
;(function() {
  var startTime = Date.now();
  var timeoutMs = 60000;
  var checkInterval = 300;
  
  function checkCondition() {
    try {
      return (function() { return !!window["imagine_externals"]; })();
    } catch (e) {
      return false;
    }
  }
  
  function waitingForCondition(callback) {
    function check() {
      if (Date.now() - startTime > timeoutMs) {
        console.error('[injects] 等待条件超时: "!!window[\"imagine_externals\"]"');
        console.error('[injects] 超过 60 秒未满足条件，代码未执行');
        return; // 超时后不执行代码
      }
      
      if (checkCondition()) {
        callback();
      } else {
        setTimeout(check, checkInterval);
      }
    }
    
    check();
  }
  
  waitingForCondition(function() {
(function(exports,React,client,antd,ReactDOM,jsxRuntime){"use strict";function _interopNamespaceDefault(a){const s=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(a){for(const c in a)if(c!=="default"){const u=Object.getOwnPropertyDescriptor(a,c);Object.defineProperty(s,c,u.get?u:{enumerable:!0,get:()=>a[c]})}}return s.default=a,Object.freeze(s)}const React__namespace=_interopNamespaceDefault(React),ReactDOM__namespace=_interopNamespaceDefault(ReactDOM),extId="imagine",PlatformMap={whisk:["https://labs.google/fx/*/tools/whisk","https://labs.google/fx/tools/whisk","https://labs.google/fx/*/tools/whisk/*","https://labs.google/fx/tools/whisk/*"],"meta-ai":["https://www.meta.ai/*"],sora:["https://sora.chatgpt.com/*"],hailuo:["https://hailuoai.video/*"],grok:["https://grok.com/*"],dreamina:["https://dreamina.capcut.com/*"],gemini:["https://business.gemini.google/*"],flow:["https://labs.google/fx/*/tools/flow","https://labs.google/fx/tools/flow","https://labs.google/fx/*/tools/flow/*","https://labs.google/fx/tools/flow/*"],playground:["https://playground.bfl.ai/*"],lmarena:["https://lmarena.ai/*"],hedra:["https://www.hedra.com/*"],opal:["https://opal.google/*"]},pathForDisplay={whisk:"^https://labs.google/fx/(.+?/)*tools/whisk/project","meta-ai":"^https://www.meta.ai/media",sora:"^https://sora.chatgpt.com/drafts",hailuo:"^https://hailuoai.video/(.+/)?create/(image-to-video|image-generation)$",grok:"^https://grok.com/imagine",dreamina:"^https://dreamina.capcut.com/ai-tool/generate",gemini:"^https://business.gemini.google",flow:"^https://labs.google/fx/zh/tools/flow/project/",playground:"^https://playground.bfl.ai",lmarena:"^https://lmarena.ai",hedra:"^https://www.hedra.com/",opal:"^https://opal.google/app/"},pathForLoad={whisk:"^https://labs.google/fx/(.+/)?tools/whisk","meta-ai":"^https://www.meta.ai",sora:"^https://sora.chatgpt.com",hailuo:"^https://hailuoai.video",grok:"^https://grok.com",dreamina:"^https://dreamina.capcut.com",gemini:"^https://business.gemini.google",flow:"^https://labs.google/fx/(.+/)?tools/flow",playground:"^https://playground.bfl.ai/image/generate",lmarena:"^https://lmarena.ai",hedra:"^https://www.hedra.com/",opal:"^https://opal.google"};Object.values(PlatformMap).flat();var Platform=(a=>(a.WHISK="whisk",a.META_AI="meta-ai",a.SORA="sora",a.HAILUO="hailuo",a.GROK="grok",a.DREAMINA="dreamina",a.GEMINI="gemini",a.FLOW="flow",a.PLAYGROUND="playground",a.LMARENA="lmarena",a.HEDRA="hedra",a.OPAL="opal",a))(Platform||{});const PlatformValues=Object.values(Platform);function createPlatformMap(a){return Object.fromEntries(typeof a=="function"?PlatformValues.map(s=>[s,a(s)]):PlatformValues.map(s=>[s,a]))}async function urlToBlob(a){return await(await fetch(a)).blob()}async function urlToBase64(a){const s=await urlToBlob(a);return new Promise((c,u)=>{const d=new FileReader;d.onload=()=>{c(d.result)},d.onerror=h=>{u(h)},d.readAsDataURL(s)})}function fileToBase64(a){return new Promise((s,c)=>{const u=new FileReader;u.onload=()=>{s(u.result)},u.onerror=d=>{c(d)},u.readAsDataURL(a)})}function base64ToFile(a,s){const c=a.split(","),u=c[0].match(/:(.*?);/),d=u?u[1]:"application/octet-stream",h=atob(c[1]),f=new Uint8Array(Array.from(h,g=>g.charCodeAt(0)));return new File([f],s,{type:d})}function sleep(a){return new Promise(s=>setTimeout(s,a*1e3))}function getExtensionFromUrl(a){try{const u=(new URL(a).pathname.split("/").filter(Boolean).pop()||"").match(/\.([^.]+)$/);return u?u[1]:""}catch{return""}}async function parseResponse(a){let s;const c=a.headers.get("Content-Type")||"";try{if(c.includes("application/json"))s=await a.json();else if(c.includes("text/")){let u=await a.text();u=u.replace(/^for\s*\(\s*;;\s*\);/,"").trim();try{s=JSON.parse(u)}catch{s=u}}else if(c.includes("application/octet-stream")||c.includes("blob"))s=await a.blob();else if(c.includes("form-data"))s=await a.formData();else{let u=await a.text();try{s=JSON.parse(u)}catch{s=u}}}catch{}return s}function inspectInstance(a){let s=a;const c=new Set;for(;s;)Object.getOwnPropertyNames(s).forEach(u=>c.add(u)),s=Object.getPrototypeOf(s);return Array.from(c)}function sanitizeFilename(a,s=""){if(typeof a!="string")return"";const c=/^(con|prn|aux|nul|com[1-9]|lpt[1-9])(\.|$)/i;let u=a.replace(/[\\/:*?"<>|]/g,s).replace(/[ .]+$/,"").replace(/^\s+/,"");return c.test(u)&&(u="_"+u),u}const APP="ucs-standalone-app",LANDING="ucs-chat-landing",NAV_PANEL="ucs-nav-panel",SEARCH_BAR="ucs-search-bar",TOOLS_CONTAINER=".tools-button-container",FILE_PICKER_MENU="ucs-file-picker-menu",LitHelper={getApp(){return document.querySelector(APP)?.shadowRoot},getConversation(){return LitHelper.getApp()?.querySelector("ucs-results")?.shadowRoot?.querySelector("ucs-conversation")},getLanding(){return LitHelper.getApp()?.querySelector(LANDING)?.shadowRoot},getNavPanel(){return LitHelper.getApp()?.querySelector(NAV_PANEL)},getSearchBar(){const a=LitHelper.getLanding()?.querySelector(SEARCH_BAR)||LitHelper.getApp()?.querySelector(SEARCH_BAR);if(a)return a;throw new Error("找不到工具栏")},getToolsContainer(){return LitHelper.getSearchBar()?.shadowRoot?.querySelector(TOOLS_CONTAINER)},getToolsButton(){return LitHelper.getToolsContainer()?.querySelector("md-text-button")},getToolsMenu(){const a=LitHelper.getToolsContainer()?.querySelector("md-menu");if(a)return a;throw new Error("找不到工具菜单")},getFilePickerMenu(){const a=LitHelper.getSearchBar()?.shadowRoot?.querySelector(FILE_PICKER_MENU);if(a)return a;throw new Error("找不到选择文件菜单")},startNewChat(){LitHelper.getNavPanel()?.shadowRoot?.querySelector(".chat-button")?.click?.()},openToolsMenu(){const a=LitHelper.getToolsButton();if(a?.click)a.click();else throw new Error("无法切换生成类型")},getTypeItem(a){if(a==="video"&&videoItem)return videoItem;if(a==="image"&&imageItem)return imageItem;const s=LitHelper.getSearchBar(),c=inspectInstance(s);for(const u of c){const d=s[u];if(Array.isArray(d)){if(!imageItem){const h=d.find(f=>f.id==="generate_image");h&&(imageItem=h)}if(!videoItem){const h=d.find(f=>f.id==="generate_video");h&&(videoItem=h)}if(a==="video"&&videoItem)return videoItem;if(a==="image"&&imageItem)return imageItem}}throw new Error("找不到类型对象")},updateConversation(a){const s=document.querySelector(APP),c=LitHelper.getConversation();if(!(!s||!c||!("update"in c)||typeof c.update!="function")){if(s!==appTemp){appTemp=s;const u=this.findSessionObj(s);u&&(sessionObj=u)}sessionObj&&(sessionObj._value=a,c.update(),console.log("update ",a))}},findSessionObj(a){const s=inspectInstance(a);for(const c of s)if(a[c]?.configId&&"namespace"in a[c]&&"agentService"in a[c]){const u=a[c],d=inspectInstance(u);for(const h of d){const f=u[h]?._value;if(typeof f=="string"&&/^\d+$/.test(f))return u[h]}}}};let appTemp,sessionObj,imageItem,videoItem;function mitt(a){return{all:a=a||new Map,on:function(s,c){var u=a.get(s);u?u.push(c):a.set(s,[c])},off:function(s,c){var u=a.get(s);u&&(c?u.splice(u.indexOf(c)>>>0,1):a.set(s,[]))},emit:function(s,c){var u=a.get(s);u&&u.slice().map(function(d){d(c)}),(u=a.get("*"))&&u.slice().map(function(d){d(s,c)})}}}const emitter=mitt();window.emitter=emitter;function useEmitter(a){React.useEffect(()=>(a.forEach(({name:s,callback:c})=>{emitter.on(s,c)}),()=>{a.forEach(({name:s,callback:c})=>{emitter.off(s,c)})}),[])}const logo="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAYAAADDPmHLAAAACXBIWXMAAC4jAAAuIwF4pT92AAAgAElEQVR4Xu19C7RV1Xnu3OccUF6KIChCfCM+MEFFEQVUFE3UGhvbxvTWpB3tuL1tOlqTNOOOaI0xiYkm3qHmts3NrUnjI1GbRGNs7MAHuREkPvBV8QGKigKiKCJPgXPOvt8/5/zn/Odcc6619uZwAO0aY5+9z15rr7X2/P7/+59z7ob6AG6/nb5qRG+nmtDb0ZhAzz2djUPwPLy3Qw3t7WwM620o/Wgqem4ovF7Xq9S6pn3G/+vx/hq8twSvF+H9RXj9wl/eOvzdD9pwNXb1L/TosW8OA8AzAPBpAHwKng/HY2+8VnhW/NzDrzvwHr41wMezBl8BXAWQ9bP+n963r81xvL+xigQC+x7B8xw85n7x5j3X7cpjuMsJwFNHrhwIYKdDk2dCo2cC/Mn4v6sJYHsY9M5tA59Bd0KghcMLixESLUTdEJYFOG4OBEgLxCU/3mPLriQQu4wA/OeElVMB9GcB+h8BfKJ4p930ur/A10zh2MIwhXhvNfbd3mw0brr8R8Me3hUEYacWgOcPfuNAAH4RAL8IFD4er0HroXaXge+Ot7RvNDpP+2Wa7/blwbesYM/fUItxvZshHDd/64ZhS3dWYdgpBWDRAStA641LAeAn8dww9jsPfpMYgARDH2OP4+NrgN9kehd+gPEJDJhV4HvBceBLv6IJobsL57nymv87dMHOJgg7lQC8OG4FOXOXAvQzGfAs+EIgWgFfarkE2dO6c/iS4IPevbMY0H8SfMc49rr3ghWuvP4HQx/cWQRhpxCAJWNWnAHgL8djmqZ4AjcJMNO/Z4O64Mda3BL4LhJoDfxAWAJ2acyDIFzxz98fcv+OFoQdKgCv7LN8HMK060Hhn+oJKD4FcAn4KfMgbHUV+KHtj2i/JvjFawhhCcGXDPILCOLF//JPQ5btKEHYIQLw6ujlXfjCX4DGfxUaP7Rl8C3gWfOQAT+21UHsLxzEojNYrvm1wRe+hrgGJZ2uwL1c9+P/Pbi7vwWh3wUA4E/Hl/xngD+R6D4HvkzkaKAj564K/JjiWwXfg7pt4KccxAzjLIQf8le3fG/wvP4Ugn4TAKv138CX+58As8HgN50QRN67jfMrwZf0Lz32pLZZepdZP+3IhUme/gQ/zECqJq59FaKPy26/flBPfwhCvwgAwB+HL3MbHieHCRxmgPrgy1AvYI+64Lt0L6eAWwPfhYyp84j3yjQ/TkMH6WgTZczDe5/5xbWDtrtvAP3ZvhvAPwdXeKo18JnybbZPxvTWFJSBT1pFg1yg/brgE3vYEE+fx6V+i+lgc1zo8KXMjaspRMmoBPh0vWk0Zhd8cdPZ2xcdhW+6nTYAT8L1bTy+jAcoX6ZuhebL/L1I5LjiTWD7DVNI8EMHrBEVdfLJnCztc/JHmgktUNXgx/fii0jpAlSYZMK9WwGlZ40M3sLr7+D5K3dcM0i/3dfbdhEAgD8QN3oTHp+mG3bgR6GejuFTAEfCEucFXK6A8/I2axfZ00ImL/T6feKm1EFMgJ/yEWqDzyAHApYEXwuEVdHb8Py5O747qM8LTX0uAAB/KG77TjzO0OAH9O1j+TLwm8QKVN2L07ry/wrwnZ1NDXgfO4hVLFR6LzAfBc23Zsfxs0HpPtVofuqO7wxe35cs0KcCAPBH4eb+A4/jaoHv6D80D/0Nft4pK3cQJaMEYacVuqDvICOI3r9w2q7NWAQ+/td8sAD7zr7z6sGr+koI+kwAAP7+uClKbY5Pgi8LNUH5tib4zCTbqPlhObfYGOKdsjz4xURRtl/ANZfE16VCU4vgs2AsxvjOuvOqwa/1hRD0iQBYzX+IwafmDErkuBg+atTwtfsi+GEXT5T+7QfwYzaIO4WqwI/7BULzwL0EbYNvMEepGX+n3fntbWeCbQ4Drc2/Z5vAtza/HfDDkM+HY7HDl9V8srfW5u4i4JMIHAYhuOf3L9lI/tY2bdskANbbJ4dvMt1FVvMZYFyNavd8XNzV4/v30ppvYnsf6mX7+IJMnwgN2Q7rZx/rBx0+9rOBfbdCkisZR11B+tyx5htBbVPzGWLma/M8Gee84/x/2EgRV9tb2wJg43wK9bS370AlkK0JKABsS70uAkg5gXjPfN6aB5eEKe/mCZo4nUYX8wLSI4/pmp02Bp/ZRXYRiQbRsKHUCZ0AnwTN3ovrKbRJKnby0g6fwVPvoy3hFNp9s7D3xvMv29i2KW9bAHBhSvLoOF8PmKDxJMAR+B5k4QdYgWi1gzek8LChw3f6CoeP71kwRZg5lF3CkTMocg4uS2iBDjRfs0x0LxH4QRou0O5mHfA5UrjQYtEWC7QlOTa9ezfJpgZftGNVabdJ/PRfE2eYjUvRvsjyFeg/1RsQsYoFuhJ81mgBtMj4eU2Hoaih+WGYaDKG59719cHki7W0tSwAtrBDuf2RKfC1ZlO6tqKPz2UAo959TgJV2eWqAS963/0Hvjctnj1iqq8FfkT/gWCIffZc70CUJ911RWvNJS2ZAFvSpaqeAV967wC9ZfBd65ex+f0JPjtl3OMfTg6pp/n6HJbWw6JOmBfIgs+6qtUw0vya4DsfQTVHwqTc+smvbaBmm9pbSwKAs1I9/2QHfiuNGtapoyhAmgz/2vYCCmcqnrXjPGmm3YSdTWm+tNX+ta8FVIMfzRwKfIhQy80919D8AOD2wTesgG9luHwanr9eG30cWNsEQPupRPkgLthw3TqpFuygRTsK51po306FUdKTTs3aKSZpyrt5igIWlnX9NSrOwwLhBMMfL1O6orgjPPs+A19WEGf86qtDanUW1RIAS/1PAvyJvlXLanJk632XbgX41uNXuzXUx/5uiBo7fZvC2VaEfqc4dt5TPeraW1HcS0UGFpWczdc6H2q+EygrZM/gkGN/ddmQyh7DuibgYpxwItl4TeFRWZdn62TB55hexvc4z4hJA9SJ3xym9pk8YKcApT9v4rjDO9U3/8du6siDMSiJeD8Jvr3BCvDpqKNxzr+r830qGcB6/c/Da6ep1dkmTgK/kAl04WExKtjrowPUlK8PUx0QhA/ztmUrHKt/3ayefZUMjjHKWfDdPmfzY81358B51uM8h999yZDlZeNbhwGuK4DvvHfruLnsnSgAlYCvdu9QE/5k0IcefAJmIMjvM2cOUAPId28HfEY3YhGAPxTnu65KuUoFANpPM3Yu4HCPOniT8+9KOnhNeEemwwvLpC8MVnse8iFXfYHMIWM71N/+4cAami/cdplQKoJvhan5B+devf70thlAT9cSpVzTiyfDOHb0uLVL5gZCYZF9fPudNFB1Dqy0PlXC+4HZvxtY4OSjrUIEKeGYFbSLF/gMsbngnEOTGkjoXB3q8rKByiYNXh6zfAbAx1w92YgZgS8SOXWbOCn0ym3zvrdRrVneq3PotImFGFzvvg718Ajy8HS8yx/YfTYW59DQF3hsscaeQ+brObHjzq/vIUz9yjyCrEFwwaYQ6ulvYsCgfeNGN9QXLsxEPNsKPvG5NiMOfGKV6ef8r/XTf/2loXNT454VAICPWbpeo2W1L07klIGvTYB1ELngkhOA1Ut71erlPUEp1cf2rTZxNgvLvJgSMN6X2TuXuDHxeLg0jDhe7DNpaH+eUvBNK5dr8+qhASnbktReQ/PT4LNAXIpLfjx12eTdvDQW8/M7FKZo+1i+qoM3rO4lTAENoH3kvn8DVCg1tmXwta6V9/GlwbfXtaxjrptpLkk1caZiefqSEfj0VldZolaCz4NkzxEklCKmoLE3QhhovmeDDnXWJ65fp3s24i0pAACf5ujbdm67+EKcwrV1AMrf6/V5WujgzQlATNdBWlVoraNeqZVay+qD79LKERu0DL4h+FwTZ7rBs4IB3PlaBF/bf2JcaxK1KfD/X1JLABZ/ZMWBAB8rc/iEj0n+CKcumszRCvjOaUncTTyRghsnZcHFAdQC+NJWpxo6pK+R1Xzq5hEMUd7QEdK+/qqxfU+hIZkkBb5jBfNCan4S/DA6OP/j/7j2gEoGAPAXgQGQ7/ep3rImTgafK4FOcOjzgvZdF2yJ9EsbLLtmC3a5BPygOidbsxg8Z/O9vZft22l2abOVK+HUlSl/qeazENlzFsDXzp8RNOcE0mvvGzTABhdVC0BHA4syVYAv2MCbgCj3nwG/jAGkzdfCkHTKfARgwIqqcRboqn4BN/fPmYBiHx+bIL4XSfVxiddoebXml31/Z8cjxvCCYeGzQNP1HOixExiCz6agXACeO/gNWoptvLT/26OJM6cF8YAXPXJblnWCsW3gy6YTJ3yB0PWt5peCLwQoW0G0gmG0ui74zAr6+bAzf7D2RDn+gRNo6J8zdj7mL2vz8jUA6ydYzY1ttaT3nADIjt92wGf690xiWMRcO1W3t3E+swY9a1YR0YS0y3ZfwZ4zLTPlRxqs7XUdHyCn+YL+WwcfguLYQQtBwAIuKFk4/o2BAP/T3LPHsX4BfK7sWcfQRQAsOIJS43q78QnkKIWiEPgA8jx2AN35cA8HTOhUBxzRqY46vkttWNdUT8zvVq+81KPefNPE57lVPt01NOhRB28sLCnw+ZYDQFvs48tpgDhnIbJwlC40v9TmW5YIwSfmuHDWD9/7wn1/vqeeaOoEAOBj+VVlVuAUeXudx3dlXNkDYGx+Ox28WRPAmlgC/oj9kKD4zO7qoCM7VYflr733hUCM71QbNzTVYxCE2XdvVe9voVSN0XzHDEIwKsEnoUtoMid99HfQgPUR+EKwkuBrsCPwdYhnY//A5ofHunumz3eoEfifmnvm0CWdCQCYtPauD/dEz37VMqxaSGpoPlNzTgDCcM0kYqQzuPdHOtSFFw9Sh0z04MtzDR7SUKfMGqD+4KKBqgOiHadxfYt4qPk+BWzMBI3KHsMaak96DG2o3ZC5TTpiqT4+ITQF2mfnrYQBsuB3VIDv2ECAH2h/YApm8i0IBoAA1FqGlVjA5Ag4Ami1gzcrANK5i8AftGdD/eHnB6m9RoW5q43rm2oACksDRHr9WJiF9ZhE/bOfbQkWdWR/QPoIXsAANq4x/fhOdfRhHWr8/v46K9/pVQuX9Kq5T/WqJcsgRinNZ+Bjf0Cairz100NSG3wWJAm6S/hYQcmDT/cfCsATE1cOA/i06rZfgNmyQdDEybkB+SxBs6/ZzrpsG1O7fS43AULz7aDQeY47baAasY8H5b3VTXX/3VvUS4t71O7Q/KOP6VKnnjXAmYWTp3ep+Q93q6UATIZ8KWeQQsmZJ6HufWaXGgEhiLeDUK6lx8dPUmo2zvnT2TAxaOTQWwLgUs0vE4LoXCbEK9p8k90z1B8mgDLgB+ygP3v86TevGfrARcPXawYA+Kj8qa5Uv18rK3EyhaemQ0mnrIwBCufAzXfuBo38mE+iv7+pqW75/ib12lJbkHm7qZa+tgWgNNUnfm+gIj+zE4cfP6VLvbJsizAjxUigA6x30e8PUGdOq+5PoKaNc6d16YreNT/Zojbyeh2C2svAN/tMriC7xVQeO3HtgO/YwQoOsIbwzMA93KNVCuCfJmP/Yo9f6BhqX0FofhxDB2GXcLzYKStnAB+KcV5g0B4NNRoayNuiZ3rU6wBfC4tgl7lzu0H9foDHjPFxvFz42TEUPnv2aV0F8DdDu594oVc99HSPehjXek+ck+5h0mGd6vNo4Oi04ARp4VJWsA5bbgCqwNcaLzSfGYBZIqZ968/4DKFlLPO50+g2mAHolzaKK3I779938+jjaoIvvW+ZFyhjgNDxMxob2EZ8eONGX+qVId/WHhxvW+u0YOODmnmi3gC+xlhEFOfN9JpP86sI8J/dB9Ox0goSrr/3Xg11/imd6owTukzrFrapcESnooljHo6nLan59os6za/wARylp2ifxgGOoD+G07x1aZ/Ax+c9G0yh22MGwO/rhFpetRJnPAXaU7cFTWi+oX8BZkYCcuBv7WmqrZuFZo/rUB0oHbNwsK+x53B47Lv5kxOg8royL0EO7Aw4fEMGe1TmQ+OvvWVrAD4N+Nv49aAbfrVV3X4/G35zjU9MNQKRBZ811E/c8D5DYgwCTRW0rUHPgC/D0oLPEDFCWClUE7QAzD/hLYr9R8kZOmXgh6GaB0GWboOETgQ+d/ukZEB65LJuvw6JnleR5OHtAPQTnjQTEkBCpgUNwAPIT8KW7767B/TpZ013UdHrN1HDlI957X93bVPd/OtuBVkzm7PrVuvw1t0PdasXX/cUcxjC0v33taZJOnD28wXNr8UAgZYajS8B3wmNBjuVHi5ovnUcm6NP/bd39+oC+PhlLS71+vZt2cTJtO8HsmZ3jqZGn4hxdJ5hAPYRCk0bGPPHf9ejjrCOIDl5510wUB0JCl6xoqm6AOZBB3WoMWO8n7D6XSSFoNEp8AnC8QciIyI8/kXoRlq1xtO+uUUPPgGxFdMs7l/Qo8YDeNrIB6BevpdW+JZuFp4yVsh8fWPfW9D8KvBdcSlwAkntnaBM6NA/rSbonzt4216GVWs8O3LpBo3sAIisnSslWyF69ulu9ThCMLkdCmdsxqld6qSTugLwu3HYbb/cqtaAOYJ0tOjyOQwC0CUc//lPxyCG4DOwTyLs3LjZ38XxmOCxO+UgBAN48COBYn8mNwDMOuwM1tH8wHFkv8DcTyxQJmQMwkoIQMAAxg/Y3suw5r6/dOgCIcIHtgKff7t5s3r80fLZTu8DnBtv36IeebKnAD6bL7r+8RM9W6xFCtkneCxlxs6nBfgdCNXCl705GjOi4RjBOWjaBCTArzIBUlNT4DMjSdBlWCiikiT44p6039TRnAATgB9V1AzgwY+bOIMyLWu4tb0FutYay9532kfIM4Bw7Kzmy6rgFoz7LTduVi8gRJsOzd8HiaFO3Dc5e90w3s8+36tm/79utfgVtH5aAI1fEXbzHLBfQ43Z2wvAilVNtRKJJaPl5jmIPIR2U2Tx0MIedQIKUbRRPeJ4FKaesdeU50izQu7bW2eSNZcdSOmLFKhchIUx+OLz7Bwaf8Km7SFgwO4QJH/0L2q6GoCz/XrgvJMVOHYJ8IMB59KrBSF2EMsYwNnsxI836vPgD2X4Hn2iWw1CBnAY7DhNr1q7QTnKD++12Mo1/oAONWh3fxePLGT6t+C7QY+oXQuI0tO41iA3MBx1AtqmQBhueWCr2kzkVKOPLysCCdrOU7kH3xd7igJRAj4Jw3D4AGbOX1AFrAA/jgRCrz/tIGoBscxQxQC5X+7kfgG6PiVrVr+H6OC1XrUMMTvb+yrwNWA8CYPOg2zeCzQvr0Y3Dw/0O4gYnoPTyNtIJKqOPhiMUAN8XZvPbEknMHIMjR0PwRdtXzZqMIKaBN++b/EYCh8Av6UrS8A1wC9rnIwLLi4/wGahxA5KumZG4fNlfrkz375NDiXGIU4kjURS50CYAN7ehue/BHMRaGOv2tC4PcI+x/se/E/vB1A0MOXwYjjoMhd8DqbpnATEEcD2AN9QvzUFzWHkBA5zq3FvI/hSy71vEEYCIlFXGIY6NXo2SwZcA3J83bJlWA8c21B7QWN5W/B8j+rBTbUCPn32WRk24v9jDkVSaZA9rzV9QZLGge8TWkk5sOYn7cFXaL77LAmwjWLY5mvQA/BJCCAA+KNNQB+AL714BijIvmmw8hQgY/aU5jPQEnwZLgbOqgRBaPfJIvlDwD8P+m8VfAJ2HQpSTy7xLKDNAEJLTb3MILHmc6ImZwJc5i7MB7j7k80fUlCY7h2DpME3nr8RIusMEgPon1NPOnzOsbPaFrZZRQ6ioHgHPg28HXyZDs7aQLoO07Y+X3Uf326DlBqMLCA5hFULMJOGHmqTOHQPGwDic9r+h3RfKO5EJoEBfvgFhJoi2jv5qK5C3cI7aD7+zn1/5/A5+y2YqaQhxPsFQvOlrbef1T0cHnzCfFiXpNRWl2Ftt4kzNwCtgE8SfMaMLvWJmV06/09FoPvm96g7HujWDmIAogV4zKiG2g8P3p5+sVdteL8Yr9N+n8zx5wq1G2Hn0h71FnyIfeFX0DYR0cUIMMFq5AoY+GQTZ44BWKsdE9hrV4FvP+do32m6oX3tWxXB1/s6IAB0u65o4mv5zAq+QUMfZwcn9RMqgeYzq9hzayaQA5sYhBzte9PiHbtZyAP8yQUDFDl1Q8EAeyAko4YOeqTAp/dOFMkfyh08+zJNFQ0BrgW+relT2Pe7531iai/cw9EHUDRgzlkAP2/9zGhY7fQePN6LwdeabSmegZfJoDLwi6ywrgPSsa7qF7VlaGVeR46dtXvpBZgN8NJWl1FgsolTCBGdZ+TIhjrvrPQsy7PRsDEWDRuO1i3AVLU7HPUC3t5H+Pfki7DhEf0Hms8HS7vOlT37ucdwjm7xA2/Tj8Jv4jkKz/Tx5RhAJHOMECU6gKMMYa47SFO9A9y+tj5CrxUqCOi6Dgw4BMBrNtNwHY88dsrCci6HYMLBrGIACt2EL5G7l5lo9yKt19oK6XqGfqjdbrvDHJyCMm/siI1EqZiLOHToIuQPNFULBiiAz5rsjvHUzp9bhPUMVr7rr38UeglHkUkoa+LMaQBfj8GPTEFcFZRMwX6AYVHn5IH6s+DTWEMAiAEsMHXBL8b2xQ5eEwYWwS8LA+uAv/feaNw8wVdxXkbP3w/v3Bp07UybhBWtSECEdh8zAWljkYRZBPtNUUDB4ZOMkNL8iBW6cY6HF3kKGIxl745DuZo9dwZGZuvKGJCTN9FkDkf7QdZPC4hvCKkCP2QFLSjEAHo1KbEwQvlkiZjOY9p3cXkG/NKJIWwqrEDKZBAL6emgeLL3vP3HvB617C2Ufjmdix2kgZOP9ImZBgbpCNA/R6DEGo+iblAFvmcHq/nMBIFgQABQIeRogA45AXMUqNLow7cobZszATnatwmhQOMrwHc5f2EGjCPoQ0H8v558APS72B0RaLFTFoOva/2CPXwcn9Z89jVyGhCYosjXoBsfAdt/yole+197o6kewoKLtN3/aI+u12uMcOyZU2GLtQw0FZmFjx7q1f/VN3rVG6sNF+Vo3+8rB59AWbqqV738pjAD49BhM9zkBAo22stucRiENnsGMTmBLPjSzguAe9kHsA5iAnz67muIAZYEjp1kAwGCB1fU+iONlUWf2K9wwpLlP+GHJMCn4T0zsv13P9htQMfxL6FT5zl49bxRvH8M+vvpu5300S41RHQKvQizQU5gX4BP194MGXxMdCzRok9TwQIp8N01E+MQxvOWNWLwY5bAfg126+DTZ5YQAyyKf83CUa9lhAB8LXHG5uc0VoZ8hl3E8WUaQOfUD98/yOZpb2j/qVO89i8H7f8OHT8cm9M1iQWI3mkje/83fzRAffXPd1N/ek6Xmy9A++ajnNtX4LPNnrcY7WTCwTkRqeHOrjBcc3P6c0ogagGh+RAMIJ3LbQOffIBFFAUsigs4MmvXDvgy5IvBL3MCc9elwZgF7ecGTgL5nnndRos155sRfQKZuVe4PQv/07SuSeM71GCh/S9B+1/gvj7p8FlQjGBU037sga+AIX1+hXcGDxndqT4ywjBQISeQEYDAcUwWgsKeP0fz1gzUpH2fDobyUxSwqOh9ew3koo5mhRqaXwZ+dSIovC77JqMwHewU4fmT9s9Dx0+cxKHZOjfctVWtfMfSQDTQb6Lp41/+HXV7kSmUkUIOfH2aODpgYC1Q1LE0n/IKdhuIvMPUQ01SihNCQW4iJQQWyKh92whRFFaGYFOmT4Z7KPpEDp8ULhcNdEAA/uz24eQOrfJ0XmziNKBW034V+Owj5Bgw5fXTdU+HQzcMuX7eZmMG8Ib3i6CQ5lJ8//UfbVazH+lW76Bf4F3E+m/j+Vfo6L0M7y92c/vCzyfBD1jBHu9A8jaaB/cJhJYbMSuZt6mHdOkZSjJFWyYEbE6i9u0i+OWxfRCCCrBtGdgJylvPTx39rpkYov0ANarOKlsy2SMbNOqCT8dlBcDci5gV3NCp3tOE7V+JaWAPPuFDOD+g1t7iHNTe9QM0hd64m+3jxzk3pebyWc1O+gOpfTH4lgU4Nn99TY9avLJXTdrf+Crj9sKayGgbf3al9TmYDXIDUEX7NDYR+JzrNwztk0CaucWxxf+bi+g2dGyE4XykCnzWTm0u6OQcMjJoDrjQ4YtDwzIvOAafhO2sGaH2k+1fXyjgePAlVZOPQGZhk5zDZ4HVGDCg+nWYFQz3GcSC0EzTsnjPpmh/+6KvDQyEHEw5EBVCZy7MNbNb7ARGtC8B1Xhwfd8KFmcAk+CL1LA1H484AQD4v/EFF5G7J5DtF/dZwnrgcyQgQ0P2NUqGwKSCbX5hNLJ+pyGtyxvZ9t8+ad1IZ5PT4DuAGXBpw9sB34Vj1kFMgE/3/vSyHrWWBRTXmXpQlyJ/wIV4JZNDC06guM+wmaMm+Kys6dTwbzwDNNSDGNZudvhSoDHFp1biNM6d1/wwYVScKpYTAPY1+PNnYcautP33YnLIeswL9FputDZ2BmuBzzdRR/PLwI8qcyuRWH/hTdE2vkeHOmLfMCeQVQDpBDqtFmA7x04UekSZN9B8bS68SdCK5U1CN/5/0AnA53+yJxWEFqToOoj3I9r3QFeAjyvxedL+uRkSXQmkZ9wsTcg8dbLXfurd+w1m5RTAZzvMms5aU6b5bl8N2ncVuoTmRzbbmI2mmrvEmwE9e+jgAWEuPyMBzgmMwPf23QLKmt0C+DJRhPM99tLkfbCEhlgiBl9vThjyedBcMsfa+YApEppv/IUwmvCfyRtBBp+ez45s/70Pg1pJ+zV4VvMz4DMDBKFbQTAS4DtWMC8KizEGNhqfF/8z+PTe48u61bvoNuLtOKSGh6BIxKnhPANYc8aabhnBaHbs4GUcvuhY4yvE2cLmHL4HlyDHReYYAIpNnGUOoqF/7zcYO1/eL5AbAD7PPrD9M0XcT9pPWb664LMtdYJQF3whUJXgS5/Caj4LBIG/4HXPAmNhBo4dC2fQlyPSQyA1Xzp5OfCtgEy6GMoAAA0nSURBVARVvlx2MDQfRQEAkHMB/mrpDMaaH8TpVUusWSr3n/GFo6wAWKD+9LwBOq1KCzNsRLx/7yN2kYYamr9dwHe22cb+VlCCfnzBBjSGTyAruBZT2t+DQ7gGj88di4oUC0rOBEjNL3bwJhs8knWARBLIhYjoWMP9uZ+Uc201X7p5zy1Xf3bt7RCEv/IhX9SUaUFtpVmE07vSMcxToNlz1Y/Nz6mFGlxN+0GIKT7vnMSUw2eFLs701V+JMzQFLIBzlmxRD7xsfxaO7sVqcVUiiMM7pu6oiTOK7cMiUKLeL+cAWFOgbnt10r4cGPtl4mgcIBk3ewbYNvDlecKoIAu/3pHW4BbAj/yCWuDzLVkKrg8+Phiwg/m/rBuoLA8iwc81cXrB4MSPTwB5XyGOHIyg2P03SwQCq/SVG/f4HTT2xVSPoGMFZgFB8XXat02VzwKco8ASpy6n3U5oEprsw8OMwxfbce3xpxZZsBGAExAW1GDtvTT4TPtCUHIqkOvgLbJCwakTmp4A3/kKavHSj+77cFYAmAW0Y2fBChNB0Xz/yOHjRE+B9iNhKecAq0UMKO7EgZ8QkGCf1GTxeU7V6t3WYS0Ud2Lw2c7LyRguH2AFJfg/Eh7nJ1jPnu+dhS4xCD7ckw2dxfRvaPflbB+R/rWC56MAvS/QfrqFgl+K8O0mUEUzSMtqAEOToGldhHoOfBKKCgcxKwAFgFsEnwe9VfD15ypW4ozBl4Dy5yOBKDRxsh9QwoAVTZxR80fY8OkYRDOV32cTRE1gVC0Al//rsKX4wF0pzZes0O4yrGX9AKHjF4EvtLtA+4L+A9qX2pbT/AqbXbTxmVW5MuA79qlhArLgOwqXTp+c8OEBj+sAwvv/5esTxyyNZS8ZmQKkK71GF2v0OfCDMJFNSMJMlJoADVoCfMEOBdpPMEeB4h0rWBPDgCQmXhRAcyFeTfBTc/ikiSlhgKQZsMzha/xl4Fun0N6zMBdXpi6bFIArfzhsAYTg3tQSaynw+abTzmBoOkqrYfoO2wffCIZ12JKsEIGfmHjRB8uwVjZx5hRAhn6ZJk4/1Uuygja7YbZQK7AvAs1edtSYx1PXzf9uYKNxJU56pgvhtB9gpCuoD9iL58D3OQU7+CXqP3Y0eSWRTJZpfqzVGnzL+9IfkObDUTEJGv6R1Kxf23Pw56Nnfzw+T+e11G+cS5MTkKVkLZTMMni5/x75JWk53ZsH345/BHYF+BQCJrVfDl8Sli/99/XIDqpprpBTtyvI0b8vEklK/vk1Yn2WUnvw4dp5wux3Cq1cBWEoA1/sE5+bu/yIMTNyI1manQb4V6TAD5xBm/eXTGHoJw0+HUf9fLov7782PQKbsMDV7Dc2twa+YC7Z9kWvI6G5omyYSwXg2h8MvR9g/kL3ALAJsM8c64c9BExRAnxBv+yhX/vTrYqmdP3XZkbghbXd6tKF6+NZO4XcP/snMhtY0Qz68xWH7/dA2wJAH4QmXwyQ18dA59bgDTSfjYy2j8Y26g3Pt96LefwuI/3hFYX13U31/SWbnN/A2sx+RBjPl070jDWfMLu4amQrF8l/dMG31h53wqVYiR+/JWwdwHj5V98oGmm+dMQE+HRTq9BH/wI6ePdB7zz1+/Mq3FU3/EHZvwHAL0QT6ZXPbVBPvLc17thN/F8FftQW3lCXrJyw3+yq8aqqUOvPA/zrAP5CY/tT/QKRzS/RfMMAJlRbiKlcX71hs3pSzK6tuuEPyv75b29Vf7ngvWrwOZxzDl4iNRzPCWioZzC+19cZK9bLymP/4vMbpoHeH4QgNIphYGJJtgTtS/Bjk8CmwVfvvLlw+xyLJIo7EcPEa+elOni58mgaNRJlXVHC9Q0iNlQU9X9zHpvzF40Xyepc0ov3uf+SPj4TgufmBOjz6vNQynfGysP2czX/MnBrMQCd4IZ/GjIPX+hqpnsXCUTLsHIWLQ2wHSRmiOh5R4Bv/JIWwQ888B0Avr2+XCpGzA+4qi749M1rCwAdDPAvg3Q95FvEW9R8M9SJZg/xfqTJrnrHpiMWmlY0P+rgdR06sTbL5g3rx7hjrQbLhJB+ndN8uVSLPa+vzdfXfFlYKvYHuvOQ1l9WSefigNomgD/z3/524zgwwVMwByM59pegMq0ybTvaJ/B5MFvRfD62hfZtuWqGo/lMB29xGhZnA42gtrwMa6KVK93UmQc/0cRp50uE6d6g8NNQ7+COJ0H7l7UiAC0xAJ34J98bjAi+8TmArkvG2wq+E5Sc5rN9TQmNeK+yiVNoeV3N3x7gi+pcEPcX5vcLRjGJNQE+/+/ZhWD4bKvgt2wCWLJuv37Qr3FD3+0L8KtZIeHwOVYwd1QJvhQubT/LbX5S8zmkTTl81gFL5eRjwKuaOIP9FuAC+MKU2MrodwD+Pa1oPh/bMgPwBzGEX8FA3a4BSFK7AS4HcNk+7wy2AX7goBmnswBowuazFx/W/63TSucQJeHA5nvvO16GNR3LO82O2rqsYAblYBxbA/zbcHdfaQd8Saptff6CL24aiBv+NQbkDEfl+qw1wY802Tl8ZbQfa7OssydsdrUdJ3Dz3UCmmseC7AVCOn0mPDPMwu/HjRmhZpuQLRkmFhxFe153DRfu0ejdh8e50P62c6otO4GxpHzq7zcNxXu/wUBPNkIgwE8A7DS/38E39xYvv1YJvhOA9sGPavP1wY/YRQoVvs1jeMwE+HqKV7vbNgsAXfhTX940Ck/zIASH6ap4pKWSHXL7vD/haZs/Vwgdnaa32Mcna/Ua2OjzdsCDHgGZDHKOmNdCp/liXyFZI5ihfJZvoY/POYoR+Itx9ycD/LfbBZ4/17YPIC98x3cHrYJ2zcKwLK4NPp+ABo7ZIFqGNTAJgjE48+ZDPAIzF76Fms8+QTvLsPq192TXbkWOPgJfVvKCxR1KF3MIaJ/An9UX4NOQ9okA0Inu+M7g1/DlpuHlAjfIDlhrQ8X/xYxhTc1PaW4V+OykOgexaArSHbwkPPbe2XlLz7VPpmmlTxD2/AsGKaH5wCE0rLoAj2kA/7Vt1fw+ZQA+2Z1XDwYT6B8lvj9L+1KTY81PsoIBwQNRpH2v1T7qCFgioP4E+KKJM7gW9wyyN14CfnJaVhzLJ2P7kEFyEz0xAuTwnQbwV/UV+H3KAE4Irhq8HoN4Dh4UnoT+gADfC4jV/KRgVIDvBCMdrrEHL9O2gdmwoVfpSpwJ8Gsuw2rtd9TBW4jtfRo5lyPAKNBYnrOtDl9KcPrMBMiT3/ntwbRW1h9jsK8mGdBaFYFvfIUWwO+rDt4gB2ASQkHsH4eVHJ/H8btz+opLsoUtWb6ZNlzDJw4bZc+/yxGQe0Rj+McAf7s00fVJFFBGSef/w8azsf8mDPJIFoS2wC948N7pc1otwYtpP4jnfTYwTPzgTvt2Jc7U7NxCwijRx0d5BfLwP9duhq+umdjuAkA3cv5lG8dhoG/Fy2l9An4iXOPFGLO0H2f/kulg4V9o6k9oZW3NL/xClxYGEriqRR0BPlX1LgT4y+sC2e5x28UExDfzy28MpgrVaQDn29C9gklIxvnS8XPeu6Xr6FczKsEXn2fnsHQxRgbffs4lcloEP2jirAd+E+B/C9/y1P4An61yu8LT1uc++bUNFCp+H5owsTzOLxZtTFpXOHwWkHglzkAg3DEinRuzQbwMa+lKnOllWAs1filE9noVmv8MGOKv0cdXq5OnrcFPfKhfGEBe966vDaGM4TF478t4UMRgtoLGhxW7nQV8GUWULMNqzIdjjFQrlxFICA5+sKP593g+tr/B3yEMIIXhvG9sGIf/rwO4F4TOWMo7b1/zzblTJeAwp5BahpWnw2W7cDhMDDJ5VeC7/T/HfV2M3v3tbutzjNEvTmAVXZ33zQ2nY4AvB1DTuc+tsokzau/yVTsrKDYKqAt+Wytx1kgQZZo45+L7XoEpW6WTNqrGrS/27xQCwF/k3KvWTwdglwL8s3xoF2p+HlARFlaBv+M6eGfj/q98/agxc/sCvL44x04lAPyFzrlm/WQM1CVgg/MhDA3XVJKl8hLwU06gsM1tab4O5aJETsJx1CEftWl3qF/iu3zrtaPHUC5/p9p2SgHgETr7unUHAPyLMJD0OKytVq4oIWScSXbAbKwuwjuxmpZr8IiaLwvgZ5o4F+NzN2HfLViYaelOhbq4mZ1aAOSgffwf154INvgsBOLTAHFEbPMZWGciqjTfhpTpjl2v3TH4RbCDhNFqMMptuLebXj5mX70c+86+7TICwAN51v9ZS21o0yAMM8EIMwH48Xh0ba8O3oomTqyw3nwM156De5oD8OctOdYvwrizg7/Dw8C+GKBZP3pvKACYASFAprE5Bc+HA4xRVU2cqQ7e0j4+k9h5C9ei31h6hEDH/3MXTzGrbu+q2y7HAHUGeuZP1+wFkCbAfcRDTQBYh+D/4XhAWJrD8DwMThye8dr4A7Rc/jrsW0evKTkDcNfgmX5TcRGBjv8XPTt99Lt1rr8rHfP/AWb5g4VI/iKmAAAAAElFTkSuQmCC";var commonjsGlobal$1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs$2(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function getAugmentedNamespace(a){if(Object.prototype.hasOwnProperty.call(a,"__esModule"))return a;var s=a.default;if(typeof s=="function"){var c=function u(){var d=!1;try{d=this instanceof u}catch{}return d?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};c.prototype=s.prototype}else c={};return Object.defineProperty(c,"__esModule",{value:!0}),Object.keys(a).forEach(function(u){var d=Object.getOwnPropertyDescriptor(a,u);Object.defineProperty(c,u,d.get?d:{enumerable:!0,get:function(){return a[u]}})}),c}var classnames={exports:{}};var hasRequiredClassnames;function requireClassnames(){return hasRequiredClassnames||(hasRequiredClassnames=1,(function(a){(function(){var s={}.hasOwnProperty;function c(){for(var h="",f=0;f<arguments.length;f++){var g=arguments[f];g&&(h=d(h,u(g)))}return h}function u(h){if(typeof h=="string"||typeof h=="number")return h;if(typeof h!="object")return"";if(Array.isArray(h))return c.apply(null,h);if(h.toString!==Object.prototype.toString&&!h.toString.toString().includes("[native code]"))return h.toString();var f="";for(var g in h)s.call(h,g)&&h[g]&&(f=d(f,g));return f}function d(h,f){return f?h?h+" "+f:h+f:h}a.exports?(c.default=c,a.exports=c):window.classNames=c})()})(classnames)),classnames.exports}requireClassnames();function _extends(){return _extends=Object.assign?Object.assign.bind():function(a){for(var s=1;s<arguments.length;s++){var c=arguments[s];for(var u in c)({}).hasOwnProperty.call(c,u)&&(a[u]=c[u])}return a},_extends.apply(null,arguments)}function _objectWithoutPropertiesLoose$1(a,s){if(a==null)return{};var c={};for(var u in a)if({}.hasOwnProperty.call(a,u)){if(s.indexOf(u)!==-1)continue;c[u]=a[u]}return c}function _objectWithoutProperties$1(a,s){if(a==null)return{};var c,u,d=_objectWithoutPropertiesLoose$1(a,s);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(a);for(u=0;u<h.length;u++)c=h[u],s.indexOf(c)===-1&&{}.propertyIsEnumerable.call(a,c)&&(d[c]=a[c])}return d}function _OverloadYield(a,s){this.v=a,this.k=s}function _regeneratorDefine(a,s,c,u){var d=Object.defineProperty;try{d({},"",{})}catch{d=0}_regeneratorDefine=function(f,g,m,p){function v(w,E){_regeneratorDefine(f,w,function(C){return this._invoke(w,E,C)})}g?d?d(f,g,{value:m,enumerable:!p,configurable:!p,writable:!p}):f[g]=m:(v("next",0),v("throw",1),v("return",2))},_regeneratorDefine(a,s,c,u)}function _regenerator(){var a,s,c=typeof Symbol=="function"?Symbol:{},u=c.iterator||"@@iterator",d=c.toStringTag||"@@toStringTag";function h(C,b,P,R){var T=b&&b.prototype instanceof g?b:g,I=Object.create(T.prototype);return _regeneratorDefine(I,"_invoke",(function(M,N,H){var L,A,k,W=0,G=H||[],oe=!1,ae={p:0,n:0,v:a,a:X,f:X.bind(a,4),d:function(ye,pe){return L=ye,A=0,k=a,ae.n=pe,f}};function X(le,ye){for(A=le,k=ye,s=0;!oe&&W&&!pe&&s<G.length;s++){var pe,he=G[s],Me=ae.p,Qe=he[2];le>3?(pe=Qe===ye)&&(k=he[(A=he[4])?5:(A=3,3)],he[4]=he[5]=a):he[0]<=Me&&((pe=le<2&&Me<he[1])?(A=0,ae.v=ye,ae.n=he[1]):Me<Qe&&(pe=le<3||he[0]>ye||ye>Qe)&&(he[4]=le,he[5]=ye,ae.n=Qe,A=0))}if(pe||le>1)return f;throw oe=!0,ye}return function(le,ye,pe){if(W>1)throw TypeError("Generator is already running");for(oe&&ye===1&&X(ye,pe),A=ye,k=pe;(s=A<2?a:k)||!oe;){L||(A?A<3?(A>1&&(ae.n=-1),X(A,k)):ae.n=k:ae.v=k);try{if(W=2,L){if(A||(le="next"),s=L[le]){if(!(s=s.call(L,k)))throw TypeError("iterator result is not an object");if(!s.done)return s;k=s.value,A<2&&(A=0)}else A===1&&(s=L.return)&&s.call(L),A<2&&(k=TypeError("The iterator does not provide a '"+le+"' method"),A=1);L=a}else if((s=(oe=ae.n<0)?k:M.call(N,ae))!==f)break}catch(he){L=a,A=1,k=he}finally{W=1}}return{value:s,done:oe}}})(C,P,R),!0),I}var f={};function g(){}function m(){}function p(){}s=Object.getPrototypeOf;var v=[][u]?s(s([][u]())):(_regeneratorDefine(s={},u,function(){return this}),s),w=p.prototype=g.prototype=Object.create(v);function E(C){return Object.setPrototypeOf?Object.setPrototypeOf(C,p):(C.__proto__=p,_regeneratorDefine(C,d,"GeneratorFunction")),C.prototype=Object.create(w),C}return m.prototype=p,_regeneratorDefine(w,"constructor",p),_regeneratorDefine(p,"constructor",m),m.displayName="GeneratorFunction",_regeneratorDefine(p,d,"GeneratorFunction"),_regeneratorDefine(w),_regeneratorDefine(w,d,"Generator"),_regeneratorDefine(w,u,function(){return this}),_regeneratorDefine(w,"toString",function(){return"[object Generator]"}),(_regenerator=function(){return{w:h,m:E}})()}function AsyncIterator(a,s){function c(d,h,f,g){try{var m=a[d](h),p=m.value;return p instanceof _OverloadYield?s.resolve(p.v).then(function(v){c("next",v,f,g)},function(v){c("throw",v,f,g)}):s.resolve(p).then(function(v){m.value=v,f(m)},function(v){return c("throw",v,f,g)})}catch(v){g(v)}}var u;this.next||(_regeneratorDefine(AsyncIterator.prototype),_regeneratorDefine(AsyncIterator.prototype,typeof Symbol=="function"&&Symbol.asyncIterator||"@asyncIterator",function(){return this})),_regeneratorDefine(this,"_invoke",function(d,h,f){function g(){return new s(function(m,p){c(d,f,m,p)})}return u=u?u.then(g,g):g()},!0)}function _regeneratorAsyncGen(a,s,c,u,d){return new AsyncIterator(_regenerator().w(a,s,c,u),d||Promise)}function _regeneratorAsync(a,s,c,u,d){var h=_regeneratorAsyncGen(a,s,c,u,d);return h.next().then(function(f){return f.done?f.value:h.next()})}function _regeneratorKeys(a){var s=Object(a),c=[];for(var u in s)c.unshift(u);return function d(){for(;c.length;)if((u=c.pop())in s)return d.value=u,d.done=!1,d;return d.done=!0,d}}function _typeof(a){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(s){return typeof s}:function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},_typeof(a)}function _regeneratorValues(a){if(a!=null){var s=a[typeof Symbol=="function"&&Symbol.iterator||"@@iterator"],c=0;if(s)return s.call(a);if(typeof a.next=="function")return a;if(!isNaN(a.length))return{next:function(){return a&&c>=a.length&&(a=void 0),{value:a&&a[c++],done:!a}}}}throw new TypeError(_typeof(a)+" is not iterable")}function _regeneratorRuntime(){var a=_regenerator(),s=a.m(_regeneratorRuntime),c=(Object.getPrototypeOf?Object.getPrototypeOf(s):s.__proto__).constructor;function u(f){var g=typeof f=="function"&&f.constructor;return!!g&&(g===c||(g.displayName||g.name)==="GeneratorFunction")}var d={throw:1,return:2,break:3,continue:3};function h(f){var g,m;return function(p){g||(g={stop:function(){return m(p.a,2)},catch:function(){return p.v},abrupt:function(w,E){return m(p.a,d[w],E)},delegateYield:function(w,E,C){return g.resultName=E,m(p.d,_regeneratorValues(w),C)},finish:function(w){return m(p.f,w)}},m=function(w,E,C){p.p=g.prev,p.n=g.next;try{return w(E,C)}finally{g.next=p.n}}),g.resultName&&(g[g.resultName]=p.v,g.resultName=void 0),g.sent=p.v,g.next=p.n;try{return f.call(this,g)}finally{p.p=g.prev,p.n=g.next}}}return(_regeneratorRuntime=function(){return{wrap:function(m,p,v,w){return a.w(h(m),p,v,w&&w.reverse())},isGeneratorFunction:u,mark:a.m,awrap:function(m,p){return new _OverloadYield(m,p)},AsyncIterator,async:function(m,p,v,w,E){return(u(p)?_regeneratorAsyncGen:_regeneratorAsync)(h(m),p,v,w,E)},keys:_regeneratorKeys,values:_regeneratorValues}})()}function asyncGeneratorStep(a,s,c,u,d,h,f){try{var g=a[h](f),m=g.value}catch(p){return void c(p)}g.done?s(m):Promise.resolve(m).then(u,d)}function _asyncToGenerator(a){return function(){var s=this,c=arguments;return new Promise(function(u,d){var h=a.apply(s,c);function f(m){asyncGeneratorStep(h,u,d,f,g,"next",m)}function g(m){asyncGeneratorStep(h,u,d,f,g,"throw",m)}f(void 0)})}}function toPrimitive$1(a,s){if(_typeof(a)!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(_typeof(u)!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function toPropertyKey$1(a){var s=toPrimitive$1(a,"string");return _typeof(s)=="symbol"?s:s+""}function _defineProperty$2f(a,s,c){return(s=toPropertyKey$1(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function ownKeys$1(a,s){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var u=Object.getOwnPropertySymbols(a);s&&(u=u.filter(function(d){return Object.getOwnPropertyDescriptor(a,d).enumerable})),c.push.apply(c,u)}return c}function _objectSpread2(a){for(var s=1;s<arguments.length;s++){var c=arguments[s]!=null?arguments[s]:{};s%2?ownKeys$1(Object(c),!0).forEach(function(u){_defineProperty$2f(a,u,c[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(c)):ownKeys$1(Object(c)).forEach(function(u){Object.defineProperty(a,u,Object.getOwnPropertyDescriptor(c,u))})}return a}function _arrayLikeToArray$1(a,s){(s==null||s>a.length)&&(s=a.length);for(var c=0,u=Array(s);c<s;c++)u[c]=a[c];return u}function _arrayWithoutHoles$1(a){if(Array.isArray(a))return _arrayLikeToArray$1(a)}function _iterableToArray$1(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function _unsupportedIterableToArray$1(a,s){if(a){if(typeof a=="string")return _arrayLikeToArray$1(a,s);var c={}.toString.call(a).slice(8,-1);return c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set"?Array.from(a):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray$1(a,s):void 0}}function _nonIterableSpread$1(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toConsumableArray$1(a){return _arrayWithoutHoles$1(a)||_iterableToArray$1(a)||_unsupportedIterableToArray$1(a)||_nonIterableSpread$1()}function _classCallCheck$1(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties$1(a,s){for(var c=0;c<s.length;c++){var u=s[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,toPropertyKey$1(u.key),u)}}function _createClass$1(a,s,c){return s&&_defineProperties$1(a.prototype,s),Object.defineProperty(a,"prototype",{writable:!1}),a}function _assertThisInitialized$1(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _setPrototypeOf$1(a,s){return _setPrototypeOf$1=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,u){return c.__proto__=u,c},_setPrototypeOf$1(a,s)}function _inherits$1(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),s&&_setPrototypeOf$1(a,s)}function _getPrototypeOf$1(a){return _getPrototypeOf$1=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},_getPrototypeOf$1(a)}function _isNativeReflectConstruct$1(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct$1=function(){return!!a})()}function _possibleConstructorReturn$1(a,s){if(s&&(_typeof(s)=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized$1(a)}function _createSuper(a){var s=_isNativeReflectConstruct$1();return function(){var c,u=_getPrototypeOf$1(a);if(s){var d=_getPrototypeOf$1(this).constructor;c=Reflect.construct(u,arguments,d)}else c=u.apply(this,arguments);return _possibleConstructorReturn$1(this,c)}}var REACT_ELEMENT_TYPE_18=Symbol.for("react.element"),REACT_ELEMENT_TYPE_19=Symbol.for("react.transitional.element"),REACT_FRAGMENT_TYPE=Symbol.for("react.fragment");function isFragment(a){return a&&_typeof(a)==="object"&&(a.$$typeof===REACT_ELEMENT_TYPE_18||a.$$typeof===REACT_ELEMENT_TYPE_19)&&a.type===REACT_FRAGMENT_TYPE}function toArray$3(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=[];return React.Children.forEach(a,function(u){u==null&&!s.keepEmpty||(Array.isArray(u)?c=c.concat(toArray$3(u)):isFragment(u)&&u.props?c=c.concat(toArray$3(u.props.children,s)):c.push(u))}),c}var warned={},preMessage=function(s){};function warning$1(a,s){}function note(a,s){}function resetWarned(){warned={}}function call(a,s,c){!s&&!warned[c]&&(a(!1,c),warned[c]=!0)}function warningOnce(a,s){call(warning$1,a,s)}function noteOnce(a,s){call(note,a,s)}warningOnce.preMessage=preMessage,warningOnce.resetWarned=resetWarned,warningOnce.noteOnce=noteOnce;function isEqual(a,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,u=new Set;function d(h,f){var g=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,m=u.has(h);if(warningOnce(!m,"Warning: There may be circular references"),m)return!1;if(h===f)return!0;if(c&&g>1)return!1;u.add(h);var p=g+1;if(Array.isArray(h)){if(!Array.isArray(f)||h.length!==f.length)return!1;for(var v=0;v<h.length;v++)if(!d(h[v],f[v],p))return!1;return!0}if(h&&f&&_typeof(h)==="object"&&_typeof(f)==="object"){var w=Object.keys(h);return w.length!==Object.keys(f).length?!1:w.every(function(E){return d(h[E],f[E],p)})}return!1}return d(a,s)}var HOOK_MARK="RC_FORM_INTERNAL_HOOKS",warningFunc=function(){warningOnce(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Context=React__namespace.createContext({getFieldValue:warningFunc,getFieldsValue:warningFunc,getFieldError:warningFunc,getFieldWarning:warningFunc,getFieldsError:warningFunc,isFieldsTouched:warningFunc,isFieldTouched:warningFunc,isFieldValidating:warningFunc,isFieldsValidating:warningFunc,resetFields:warningFunc,setFields:warningFunc,setFieldValue:warningFunc,setFieldsValue:warningFunc,validateFields:warningFunc,submit:warningFunc,getInternalHooks:function(){return warningFunc(),{dispatch:warningFunc,initEntityValue:warningFunc,registerField:warningFunc,useSubscribe:warningFunc,setInitialValues:warningFunc,destroyForm:warningFunc,setCallbacks:warningFunc,registerWatch:warningFunc,getFields:warningFunc,setValidateMessages:warningFunc,setPreserve:warningFunc,getInitialValue:warningFunc}}}),ListContext=React__namespace.createContext(null);function toArray$2(a){return a==null?[]:Array.isArray(a)?a:[a]}function isFormInstance(a){return a&&!!a._init}function newMessages(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var s=JSON.parse(JSON.stringify(this));return s.clone=this.clone,s}}}var messages=newMessages();function _isNativeFunction(a){try{return Function.toString.call(a).indexOf("[native code]")!==-1}catch{return typeof a=="function"}}function _construct(a,s,c){if(_isNativeReflectConstruct$1())return Reflect.construct.apply(null,arguments);var u=[null];u.push.apply(u,s);var d=new(a.bind.apply(a,u));return c&&_setPrototypeOf$1(d,c.prototype),d}function _wrapNativeSuper(a){var s=typeof Map=="function"?new Map:void 0;return _wrapNativeSuper=function(u){if(u===null||!_isNativeFunction(u))return u;if(typeof u!="function")throw new TypeError("Super expression must either be null or a function");if(s!==void 0){if(s.has(u))return s.get(u);s.set(u,d)}function d(){return _construct(u,arguments,_getPrototypeOf$1(this).constructor)}return d.prototype=Object.create(u.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf$1(d,u)},_wrapNativeSuper(a)}var formatRegExp=/%[sdj%]/g,warning=function(){};typeof process<"u"&&process.env;function convertFieldsError(a){if(!a||!a.length)return null;var s={};return a.forEach(function(c){var u=c.field;s[u]=s[u]||[],s[u].push(c)}),s}function format$2(a){for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];var d=0,h=c.length;if(typeof a=="function")return a.apply(null,c);if(typeof a=="string"){var f=a.replace(formatRegExp,function(g){if(g==="%%")return"%";if(d>=h)return g;switch(g){case"%s":return String(c[d++]);case"%d":return Number(c[d++]);case"%j":try{return JSON.stringify(c[d++])}catch{return"[Circular]"}break;default:return g}});return f}return a}function isNativeStringType(a){return a==="string"||a==="url"||a==="hex"||a==="email"||a==="date"||a==="pattern"}function isEmptyValue(a,s){return!!(a==null||s==="array"&&Array.isArray(a)&&!a.length||isNativeStringType(s)&&typeof a=="string"&&!a)}function asyncParallelArray(a,s,c){var u=[],d=0,h=a.length;function f(g){u.push.apply(u,_toConsumableArray$1(g||[])),d++,d===h&&c(u)}a.forEach(function(g){s(g,f)})}function asyncSerialArray(a,s,c){var u=0,d=a.length;function h(f){if(f&&f.length){c(f);return}var g=u;u=u+1,g<d?s(a[g],h):c([])}h([])}function flattenObjArr(a){var s=[];return Object.keys(a).forEach(function(c){s.push.apply(s,_toConsumableArray$1(a[c]||[]))}),s}var AsyncValidationError=(function(a){_inherits$1(c,a);var s=_createSuper(c);function c(u,d){var h;return _classCallCheck$1(this,c),h=s.call(this,"Async Validation Error"),_defineProperty$2f(_assertThisInitialized$1(h),"errors",void 0),_defineProperty$2f(_assertThisInitialized$1(h),"fields",void 0),h.errors=u,h.fields=d,h}return _createClass$1(c)})(_wrapNativeSuper(Error));function asyncMap(a,s,c,u,d){if(s.first){var h=new Promise(function(E,C){var b=function(T){return u(T),T.length?C(new AsyncValidationError(T,convertFieldsError(T))):E(d)},P=flattenObjArr(a);asyncSerialArray(P,c,b)});return h.catch(function(E){return E}),h}var f=s.firstFields===!0?Object.keys(a):s.firstFields||[],g=Object.keys(a),m=g.length,p=0,v=[],w=new Promise(function(E,C){var b=function(R){if(v.push.apply(v,R),p++,p===m)return u(v),v.length?C(new AsyncValidationError(v,convertFieldsError(v))):E(d)};g.length||(u(v),E(d)),g.forEach(function(P){var R=a[P];f.indexOf(P)!==-1?asyncSerialArray(R,c,b):asyncParallelArray(R,c,b)})});return w.catch(function(E){return E}),w}function isErrorObj(a){return!!(a&&a.message!==void 0)}function getValue(a,s){for(var c=a,u=0;u<s.length;u++){if(c==null)return c;c=c[s[u]]}return c}function complementError(a,s){return function(c){var u;return a.fullFields?u=getValue(s,a.fullFields):u=s[c.field||a.fullField],isErrorObj(c)?(c.field=c.field||a.fullField,c.fieldValue=u,c):{message:typeof c=="function"?c():c,fieldValue:u,field:c.field||a.fullField}}}function deepMerge(a,s){if(s){for(var c in s)if(s.hasOwnProperty(c)){var u=s[c];_typeof(u)==="object"&&_typeof(a[c])==="object"?a[c]=_objectSpread2(_objectSpread2({},a[c]),u):a[c]=u}}return a}var ENUM$1="enum",enumerable$1=function(s,c,u,d,h){s[ENUM$1]=Array.isArray(s[ENUM$1])?s[ENUM$1]:[],s[ENUM$1].indexOf(c)===-1&&d.push(format$2(h.messages[ENUM$1],s.fullField,s[ENUM$1].join(", ")))},pattern$2=function(s,c,u,d,h){if(s.pattern){if(s.pattern instanceof RegExp)s.pattern.lastIndex=0,s.pattern.test(c)||d.push(format$2(h.messages.pattern.mismatch,s.fullField,c,s.pattern));else if(typeof s.pattern=="string"){var f=new RegExp(s.pattern);f.test(c)||d.push(format$2(h.messages.pattern.mismatch,s.fullField,c,s.pattern))}}},range=function(s,c,u,d,h){var f=typeof s.len=="number",g=typeof s.min=="number",m=typeof s.max=="number",p=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,v=c,w=null,E=typeof c=="number",C=typeof c=="string",b=Array.isArray(c);if(E?w="number":C?w="string":b&&(w="array"),!w)return!1;b&&(v=c.length),C&&(v=c.replace(p,"_").length),f?v!==s.len&&d.push(format$2(h.messages[w].len,s.fullField,s.len)):g&&!m&&v<s.min?d.push(format$2(h.messages[w].min,s.fullField,s.min)):m&&!g&&v>s.max?d.push(format$2(h.messages[w].max,s.fullField,s.max)):g&&m&&(v<s.min||v>s.max)&&d.push(format$2(h.messages[w].range,s.fullField,s.min,s.max))},required$1=function(s,c,u,d,h,f){s.required&&(!u.hasOwnProperty(s.field)||isEmptyValue(c,f||s.type))&&d.push(format$2(h.messages.required,s.fullField))},urlReg;const getUrlRegex=(function(){if(urlReg)return urlReg;var a="[a-fA-F\\d:]",s=function(L){return L&&L.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(a,")|(?<=").concat(a,")(?=\\s|$))"):""},c="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",u="[a-fA-F\\d]{1,4}",d=["(?:".concat(u,":){7}(?:").concat(u,"|:)"),"(?:".concat(u,":){6}(?:").concat(c,"|:").concat(u,"|:)"),"(?:".concat(u,":){5}(?::").concat(c,"|(?::").concat(u,"){1,2}|:)"),"(?:".concat(u,":){4}(?:(?::").concat(u,"){0,1}:").concat(c,"|(?::").concat(u,"){1,3}|:)"),"(?:".concat(u,":){3}(?:(?::").concat(u,"){0,2}:").concat(c,"|(?::").concat(u,"){1,4}|:)"),"(?:".concat(u,":){2}(?:(?::").concat(u,"){0,3}:").concat(c,"|(?::").concat(u,"){1,5}|:)"),"(?:".concat(u,":){1}(?:(?::").concat(u,"){0,4}:").concat(c,"|(?::").concat(u,"){1,6}|:)"),"(?::(?:(?::".concat(u,"){0,5}:").concat(c,"|(?::").concat(u,"){1,7}|:))")],h="(?:%[0-9a-zA-Z]{1,})?",f="(?:".concat(d.join("|"),")").concat(h),g=new RegExp("(?:^".concat(c,"$)|(?:^").concat(f,"$)")),m=new RegExp("^".concat(c,"$")),p=new RegExp("^".concat(f,"$")),v=function(L){return L&&L.exact?g:new RegExp("(?:".concat(s(L)).concat(c).concat(s(L),")|(?:").concat(s(L)).concat(f).concat(s(L),")"),"g")};v.v4=function(H){return H&&H.exact?m:new RegExp("".concat(s(H)).concat(c).concat(s(H)),"g")},v.v6=function(H){return H&&H.exact?p:new RegExp("".concat(s(H)).concat(f).concat(s(H)),"g")};var w="(?:(?:[a-z]+:)?//)",E="(?:\\S+(?::\\S*)?@)?",C=v.v4().source,b=v.v6().source,P="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",R="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",T="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",I="(?::\\d{2,5})?",M='(?:[/?#][^\\s"]*)?',N="(?:".concat(w,"|www\\.)").concat(E,"(?:localhost|").concat(C,"|").concat(b,"|").concat(P).concat(R).concat(T,")").concat(I).concat(M);return urlReg=new RegExp("(?:^".concat(N,"$)"),"i"),urlReg});var pattern$1={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},types={integer:function(s){return types.number(s)&&parseInt(s,10)===s},float:function(s){return types.number(s)&&!types.integer(s)},array:function(s){return Array.isArray(s)},regexp:function(s){if(s instanceof RegExp)return!0;try{return!!new RegExp(s)}catch{return!1}},date:function(s){return typeof s.getTime=="function"&&typeof s.getMonth=="function"&&typeof s.getYear=="function"&&!isNaN(s.getTime())},number:function(s){return isNaN(s)?!1:typeof s=="number"},object:function(s){return _typeof(s)==="object"&&!types.array(s)},method:function(s){return typeof s=="function"},email:function(s){return typeof s=="string"&&s.length<=320&&!!s.match(pattern$1.email)},url:function(s){return typeof s=="string"&&s.length<=2048&&!!s.match(getUrlRegex())},hex:function(s){return typeof s=="string"&&!!s.match(pattern$1.hex)}},type$1=function(s,c,u,d,h){if(s.required&&c===void 0){required$1(s,c,u,d,h);return}var f=["integer","float","array","regexp","object","method","email","number","date","url","hex"],g=s.type;f.indexOf(g)>-1?types[g](c)||d.push(format$2(h.messages.types[g],s.fullField,s.type)):g&&_typeof(c)!==s.type&&d.push(format$2(h.messages.types[g],s.fullField,s.type))},whitespace=function(s,c,u,d,h){(/^\s+$/.test(c)||c==="")&&d.push(format$2(h.messages.whitespace,s.fullField))};const rules={required:required$1,whitespace,type:type$1,range,enum:enumerable$1,pattern:pattern$2};var any=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h)}u(f)},array=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(c==null&&!s.required)return u();rules.required(s,c,d,f,h,"array"),c!=null&&(rules.type(s,c,d,f,h),rules.range(s,c,d,f,h))}u(f)},boolean=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&rules.type(s,c,d,f,h)}u(f)},date=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c,"date")&&!s.required)return u();if(rules.required(s,c,d,f,h),!isEmptyValue(c,"date")){var m;c instanceof Date?m=c:m=new Date(c),rules.type(s,m,d,f,h),m&&rules.range(s,m.getTime(),d,f,h)}}u(f)},ENUM="enum",enumerable=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&rules[ENUM](s,c,d,f,h)}u(f)},floatFn=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&(rules.type(s,c,d,f,h),rules.range(s,c,d,f,h))}u(f)},integer=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&(rules.type(s,c,d,f,h),rules.range(s,c,d,f,h))}u(f)},method=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&rules.type(s,c,d,f,h)}u(f)},number=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(c===""&&(c=void 0),isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&(rules.type(s,c,d,f,h),rules.range(s,c,d,f,h))}u(f)},object=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),c!==void 0&&rules.type(s,c,d,f,h)}u(f)},pattern=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c,"string")&&!s.required)return u();rules.required(s,c,d,f,h),isEmptyValue(c,"string")||rules.pattern(s,c,d,f,h)}u(f)},regexp=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c)&&!s.required)return u();rules.required(s,c,d,f,h),isEmptyValue(c)||rules.type(s,c,d,f,h)}u(f)},required=function(s,c,u,d,h){var f=[],g=Array.isArray(c)?"array":_typeof(c);rules.required(s,c,d,f,h,g),u(f)},string=function(s,c,u,d,h){var f=[],g=s.required||!s.required&&d.hasOwnProperty(s.field);if(g){if(isEmptyValue(c,"string")&&!s.required)return u();rules.required(s,c,d,f,h,"string"),isEmptyValue(c,"string")||(rules.type(s,c,d,f,h),rules.range(s,c,d,f,h),rules.pattern(s,c,d,f,h),s.whitespace===!0&&rules.whitespace(s,c,d,f,h))}u(f)},type=function(s,c,u,d,h){var f=s.type,g=[],m=s.required||!s.required&&d.hasOwnProperty(s.field);if(m){if(isEmptyValue(c,f)&&!s.required)return u();rules.required(s,c,d,g,h,f),isEmptyValue(c,f)||rules.type(s,c,d,g,h)}u(g)};const validators={string,method,number,boolean,regexp,integer,float:floatFn,array,object,enum:enumerable,pattern,date,url:type,hex:type,email:type,required,any};var Schema=(function(){function a(s){_classCallCheck$1(this,a),_defineProperty$2f(this,"rules",null),_defineProperty$2f(this,"_messages",messages),this.define(s)}return _createClass$1(a,[{key:"define",value:function(c){var u=this;if(!c)throw new Error("Cannot configure a schema with no rules");if(_typeof(c)!=="object"||Array.isArray(c))throw new Error("Rules must be an object");this.rules={},Object.keys(c).forEach(function(d){var h=c[d];u.rules[d]=Array.isArray(h)?h:[h]})}},{key:"messages",value:function(c){return c&&(this._messages=deepMerge(newMessages(),c)),this._messages}},{key:"validate",value:function(c){var u=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},f=c,g=d,m=h;if(typeof g=="function"&&(m=g,g={}),!this.rules||Object.keys(this.rules).length===0)return m&&m(null,f),Promise.resolve(f);function p(b){var P=[],R={};function T(M){if(Array.isArray(M)){var N;P=(N=P).concat.apply(N,_toConsumableArray$1(M))}else P.push(M)}for(var I=0;I<b.length;I++)T(b[I]);P.length?(R=convertFieldsError(P),m(P,R)):m(null,f)}if(g.messages){var v=this.messages();v===messages&&(v=newMessages()),deepMerge(v,g.messages),g.messages=v}else g.messages=this.messages();var w={},E=g.keys||Object.keys(this.rules);E.forEach(function(b){var P=u.rules[b],R=f[b];P.forEach(function(T){var I=T;typeof I.transform=="function"&&(f===c&&(f=_objectSpread2({},f)),R=f[b]=I.transform(R),R!=null&&(I.type=I.type||(Array.isArray(R)?"array":_typeof(R)))),typeof I=="function"?I={validator:I}:I=_objectSpread2({},I),I.validator=u.getValidationMethod(I),I.validator&&(I.field=b,I.fullField=I.fullField||b,I.type=u.getType(I),w[b]=w[b]||[],w[b].push({rule:I,value:R,source:f,field:b}))})});var C={};return asyncMap(w,g,function(b,P){var R=b.rule,T=(R.type==="object"||R.type==="array")&&(_typeof(R.fields)==="object"||_typeof(R.defaultField)==="object");T=T&&(R.required||!R.required&&b.value),R.field=b.field;function I(A,k){return _objectSpread2(_objectSpread2({},k),{},{fullField:"".concat(R.fullField,".").concat(A),fullFields:R.fullFields?[].concat(_toConsumableArray$1(R.fullFields),[A]):[A]})}function M(){var A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],k=Array.isArray(A)?A:[A];!g.suppressWarning&&k.length&&a.warning("async-validator:",k),k.length&&R.message!==void 0&&(k=[].concat(R.message));var W=k.map(complementError(R,f));if(g.first&&W.length)return C[R.field]=1,P(W);if(!T)P(W);else{if(R.required&&!b.value)return R.message!==void 0?W=[].concat(R.message).map(complementError(R,f)):g.error&&(W=[g.error(R,format$2(g.messages.required,R.field))]),P(W);var G={};R.defaultField&&Object.keys(b.value).map(function(X){G[X]=R.defaultField}),G=_objectSpread2(_objectSpread2({},G),b.rule.fields);var oe={};Object.keys(G).forEach(function(X){var le=G[X],ye=Array.isArray(le)?le:[le];oe[X]=ye.map(I.bind(null,X))});var ae=new a(oe);ae.messages(g.messages),b.rule.options&&(b.rule.options.messages=g.messages,b.rule.options.error=g.error),ae.validate(b.value,b.rule.options||g,function(X){var le=[];W&&W.length&&le.push.apply(le,_toConsumableArray$1(W)),X&&X.length&&le.push.apply(le,_toConsumableArray$1(X)),P(le.length?le:null)})}}var N;if(R.asyncValidator)N=R.asyncValidator(R,b.value,M,b.source,g);else if(R.validator){try{N=R.validator(R,b.value,M,b.source,g)}catch(A){var H,L;(H=(L=console).error)===null||H===void 0||H.call(L,A),g.suppressValidatorError||setTimeout(function(){throw A},0),M(A.message)}N===!0?M():N===!1?M(typeof R.message=="function"?R.message(R.fullField||R.field):R.message||"".concat(R.fullField||R.field," fails")):N instanceof Array?M(N):N instanceof Error&&M(N.message)}N&&N.then&&N.then(function(){return M()},function(A){return M(A)})},function(b){p(b)},f)}},{key:"getType",value:function(c){if(c.type===void 0&&c.pattern instanceof RegExp&&(c.type="pattern"),typeof c.validator!="function"&&c.type&&!validators.hasOwnProperty(c.type))throw new Error(format$2("Unknown rule type %s",c.type));return c.type||"string"}},{key:"getValidationMethod",value:function(c){if(typeof c.validator=="function")return c.validator;var u=Object.keys(c),d=u.indexOf("message");return d!==-1&&u.splice(d,1),u.length===1&&u[0]==="required"?validators.required:validators[this.getType(c)]||void 0}}]),a})();_defineProperty$2f(Schema,"register",function(s,c){if(typeof c!="function")throw new Error("Cannot register a validator by type, validator is not a function");validators[s]=c}),_defineProperty$2f(Schema,"warning",warning),_defineProperty$2f(Schema,"messages",messages),_defineProperty$2f(Schema,"validators",validators);var typeTemplate="'${name}' is not a valid ${type}",defaultValidateMessages={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:typeTemplate,method:typeTemplate,array:typeTemplate,object:typeTemplate,number:typeTemplate,date:typeTemplate,boolean:typeTemplate,integer:typeTemplate,float:typeTemplate,regexp:typeTemplate,email:typeTemplate,url:typeTemplate,hex:typeTemplate},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}};function _arrayWithHoles$1(a){if(Array.isArray(a))return a}function _nonIterableRest$1(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _toArray(a){return _arrayWithHoles$1(a)||_iterableToArray$1(a)||_unsupportedIterableToArray$1(a)||_nonIterableRest$1()}function get$3(a,s){for(var c=a,u=0;u<s.length;u+=1){if(c==null)return;c=c[s[u]]}return c}function internalSet(a,s,c,u){if(!s.length)return c;var d=_toArray(s),h=d[0],f=d.slice(1),g;return!a&&typeof h=="number"?g=[]:Array.isArray(a)?g=_toConsumableArray$1(a):g=_objectSpread2({},a),u&&c===void 0&&f.length===1?delete g[h][f[0]]:g[h]=internalSet(g[h],f,c,u),g}function set$2(a,s,c){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return s.length&&u&&c===void 0&&!get$3(a,s.slice(0,-1))?a:internalSet(a,s,c,u)}function isObject$3(a){return _typeof(a)==="object"&&a!==null&&Object.getPrototypeOf(a)===Object.prototype}function createEmpty(a){return Array.isArray(a)?[]:{}}var keys$1=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function merge(){for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=createEmpty(s[0]);return s.forEach(function(d){function h(f,g){var m=new Set(g),p=get$3(d,f),v=Array.isArray(p);if(v||isObject$3(p)){if(!m.has(p)){m.add(p);var w=get$3(u,f);v?u=set$2(u,f,[]):(!w||_typeof(w)!=="object")&&(u=set$2(u,f,createEmpty(p))),keys$1(p).forEach(function(E){h([].concat(_toConsumableArray$1(f),[E]),m)})}}else u=set$2(u,f,p)}h([])}),u}var AsyncValidator=Schema;function replaceMessage(a,s){return a.replace(/\\?\$\{\w+\}/g,function(c){if(c.startsWith("\\"))return c.slice(1);var u=c.slice(2,-1);return s[u]})}var CODE_LOGIC_ERROR="CODE_LOGIC_ERROR";function validateRule(a,s,c,u,d){return _validateRule.apply(this,arguments)}function _validateRule(){return _validateRule=_asyncToGenerator(_regeneratorRuntime().mark(function a(s,c,u,d,h){var f,g,m,p,v,w,E,C,b;return _regeneratorRuntime().wrap(function(R){for(;;)switch(R.prev=R.next){case 0:return f=_objectSpread2({},u),delete f.ruleIndex,AsyncValidator.warning=function(){},f.validator&&(g=f.validator,f.validator=function(){try{return g.apply(void 0,arguments)}catch(T){return console.error(T),Promise.reject(CODE_LOGIC_ERROR)}}),m=null,f&&f.type==="array"&&f.defaultField&&(m=f.defaultField,delete f.defaultField),p=new AsyncValidator(_defineProperty$2f({},s,[f])),v=merge(defaultValidateMessages,d.validateMessages),p.messages(v),w=[],R.prev=10,R.next=13,Promise.resolve(p.validate(_defineProperty$2f({},s,c),_objectSpread2({},d)));case 13:R.next=18;break;case 15:R.prev=15,R.t0=R.catch(10),R.t0.errors&&(w=R.t0.errors.map(function(T,I){var M=T.message,N=M===CODE_LOGIC_ERROR?v.default:M;return React__namespace.isValidElement(N)?React__namespace.cloneElement(N,{key:"error_".concat(I)}):N}));case 18:if(!(!w.length&&m&&Array.isArray(c)&&c.length>0)){R.next=23;break}return R.next=21,Promise.all(c.map(function(T,I){return validateRule("".concat(s,".").concat(I),T,m,d,h)}));case 21:return E=R.sent,R.abrupt("return",E.reduce(function(T,I){return[].concat(_toConsumableArray$1(T),_toConsumableArray$1(I))},[]));case 23:return C=_objectSpread2(_objectSpread2({},u),{},{name:s,enum:(u.enum||[]).join(", ")},h),b=w.map(function(T){return typeof T=="string"?replaceMessage(T,C):T}),R.abrupt("return",b);case 26:case"end":return R.stop()}},a,null,[[10,15]])})),_validateRule.apply(this,arguments)}function validateRules(a,s,c,u,d,h){var f=a.join("."),g=c.map(function(v,w){var E=v.validator,C=_objectSpread2(_objectSpread2({},v),{},{ruleIndex:w});return E&&(C.validator=function(b,P,R){var T=!1,I=function(){for(var H=arguments.length,L=new Array(H),A=0;A<H;A++)L[A]=arguments[A];Promise.resolve().then(function(){warningOnce(!T,"Your validator function has already return a promise. `callback` will be ignored."),T||R.apply(void 0,L)})},M=E(b,P,I);T=M&&typeof M.then=="function"&&typeof M.catch=="function",warningOnce(T,"`callback` is deprecated. Please return a promise instead."),T&&M.then(function(){R()}).catch(function(N){R(N||" ")})}),C}).sort(function(v,w){var E=v.warningOnly,C=v.ruleIndex,b=w.warningOnly,P=w.ruleIndex;return!!E==!!b?C-P:E?1:-1}),m;if(d===!0)m=new Promise((function(){var v=_asyncToGenerator(_regeneratorRuntime().mark(function w(E,C){var b,P,R;return _regeneratorRuntime().wrap(function(I){for(;;)switch(I.prev=I.next){case 0:b=0;case 1:if(!(b<g.length)){I.next=12;break}return P=g[b],I.next=5,validateRule(f,s,P,u,h);case 5:if(R=I.sent,!R.length){I.next=9;break}return C([{errors:R,rule:P}]),I.abrupt("return");case 9:b+=1,I.next=1;break;case 12:E([]);case 13:case"end":return I.stop()}},w)}));return function(w,E){return v.apply(this,arguments)}})());else{var p=g.map(function(v){return validateRule(f,s,v,u,h).then(function(w){return{errors:w,rule:v}})});m=(d?finishOnFirstFailed(p):finishOnAllFailed(p)).then(function(v){return Promise.reject(v)})}return m.catch(function(v){return v}),m}function finishOnAllFailed(a){return _finishOnAllFailed.apply(this,arguments)}function _finishOnAllFailed(){return _finishOnAllFailed=_asyncToGenerator(_regeneratorRuntime().mark(function a(s){return _regeneratorRuntime().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.abrupt("return",Promise.all(s).then(function(d){var h,f=(h=[]).concat.apply(h,_toConsumableArray$1(d));return f}));case 1:case"end":return u.stop()}},a)})),_finishOnAllFailed.apply(this,arguments)}function finishOnFirstFailed(a){return _finishOnFirstFailed.apply(this,arguments)}function _finishOnFirstFailed(){return _finishOnFirstFailed=_asyncToGenerator(_regeneratorRuntime().mark(function a(s){var c;return _regeneratorRuntime().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return c=0,d.abrupt("return",new Promise(function(h){s.forEach(function(f){f.then(function(g){g.errors.length&&h([g]),c+=1,c===s.length&&h([])})})}));case 2:case"end":return d.stop()}},a)})),_finishOnFirstFailed.apply(this,arguments)}function getNamePath(a){return toArray$2(a)}function cloneByNamePathList(a,s){var c={};return s.forEach(function(u){var d=get$3(a,u);c=set$2(c,u,d)}),c}function containsNamePath(a,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return a&&a.some(function(u){return matchNamePath(s,u,c)})}function matchNamePath(a,s){var c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!a||!s||!c&&a.length!==s.length?!1:s.every(function(u,d){return a[d]===u})}function isSimilar(a,s){if(a===s)return!0;if(!a&&s||a&&!s||!a||!s||_typeof(a)!=="object"||_typeof(s)!=="object")return!1;var c=Object.keys(a),u=Object.keys(s),d=new Set([].concat(c,u));return _toConsumableArray$1(d).every(function(h){var f=a[h],g=s[h];return typeof f=="function"&&typeof g=="function"?!0:f===g})}function defaultGetValueFromEvent(a){var s=arguments.length<=1?void 0:arguments[1];return s&&s.target&&_typeof(s.target)==="object"&&a in s.target?s.target[a]:s}function move(a,s,c){var u=a.length;if(s<0||s>=u||c<0||c>=u)return a;var d=a[s],h=s-c;return h>0?[].concat(_toConsumableArray$1(a.slice(0,c)),[d],_toConsumableArray$1(a.slice(c,s)),_toConsumableArray$1(a.slice(s+1,u))):h<0?[].concat(_toConsumableArray$1(a.slice(0,s)),_toConsumableArray$1(a.slice(s+1,c+1)),[d],_toConsumableArray$1(a.slice(c+1,u))):a}var _excluded$3=["name"],EMPTY_ERRORS=[];function requireUpdate(a,s,c,u,d,h){return typeof a=="function"?a(s,c,"source"in h?{source:h.source}:{}):u!==d}var Field=(function(a){_inherits$1(c,a);var s=_createSuper(c);function c(u){var d;if(_classCallCheck$1(this,c),d=s.call(this,u),_defineProperty$2f(_assertThisInitialized$1(d),"state",{resetCount:0}),_defineProperty$2f(_assertThisInitialized$1(d),"cancelRegisterFunc",null),_defineProperty$2f(_assertThisInitialized$1(d),"mounted",!1),_defineProperty$2f(_assertThisInitialized$1(d),"touched",!1),_defineProperty$2f(_assertThisInitialized$1(d),"dirty",!1),_defineProperty$2f(_assertThisInitialized$1(d),"validatePromise",void 0),_defineProperty$2f(_assertThisInitialized$1(d),"prevValidating",void 0),_defineProperty$2f(_assertThisInitialized$1(d),"errors",EMPTY_ERRORS),_defineProperty$2f(_assertThisInitialized$1(d),"warnings",EMPTY_ERRORS),_defineProperty$2f(_assertThisInitialized$1(d),"cancelRegister",function(){var m=d.props,p=m.preserve,v=m.isListField,w=m.name;d.cancelRegisterFunc&&d.cancelRegisterFunc(v,p,getNamePath(w)),d.cancelRegisterFunc=null}),_defineProperty$2f(_assertThisInitialized$1(d),"getNamePath",function(){var m=d.props,p=m.name,v=m.fieldContext,w=v.prefixName,E=w===void 0?[]:w;return p!==void 0?[].concat(_toConsumableArray$1(E),_toConsumableArray$1(p)):[]}),_defineProperty$2f(_assertThisInitialized$1(d),"getRules",function(){var m=d.props,p=m.rules,v=p===void 0?[]:p,w=m.fieldContext;return v.map(function(E){return typeof E=="function"?E(w):E})}),_defineProperty$2f(_assertThisInitialized$1(d),"refresh",function(){d.mounted&&d.setState(function(m){var p=m.resetCount;return{resetCount:p+1}})}),_defineProperty$2f(_assertThisInitialized$1(d),"metaCache",null),_defineProperty$2f(_assertThisInitialized$1(d),"triggerMetaEvent",function(m){var p=d.props.onMetaChange;if(p){var v=_objectSpread2(_objectSpread2({},d.getMeta()),{},{destroy:m});isEqual(d.metaCache,v)||p(v),d.metaCache=v}else d.metaCache=null}),_defineProperty$2f(_assertThisInitialized$1(d),"onStoreChange",function(m,p,v){var w=d.props,E=w.shouldUpdate,C=w.dependencies,b=C===void 0?[]:C,P=w.onReset,R=v.store,T=d.getNamePath(),I=d.getValue(m),M=d.getValue(R),N=p&&containsNamePath(p,T);switch(v.type==="valueUpdate"&&v.source==="external"&&!isEqual(I,M)&&(d.touched=!0,d.dirty=!0,d.validatePromise=null,d.errors=EMPTY_ERRORS,d.warnings=EMPTY_ERRORS,d.triggerMetaEvent()),v.type){case"reset":if(!p||N){d.touched=!1,d.dirty=!1,d.validatePromise=void 0,d.errors=EMPTY_ERRORS,d.warnings=EMPTY_ERRORS,d.triggerMetaEvent(),P?.(),d.refresh();return}break;case"remove":{if(E&&requireUpdate(E,m,R,I,M,v)){d.reRender();return}break}case"setField":{var H=v.data;if(N){"touched"in H&&(d.touched=H.touched),"validating"in H&&!("originRCField"in H)&&(d.validatePromise=H.validating?Promise.resolve([]):null),"errors"in H&&(d.errors=H.errors||EMPTY_ERRORS),"warnings"in H&&(d.warnings=H.warnings||EMPTY_ERRORS),d.dirty=!0,d.triggerMetaEvent(),d.reRender();return}else if("value"in H&&containsNamePath(p,T,!0)){d.reRender();return}if(E&&!T.length&&requireUpdate(E,m,R,I,M,v)){d.reRender();return}break}case"dependenciesUpdate":{var L=b.map(getNamePath);if(L.some(function(A){return containsNamePath(v.relatedFields,A)})){d.reRender();return}break}default:if(N||(!b.length||T.length||E)&&requireUpdate(E,m,R,I,M,v)){d.reRender();return}break}E===!0&&d.reRender()}),_defineProperty$2f(_assertThisInitialized$1(d),"validateRules",function(m){var p=d.getNamePath(),v=d.getValue(),w=m||{},E=w.triggerName,C=w.validateOnly,b=C===void 0?!1:C,P=Promise.resolve().then(_asyncToGenerator(_regeneratorRuntime().mark(function R(){var T,I,M,N,H,L,A;return _regeneratorRuntime().wrap(function(W){for(;;)switch(W.prev=W.next){case 0:if(d.mounted){W.next=2;break}return W.abrupt("return",[]);case 2:if(T=d.props,I=T.validateFirst,M=I===void 0?!1:I,N=T.messageVariables,H=T.validateDebounce,L=d.getRules(),E&&(L=L.filter(function(G){return G}).filter(function(G){var oe=G.validateTrigger;if(!oe)return!0;var ae=toArray$2(oe);return ae.includes(E)})),!(H&&E)){W.next=10;break}return W.next=8,new Promise(function(G){setTimeout(G,H)});case 8:if(d.validatePromise===P){W.next=10;break}return W.abrupt("return",[]);case 10:return A=validateRules(p,v,L,m,M,N),A.catch(function(G){return G}).then(function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:EMPTY_ERRORS;if(d.validatePromise===P){var oe;d.validatePromise=null;var ae=[],X=[];(oe=G.forEach)===null||oe===void 0||oe.call(G,function(le){var ye=le.rule.warningOnly,pe=le.errors,he=pe===void 0?EMPTY_ERRORS:pe;ye?X.push.apply(X,_toConsumableArray$1(he)):ae.push.apply(ae,_toConsumableArray$1(he))}),d.errors=ae,d.warnings=X,d.triggerMetaEvent(),d.reRender()}}),W.abrupt("return",A);case 13:case"end":return W.stop()}},R)})));return b||(d.validatePromise=P,d.dirty=!0,d.errors=EMPTY_ERRORS,d.warnings=EMPTY_ERRORS,d.triggerMetaEvent(),d.reRender()),P}),_defineProperty$2f(_assertThisInitialized$1(d),"isFieldValidating",function(){return!!d.validatePromise}),_defineProperty$2f(_assertThisInitialized$1(d),"isFieldTouched",function(){return d.touched}),_defineProperty$2f(_assertThisInitialized$1(d),"isFieldDirty",function(){if(d.dirty||d.props.initialValue!==void 0)return!0;var m=d.props.fieldContext,p=m.getInternalHooks(HOOK_MARK),v=p.getInitialValue;return v(d.getNamePath())!==void 0}),_defineProperty$2f(_assertThisInitialized$1(d),"getErrors",function(){return d.errors}),_defineProperty$2f(_assertThisInitialized$1(d),"getWarnings",function(){return d.warnings}),_defineProperty$2f(_assertThisInitialized$1(d),"isListField",function(){return d.props.isListField}),_defineProperty$2f(_assertThisInitialized$1(d),"isList",function(){return d.props.isList}),_defineProperty$2f(_assertThisInitialized$1(d),"isPreserve",function(){return d.props.preserve}),_defineProperty$2f(_assertThisInitialized$1(d),"getMeta",function(){d.prevValidating=d.isFieldValidating();var m={touched:d.isFieldTouched(),validating:d.prevValidating,errors:d.errors,warnings:d.warnings,name:d.getNamePath(),validated:d.validatePromise===null};return m}),_defineProperty$2f(_assertThisInitialized$1(d),"getOnlyChild",function(m){if(typeof m=="function"){var p=d.getMeta();return _objectSpread2(_objectSpread2({},d.getOnlyChild(m(d.getControlled(),p,d.props.fieldContext))),{},{isFunction:!0})}var v=toArray$3(m);return v.length!==1||!React__namespace.isValidElement(v[0])?{child:v,isFunction:!1}:{child:v[0],isFunction:!1}}),_defineProperty$2f(_assertThisInitialized$1(d),"getValue",function(m){var p=d.props.fieldContext.getFieldsValue,v=d.getNamePath();return get$3(m||p(!0),v)}),_defineProperty$2f(_assertThisInitialized$1(d),"getControlled",function(){var m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},p=d.props,v=p.name,w=p.trigger,E=p.validateTrigger,C=p.getValueFromEvent,b=p.normalize,P=p.valuePropName,R=p.getValueProps,T=p.fieldContext,I=E!==void 0?E:T.validateTrigger,M=d.getNamePath(),N=T.getInternalHooks,H=T.getFieldsValue,L=N(HOOK_MARK),A=L.dispatch,k=d.getValue(),W=R||function(le){return _defineProperty$2f({},P,le)},G=m[w],oe=v!==void 0?W(k):{},ae=_objectSpread2(_objectSpread2({},m),oe);ae[w]=function(){d.touched=!0,d.dirty=!0,d.triggerMetaEvent();for(var le,ye=arguments.length,pe=new Array(ye),he=0;he<ye;he++)pe[he]=arguments[he];C?le=C.apply(void 0,pe):le=defaultGetValueFromEvent.apply(void 0,[P].concat(pe)),b&&(le=b(le,k,H(!0))),le!==k&&A({type:"updateValue",namePath:M,value:le}),G&&G.apply(void 0,pe)};var X=toArray$2(I||[]);return X.forEach(function(le){var ye=ae[le];ae[le]=function(){ye&&ye.apply(void 0,arguments);var pe=d.props.rules;pe&&pe.length&&A({type:"validateField",namePath:M,triggerName:le})}}),ae}),u.fieldContext){var h=u.fieldContext.getInternalHooks,f=h(HOOK_MARK),g=f.initEntityValue;g(_assertThisInitialized$1(d))}return d}return _createClass$1(c,[{key:"componentDidMount",value:function(){var d=this.props,h=d.shouldUpdate,f=d.fieldContext;if(this.mounted=!0,f){var g=f.getInternalHooks,m=g(HOOK_MARK),p=m.registerField;this.cancelRegisterFunc=p(this)}h===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var d=this.state.resetCount,h=this.props.children,f=this.getOnlyChild(h),g=f.child,m=f.isFunction,p;return m?p=g:React__namespace.isValidElement(g)?p=React__namespace.cloneElement(g,this.getControlled(g.props)):(warningOnce(!g,"`children` of Field is not validate ReactElement."),p=g),React__namespace.createElement(React__namespace.Fragment,{key:d},p)}}]),c})(React__namespace.Component);_defineProperty$2f(Field,"contextType",Context),_defineProperty$2f(Field,"defaultProps",{trigger:"onChange",valuePropName:"value"});function WrapperField(a){var s,c=a.name,u=_objectWithoutProperties$1(a,_excluded$3),d=React__namespace.useContext(Context),h=React__namespace.useContext(ListContext),f=c!==void 0?getNamePath(c):void 0,g=(s=u.isListField)!==null&&s!==void 0?s:!!h,m="keep";return g||(m="_".concat((f||[]).join("_"))),React__namespace.createElement(Field,_extends({key:m,name:f,isListField:g},u,{fieldContext:d}))}function List(a){var s=a.name,c=a.initialValue,u=a.children,d=a.rules,h=a.validateTrigger,f=a.isListField,g=React__namespace.useContext(Context),m=React__namespace.useContext(ListContext),p=React__namespace.useRef({keys:[],id:0}),v=p.current,w=React__namespace.useMemo(function(){var P=getNamePath(g.prefixName)||[];return[].concat(_toConsumableArray$1(P),_toConsumableArray$1(getNamePath(s)))},[g.prefixName,s]),E=React__namespace.useMemo(function(){return _objectSpread2(_objectSpread2({},g),{},{prefixName:w})},[g,w]),C=React__namespace.useMemo(function(){return{getKey:function(R){var T=w.length,I=R[T];return[v.keys[I],R.slice(T+1)]}}},[w]);if(typeof u!="function")return warningOnce(!1,"Form.List only accepts function as children."),null;var b=function(R,T,I){var M=I.source;return M==="internal"?!1:R!==T};return React__namespace.createElement(ListContext.Provider,{value:C},React__namespace.createElement(Context.Provider,{value:E},React__namespace.createElement(WrapperField,{name:[],shouldUpdate:b,rules:d,validateTrigger:h,initialValue:c,isList:!0,isListField:f??!!m},function(P,R){var T=P.value,I=T===void 0?[]:T,M=P.onChange,N=g.getFieldValue,H=function(){var W=N(w||[]);return W||[]},L={add:function(W,G){var oe=H();G>=0&&G<=oe.length?(v.keys=[].concat(_toConsumableArray$1(v.keys.slice(0,G)),[v.id],_toConsumableArray$1(v.keys.slice(G))),M([].concat(_toConsumableArray$1(oe.slice(0,G)),[W],_toConsumableArray$1(oe.slice(G))))):(v.keys=[].concat(_toConsumableArray$1(v.keys),[v.id]),M([].concat(_toConsumableArray$1(oe),[W]))),v.id+=1},remove:function(W){var G=H(),oe=new Set(Array.isArray(W)?W:[W]);oe.size<=0||(v.keys=v.keys.filter(function(ae,X){return!oe.has(X)}),M(G.filter(function(ae,X){return!oe.has(X)})))},move:function(W,G){if(W!==G){var oe=H();W<0||W>=oe.length||G<0||G>=oe.length||(v.keys=move(v.keys,W,G),M(move(oe,W,G)))}}},A=I||[];return Array.isArray(A)||(A=[]),u(A.map(function(k,W){var G=v.keys[W];return G===void 0&&(v.keys[W]=v.id,G=v.keys[W],v.id+=1),{name:W,key:G,isListField:!0}}),L,R)})))}function _iterableToArrayLimit$1(a,s){var c=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(c!=null){var u,d,h,f,g=[],m=!0,p=!1;try{if(h=(c=c.call(a)).next,s===0){if(Object(c)!==c)return;m=!1}else for(;!(m=(u=h.call(c)).done)&&(g.push(u.value),g.length!==s);m=!0);}catch(v){p=!0,d=v}finally{try{if(!m&&c.return!=null&&(f=c.return(),Object(f)!==f))return}finally{if(p)throw d}}return g}}function _slicedToArray$1(a,s){return _arrayWithHoles$1(a)||_iterableToArrayLimit$1(a,s)||_unsupportedIterableToArray$1(a,s)||_nonIterableRest$1()}function allPromiseFinish(a){var s=!1,c=a.length,u=[];return a.length?new Promise(function(d,h){a.forEach(function(f,g){f.catch(function(m){return s=!0,m}).then(function(m){c-=1,u[g]=m,!(c>0)&&(s&&h(u),d(u))})})}):Promise.resolve([])}var SPLIT="__@field_split__";function normalize(a){return a.map(function(s){return"".concat(_typeof(s),":").concat(s)}).join(SPLIT)}var NameMap=(function(){function a(){_classCallCheck$1(this,a),_defineProperty$2f(this,"kvs",new Map)}return _createClass$1(a,[{key:"set",value:function(c,u){this.kvs.set(normalize(c),u)}},{key:"get",value:function(c){return this.kvs.get(normalize(c))}},{key:"update",value:function(c,u){var d=this.get(c),h=u(d);h?this.set(c,h):this.delete(c)}},{key:"delete",value:function(c){this.kvs.delete(normalize(c))}},{key:"map",value:function(c){return _toConsumableArray$1(this.kvs.entries()).map(function(u){var d=_slicedToArray$1(u,2),h=d[0],f=d[1],g=h.split(SPLIT);return c({key:g.map(function(m){var p=m.match(/^([^:]*):(.*)$/),v=_slicedToArray$1(p,3),w=v[1],E=v[2];return w==="number"?Number(E):E}),value:f})})}},{key:"toJSON",value:function(){var c={};return this.map(function(u){var d=u.key,h=u.value;return c[d.join(".")]=h,null}),c}}]),a})(),_excluded$2=["name"],FormStore=_createClass$1(function a(s){var c=this;_classCallCheck$1(this,a),_defineProperty$2f(this,"formHooked",!1),_defineProperty$2f(this,"forceRootUpdate",void 0),_defineProperty$2f(this,"subscribable",!0),_defineProperty$2f(this,"store",{}),_defineProperty$2f(this,"fieldEntities",[]),_defineProperty$2f(this,"initialValues",{}),_defineProperty$2f(this,"callbacks",{}),_defineProperty$2f(this,"validateMessages",null),_defineProperty$2f(this,"preserve",null),_defineProperty$2f(this,"lastValidatePromise",null),_defineProperty$2f(this,"getForm",function(){return{getFieldValue:c.getFieldValue,getFieldsValue:c.getFieldsValue,getFieldError:c.getFieldError,getFieldWarning:c.getFieldWarning,getFieldsError:c.getFieldsError,isFieldsTouched:c.isFieldsTouched,isFieldTouched:c.isFieldTouched,isFieldValidating:c.isFieldValidating,isFieldsValidating:c.isFieldsValidating,resetFields:c.resetFields,setFields:c.setFields,setFieldValue:c.setFieldValue,setFieldsValue:c.setFieldsValue,validateFields:c.validateFields,submit:c.submit,_init:!0,getInternalHooks:c.getInternalHooks}}),_defineProperty$2f(this,"getInternalHooks",function(u){return u===HOOK_MARK?(c.formHooked=!0,{dispatch:c.dispatch,initEntityValue:c.initEntityValue,registerField:c.registerField,useSubscribe:c.useSubscribe,setInitialValues:c.setInitialValues,destroyForm:c.destroyForm,setCallbacks:c.setCallbacks,setValidateMessages:c.setValidateMessages,getFields:c.getFields,setPreserve:c.setPreserve,getInitialValue:c.getInitialValue,registerWatch:c.registerWatch}):(warningOnce(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),_defineProperty$2f(this,"useSubscribe",function(u){c.subscribable=u}),_defineProperty$2f(this,"prevWithoutPreserves",null),_defineProperty$2f(this,"setInitialValues",function(u,d){if(c.initialValues=u||{},d){var h,f=merge(u,c.store);(h=c.prevWithoutPreserves)===null||h===void 0||h.map(function(g){var m=g.key;f=set$2(f,m,get$3(u,m))}),c.prevWithoutPreserves=null,c.updateStore(f)}}),_defineProperty$2f(this,"destroyForm",function(u){if(u)c.updateStore({});else{var d=new NameMap;c.getFieldEntities(!0).forEach(function(h){c.isMergedPreserve(h.isPreserve())||d.set(h.getNamePath(),!0)}),c.prevWithoutPreserves=d}}),_defineProperty$2f(this,"getInitialValue",function(u){var d=get$3(c.initialValues,u);return u.length?merge(d):d}),_defineProperty$2f(this,"setCallbacks",function(u){c.callbacks=u}),_defineProperty$2f(this,"setValidateMessages",function(u){c.validateMessages=u}),_defineProperty$2f(this,"setPreserve",function(u){c.preserve=u}),_defineProperty$2f(this,"watchList",[]),_defineProperty$2f(this,"registerWatch",function(u){return c.watchList.push(u),function(){c.watchList=c.watchList.filter(function(d){return d!==u})}}),_defineProperty$2f(this,"notifyWatch",function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(c.watchList.length){var d=c.getFieldsValue(),h=c.getFieldsValue(!0);c.watchList.forEach(function(f){f(d,h,u)})}}),_defineProperty$2f(this,"timeoutId",null),_defineProperty$2f(this,"warningUnhooked",function(){}),_defineProperty$2f(this,"updateStore",function(u){c.store=u}),_defineProperty$2f(this,"getFieldEntities",function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return u?c.fieldEntities.filter(function(d){return d.getNamePath().length}):c.fieldEntities}),_defineProperty$2f(this,"getFieldsMap",function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=new NameMap;return c.getFieldEntities(u).forEach(function(h){var f=h.getNamePath();d.set(f,h)}),d}),_defineProperty$2f(this,"getFieldEntitiesForNamePathList",function(u){if(!u)return c.getFieldEntities(!0);var d=c.getFieldsMap(!0);return u.map(function(h){var f=getNamePath(h);return d.get(f)||{INVALIDATE_NAME_PATH:getNamePath(h)}})}),_defineProperty$2f(this,"getFieldsValue",function(u,d){c.warningUnhooked();var h,f,g;if(u===!0||Array.isArray(u)?(h=u,f=d):u&&_typeof(u)==="object"&&(g=u.strict,f=u.filter),h===!0&&!f)return c.store;var m=c.getFieldEntitiesForNamePathList(Array.isArray(h)?h:null),p=[];return m.forEach(function(v){var w,E,C="INVALIDATE_NAME_PATH"in v?v.INVALIDATE_NAME_PATH:v.getNamePath();if(g){var b,P;if((b=(P=v).isList)!==null&&b!==void 0&&b.call(P))return}else if(!h&&(w=(E=v).isListField)!==null&&w!==void 0&&w.call(E))return;if(!f)p.push(C);else{var R="getMeta"in v?v.getMeta():null;f(R)&&p.push(C)}}),cloneByNamePathList(c.store,p.map(getNamePath))}),_defineProperty$2f(this,"getFieldValue",function(u){c.warningUnhooked();var d=getNamePath(u);return get$3(c.store,d)}),_defineProperty$2f(this,"getFieldsError",function(u){c.warningUnhooked();var d=c.getFieldEntitiesForNamePathList(u);return d.map(function(h,f){return h&&!("INVALIDATE_NAME_PATH"in h)?{name:h.getNamePath(),errors:h.getErrors(),warnings:h.getWarnings()}:{name:getNamePath(u[f]),errors:[],warnings:[]}})}),_defineProperty$2f(this,"getFieldError",function(u){c.warningUnhooked();var d=getNamePath(u),h=c.getFieldsError([d])[0];return h.errors}),_defineProperty$2f(this,"getFieldWarning",function(u){c.warningUnhooked();var d=getNamePath(u),h=c.getFieldsError([d])[0];return h.warnings}),_defineProperty$2f(this,"isFieldsTouched",function(){c.warningUnhooked();for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];var f=d[0],g=d[1],m,p=!1;d.length===0?m=null:d.length===1?Array.isArray(f)?(m=f.map(getNamePath),p=!1):(m=null,p=f):(m=f.map(getNamePath),p=g);var v=c.getFieldEntities(!0),w=function(R){return R.isFieldTouched()};if(!m)return p?v.every(function(P){return w(P)||P.isList()}):v.some(w);var E=new NameMap;m.forEach(function(P){E.set(P,[])}),v.forEach(function(P){var R=P.getNamePath();m.forEach(function(T){T.every(function(I,M){return R[M]===I})&&E.update(T,function(I){return[].concat(_toConsumableArray$1(I),[P])})})});var C=function(R){return R.some(w)},b=E.map(function(P){var R=P.value;return R});return p?b.every(C):b.some(C)}),_defineProperty$2f(this,"isFieldTouched",function(u){return c.warningUnhooked(),c.isFieldsTouched([u])}),_defineProperty$2f(this,"isFieldsValidating",function(u){c.warningUnhooked();var d=c.getFieldEntities();if(!u)return d.some(function(f){return f.isFieldValidating()});var h=u.map(getNamePath);return d.some(function(f){var g=f.getNamePath();return containsNamePath(h,g)&&f.isFieldValidating()})}),_defineProperty$2f(this,"isFieldValidating",function(u){return c.warningUnhooked(),c.isFieldsValidating([u])}),_defineProperty$2f(this,"resetWithFieldInitialValue",function(){var u=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=new NameMap,h=c.getFieldEntities(!0);h.forEach(function(m){var p=m.props.initialValue,v=m.getNamePath();if(p!==void 0){var w=d.get(v)||new Set;w.add({entity:m,value:p}),d.set(v,w)}});var f=function(p){p.forEach(function(v){var w=v.props.initialValue;if(w!==void 0){var E=v.getNamePath(),C=c.getInitialValue(E);if(C!==void 0)warningOnce(!1,"Form already set 'initialValues' with path '".concat(E.join("."),"'. Field can not overwrite it."));else{var b=d.get(E);if(b&&b.size>1)warningOnce(!1,"Multiple Field with path '".concat(E.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(b){var P=c.getFieldValue(E),R=v.isListField();!R&&(!u.skipExist||P===void 0)&&c.updateStore(set$2(c.store,E,_toConsumableArray$1(b)[0].value))}}}})},g;u.entities?g=u.entities:u.namePathList?(g=[],u.namePathList.forEach(function(m){var p=d.get(m);if(p){var v;(v=g).push.apply(v,_toConsumableArray$1(_toConsumableArray$1(p).map(function(w){return w.entity})))}})):g=h,f(g)}),_defineProperty$2f(this,"resetFields",function(u){c.warningUnhooked();var d=c.store;if(!u){c.updateStore(merge(c.initialValues)),c.resetWithFieldInitialValue(),c.notifyObservers(d,null,{type:"reset"}),c.notifyWatch();return}var h=u.map(getNamePath);h.forEach(function(f){var g=c.getInitialValue(f);c.updateStore(set$2(c.store,f,g))}),c.resetWithFieldInitialValue({namePathList:h}),c.notifyObservers(d,h,{type:"reset"}),c.notifyWatch(h)}),_defineProperty$2f(this,"setFields",function(u){c.warningUnhooked();var d=c.store,h=[];u.forEach(function(f){var g=f.name,m=_objectWithoutProperties$1(f,_excluded$2),p=getNamePath(g);h.push(p),"value"in m&&c.updateStore(set$2(c.store,p,m.value)),c.notifyObservers(d,[p],{type:"setField",data:f})}),c.notifyWatch(h)}),_defineProperty$2f(this,"getFields",function(){var u=c.getFieldEntities(!0),d=u.map(function(h){var f=h.getNamePath(),g=h.getMeta(),m=_objectSpread2(_objectSpread2({},g),{},{name:f,value:c.getFieldValue(f)});return Object.defineProperty(m,"originRCField",{value:!0}),m});return d}),_defineProperty$2f(this,"initEntityValue",function(u){var d=u.props.initialValue;if(d!==void 0){var h=u.getNamePath(),f=get$3(c.store,h);f===void 0&&c.updateStore(set$2(c.store,h,d))}}),_defineProperty$2f(this,"isMergedPreserve",function(u){var d=u!==void 0?u:c.preserve;return d??!0}),_defineProperty$2f(this,"registerField",function(u){c.fieldEntities.push(u);var d=u.getNamePath();if(c.notifyWatch([d]),u.props.initialValue!==void 0){var h=c.store;c.resetWithFieldInitialValue({entities:[u],skipExist:!0}),c.notifyObservers(h,[u.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(f,g){var m=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(c.fieldEntities=c.fieldEntities.filter(function(w){return w!==u}),!c.isMergedPreserve(g)&&(!f||m.length>1)){var p=f?void 0:c.getInitialValue(d);if(d.length&&c.getFieldValue(d)!==p&&c.fieldEntities.every(function(w){return!matchNamePath(w.getNamePath(),d)})){var v=c.store;c.updateStore(set$2(v,d,p,!0)),c.notifyObservers(v,[d],{type:"remove"}),c.triggerDependenciesUpdate(v,d)}}c.notifyWatch([d])}}),_defineProperty$2f(this,"dispatch",function(u){switch(u.type){case"updateValue":{var d=u.namePath,h=u.value;c.updateValue(d,h);break}case"validateField":{var f=u.namePath,g=u.triggerName;c.validateFields([f],{triggerName:g});break}}}),_defineProperty$2f(this,"notifyObservers",function(u,d,h){if(c.subscribable){var f=_objectSpread2(_objectSpread2({},h),{},{store:c.getFieldsValue(!0)});c.getFieldEntities().forEach(function(g){var m=g.onStoreChange;m(u,d,f)})}else c.forceRootUpdate()}),_defineProperty$2f(this,"triggerDependenciesUpdate",function(u,d){var h=c.getDependencyChildrenFields(d);return h.length&&c.validateFields(h),c.notifyObservers(u,h,{type:"dependenciesUpdate",relatedFields:[d].concat(_toConsumableArray$1(h))}),h}),_defineProperty$2f(this,"updateValue",function(u,d){var h=getNamePath(u),f=c.store;c.updateStore(set$2(c.store,h,d)),c.notifyObservers(f,[h],{type:"valueUpdate",source:"internal"}),c.notifyWatch([h]);var g=c.triggerDependenciesUpdate(f,h),m=c.callbacks.onValuesChange;if(m){var p=cloneByNamePathList(c.store,[h]);m(p,c.getFieldsValue())}c.triggerOnFieldsChange([h].concat(_toConsumableArray$1(g)))}),_defineProperty$2f(this,"setFieldsValue",function(u){c.warningUnhooked();var d=c.store;if(u){var h=merge(c.store,u);c.updateStore(h)}c.notifyObservers(d,null,{type:"valueUpdate",source:"external"}),c.notifyWatch()}),_defineProperty$2f(this,"setFieldValue",function(u,d){c.setFields([{name:u,value:d,errors:[],warnings:[]}])}),_defineProperty$2f(this,"getDependencyChildrenFields",function(u){var d=new Set,h=[],f=new NameMap;c.getFieldEntities().forEach(function(m){var p=m.props.dependencies;(p||[]).forEach(function(v){var w=getNamePath(v);f.update(w,function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return E.add(m),E})})});var g=function m(p){var v=f.get(p)||new Set;v.forEach(function(w){if(!d.has(w)){d.add(w);var E=w.getNamePath();w.isFieldDirty()&&E.length&&(h.push(E),m(E))}})};return g(u),h}),_defineProperty$2f(this,"triggerOnFieldsChange",function(u,d){var h=c.callbacks.onFieldsChange;if(h){var f=c.getFields();if(d){var g=new NameMap;d.forEach(function(p){var v=p.name,w=p.errors;g.set(v,w)}),f.forEach(function(p){p.errors=g.get(p.name)||p.errors})}var m=f.filter(function(p){var v=p.name;return containsNamePath(u,v)});m.length&&h(m,f)}}),_defineProperty$2f(this,"validateFields",function(u,d){c.warningUnhooked();var h,f;Array.isArray(u)||typeof u=="string"||typeof d=="string"?(h=u,f=d):f=u;var g=!!h,m=g?h.map(getNamePath):[],p=[],v=String(Date.now()),w=new Set,E=f||{},C=E.recursive,b=E.dirty;c.getFieldEntities(!0).forEach(function(I){if(g||m.push(I.getNamePath()),!(!I.props.rules||!I.props.rules.length)&&!(b&&!I.isFieldDirty())){var M=I.getNamePath();if(w.add(M.join(v)),!g||containsNamePath(m,M,C)){var N=I.validateRules(_objectSpread2({validateMessages:_objectSpread2(_objectSpread2({},defaultValidateMessages),c.validateMessages)},f));p.push(N.then(function(){return{name:M,errors:[],warnings:[]}}).catch(function(H){var L,A=[],k=[];return(L=H.forEach)===null||L===void 0||L.call(H,function(W){var G=W.rule.warningOnly,oe=W.errors;G?k.push.apply(k,_toConsumableArray$1(oe)):A.push.apply(A,_toConsumableArray$1(oe))}),A.length?Promise.reject({name:M,errors:A,warnings:k}):{name:M,errors:A,warnings:k}}))}}});var P=allPromiseFinish(p);c.lastValidatePromise=P,P.catch(function(I){return I}).then(function(I){var M=I.map(function(N){var H=N.name;return H});c.notifyObservers(c.store,M,{type:"validateFinish"}),c.triggerOnFieldsChange(M,I)});var R=P.then(function(){return c.lastValidatePromise===P?Promise.resolve(c.getFieldsValue(m)):Promise.reject([])}).catch(function(I){var M=I.filter(function(N){return N&&N.errors.length});return Promise.reject({values:c.getFieldsValue(m),errorFields:M,outOfDate:c.lastValidatePromise!==P})});R.catch(function(I){return I});var T=m.filter(function(I){return w.has(I.join(v))});return c.triggerOnFieldsChange(T),R}),_defineProperty$2f(this,"submit",function(){c.warningUnhooked(),c.validateFields().then(function(u){var d=c.callbacks.onFinish;if(d)try{d(u)}catch(h){console.error(h)}}).catch(function(u){var d=c.callbacks.onFinishFailed;d&&d(u)})}),this.forceRootUpdate=s});function useForm$1(a){var s=React__namespace.useRef(),c=React__namespace.useState({}),u=_slicedToArray$1(c,2),d=u[1];if(!s.current)if(a)s.current=a;else{var h=function(){d({})},f=new FormStore(h);s.current=f.getForm()}return[s.current]}var FormContext=React__namespace.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),FormProvider=function(s){var c=s.validateMessages,u=s.onFormChange,d=s.onFormFinish,h=s.children,f=React__namespace.useContext(FormContext),g=React__namespace.useRef({});return React__namespace.createElement(FormContext.Provider,{value:_objectSpread2(_objectSpread2({},f),{},{validateMessages:_objectSpread2(_objectSpread2({},f.validateMessages),c),triggerFormChange:function(p,v){u&&u(p,{changedFields:v,forms:g.current}),f.triggerFormChange(p,v)},triggerFormFinish:function(p,v){d&&d(p,{values:v,forms:g.current}),f.triggerFormFinish(p,v)},registerForm:function(p,v){p&&(g.current=_objectSpread2(_objectSpread2({},g.current),{},_defineProperty$2f({},p,v))),f.registerForm(p,v)},unregisterForm:function(p){var v=_objectSpread2({},g.current);delete v[p],g.current=v,f.unregisterForm(p)}})},h)},_excluded$1=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],Form=function(s,c){var u=s.name,d=s.initialValues,h=s.fields,f=s.form,g=s.preserve,m=s.children,p=s.component,v=p===void 0?"form":p,w=s.validateMessages,E=s.validateTrigger,C=E===void 0?"onChange":E,b=s.onValuesChange,P=s.onFieldsChange,R=s.onFinish,T=s.onFinishFailed,I=s.clearOnDestroy,M=_objectWithoutProperties$1(s,_excluded$1),N=React__namespace.useRef(null),H=React__namespace.useContext(FormContext),L=useForm$1(f),A=_slicedToArray$1(L,1),k=A[0],W=k.getInternalHooks(HOOK_MARK),G=W.useSubscribe,oe=W.setInitialValues,ae=W.setCallbacks,X=W.setValidateMessages,le=W.setPreserve,ye=W.destroyForm;React__namespace.useImperativeHandle(c,function(){return _objectSpread2(_objectSpread2({},k),{},{nativeElement:N.current})}),React__namespace.useEffect(function(){return H.registerForm(u,k),function(){H.unregisterForm(u)}},[H,k,u]),X(_objectSpread2(_objectSpread2({},H.validateMessages),w)),ae({onValuesChange:b,onFieldsChange:function(Pe){if(H.triggerFormChange(u,Pe),P){for(var U=arguments.length,Q=new Array(U>1?U-1:0),ee=1;ee<U;ee++)Q[ee-1]=arguments[ee];P.apply(void 0,[Pe].concat(Q))}},onFinish:function(Pe){H.triggerFormFinish(u,Pe),R&&R(Pe)},onFinishFailed:T}),le(g);var pe=React__namespace.useRef(null);oe(d,!pe.current),pe.current||(pe.current=!0),React__namespace.useEffect(function(){return function(){return ye(I)}},[]);var he,Me=typeof m=="function";if(Me){var Qe=k.getFieldsValue(!0);he=m(Qe,k)}else he=m;G(!Me);var Xe=React__namespace.useRef();React__namespace.useEffect(function(){isSimilar(Xe.current||[],h||[])||k.setFields(h||[]),Xe.current=h},[h,k]);var Ke=React__namespace.useMemo(function(){return _objectSpread2(_objectSpread2({},k),{},{validateTrigger:C})},[k,C]),it=React__namespace.createElement(ListContext.Provider,{value:null},React__namespace.createElement(Context.Provider,{value:Ke},he));return v===!1?it:React__namespace.createElement(v,_extends({},M,{ref:N,onSubmit:function(Pe){Pe.preventDefault(),Pe.stopPropagation(),k.submit()},onReset:function(Pe){var U;Pe.preventDefault(),k.resetFields(),(U=M.onReset)===null||U===void 0||U.call(M,Pe)}}),it)};function stringify$2(a){try{return JSON.stringify(a)}catch{return Math.random()}}function useWatch(){for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];var u=s[0],d=s[1],h=d===void 0?{}:d,f=isFormInstance(h)?{form:h}:h,g=f.form,m=React.useState(),p=_slicedToArray$1(m,2),v=p[0],w=p[1],E=React.useMemo(function(){return stringify$2(v)},[v]),C=React.useRef(E);C.current=E;var b=React.useContext(Context),P=g||b,R=P&&P._init,T=getNamePath(u),I=React.useRef(T);return I.current=T,React.useEffect(function(){if(R){var M=P.getFieldsValue,N=P.getInternalHooks,H=N(HOOK_MARK),L=H.registerWatch,A=function(oe,ae){var X=f.preserve?ae:oe;return typeof u=="function"?u(X):get$3(X,I.current)},k=L(function(G,oe){var ae=A(G,oe),X=stringify$2(ae);C.current!==X&&(C.current=X,w(ae))}),W=A(M(),M(!0));return v!==W&&w(W),k}},[R]),v}var InternalForm=React__namespace.forwardRef(Form),RefForm=InternalForm;RefForm.FormProvider=FormProvider,RefForm.Field=WrapperField,RefForm.List=List,RefForm.useForm=useForm$1,RefForm.useWatch=useWatch;function isDOM(a){return a instanceof HTMLElement||a instanceof SVGElement}function getDOM(a){return a&&_typeof(a)==="object"&&isDOM(a.nativeElement)?a.nativeElement:isDOM(a)?a:null}const t=a=>typeof a=="object"&&a!=null&&a.nodeType===1,e$1=(a,s)=>(!s||a!=="hidden")&&a!=="visible"&&a!=="clip",n=(a,s)=>{if(a.clientHeight<a.scrollHeight||a.clientWidth<a.scrollWidth){const c=getComputedStyle(a,null);return e$1(c.overflowY,s)||e$1(c.overflowX,s)||(u=>{const d=(h=>{if(!h.ownerDocument||!h.ownerDocument.defaultView)return null;try{return h.ownerDocument.defaultView.frameElement}catch{return null}})(u);return!!d&&(d.clientHeight<u.scrollHeight||d.clientWidth<u.scrollWidth)})(a)}return!1},o$2=(a,s,c,u,d,h,f,g)=>h<a&&f>s||h>a&&f<s?0:h<=a&&g<=c||f>=s&&g>=c?h-a-u:f>s&&g<c||h<a&&g>c?f-s+d:0,l=a=>{const s=a.parentElement;return s??(a.getRootNode().host||null)},r=(a,s)=>{var c,u,d,h;if(typeof document>"u")return[];const{scrollMode:f,block:g,inline:m,boundary:p,skipOverflowHiddenElements:v}=s,w=typeof p=="function"?p:pe=>pe!==p;if(!t(a))throw new TypeError("Invalid target");const E=document.scrollingElement||document.documentElement,C=[];let b=a;for(;t(b)&&w(b);){if(b=l(b),b===E){C.push(b);break}b!=null&&b===document.body&&n(b)&&!n(document.documentElement)||b!=null&&n(b,v)&&C.push(b)}const P=(u=(c=window.visualViewport)==null?void 0:c.width)!=null?u:innerWidth,R=(h=(d=window.visualViewport)==null?void 0:d.height)!=null?h:innerHeight,{scrollX:T,scrollY:I}=window,{height:M,width:N,top:H,right:L,bottom:A,left:k}=a.getBoundingClientRect(),{top:W,right:G,bottom:oe,left:ae}=(pe=>{const he=window.getComputedStyle(pe);return{top:parseFloat(he.scrollMarginTop)||0,right:parseFloat(he.scrollMarginRight)||0,bottom:parseFloat(he.scrollMarginBottom)||0,left:parseFloat(he.scrollMarginLeft)||0}})(a);let X=g==="start"||g==="nearest"?H-W:g==="end"?A+oe:H+M/2-W+oe,le=m==="center"?k+N/2-ae+G:m==="end"?L+G:k-ae;const ye=[];for(let pe=0;pe<C.length;pe++){const he=C[pe],{height:Me,width:Qe,top:Xe,right:Ke,bottom:it,left:te}=he.getBoundingClientRect();if(f==="if-needed"&&H>=0&&k>=0&&A<=R&&L<=P&&(he===E&&!n(he)||H>=Xe&&A<=it&&k>=te&&L<=Ke))return ye;const Pe=getComputedStyle(he),U=parseInt(Pe.borderLeftWidth,10),Q=parseInt(Pe.borderTopWidth,10),ee=parseInt(Pe.borderRightWidth,10),ce=parseInt(Pe.borderBottomWidth,10);let ve=0,K=0;const ne="offsetWidth"in he?he.offsetWidth-he.clientWidth-U-ee:0,de="offsetHeight"in he?he.offsetHeight-he.clientHeight-Q-ce:0,Oe="offsetWidth"in he?he.offsetWidth===0?0:Qe/he.offsetWidth:0,Se="offsetHeight"in he?he.offsetHeight===0?0:Me/he.offsetHeight:0;if(E===he)ve=g==="start"?X:g==="end"?X-R:g==="nearest"?o$2(I,I+R,R,Q,ce,I+X,I+X+M,M):X-R/2,K=m==="start"?le:m==="center"?le-P/2:m==="end"?le-P:o$2(T,T+P,P,U,ee,T+le,T+le+N,N),ve=Math.max(0,ve+I),K=Math.max(0,K+T);else{ve=g==="start"?X-Xe-Q:g==="end"?X-it+ce+de:g==="nearest"?o$2(Xe,it,Me,Q,ce+de,X,X+M,M):X-(Xe+Me/2)+de/2,K=m==="start"?le-te-U:m==="center"?le-(te+Qe/2)+ne/2:m==="end"?le-Ke+ee+ne:o$2(te,Ke,Qe,U,ee+ne,le,le+N,N);const{scrollLeft:ge,scrollTop:De}=he;ve=Se===0?0:Math.max(0,Math.min(De+ve/Se,he.scrollHeight-Me/Se+de)),K=Oe===0?0:Math.max(0,Math.min(ge+K/Oe,he.scrollWidth-Qe/Oe+ne)),X+=De-ve,le+=ge-K}ye.push({el:he,top:ve,left:K})}return ye},o$1=a=>a===!1?{block:"end",inline:"nearest"}:(s=>s===Object(s)&&Object.keys(s).length!==0)(a)?a:{block:"start",inline:"nearest"};function e(a,s){if(!a.isConnected||!(d=>{let h=d;for(;h&&h.parentNode;){if(h.parentNode===document)return!0;h=h.parentNode instanceof ShadowRoot?h.parentNode.host:h.parentNode}return!1})(a))return;const c=(d=>{const h=window.getComputedStyle(d);return{top:parseFloat(h.scrollMarginTop)||0,right:parseFloat(h.scrollMarginRight)||0,bottom:parseFloat(h.scrollMarginBottom)||0,left:parseFloat(h.scrollMarginLeft)||0}})(a);if((d=>typeof d=="object"&&typeof d.behavior=="function")(s))return s.behavior(r(a,s));const u=typeof s=="boolean"||s==null?void 0:s.behavior;for(const{el:d,top:h,left:f}of r(a,o$1(s))){const g=h-c.top+c.bottom,m=f-c.left+c.right;d.scroll({top:g,left:m,behavior:u})}}const formItemNameBlackList=["parentNode"],defaultItemNamePrefixCls="form_item";function toArray$1(a){return a===void 0||a===!1?[]:Array.isArray(a)?a:[a]}function getFieldId(a,s){if(!a.length)return;const c=a.join("_");return s?`${s}_${c}`:formItemNameBlackList.includes(c)?`${defaultItemNamePrefixCls}_${c}`:c}var __rest=function(a,s){var c={};for(var u in a)Object.prototype.hasOwnProperty.call(a,u)&&s.indexOf(u)<0&&(c[u]=a[u]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,u=Object.getOwnPropertySymbols(a);d<u.length;d++)s.indexOf(u[d])<0&&Object.prototype.propertyIsEnumerable.call(a,u[d])&&(c[u[d]]=a[u[d]]);return c};function toNamePathStr(a){return toArray$1(a).join("_")}function getFieldDOMNode(a,s){const c=s.getFieldInstance(a),u=getDOM(c);if(u)return u;const d=getFieldId(toArray$1(a),s.__INTERNAL__.name);if(d)return document.getElementById(d)}function useForm(a){const[s]=useForm$1(),c=React__namespace.useRef({}),u=React__namespace.useMemo(()=>Object.assign(Object.assign({},s),{__INTERNAL__:{itemRef:d=>h=>{const f=toNamePathStr(d);h?c.current[f]=h:delete c.current[f]}},scrollToField:(d,h={})=>{const{focus:f}=h,g=__rest(h,["focus"]),m=getFieldDOMNode(d,u);m&&(e(m,Object.assign({scrollMode:"if-needed",block:"nearest"},g)),f&&u.focusField(d))},focusField:d=>{var h,f;const g=u.getFieldInstance(d);typeof g?.focus=="function"?g.focus():(f=(h=getFieldDOMNode(d,u))===null||h===void 0?void 0:h.focus)===null||f===void 0||f.call(h)},getFieldInstance:d=>{const h=toNamePathStr(d);return c.current[h]}}),[a,s]);return[u]}var FolderType=(a=>(a.NOFOLDER="不创建文件夹",a.BYNAME="按文件命名",a.BYDATE="按日期命名",a))(FolderType||{});const SettingsSchema={properties:createPlatformMap({type:"object",properties:{generate:{type:"object",properties:{times:{type:"number",default:1},interval:{type:"number",default:30},shouldDownload:{type:"boolean",default:!0},folderType:{type:"string",default:"不创建文件夹"}},required:["times","interval","shouldDownload","folderType"],default:{times:1,interval:30,shouldDownload:!0,folderType:"不创建文件夹"}},submit:{type:"object",properties:{history:{type:"boolean",default:!0},register:{type:"boolean",default:!1},submitter:{type:"string",default:""},webAppUrl:{type:"string",default:""},sheet:{type:"string",default:""}},required:["history","register","submitter","webAppUrl","sheet"],default:{histroy:!0,register:!1,submitter:"",webAppUrl:"",sheet:""}},window:{type:"object",properties:{x:{type:"number",default:0},y:{type:"number",default:0},width:{type:"number",default:0},height:{type:"number",default:0},adjustable:{type:"boolean",default:!1}},required:["x","y","width","height","adjustable"]}},required:["generate","submit","window"]}),default:createPlatformMap({generate:{times:1,interval:30,shouldDownload:!0,folderType:"不创建文件夹"},submit:{history:!0,register:!1,submitter:"",webAppUrl:"",sheet:""},window:{x:0,y:0,width:0,height:0,adjustable:!1}})};var cjs={exports:{}},Draggable$1={};const require$$0=getAugmentedNamespace(React__namespace);var propTypes$1={exports:{}},ReactPropTypesSecret_1$1,hasRequiredReactPropTypesSecret$1;function requireReactPropTypesSecret$1(){if(hasRequiredReactPropTypesSecret$1)return ReactPropTypesSecret_1$1;hasRequiredReactPropTypesSecret$1=1;var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1$1=a,ReactPropTypesSecret_1$1}var factoryWithThrowingShims$1,hasRequiredFactoryWithThrowingShims$1;function requireFactoryWithThrowingShims$1(){if(hasRequiredFactoryWithThrowingShims$1)return factoryWithThrowingShims$1;hasRequiredFactoryWithThrowingShims$1=1;var a=requireReactPropTypesSecret$1();function s(){}function c(){}return c.resetWarningCache=s,factoryWithThrowingShims$1=function(){function u(f,g,m,p,v,w){if(w!==a){var E=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw E.name="Invariant Violation",E}}u.isRequired=u;function d(){return u}var h={array:u,bigint:u,bool:u,func:u,number:u,object:u,string:u,symbol:u,any:u,arrayOf:d,element:u,elementType:u,instanceOf:d,node:u,objectOf:d,oneOf:d,oneOfType:d,shape:d,exact:d,checkPropTypes:c,resetWarningCache:s};return h.PropTypes=h,h},factoryWithThrowingShims$1}var hasRequiredPropTypes;function requirePropTypes(){return hasRequiredPropTypes||(hasRequiredPropTypes=1,propTypes$1.exports=requireFactoryWithThrowingShims$1()()),propTypes$1.exports}const require$$2=getAugmentedNamespace(ReactDOM__namespace);var clsx={exports:{}},hasRequiredClsx;function requireClsx(){if(hasRequiredClsx)return clsx.exports;hasRequiredClsx=1;function a(c){var u,d,h="";if(typeof c=="string"||typeof c=="number")h+=c;else if(typeof c=="object")if(Array.isArray(c)){var f=c.length;for(u=0;u<f;u++)c[u]&&(d=a(c[u]))&&(h&&(h+=" "),h+=d)}else for(d in c)c[d]&&(h&&(h+=" "),h+=d);return h}function s(){for(var c,u,d=0,h="",f=arguments.length;d<f;d++)(c=arguments[d])&&(u=a(c))&&(h&&(h+=" "),h+=u);return h}return clsx.exports=s,clsx.exports.clsx=s,clsx.exports}var domFns={},shims={},hasRequiredShims;function requireShims(){if(hasRequiredShims)return shims;hasRequiredShims=1,Object.defineProperty(shims,"__esModule",{value:!0}),shims.dontSetMe=d,shims.findInArray=a,shims.int=u,shims.isFunction=s,shims.isNum=c;function a(h,f){for(let g=0,m=h.length;g<m;g++)if(f.apply(f,[h[g],g,h]))return h[g]}function s(h){return typeof h=="function"||Object.prototype.toString.call(h)==="[object Function]"}function c(h){return typeof h=="number"&&!isNaN(h)}function u(h){return parseInt(h,10)}function d(h,f,g){if(h[f])return new Error(`Invalid prop ${f} passed to ${g} - do not set this, set it on the child.`)}return shims}var getPrefix={},hasRequiredGetPrefix;function requireGetPrefix(){if(hasRequiredGetPrefix)return getPrefix;hasRequiredGetPrefix=1,Object.defineProperty(getPrefix,"__esModule",{value:!0}),getPrefix.browserPrefixToKey=c,getPrefix.browserPrefixToStyle=u,getPrefix.default=void 0,getPrefix.getPrefix=s;const a=["Moz","Webkit","O","ms"];function s(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"transform";if(typeof window>"u")return"";const f=window.document?.documentElement?.style;if(!f||h in f)return"";for(let g=0;g<a.length;g++)if(c(h,a[g])in f)return a[g];return""}function c(h,f){return f?`${f}${d(h)}`:h}function u(h,f){return f?`-${f.toLowerCase()}-${h}`:h}function d(h){let f="",g=!0;for(let m=0;m<h.length;m++)g?(f+=h[m].toUpperCase(),g=!1):h[m]==="-"?g=!0:f+=h[m];return f}return getPrefix.default=s(),getPrefix}var hasRequiredDomFns;function requireDomFns(){if(hasRequiredDomFns)return domFns;hasRequiredDomFns=1,Object.defineProperty(domFns,"__esModule",{value:!0}),domFns.addClassName=H,domFns.addEvent=f,domFns.addUserSelectStyles=I,domFns.createCSSTransform=C,domFns.createSVGTransform=b,domFns.getTouch=R,domFns.getTouchIdentifier=T,domFns.getTranslation=P,domFns.innerHeight=v,domFns.innerWidth=w,domFns.matchesSelector=d,domFns.matchesSelectorAndParentsTo=h,domFns.offsetXYFromParent=E,domFns.outerHeight=m,domFns.outerWidth=p,domFns.removeClassName=L,domFns.removeEvent=g,domFns.scheduleRemoveUserSelectStyles=M;var a=requireShims(),s=c(requireGetPrefix());function c(A,k){if(typeof WeakMap=="function")var W=new WeakMap,G=new WeakMap;return(c=function(oe,ae){if(!ae&&oe&&oe.__esModule)return oe;var X,le,ye={__proto__:null,default:oe};if(oe===null||typeof oe!="object"&&typeof oe!="function")return ye;if(X=ae?G:W){if(X.has(oe))return X.get(oe);X.set(oe,ye)}for(const pe in oe)pe!=="default"&&{}.hasOwnProperty.call(oe,pe)&&((le=(X=Object.defineProperty)&&Object.getOwnPropertyDescriptor(oe,pe))&&(le.get||le.set)?X(ye,pe,le):ye[pe]=oe[pe]);return ye})(A,k)}let u="";function d(A,k){return u||(u=(0,a.findInArray)(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(W){return(0,a.isFunction)(A[W])})),(0,a.isFunction)(A[u])?A[u](k):!1}function h(A,k,W){let G=A;do{if(d(G,k))return!0;if(G===W)return!1;G=G.parentNode}while(G);return!1}function f(A,k,W,G){if(!A)return;const oe={capture:!0,...G};A.addEventListener?A.addEventListener(k,W,oe):A.attachEvent?A.attachEvent("on"+k,W):A["on"+k]=W}function g(A,k,W,G){if(!A)return;const oe={capture:!0,...G};A.removeEventListener?A.removeEventListener(k,W,oe):A.detachEvent?A.detachEvent("on"+k,W):A["on"+k]=null}function m(A){let k=A.clientHeight;const W=A.ownerDocument.defaultView.getComputedStyle(A);return k+=(0,a.int)(W.borderTopWidth),k+=(0,a.int)(W.borderBottomWidth),k}function p(A){let k=A.clientWidth;const W=A.ownerDocument.defaultView.getComputedStyle(A);return k+=(0,a.int)(W.borderLeftWidth),k+=(0,a.int)(W.borderRightWidth),k}function v(A){let k=A.clientHeight;const W=A.ownerDocument.defaultView.getComputedStyle(A);return k-=(0,a.int)(W.paddingTop),k-=(0,a.int)(W.paddingBottom),k}function w(A){let k=A.clientWidth;const W=A.ownerDocument.defaultView.getComputedStyle(A);return k-=(0,a.int)(W.paddingLeft),k-=(0,a.int)(W.paddingRight),k}function E(A,k,W){const oe=k===k.ownerDocument.body?{left:0,top:0}:k.getBoundingClientRect(),ae=(A.clientX+k.scrollLeft-oe.left)/W,X=(A.clientY+k.scrollTop-oe.top)/W;return{x:ae,y:X}}function C(A,k){const W=P(A,k,"px");return{[(0,s.browserPrefixToKey)("transform",s.default)]:W}}function b(A,k){return P(A,k,"")}function P(A,k,W){let{x:G,y:oe}=A,ae=`translate(${G}${W},${oe}${W})`;if(k){const X=`${typeof k.x=="string"?k.x:k.x+W}`,le=`${typeof k.y=="string"?k.y:k.y+W}`;ae=`translate(${X}, ${le})`+ae}return ae}function R(A,k){return A.targetTouches&&(0,a.findInArray)(A.targetTouches,W=>k===W.identifier)||A.changedTouches&&(0,a.findInArray)(A.changedTouches,W=>k===W.identifier)}function T(A){if(A.targetTouches&&A.targetTouches[0])return A.targetTouches[0].identifier;if(A.changedTouches&&A.changedTouches[0])return A.changedTouches[0].identifier}function I(A){if(!A)return;let k=A.getElementById("react-draggable-style-el");k||(k=A.createElement("style"),k.type="text/css",k.id="react-draggable-style-el",k.innerHTML=`.react-draggable-transparent-selection *::-moz-selection {all: inherit;}
`,k.innerHTML+=`.react-draggable-transparent-selection *::selection {all: inherit;}
`,A.getElementsByTagName("head")[0].appendChild(k)),A.body&&H(A.body,"react-draggable-transparent-selection")}function M(A){window.requestAnimationFrame?window.requestAnimationFrame(()=>{N(A)}):N(A)}function N(A){if(A)try{if(A.body&&L(A.body,"react-draggable-transparent-selection"),A.selection)A.selection.empty();else{const k=(A.defaultView||window).getSelection();k&&k.type!=="Caret"&&k.removeAllRanges()}}catch{}}function H(A,k){A.classList?A.classList.add(k):A.className.match(new RegExp(`(?:^|\\s)${k}(?!\\S)`))||(A.className+=` ${k}`)}function L(A,k){A.classList?A.classList.remove(k):A.className=A.className.replace(new RegExp(`(?:^|\\s)${k}(?!\\S)`,"g"),"")}return domFns}var positionFns={},hasRequiredPositionFns;function requirePositionFns(){if(hasRequiredPositionFns)return positionFns;hasRequiredPositionFns=1,Object.defineProperty(positionFns,"__esModule",{value:!0}),positionFns.canDragX=d,positionFns.canDragY=h,positionFns.createCoreData=g,positionFns.createDraggableData=m,positionFns.getBoundPosition=c,positionFns.getControlPosition=f,positionFns.snapToGrid=u;var a=requireShims(),s=requireDomFns();function c(w,E,C){if(!w.props.bounds)return[E,C];let{bounds:b}=w.props;b=typeof b=="string"?b:p(b);const P=v(w);if(typeof b=="string"){const{ownerDocument:R}=P,T=R.defaultView;let I;if(b==="parent"?I=P.parentNode:I=P.getRootNode().querySelector(b),!(I instanceof T.HTMLElement))throw new Error('Bounds selector "'+b+'" could not find an element.');const M=I,N=T.getComputedStyle(P),H=T.getComputedStyle(M);b={left:-P.offsetLeft+(0,a.int)(H.paddingLeft)+(0,a.int)(N.marginLeft),top:-P.offsetTop+(0,a.int)(H.paddingTop)+(0,a.int)(N.marginTop),right:(0,s.innerWidth)(M)-(0,s.outerWidth)(P)-P.offsetLeft+(0,a.int)(H.paddingRight)-(0,a.int)(N.marginRight),bottom:(0,s.innerHeight)(M)-(0,s.outerHeight)(P)-P.offsetTop+(0,a.int)(H.paddingBottom)-(0,a.int)(N.marginBottom)}}return(0,a.isNum)(b.right)&&(E=Math.min(E,b.right)),(0,a.isNum)(b.bottom)&&(C=Math.min(C,b.bottom)),(0,a.isNum)(b.left)&&(E=Math.max(E,b.left)),(0,a.isNum)(b.top)&&(C=Math.max(C,b.top)),[E,C]}function u(w,E,C){const b=Math.round(E/w[0])*w[0],P=Math.round(C/w[1])*w[1];return[b,P]}function d(w){return w.props.axis==="both"||w.props.axis==="x"}function h(w){return w.props.axis==="both"||w.props.axis==="y"}function f(w,E,C){const b=typeof E=="number"?(0,s.getTouch)(w,E):null;if(typeof E=="number"&&!b)return null;const P=v(C),R=C.props.offsetParent||P.offsetParent||P.ownerDocument.body;return(0,s.offsetXYFromParent)(b||w,R,C.props.scale)}function g(w,E,C){const b=!(0,a.isNum)(w.lastX),P=v(w);return b?{node:P,deltaX:0,deltaY:0,lastX:E,lastY:C,x:E,y:C}:{node:P,deltaX:E-w.lastX,deltaY:C-w.lastY,lastX:w.lastX,lastY:w.lastY,x:E,y:C}}function m(w,E){const C=w.props.scale;return{node:E.node,x:w.state.x+E.deltaX/C,y:w.state.y+E.deltaY/C,deltaX:E.deltaX/C,deltaY:E.deltaY/C,lastX:w.state.x,lastY:w.state.y}}function p(w){return{left:w.left,top:w.top,right:w.right,bottom:w.bottom}}function v(w){const E=w.findDOMNode();if(!E)throw new Error("<DraggableCore>: Unmounted during event!");return E}return positionFns}var DraggableCore={},log={},hasRequiredLog;function requireLog(){if(hasRequiredLog)return log;hasRequiredLog=1,Object.defineProperty(log,"__esModule",{value:!0}),log.default=a;function a(){}return log}var hasRequiredDraggableCore;function requireDraggableCore(){if(hasRequiredDraggableCore)return DraggableCore;hasRequiredDraggableCore=1,Object.defineProperty(DraggableCore,"__esModule",{value:!0}),DraggableCore.default=void 0;var a=m(require$$0),s=g(requirePropTypes()),c=g(require$$2),u=requireDomFns(),d=requirePositionFns(),h=requireShims(),f=g(requireLog());function g(P){return P&&P.__esModule?P:{default:P}}function m(P,R){if(typeof WeakMap=="function")var T=new WeakMap,I=new WeakMap;return(m=function(M,N){if(!N&&M&&M.__esModule)return M;var H,L,A={__proto__:null,default:M};if(M===null||typeof M!="object"&&typeof M!="function")return A;if(H=N?I:T){if(H.has(M))return H.get(M);H.set(M,A)}for(const k in M)k!=="default"&&{}.hasOwnProperty.call(M,k)&&((L=(H=Object.defineProperty)&&Object.getOwnPropertyDescriptor(M,k))&&(L.get||L.set)?H(A,k,L):A[k]=M[k]);return A})(P,R)}function p(P,R,T){return(R=v(R))in P?Object.defineProperty(P,R,{value:T,enumerable:!0,configurable:!0,writable:!0}):P[R]=T,P}function v(P){var R=w(P,"string");return typeof R=="symbol"?R:R+""}function w(P,R){if(typeof P!="object"||!P)return P;var T=P[Symbol.toPrimitive];if(T!==void 0){var I=T.call(P,R);if(typeof I!="object")return I;throw new TypeError("@@toPrimitive must return a primitive value.")}return(R==="string"?String:Number)(P)}const E={touch:{start:"touchstart",move:"touchmove",stop:"touchend"},mouse:{start:"mousedown",move:"mousemove",stop:"mouseup"}};let C=E.mouse,b=class extends a.Component{constructor(){super(...arguments),p(this,"dragging",!1),p(this,"lastX",NaN),p(this,"lastY",NaN),p(this,"touchIdentifier",null),p(this,"mounted",!1),p(this,"handleDragStart",R=>{if(this.props.onMouseDown(R),!this.props.allowAnyClick&&typeof R.button=="number"&&R.button!==0)return!1;const T=this.findDOMNode();if(!T||!T.ownerDocument||!T.ownerDocument.body)throw new Error("<DraggableCore> not mounted on DragStart!");const{ownerDocument:I}=T;if(this.props.disabled||!(R.target instanceof I.defaultView.Node)||this.props.handle&&!(0,u.matchesSelectorAndParentsTo)(R.target,this.props.handle,T)||this.props.cancel&&(0,u.matchesSelectorAndParentsTo)(R.target,this.props.cancel,T))return;R.type==="touchstart"&&!this.props.allowMobileScroll&&R.preventDefault();const M=(0,u.getTouchIdentifier)(R);this.touchIdentifier=M;const N=(0,d.getControlPosition)(R,M,this);if(N==null)return;const{x:H,y:L}=N,A=(0,d.createCoreData)(this,H,L);(0,f.default)("DraggableCore: handleDragStart: %j",A),(0,f.default)("calling",this.props.onStart),!(this.props.onStart(R,A)===!1||this.mounted===!1)&&(this.props.enableUserSelectHack&&(0,u.addUserSelectStyles)(I),this.dragging=!0,this.lastX=H,this.lastY=L,(0,u.addEvent)(I,C.move,this.handleDrag),(0,u.addEvent)(I,C.stop,this.handleDragStop))}),p(this,"handleDrag",R=>{const T=(0,d.getControlPosition)(R,this.touchIdentifier,this);if(T==null)return;let{x:I,y:M}=T;if(Array.isArray(this.props.grid)){let L=I-this.lastX,A=M-this.lastY;if([L,A]=(0,d.snapToGrid)(this.props.grid,L,A),!L&&!A)return;I=this.lastX+L,M=this.lastY+A}const N=(0,d.createCoreData)(this,I,M);if((0,f.default)("DraggableCore: handleDrag: %j",N),this.props.onDrag(R,N)===!1||this.mounted===!1){try{this.handleDragStop(new MouseEvent("mouseup"))}catch{const A=document.createEvent("MouseEvents");A.initMouseEvent("mouseup",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),this.handleDragStop(A)}return}this.lastX=I,this.lastY=M}),p(this,"handleDragStop",R=>{if(!this.dragging)return;const T=(0,d.getControlPosition)(R,this.touchIdentifier,this);if(T==null)return;let{x:I,y:M}=T;if(Array.isArray(this.props.grid)){let A=I-this.lastX||0,k=M-this.lastY||0;[A,k]=(0,d.snapToGrid)(this.props.grid,A,k),I=this.lastX+A,M=this.lastY+k}const N=(0,d.createCoreData)(this,I,M);if(this.props.onStop(R,N)===!1||this.mounted===!1)return!1;const L=this.findDOMNode();L&&this.props.enableUserSelectHack&&(0,u.scheduleRemoveUserSelectStyles)(L.ownerDocument),(0,f.default)("DraggableCore: handleDragStop: %j",N),this.dragging=!1,this.lastX=NaN,this.lastY=NaN,L&&((0,f.default)("DraggableCore: Removing handlers"),(0,u.removeEvent)(L.ownerDocument,C.move,this.handleDrag),(0,u.removeEvent)(L.ownerDocument,C.stop,this.handleDragStop))}),p(this,"onMouseDown",R=>(C=E.mouse,this.handleDragStart(R))),p(this,"onMouseUp",R=>(C=E.mouse,this.handleDragStop(R))),p(this,"onTouchStart",R=>(C=E.touch,this.handleDragStart(R))),p(this,"onTouchEnd",R=>(C=E.touch,this.handleDragStop(R)))}componentDidMount(){this.mounted=!0;const R=this.findDOMNode();R&&(0,u.addEvent)(R,E.touch.start,this.onTouchStart,{passive:!1})}componentWillUnmount(){this.mounted=!1;const R=this.findDOMNode();if(R){const{ownerDocument:T}=R;(0,u.removeEvent)(T,E.mouse.move,this.handleDrag),(0,u.removeEvent)(T,E.touch.move,this.handleDrag),(0,u.removeEvent)(T,E.mouse.stop,this.handleDragStop),(0,u.removeEvent)(T,E.touch.stop,this.handleDragStop),(0,u.removeEvent)(R,E.touch.start,this.onTouchStart,{passive:!1}),this.props.enableUserSelectHack&&(0,u.scheduleRemoveUserSelectStyles)(T)}}findDOMNode(){return this.props?.nodeRef?this.props?.nodeRef?.current:c.default.findDOMNode(this)}render(){return a.cloneElement(a.Children.only(this.props.children),{onMouseDown:this.onMouseDown,onMouseUp:this.onMouseUp,onTouchEnd:this.onTouchEnd})}};return DraggableCore.default=b,p(b,"displayName","DraggableCore"),p(b,"propTypes",{allowAnyClick:s.default.bool,allowMobileScroll:s.default.bool,children:s.default.node.isRequired,disabled:s.default.bool,enableUserSelectHack:s.default.bool,offsetParent:function(P,R){if(P[R]&&P[R].nodeType!==1)throw new Error("Draggable's offsetParent must be a DOM Node.")},grid:s.default.arrayOf(s.default.number),handle:s.default.string,cancel:s.default.string,nodeRef:s.default.object,onStart:s.default.func,onDrag:s.default.func,onStop:s.default.func,onMouseDown:s.default.func,scale:s.default.number,className:h.dontSetMe,style:h.dontSetMe,transform:h.dontSetMe}),p(b,"defaultProps",{allowAnyClick:!1,allowMobileScroll:!1,disabled:!1,enableUserSelectHack:!0,onStart:function(){},onDrag:function(){},onStop:function(){},onMouseDown:function(){},scale:1}),DraggableCore}var hasRequiredDraggable;function requireDraggable(){return hasRequiredDraggable||(hasRequiredDraggable=1,(function(a){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"DraggableCore",{enumerable:!0,get:function(){return m.default}}),a.default=void 0;var s=w(require$$0),c=v(requirePropTypes()),u=v(require$$2),d=requireClsx(),h=requireDomFns(),f=requirePositionFns(),g=requireShims(),m=v(requireDraggableCore()),p=v(requireLog());function v(T){return T&&T.__esModule?T:{default:T}}function w(T,I){if(typeof WeakMap=="function")var M=new WeakMap,N=new WeakMap;return(w=function(H,L){if(!L&&H&&H.__esModule)return H;var A,k,W={__proto__:null,default:H};if(H===null||typeof H!="object"&&typeof H!="function")return W;if(A=L?N:M){if(A.has(H))return A.get(H);A.set(H,W)}for(const G in H)G!=="default"&&{}.hasOwnProperty.call(H,G)&&((k=(A=Object.defineProperty)&&Object.getOwnPropertyDescriptor(H,G))&&(k.get||k.set)?A(W,G,k):W[G]=H[G]);return W})(T,I)}function E(){return E=Object.assign?Object.assign.bind():function(T){for(var I=1;I<arguments.length;I++){var M=arguments[I];for(var N in M)({}).hasOwnProperty.call(M,N)&&(T[N]=M[N])}return T},E.apply(null,arguments)}function C(T,I,M){return(I=b(I))in T?Object.defineProperty(T,I,{value:M,enumerable:!0,configurable:!0,writable:!0}):T[I]=M,T}function b(T){var I=P(T,"string");return typeof I=="symbol"?I:I+""}function P(T,I){if(typeof T!="object"||!T)return T;var M=T[Symbol.toPrimitive];if(M!==void 0){var N=M.call(T,I);if(typeof N!="object")return N;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(T)}class R extends s.Component{static getDerivedStateFromProps(I,M){let{position:N}=I,{prevPropsPosition:H}=M;return N&&(!H||N.x!==H.x||N.y!==H.y)?((0,p.default)("Draggable: getDerivedStateFromProps %j",{position:N,prevPropsPosition:H}),{x:N.x,y:N.y,prevPropsPosition:{...N}}):null}constructor(I){super(I),C(this,"onDragStart",(M,N)=>{if((0,p.default)("Draggable: onDragStart: %j",N),this.props.onStart(M,(0,f.createDraggableData)(this,N))===!1)return!1;this.setState({dragging:!0,dragged:!0})}),C(this,"onDrag",(M,N)=>{if(!this.state.dragging)return!1;(0,p.default)("Draggable: onDrag: %j",N);const H=(0,f.createDraggableData)(this,N),L={x:H.x,y:H.y,slackX:0,slackY:0};if(this.props.bounds){const{x:k,y:W}=L;L.x+=this.state.slackX,L.y+=this.state.slackY;const[G,oe]=(0,f.getBoundPosition)(this,L.x,L.y);L.x=G,L.y=oe,L.slackX=this.state.slackX+(k-L.x),L.slackY=this.state.slackY+(W-L.y),H.x=L.x,H.y=L.y,H.deltaX=L.x-this.state.x,H.deltaY=L.y-this.state.y}if(this.props.onDrag(M,H)===!1)return!1;this.setState(L)}),C(this,"onDragStop",(M,N)=>{if(!this.state.dragging||this.props.onStop(M,(0,f.createDraggableData)(this,N))===!1)return!1;(0,p.default)("Draggable: onDragStop: %j",N);const L={dragging:!1,slackX:0,slackY:0};if(!!this.props.position){const{x:k,y:W}=this.props.position;L.x=k,L.y=W}this.setState(L)}),this.state={dragging:!1,dragged:!1,x:I.position?I.position.x:I.defaultPosition.x,y:I.position?I.position.y:I.defaultPosition.y,prevPropsPosition:{...I.position},slackX:0,slackY:0,isElementSVG:!1},I.position&&!(I.onDrag||I.onStop)&&console.warn("A `position` was applied to this <Draggable>, without drag handlers. This will make this component effectively undraggable. Please attach `onDrag` or `onStop` handlers so you can adjust the `position` of this element.")}componentDidMount(){typeof window.SVGElement<"u"&&this.findDOMNode()instanceof window.SVGElement&&this.setState({isElementSVG:!0})}componentWillUnmount(){this.state.dragging&&this.setState({dragging:!1})}findDOMNode(){return this.props?.nodeRef?.current??u.default.findDOMNode(this)}render(){const{axis:I,bounds:M,children:N,defaultPosition:H,defaultClassName:L,defaultClassNameDragging:A,defaultClassNameDragged:k,position:W,positionOffset:G,scale:oe,...ae}=this.props;let X={},le=null;const pe=!!!W||this.state.dragging,he=W||H,Me={x:(0,f.canDragX)(this)&&pe?this.state.x:he.x,y:(0,f.canDragY)(this)&&pe?this.state.y:he.y};this.state.isElementSVG?le=(0,h.createSVGTransform)(Me,G):X=(0,h.createCSSTransform)(Me,G);const Qe=(0,d.clsx)(N.props.className||"",L,{[A]:this.state.dragging,[k]:this.state.dragged});return s.createElement(m.default,E({},ae,{onStart:this.onDragStart,onDrag:this.onDrag,onStop:this.onDragStop}),s.cloneElement(s.Children.only(N),{className:Qe,style:{...N.props.style,...X},transform:le}))}}a.default=R,C(R,"displayName","Draggable"),C(R,"propTypes",{...m.default.propTypes,axis:c.default.oneOf(["both","x","y","none"]),bounds:c.default.oneOfType([c.default.shape({left:c.default.number,right:c.default.number,top:c.default.number,bottom:c.default.number}),c.default.string,c.default.oneOf([!1])]),defaultClassName:c.default.string,defaultClassNameDragging:c.default.string,defaultClassNameDragged:c.default.string,defaultPosition:c.default.shape({x:c.default.number,y:c.default.number}),positionOffset:c.default.shape({x:c.default.oneOfType([c.default.number,c.default.string]),y:c.default.oneOfType([c.default.number,c.default.string])}),position:c.default.shape({x:c.default.number,y:c.default.number}),className:g.dontSetMe,style:g.dontSetMe,transform:g.dontSetMe}),C(R,"defaultProps",{...m.default.defaultProps,axis:"both",bounds:!1,defaultClassName:"react-draggable",defaultClassNameDragging:"react-draggable-dragging",defaultClassNameDragged:"react-draggable-dragged",defaultPosition:{x:0,y:0},scale:1})})(Draggable$1)),Draggable$1}var hasRequiredCjs;function requireCjs(){if(hasRequiredCjs)return cjs.exports;hasRequiredCjs=1;const{default:a,DraggableCore:s}=requireDraggable();return cjs.exports=a,cjs.exports.default=a,cjs.exports.DraggableCore=s,cjs.exports}var cjsExports=requireCjs();const Draggable=getDefaultExportFromCjs$2(cjsExports),Icon={SelectWindow:jsxRuntime.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"rgba(0, 0, 0, 0.45)",children:jsxRuntime.jsx("path",{d:"M640-160v-360H160v360h480Zm80-200v-80h80v-360H320v200h-80v-200q0-33 23.5-56.5T320-880h480q33 0 56.5 23.5T880-800v360q0 33-23.5 56.5T800-360h-80ZM160-80q-33 0-56.5-23.5T80-160v-360q0-33 23.5-56.5T160-600h480q33 0 56.5 23.5T720-520v360q0 33-23.5 56.5T640-80H160Zm400-603ZM400-340Z"})})};var __assign$1=function(){return __assign$1=Object.assign||function(a){for(var s,c=1,u=arguments.length;c<u;c++){s=arguments[c];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},__assign$1.apply(this,arguments)},rowSizeBase={width:"100%",height:"10px",top:"0px",left:"0px",cursor:"row-resize"},colSizeBase={width:"10px",height:"100%",top:"0px",left:"0px",cursor:"col-resize"},edgeBase={width:"20px",height:"20px",position:"absolute",zIndex:1},styles={top:__assign$1(__assign$1({},rowSizeBase),{top:"-5px"}),right:__assign$1(__assign$1({},colSizeBase),{left:void 0,right:"-5px"}),bottom:__assign$1(__assign$1({},rowSizeBase),{top:void 0,bottom:"-5px"}),left:__assign$1(__assign$1({},colSizeBase),{left:"-5px"}),topRight:__assign$1(__assign$1({},edgeBase),{right:"-10px",top:"-10px",cursor:"ne-resize"}),bottomRight:__assign$1(__assign$1({},edgeBase),{right:"-10px",bottom:"-10px",cursor:"se-resize"}),bottomLeft:__assign$1(__assign$1({},edgeBase),{left:"-10px",bottom:"-10px",cursor:"sw-resize"}),topLeft:__assign$1(__assign$1({},edgeBase),{left:"-10px",top:"-10px",cursor:"nw-resize"})},Resizer=React.memo(function(a){var s=a.onResizeStart,c=a.direction,u=a.children,d=a.replaceStyles,h=a.className,f=React.useCallback(function(p){s(p,c)},[s,c]),g=React.useCallback(function(p){s(p,c)},[s,c]),m=React.useMemo(function(){return __assign$1(__assign$1({position:"absolute",userSelect:"none"},styles[c]),d??{})},[d,c]);return jsxRuntime.jsx("div",{className:h||void 0,style:m,onMouseDown:f,onTouchStart:g,children:u})}),__extends=(function(){var a=function(s,c){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(u,d){u.__proto__=d}||function(u,d){for(var h in d)Object.prototype.hasOwnProperty.call(d,h)&&(u[h]=d[h])},a(s,c)};return function(s,c){if(typeof c!="function"&&c!==null)throw new TypeError("Class extends value "+String(c)+" is not a constructor or null");a(s,c);function u(){this.constructor=s}s.prototype=c===null?Object.create(c):(u.prototype=c.prototype,new u)}})(),__assign=function(){return __assign=Object.assign||function(a){for(var s,c=1,u=arguments.length;c<u;c++){s=arguments[c];for(var d in s)Object.prototype.hasOwnProperty.call(s,d)&&(a[d]=s[d])}return a},__assign.apply(this,arguments)},DEFAULT_SIZE={width:"auto",height:"auto"},clamp$1=function(a,s,c){return Math.max(Math.min(a,c),s)},snap=function(a,s,c){var u=Math.round(a/s);return u*s+c*(u-1)},hasDirection=function(a,s){return new RegExp(a,"i").test(s)},isTouchEvent$1=function(a){return!!(a.touches&&a.touches.length)},isMouseEvent=function(a){return!!((a.clientX||a.clientX===0)&&(a.clientY||a.clientY===0))},findClosestSnap=function(a,s,c){c===void 0&&(c=0);var u=s.reduce(function(h,f,g){return Math.abs(f-a)<Math.abs(s[h]-a)?g:h},0),d=Math.abs(s[u]-a);return c===0||d<c?s[u]:a},getStringSize=function(a){return a=a.toString(),a==="auto"||a.endsWith("px")||a.endsWith("%")||a.endsWith("vh")||a.endsWith("vw")||a.endsWith("vmax")||a.endsWith("vmin")?a:"".concat(a,"px")},getPixelSize=function(a,s,c,u){if(a&&typeof a=="string"){if(a.endsWith("px"))return Number(a.replace("px",""));if(a.endsWith("%")){var d=Number(a.replace("%",""))/100;return s*d}if(a.endsWith("vw")){var d=Number(a.replace("vw",""))/100;return c*d}if(a.endsWith("vh")){var d=Number(a.replace("vh",""))/100;return u*d}}return a},calculateNewMax=function(a,s,c,u,d,h,f){return u=getPixelSize(u,a.width,s,c),d=getPixelSize(d,a.height,s,c),h=getPixelSize(h,a.width,s,c),f=getPixelSize(f,a.height,s,c),{maxWidth:typeof u>"u"?void 0:Number(u),maxHeight:typeof d>"u"?void 0:Number(d),minWidth:typeof h>"u"?void 0:Number(h),minHeight:typeof f>"u"?void 0:Number(f)}},normalizeToPair=function(a){return Array.isArray(a)?a:[a,a]},definedProps=["as","ref","style","className","grid","gridGap","snap","bounds","boundsByDirection","size","defaultSize","minWidth","minHeight","maxWidth","maxHeight","lockAspectRatio","lockAspectRatioExtraWidth","lockAspectRatioExtraHeight","enable","handleStyles","handleClasses","handleWrapperStyle","handleWrapperClass","children","onResizeStart","onResize","onResizeStop","handleComponent","scale","resizeRatio","snapGap"],baseClassName="__resizable_base__",Resizable=(function(a){__extends(s,a);function s(c){var u,d,h,f,g=a.call(this,c)||this;return g.ratio=1,g.resizable=null,g.parentLeft=0,g.parentTop=0,g.resizableLeft=0,g.resizableRight=0,g.resizableTop=0,g.resizableBottom=0,g.targetLeft=0,g.targetTop=0,g.delta={width:0,height:0},g.appendBase=function(){if(!g.resizable||!g.window)return null;var m=g.parentNode;if(!m)return null;var p=g.window.document.createElement("div");return p.style.width="100%",p.style.height="100%",p.style.position="absolute",p.style.transform="scale(0, 0)",p.style.left="0",p.style.flex="0 0 100%",p.classList?p.classList.add(baseClassName):p.className+=baseClassName,m.appendChild(p),p},g.removeBase=function(m){var p=g.parentNode;p&&p.removeChild(m)},g.state={isResizing:!1,width:(d=(u=g.propsSize)===null||u===void 0?void 0:u.width)!==null&&d!==void 0?d:"auto",height:(f=(h=g.propsSize)===null||h===void 0?void 0:h.height)!==null&&f!==void 0?f:"auto",direction:"right",original:{x:0,y:0,width:0,height:0},backgroundStyle:{height:"100%",width:"100%",backgroundColor:"rgba(0,0,0,0)",cursor:"auto",opacity:0,position:"fixed",zIndex:9999,top:"0",left:"0",bottom:"0",right:"0"},flexBasis:void 0},g.onResizeStart=g.onResizeStart.bind(g),g.onMouseMove=g.onMouseMove.bind(g),g.onMouseUp=g.onMouseUp.bind(g),g}return Object.defineProperty(s.prototype,"parentNode",{get:function(){return this.resizable?this.resizable.parentNode:null},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"window",{get:function(){return!this.resizable||!this.resizable.ownerDocument?null:this.resizable.ownerDocument.defaultView},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"propsSize",{get:function(){return this.props.size||this.props.defaultSize||DEFAULT_SIZE},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"size",{get:function(){var c=0,u=0;if(this.resizable&&this.window){var d=this.resizable.offsetWidth,h=this.resizable.offsetHeight,f=this.resizable.style.position;f!=="relative"&&(this.resizable.style.position="relative"),c=this.resizable.style.width!=="auto"?this.resizable.offsetWidth:d,u=this.resizable.style.height!=="auto"?this.resizable.offsetHeight:h,this.resizable.style.position=f}return{width:c,height:u}},enumerable:!1,configurable:!0}),Object.defineProperty(s.prototype,"sizeStyle",{get:function(){var c=this,u=this.props.size,d=function(g){var m;if(typeof c.state[g]>"u"||c.state[g]==="auto")return"auto";if(c.propsSize&&c.propsSize[g]&&(!((m=c.propsSize[g])===null||m===void 0)&&m.toString().endsWith("%"))){if(c.state[g].toString().endsWith("%"))return c.state[g].toString();var p=c.getParentSize(),v=Number(c.state[g].toString().replace("px","")),w=v/p[g]*100;return"".concat(w,"%")}return getStringSize(c.state[g])},h=u&&typeof u.width<"u"&&!this.state.isResizing?getStringSize(u.width):d("width"),f=u&&typeof u.height<"u"&&!this.state.isResizing?getStringSize(u.height):d("height");return{width:h,height:f}},enumerable:!1,configurable:!0}),s.prototype.getParentSize=function(){if(!this.parentNode)return this.window?{width:this.window.innerWidth,height:this.window.innerHeight}:{width:0,height:0};var c=this.appendBase();if(!c)return{width:0,height:0};var u=!1,d=this.parentNode.style.flexWrap;d!=="wrap"&&(u=!0,this.parentNode.style.flexWrap="wrap"),c.style.position="relative",c.style.minWidth="100%",c.style.minHeight="100%";var h={width:c.offsetWidth,height:c.offsetHeight};return u&&(this.parentNode.style.flexWrap=d),this.removeBase(c),h},s.prototype.bindEvents=function(){this.window&&(this.window.addEventListener("mouseup",this.onMouseUp),this.window.addEventListener("mousemove",this.onMouseMove),this.window.addEventListener("mouseleave",this.onMouseUp),this.window.addEventListener("touchmove",this.onMouseMove,{capture:!0,passive:!1}),this.window.addEventListener("touchend",this.onMouseUp))},s.prototype.unbindEvents=function(){this.window&&(this.window.removeEventListener("mouseup",this.onMouseUp),this.window.removeEventListener("mousemove",this.onMouseMove),this.window.removeEventListener("mouseleave",this.onMouseUp),this.window.removeEventListener("touchmove",this.onMouseMove,!0),this.window.removeEventListener("touchend",this.onMouseUp))},s.prototype.componentDidMount=function(){if(!(!this.resizable||!this.window)){var c=this.window.getComputedStyle(this.resizable);this.setState({width:this.state.width||this.size.width,height:this.state.height||this.size.height,flexBasis:c.flexBasis!=="auto"?c.flexBasis:void 0})}},s.prototype.componentWillUnmount=function(){this.window&&this.unbindEvents()},s.prototype.createSizeForCssProperty=function(c,u){var d=this.propsSize&&this.propsSize[u];return this.state[u]==="auto"&&this.state.original[u]===c&&(typeof d>"u"||d==="auto")?"auto":c},s.prototype.calculateNewMaxFromBoundary=function(c,u){var d=this.props.boundsByDirection,h=this.state.direction,f=d&&hasDirection("left",h),g=d&&hasDirection("top",h),m,p;if(this.props.bounds==="parent"){var v=this.parentNode;v&&(m=f?this.resizableRight-this.parentLeft:v.offsetWidth+(this.parentLeft-this.resizableLeft),p=g?this.resizableBottom-this.parentTop:v.offsetHeight+(this.parentTop-this.resizableTop))}else this.props.bounds==="window"?this.window&&(m=f?this.resizableRight:this.window.innerWidth-this.resizableLeft,p=g?this.resizableBottom:this.window.innerHeight-this.resizableTop):this.props.bounds&&(m=f?this.resizableRight-this.targetLeft:this.props.bounds.offsetWidth+(this.targetLeft-this.resizableLeft),p=g?this.resizableBottom-this.targetTop:this.props.bounds.offsetHeight+(this.targetTop-this.resizableTop));return m&&Number.isFinite(m)&&(c=c&&c<m?c:m),p&&Number.isFinite(p)&&(u=u&&u<p?u:p),{maxWidth:c,maxHeight:u}},s.prototype.calculateNewSizeFromDirection=function(c,u){var d=this.props.scale||1,h=normalizeToPair(this.props.resizeRatio||1),f=h[0],g=h[1],m=this.state,p=m.direction,v=m.original,w=this.props,E=w.lockAspectRatio,C=w.lockAspectRatioExtraHeight,b=w.lockAspectRatioExtraWidth,P=v.width,R=v.height,T=C||0,I=b||0;return hasDirection("right",p)&&(P=v.width+(c-v.x)*f/d,E&&(R=(P-I)/this.ratio+T)),hasDirection("left",p)&&(P=v.width-(c-v.x)*f/d,E&&(R=(P-I)/this.ratio+T)),hasDirection("bottom",p)&&(R=v.height+(u-v.y)*g/d,E&&(P=(R-T)*this.ratio+I)),hasDirection("top",p)&&(R=v.height-(u-v.y)*g/d,E&&(P=(R-T)*this.ratio+I)),{newWidth:P,newHeight:R}},s.prototype.calculateNewSizeFromAspectRatio=function(c,u,d,h){var f=this.props,g=f.lockAspectRatio,m=f.lockAspectRatioExtraHeight,p=f.lockAspectRatioExtraWidth,v=typeof h.width>"u"?10:h.width,w=typeof d.width>"u"||d.width<0?c:d.width,E=typeof h.height>"u"?10:h.height,C=typeof d.height>"u"||d.height<0?u:d.height,b=m||0,P=p||0;if(g){var R=(E-b)*this.ratio+P,T=(C-b)*this.ratio+P,I=(v-P)/this.ratio+b,M=(w-P)/this.ratio+b,N=Math.max(v,R),H=Math.min(w,T),L=Math.max(E,I),A=Math.min(C,M);c=clamp$1(c,N,H),u=clamp$1(u,L,A)}else c=clamp$1(c,v,w),u=clamp$1(u,E,C);return{newWidth:c,newHeight:u}},s.prototype.setBoundingClientRect=function(){var c=1/(this.props.scale||1);if(this.props.bounds==="parent"){var u=this.parentNode;if(u){var d=u.getBoundingClientRect();this.parentLeft=d.left*c,this.parentTop=d.top*c}}if(this.props.bounds&&typeof this.props.bounds!="string"){var h=this.props.bounds.getBoundingClientRect();this.targetLeft=h.left*c,this.targetTop=h.top*c}if(this.resizable){var f=this.resizable.getBoundingClientRect(),g=f.left,m=f.top,p=f.right,v=f.bottom;this.resizableLeft=g*c,this.resizableRight=p*c,this.resizableTop=m*c,this.resizableBottom=v*c}},s.prototype.onResizeStart=function(c,u){if(!(!this.resizable||!this.window)){var d=0,h=0;if(c.nativeEvent&&isMouseEvent(c.nativeEvent)?(d=c.nativeEvent.clientX,h=c.nativeEvent.clientY):c.nativeEvent&&isTouchEvent$1(c.nativeEvent)&&(d=c.nativeEvent.touches[0].clientX,h=c.nativeEvent.touches[0].clientY),this.props.onResizeStart&&this.resizable){var f=this.props.onResizeStart(c,u,this.resizable);if(f===!1)return}this.props.size&&(typeof this.props.size.height<"u"&&this.props.size.height!==this.state.height&&this.setState({height:this.props.size.height}),typeof this.props.size.width<"u"&&this.props.size.width!==this.state.width&&this.setState({width:this.props.size.width})),this.ratio=typeof this.props.lockAspectRatio=="number"?this.props.lockAspectRatio:this.size.width/this.size.height;var g,m=this.window.getComputedStyle(this.resizable);if(m.flexBasis!=="auto"){var p=this.parentNode;if(p){var v=this.window.getComputedStyle(p).flexDirection;this.flexDir=v.startsWith("row")?"row":"column",g=m.flexBasis}}this.setBoundingClientRect(),this.bindEvents();var w={original:{x:d,y:h,width:this.size.width,height:this.size.height},isResizing:!0,backgroundStyle:__assign(__assign({},this.state.backgroundStyle),{cursor:this.window.getComputedStyle(c.target).cursor||"auto"}),direction:u,flexBasis:g};this.setState(w)}},s.prototype.onMouseMove=function(c){var u=this;if(!(!this.state.isResizing||!this.resizable||!this.window)){if(this.window.TouchEvent&&isTouchEvent$1(c))try{c.preventDefault(),c.stopPropagation()}catch{}var d=this.props,h=d.maxWidth,f=d.maxHeight,g=d.minWidth,m=d.minHeight,p=isTouchEvent$1(c)?c.touches[0].clientX:c.clientX,v=isTouchEvent$1(c)?c.touches[0].clientY:c.clientY,w=this.state,E=w.direction,C=w.original,b=w.width,P=w.height,R=this.getParentSize(),T=calculateNewMax(R,this.window.innerWidth,this.window.innerHeight,h,f,g,m);h=T.maxWidth,f=T.maxHeight,g=T.minWidth,m=T.minHeight;var I=this.calculateNewSizeFromDirection(p,v),M=I.newHeight,N=I.newWidth,H=this.calculateNewMaxFromBoundary(h,f);this.props.snap&&this.props.snap.x&&(N=findClosestSnap(N,this.props.snap.x,this.props.snapGap)),this.props.snap&&this.props.snap.y&&(M=findClosestSnap(M,this.props.snap.y,this.props.snapGap));var L=this.calculateNewSizeFromAspectRatio(N,M,{width:H.maxWidth,height:H.maxHeight},{width:g,height:m});if(N=L.newWidth,M=L.newHeight,this.props.grid){var A=snap(N,this.props.grid[0],this.props.gridGap?this.props.gridGap[0]:0),k=snap(M,this.props.grid[1],this.props.gridGap?this.props.gridGap[1]:0),W=this.props.snapGap||0,G=W===0||Math.abs(A-N)<=W?A:N,oe=W===0||Math.abs(k-M)<=W?k:M;N=G,M=oe}var ae={width:N-C.width,height:M-C.height};if(this.delta=ae,b&&typeof b=="string"){if(b.endsWith("%")){var X=N/R.width*100;N="".concat(X,"%")}else if(b.endsWith("vw")){var le=N/this.window.innerWidth*100;N="".concat(le,"vw")}else if(b.endsWith("vh")){var ye=N/this.window.innerHeight*100;N="".concat(ye,"vh")}}if(P&&typeof P=="string"){if(P.endsWith("%")){var X=M/R.height*100;M="".concat(X,"%")}else if(P.endsWith("vw")){var le=M/this.window.innerWidth*100;M="".concat(le,"vw")}else if(P.endsWith("vh")){var ye=M/this.window.innerHeight*100;M="".concat(ye,"vh")}}var pe={width:this.createSizeForCssProperty(N,"width"),height:this.createSizeForCssProperty(M,"height")};this.flexDir==="row"?pe.flexBasis=pe.width:this.flexDir==="column"&&(pe.flexBasis=pe.height);var he=this.state.width!==pe.width,Me=this.state.height!==pe.height,Qe=this.state.flexBasis!==pe.flexBasis,Xe=he||Me||Qe;Xe&&ReactDOM.flushSync(function(){u.setState(pe)}),this.props.onResize&&Xe&&this.props.onResize(c,E,this.resizable,ae)}},s.prototype.onMouseUp=function(c){var u,d,h=this.state,f=h.isResizing,g=h.direction;h.original,!(!f||!this.resizable)&&(this.props.onResizeStop&&this.props.onResizeStop(c,g,this.resizable,this.delta),this.props.size&&this.setState({width:(u=this.props.size.width)!==null&&u!==void 0?u:"auto",height:(d=this.props.size.height)!==null&&d!==void 0?d:"auto"}),this.unbindEvents(),this.setState({isResizing:!1,backgroundStyle:__assign(__assign({},this.state.backgroundStyle),{cursor:"auto"})}))},s.prototype.updateSize=function(c){var u,d;this.setState({width:(u=c.width)!==null&&u!==void 0?u:"auto",height:(d=c.height)!==null&&d!==void 0?d:"auto"})},s.prototype.renderResizer=function(){var c=this,u=this.props,d=u.enable,h=u.handleStyles,f=u.handleClasses,g=u.handleWrapperStyle,m=u.handleWrapperClass,p=u.handleComponent;if(!d)return null;var v=Object.keys(d).map(function(w){return d[w]!==!1?jsxRuntime.jsx(Resizer,{direction:w,onResizeStart:c.onResizeStart,replaceStyles:h&&h[w],className:f&&f[w],children:p&&p[w]?p[w]:null},w):null});return jsxRuntime.jsx("div",{className:m,style:g,children:v})},s.prototype.render=function(){var c=this,u=Object.keys(this.props).reduce(function(f,g){return definedProps.indexOf(g)!==-1||(f[g]=c.props[g]),f},{}),d=__assign(__assign(__assign({position:"relative",userSelect:this.state.isResizing?"none":"auto"},this.props.style),this.sizeStyle),{maxWidth:this.props.maxWidth,maxHeight:this.props.maxHeight,minWidth:this.props.minWidth,minHeight:this.props.minHeight,boxSizing:"border-box",flexShrink:0});this.state.flexBasis&&(d.flexBasis=this.state.flexBasis);var h=this.props.as||"div";return jsxRuntime.jsxs(h,__assign({style:d,className:this.props.className},u,{ref:function(f){f&&(c.resizable=f)},children:[this.state.isResizing&&jsxRuntime.jsx("div",{style:this.state.backgroundStyle}),this.props.children,this.renderResizer()]}))},s.defaultProps={as:"div",onResizeStart:function(){},onResize:function(){},onResizeStop:function(){},enable:{top:!0,right:!0,bottom:!0,left:!0,topRight:!0,bottomRight:!0,bottomLeft:!0,topLeft:!0},style:{},grid:[1,1],gridGap:[0,0],lockAspectRatio:!1,lockAspectRatioExtraWidth:0,lockAspectRatioExtraHeight:0,scale:1,resizeRatio:1,snapGap:0},s})(React.PureComponent);function AdjustableWindow(a){const{className:s,children:c,title:u,footer:d,windowProps:h,onAdjust:f,open:g,onCancel:m,...p}=a,[v,w]=React.useState(h),E=React.useRef(null),C=React.useRef(null),b=React.useRef(null);React.useEffect(()=>{w(a.windowProps)},[a.windowProps]);function P(){if(v.adjustable)f({...v,adjustable:!v.adjustable});else{const N={adjustable:!0};if(v.width===0&&E.current){const H=E.current.getBoundingClientRect();N.x=0,N.y=0,N.width=H.width,N.height=H.height}f({...v,...N})}}function R(N,H,L,A){const{width:k,height:W}=A;H==="bottomRight"?w(G=>({...G,width:h.width+k,height:h.height+W})):H==="bottomLeft"?w(G=>({...G,width:h.width+k,height:h.height+W,x:h.x-k})):H==="topRight"?w(G=>({...G,width:h.width+k,height:h.height+W,y:h.y-W})):H==="topLeft"?w(G=>({...G,width:h.width+k,height:h.height+W,x:h.x-k,y:h.y-W})):H==="top"?w(G=>({...G,height:h.height+W,y:h.y-W})):H==="bottom"?w(G=>({...G,height:h.height+W})):H==="right"?w(G=>({...G,width:h.width+k})):H==="left"&&w(G=>({...G,width:h.width+k,x:h.x-k}))}function T(N,H,L,A){const{width:k,height:W}=A;f({...v,width:h.width+k,height:h.height+W})}function I(N,H){w(L=>({...L,x:L.x+H.deltaX,y:L.y+H.deltaY}))}function M(N,H){f({...v,x:H.lastX,y:H.lastY})}return jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("style",{children:`
          .${s} {
            ${v.adjustable?"":` .ant-modal-content {
                      width: fit-content;
                    }`}
            .ant-modal-body {
              width: ${v.adjustable?v.width-20+"px":"70vw"};
              height: ${v.adjustable?v.height-(b.current?b.current.getBoundingClientRect().height+72:170)+"px":"75vh"};
              overflow: hidden;
            }
          }
        `}),jsxRuntime.jsx(antd.Modal,{className:s+" adjustable-window top-2",panelRef:E,width:"70vw",centered:!0,title:jsxRuntime.jsxs("div",{ref:C,className:"flex justify-between"+(v.adjustable?" handle cursor-move":""),children:[jsxRuntime.jsx("div",{className:"w-full",children:a.title}),jsxRuntime.jsx(antd.Button,{className:"mr-[40px] mt-[3px] border-none",icon:Icon.SelectWindow,type:"text",onClick:P})]}),open:g,onCancel:m,footer:jsxRuntime.jsx("div",{className:v.adjustable?"handle cursor-move":"",ref:b,children:d}),maskClosable:!v.adjustable,mask:!v.adjustable,styles:{content:{padding:10},footer:{marginTop:5}},wrapStyle:v.adjustable?{pointerEvents:"none"}:void 0,modalRender:v.adjustable?N=>jsxRuntime.jsx(Draggable,{handle:".handle",position:{x:v.x,y:v.y},onDrag:I,onStop:M,children:jsxRuntime.jsx(Resizable,{className:"re-resizable",handleWrapperStyle:{pointerEvents:"all"},size:{width:v.width,height:v.height},onResize:R,onResizeStop:T,children:jsxRuntime.jsx("div",{children:N})})}):void 0,...p,children:a.children})]})}const supportedFiles={image:["image/jpeg","image/jpg","image/png"]};function fileInput(a={}){return new Promise(s=>{const c=document.createElement("input");c.type="file",c.multiple=!!a.multiple,a.accept?.length&&(c.accept=a.accept.join(",")),c.onchange=()=>{const u=c.files?Array.from(c.files):[];s(u)},c.click()})}class IDBManager{db=null;constructor(){this.db=null}async open(s,c,u){return this.db?this.db:new Promise((d,h)=>{const f=indexedDB.open(s,c);f.onupgradeneeded=g=>{const m=g.target.result;Object.entries(u).forEach(([p,v])=>{m.objectStoreNames.contains(p)||m.createObjectStore(p,v)})},f.onsuccess=g=>{this.db=g.target.result,d(this.db)},f.onerror=()=>h(f.error)})}getObjectStore(s,c){if(!this.db)throw new Error("Database not opened");return this.db.transaction(s,c).objectStore(s)}async put(s,c,u){return new Promise((d,h)=>{const f=this.getObjectStore(s,"readwrite").put(c,u);f.onsuccess=()=>d(),f.onerror=()=>h(f.error)})}async get(s,c){return new Promise((u,d)=>{const h=this.getObjectStore(s,"readonly").get(c);h.onsuccess=()=>u(h.result),h.onerror=()=>d(h.error)})}async delete(s,c){return new Promise((u,d)=>{const h=this.getObjectStore(s,"readwrite").delete(c);h.onsuccess=()=>u(),h.onerror=()=>d(h.error)})}async getAll(s){return new Promise((c,u)=>{const d=this.getObjectStore(s,"readonly").getAll();d.onsuccess=()=>c(d.result),d.onerror=()=>u(d.error)})}async clear(s){return new Promise((c,u)=>{const d=this.getObjectStore(s,"readwrite").clear();d.onsuccess=()=>c(),d.onerror=()=>u(d.error)})}}const dbStores={fileHandle:{keyPath:"id"}},idb=new IDBManager;idb.open(extId,1,dbStores);async function download(a,s,c){try{const u=await urlToBlob(a);if(u){const d=URL.createObjectURL(u),h=await mc.send("download",d,s,c);if(URL.revokeObjectURL(d),h)throw new Error(h)}}catch(u){antd.message.error("下载文件出错："+u.message)}}function ImagesRender(a){const s=a.value;return jsxRuntime.jsx("div",{onDrop:a.cellProperties.onDropImages,onDragOver:c=>c.preventDefault(),"data-row":a.row,children:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("button",{onClick:a.cellProperties.onAddImages,"data-row":a.row,children:"添加图片"}),jsxRuntime.jsx("br",{}),jsxRuntime.jsx("div",{className:"flex flex-wrap",children:s?.filter(c=>c.base64).map((c,u)=>jsxRuntime.jsxs("div",{style:{position:"relative"},children:[jsxRuntime.jsx("img",{src:c.base64}),jsxRuntime.jsx("div",{className:"delete-btn",onClick:a.cellProperties.onDeleteImage,"data-row":a.row,"data-index":u,children:"×"})]}))})]})})}var es_error_cause={},globalThis_1,hasRequiredGlobalThis;function requireGlobalThis(){if(hasRequiredGlobalThis)return globalThis_1;hasRequiredGlobalThis=1;var a=function(s){return s&&s.Math===Math&&s};return globalThis_1=a(typeof globalThis=="object"&&globalThis)||a(typeof window=="object"&&window)||a(typeof self=="object"&&self)||a(typeof commonjsGlobal$1=="object"&&commonjsGlobal$1)||a(typeof globalThis_1=="object"&&globalThis_1)||(function(){return this})()||Function("return this")(),globalThis_1}var objectGetOwnPropertyDescriptor={},fails,hasRequiredFails;function requireFails(){return hasRequiredFails||(hasRequiredFails=1,fails=function(a){try{return!!a()}catch{return!0}}),fails}var descriptors,hasRequiredDescriptors;function requireDescriptors(){if(hasRequiredDescriptors)return descriptors;hasRequiredDescriptors=1;var a=requireFails();return descriptors=!a(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),descriptors}var functionBindNative,hasRequiredFunctionBindNative;function requireFunctionBindNative(){if(hasRequiredFunctionBindNative)return functionBindNative;hasRequiredFunctionBindNative=1;var a=requireFails();return functionBindNative=!a(function(){var s=(function(){}).bind();return typeof s!="function"||s.hasOwnProperty("prototype")}),functionBindNative}var functionCall,hasRequiredFunctionCall;function requireFunctionCall(){if(hasRequiredFunctionCall)return functionCall;hasRequiredFunctionCall=1;var a=requireFunctionBindNative(),s=Function.prototype.call;return functionCall=a?s.bind(s):function(){return s.apply(s,arguments)},functionCall}var objectPropertyIsEnumerable={},hasRequiredObjectPropertyIsEnumerable;function requireObjectPropertyIsEnumerable(){if(hasRequiredObjectPropertyIsEnumerable)return objectPropertyIsEnumerable;hasRequiredObjectPropertyIsEnumerable=1;var a={}.propertyIsEnumerable,s=Object.getOwnPropertyDescriptor,c=s&&!a.call({1:2},1);return objectPropertyIsEnumerable.f=c?function(d){var h=s(this,d);return!!h&&h.enumerable}:a,objectPropertyIsEnumerable}var createPropertyDescriptor,hasRequiredCreatePropertyDescriptor;function requireCreatePropertyDescriptor(){return hasRequiredCreatePropertyDescriptor||(hasRequiredCreatePropertyDescriptor=1,createPropertyDescriptor=function(a,s){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:s}}),createPropertyDescriptor}var functionUncurryThis,hasRequiredFunctionUncurryThis;function requireFunctionUncurryThis(){if(hasRequiredFunctionUncurryThis)return functionUncurryThis;hasRequiredFunctionUncurryThis=1;var a=requireFunctionBindNative(),s=Function.prototype,c=s.call,u=a&&s.bind.bind(c,c);return functionUncurryThis=a?u:function(d){return function(){return c.apply(d,arguments)}},functionUncurryThis}var classofRaw,hasRequiredClassofRaw;function requireClassofRaw(){if(hasRequiredClassofRaw)return classofRaw;hasRequiredClassofRaw=1;var a=requireFunctionUncurryThis(),s=a({}.toString),c=a("".slice);return classofRaw=function(u){return c(s(u),8,-1)},classofRaw}var indexedObject,hasRequiredIndexedObject;function requireIndexedObject(){if(hasRequiredIndexedObject)return indexedObject;hasRequiredIndexedObject=1;var a=requireFunctionUncurryThis(),s=requireFails(),c=requireClassofRaw(),u=Object,d=a("".split);return indexedObject=s(function(){return!u("z").propertyIsEnumerable(0)})?function(h){return c(h)==="String"?d(h,""):u(h)}:u,indexedObject}var isNullOrUndefined,hasRequiredIsNullOrUndefined;function requireIsNullOrUndefined(){return hasRequiredIsNullOrUndefined||(hasRequiredIsNullOrUndefined=1,isNullOrUndefined=function(a){return a==null}),isNullOrUndefined}var requireObjectCoercible,hasRequiredRequireObjectCoercible;function requireRequireObjectCoercible(){if(hasRequiredRequireObjectCoercible)return requireObjectCoercible;hasRequiredRequireObjectCoercible=1;var a=requireIsNullOrUndefined(),s=TypeError;return requireObjectCoercible=function(c){if(a(c))throw new s("Can't call method on "+c);return c},requireObjectCoercible}var toIndexedObject,hasRequiredToIndexedObject;function requireToIndexedObject(){if(hasRequiredToIndexedObject)return toIndexedObject;hasRequiredToIndexedObject=1;var a=requireIndexedObject(),s=requireRequireObjectCoercible();return toIndexedObject=function(c){return a(s(c))},toIndexedObject}var isCallable,hasRequiredIsCallable;function requireIsCallable(){if(hasRequiredIsCallable)return isCallable;hasRequiredIsCallable=1;var a=typeof document=="object"&&document.all;return isCallable=typeof a>"u"&&a!==void 0?function(s){return typeof s=="function"||s===a}:function(s){return typeof s=="function"},isCallable}var isObject$2,hasRequiredIsObject;function requireIsObject(){if(hasRequiredIsObject)return isObject$2;hasRequiredIsObject=1;var a=requireIsCallable();return isObject$2=function(s){return typeof s=="object"?s!==null:a(s)},isObject$2}var getBuiltIn,hasRequiredGetBuiltIn;function requireGetBuiltIn(){if(hasRequiredGetBuiltIn)return getBuiltIn;hasRequiredGetBuiltIn=1;var a=requireGlobalThis(),s=requireIsCallable(),c=function(u){return s(u)?u:void 0};return getBuiltIn=function(u,d){return arguments.length<2?c(a[u]):a[u]&&a[u][d]},getBuiltIn}var objectIsPrototypeOf,hasRequiredObjectIsPrototypeOf;function requireObjectIsPrototypeOf(){if(hasRequiredObjectIsPrototypeOf)return objectIsPrototypeOf;hasRequiredObjectIsPrototypeOf=1;var a=requireFunctionUncurryThis();return objectIsPrototypeOf=a({}.isPrototypeOf),objectIsPrototypeOf}var environmentUserAgent,hasRequiredEnvironmentUserAgent;function requireEnvironmentUserAgent(){if(hasRequiredEnvironmentUserAgent)return environmentUserAgent;hasRequiredEnvironmentUserAgent=1;var a=requireGlobalThis(),s=a.navigator,c=s&&s.userAgent;return environmentUserAgent=c?String(c):"",environmentUserAgent}var environmentV8Version,hasRequiredEnvironmentV8Version;function requireEnvironmentV8Version(){if(hasRequiredEnvironmentV8Version)return environmentV8Version;hasRequiredEnvironmentV8Version=1;var a=requireGlobalThis(),s=requireEnvironmentUserAgent(),c=a.process,u=a.Deno,d=c&&c.versions||u&&u.version,h=d&&d.v8,f,g;return h&&(f=h.split("."),g=f[0]>0&&f[0]<4?1:+(f[0]+f[1])),!g&&s&&(f=s.match(/Edge\/(\d+)/),(!f||f[1]>=74)&&(f=s.match(/Chrome\/(\d+)/),f&&(g=+f[1]))),environmentV8Version=g,environmentV8Version}var symbolConstructorDetection,hasRequiredSymbolConstructorDetection;function requireSymbolConstructorDetection(){if(hasRequiredSymbolConstructorDetection)return symbolConstructorDetection;hasRequiredSymbolConstructorDetection=1;var a=requireEnvironmentV8Version(),s=requireFails(),c=requireGlobalThis(),u=c.String;return symbolConstructorDetection=!!Object.getOwnPropertySymbols&&!s(function(){var d=Symbol("symbol detection");return!u(d)||!(Object(d)instanceof Symbol)||!Symbol.sham&&a&&a<41}),symbolConstructorDetection}var useSymbolAsUid,hasRequiredUseSymbolAsUid;function requireUseSymbolAsUid(){if(hasRequiredUseSymbolAsUid)return useSymbolAsUid;hasRequiredUseSymbolAsUid=1;var a=requireSymbolConstructorDetection();return useSymbolAsUid=a&&!Symbol.sham&&typeof Symbol.iterator=="symbol",useSymbolAsUid}var isSymbol,hasRequiredIsSymbol;function requireIsSymbol(){if(hasRequiredIsSymbol)return isSymbol;hasRequiredIsSymbol=1;var a=requireGetBuiltIn(),s=requireIsCallable(),c=requireObjectIsPrototypeOf(),u=requireUseSymbolAsUid(),d=Object;return isSymbol=u?function(h){return typeof h=="symbol"}:function(h){var f=a("Symbol");return s(f)&&c(f.prototype,d(h))},isSymbol}var tryToString,hasRequiredTryToString;function requireTryToString(){if(hasRequiredTryToString)return tryToString;hasRequiredTryToString=1;var a=String;return tryToString=function(s){try{return a(s)}catch{return"Object"}},tryToString}var aCallable,hasRequiredACallable;function requireACallable(){if(hasRequiredACallable)return aCallable;hasRequiredACallable=1;var a=requireIsCallable(),s=requireTryToString(),c=TypeError;return aCallable=function(u){if(a(u))return u;throw new c(s(u)+" is not a function")},aCallable}var getMethod,hasRequiredGetMethod;function requireGetMethod(){if(hasRequiredGetMethod)return getMethod;hasRequiredGetMethod=1;var a=requireACallable(),s=requireIsNullOrUndefined();return getMethod=function(c,u){var d=c[u];return s(d)?void 0:a(d)},getMethod}var ordinaryToPrimitive,hasRequiredOrdinaryToPrimitive;function requireOrdinaryToPrimitive(){if(hasRequiredOrdinaryToPrimitive)return ordinaryToPrimitive;hasRequiredOrdinaryToPrimitive=1;var a=requireFunctionCall(),s=requireIsCallable(),c=requireIsObject(),u=TypeError;return ordinaryToPrimitive=function(d,h){var f,g;if(h==="string"&&s(f=d.toString)&&!c(g=a(f,d))||s(f=d.valueOf)&&!c(g=a(f,d))||h!=="string"&&s(f=d.toString)&&!c(g=a(f,d)))return g;throw new u("Can't convert object to primitive value")},ordinaryToPrimitive}var sharedStore={exports:{}},isPure,hasRequiredIsPure;function requireIsPure(){return hasRequiredIsPure||(hasRequiredIsPure=1,isPure=!1),isPure}var defineGlobalProperty,hasRequiredDefineGlobalProperty;function requireDefineGlobalProperty(){if(hasRequiredDefineGlobalProperty)return defineGlobalProperty;hasRequiredDefineGlobalProperty=1;var a=requireGlobalThis(),s=Object.defineProperty;return defineGlobalProperty=function(c,u){try{s(a,c,{value:u,configurable:!0,writable:!0})}catch{a[c]=u}return u},defineGlobalProperty}var hasRequiredSharedStore;function requireSharedStore(){if(hasRequiredSharedStore)return sharedStore.exports;hasRequiredSharedStore=1;var a=requireIsPure(),s=requireGlobalThis(),c=requireDefineGlobalProperty(),u="__core-js_shared__",d=sharedStore.exports=s[u]||c(u,{});return(d.versions||(d.versions=[])).push({version:"3.47.0",mode:a?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.47.0/LICENSE",source:"https://github.com/zloirock/core-js"}),sharedStore.exports}var shared,hasRequiredShared;function requireShared(){if(hasRequiredShared)return shared;hasRequiredShared=1;var a=requireSharedStore();return shared=function(s,c){return a[s]||(a[s]=c||{})},shared}var toObject$1,hasRequiredToObject;function requireToObject(){if(hasRequiredToObject)return toObject$1;hasRequiredToObject=1;var a=requireRequireObjectCoercible(),s=Object;return toObject$1=function(c){return s(a(c))},toObject$1}var hasOwnProperty_1,hasRequiredHasOwnProperty;function requireHasOwnProperty(){if(hasRequiredHasOwnProperty)return hasOwnProperty_1;hasRequiredHasOwnProperty=1;var a=requireFunctionUncurryThis(),s=requireToObject(),c=a({}.hasOwnProperty);return hasOwnProperty_1=Object.hasOwn||function(d,h){return c(s(d),h)},hasOwnProperty_1}var uid,hasRequiredUid;function requireUid(){if(hasRequiredUid)return uid;hasRequiredUid=1;var a=requireFunctionUncurryThis(),s=0,c=Math.random(),u=a(1.1.toString);return uid=function(d){return"Symbol("+(d===void 0?"":d)+")_"+u(++s+c,36)},uid}var wellKnownSymbol,hasRequiredWellKnownSymbol;function requireWellKnownSymbol(){if(hasRequiredWellKnownSymbol)return wellKnownSymbol;hasRequiredWellKnownSymbol=1;var a=requireGlobalThis(),s=requireShared(),c=requireHasOwnProperty(),u=requireUid(),d=requireSymbolConstructorDetection(),h=requireUseSymbolAsUid(),f=a.Symbol,g=s("wks"),m=h?f.for||f:f&&f.withoutSetter||u;return wellKnownSymbol=function(p){return c(g,p)||(g[p]=d&&c(f,p)?f[p]:m("Symbol."+p)),g[p]},wellKnownSymbol}var toPrimitive,hasRequiredToPrimitive;function requireToPrimitive(){if(hasRequiredToPrimitive)return toPrimitive;hasRequiredToPrimitive=1;var a=requireFunctionCall(),s=requireIsObject(),c=requireIsSymbol(),u=requireGetMethod(),d=requireOrdinaryToPrimitive(),h=requireWellKnownSymbol(),f=TypeError,g=h("toPrimitive");return toPrimitive=function(m,p){if(!s(m)||c(m))return m;var v=u(m,g),w;if(v){if(p===void 0&&(p="default"),w=a(v,m,p),!s(w)||c(w))return w;throw new f("Can't convert object to primitive value")}return p===void 0&&(p="number"),d(m,p)},toPrimitive}var toPropertyKey,hasRequiredToPropertyKey;function requireToPropertyKey(){if(hasRequiredToPropertyKey)return toPropertyKey;hasRequiredToPropertyKey=1;var a=requireToPrimitive(),s=requireIsSymbol();return toPropertyKey=function(c){var u=a(c,"string");return s(u)?u:u+""},toPropertyKey}var documentCreateElement,hasRequiredDocumentCreateElement;function requireDocumentCreateElement(){if(hasRequiredDocumentCreateElement)return documentCreateElement;hasRequiredDocumentCreateElement=1;var a=requireGlobalThis(),s=requireIsObject(),c=a.document,u=s(c)&&s(c.createElement);return documentCreateElement=function(d){return u?c.createElement(d):{}},documentCreateElement}var ie8DomDefine,hasRequiredIe8DomDefine;function requireIe8DomDefine(){if(hasRequiredIe8DomDefine)return ie8DomDefine;hasRequiredIe8DomDefine=1;var a=requireDescriptors(),s=requireFails(),c=requireDocumentCreateElement();return ie8DomDefine=!a&&!s(function(){return Object.defineProperty(c("div"),"a",{get:function(){return 7}}).a!==7}),ie8DomDefine}var hasRequiredObjectGetOwnPropertyDescriptor;function requireObjectGetOwnPropertyDescriptor(){if(hasRequiredObjectGetOwnPropertyDescriptor)return objectGetOwnPropertyDescriptor;hasRequiredObjectGetOwnPropertyDescriptor=1;var a=requireDescriptors(),s=requireFunctionCall(),c=requireObjectPropertyIsEnumerable(),u=requireCreatePropertyDescriptor(),d=requireToIndexedObject(),h=requireToPropertyKey(),f=requireHasOwnProperty(),g=requireIe8DomDefine(),m=Object.getOwnPropertyDescriptor;return objectGetOwnPropertyDescriptor.f=a?m:function(v,w){if(v=d(v),w=h(w),g)try{return m(v,w)}catch{}if(f(v,w))return u(!s(c.f,v,w),v[w])},objectGetOwnPropertyDescriptor}var objectDefineProperty={},v8PrototypeDefineBug,hasRequiredV8PrototypeDefineBug;function requireV8PrototypeDefineBug(){if(hasRequiredV8PrototypeDefineBug)return v8PrototypeDefineBug;hasRequiredV8PrototypeDefineBug=1;var a=requireDescriptors(),s=requireFails();return v8PrototypeDefineBug=a&&s(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),v8PrototypeDefineBug}var anObject,hasRequiredAnObject;function requireAnObject(){if(hasRequiredAnObject)return anObject;hasRequiredAnObject=1;var a=requireIsObject(),s=String,c=TypeError;return anObject=function(u){if(a(u))return u;throw new c(s(u)+" is not an object")},anObject}var hasRequiredObjectDefineProperty;function requireObjectDefineProperty(){if(hasRequiredObjectDefineProperty)return objectDefineProperty;hasRequiredObjectDefineProperty=1;var a=requireDescriptors(),s=requireIe8DomDefine(),c=requireV8PrototypeDefineBug(),u=requireAnObject(),d=requireToPropertyKey(),h=TypeError,f=Object.defineProperty,g=Object.getOwnPropertyDescriptor,m="enumerable",p="configurable",v="writable";return objectDefineProperty.f=a?c?function(E,C,b){if(u(E),C=d(C),u(b),typeof E=="function"&&C==="prototype"&&"value"in b&&v in b&&!b[v]){var P=g(E,C);P&&P[v]&&(E[C]=b.value,b={configurable:p in b?b[p]:P[p],enumerable:m in b?b[m]:P[m],writable:!1})}return f(E,C,b)}:f:function(E,C,b){if(u(E),C=d(C),u(b),s)try{return f(E,C,b)}catch{}if("get"in b||"set"in b)throw new h("Accessors not supported");return"value"in b&&(E[C]=b.value),E},objectDefineProperty}var createNonEnumerableProperty,hasRequiredCreateNonEnumerableProperty;function requireCreateNonEnumerableProperty(){if(hasRequiredCreateNonEnumerableProperty)return createNonEnumerableProperty;hasRequiredCreateNonEnumerableProperty=1;var a=requireDescriptors(),s=requireObjectDefineProperty(),c=requireCreatePropertyDescriptor();return createNonEnumerableProperty=a?function(u,d,h){return s.f(u,d,c(1,h))}:function(u,d,h){return u[d]=h,u},createNonEnumerableProperty}var makeBuiltIn={exports:{}},functionName,hasRequiredFunctionName;function requireFunctionName(){if(hasRequiredFunctionName)return functionName;hasRequiredFunctionName=1;var a=requireDescriptors(),s=requireHasOwnProperty(),c=Function.prototype,u=a&&Object.getOwnPropertyDescriptor,d=s(c,"name"),h=d&&(function(){}).name==="something",f=d&&(!a||a&&u(c,"name").configurable);return functionName={EXISTS:d,PROPER:h,CONFIGURABLE:f},functionName}var inspectSource,hasRequiredInspectSource;function requireInspectSource(){if(hasRequiredInspectSource)return inspectSource;hasRequiredInspectSource=1;var a=requireFunctionUncurryThis(),s=requireIsCallable(),c=requireSharedStore(),u=a(Function.toString);return s(c.inspectSource)||(c.inspectSource=function(d){return u(d)}),inspectSource=c.inspectSource,inspectSource}var weakMapBasicDetection,hasRequiredWeakMapBasicDetection;function requireWeakMapBasicDetection(){if(hasRequiredWeakMapBasicDetection)return weakMapBasicDetection;hasRequiredWeakMapBasicDetection=1;var a=requireGlobalThis(),s=requireIsCallable(),c=a.WeakMap;return weakMapBasicDetection=s(c)&&/native code/.test(String(c)),weakMapBasicDetection}var sharedKey,hasRequiredSharedKey;function requireSharedKey(){if(hasRequiredSharedKey)return sharedKey;hasRequiredSharedKey=1;var a=requireShared(),s=requireUid(),c=a("keys");return sharedKey=function(u){return c[u]||(c[u]=s(u))},sharedKey}var hiddenKeys,hasRequiredHiddenKeys;function requireHiddenKeys(){return hasRequiredHiddenKeys||(hasRequiredHiddenKeys=1,hiddenKeys={}),hiddenKeys}var internalState,hasRequiredInternalState;function requireInternalState(){if(hasRequiredInternalState)return internalState;hasRequiredInternalState=1;var a=requireWeakMapBasicDetection(),s=requireGlobalThis(),c=requireIsObject(),u=requireCreateNonEnumerableProperty(),d=requireHasOwnProperty(),h=requireSharedStore(),f=requireSharedKey(),g=requireHiddenKeys(),m="Object already initialized",p=s.TypeError,v=s.WeakMap,w,E,C,b=function(I){return C(I)?E(I):w(I,{})},P=function(I){return function(M){var N;if(!c(M)||(N=E(M)).type!==I)throw new p("Incompatible receiver, "+I+" required");return N}};if(a||h.state){var R=h.state||(h.state=new v);R.get=R.get,R.has=R.has,R.set=R.set,w=function(I,M){if(R.has(I))throw new p(m);return M.facade=I,R.set(I,M),M},E=function(I){return R.get(I)||{}},C=function(I){return R.has(I)}}else{var T=f("state");g[T]=!0,w=function(I,M){if(d(I,T))throw new p(m);return M.facade=I,u(I,T,M),M},E=function(I){return d(I,T)?I[T]:{}},C=function(I){return d(I,T)}}return internalState={set:w,get:E,has:C,enforce:b,getterFor:P},internalState}var hasRequiredMakeBuiltIn;function requireMakeBuiltIn(){if(hasRequiredMakeBuiltIn)return makeBuiltIn.exports;hasRequiredMakeBuiltIn=1;var a=requireFunctionUncurryThis(),s=requireFails(),c=requireIsCallable(),u=requireHasOwnProperty(),d=requireDescriptors(),h=requireFunctionName().CONFIGURABLE,f=requireInspectSource(),g=requireInternalState(),m=g.enforce,p=g.get,v=String,w=Object.defineProperty,E=a("".slice),C=a("".replace),b=a([].join),P=d&&!s(function(){return w(function(){},"length",{value:8}).length!==8}),R=String(String).split("String"),T=makeBuiltIn.exports=function(I,M,N){E(v(M),0,7)==="Symbol("&&(M="["+C(v(M),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),N&&N.getter&&(M="get "+M),N&&N.setter&&(M="set "+M),(!u(I,"name")||h&&I.name!==M)&&(d?w(I,"name",{value:M,configurable:!0}):I.name=M),P&&N&&u(N,"arity")&&I.length!==N.arity&&w(I,"length",{value:N.arity});try{N&&u(N,"constructor")&&N.constructor?d&&w(I,"prototype",{writable:!1}):I.prototype&&(I.prototype=void 0)}catch{}var H=m(I);return u(H,"source")||(H.source=b(R,typeof M=="string"?M:"")),I};return Function.prototype.toString=T(function(){return c(this)&&p(this).source||f(this)},"toString"),makeBuiltIn.exports}var defineBuiltIn,hasRequiredDefineBuiltIn;function requireDefineBuiltIn(){if(hasRequiredDefineBuiltIn)return defineBuiltIn;hasRequiredDefineBuiltIn=1;var a=requireIsCallable(),s=requireObjectDefineProperty(),c=requireMakeBuiltIn(),u=requireDefineGlobalProperty();return defineBuiltIn=function(d,h,f,g){g||(g={});var m=g.enumerable,p=g.name!==void 0?g.name:h;if(a(f)&&c(f,p,g),g.global)m?d[h]=f:u(h,f);else{try{g.unsafe?d[h]&&(m=!0):delete d[h]}catch{}m?d[h]=f:s.f(d,h,{value:f,enumerable:!1,configurable:!g.nonConfigurable,writable:!g.nonWritable})}return d},defineBuiltIn}var objectGetOwnPropertyNames={},mathTrunc,hasRequiredMathTrunc;function requireMathTrunc(){if(hasRequiredMathTrunc)return mathTrunc;hasRequiredMathTrunc=1;var a=Math.ceil,s=Math.floor;return mathTrunc=Math.trunc||function(u){var d=+u;return(d>0?s:a)(d)},mathTrunc}var toIntegerOrInfinity,hasRequiredToIntegerOrInfinity;function requireToIntegerOrInfinity(){if(hasRequiredToIntegerOrInfinity)return toIntegerOrInfinity;hasRequiredToIntegerOrInfinity=1;var a=requireMathTrunc();return toIntegerOrInfinity=function(s){var c=+s;return c!==c||c===0?0:a(c)},toIntegerOrInfinity}var toAbsoluteIndex,hasRequiredToAbsoluteIndex;function requireToAbsoluteIndex(){if(hasRequiredToAbsoluteIndex)return toAbsoluteIndex;hasRequiredToAbsoluteIndex=1;var a=requireToIntegerOrInfinity(),s=Math.max,c=Math.min;return toAbsoluteIndex=function(u,d){var h=a(u);return h<0?s(h+d,0):c(h,d)},toAbsoluteIndex}var toLength,hasRequiredToLength;function requireToLength(){if(hasRequiredToLength)return toLength;hasRequiredToLength=1;var a=requireToIntegerOrInfinity(),s=Math.min;return toLength=function(c){var u=a(c);return u>0?s(u,9007199254740991):0},toLength}var lengthOfArrayLike,hasRequiredLengthOfArrayLike;function requireLengthOfArrayLike(){if(hasRequiredLengthOfArrayLike)return lengthOfArrayLike;hasRequiredLengthOfArrayLike=1;var a=requireToLength();return lengthOfArrayLike=function(s){return a(s.length)},lengthOfArrayLike}var arrayIncludes,hasRequiredArrayIncludes;function requireArrayIncludes(){if(hasRequiredArrayIncludes)return arrayIncludes;hasRequiredArrayIncludes=1;var a=requireToIndexedObject(),s=requireToAbsoluteIndex(),c=requireLengthOfArrayLike(),u=function(d){return function(h,f,g){var m=a(h),p=c(m);if(p===0)return!d&&-1;var v=s(g,p),w;if(d&&f!==f){for(;p>v;)if(w=m[v++],w!==w)return!0}else for(;p>v;v++)if((d||v in m)&&m[v]===f)return d||v||0;return!d&&-1}};return arrayIncludes={includes:u(!0),indexOf:u(!1)},arrayIncludes}var objectKeysInternal,hasRequiredObjectKeysInternal;function requireObjectKeysInternal(){if(hasRequiredObjectKeysInternal)return objectKeysInternal;hasRequiredObjectKeysInternal=1;var a=requireFunctionUncurryThis(),s=requireHasOwnProperty(),c=requireToIndexedObject(),u=requireArrayIncludes().indexOf,d=requireHiddenKeys(),h=a([].push);return objectKeysInternal=function(f,g){var m=c(f),p=0,v=[],w;for(w in m)!s(d,w)&&s(m,w)&&h(v,w);for(;g.length>p;)s(m,w=g[p++])&&(~u(v,w)||h(v,w));return v},objectKeysInternal}var enumBugKeys,hasRequiredEnumBugKeys;function requireEnumBugKeys(){return hasRequiredEnumBugKeys||(hasRequiredEnumBugKeys=1,enumBugKeys=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),enumBugKeys}var hasRequiredObjectGetOwnPropertyNames;function requireObjectGetOwnPropertyNames(){if(hasRequiredObjectGetOwnPropertyNames)return objectGetOwnPropertyNames;hasRequiredObjectGetOwnPropertyNames=1;var a=requireObjectKeysInternal(),s=requireEnumBugKeys(),c=s.concat("length","prototype");return objectGetOwnPropertyNames.f=Object.getOwnPropertyNames||function(d){return a(d,c)},objectGetOwnPropertyNames}var objectGetOwnPropertySymbols={},hasRequiredObjectGetOwnPropertySymbols;function requireObjectGetOwnPropertySymbols(){return hasRequiredObjectGetOwnPropertySymbols||(hasRequiredObjectGetOwnPropertySymbols=1,objectGetOwnPropertySymbols.f=Object.getOwnPropertySymbols),objectGetOwnPropertySymbols}var ownKeys,hasRequiredOwnKeys;function requireOwnKeys(){if(hasRequiredOwnKeys)return ownKeys;hasRequiredOwnKeys=1;var a=requireGetBuiltIn(),s=requireFunctionUncurryThis(),c=requireObjectGetOwnPropertyNames(),u=requireObjectGetOwnPropertySymbols(),d=requireAnObject(),h=s([].concat);return ownKeys=a("Reflect","ownKeys")||function(g){var m=c.f(d(g)),p=u.f;return p?h(m,p(g)):m},ownKeys}var copyConstructorProperties,hasRequiredCopyConstructorProperties;function requireCopyConstructorProperties(){if(hasRequiredCopyConstructorProperties)return copyConstructorProperties;hasRequiredCopyConstructorProperties=1;var a=requireHasOwnProperty(),s=requireOwnKeys(),c=requireObjectGetOwnPropertyDescriptor(),u=requireObjectDefineProperty();return copyConstructorProperties=function(d,h,f){for(var g=s(h),m=u.f,p=c.f,v=0;v<g.length;v++){var w=g[v];!a(d,w)&&!(f&&a(f,w))&&m(d,w,p(h,w))}},copyConstructorProperties}var isForced_1,hasRequiredIsForced;function requireIsForced(){if(hasRequiredIsForced)return isForced_1;hasRequiredIsForced=1;var a=requireFails(),s=requireIsCallable(),c=/#|\.prototype\./,u=function(m,p){var v=h[d(m)];return v===g?!0:v===f?!1:s(p)?a(p):!!p},d=u.normalize=function(m){return String(m).replace(c,".").toLowerCase()},h=u.data={},f=u.NATIVE="N",g=u.POLYFILL="P";return isForced_1=u,isForced_1}var _export,hasRequired_export;function require_export(){if(hasRequired_export)return _export;hasRequired_export=1;var a=requireGlobalThis(),s=requireObjectGetOwnPropertyDescriptor().f,c=requireCreateNonEnumerableProperty(),u=requireDefineBuiltIn(),d=requireDefineGlobalProperty(),h=requireCopyConstructorProperties(),f=requireIsForced();return _export=function(g,m){var p=g.target,v=g.global,w=g.stat,E,C,b,P,R,T;if(v?C=a:w?C=a[p]||d(p,{}):C=a[p]&&a[p].prototype,C)for(b in m){if(R=m[b],g.dontCallGetSet?(T=s(C,b),P=T&&T.value):P=C[b],E=f(v?b:p+(w?".":"#")+b,g.forced),!E&&P!==void 0){if(typeof R==typeof P)continue;h(R,P)}(g.sham||P&&P.sham)&&c(R,"sham",!0),u(C,b,R,g)}},_export}var functionApply,hasRequiredFunctionApply;function requireFunctionApply(){if(hasRequiredFunctionApply)return functionApply;hasRequiredFunctionApply=1;var a=requireFunctionBindNative(),s=Function.prototype,c=s.apply,u=s.call;return functionApply=typeof Reflect=="object"&&Reflect.apply||(a?u.bind(c):function(){return u.apply(c,arguments)}),functionApply}var functionUncurryThisAccessor,hasRequiredFunctionUncurryThisAccessor;function requireFunctionUncurryThisAccessor(){if(hasRequiredFunctionUncurryThisAccessor)return functionUncurryThisAccessor;hasRequiredFunctionUncurryThisAccessor=1;var a=requireFunctionUncurryThis(),s=requireACallable();return functionUncurryThisAccessor=function(c,u,d){try{return a(s(Object.getOwnPropertyDescriptor(c,u)[d]))}catch{}},functionUncurryThisAccessor}var isPossiblePrototype,hasRequiredIsPossiblePrototype;function requireIsPossiblePrototype(){if(hasRequiredIsPossiblePrototype)return isPossiblePrototype;hasRequiredIsPossiblePrototype=1;var a=requireIsObject();return isPossiblePrototype=function(s){return a(s)||s===null},isPossiblePrototype}var aPossiblePrototype,hasRequiredAPossiblePrototype;function requireAPossiblePrototype(){if(hasRequiredAPossiblePrototype)return aPossiblePrototype;hasRequiredAPossiblePrototype=1;var a=requireIsPossiblePrototype(),s=String,c=TypeError;return aPossiblePrototype=function(u){if(a(u))return u;throw new c("Can't set "+s(u)+" as a prototype")},aPossiblePrototype}var objectSetPrototypeOf,hasRequiredObjectSetPrototypeOf;function requireObjectSetPrototypeOf(){if(hasRequiredObjectSetPrototypeOf)return objectSetPrototypeOf;hasRequiredObjectSetPrototypeOf=1;var a=requireFunctionUncurryThisAccessor(),s=requireIsObject(),c=requireRequireObjectCoercible(),u=requireAPossiblePrototype();return objectSetPrototypeOf=Object.setPrototypeOf||("__proto__"in{}?(function(){var d=!1,h={},f;try{f=a(Object.prototype,"__proto__","set"),f(h,[]),d=h instanceof Array}catch{}return function(m,p){return c(m),u(p),s(m)&&(d?f(m,p):m.__proto__=p),m}})():void 0),objectSetPrototypeOf}var proxyAccessor,hasRequiredProxyAccessor;function requireProxyAccessor(){if(hasRequiredProxyAccessor)return proxyAccessor;hasRequiredProxyAccessor=1;var a=requireObjectDefineProperty().f;return proxyAccessor=function(s,c,u){u in s||a(s,u,{configurable:!0,get:function(){return c[u]},set:function(d){c[u]=d}})},proxyAccessor}var inheritIfRequired,hasRequiredInheritIfRequired;function requireInheritIfRequired(){if(hasRequiredInheritIfRequired)return inheritIfRequired;hasRequiredInheritIfRequired=1;var a=requireIsCallable(),s=requireIsObject(),c=requireObjectSetPrototypeOf();return inheritIfRequired=function(u,d,h){var f,g;return c&&a(f=d.constructor)&&f!==h&&s(g=f.prototype)&&g!==h.prototype&&c(u,g),u},inheritIfRequired}var toStringTagSupport,hasRequiredToStringTagSupport;function requireToStringTagSupport(){if(hasRequiredToStringTagSupport)return toStringTagSupport;hasRequiredToStringTagSupport=1;var a=requireWellKnownSymbol(),s=a("toStringTag"),c={};return c[s]="z",toStringTagSupport=String(c)==="[object z]",toStringTagSupport}var classof,hasRequiredClassof;function requireClassof(){if(hasRequiredClassof)return classof;hasRequiredClassof=1;var a=requireToStringTagSupport(),s=requireIsCallable(),c=requireClassofRaw(),u=requireWellKnownSymbol(),d=u("toStringTag"),h=Object,f=c((function(){return arguments})())==="Arguments",g=function(m,p){try{return m[p]}catch{}};return classof=a?c:function(m){var p,v,w;return m===void 0?"Undefined":m===null?"Null":typeof(v=g(p=h(m),d))=="string"?v:f?c(p):(w=c(p))==="Object"&&s(p.callee)?"Arguments":w},classof}var toString$1,hasRequiredToString;function requireToString(){if(hasRequiredToString)return toString$1;hasRequiredToString=1;var a=requireClassof(),s=String;return toString$1=function(c){if(a(c)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return s(c)},toString$1}var normalizeStringArgument,hasRequiredNormalizeStringArgument;function requireNormalizeStringArgument(){if(hasRequiredNormalizeStringArgument)return normalizeStringArgument;hasRequiredNormalizeStringArgument=1;var a=requireToString();return normalizeStringArgument=function(s,c){return s===void 0?arguments.length<2?"":c:a(s)},normalizeStringArgument}var installErrorCause,hasRequiredInstallErrorCause;function requireInstallErrorCause(){if(hasRequiredInstallErrorCause)return installErrorCause;hasRequiredInstallErrorCause=1;var a=requireIsObject(),s=requireCreateNonEnumerableProperty();return installErrorCause=function(c,u){a(u)&&"cause"in u&&s(c,"cause",u.cause)},installErrorCause}var errorStackClear,hasRequiredErrorStackClear;function requireErrorStackClear(){if(hasRequiredErrorStackClear)return errorStackClear;hasRequiredErrorStackClear=1;var a=requireFunctionUncurryThis(),s=Error,c=a("".replace),u=(function(f){return String(new s(f).stack)})("zxcasd"),d=/\n\s*at [^:]*:[^\n]*/,h=d.test(u);return errorStackClear=function(f,g){if(h&&typeof f=="string"&&!s.prepareStackTrace)for(;g--;)f=c(f,d,"");return f},errorStackClear}var errorStackInstallable,hasRequiredErrorStackInstallable;function requireErrorStackInstallable(){if(hasRequiredErrorStackInstallable)return errorStackInstallable;hasRequiredErrorStackInstallable=1;var a=requireFails(),s=requireCreatePropertyDescriptor();return errorStackInstallable=!a(function(){var c=new Error("a");return"stack"in c?(Object.defineProperty(c,"stack",s(1,7)),c.stack!==7):!0}),errorStackInstallable}var errorStackInstall,hasRequiredErrorStackInstall;function requireErrorStackInstall(){if(hasRequiredErrorStackInstall)return errorStackInstall;hasRequiredErrorStackInstall=1;var a=requireCreateNonEnumerableProperty(),s=requireErrorStackClear(),c=requireErrorStackInstallable(),u=Error.captureStackTrace;return errorStackInstall=function(d,h,f,g){c&&(u?u(d,h):a(d,"stack",s(f,g)))},errorStackInstall}var wrapErrorConstructorWithCause,hasRequiredWrapErrorConstructorWithCause;function requireWrapErrorConstructorWithCause(){if(hasRequiredWrapErrorConstructorWithCause)return wrapErrorConstructorWithCause;hasRequiredWrapErrorConstructorWithCause=1;var a=requireGetBuiltIn(),s=requireHasOwnProperty(),c=requireCreateNonEnumerableProperty(),u=requireObjectIsPrototypeOf(),d=requireObjectSetPrototypeOf(),h=requireCopyConstructorProperties(),f=requireProxyAccessor(),g=requireInheritIfRequired(),m=requireNormalizeStringArgument(),p=requireInstallErrorCause(),v=requireErrorStackInstall(),w=requireDescriptors(),E=requireIsPure();return wrapErrorConstructorWithCause=function(C,b,P,R){var T="stackTraceLimit",I=R?2:1,M=C.split("."),N=M[M.length-1],H=a.apply(null,M);if(H){var L=H.prototype;if(!E&&s(L,"cause")&&delete L.cause,!P)return H;var A=a("Error"),k=b(function(W,G){var oe=m(R?G:W,void 0),ae=R?new H(W):new H;return oe!==void 0&&c(ae,"message",oe),v(ae,k,ae.stack,2),this&&u(L,this)&&g(ae,this,k),arguments.length>I&&p(ae,arguments[I]),ae});if(k.prototype=L,N!=="Error"?d?d(k,A):h(k,A,{name:!0}):w&&T in H&&(f(k,H,T),f(k,H,"prepareStackTrace")),h(k,H),!E)try{L.name!==N&&c(L,"name",N),L.constructor=k}catch{}return k}},wrapErrorConstructorWithCause}var hasRequiredEs_error_cause;function requireEs_error_cause(){if(hasRequiredEs_error_cause)return es_error_cause;hasRequiredEs_error_cause=1;var a=require_export(),s=requireGlobalThis(),c=requireFunctionApply(),u=requireWrapErrorConstructorWithCause(),d="WebAssembly",h=s[d],f=new Error("e",{cause:7}).cause!==7,g=function(p,v){var w={};w[p]=u(p,v,f),a({global:!0,constructor:!0,arity:1,forced:f},w)},m=function(p,v){if(h&&h[p]){var w={};w[p]=u(d+"."+p,v,f),a({target:d,stat:!0,constructor:!0,arity:1,forced:f},w)}};return g("Error",function(p){return function(w){return c(p,this,arguments)}}),g("EvalError",function(p){return function(w){return c(p,this,arguments)}}),g("RangeError",function(p){return function(w){return c(p,this,arguments)}}),g("ReferenceError",function(p){return function(w){return c(p,this,arguments)}}),g("SyntaxError",function(p){return function(w){return c(p,this,arguments)}}),g("TypeError",function(p){return function(w){return c(p,this,arguments)}}),g("URIError",function(p){return function(w){return c(p,this,arguments)}}),m("CompileError",function(p){return function(w){return c(p,this,arguments)}}),m("LinkError",function(p){return function(w){return c(p,this,arguments)}}),m("RuntimeError",function(p){return function(w){return c(p,this,arguments)}}),es_error_cause}requireEs_error_cause();var es_array_push={},isArray$2,hasRequiredIsArray;function requireIsArray(){if(hasRequiredIsArray)return isArray$2;hasRequiredIsArray=1;var a=requireClassofRaw();return isArray$2=Array.isArray||function(c){return a(c)==="Array"},isArray$2}var arraySetLength,hasRequiredArraySetLength;function requireArraySetLength(){if(hasRequiredArraySetLength)return arraySetLength;hasRequiredArraySetLength=1;var a=requireDescriptors(),s=requireIsArray(),c=TypeError,u=Object.getOwnPropertyDescriptor,d=a&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(h){return h instanceof TypeError}})();return arraySetLength=d?function(h,f){if(s(h)&&!u(h,"length").writable)throw new c("Cannot set read only .length");return h.length=f}:function(h,f){return h.length=f},arraySetLength}var doesNotExceedSafeInteger,hasRequiredDoesNotExceedSafeInteger;function requireDoesNotExceedSafeInteger(){if(hasRequiredDoesNotExceedSafeInteger)return doesNotExceedSafeInteger;hasRequiredDoesNotExceedSafeInteger=1;var a=TypeError,s=9007199254740991;return doesNotExceedSafeInteger=function(c){if(c>s)throw a("Maximum allowed index exceeded");return c},doesNotExceedSafeInteger}var hasRequiredEs_array_push;function requireEs_array_push(){if(hasRequiredEs_array_push)return es_array_push;hasRequiredEs_array_push=1;var a=require_export(),s=requireToObject(),c=requireLengthOfArrayLike(),u=requireArraySetLength(),d=requireDoesNotExceedSafeInteger(),h=requireFails(),f=h(function(){return[].push.call({length:4294967296},1)!==4294967297}),g=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(p){return p instanceof TypeError}},m=f||!g();return a({target:"Array",proto:!0,arity:1,forced:m},{push:function(v){var w=s(this),E=c(w),C=arguments.length;d(E+C);for(var b=0;b<C;b++)w[E]=arguments[b],E++;return u(w,E),E}}),es_array_push}requireEs_array_push();var es_object_fromEntries={},functionUncurryThisClause,hasRequiredFunctionUncurryThisClause;function requireFunctionUncurryThisClause(){if(hasRequiredFunctionUncurryThisClause)return functionUncurryThisClause;hasRequiredFunctionUncurryThisClause=1;var a=requireClassofRaw(),s=requireFunctionUncurryThis();return functionUncurryThisClause=function(c){if(a(c)==="Function")return s(c)},functionUncurryThisClause}var functionBindContext,hasRequiredFunctionBindContext;function requireFunctionBindContext(){if(hasRequiredFunctionBindContext)return functionBindContext;hasRequiredFunctionBindContext=1;var a=requireFunctionUncurryThisClause(),s=requireACallable(),c=requireFunctionBindNative(),u=a(a.bind);return functionBindContext=function(d,h){return s(d),h===void 0?d:c?u(d,h):function(){return d.apply(h,arguments)}},functionBindContext}var iterators,hasRequiredIterators;function requireIterators(){return hasRequiredIterators||(hasRequiredIterators=1,iterators={}),iterators}var isArrayIteratorMethod,hasRequiredIsArrayIteratorMethod;function requireIsArrayIteratorMethod(){if(hasRequiredIsArrayIteratorMethod)return isArrayIteratorMethod;hasRequiredIsArrayIteratorMethod=1;var a=requireWellKnownSymbol(),s=requireIterators(),c=a("iterator"),u=Array.prototype;return isArrayIteratorMethod=function(d){return d!==void 0&&(s.Array===d||u[c]===d)},isArrayIteratorMethod}var getIteratorMethod,hasRequiredGetIteratorMethod;function requireGetIteratorMethod(){if(hasRequiredGetIteratorMethod)return getIteratorMethod;hasRequiredGetIteratorMethod=1;var a=requireClassof(),s=requireGetMethod(),c=requireIsNullOrUndefined(),u=requireIterators(),d=requireWellKnownSymbol(),h=d("iterator");return getIteratorMethod=function(f){if(!c(f))return s(f,h)||s(f,"@@iterator")||u[a(f)]},getIteratorMethod}var getIterator,hasRequiredGetIterator;function requireGetIterator(){if(hasRequiredGetIterator)return getIterator;hasRequiredGetIterator=1;var a=requireFunctionCall(),s=requireACallable(),c=requireAnObject(),u=requireTryToString(),d=requireGetIteratorMethod(),h=TypeError;return getIterator=function(f,g){var m=arguments.length<2?d(f):g;if(s(m))return c(a(m,f));throw new h(u(f)+" is not iterable")},getIterator}var iteratorClose,hasRequiredIteratorClose;function requireIteratorClose(){if(hasRequiredIteratorClose)return iteratorClose;hasRequiredIteratorClose=1;var a=requireFunctionCall(),s=requireAnObject(),c=requireGetMethod();return iteratorClose=function(u,d,h){var f,g;s(u);try{if(f=c(u,"return"),!f){if(d==="throw")throw h;return h}f=a(f,u)}catch(m){g=!0,f=m}if(d==="throw")throw h;if(g)throw f;return s(f),h},iteratorClose}var iterate,hasRequiredIterate;function requireIterate(){if(hasRequiredIterate)return iterate;hasRequiredIterate=1;var a=requireFunctionBindContext(),s=requireFunctionCall(),c=requireAnObject(),u=requireTryToString(),d=requireIsArrayIteratorMethod(),h=requireLengthOfArrayLike(),f=requireObjectIsPrototypeOf(),g=requireGetIterator(),m=requireGetIteratorMethod(),p=requireIteratorClose(),v=TypeError,w=function(C,b){this.stopped=C,this.result=b},E=w.prototype;return iterate=function(C,b,P){var R=P&&P.that,T=!!(P&&P.AS_ENTRIES),I=!!(P&&P.IS_RECORD),M=!!(P&&P.IS_ITERATOR),N=!!(P&&P.INTERRUPTED),H=a(b,R),L,A,k,W,G,oe,ae,X=function(ye){return L&&p(L,"normal"),new w(!0,ye)},le=function(ye){return T?(c(ye),N?H(ye[0],ye[1],X):H(ye[0],ye[1])):N?H(ye,X):H(ye)};if(I)L=C.iterator;else if(M)L=C;else{if(A=m(C),!A)throw new v(u(C)+" is not iterable");if(d(A)){for(k=0,W=h(C);W>k;k++)if(G=le(C[k]),G&&f(E,G))return G;return new w(!1)}L=g(C,A)}for(oe=I?C.next:L.next;!(ae=s(oe,L)).done;){try{G=le(ae.value)}catch(ye){p(L,"throw",ye)}if(typeof G=="object"&&G&&f(E,G))return G}return new w(!1)},iterate}var createProperty,hasRequiredCreateProperty;function requireCreateProperty(){if(hasRequiredCreateProperty)return createProperty;hasRequiredCreateProperty=1;var a=requireDescriptors(),s=requireObjectDefineProperty(),c=requireCreatePropertyDescriptor();return createProperty=function(u,d,h){a?s.f(u,d,c(0,h)):u[d]=h},createProperty}var hasRequiredEs_object_fromEntries;function requireEs_object_fromEntries(){if(hasRequiredEs_object_fromEntries)return es_object_fromEntries;hasRequiredEs_object_fromEntries=1;var a=require_export(),s=requireIterate(),c=requireCreateProperty();return a({target:"Object",stat:!0},{fromEntries:function(d){var h={};return s(d,function(f,g){c(h,f,g)},{AS_ENTRIES:!0}),h}}),es_object_fromEntries}requireEs_object_fromEntries();var es_set_difference_v2={},setHelpers,hasRequiredSetHelpers;function requireSetHelpers(){if(hasRequiredSetHelpers)return setHelpers;hasRequiredSetHelpers=1;var a=requireFunctionUncurryThis(),s=Set.prototype;return setHelpers={Set,add:a(s.add),has:a(s.has),remove:a(s.delete),proto:s},setHelpers}var aSet,hasRequiredASet;function requireASet(){if(hasRequiredASet)return aSet;hasRequiredASet=1;var a=requireSetHelpers().has;return aSet=function(s){return a(s),s},aSet}var iterateSimple,hasRequiredIterateSimple;function requireIterateSimple(){if(hasRequiredIterateSimple)return iterateSimple;hasRequiredIterateSimple=1;var a=requireFunctionCall();return iterateSimple=function(s,c,u){for(var d=u?s:s.iterator,h=s.next,f,g;!(f=a(h,d)).done;)if(g=c(f.value),g!==void 0)return g},iterateSimple}var setIterate,hasRequiredSetIterate;function requireSetIterate(){if(hasRequiredSetIterate)return setIterate;hasRequiredSetIterate=1;var a=requireFunctionUncurryThis(),s=requireIterateSimple(),c=requireSetHelpers(),u=c.Set,d=c.proto,h=a(d.forEach),f=a(d.keys),g=f(new u).next;return setIterate=function(m,p,v){return v?s({iterator:f(m),next:g},p):h(m,p)},setIterate}var setClone,hasRequiredSetClone;function requireSetClone(){if(hasRequiredSetClone)return setClone;hasRequiredSetClone=1;var a=requireSetHelpers(),s=requireSetIterate(),c=a.Set,u=a.add;return setClone=function(d){var h=new c;return s(d,function(f){u(h,f)}),h},setClone}var setSize,hasRequiredSetSize;function requireSetSize(){if(hasRequiredSetSize)return setSize;hasRequiredSetSize=1;var a=requireFunctionUncurryThisAccessor(),s=requireSetHelpers();return setSize=a(s.proto,"size","get")||function(c){return c.size},setSize}var getIteratorDirect,hasRequiredGetIteratorDirect;function requireGetIteratorDirect(){return hasRequiredGetIteratorDirect||(hasRequiredGetIteratorDirect=1,getIteratorDirect=function(a){return{iterator:a,next:a.next,done:!1}}),getIteratorDirect}var getSetRecord,hasRequiredGetSetRecord;function requireGetSetRecord(){if(hasRequiredGetSetRecord)return getSetRecord;hasRequiredGetSetRecord=1;var a=requireACallable(),s=requireAnObject(),c=requireFunctionCall(),u=requireToIntegerOrInfinity(),d=requireGetIteratorDirect(),h="Invalid size",f=RangeError,g=TypeError,m=Math.max,p=function(v,w){this.set=v,this.size=m(w,0),this.has=a(v.has),this.keys=a(v.keys)};return p.prototype={getIterator:function(){return d(s(c(this.keys,this.set)))},includes:function(v){return c(this.has,this.set,v)}},getSetRecord=function(v){s(v);var w=+v.size;if(w!==w)throw new g(h);var E=u(w);if(E<0)throw new f(h);return new p(v,E)},getSetRecord}var setDifference,hasRequiredSetDifference;function requireSetDifference(){if(hasRequiredSetDifference)return setDifference;hasRequiredSetDifference=1;var a=requireASet(),s=requireSetHelpers(),c=requireSetClone(),u=requireSetSize(),d=requireGetSetRecord(),h=requireSetIterate(),f=requireIterateSimple(),g=s.has,m=s.remove;return setDifference=function(v){var w=a(this),E=d(v),C=c(w);return u(w)<=E.size?h(w,function(b){E.includes(b)&&m(C,b)}):f(E.getIterator(),function(b){g(C,b)&&m(C,b)}),C},setDifference}var setMethodAcceptSetLike,hasRequiredSetMethodAcceptSetLike;function requireSetMethodAcceptSetLike(){if(hasRequiredSetMethodAcceptSetLike)return setMethodAcceptSetLike;hasRequiredSetMethodAcceptSetLike=1;var a=requireGetBuiltIn(),s=function(u){return{size:u,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},c=function(u){return{size:u,has:function(){return!0},keys:function(){throw new Error("e")}}};return setMethodAcceptSetLike=function(u,d){var h=a("Set");try{new h()[u](s(0));try{return new h()[u](s(-1)),!1}catch{if(!d)return!0;try{return new h()[u](c(-1/0)),!1}catch{var f=new h([1,2]);return d(f[u](c(1/0)))}}}catch{return!1}},setMethodAcceptSetLike}var hasRequiredEs_set_difference_v2;function requireEs_set_difference_v2(){if(hasRequiredEs_set_difference_v2)return es_set_difference_v2;hasRequiredEs_set_difference_v2=1;var a=require_export(),s=requireSetDifference(),c=requireFails(),u=requireSetMethodAcceptSetLike(),d=!u("difference",function(f){return f.size===0}),h=d||c(function(){var f={size:1,has:function(){return!0},keys:function(){var m=0;return{next:function(){var p=m++>1;return g.has(1)&&g.clear(),{done:p,value:2}}}}},g=new Set([1,2,3,4]);return g.difference(f).size!==3});return a({target:"Set",proto:!0,real:!0,forced:h},{difference:s}),es_set_difference_v2}requireEs_set_difference_v2();var es_set_intersection_v2={},setIntersection,hasRequiredSetIntersection;function requireSetIntersection(){if(hasRequiredSetIntersection)return setIntersection;hasRequiredSetIntersection=1;var a=requireASet(),s=requireSetHelpers(),c=requireSetSize(),u=requireGetSetRecord(),d=requireSetIterate(),h=requireIterateSimple(),f=s.Set,g=s.add,m=s.has;return setIntersection=function(v){var w=a(this),E=u(v),C=new f;return c(w)>E.size?h(E.getIterator(),function(b){m(w,b)&&g(C,b)}):d(w,function(b){E.includes(b)&&g(C,b)}),C},setIntersection}var hasRequiredEs_set_intersection_v2;function requireEs_set_intersection_v2(){if(hasRequiredEs_set_intersection_v2)return es_set_intersection_v2;hasRequiredEs_set_intersection_v2=1;var a=require_export(),s=requireFails(),c=requireSetIntersection(),u=requireSetMethodAcceptSetLike(),d=!u("intersection",function(h){return h.size===2&&h.has(1)&&h.has(2)})||s(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return a({target:"Set",proto:!0,real:!0,forced:d},{intersection:c}),es_set_intersection_v2}requireEs_set_intersection_v2();var es_set_isDisjointFrom_v2={},setIsDisjointFrom,hasRequiredSetIsDisjointFrom;function requireSetIsDisjointFrom(){if(hasRequiredSetIsDisjointFrom)return setIsDisjointFrom;hasRequiredSetIsDisjointFrom=1;var a=requireASet(),s=requireSetHelpers().has,c=requireSetSize(),u=requireGetSetRecord(),d=requireSetIterate(),h=requireIterateSimple(),f=requireIteratorClose();return setIsDisjointFrom=function(m){var p=a(this),v=u(m);if(c(p)<=v.size)return d(p,function(E){if(v.includes(E))return!1},!0)!==!1;var w=v.getIterator();return h(w,function(E){if(s(p,E))return f(w,"normal",!1)})!==!1},setIsDisjointFrom}var hasRequiredEs_set_isDisjointFrom_v2;function requireEs_set_isDisjointFrom_v2(){if(hasRequiredEs_set_isDisjointFrom_v2)return es_set_isDisjointFrom_v2;hasRequiredEs_set_isDisjointFrom_v2=1;var a=require_export(),s=requireSetIsDisjointFrom(),c=requireSetMethodAcceptSetLike(),u=!c("isDisjointFrom",function(d){return!d});return a({target:"Set",proto:!0,real:!0,forced:u},{isDisjointFrom:s}),es_set_isDisjointFrom_v2}requireEs_set_isDisjointFrom_v2();var es_set_isSubsetOf_v2={},setIsSubsetOf,hasRequiredSetIsSubsetOf;function requireSetIsSubsetOf(){if(hasRequiredSetIsSubsetOf)return setIsSubsetOf;hasRequiredSetIsSubsetOf=1;var a=requireASet(),s=requireSetSize(),c=requireSetIterate(),u=requireGetSetRecord();return setIsSubsetOf=function(h){var f=a(this),g=u(h);return s(f)>g.size?!1:c(f,function(m){if(!g.includes(m))return!1},!0)!==!1},setIsSubsetOf}var hasRequiredEs_set_isSubsetOf_v2;function requireEs_set_isSubsetOf_v2(){if(hasRequiredEs_set_isSubsetOf_v2)return es_set_isSubsetOf_v2;hasRequiredEs_set_isSubsetOf_v2=1;var a=require_export(),s=requireSetIsSubsetOf(),c=requireSetMethodAcceptSetLike(),u=!c("isSubsetOf",function(d){return d});return a({target:"Set",proto:!0,real:!0,forced:u},{isSubsetOf:s}),es_set_isSubsetOf_v2}requireEs_set_isSubsetOf_v2();var es_set_isSupersetOf_v2={},setIsSupersetOf,hasRequiredSetIsSupersetOf;function requireSetIsSupersetOf(){if(hasRequiredSetIsSupersetOf)return setIsSupersetOf;hasRequiredSetIsSupersetOf=1;var a=requireASet(),s=requireSetHelpers().has,c=requireSetSize(),u=requireGetSetRecord(),d=requireIterateSimple(),h=requireIteratorClose();return setIsSupersetOf=function(g){var m=a(this),p=u(g);if(c(m)<p.size)return!1;var v=p.getIterator();return d(v,function(w){if(!s(m,w))return h(v,"normal",!1)})!==!1},setIsSupersetOf}var hasRequiredEs_set_isSupersetOf_v2;function requireEs_set_isSupersetOf_v2(){if(hasRequiredEs_set_isSupersetOf_v2)return es_set_isSupersetOf_v2;hasRequiredEs_set_isSupersetOf_v2=1;var a=require_export(),s=requireSetIsSupersetOf(),c=requireSetMethodAcceptSetLike(),u=!c("isSupersetOf",function(d){return!d});return a({target:"Set",proto:!0,real:!0,forced:u},{isSupersetOf:s}),es_set_isSupersetOf_v2}requireEs_set_isSupersetOf_v2();var es_set_symmetricDifference_v2={},setSymmetricDifference,hasRequiredSetSymmetricDifference;function requireSetSymmetricDifference(){if(hasRequiredSetSymmetricDifference)return setSymmetricDifference;hasRequiredSetSymmetricDifference=1;var a=requireASet(),s=requireSetHelpers(),c=requireSetClone(),u=requireGetSetRecord(),d=requireIterateSimple(),h=s.add,f=s.has,g=s.remove;return setSymmetricDifference=function(p){var v=a(this),w=u(p).getIterator(),E=c(v);return d(w,function(C){f(v,C)?g(E,C):h(E,C)}),E},setSymmetricDifference}var setMethodGetKeysBeforeCloningDetection,hasRequiredSetMethodGetKeysBeforeCloningDetection;function requireSetMethodGetKeysBeforeCloningDetection(){return hasRequiredSetMethodGetKeysBeforeCloningDetection||(hasRequiredSetMethodGetKeysBeforeCloningDetection=1,setMethodGetKeysBeforeCloningDetection=function(a){try{var s=new Set,c={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return s.clear(),s.add(4),function(){return{done:!0}}}})}},u=s[a](c);return u.size===1&&u.values().next().value===4}catch{return!1}}),setMethodGetKeysBeforeCloningDetection}var hasRequiredEs_set_symmetricDifference_v2;function requireEs_set_symmetricDifference_v2(){if(hasRequiredEs_set_symmetricDifference_v2)return es_set_symmetricDifference_v2;hasRequiredEs_set_symmetricDifference_v2=1;var a=require_export(),s=requireSetSymmetricDifference(),c=requireSetMethodGetKeysBeforeCloningDetection(),u=requireSetMethodAcceptSetLike(),d=!u("symmetricDifference")||!c("symmetricDifference");return a({target:"Set",proto:!0,real:!0,forced:d},{symmetricDifference:s}),es_set_symmetricDifference_v2}requireEs_set_symmetricDifference_v2();var es_set_union_v2={},setUnion,hasRequiredSetUnion;function requireSetUnion(){if(hasRequiredSetUnion)return setUnion;hasRequiredSetUnion=1;var a=requireASet(),s=requireSetHelpers().add,c=requireSetClone(),u=requireGetSetRecord(),d=requireIterateSimple();return setUnion=function(f){var g=a(this),m=u(f).getIterator(),p=c(g);return d(m,function(v){s(p,v)}),p},setUnion}var hasRequiredEs_set_union_v2;function requireEs_set_union_v2(){if(hasRequiredEs_set_union_v2)return es_set_union_v2;hasRequiredEs_set_union_v2=1;var a=require_export(),s=requireSetUnion(),c=requireSetMethodGetKeysBeforeCloningDetection(),u=requireSetMethodAcceptSetLike(),d=!u("union")||!c("union");return a({target:"Set",proto:!0,real:!0,forced:d},{union:s}),es_set_union_v2}requireEs_set_union_v2();var esnext_iterator_constructor={},es_iterator_constructor={},anInstance,hasRequiredAnInstance;function requireAnInstance(){if(hasRequiredAnInstance)return anInstance;hasRequiredAnInstance=1;var a=requireObjectIsPrototypeOf(),s=TypeError;return anInstance=function(c,u){if(a(u,c))return c;throw new s("Incorrect invocation")},anInstance}var correctPrototypeGetter,hasRequiredCorrectPrototypeGetter;function requireCorrectPrototypeGetter(){if(hasRequiredCorrectPrototypeGetter)return correctPrototypeGetter;hasRequiredCorrectPrototypeGetter=1;var a=requireFails();return correctPrototypeGetter=!a(function(){function s(){}return s.prototype.constructor=null,Object.getPrototypeOf(new s)!==s.prototype}),correctPrototypeGetter}var objectGetPrototypeOf,hasRequiredObjectGetPrototypeOf;function requireObjectGetPrototypeOf(){if(hasRequiredObjectGetPrototypeOf)return objectGetPrototypeOf;hasRequiredObjectGetPrototypeOf=1;var a=requireHasOwnProperty(),s=requireIsCallable(),c=requireToObject(),u=requireSharedKey(),d=requireCorrectPrototypeGetter(),h=u("IE_PROTO"),f=Object,g=f.prototype;return objectGetPrototypeOf=d?f.getPrototypeOf:function(m){var p=c(m);if(a(p,h))return p[h];var v=p.constructor;return s(v)&&p instanceof v?v.prototype:p instanceof f?g:null},objectGetPrototypeOf}var defineBuiltInAccessor,hasRequiredDefineBuiltInAccessor;function requireDefineBuiltInAccessor(){if(hasRequiredDefineBuiltInAccessor)return defineBuiltInAccessor;hasRequiredDefineBuiltInAccessor=1;var a=requireMakeBuiltIn(),s=requireObjectDefineProperty();return defineBuiltInAccessor=function(c,u,d){return d.get&&a(d.get,u,{getter:!0}),d.set&&a(d.set,u,{setter:!0}),s.f(c,u,d)},defineBuiltInAccessor}var objectDefineProperties={},objectKeys,hasRequiredObjectKeys;function requireObjectKeys(){if(hasRequiredObjectKeys)return objectKeys;hasRequiredObjectKeys=1;var a=requireObjectKeysInternal(),s=requireEnumBugKeys();return objectKeys=Object.keys||function(u){return a(u,s)},objectKeys}var hasRequiredObjectDefineProperties;function requireObjectDefineProperties(){if(hasRequiredObjectDefineProperties)return objectDefineProperties;hasRequiredObjectDefineProperties=1;var a=requireDescriptors(),s=requireV8PrototypeDefineBug(),c=requireObjectDefineProperty(),u=requireAnObject(),d=requireToIndexedObject(),h=requireObjectKeys();return objectDefineProperties.f=a&&!s?Object.defineProperties:function(g,m){u(g);for(var p=d(m),v=h(m),w=v.length,E=0,C;w>E;)c.f(g,C=v[E++],p[C]);return g},objectDefineProperties}var html$3,hasRequiredHtml;function requireHtml(){if(hasRequiredHtml)return html$3;hasRequiredHtml=1;var a=requireGetBuiltIn();return html$3=a("document","documentElement"),html$3}var objectCreate,hasRequiredObjectCreate;function requireObjectCreate(){if(hasRequiredObjectCreate)return objectCreate;hasRequiredObjectCreate=1;var a=requireAnObject(),s=requireObjectDefineProperties(),c=requireEnumBugKeys(),u=requireHiddenKeys(),d=requireHtml(),h=requireDocumentCreateElement(),f=requireSharedKey(),g=">",m="<",p="prototype",v="script",w=f("IE_PROTO"),E=function(){},C=function(I){return m+v+g+I+m+"/"+v+g},b=function(I){I.write(C("")),I.close();var M=I.parentWindow.Object;return I=null,M},P=function(){var I=h("iframe"),M="java"+v+":",N;return I.style.display="none",d.appendChild(I),I.src=String(M),N=I.contentWindow.document,N.open(),N.write(C("document.F=Object")),N.close(),N.F},R,T=function(){try{R=new ActiveXObject("htmlfile")}catch{}T=typeof document<"u"?document.domain&&R?b(R):P():b(R);for(var I=c.length;I--;)delete T[p][c[I]];return T()};return u[w]=!0,objectCreate=Object.create||function(M,N){var H;return M!==null?(E[p]=a(M),H=new E,E[p]=null,H[w]=M):H=T(),N===void 0?H:s.f(H,N)},objectCreate}var iteratorsCore,hasRequiredIteratorsCore;function requireIteratorsCore(){if(hasRequiredIteratorsCore)return iteratorsCore;hasRequiredIteratorsCore=1;var a=requireFails(),s=requireIsCallable(),c=requireIsObject(),u=requireObjectCreate(),d=requireObjectGetPrototypeOf(),h=requireDefineBuiltIn(),f=requireWellKnownSymbol(),g=requireIsPure(),m=f("iterator"),p=!1,v,w,E;[].keys&&(E=[].keys(),"next"in E?(w=d(d(E)),w!==Object.prototype&&(v=w)):p=!0);var C=!c(v)||a(function(){var b={};return v[m].call(b)!==b});return C?v={}:g&&(v=u(v)),s(v[m])||h(v,m,function(){return this}),iteratorsCore={IteratorPrototype:v,BUGGY_SAFARI_ITERATORS:p},iteratorsCore}var hasRequiredEs_iterator_constructor;function requireEs_iterator_constructor(){if(hasRequiredEs_iterator_constructor)return es_iterator_constructor;hasRequiredEs_iterator_constructor=1;var a=require_export(),s=requireGlobalThis(),c=requireAnInstance(),u=requireAnObject(),d=requireIsCallable(),h=requireObjectGetPrototypeOf(),f=requireDefineBuiltInAccessor(),g=requireCreateProperty(),m=requireFails(),p=requireHasOwnProperty(),v=requireWellKnownSymbol(),w=requireIteratorsCore().IteratorPrototype,E=requireDescriptors(),C=requireIsPure(),b="constructor",P="Iterator",R=v("toStringTag"),T=TypeError,I=s[P],M=C||!d(I)||I.prototype!==w||!m(function(){I({})}),N=function(){if(c(this,w),h(this)===w)throw new T("Abstract class Iterator not directly constructable")},H=function(L,A){E?f(w,L,{configurable:!0,get:function(){return A},set:function(k){if(u(this),this===w)throw new T("You can't redefine this property");p(this,L)?this[L]=k:g(this,L,k)}}):w[L]=A};return p(w,R)||H(R,P),(M||!p(w,b)||w[b]===Object)&&H(b,N),N.prototype=w,a({global:!0,constructor:!0,forced:M},{Iterator:N}),es_iterator_constructor}var hasRequiredEsnext_iterator_constructor;function requireEsnext_iterator_constructor(){return hasRequiredEsnext_iterator_constructor||(hasRequiredEsnext_iterator_constructor=1,requireEs_iterator_constructor()),esnext_iterator_constructor}requireEsnext_iterator_constructor();var esnext_iterator_filter={},es_iterator_filter={},defineBuiltIns,hasRequiredDefineBuiltIns;function requireDefineBuiltIns(){if(hasRequiredDefineBuiltIns)return defineBuiltIns;hasRequiredDefineBuiltIns=1;var a=requireDefineBuiltIn();return defineBuiltIns=function(s,c,u){for(var d in c)a(s,d,c[d],u);return s},defineBuiltIns}var createIterResultObject,hasRequiredCreateIterResultObject;function requireCreateIterResultObject(){return hasRequiredCreateIterResultObject||(hasRequiredCreateIterResultObject=1,createIterResultObject=function(a,s){return{value:a,done:s}}),createIterResultObject}var iteratorCloseAll,hasRequiredIteratorCloseAll;function requireIteratorCloseAll(){if(hasRequiredIteratorCloseAll)return iteratorCloseAll;hasRequiredIteratorCloseAll=1;var a=requireIteratorClose();return iteratorCloseAll=function(s,c,u){for(var d=s.length-1;d>=0;d--)if(s[d]!==void 0)try{u=a(s[d].iterator,c,u)}catch(h){c="throw",u=h}if(c==="throw")throw u;return u},iteratorCloseAll}var iteratorCreateProxy,hasRequiredIteratorCreateProxy;function requireIteratorCreateProxy(){if(hasRequiredIteratorCreateProxy)return iteratorCreateProxy;hasRequiredIteratorCreateProxy=1;var a=requireFunctionCall(),s=requireObjectCreate(),c=requireCreateNonEnumerableProperty(),u=requireDefineBuiltIns(),d=requireWellKnownSymbol(),h=requireInternalState(),f=requireGetMethod(),g=requireIteratorsCore().IteratorPrototype,m=requireCreateIterResultObject(),p=requireIteratorClose(),v=requireIteratorCloseAll(),w=d("toStringTag"),E="IteratorHelper",C="WrapForValidIterator",b="normal",P="throw",R=h.set,T=function(N){var H=h.getterFor(N?C:E);return u(s(g),{next:function(){var A=H(this);if(N)return A.nextHandler();if(A.done)return m(void 0,!0);try{var k=A.nextHandler();return A.returnHandlerResult?k:m(k,A.done)}catch(W){throw A.done=!0,W}},return:function(){var L=H(this),A=L.iterator;if(L.done=!0,N){var k=f(A,"return");return k?a(k,A):m(void 0,!0)}if(L.inner)try{p(L.inner.iterator,b)}catch(W){return p(A,P,W)}if(L.openIters)try{v(L.openIters,b)}catch(W){return p(A,P,W)}return A&&p(A,b),m(void 0,!0)}})},I=T(!0),M=T(!1);return c(M,w,"Iterator Helper"),iteratorCreateProxy=function(N,H,L){var A=function(W,G){G?(G.iterator=W.iterator,G.next=W.next):G=W,G.type=H?C:E,G.returnHandlerResult=!!L,G.nextHandler=N,G.counter=0,G.done=!1,R(this,G)};return A.prototype=H?I:M,A},iteratorCreateProxy}var callWithSafeIterationClosing,hasRequiredCallWithSafeIterationClosing;function requireCallWithSafeIterationClosing(){if(hasRequiredCallWithSafeIterationClosing)return callWithSafeIterationClosing;hasRequiredCallWithSafeIterationClosing=1;var a=requireAnObject(),s=requireIteratorClose();return callWithSafeIterationClosing=function(c,u,d,h){try{return h?u(a(d)[0],d[1]):u(d)}catch(f){s(c,"throw",f)}},callWithSafeIterationClosing}var iteratorHelperThrowsOnInvalidIterator,hasRequiredIteratorHelperThrowsOnInvalidIterator;function requireIteratorHelperThrowsOnInvalidIterator(){return hasRequiredIteratorHelperThrowsOnInvalidIterator||(hasRequiredIteratorHelperThrowsOnInvalidIterator=1,iteratorHelperThrowsOnInvalidIterator=function(a,s){var c=typeof Iterator=="function"&&Iterator.prototype[a];if(c)try{c.call({next:null},s).next()}catch{return!0}}),iteratorHelperThrowsOnInvalidIterator}var iteratorHelperWithoutClosingOnEarlyError,hasRequiredIteratorHelperWithoutClosingOnEarlyError;function requireIteratorHelperWithoutClosingOnEarlyError(){if(hasRequiredIteratorHelperWithoutClosingOnEarlyError)return iteratorHelperWithoutClosingOnEarlyError;hasRequiredIteratorHelperWithoutClosingOnEarlyError=1;var a=requireGlobalThis();return iteratorHelperWithoutClosingOnEarlyError=function(s,c){var u=a.Iterator,d=u&&u.prototype,h=d&&d[s],f=!1;if(h)try{h.call({next:function(){return{done:!0}},return:function(){f=!0}},-1)}catch(g){g instanceof c||(f=!1)}if(!f)return h},iteratorHelperWithoutClosingOnEarlyError}var hasRequiredEs_iterator_filter;function requireEs_iterator_filter(){if(hasRequiredEs_iterator_filter)return es_iterator_filter;hasRequiredEs_iterator_filter=1;var a=require_export(),s=requireFunctionCall(),c=requireACallable(),u=requireAnObject(),d=requireGetIteratorDirect(),h=requireIteratorCreateProxy(),f=requireCallWithSafeIterationClosing(),g=requireIsPure(),m=requireIteratorClose(),p=requireIteratorHelperThrowsOnInvalidIterator(),v=requireIteratorHelperWithoutClosingOnEarlyError(),w=!g&&!p("filter",function(){}),E=!g&&!w&&v("filter",TypeError),C=g||w||E,b=h(function(){for(var P=this.iterator,R=this.predicate,T=this.next,I,M,N;;){if(I=u(s(T,P)),M=this.done=!!I.done,M)return;if(N=I.value,f(P,R,[N,this.counter++],!0))return N}});return a({target:"Iterator",proto:!0,real:!0,forced:C},{filter:function(R){u(this);try{c(R)}catch(T){m(this,"throw",T)}return E?s(E,this,R):new b(d(this),{predicate:R})}}),es_iterator_filter}var hasRequiredEsnext_iterator_filter;function requireEsnext_iterator_filter(){return hasRequiredEsnext_iterator_filter||(hasRequiredEsnext_iterator_filter=1,requireEs_iterator_filter()),esnext_iterator_filter}requireEsnext_iterator_filter();var esnext_iterator_forEach={},es_iterator_forEach={},hasRequiredEs_iterator_forEach;function requireEs_iterator_forEach(){if(hasRequiredEs_iterator_forEach)return es_iterator_forEach;hasRequiredEs_iterator_forEach=1;var a=require_export(),s=requireFunctionCall(),c=requireIterate(),u=requireACallable(),d=requireAnObject(),h=requireGetIteratorDirect(),f=requireIteratorClose(),g=requireIteratorHelperWithoutClosingOnEarlyError(),m=g("forEach",TypeError);return a({target:"Iterator",proto:!0,real:!0,forced:m},{forEach:function(v){d(this);try{u(v)}catch(C){f(this,"throw",C)}if(m)return s(m,this,v);var w=h(this),E=0;c(w,function(C){v(C,E++)},{IS_RECORD:!0})}}),es_iterator_forEach}var hasRequiredEsnext_iterator_forEach;function requireEsnext_iterator_forEach(){return hasRequiredEsnext_iterator_forEach||(hasRequiredEsnext_iterator_forEach=1,requireEs_iterator_forEach()),esnext_iterator_forEach}requireEsnext_iterator_forEach();var esnext_iterator_map={},es_iterator_map={},hasRequiredEs_iterator_map;function requireEs_iterator_map(){if(hasRequiredEs_iterator_map)return es_iterator_map;hasRequiredEs_iterator_map=1;var a=require_export(),s=requireFunctionCall(),c=requireACallable(),u=requireAnObject(),d=requireGetIteratorDirect(),h=requireIteratorCreateProxy(),f=requireCallWithSafeIterationClosing(),g=requireIteratorClose(),m=requireIteratorHelperThrowsOnInvalidIterator(),p=requireIteratorHelperWithoutClosingOnEarlyError(),v=requireIsPure(),w=!v&&!m("map",function(){}),E=!v&&!w&&p("map",TypeError),C=v||w||E,b=h(function(){var P=this.iterator,R=u(s(this.next,P)),T=this.done=!!R.done;if(!T)return f(P,this.mapper,[R.value,this.counter++],!0)});return a({target:"Iterator",proto:!0,real:!0,forced:C},{map:function(R){u(this);try{c(R)}catch(T){g(this,"throw",T)}return E?s(E,this,R):new b(d(this),{mapper:R})}}),es_iterator_map}var hasRequiredEsnext_iterator_map;function requireEsnext_iterator_map(){return hasRequiredEsnext_iterator_map||(hasRequiredEsnext_iterator_map=1,requireEs_iterator_map()),esnext_iterator_map}requireEsnext_iterator_map();var web_immediate={},web_clearImmediate={},arraySlice,hasRequiredArraySlice;function requireArraySlice(){if(hasRequiredArraySlice)return arraySlice;hasRequiredArraySlice=1;var a=requireFunctionUncurryThis();return arraySlice=a([].slice),arraySlice}var validateArgumentsLength,hasRequiredValidateArgumentsLength;function requireValidateArgumentsLength(){if(hasRequiredValidateArgumentsLength)return validateArgumentsLength;hasRequiredValidateArgumentsLength=1;var a=TypeError;return validateArgumentsLength=function(s,c){if(s<c)throw new a("Not enough arguments");return s},validateArgumentsLength}var environmentIsIos,hasRequiredEnvironmentIsIos;function requireEnvironmentIsIos(){if(hasRequiredEnvironmentIsIos)return environmentIsIos;hasRequiredEnvironmentIsIos=1;var a=requireEnvironmentUserAgent();return environmentIsIos=/(?:ipad|iphone|ipod).*applewebkit/i.test(a),environmentIsIos}var environment,hasRequiredEnvironment;function requireEnvironment(){if(hasRequiredEnvironment)return environment;hasRequiredEnvironment=1;var a=requireGlobalThis(),s=requireEnvironmentUserAgent(),c=requireClassofRaw(),u=function(d){return s.slice(0,d.length)===d};return environment=(function(){return u("Bun/")?"BUN":u("Cloudflare-Workers")?"CLOUDFLARE":u("Deno/")?"DENO":u("Node.js/")?"NODE":a.Bun&&typeof Bun.version=="string"?"BUN":a.Deno&&typeof Deno.version=="object"?"DENO":c(a.process)==="process"?"NODE":a.window&&a.document?"BROWSER":"REST"})(),environment}var environmentIsNode,hasRequiredEnvironmentIsNode;function requireEnvironmentIsNode(){if(hasRequiredEnvironmentIsNode)return environmentIsNode;hasRequiredEnvironmentIsNode=1;var a=requireEnvironment();return environmentIsNode=a==="NODE",environmentIsNode}var task,hasRequiredTask;function requireTask(){if(hasRequiredTask)return task;hasRequiredTask=1;var a=requireGlobalThis(),s=requireFunctionApply(),c=requireFunctionBindContext(),u=requireIsCallable(),d=requireHasOwnProperty(),h=requireFails(),f=requireHtml(),g=requireArraySlice(),m=requireDocumentCreateElement(),p=requireValidateArgumentsLength(),v=requireEnvironmentIsIos(),w=requireEnvironmentIsNode(),E=a.setImmediate,C=a.clearImmediate,b=a.process,P=a.Dispatch,R=a.Function,T=a.MessageChannel,I=a.String,M=0,N={},H="onreadystatechange",L,A,k,W;h(function(){L=a.location});var G=function(le){if(d(N,le)){var ye=N[le];delete N[le],ye()}},oe=function(le){return function(){G(le)}},ae=function(le){G(le.data)},X=function(le){a.postMessage(I(le),L.protocol+"//"+L.host)};return(!E||!C)&&(E=function(ye){p(arguments.length,1);var pe=u(ye)?ye:R(ye),he=g(arguments,1);return N[++M]=function(){s(pe,void 0,he)},A(M),M},C=function(ye){delete N[ye]},w?A=function(le){b.nextTick(oe(le))}:P&&P.now?A=function(le){P.now(oe(le))}:T&&!v?(k=new T,W=k.port2,k.port1.onmessage=ae,A=c(W.postMessage,W)):a.addEventListener&&u(a.postMessage)&&!a.importScripts&&L&&L.protocol!=="file:"&&!h(X)?(A=X,a.addEventListener("message",ae,!1)):H in m("script")?A=function(le){f.appendChild(m("script"))[H]=function(){f.removeChild(this),G(le)}}:A=function(le){setTimeout(oe(le),0)}),task={set:E,clear:C},task}var hasRequiredWeb_clearImmediate;function requireWeb_clearImmediate(){if(hasRequiredWeb_clearImmediate)return web_clearImmediate;hasRequiredWeb_clearImmediate=1;var a=require_export(),s=requireGlobalThis(),c=requireTask().clear;return a({global:!0,bind:!0,enumerable:!0,forced:s.clearImmediate!==c},{clearImmediate:c}),web_clearImmediate}var web_setImmediate={},schedulersFix,hasRequiredSchedulersFix;function requireSchedulersFix(){if(hasRequiredSchedulersFix)return schedulersFix;hasRequiredSchedulersFix=1;var a=requireGlobalThis(),s=requireFunctionApply(),c=requireIsCallable(),u=requireEnvironment(),d=requireEnvironmentUserAgent(),h=requireArraySlice(),f=requireValidateArgumentsLength(),g=a.Function,m=/MSIE .\./.test(d)||u==="BUN"&&(function(){var p=a.Bun.version.split(".");return p.length<3||p[0]==="0"&&(p[1]<3||p[1]==="3"&&p[2]==="0")})();return schedulersFix=function(p,v){var w=v?2:1;return m?function(E,C){var b=f(arguments.length,1)>w,P=c(E)?E:g(E),R=b?h(arguments,w):[],T=b?function(){s(P,this,R)}:P;return v?p(T,C):p(T)}:p},schedulersFix}var hasRequiredWeb_setImmediate;function requireWeb_setImmediate(){if(hasRequiredWeb_setImmediate)return web_setImmediate;hasRequiredWeb_setImmediate=1;var a=require_export(),s=requireGlobalThis(),c=requireTask().set,u=requireSchedulersFix(),d=s.setImmediate?u(c,!1):c;return a({global:!0,bind:!0,enumerable:!0,forced:s.setImmediate!==d},{setImmediate:d}),web_setImmediate}var hasRequiredWeb_immediate;function requireWeb_immediate(){return hasRequiredWeb_immediate||(hasRequiredWeb_immediate=1,requireWeb_clearImmediate(),requireWeb_setImmediate()),web_immediate}requireWeb_immediate();const{entries,setPrototypeOf,isFrozen,getPrototypeOf,getOwnPropertyDescriptor}=Object;let{freeze,seal,create}=Object,{apply,construct}=typeof Reflect<"u"&&Reflect;freeze||(freeze=function(s){return s}),seal||(seal=function(s){return s}),apply||(apply=function(s,c){for(var u=arguments.length,d=new Array(u>2?u-2:0),h=2;h<u;h++)d[h-2]=arguments[h];return s.apply(c,d)}),construct||(construct=function(s){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];return new s(...u)});const arrayForEach=unapply(Array.prototype.forEach),arrayLastIndexOf=unapply(Array.prototype.lastIndexOf),arrayPop=unapply(Array.prototype.pop),arrayPush=unapply(Array.prototype.push),arraySplice=unapply(Array.prototype.splice),stringToLowerCase=unapply(String.prototype.toLowerCase),stringToString=unapply(String.prototype.toString),stringMatch=unapply(String.prototype.match),stringReplace=unapply(String.prototype.replace),stringIndexOf=unapply(String.prototype.indexOf),stringTrim=unapply(String.prototype.trim),objectHasOwnProperty=unapply(Object.prototype.hasOwnProperty),regExpTest=unapply(RegExp.prototype.test),typeErrorCreate=unconstruct(TypeError);function unapply(a){return function(s){s instanceof RegExp&&(s.lastIndex=0);for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];return apply(a,s,u)}}function unconstruct(a){return function(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return construct(a,c)}}function addToSet(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:stringToLowerCase;setPrototypeOf&&setPrototypeOf(a,null);let u=s.length;for(;u--;){let d=s[u];if(typeof d=="string"){const h=c(d);h!==d&&(isFrozen(s)||(s[u]=h),d=h)}a[d]=!0}return a}function cleanArray(a){for(let s=0;s<a.length;s++)objectHasOwnProperty(a,s)||(a[s]=null);return a}function clone$2(a){const s=create(null);for(const[c,u]of entries(a))objectHasOwnProperty(a,c)&&(Array.isArray(u)?s[c]=cleanArray(u):u&&typeof u=="object"&&u.constructor===Object?s[c]=clone$2(u):s[c]=u);return s}function lookupGetter(a,s){for(;a!==null;){const u=getOwnPropertyDescriptor(a,s);if(u){if(u.get)return unapply(u.get);if(typeof u.value=="function")return unapply(u.value)}a=getPrototypeOf(a)}function c(){return null}return c}const html$1=freeze(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),svg$1=freeze(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),svgFilters=freeze(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),svgDisallowed=freeze(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),mathMl$1=freeze(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),mathMlDisallowed=freeze(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),text=freeze(["#text"]),html$2=freeze(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),svg=freeze(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),mathMl=freeze(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),xml=freeze(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),MUSTACHE_EXPR=seal(/\{\{[\w\W]*|[\w\W]*\}\}/gm),ERB_EXPR=seal(/<%[\w\W]*|[\w\W]*%>/gm),TMPLIT_EXPR=seal(/\$\{[\w\W]*/gm),DATA_ATTR=seal(/^data-[\-\w.\u00B7-\uFFFF]+$/),ARIA_ATTR=seal(/^aria-[\-\w]+$/),IS_ALLOWED_URI=seal(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),IS_SCRIPT_OR_DATA=seal(/^(?:\w+script|data):/i),ATTR_WHITESPACE=seal(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),DOCTYPE_NAME=seal(/^html$/i),CUSTOM_ELEMENT=seal(/^[a-z][.\w]*(-[.\w]+)+$/i);var EXPRESSIONS=Object.freeze({__proto__:null,ARIA_ATTR,ATTR_WHITESPACE,CUSTOM_ELEMENT,DATA_ATTR,DOCTYPE_NAME,ERB_EXPR,IS_ALLOWED_URI,IS_SCRIPT_OR_DATA,MUSTACHE_EXPR,TMPLIT_EXPR});const NODE_TYPE={element:1,text:3,progressingInstruction:7,comment:8,document:9},getGlobal=function(){return typeof window>"u"?null:window},_createTrustedTypesPolicy=function(s,c){if(typeof s!="object"||typeof s.createPolicy!="function")return null;let u=null;const d="data-tt-policy-suffix";c&&c.hasAttribute(d)&&(u=c.getAttribute(d));const h="dompurify"+(u?"#"+u:"");try{return s.createPolicy(h,{createHTML(f){return f},createScriptURL(f){return f}})}catch{return console.warn("TrustedTypes policy "+h+" could not be created."),null}},_createHooksMap=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function createDOMPurify(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:getGlobal();const s=Ge=>createDOMPurify(Ge);if(s.version="3.3.0",s.removed=[],!a||!a.document||a.document.nodeType!==NODE_TYPE.document||!a.Element)return s.isSupported=!1,s;let{document:c}=a;const u=c,d=u.currentScript,{DocumentFragment:h,HTMLTemplateElement:f,Node:g,Element:m,NodeFilter:p,NamedNodeMap:v=a.NamedNodeMap||a.MozNamedAttrMap,HTMLFormElement:w,DOMParser:E,trustedTypes:C}=a,b=m.prototype,P=lookupGetter(b,"cloneNode"),R=lookupGetter(b,"remove"),T=lookupGetter(b,"nextSibling"),I=lookupGetter(b,"childNodes"),M=lookupGetter(b,"parentNode");if(typeof f=="function"){const Ge=c.createElement("template");Ge.content&&Ge.content.ownerDocument&&(c=Ge.content.ownerDocument)}let N,H="";const{implementation:L,createNodeIterator:A,createDocumentFragment:k,getElementsByTagName:W}=c,{importNode:G}=u;let oe=_createHooksMap();s.isSupported=typeof entries=="function"&&typeof M=="function"&&L&&L.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:ae,ERB_EXPR:X,TMPLIT_EXPR:le,DATA_ATTR:ye,ARIA_ATTR:pe,IS_SCRIPT_OR_DATA:he,ATTR_WHITESPACE:Me,CUSTOM_ELEMENT:Qe}=EXPRESSIONS;let{IS_ALLOWED_URI:Xe}=EXPRESSIONS,Ke=null;const it=addToSet({},[...html$1,...svg$1,...svgFilters,...mathMl$1,...text]);let te=null;const Pe=addToSet({},[...html$2,...svg,...mathMl,...xml]);let U=Object.seal(create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,ee=null;const ce=Object.seal(create(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ve=!0,K=!0,ne=!1,de=!0,Oe=!1,Se=!0,ge=!1,De=!1,$e=!1,Fe=!1,Ve=!1,Be=!1,Je=!0,lt=!1;const ot="user-content-";let ht=!0,Ct=!1,bt={},vt=null;const mt=addToSet({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Et=null;const Rt=addToSet({},["audio","video","img","source","image","track"]);let V=null;const q=addToSet({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),D="http://www.w3.org/1998/Math/MathML",O="http://www.w3.org/2000/svg",re="http://www.w3.org/1999/xhtml";let Ee=re,we=!1,Z=null;const Y=addToSet({},[D,O,re],stringToString);let se=addToSet({},["mi","mo","mn","ms","mtext"]),_e=addToSet({},["annotation-xml"]);const Ae=addToSet({},["title","style","font","a","script"]);let ke=null;const je=["application/xhtml+xml","text/html"],Ue="text/html";let et=null,st=null;const at=c.createElement("form"),ft=function(Te){return Te instanceof RegExp||Te instanceof Function},gt=function(){let Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(st&&st===Te)){if((!Te||typeof Te!="object")&&(Te={}),Te=clone$2(Te),ke=je.indexOf(Te.PARSER_MEDIA_TYPE)===-1?Ue:Te.PARSER_MEDIA_TYPE,et=ke==="application/xhtml+xml"?stringToString:stringToLowerCase,Ke=objectHasOwnProperty(Te,"ALLOWED_TAGS")?addToSet({},Te.ALLOWED_TAGS,et):it,te=objectHasOwnProperty(Te,"ALLOWED_ATTR")?addToSet({},Te.ALLOWED_ATTR,et):Pe,Z=objectHasOwnProperty(Te,"ALLOWED_NAMESPACES")?addToSet({},Te.ALLOWED_NAMESPACES,stringToString):Y,V=objectHasOwnProperty(Te,"ADD_URI_SAFE_ATTR")?addToSet(clone$2(q),Te.ADD_URI_SAFE_ATTR,et):q,Et=objectHasOwnProperty(Te,"ADD_DATA_URI_TAGS")?addToSet(clone$2(Rt),Te.ADD_DATA_URI_TAGS,et):Rt,vt=objectHasOwnProperty(Te,"FORBID_CONTENTS")?addToSet({},Te.FORBID_CONTENTS,et):mt,Q=objectHasOwnProperty(Te,"FORBID_TAGS")?addToSet({},Te.FORBID_TAGS,et):clone$2({}),ee=objectHasOwnProperty(Te,"FORBID_ATTR")?addToSet({},Te.FORBID_ATTR,et):clone$2({}),bt=objectHasOwnProperty(Te,"USE_PROFILES")?Te.USE_PROFILES:!1,ve=Te.ALLOW_ARIA_ATTR!==!1,K=Te.ALLOW_DATA_ATTR!==!1,ne=Te.ALLOW_UNKNOWN_PROTOCOLS||!1,de=Te.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Oe=Te.SAFE_FOR_TEMPLATES||!1,Se=Te.SAFE_FOR_XML!==!1,ge=Te.WHOLE_DOCUMENT||!1,Fe=Te.RETURN_DOM||!1,Ve=Te.RETURN_DOM_FRAGMENT||!1,Be=Te.RETURN_TRUSTED_TYPE||!1,$e=Te.FORCE_BODY||!1,Je=Te.SANITIZE_DOM!==!1,lt=Te.SANITIZE_NAMED_PROPS||!1,ht=Te.KEEP_CONTENT!==!1,Ct=Te.IN_PLACE||!1,Xe=Te.ALLOWED_URI_REGEXP||IS_ALLOWED_URI,Ee=Te.NAMESPACE||re,se=Te.MATHML_TEXT_INTEGRATION_POINTS||se,_e=Te.HTML_INTEGRATION_POINTS||_e,U=Te.CUSTOM_ELEMENT_HANDLING||{},Te.CUSTOM_ELEMENT_HANDLING&&ft(Te.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(U.tagNameCheck=Te.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Te.CUSTOM_ELEMENT_HANDLING&&ft(Te.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(U.attributeNameCheck=Te.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Te.CUSTOM_ELEMENT_HANDLING&&typeof Te.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(U.allowCustomizedBuiltInElements=Te.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Oe&&(K=!1),Ve&&(Fe=!0),bt&&(Ke=addToSet({},text),te=[],bt.html===!0&&(addToSet(Ke,html$1),addToSet(te,html$2)),bt.svg===!0&&(addToSet(Ke,svg$1),addToSet(te,svg),addToSet(te,xml)),bt.svgFilters===!0&&(addToSet(Ke,svgFilters),addToSet(te,svg),addToSet(te,xml)),bt.mathMl===!0&&(addToSet(Ke,mathMl$1),addToSet(te,mathMl),addToSet(te,xml))),Te.ADD_TAGS&&(typeof Te.ADD_TAGS=="function"?ce.tagCheck=Te.ADD_TAGS:(Ke===it&&(Ke=clone$2(Ke)),addToSet(Ke,Te.ADD_TAGS,et))),Te.ADD_ATTR&&(typeof Te.ADD_ATTR=="function"?ce.attributeCheck=Te.ADD_ATTR:(te===Pe&&(te=clone$2(te)),addToSet(te,Te.ADD_ATTR,et))),Te.ADD_URI_SAFE_ATTR&&addToSet(V,Te.ADD_URI_SAFE_ATTR,et),Te.FORBID_CONTENTS&&(vt===mt&&(vt=clone$2(vt)),addToSet(vt,Te.FORBID_CONTENTS,et)),ht&&(Ke["#text"]=!0),ge&&addToSet(Ke,["html","head","body"]),Ke.table&&(addToSet(Ke,["tbody"]),delete Q.tbody),Te.TRUSTED_TYPES_POLICY){if(typeof Te.TRUSTED_TYPES_POLICY.createHTML!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Te.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw typeErrorCreate('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');N=Te.TRUSTED_TYPES_POLICY,H=N.createHTML("")}else N===void 0&&(N=_createTrustedTypesPolicy(C,d)),N!==null&&typeof H=="string"&&(H=N.createHTML(""));freeze&&freeze(Te),st=Te}},Ie=addToSet({},[...svg$1,...svgFilters,...svgDisallowed]),We=addToSet({},[...mathMl$1,...mathMlDisallowed]),tt=function(Te){let ze=M(Te);(!ze||!ze.tagName)&&(ze={namespaceURI:Ee,tagName:"template"});const nt=stringToLowerCase(Te.tagName),ut=stringToLowerCase(ze.tagName);return Z[Te.namespaceURI]?Te.namespaceURI===O?ze.namespaceURI===re?nt==="svg":ze.namespaceURI===D?nt==="svg"&&(ut==="annotation-xml"||se[ut]):!!Ie[nt]:Te.namespaceURI===D?ze.namespaceURI===re?nt==="math":ze.namespaceURI===O?nt==="math"&&_e[ut]:!!We[nt]:Te.namespaceURI===re?ze.namespaceURI===O&&!_e[ut]||ze.namespaceURI===D&&!se[ut]?!1:!We[nt]&&(Ae[nt]||!Ie[nt]):!!(ke==="application/xhtml+xml"&&Z[Te.namespaceURI]):!1},ue=function(Te){arrayPush(s.removed,{element:Te});try{M(Te).removeChild(Te)}catch{R(Te)}},be=function(Te,ze){try{arrayPush(s.removed,{attribute:ze.getAttributeNode(Te),from:ze})}catch{arrayPush(s.removed,{attribute:null,from:ze})}if(ze.removeAttribute(Te),Te==="is")if(Fe||Ve)try{ue(ze)}catch{}else try{ze.setAttribute(Te,"")}catch{}},j=function(Te){let ze=null,nt=null;if($e)Te="<remove></remove>"+Te;else{const $t=stringMatch(Te,/^[\r\n\t ]+/);nt=$t&&$t[0]}ke==="application/xhtml+xml"&&Ee===re&&(Te='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Te+"</body></html>");const ut=N?N.createHTML(Te):Te;if(Ee===re)try{ze=new E().parseFromString(ut,ke)}catch{}if(!ze||!ze.documentElement){ze=L.createDocument(Ee,"template",null);try{ze.documentElement.innerHTML=we?H:ut}catch{}}const _t=ze.body||ze.documentElement;return Te&&nt&&_t.insertBefore(c.createTextNode(nt),_t.childNodes[0]||null),Ee===re?W.call(ze,ge?"html":"body")[0]:ge?ze.documentElement:_t},J=function(Te){return A.call(Te.ownerDocument||Te,Te,p.SHOW_ELEMENT|p.SHOW_COMMENT|p.SHOW_TEXT|p.SHOW_PROCESSING_INSTRUCTION|p.SHOW_CDATA_SECTION,null)},Ce=function(Te){return Te instanceof w&&(typeof Te.nodeName!="string"||typeof Te.textContent!="string"||typeof Te.removeChild!="function"||!(Te.attributes instanceof v)||typeof Te.removeAttribute!="function"||typeof Te.setAttribute!="function"||typeof Te.namespaceURI!="string"||typeof Te.insertBefore!="function"||typeof Te.hasChildNodes!="function")},Le=function(Te){return typeof g=="function"&&Te instanceof g};function me(Ge,Te,ze){arrayForEach(Ge,nt=>{nt.call(s,Te,ze,st)})}const He=function(Te){let ze=null;if(me(oe.beforeSanitizeElements,Te,null),Ce(Te))return ue(Te),!0;const nt=et(Te.nodeName);if(me(oe.uponSanitizeElement,Te,{tagName:nt,allowedTags:Ke}),Se&&Te.hasChildNodes()&&!Le(Te.firstElementChild)&&regExpTest(/<[/\w!]/g,Te.innerHTML)&&regExpTest(/<[/\w!]/g,Te.textContent)||Te.nodeType===NODE_TYPE.progressingInstruction||Se&&Te.nodeType===NODE_TYPE.comment&&regExpTest(/<[/\w]/g,Te.data))return ue(Te),!0;if(!(ce.tagCheck instanceof Function&&ce.tagCheck(nt))&&(!Ke[nt]||Q[nt])){if(!Q[nt]&&Re(nt)&&(U.tagNameCheck instanceof RegExp&&regExpTest(U.tagNameCheck,nt)||U.tagNameCheck instanceof Function&&U.tagNameCheck(nt)))return!1;if(ht&&!vt[nt]){const ut=M(Te)||Te.parentNode,_t=I(Te)||Te.childNodes;if(_t&&ut){const $t=_t.length;for(let Nt=$t-1;Nt>=0;--Nt){const At=P(_t[Nt],!0);At.__removalCount=(Te.__removalCount||0)+1,ut.insertBefore(At,T(Te))}}}return ue(Te),!0}return Te instanceof m&&!tt(Te)||(nt==="noscript"||nt==="noembed"||nt==="noframes")&&regExpTest(/<\/no(script|embed|frames)/i,Te.innerHTML)?(ue(Te),!0):(Oe&&Te.nodeType===NODE_TYPE.text&&(ze=Te.textContent,arrayForEach([ae,X,le],ut=>{ze=stringReplace(ze,ut," ")}),Te.textContent!==ze&&(arrayPush(s.removed,{element:Te.cloneNode()}),Te.textContent=ze)),me(oe.afterSanitizeElements,Te,null),!1)},Ze=function(Te,ze,nt){if(Je&&(ze==="id"||ze==="name")&&(nt in c||nt in at))return!1;if(!(K&&!ee[ze]&&regExpTest(ye,ze))){if(!(ve&&regExpTest(pe,ze))){if(!(ce.attributeCheck instanceof Function&&ce.attributeCheck(ze,Te))){if(!te[ze]||ee[ze]){if(!(Re(Te)&&(U.tagNameCheck instanceof RegExp&&regExpTest(U.tagNameCheck,Te)||U.tagNameCheck instanceof Function&&U.tagNameCheck(Te))&&(U.attributeNameCheck instanceof RegExp&&regExpTest(U.attributeNameCheck,ze)||U.attributeNameCheck instanceof Function&&U.attributeNameCheck(ze,Te))||ze==="is"&&U.allowCustomizedBuiltInElements&&(U.tagNameCheck instanceof RegExp&&regExpTest(U.tagNameCheck,nt)||U.tagNameCheck instanceof Function&&U.tagNameCheck(nt))))return!1}else if(!V[ze]){if(!regExpTest(Xe,stringReplace(nt,Me,""))){if(!((ze==="src"||ze==="xlink:href"||ze==="href")&&Te!=="script"&&stringIndexOf(nt,"data:")===0&&Et[Te])){if(!(ne&&!regExpTest(he,stringReplace(nt,Me,"")))){if(nt)return!1}}}}}}}return!0},Re=function(Te){return Te!=="annotation-xml"&&stringMatch(Te,Qe)},xe=function(Te){me(oe.beforeSanitizeAttributes,Te,null);const{attributes:ze}=Te;if(!ze||Ce(Te))return;const nt={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let ut=ze.length;for(;ut--;){const _t=ze[ut],{name:$t,namespaceURI:Nt,value:At}=_t,xt=et($t),Ft=At;let St=$t==="value"?Ft:stringTrim(Ft);if(nt.attrName=xt,nt.attrValue=St,nt.keepAttr=!0,nt.forceKeepAttr=void 0,me(oe.uponSanitizeAttribute,Te,nt),St=nt.attrValue,lt&&(xt==="id"||xt==="name")&&(be($t,Te),St=ot+St),Se&&regExpTest(/((--!?|])>)|<\/(style|title|textarea)/i,St)){be($t,Te);continue}if(xt==="attributename"&&stringMatch(St,"href")){be($t,Te);continue}if(nt.forceKeepAttr)continue;if(!nt.keepAttr){be($t,Te);continue}if(!de&&regExpTest(/\/>/i,St)){be($t,Te);continue}Oe&&arrayForEach([ae,X,le],Yt=>{St=stringReplace(St,Yt," ")});const wt=et(Te.nodeName);if(!Ze(wt,xt,St)){be($t,Te);continue}if(N&&typeof C=="object"&&typeof C.getAttributeType=="function"&&!Nt)switch(C.getAttributeType(wt,xt)){case"TrustedHTML":{St=N.createHTML(St);break}case"TrustedScriptURL":{St=N.createScriptURL(St);break}}if(St!==Ft)try{Nt?Te.setAttributeNS(Nt,$t,St):Te.setAttribute($t,St),Ce(Te)?ue(Te):arrayPop(s.removed)}catch{be($t,Te)}}me(oe.afterSanitizeAttributes,Te,null)},Ye=function Ge(Te){let ze=null;const nt=J(Te);for(me(oe.beforeSanitizeShadowDOM,Te,null);ze=nt.nextNode();)me(oe.uponSanitizeShadowNode,ze,null),He(ze),xe(ze),ze.content instanceof h&&Ge(ze.content);me(oe.afterSanitizeShadowDOM,Te,null)};return s.sanitize=function(Ge){let Te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},ze=null,nt=null,ut=null,_t=null;if(we=!Ge,we&&(Ge="<!-->"),typeof Ge!="string"&&!Le(Ge))if(typeof Ge.toString=="function"){if(Ge=Ge.toString(),typeof Ge!="string")throw typeErrorCreate("dirty is not a string, aborting")}else throw typeErrorCreate("toString is not a function");if(!s.isSupported)return Ge;if(De||gt(Te),s.removed=[],typeof Ge=="string"&&(Ct=!1),Ct){if(Ge.nodeName){const At=et(Ge.nodeName);if(!Ke[At]||Q[At])throw typeErrorCreate("root node is forbidden and cannot be sanitized in-place")}}else if(Ge instanceof g)ze=j("<!---->"),nt=ze.ownerDocument.importNode(Ge,!0),nt.nodeType===NODE_TYPE.element&&nt.nodeName==="BODY"||nt.nodeName==="HTML"?ze=nt:ze.appendChild(nt);else{if(!Fe&&!Oe&&!ge&&Ge.indexOf("<")===-1)return N&&Be?N.createHTML(Ge):Ge;if(ze=j(Ge),!ze)return Fe?null:Be?H:""}ze&&$e&&ue(ze.firstChild);const $t=J(Ct?Ge:ze);for(;ut=$t.nextNode();)He(ut),xe(ut),ut.content instanceof h&&Ye(ut.content);if(Ct)return Ge;if(Fe){if(Ve)for(_t=k.call(ze.ownerDocument);ze.firstChild;)_t.appendChild(ze.firstChild);else _t=ze;return(te.shadowroot||te.shadowrootmode)&&(_t=G.call(u,_t,!0)),_t}let Nt=ge?ze.outerHTML:ze.innerHTML;return ge&&Ke["!doctype"]&&ze.ownerDocument&&ze.ownerDocument.doctype&&ze.ownerDocument.doctype.name&&regExpTest(DOCTYPE_NAME,ze.ownerDocument.doctype.name)&&(Nt="<!DOCTYPE "+ze.ownerDocument.doctype.name+`>
`+Nt),Oe&&arrayForEach([ae,X,le],At=>{Nt=stringReplace(Nt,At," ")}),N&&Be?N.createHTML(Nt):Nt},s.setConfig=function(){let Ge=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};gt(Ge),De=!0},s.clearConfig=function(){st=null,De=!1},s.isValidAttribute=function(Ge,Te,ze){st||gt({});const nt=et(Ge),ut=et(Te);return Ze(nt,ut,ze)},s.addHook=function(Ge,Te){typeof Te=="function"&&arrayPush(oe[Ge],Te)},s.removeHook=function(Ge,Te){if(Te!==void 0){const ze=arrayLastIndexOf(oe[Ge],Te);return ze===-1?void 0:arraySplice(oe[Ge],ze,1)[0]}return arrayPop(oe[Ge])},s.removeHooks=function(Ge){oe[Ge]=[]},s.removeAllHooks=function(){oe=_createHooksMap()},s}var purify=createDOMPurify();var hookCallback;function hooks(){return hookCallback.apply(null,arguments)}function setHookCallback(a){hookCallback=a}function isArray$1(a){return a instanceof Array||Object.prototype.toString.call(a)==="[object Array]"}function isObject$1(a){return a!=null&&Object.prototype.toString.call(a)==="[object Object]"}function hasOwnProp(a,s){return Object.prototype.hasOwnProperty.call(a,s)}function isObjectEmpty(a){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(a).length===0;var s;for(s in a)if(hasOwnProp(a,s))return!1;return!0}function isUndefined$1(a){return a===void 0}function isNumber(a){return typeof a=="number"||Object.prototype.toString.call(a)==="[object Number]"}function isDate$2(a){return a instanceof Date||Object.prototype.toString.call(a)==="[object Date]"}function map(a,s){var c=[],u,d=a.length;for(u=0;u<d;++u)c.push(s(a[u],u));return c}function extend$2(a,s){for(var c in s)hasOwnProp(s,c)&&(a[c]=s[c]);return hasOwnProp(s,"toString")&&(a.toString=s.toString),hasOwnProp(s,"valueOf")&&(a.valueOf=s.valueOf),a}function createUTC(a,s,c,u){return createLocalOrUTC(a,s,c,u,!0).utc()}function defaultParsingFlags(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function getParsingFlags(a){return a._pf==null&&(a._pf=defaultParsingFlags()),a._pf}var some;Array.prototype.some?some=Array.prototype.some:some=function(a){var s=Object(this),c=s.length>>>0,u;for(u=0;u<c;u++)if(u in s&&a.call(this,s[u],u,s))return!0;return!1};function isValid$1(a){var s=null,c=!1,u=a._d&&!isNaN(a._d.getTime());if(u&&(s=getParsingFlags(a),c=some.call(s.parsedDateParts,function(d){return d!=null}),u=s.overflow<0&&!s.empty&&!s.invalidEra&&!s.invalidMonth&&!s.invalidWeekday&&!s.weekdayMismatch&&!s.nullInput&&!s.invalidFormat&&!s.userInvalidated&&(!s.meridiem||s.meridiem&&c),a._strict&&(u=u&&s.charsLeftOver===0&&s.unusedTokens.length===0&&s.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(a))a._isValid=u;else return u;return a._isValid}function createInvalid(a){var s=createUTC(NaN);return a!=null?extend$2(getParsingFlags(s),a):getParsingFlags(s).userInvalidated=!0,s}var momentProperties=hooks.momentProperties=[],updateInProgress=!1;function copyConfig(a,s){var c,u,d,h=momentProperties.length;if(isUndefined$1(s._isAMomentObject)||(a._isAMomentObject=s._isAMomentObject),isUndefined$1(s._i)||(a._i=s._i),isUndefined$1(s._f)||(a._f=s._f),isUndefined$1(s._l)||(a._l=s._l),isUndefined$1(s._strict)||(a._strict=s._strict),isUndefined$1(s._tzm)||(a._tzm=s._tzm),isUndefined$1(s._isUTC)||(a._isUTC=s._isUTC),isUndefined$1(s._offset)||(a._offset=s._offset),isUndefined$1(s._pf)||(a._pf=getParsingFlags(s)),isUndefined$1(s._locale)||(a._locale=s._locale),h>0)for(c=0;c<h;c++)u=momentProperties[c],d=s[u],isUndefined$1(d)||(a[u]=d);return a}function Moment(a){copyConfig(this,a),this._d=new Date(a._d!=null?a._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),updateInProgress===!1&&(updateInProgress=!0,hooks.updateOffset(this),updateInProgress=!1)}function isMoment(a){return a instanceof Moment||a!=null&&a._isAMomentObject!=null}function warn$2(a){hooks.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+a)}function deprecate(a,s){var c=!0;return extend$2(function(){if(hooks.deprecationHandler!=null&&hooks.deprecationHandler(null,a),c){var u=[],d,h,f,g=arguments.length;for(h=0;h<g;h++){if(d="",typeof arguments[h]=="object"){d+=`
[`+h+"] ";for(f in arguments[0])hasOwnProp(arguments[0],f)&&(d+=f+": "+arguments[0][f]+", ");d=d.slice(0,-2)}else d=arguments[h];u.push(d)}warn$2(a+`
Arguments: `+Array.prototype.slice.call(u).join("")+`
`+new Error().stack),c=!1}return s.apply(this,arguments)},s)}var deprecations={};function deprecateSimple(a,s){hooks.deprecationHandler!=null&&hooks.deprecationHandler(a,s),deprecations[a]||(warn$2(s),deprecations[a]=!0)}hooks.suppressDeprecationWarnings=!1,hooks.deprecationHandler=null;function isFunction$1(a){return typeof Function<"u"&&a instanceof Function||Object.prototype.toString.call(a)==="[object Function]"}function set$1(a){var s,c;for(c in a)hasOwnProp(a,c)&&(s=a[c],isFunction$1(s)?this[c]=s:this["_"+c]=s);this._config=a,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function mergeConfigs(a,s){var c=extend$2({},a),u;for(u in s)hasOwnProp(s,u)&&(isObject$1(a[u])&&isObject$1(s[u])?(c[u]={},extend$2(c[u],a[u]),extend$2(c[u],s[u])):s[u]!=null?c[u]=s[u]:delete c[u]);for(u in a)hasOwnProp(a,u)&&!hasOwnProp(s,u)&&isObject$1(a[u])&&(c[u]=extend$2({},c[u]));return c}function Locale(a){a!=null&&this.set(a)}var keys;Object.keys?keys=Object.keys:keys=function(a){var s,c=[];for(s in a)hasOwnProp(a,s)&&c.push(s);return c};var defaultCalendar={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function calendar(a,s,c){var u=this._calendar[a]||this._calendar.sameElse;return isFunction$1(u)?u.call(s,c):u}function zeroFill(a,s,c){var u=""+Math.abs(a),d=s-u.length,h=a>=0;return(h?c?"+":"":"-")+Math.pow(10,Math.max(0,d)).toString().substr(1)+u}var formattingTokens=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,formatFunctions={},formatTokenFunctions={};function addFormatToken(a,s,c,u){var d=u;typeof u=="string"&&(d=function(){return this[u]()}),a&&(formatTokenFunctions[a]=d),s&&(formatTokenFunctions[s[0]]=function(){return zeroFill(d.apply(this,arguments),s[1],s[2])}),c&&(formatTokenFunctions[c]=function(){return this.localeData().ordinal(d.apply(this,arguments),a)})}function removeFormattingTokens(a){return a.match(/\[[\s\S]/)?a.replace(/^\[|\]$/g,""):a.replace(/\\/g,"")}function makeFormatFunction(a){var s=a.match(formattingTokens),c,u;for(c=0,u=s.length;c<u;c++)formatTokenFunctions[s[c]]?s[c]=formatTokenFunctions[s[c]]:s[c]=removeFormattingTokens(s[c]);return function(d){var h="",f;for(f=0;f<u;f++)h+=isFunction$1(s[f])?s[f].call(d,a):s[f];return h}}function formatMoment(a,s){return a.isValid()?(s=expandFormat(s,a.localeData()),formatFunctions[s]=formatFunctions[s]||makeFormatFunction(s),formatFunctions[s](a)):a.localeData().invalidDate()}function expandFormat(a,s){var c=5;function u(d){return s.longDateFormat(d)||d}for(localFormattingTokens.lastIndex=0;c>=0&&localFormattingTokens.test(a);)a=a.replace(localFormattingTokens,u),localFormattingTokens.lastIndex=0,c-=1;return a}var defaultLongDateFormat={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function longDateFormat(a){var s=this._longDateFormat[a],c=this._longDateFormat[a.toUpperCase()];return s||!c?s:(this._longDateFormat[a]=c.match(formattingTokens).map(function(u){return u==="MMMM"||u==="MM"||u==="DD"||u==="dddd"?u.slice(1):u}).join(""),this._longDateFormat[a])}var defaultInvalidDate="Invalid date";function invalidDate(){return this._invalidDate}var defaultOrdinal="%d",defaultDayOfMonthOrdinalParse=/\d{1,2}/;function ordinal(a){return this._ordinal.replace("%d",a)}var defaultRelativeTime={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function relativeTime(a,s,c,u){var d=this._relativeTime[c];return isFunction$1(d)?d(a,s,c,u):d.replace(/%d/i,a)}function pastFuture(a,s){var c=this._relativeTime[a>0?"future":"past"];return isFunction$1(c)?c(s):c.replace(/%s/i,s)}var aliases={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function normalizeUnits(a){return typeof a=="string"?aliases[a]||aliases[a.toLowerCase()]:void 0}function normalizeObjectUnits(a){var s={},c,u;for(u in a)hasOwnProp(a,u)&&(c=normalizeUnits(u),c&&(s[c]=a[u]));return s}var priorities={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function getPrioritizedUnits(a){var s=[],c;for(c in a)hasOwnProp(a,c)&&s.push({unit:c,priority:priorities[c]});return s.sort(function(u,d){return u.priority-d.priority}),s}var match1=/\d/,match2=/\d\d/,match3=/\d{3}/,match4=/\d{4}/,match6=/[+-]?\d{6}/,match1to2=/\d\d?/,match3to4=/\d\d\d\d?/,match5to6=/\d\d\d\d\d\d?/,match1to3=/\d{1,3}/,match1to4=/\d{1,4}/,match1to6=/[+-]?\d{1,6}/,matchUnsigned=/\d+/,matchSigned=/[+-]?\d+/,matchOffset=/Z|[+-]\d\d:?\d\d/gi,matchShortOffset=/Z|[+-]\d\d(?::?\d\d)?/gi,matchTimestamp=/[+-]?\d+(\.\d{1,3})?/,matchWord=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,match1to2NoLeadingZero=/^[1-9]\d?/,match1to2HasZero=/^([1-9]\d|\d)/,regexes;regexes={};function addRegexToken(a,s,c){regexes[a]=isFunction$1(s)?s:function(u,d){return u&&c?c:s}}function getParseRegexForToken(a,s){return hasOwnProp(regexes,a)?regexes[a](s._strict,s._locale):new RegExp(unescapeFormat(a))}function unescapeFormat(a){return regexEscape(a.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(s,c,u,d,h){return c||u||d||h}))}function regexEscape(a){return a.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function absFloor(a){return a<0?Math.ceil(a)||0:Math.floor(a)}function toInt(a){var s=+a,c=0;return s!==0&&isFinite(s)&&(c=absFloor(s)),c}var tokens={};function addParseToken(a,s){var c,u=s,d;for(typeof a=="string"&&(a=[a]),isNumber(s)&&(u=function(h,f){f[s]=toInt(h)}),d=a.length,c=0;c<d;c++)tokens[a[c]]=u}function addWeekParseToken(a,s){addParseToken(a,function(c,u,d,h){d._w=d._w||{},s(c,d._w,d,h)})}function addTimeToArrayFromToken(a,s,c){s!=null&&hasOwnProp(tokens,a)&&tokens[a](s,c._a,c,a)}function isLeapYear$1(a){return a%4===0&&a%100!==0||a%400===0}var YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,WEEK=7,WEEKDAY=8;addFormatToken("Y",0,0,function(){var a=this.year();return a<=9999?zeroFill(a,4):"+"+a}),addFormatToken(0,["YY",2],0,function(){return this.year()%100}),addFormatToken(0,["YYYY",4],0,"year"),addFormatToken(0,["YYYYY",5],0,"year"),addFormatToken(0,["YYYYYY",6,!0],0,"year"),addRegexToken("Y",matchSigned),addRegexToken("YY",match1to2,match2),addRegexToken("YYYY",match1to4,match4),addRegexToken("YYYYY",match1to6,match6),addRegexToken("YYYYYY",match1to6,match6),addParseToken(["YYYYY","YYYYYY"],YEAR),addParseToken("YYYY",function(a,s){s[YEAR]=a.length===2?hooks.parseTwoDigitYear(a):toInt(a)}),addParseToken("YY",function(a,s){s[YEAR]=hooks.parseTwoDigitYear(a)}),addParseToken("Y",function(a,s){s[YEAR]=parseInt(a,10)});function daysInYear(a){return isLeapYear$1(a)?366:365}hooks.parseTwoDigitYear=function(a){return toInt(a)+(toInt(a)>68?1900:2e3)};var getSetYear=makeGetSet("FullYear",!0);function getIsLeapYear(){return isLeapYear$1(this.year())}function makeGetSet(a,s){return function(c){return c!=null?(set$1$1(this,a,c),hooks.updateOffset(this,s),this):get(this,a)}}function get(a,s){if(!a.isValid())return NaN;var c=a._d,u=a._isUTC;switch(s){case"Milliseconds":return u?c.getUTCMilliseconds():c.getMilliseconds();case"Seconds":return u?c.getUTCSeconds():c.getSeconds();case"Minutes":return u?c.getUTCMinutes():c.getMinutes();case"Hours":return u?c.getUTCHours():c.getHours();case"Date":return u?c.getUTCDate():c.getDate();case"Day":return u?c.getUTCDay():c.getDay();case"Month":return u?c.getUTCMonth():c.getMonth();case"FullYear":return u?c.getUTCFullYear():c.getFullYear();default:return NaN}}function set$1$1(a,s,c){var u,d,h,f,g;if(!(!a.isValid()||isNaN(c))){switch(u=a._d,d=a._isUTC,s){case"Milliseconds":return void(d?u.setUTCMilliseconds(c):u.setMilliseconds(c));case"Seconds":return void(d?u.setUTCSeconds(c):u.setSeconds(c));case"Minutes":return void(d?u.setUTCMinutes(c):u.setMinutes(c));case"Hours":return void(d?u.setUTCHours(c):u.setHours(c));case"Date":return void(d?u.setUTCDate(c):u.setDate(c));case"FullYear":break;default:return}h=c,f=a.month(),g=a.date(),g=g===29&&f===1&&!isLeapYear$1(h)?28:g,d?u.setUTCFullYear(h,f,g):u.setFullYear(h,f,g)}}function stringGet(a){return a=normalizeUnits(a),isFunction$1(this[a])?this[a]():this}function stringSet(a,s){if(typeof a=="object"){a=normalizeObjectUnits(a);var c=getPrioritizedUnits(a),u,d=c.length;for(u=0;u<d;u++)this[c[u].unit](a[c[u].unit])}else if(a=normalizeUnits(a),isFunction$1(this[a]))return this[a](s);return this}function mod(a,s){return(a%s+s)%s}var indexOf;Array.prototype.indexOf?indexOf=Array.prototype.indexOf:indexOf=function(a){var s;for(s=0;s<this.length;++s)if(this[s]===a)return s;return-1};function daysInMonth(a,s){if(isNaN(a)||isNaN(s))return NaN;var c=mod(s,12);return a+=(s-c)/12,c===1?isLeapYear$1(a)?29:28:31-c%7%2}addFormatToken("M",["MM",2],"Mo",function(){return this.month()+1}),addFormatToken("MMM",0,0,function(a){return this.localeData().monthsShort(this,a)}),addFormatToken("MMMM",0,0,function(a){return this.localeData().months(this,a)}),addRegexToken("M",match1to2,match1to2NoLeadingZero),addRegexToken("MM",match1to2,match2),addRegexToken("MMM",function(a,s){return s.monthsShortRegex(a)}),addRegexToken("MMMM",function(a,s){return s.monthsRegex(a)}),addParseToken(["M","MM"],function(a,s){s[MONTH]=toInt(a)-1}),addParseToken(["MMM","MMMM"],function(a,s,c,u){var d=c._locale.monthsParse(a,u,c._strict);d!=null?s[MONTH]=d:getParsingFlags(c).invalidMonth=a});var defaultLocaleMonths="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),defaultLocaleMonthsShort="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),MONTHS_IN_FORMAT=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,defaultMonthsShortRegex=matchWord,defaultMonthsRegex=matchWord;function localeMonths(a,s){return a?isArray$1(this._months)?this._months[a.month()]:this._months[(this._months.isFormat||MONTHS_IN_FORMAT).test(s)?"format":"standalone"][a.month()]:isArray$1(this._months)?this._months:this._months.standalone}function localeMonthsShort(a,s){return a?isArray$1(this._monthsShort)?this._monthsShort[a.month()]:this._monthsShort[MONTHS_IN_FORMAT.test(s)?"format":"standalone"][a.month()]:isArray$1(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function handleStrictParse(a,s,c){var u,d,h,f=a.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],u=0;u<12;++u)h=createUTC([2e3,u]),this._shortMonthsParse[u]=this.monthsShort(h,"").toLocaleLowerCase(),this._longMonthsParse[u]=this.months(h,"").toLocaleLowerCase();return c?s==="MMM"?(d=indexOf.call(this._shortMonthsParse,f),d!==-1?d:null):(d=indexOf.call(this._longMonthsParse,f),d!==-1?d:null):s==="MMM"?(d=indexOf.call(this._shortMonthsParse,f),d!==-1?d:(d=indexOf.call(this._longMonthsParse,f),d!==-1?d:null)):(d=indexOf.call(this._longMonthsParse,f),d!==-1?d:(d=indexOf.call(this._shortMonthsParse,f),d!==-1?d:null))}function localeMonthsParse(a,s,c){var u,d,h;if(this._monthsParseExact)return handleStrictParse.call(this,a,s,c);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),u=0;u<12;u++){if(d=createUTC([2e3,u]),c&&!this._longMonthsParse[u]&&(this._longMonthsParse[u]=new RegExp("^"+this.months(d,"").replace(".","")+"$","i"),this._shortMonthsParse[u]=new RegExp("^"+this.monthsShort(d,"").replace(".","")+"$","i")),!c&&!this._monthsParse[u]&&(h="^"+this.months(d,"")+"|^"+this.monthsShort(d,""),this._monthsParse[u]=new RegExp(h.replace(".",""),"i")),c&&s==="MMMM"&&this._longMonthsParse[u].test(a))return u;if(c&&s==="MMM"&&this._shortMonthsParse[u].test(a))return u;if(!c&&this._monthsParse[u].test(a))return u}}function setMonth(a,s){if(!a.isValid())return a;if(typeof s=="string"){if(/^\d+$/.test(s))s=toInt(s);else if(s=a.localeData().monthsParse(s),!isNumber(s))return a}var c=s,u=a.date();return u=u<29?u:Math.min(u,daysInMonth(a.year(),c)),a._isUTC?a._d.setUTCMonth(c,u):a._d.setMonth(c,u),a}function getSetMonth(a){return a!=null?(setMonth(this,a),hooks.updateOffset(this,!0),this):get(this,"Month")}function getDaysInMonth$1(){return daysInMonth(this.year(),this.month())}function monthsShortRegex(a){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),a?this._monthsShortStrictRegex:this._monthsShortRegex):(hasOwnProp(this,"_monthsShortRegex")||(this._monthsShortRegex=defaultMonthsShortRegex),this._monthsShortStrictRegex&&a?this._monthsShortStrictRegex:this._monthsShortRegex)}function monthsRegex(a){return this._monthsParseExact?(hasOwnProp(this,"_monthsRegex")||computeMonthsParse.call(this),a?this._monthsStrictRegex:this._monthsRegex):(hasOwnProp(this,"_monthsRegex")||(this._monthsRegex=defaultMonthsRegex),this._monthsStrictRegex&&a?this._monthsStrictRegex:this._monthsRegex)}function computeMonthsParse(){function a(m,p){return p.length-m.length}var s=[],c=[],u=[],d,h,f,g;for(d=0;d<12;d++)h=createUTC([2e3,d]),f=regexEscape(this.monthsShort(h,"")),g=regexEscape(this.months(h,"")),s.push(f),c.push(g),u.push(g),u.push(f);s.sort(a),c.sort(a),u.sort(a),this._monthsRegex=new RegExp("^("+u.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function createDate(a,s,c,u,d,h,f){var g;return a<100&&a>=0?(g=new Date(a+400,s,c,u,d,h,f),isFinite(g.getFullYear())&&g.setFullYear(a)):g=new Date(a,s,c,u,d,h,f),g}function createUTCDate(a){var s,c;return a<100&&a>=0?(c=Array.prototype.slice.call(arguments),c[0]=a+400,s=new Date(Date.UTC.apply(null,c)),isFinite(s.getUTCFullYear())&&s.setUTCFullYear(a)):s=new Date(Date.UTC.apply(null,arguments)),s}function firstWeekOffset(a,s,c){var u=7+s-c,d=(7+createUTCDate(a,0,u).getUTCDay()-s)%7;return-d+u-1}function dayOfYearFromWeeks(a,s,c,u,d){var h=(7+c-u)%7,f=firstWeekOffset(a,u,d),g=1+7*(s-1)+h+f,m,p;return g<=0?(m=a-1,p=daysInYear(m)+g):g>daysInYear(a)?(m=a+1,p=g-daysInYear(a)):(m=a,p=g),{year:m,dayOfYear:p}}function weekOfYear(a,s,c){var u=firstWeekOffset(a.year(),s,c),d=Math.floor((a.dayOfYear()-u-1)/7)+1,h,f;return d<1?(f=a.year()-1,h=d+weeksInYear(f,s,c)):d>weeksInYear(a.year(),s,c)?(h=d-weeksInYear(a.year(),s,c),f=a.year()+1):(f=a.year(),h=d),{week:h,year:f}}function weeksInYear(a,s,c){var u=firstWeekOffset(a,s,c),d=firstWeekOffset(a+1,s,c);return(daysInYear(a)-u+d)/7}addFormatToken("w",["ww",2],"wo","week"),addFormatToken("W",["WW",2],"Wo","isoWeek"),addRegexToken("w",match1to2,match1to2NoLeadingZero),addRegexToken("ww",match1to2,match2),addRegexToken("W",match1to2,match1to2NoLeadingZero),addRegexToken("WW",match1to2,match2),addWeekParseToken(["w","ww","W","WW"],function(a,s,c,u){s[u.substr(0,1)]=toInt(a)});function localeWeek(a){return weekOfYear(a,this._week.dow,this._week.doy).week}var defaultLocaleWeek={dow:0,doy:6};function localeFirstDayOfWeek(){return this._week.dow}function localeFirstDayOfYear(){return this._week.doy}function getSetWeek(a){var s=this.localeData().week(this);return a==null?s:this.add((a-s)*7,"d")}function getSetISOWeek(a){var s=weekOfYear(this,1,4).week;return a==null?s:this.add((a-s)*7,"d")}addFormatToken("d",0,"do","day"),addFormatToken("dd",0,0,function(a){return this.localeData().weekdaysMin(this,a)}),addFormatToken("ddd",0,0,function(a){return this.localeData().weekdaysShort(this,a)}),addFormatToken("dddd",0,0,function(a){return this.localeData().weekdays(this,a)}),addFormatToken("e",0,0,"weekday"),addFormatToken("E",0,0,"isoWeekday"),addRegexToken("d",match1to2),addRegexToken("e",match1to2),addRegexToken("E",match1to2),addRegexToken("dd",function(a,s){return s.weekdaysMinRegex(a)}),addRegexToken("ddd",function(a,s){return s.weekdaysShortRegex(a)}),addRegexToken("dddd",function(a,s){return s.weekdaysRegex(a)}),addWeekParseToken(["dd","ddd","dddd"],function(a,s,c,u){var d=c._locale.weekdaysParse(a,u,c._strict);d!=null?s.d=d:getParsingFlags(c).invalidWeekday=a}),addWeekParseToken(["d","e","E"],function(a,s,c,u){s[u]=toInt(a)});function parseWeekday(a,s){return typeof a!="string"?a:isNaN(a)?(a=s.weekdaysParse(a),typeof a=="number"?a:null):parseInt(a,10)}function parseIsoWeekday(a,s){return typeof a=="string"?s.weekdaysParse(a)%7||7:isNaN(a)?null:a}function shiftWeekdays(a,s){return a.slice(s,7).concat(a.slice(0,s))}var defaultLocaleWeekdays="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),defaultLocaleWeekdaysShort="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),defaultLocaleWeekdaysMin="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),defaultWeekdaysRegex=matchWord,defaultWeekdaysShortRegex=matchWord,defaultWeekdaysMinRegex=matchWord;function localeWeekdays(a,s){var c=isArray$1(this._weekdays)?this._weekdays:this._weekdays[a&&a!==!0&&this._weekdays.isFormat.test(s)?"format":"standalone"];return a===!0?shiftWeekdays(c,this._week.dow):a?c[a.day()]:c}function localeWeekdaysShort(a){return a===!0?shiftWeekdays(this._weekdaysShort,this._week.dow):a?this._weekdaysShort[a.day()]:this._weekdaysShort}function localeWeekdaysMin(a){return a===!0?shiftWeekdays(this._weekdaysMin,this._week.dow):a?this._weekdaysMin[a.day()]:this._weekdaysMin}function handleStrictParse$1(a,s,c){var u,d,h,f=a.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],u=0;u<7;++u)h=createUTC([2e3,1]).day(u),this._minWeekdaysParse[u]=this.weekdaysMin(h,"").toLocaleLowerCase(),this._shortWeekdaysParse[u]=this.weekdaysShort(h,"").toLocaleLowerCase(),this._weekdaysParse[u]=this.weekdays(h,"").toLocaleLowerCase();return c?s==="dddd"?(d=indexOf.call(this._weekdaysParse,f),d!==-1?d:null):s==="ddd"?(d=indexOf.call(this._shortWeekdaysParse,f),d!==-1?d:null):(d=indexOf.call(this._minWeekdaysParse,f),d!==-1?d:null):s==="dddd"?(d=indexOf.call(this._weekdaysParse,f),d!==-1||(d=indexOf.call(this._shortWeekdaysParse,f),d!==-1)?d:(d=indexOf.call(this._minWeekdaysParse,f),d!==-1?d:null)):s==="ddd"?(d=indexOf.call(this._shortWeekdaysParse,f),d!==-1||(d=indexOf.call(this._weekdaysParse,f),d!==-1)?d:(d=indexOf.call(this._minWeekdaysParse,f),d!==-1?d:null)):(d=indexOf.call(this._minWeekdaysParse,f),d!==-1||(d=indexOf.call(this._weekdaysParse,f),d!==-1)?d:(d=indexOf.call(this._shortWeekdaysParse,f),d!==-1?d:null))}function localeWeekdaysParse(a,s,c){var u,d,h;if(this._weekdaysParseExact)return handleStrictParse$1.call(this,a,s,c);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),u=0;u<7;u++){if(d=createUTC([2e3,1]).day(u),c&&!this._fullWeekdaysParse[u]&&(this._fullWeekdaysParse[u]=new RegExp("^"+this.weekdays(d,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[u]=new RegExp("^"+this.weekdaysShort(d,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[u]=new RegExp("^"+this.weekdaysMin(d,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[u]||(h="^"+this.weekdays(d,"")+"|^"+this.weekdaysShort(d,"")+"|^"+this.weekdaysMin(d,""),this._weekdaysParse[u]=new RegExp(h.replace(".",""),"i")),c&&s==="dddd"&&this._fullWeekdaysParse[u].test(a))return u;if(c&&s==="ddd"&&this._shortWeekdaysParse[u].test(a))return u;if(c&&s==="dd"&&this._minWeekdaysParse[u].test(a))return u;if(!c&&this._weekdaysParse[u].test(a))return u}}function getSetDayOfWeek(a){if(!this.isValid())return a!=null?this:NaN;var s=get(this,"Day");return a!=null?(a=parseWeekday(a,this.localeData()),this.add(a-s,"d")):s}function getSetLocaleDayOfWeek(a){if(!this.isValid())return a!=null?this:NaN;var s=(this.day()+7-this.localeData()._week.dow)%7;return a==null?s:this.add(a-s,"d")}function getSetISODayOfWeek(a){if(!this.isValid())return a!=null?this:NaN;if(a!=null){var s=parseIsoWeekday(a,this.localeData());return this.day(this.day()%7?s:s-7)}else return this.day()||7}function weekdaysRegex(a){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),a?this._weekdaysStrictRegex:this._weekdaysRegex):(hasOwnProp(this,"_weekdaysRegex")||(this._weekdaysRegex=defaultWeekdaysRegex),this._weekdaysStrictRegex&&a?this._weekdaysStrictRegex:this._weekdaysRegex)}function weekdaysShortRegex(a){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(hasOwnProp(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=defaultWeekdaysShortRegex),this._weekdaysShortStrictRegex&&a?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function weekdaysMinRegex(a){return this._weekdaysParseExact?(hasOwnProp(this,"_weekdaysRegex")||computeWeekdaysParse.call(this),a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(hasOwnProp(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=defaultWeekdaysMinRegex),this._weekdaysMinStrictRegex&&a?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function computeWeekdaysParse(){function a(v,w){return w.length-v.length}var s=[],c=[],u=[],d=[],h,f,g,m,p;for(h=0;h<7;h++)f=createUTC([2e3,1]).day(h),g=regexEscape(this.weekdaysMin(f,"")),m=regexEscape(this.weekdaysShort(f,"")),p=regexEscape(this.weekdays(f,"")),s.push(g),c.push(m),u.push(p),d.push(g),d.push(m),d.push(p);s.sort(a),c.sort(a),u.sort(a),d.sort(a),this._weekdaysRegex=new RegExp("^("+d.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+s.join("|")+")","i")}function hFormat(){return this.hours()%12||12}function kFormat(){return this.hours()||24}addFormatToken("H",["HH",2],0,"hour"),addFormatToken("h",["hh",2],0,hFormat),addFormatToken("k",["kk",2],0,kFormat),addFormatToken("hmm",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)}),addFormatToken("hmmss",0,0,function(){return""+hFormat.apply(this)+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)}),addFormatToken("Hmm",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)}),addFormatToken("Hmmss",0,0,function(){return""+this.hours()+zeroFill(this.minutes(),2)+zeroFill(this.seconds(),2)});function meridiem(a,s){addFormatToken(a,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),s)})}meridiem("a",!0),meridiem("A",!1);function matchMeridiem(a,s){return s._meridiemParse}addRegexToken("a",matchMeridiem),addRegexToken("A",matchMeridiem),addRegexToken("H",match1to2,match1to2HasZero),addRegexToken("h",match1to2,match1to2NoLeadingZero),addRegexToken("k",match1to2,match1to2NoLeadingZero),addRegexToken("HH",match1to2,match2),addRegexToken("hh",match1to2,match2),addRegexToken("kk",match1to2,match2),addRegexToken("hmm",match3to4),addRegexToken("hmmss",match5to6),addRegexToken("Hmm",match3to4),addRegexToken("Hmmss",match5to6),addParseToken(["H","HH"],HOUR),addParseToken(["k","kk"],function(a,s,c){var u=toInt(a);s[HOUR]=u===24?0:u}),addParseToken(["a","A"],function(a,s,c){c._isPm=c._locale.isPM(a),c._meridiem=a}),addParseToken(["h","hh"],function(a,s,c){s[HOUR]=toInt(a),getParsingFlags(c).bigHour=!0}),addParseToken("hmm",function(a,s,c){var u=a.length-2;s[HOUR]=toInt(a.substr(0,u)),s[MINUTE]=toInt(a.substr(u)),getParsingFlags(c).bigHour=!0}),addParseToken("hmmss",function(a,s,c){var u=a.length-4,d=a.length-2;s[HOUR]=toInt(a.substr(0,u)),s[MINUTE]=toInt(a.substr(u,2)),s[SECOND]=toInt(a.substr(d)),getParsingFlags(c).bigHour=!0}),addParseToken("Hmm",function(a,s,c){var u=a.length-2;s[HOUR]=toInt(a.substr(0,u)),s[MINUTE]=toInt(a.substr(u))}),addParseToken("Hmmss",function(a,s,c){var u=a.length-4,d=a.length-2;s[HOUR]=toInt(a.substr(0,u)),s[MINUTE]=toInt(a.substr(u,2)),s[SECOND]=toInt(a.substr(d))});function localeIsPM(a){return(a+"").toLowerCase().charAt(0)==="p"}var defaultLocaleMeridiemParse=/[ap]\.?m?\.?/i,getSetHour=makeGetSet("Hours",!0);function localeMeridiem(a,s,c){return a>11?c?"pm":"PM":c?"am":"AM"}var baseConfig={calendar:defaultCalendar,longDateFormat:defaultLongDateFormat,invalidDate:defaultInvalidDate,ordinal:defaultOrdinal,dayOfMonthOrdinalParse:defaultDayOfMonthOrdinalParse,relativeTime:defaultRelativeTime,months:defaultLocaleMonths,monthsShort:defaultLocaleMonthsShort,week:defaultLocaleWeek,weekdays:defaultLocaleWeekdays,weekdaysMin:defaultLocaleWeekdaysMin,weekdaysShort:defaultLocaleWeekdaysShort,meridiemParse:defaultLocaleMeridiemParse},locales={},localeFamilies={},globalLocale;function commonPrefix(a,s){var c,u=Math.min(a.length,s.length);for(c=0;c<u;c+=1)if(a[c]!==s[c])return c;return u}function normalizeLocale(a){return a&&a.toLowerCase().replace("_","-")}function chooseLocale(a){for(var s=0,c,u,d,h;s<a.length;){for(h=normalizeLocale(a[s]).split("-"),c=h.length,u=normalizeLocale(a[s+1]),u=u?u.split("-"):null;c>0;){if(d=loadLocale(h.slice(0,c).join("-")),d)return d;if(u&&u.length>=c&&commonPrefix(h,u)>=c-1)break;c--}s++}return globalLocale}function isLocaleNameSane(a){return!!(a&&a.match("^[^/\\\\]*$"))}function loadLocale(a){var s=null,c;if(locales[a]===void 0&&typeof module<"u"&&module&&module.exports&&isLocaleNameSane(a))try{s=globalLocale._abbr,c=require,c("./locale/"+a),getSetGlobalLocale(s)}catch{locales[a]=null}return locales[a]}function getSetGlobalLocale(a,s){var c;return a&&(isUndefined$1(s)?c=getLocale(a):c=defineLocale(a,s),c?globalLocale=c:typeof console<"u"&&console.warn&&console.warn("Locale "+a+" not found. Did you forget to load it?")),globalLocale._abbr}function defineLocale(a,s){if(s!==null){var c,u=baseConfig;if(s.abbr=a,locales[a]!=null)deprecateSimple("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),u=locales[a]._config;else if(s.parentLocale!=null)if(locales[s.parentLocale]!=null)u=locales[s.parentLocale]._config;else if(c=loadLocale(s.parentLocale),c!=null)u=c._config;else return localeFamilies[s.parentLocale]||(localeFamilies[s.parentLocale]=[]),localeFamilies[s.parentLocale].push({name:a,config:s}),null;return locales[a]=new Locale(mergeConfigs(u,s)),localeFamilies[a]&&localeFamilies[a].forEach(function(d){defineLocale(d.name,d.config)}),getSetGlobalLocale(a),locales[a]}else return delete locales[a],null}function updateLocale(a,s){if(s!=null){var c,u,d=baseConfig;locales[a]!=null&&locales[a].parentLocale!=null?locales[a].set(mergeConfigs(locales[a]._config,s)):(u=loadLocale(a),u!=null&&(d=u._config),s=mergeConfigs(d,s),u==null&&(s.abbr=a),c=new Locale(s),c.parentLocale=locales[a],locales[a]=c),getSetGlobalLocale(a)}else locales[a]!=null&&(locales[a].parentLocale!=null?(locales[a]=locales[a].parentLocale,a===getSetGlobalLocale()&&getSetGlobalLocale(a)):locales[a]!=null&&delete locales[a]);return locales[a]}function getLocale(a){var s;if(a&&a._locale&&a._locale._abbr&&(a=a._locale._abbr),!a)return globalLocale;if(!isArray$1(a)){if(s=loadLocale(a),s)return s;a=[a]}return chooseLocale(a)}function listLocales(){return keys(locales)}function checkOverflow(a){var s,c=a._a;return c&&getParsingFlags(a).overflow===-2&&(s=c[MONTH]<0||c[MONTH]>11?MONTH:c[DATE]<1||c[DATE]>daysInMonth(c[YEAR],c[MONTH])?DATE:c[HOUR]<0||c[HOUR]>24||c[HOUR]===24&&(c[MINUTE]!==0||c[SECOND]!==0||c[MILLISECOND]!==0)?HOUR:c[MINUTE]<0||c[MINUTE]>59?MINUTE:c[SECOND]<0||c[SECOND]>59?SECOND:c[MILLISECOND]<0||c[MILLISECOND]>999?MILLISECOND:-1,getParsingFlags(a)._overflowDayOfYear&&(s<YEAR||s>DATE)&&(s=DATE),getParsingFlags(a)._overflowWeeks&&s===-1&&(s=WEEK),getParsingFlags(a)._overflowWeekday&&s===-1&&(s=WEEKDAY),getParsingFlags(a).overflow=s),a}var extendedIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,basicIsoRegex=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,tzRegex=/Z|[+-]\d\d(?::?\d\d)?/,isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],isoTimes=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],aspNetJsonRegex=/^\/?Date\((-?\d+)/i,rfc2822=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,obsOffsets={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function configFromISO(a){var s,c,u=a._i,d=extendedIsoRegex.exec(u)||basicIsoRegex.exec(u),h,f,g,m,p=isoDates.length,v=isoTimes.length;if(d){for(getParsingFlags(a).iso=!0,s=0,c=p;s<c;s++)if(isoDates[s][1].exec(d[1])){f=isoDates[s][0],h=isoDates[s][2]!==!1;break}if(f==null){a._isValid=!1;return}if(d[3]){for(s=0,c=v;s<c;s++)if(isoTimes[s][1].exec(d[3])){g=(d[2]||" ")+isoTimes[s][0];break}if(g==null){a._isValid=!1;return}}if(!h&&g!=null){a._isValid=!1;return}if(d[4])if(tzRegex.exec(d[4]))m="Z";else{a._isValid=!1;return}a._f=f+(g||"")+(m||""),configFromStringAndFormat(a)}else a._isValid=!1}function extractFromRFC2822Strings(a,s,c,u,d,h){var f=[untruncateYear(a),defaultLocaleMonthsShort.indexOf(s),parseInt(c,10),parseInt(u,10),parseInt(d,10)];return h&&f.push(parseInt(h,10)),f}function untruncateYear(a){var s=parseInt(a,10);return s<=49?2e3+s:s<=999?1900+s:s}function preprocessRFC2822(a){return a.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function checkWeekday(a,s,c){if(a){var u=defaultLocaleWeekdaysShort.indexOf(a),d=new Date(s[0],s[1],s[2]).getDay();if(u!==d)return getParsingFlags(c).weekdayMismatch=!0,c._isValid=!1,!1}return!0}function calculateOffset(a,s,c){if(a)return obsOffsets[a];if(s)return 0;var u=parseInt(c,10),d=u%100,h=(u-d)/100;return h*60+d}function configFromRFC2822(a){var s=rfc2822.exec(preprocessRFC2822(a._i)),c;if(s){if(c=extractFromRFC2822Strings(s[4],s[3],s[2],s[5],s[6],s[7]),!checkWeekday(s[1],c,a))return;a._a=c,a._tzm=calculateOffset(s[8],s[9],s[10]),a._d=createUTCDate.apply(null,a._a),a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),getParsingFlags(a).rfc2822=!0}else a._isValid=!1}function configFromString(a){var s=aspNetJsonRegex.exec(a._i);if(s!==null){a._d=new Date(+s[1]);return}if(configFromISO(a),a._isValid===!1)delete a._isValid;else return;if(configFromRFC2822(a),a._isValid===!1)delete a._isValid;else return;a._strict?a._isValid=!1:hooks.createFromInputFallback(a)}hooks.createFromInputFallback=deprecate("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(a){a._d=new Date(a._i+(a._useUTC?" UTC":""))});function defaults$1(a,s,c){return a??s??c}function currentDateArray(a){var s=new Date(hooks.now());return a._useUTC?[s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()]:[s.getFullYear(),s.getMonth(),s.getDate()]}function configFromArray(a){var s,c,u=[],d,h,f;if(!a._d){for(d=currentDateArray(a),a._w&&a._a[DATE]==null&&a._a[MONTH]==null&&dayOfYearFromWeekInfo(a),a._dayOfYear!=null&&(f=defaults$1(a._a[YEAR],d[YEAR]),(a._dayOfYear>daysInYear(f)||a._dayOfYear===0)&&(getParsingFlags(a)._overflowDayOfYear=!0),c=createUTCDate(f,0,a._dayOfYear),a._a[MONTH]=c.getUTCMonth(),a._a[DATE]=c.getUTCDate()),s=0;s<3&&a._a[s]==null;++s)a._a[s]=u[s]=d[s];for(;s<7;s++)a._a[s]=u[s]=a._a[s]==null?s===2?1:0:a._a[s];a._a[HOUR]===24&&a._a[MINUTE]===0&&a._a[SECOND]===0&&a._a[MILLISECOND]===0&&(a._nextDay=!0,a._a[HOUR]=0),a._d=(a._useUTC?createUTCDate:createDate).apply(null,u),h=a._useUTC?a._d.getUTCDay():a._d.getDay(),a._tzm!=null&&a._d.setUTCMinutes(a._d.getUTCMinutes()-a._tzm),a._nextDay&&(a._a[HOUR]=24),a._w&&typeof a._w.d<"u"&&a._w.d!==h&&(getParsingFlags(a).weekdayMismatch=!0)}}function dayOfYearFromWeekInfo(a){var s,c,u,d,h,f,g,m,p;s=a._w,s.GG!=null||s.W!=null||s.E!=null?(h=1,f=4,c=defaults$1(s.GG,a._a[YEAR],weekOfYear(createLocal(),1,4).year),u=defaults$1(s.W,1),d=defaults$1(s.E,1),(d<1||d>7)&&(m=!0)):(h=a._locale._week.dow,f=a._locale._week.doy,p=weekOfYear(createLocal(),h,f),c=defaults$1(s.gg,a._a[YEAR],p.year),u=defaults$1(s.w,p.week),s.d!=null?(d=s.d,(d<0||d>6)&&(m=!0)):s.e!=null?(d=s.e+h,(s.e<0||s.e>6)&&(m=!0)):d=h),u<1||u>weeksInYear(c,h,f)?getParsingFlags(a)._overflowWeeks=!0:m!=null?getParsingFlags(a)._overflowWeekday=!0:(g=dayOfYearFromWeeks(c,u,d,h,f),a._a[YEAR]=g.year,a._dayOfYear=g.dayOfYear)}hooks.ISO_8601=function(){},hooks.RFC_2822=function(){};function configFromStringAndFormat(a){if(a._f===hooks.ISO_8601){configFromISO(a);return}if(a._f===hooks.RFC_2822){configFromRFC2822(a);return}a._a=[],getParsingFlags(a).empty=!0;var s=""+a._i,c,u,d,h,f,g=s.length,m=0,p,v;for(d=expandFormat(a._f,a._locale).match(formattingTokens)||[],v=d.length,c=0;c<v;c++)h=d[c],u=(s.match(getParseRegexForToken(h,a))||[])[0],u&&(f=s.substr(0,s.indexOf(u)),f.length>0&&getParsingFlags(a).unusedInput.push(f),s=s.slice(s.indexOf(u)+u.length),m+=u.length),formatTokenFunctions[h]?(u?getParsingFlags(a).empty=!1:getParsingFlags(a).unusedTokens.push(h),addTimeToArrayFromToken(h,u,a)):a._strict&&!u&&getParsingFlags(a).unusedTokens.push(h);getParsingFlags(a).charsLeftOver=g-m,s.length>0&&getParsingFlags(a).unusedInput.push(s),a._a[HOUR]<=12&&getParsingFlags(a).bigHour===!0&&a._a[HOUR]>0&&(getParsingFlags(a).bigHour=void 0),getParsingFlags(a).parsedDateParts=a._a.slice(0),getParsingFlags(a).meridiem=a._meridiem,a._a[HOUR]=meridiemFixWrap(a._locale,a._a[HOUR],a._meridiem),p=getParsingFlags(a).era,p!==null&&(a._a[YEAR]=a._locale.erasConvertYear(p,a._a[YEAR])),configFromArray(a),checkOverflow(a)}function meridiemFixWrap(a,s,c){var u;return c==null?s:a.meridiemHour!=null?a.meridiemHour(s,c):(a.isPM!=null&&(u=a.isPM(c),u&&s<12&&(s+=12),!u&&s===12&&(s=0)),s)}function configFromStringAndArray(a){var s,c,u,d,h,f,g=!1,m=a._f.length;if(m===0){getParsingFlags(a).invalidFormat=!0,a._d=new Date(NaN);return}for(d=0;d<m;d++)h=0,f=!1,s=copyConfig({},a),a._useUTC!=null&&(s._useUTC=a._useUTC),s._f=a._f[d],configFromStringAndFormat(s),isValid$1(s)&&(f=!0),h+=getParsingFlags(s).charsLeftOver,h+=getParsingFlags(s).unusedTokens.length*10,getParsingFlags(s).score=h,g?h<u&&(u=h,c=s):(u==null||h<u||f)&&(u=h,c=s,f&&(g=!0));extend$2(a,c||s)}function configFromObject(a){if(!a._d){var s=normalizeObjectUnits(a._i),c=s.day===void 0?s.date:s.day;a._a=map([s.year,s.month,c,s.hour,s.minute,s.second,s.millisecond],function(u){return u&&parseInt(u,10)}),configFromArray(a)}}function createFromConfig(a){var s=new Moment(checkOverflow(prepareConfig(a)));return s._nextDay&&(s.add(1,"d"),s._nextDay=void 0),s}function prepareConfig(a){var s=a._i,c=a._f;return a._locale=a._locale||getLocale(a._l),s===null||c===void 0&&s===""?createInvalid({nullInput:!0}):(typeof s=="string"&&(a._i=s=a._locale.preparse(s)),isMoment(s)?new Moment(checkOverflow(s)):(isDate$2(s)?a._d=s:isArray$1(c)?configFromStringAndArray(a):c?configFromStringAndFormat(a):configFromInput(a),isValid$1(a)||(a._d=null),a))}function configFromInput(a){var s=a._i;isUndefined$1(s)?a._d=new Date(hooks.now()):isDate$2(s)?a._d=new Date(s.valueOf()):typeof s=="string"?configFromString(a):isArray$1(s)?(a._a=map(s.slice(0),function(c){return parseInt(c,10)}),configFromArray(a)):isObject$1(s)?configFromObject(a):isNumber(s)?a._d=new Date(s):hooks.createFromInputFallback(a)}function createLocalOrUTC(a,s,c,u,d){var h={};return(s===!0||s===!1)&&(u=s,s=void 0),(c===!0||c===!1)&&(u=c,c=void 0),(isObject$1(a)&&isObjectEmpty(a)||isArray$1(a)&&a.length===0)&&(a=void 0),h._isAMomentObject=!0,h._useUTC=h._isUTC=d,h._l=c,h._i=a,h._f=s,h._strict=u,createFromConfig(h)}function createLocal(a,s,c,u){return createLocalOrUTC(a,s,c,u,!1)}var prototypeMin=deprecate("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=createLocal.apply(null,arguments);return this.isValid()&&a.isValid()?a<this?this:a:createInvalid()}),prototypeMax=deprecate("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var a=createLocal.apply(null,arguments);return this.isValid()&&a.isValid()?a>this?this:a:createInvalid()});function pickBy(a,s){var c,u;if(s.length===1&&isArray$1(s[0])&&(s=s[0]),!s.length)return createLocal();for(c=s[0],u=1;u<s.length;++u)(!s[u].isValid()||s[u][a](c))&&(c=s[u]);return c}function min(){var a=[].slice.call(arguments,0);return pickBy("isBefore",a)}function max(){var a=[].slice.call(arguments,0);return pickBy("isAfter",a)}var now=function(){return Date.now?Date.now():+new Date},ordering=["year","quarter","month","week","day","hour","minute","second","millisecond"];function isDurationValid(a){var s,c=!1,u,d=ordering.length;for(s in a)if(hasOwnProp(a,s)&&!(indexOf.call(ordering,s)!==-1&&(a[s]==null||!isNaN(a[s]))))return!1;for(u=0;u<d;++u)if(a[ordering[u]]){if(c)return!1;parseFloat(a[ordering[u]])!==toInt(a[ordering[u]])&&(c=!0)}return!0}function isValid$1$1(){return this._isValid}function createInvalid$1(){return createDuration(NaN)}function Duration(a){var s=normalizeObjectUnits(a),c=s.year||0,u=s.quarter||0,d=s.month||0,h=s.week||s.isoWeek||0,f=s.day||0,g=s.hour||0,m=s.minute||0,p=s.second||0,v=s.millisecond||0;this._isValid=isDurationValid(s),this._milliseconds=+v+p*1e3+m*6e4+g*1e3*60*60,this._days=+f+h*7,this._months=+d+u*3+c*12,this._data={},this._locale=getLocale(),this._bubble()}function isDuration(a){return a instanceof Duration}function absRound(a){return a<0?Math.round(-1*a)*-1:Math.round(a)}function compareArrays(a,s,c){var u=Math.min(a.length,s.length),d=Math.abs(a.length-s.length),h=0,f;for(f=0;f<u;f++)toInt(a[f])!==toInt(s[f])&&h++;return h+d}function offset$1(a,s){addFormatToken(a,0,0,function(){var c=this.utcOffset(),u="+";return c<0&&(c=-c,u="-"),u+zeroFill(~~(c/60),2)+s+zeroFill(~~c%60,2)})}offset$1("Z",":"),offset$1("ZZ",""),addRegexToken("Z",matchShortOffset),addRegexToken("ZZ",matchShortOffset),addParseToken(["Z","ZZ"],function(a,s,c){c._useUTC=!0,c._tzm=offsetFromString(matchShortOffset,a)});var chunkOffset=/([\+\-]|\d\d)/gi;function offsetFromString(a,s){var c=(s||"").match(a),u,d,h;return c===null?null:(u=c[c.length-1]||[],d=(u+"").match(chunkOffset)||["-",0,0],h=+(d[1]*60)+toInt(d[2]),h===0?0:d[0]==="+"?h:-h)}function cloneWithOffset(a,s){var c,u;return s._isUTC?(c=s.clone(),u=(isMoment(a)||isDate$2(a)?a.valueOf():createLocal(a).valueOf())-c.valueOf(),c._d.setTime(c._d.valueOf()+u),hooks.updateOffset(c,!1),c):createLocal(a).local()}function getDateOffset(a){return-Math.round(a._d.getTimezoneOffset())}hooks.updateOffset=function(){};function getSetOffset(a,s,c){var u=this._offset||0,d;if(!this.isValid())return a!=null?this:NaN;if(a!=null){if(typeof a=="string"){if(a=offsetFromString(matchShortOffset,a),a===null)return this}else Math.abs(a)<16&&!c&&(a=a*60);return!this._isUTC&&s&&(d=getDateOffset(this)),this._offset=a,this._isUTC=!0,d!=null&&this.add(d,"m"),u!==a&&(!s||this._changeInProgress?addSubtract(this,createDuration(a-u,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,hooks.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?u:getDateOffset(this)}function getSetZone(a,s){return a!=null?(typeof a!="string"&&(a=-a),this.utcOffset(a,s),this):-this.utcOffset()}function setOffsetToUTC(a){return this.utcOffset(0,a)}function setOffsetToLocal(a){return this._isUTC&&(this.utcOffset(0,a),this._isUTC=!1,a&&this.subtract(getDateOffset(this),"m")),this}function setOffsetToParsedOffset(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var a=offsetFromString(matchOffset,this._i);a!=null?this.utcOffset(a):this.utcOffset(0,!0)}return this}function hasAlignedHourOffset(a){return this.isValid()?(a=a?createLocal(a).utcOffset():0,(this.utcOffset()-a)%60===0):!1}function isDaylightSavingTime(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function isDaylightSavingTimeShifted(){if(!isUndefined$1(this._isDSTShifted))return this._isDSTShifted;var a={},s;return copyConfig(a,this),a=prepareConfig(a),a._a?(s=a._isUTC?createUTC(a._a):createLocal(a._a),this._isDSTShifted=this.isValid()&&compareArrays(a._a,s.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function isLocal(){return this.isValid()?!this._isUTC:!1}function isUtcOffset(){return this.isValid()?this._isUTC:!1}function isUtc(){return this.isValid()?this._isUTC&&this._offset===0:!1}var aspNetRegex=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,isoRegex=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function createDuration(a,s){var c=a,u=null,d,h,f;return isDuration(a)?c={ms:a._milliseconds,d:a._days,M:a._months}:isNumber(a)||!isNaN(+a)?(c={},s?c[s]=+a:c.milliseconds=+a):(u=aspNetRegex.exec(a))?(d=u[1]==="-"?-1:1,c={y:0,d:toInt(u[DATE])*d,h:toInt(u[HOUR])*d,m:toInt(u[MINUTE])*d,s:toInt(u[SECOND])*d,ms:toInt(absRound(u[MILLISECOND]*1e3))*d}):(u=isoRegex.exec(a))?(d=u[1]==="-"?-1:1,c={y:parseIso(u[2],d),M:parseIso(u[3],d),w:parseIso(u[4],d),d:parseIso(u[5],d),h:parseIso(u[6],d),m:parseIso(u[7],d),s:parseIso(u[8],d)}):c==null?c={}:typeof c=="object"&&("from"in c||"to"in c)&&(f=momentsDifference(createLocal(c.from),createLocal(c.to)),c={},c.ms=f.milliseconds,c.M=f.months),h=new Duration(c),isDuration(a)&&hasOwnProp(a,"_locale")&&(h._locale=a._locale),isDuration(a)&&hasOwnProp(a,"_isValid")&&(h._isValid=a._isValid),h}createDuration.fn=Duration.prototype,createDuration.invalid=createInvalid$1;function parseIso(a,s){var c=a&&parseFloat(a.replace(",","."));return(isNaN(c)?0:c)*s}function positiveMomentsDifference(a,s){var c={};return c.months=s.month()-a.month()+(s.year()-a.year())*12,a.clone().add(c.months,"M").isAfter(s)&&--c.months,c.milliseconds=+s-+a.clone().add(c.months,"M"),c}function momentsDifference(a,s){var c;return a.isValid()&&s.isValid()?(s=cloneWithOffset(s,a),a.isBefore(s)?c=positiveMomentsDifference(a,s):(c=positiveMomentsDifference(s,a),c.milliseconds=-c.milliseconds,c.months=-c.months),c):{milliseconds:0,months:0}}function createAdder(a,s){return function(c,u){var d,h;return u!==null&&!isNaN(+u)&&(deprecateSimple(s,"moment()."+s+"(period, number) is deprecated. Please use moment()."+s+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),h=c,c=u,u=h),d=createDuration(c,u),addSubtract(this,d,a),this}}function addSubtract(a,s,c,u){var d=s._milliseconds,h=absRound(s._days),f=absRound(s._months);a.isValid()&&(u=u??!0,f&&setMonth(a,get(a,"Month")+f*c),h&&set$1$1(a,"Date",get(a,"Date")+h*c),d&&a._d.setTime(a._d.valueOf()+d*c),u&&hooks.updateOffset(a,h||f))}var add$1=createAdder(1,"add"),subtract$1=createAdder(-1,"subtract");function isString(a){return typeof a=="string"||a instanceof String}function isMomentInput(a){return isMoment(a)||isDate$2(a)||isString(a)||isNumber(a)||isNumberOrStringArray(a)||isMomentInputObject(a)||a===null||a===void 0}function isMomentInputObject(a){var s=isObject$1(a)&&!isObjectEmpty(a),c=!1,u=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],d,h,f=u.length;for(d=0;d<f;d+=1)h=u[d],c=c||hasOwnProp(a,h);return s&&c}function isNumberOrStringArray(a){var s=isArray$1(a),c=!1;return s&&(c=a.filter(function(u){return!isNumber(u)&&isString(a)}).length===0),s&&c}function isCalendarSpec(a){var s=isObject$1(a)&&!isObjectEmpty(a),c=!1,u=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],d,h;for(d=0;d<u.length;d+=1)h=u[d],c=c||hasOwnProp(a,h);return s&&c}function getCalendarFormat(a,s){var c=a.diff(s,"days",!0);return c<-6?"sameElse":c<-1?"lastWeek":c<0?"lastDay":c<1?"sameDay":c<2?"nextDay":c<7?"nextWeek":"sameElse"}function calendar$1(a,s){arguments.length===1&&(arguments[0]?isMomentInput(arguments[0])?(a=arguments[0],s=void 0):isCalendarSpec(arguments[0])&&(s=arguments[0],a=void 0):(a=void 0,s=void 0));var c=a||createLocal(),u=cloneWithOffset(c,this).startOf("day"),d=hooks.calendarFormat(this,u)||"sameElse",h=s&&(isFunction$1(s[d])?s[d].call(this,c):s[d]);return this.format(h||this.localeData().calendar(d,this,createLocal(c)))}function clone$1(){return new Moment(this)}function isAfter(a,s){var c=isMoment(a)?a:createLocal(a);return this.isValid()&&c.isValid()?(s=normalizeUnits(s)||"millisecond",s==="millisecond"?this.valueOf()>c.valueOf():c.valueOf()<this.clone().startOf(s).valueOf()):!1}function isBefore(a,s){var c=isMoment(a)?a:createLocal(a);return this.isValid()&&c.isValid()?(s=normalizeUnits(s)||"millisecond",s==="millisecond"?this.valueOf()<c.valueOf():this.clone().endOf(s).valueOf()<c.valueOf()):!1}function isBetween(a,s,c,u){var d=isMoment(a)?a:createLocal(a),h=isMoment(s)?s:createLocal(s);return this.isValid()&&d.isValid()&&h.isValid()?(u=u||"()",(u[0]==="("?this.isAfter(d,c):!this.isBefore(d,c))&&(u[1]===")"?this.isBefore(h,c):!this.isAfter(h,c))):!1}function isSame(a,s){var c=isMoment(a)?a:createLocal(a),u;return this.isValid()&&c.isValid()?(s=normalizeUnits(s)||"millisecond",s==="millisecond"?this.valueOf()===c.valueOf():(u=c.valueOf(),this.clone().startOf(s).valueOf()<=u&&u<=this.clone().endOf(s).valueOf())):!1}function isSameOrAfter(a,s){return this.isSame(a,s)||this.isAfter(a,s)}function isSameOrBefore(a,s){return this.isSame(a,s)||this.isBefore(a,s)}function diff(a,s,c){var u,d,h;if(!this.isValid())return NaN;if(u=cloneWithOffset(a,this),!u.isValid())return NaN;switch(d=(u.utcOffset()-this.utcOffset())*6e4,s=normalizeUnits(s),s){case"year":h=monthDiff(this,u)/12;break;case"month":h=monthDiff(this,u);break;case"quarter":h=monthDiff(this,u)/3;break;case"second":h=(this-u)/1e3;break;case"minute":h=(this-u)/6e4;break;case"hour":h=(this-u)/36e5;break;case"day":h=(this-u-d)/864e5;break;case"week":h=(this-u-d)/6048e5;break;default:h=this-u}return c?h:absFloor(h)}function monthDiff(a,s){if(a.date()<s.date())return-monthDiff(s,a);var c=(s.year()-a.year())*12+(s.month()-a.month()),u=a.clone().add(c,"months"),d,h;return s-u<0?(d=a.clone().add(c-1,"months"),h=(s-u)/(u-d)):(d=a.clone().add(c+1,"months"),h=(s-u)/(d-u)),-(c+h)||0}hooks.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",hooks.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function toString(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function toISOString(a){if(!this.isValid())return null;var s=a!==!0,c=s?this.clone().utc():this;return c.year()<0||c.year()>9999?formatMoment(c,s?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):isFunction$1(Date.prototype.toISOString)?s?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",formatMoment(c,"Z")):formatMoment(c,s?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function inspect(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var a="moment",s="",c,u,d,h;return this.isLocal()||(a=this.utcOffset()===0?"moment.utc":"moment.parseZone",s="Z"),c="["+a+'("]',u=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",d="-MM-DD[T]HH:mm:ss.SSS",h=s+'[")]',this.format(c+u+d+h)}function format$1(a){a||(a=this.isUtc()?hooks.defaultFormatUtc:hooks.defaultFormat);var s=formatMoment(this,a);return this.localeData().postformat(s)}function from(a,s){return this.isValid()&&(isMoment(a)&&a.isValid()||createLocal(a).isValid())?createDuration({to:this,from:a}).locale(this.locale()).humanize(!s):this.localeData().invalidDate()}function fromNow(a){return this.from(createLocal(),a)}function to(a,s){return this.isValid()&&(isMoment(a)&&a.isValid()||createLocal(a).isValid())?createDuration({from:this,to:a}).locale(this.locale()).humanize(!s):this.localeData().invalidDate()}function toNow(a){return this.to(createLocal(),a)}function locale(a){var s;return a===void 0?this._locale._abbr:(s=getLocale(a),s!=null&&(this._locale=s),this)}var lang=deprecate("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(a){return a===void 0?this.localeData():this.locale(a)});function localeData(){return this._locale}var MS_PER_SECOND=1e3,MS_PER_MINUTE=60*MS_PER_SECOND,MS_PER_HOUR=60*MS_PER_MINUTE,MS_PER_400_YEARS=(365*400+97)*24*MS_PER_HOUR;function mod$1(a,s){return(a%s+s)%s}function localStartOfDate(a,s,c){return a<100&&a>=0?new Date(a+400,s,c)-MS_PER_400_YEARS:new Date(a,s,c).valueOf()}function utcStartOfDate(a,s,c){return a<100&&a>=0?Date.UTC(a+400,s,c)-MS_PER_400_YEARS:Date.UTC(a,s,c)}function startOf(a){var s,c;if(a=normalizeUnits(a),a===void 0||a==="millisecond"||!this.isValid())return this;switch(c=this._isUTC?utcStartOfDate:localStartOfDate,a){case"year":s=c(this.year(),0,1);break;case"quarter":s=c(this.year(),this.month()-this.month()%3,1);break;case"month":s=c(this.year(),this.month(),1);break;case"week":s=c(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":s=c(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":s=c(this.year(),this.month(),this.date());break;case"hour":s=this._d.valueOf(),s-=mod$1(s+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR);break;case"minute":s=this._d.valueOf(),s-=mod$1(s,MS_PER_MINUTE);break;case"second":s=this._d.valueOf(),s-=mod$1(s,MS_PER_SECOND);break}return this._d.setTime(s),hooks.updateOffset(this,!0),this}function endOf(a){var s,c;if(a=normalizeUnits(a),a===void 0||a==="millisecond"||!this.isValid())return this;switch(c=this._isUTC?utcStartOfDate:localStartOfDate,a){case"year":s=c(this.year()+1,0,1)-1;break;case"quarter":s=c(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":s=c(this.year(),this.month()+1,1)-1;break;case"week":s=c(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":s=c(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":s=c(this.year(),this.month(),this.date()+1)-1;break;case"hour":s=this._d.valueOf(),s+=MS_PER_HOUR-mod$1(s+(this._isUTC?0:this.utcOffset()*MS_PER_MINUTE),MS_PER_HOUR)-1;break;case"minute":s=this._d.valueOf(),s+=MS_PER_MINUTE-mod$1(s,MS_PER_MINUTE)-1;break;case"second":s=this._d.valueOf(),s+=MS_PER_SECOND-mod$1(s,MS_PER_SECOND)-1;break}return this._d.setTime(s),hooks.updateOffset(this,!0),this}function valueOf(){return this._d.valueOf()-(this._offset||0)*6e4}function unix(){return Math.floor(this.valueOf()/1e3)}function toDate(){return new Date(this.valueOf())}function toArray(){var a=this;return[a.year(),a.month(),a.date(),a.hour(),a.minute(),a.second(),a.millisecond()]}function toObject(){var a=this;return{years:a.year(),months:a.month(),date:a.date(),hours:a.hours(),minutes:a.minutes(),seconds:a.seconds(),milliseconds:a.milliseconds()}}function toJSON(){return this.isValid()?this.toISOString():null}function isValid$2(){return isValid$1(this)}function parsingFlags(){return extend$2({},getParsingFlags(this))}function invalidAt(){return getParsingFlags(this).overflow}function creationData(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}addFormatToken("N",0,0,"eraAbbr"),addFormatToken("NN",0,0,"eraAbbr"),addFormatToken("NNN",0,0,"eraAbbr"),addFormatToken("NNNN",0,0,"eraName"),addFormatToken("NNNNN",0,0,"eraNarrow"),addFormatToken("y",["y",1],"yo","eraYear"),addFormatToken("y",["yy",2],0,"eraYear"),addFormatToken("y",["yyy",3],0,"eraYear"),addFormatToken("y",["yyyy",4],0,"eraYear"),addRegexToken("N",matchEraAbbr),addRegexToken("NN",matchEraAbbr),addRegexToken("NNN",matchEraAbbr),addRegexToken("NNNN",matchEraName),addRegexToken("NNNNN",matchEraNarrow),addParseToken(["N","NN","NNN","NNNN","NNNNN"],function(a,s,c,u){var d=c._locale.erasParse(a,u,c._strict);d?getParsingFlags(c).era=d:getParsingFlags(c).invalidEra=a}),addRegexToken("y",matchUnsigned),addRegexToken("yy",matchUnsigned),addRegexToken("yyy",matchUnsigned),addRegexToken("yyyy",matchUnsigned),addRegexToken("yo",matchEraYearOrdinal),addParseToken(["y","yy","yyy","yyyy"],YEAR),addParseToken(["yo"],function(a,s,c,u){var d;c._locale._eraYearOrdinalRegex&&(d=a.match(c._locale._eraYearOrdinalRegex)),c._locale.eraYearOrdinalParse?s[YEAR]=c._locale.eraYearOrdinalParse(a,d):s[YEAR]=parseInt(a,10)});function localeEras(a,s){var c,u,d,h=this._eras||getLocale("en")._eras;for(c=0,u=h.length;c<u;++c){switch(typeof h[c].since){case"string":d=hooks(h[c].since).startOf("day"),h[c].since=d.valueOf();break}switch(typeof h[c].until){case"undefined":h[c].until=1/0;break;case"string":d=hooks(h[c].until).startOf("day").valueOf(),h[c].until=d.valueOf();break}}return h}function localeErasParse(a,s,c){var u,d,h=this.eras(),f,g,m;for(a=a.toUpperCase(),u=0,d=h.length;u<d;++u)if(f=h[u].name.toUpperCase(),g=h[u].abbr.toUpperCase(),m=h[u].narrow.toUpperCase(),c)switch(s){case"N":case"NN":case"NNN":if(g===a)return h[u];break;case"NNNN":if(f===a)return h[u];break;case"NNNNN":if(m===a)return h[u];break}else if([f,g,m].indexOf(a)>=0)return h[u]}function localeErasConvertYear(a,s){var c=a.since<=a.until?1:-1;return s===void 0?hooks(a.since).year():hooks(a.since).year()+(s-a.offset)*c}function getEraName(){var a,s,c,u=this.localeData().eras();for(a=0,s=u.length;a<s;++a)if(c=this.clone().startOf("day").valueOf(),u[a].since<=c&&c<=u[a].until||u[a].until<=c&&c<=u[a].since)return u[a].name;return""}function getEraNarrow(){var a,s,c,u=this.localeData().eras();for(a=0,s=u.length;a<s;++a)if(c=this.clone().startOf("day").valueOf(),u[a].since<=c&&c<=u[a].until||u[a].until<=c&&c<=u[a].since)return u[a].narrow;return""}function getEraAbbr(){var a,s,c,u=this.localeData().eras();for(a=0,s=u.length;a<s;++a)if(c=this.clone().startOf("day").valueOf(),u[a].since<=c&&c<=u[a].until||u[a].until<=c&&c<=u[a].since)return u[a].abbr;return""}function getEraYear(){var a,s,c,u,d=this.localeData().eras();for(a=0,s=d.length;a<s;++a)if(c=d[a].since<=d[a].until?1:-1,u=this.clone().startOf("day").valueOf(),d[a].since<=u&&u<=d[a].until||d[a].until<=u&&u<=d[a].since)return(this.year()-hooks(d[a].since).year())*c+d[a].offset;return this.year()}function erasNameRegex(a){return hasOwnProp(this,"_erasNameRegex")||computeErasParse.call(this),a?this._erasNameRegex:this._erasRegex}function erasAbbrRegex(a){return hasOwnProp(this,"_erasAbbrRegex")||computeErasParse.call(this),a?this._erasAbbrRegex:this._erasRegex}function erasNarrowRegex(a){return hasOwnProp(this,"_erasNarrowRegex")||computeErasParse.call(this),a?this._erasNarrowRegex:this._erasRegex}function matchEraAbbr(a,s){return s.erasAbbrRegex(a)}function matchEraName(a,s){return s.erasNameRegex(a)}function matchEraNarrow(a,s){return s.erasNarrowRegex(a)}function matchEraYearOrdinal(a,s){return s._eraYearOrdinalRegex||matchUnsigned}function computeErasParse(){var a=[],s=[],c=[],u=[],d,h,f,g,m,p=this.eras();for(d=0,h=p.length;d<h;++d)f=regexEscape(p[d].name),g=regexEscape(p[d].abbr),m=regexEscape(p[d].narrow),s.push(f),a.push(g),c.push(m),u.push(f),u.push(g),u.push(m);this._erasRegex=new RegExp("^("+u.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+s.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+a.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+c.join("|")+")","i")}addFormatToken(0,["gg",2],0,function(){return this.weekYear()%100}),addFormatToken(0,["GG",2],0,function(){return this.isoWeekYear()%100});function addWeekYearFormatToken(a,s){addFormatToken(0,[a,a.length],0,s)}addWeekYearFormatToken("gggg","weekYear"),addWeekYearFormatToken("ggggg","weekYear"),addWeekYearFormatToken("GGGG","isoWeekYear"),addWeekYearFormatToken("GGGGG","isoWeekYear"),addRegexToken("G",matchSigned),addRegexToken("g",matchSigned),addRegexToken("GG",match1to2,match2),addRegexToken("gg",match1to2,match2),addRegexToken("GGGG",match1to4,match4),addRegexToken("gggg",match1to4,match4),addRegexToken("GGGGG",match1to6,match6),addRegexToken("ggggg",match1to6,match6),addWeekParseToken(["gggg","ggggg","GGGG","GGGGG"],function(a,s,c,u){s[u.substr(0,2)]=toInt(a)}),addWeekParseToken(["gg","GG"],function(a,s,c,u){s[u]=hooks.parseTwoDigitYear(a)});function getSetWeekYear(a){return getSetWeekYearHelper.call(this,a,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function getSetISOWeekYear(a){return getSetWeekYearHelper.call(this,a,this.isoWeek(),this.isoWeekday(),1,4)}function getISOWeeksInYear(){return weeksInYear(this.year(),1,4)}function getISOWeeksInISOWeekYear(){return weeksInYear(this.isoWeekYear(),1,4)}function getWeeksInYear(){var a=this.localeData()._week;return weeksInYear(this.year(),a.dow,a.doy)}function getWeeksInWeekYear(){var a=this.localeData()._week;return weeksInYear(this.weekYear(),a.dow,a.doy)}function getSetWeekYearHelper(a,s,c,u,d){var h;return a==null?weekOfYear(this,u,d).year:(h=weeksInYear(a,u,d),s>h&&(s=h),setWeekAll.call(this,a,s,c,u,d))}function setWeekAll(a,s,c,u,d){var h=dayOfYearFromWeeks(a,s,c,u,d),f=createUTCDate(h.year,0,h.dayOfYear);return this.year(f.getUTCFullYear()),this.month(f.getUTCMonth()),this.date(f.getUTCDate()),this}addFormatToken("Q",0,"Qo","quarter"),addRegexToken("Q",match1),addParseToken("Q",function(a,s){s[MONTH]=(toInt(a)-1)*3});function getSetQuarter(a){return a==null?Math.ceil((this.month()+1)/3):this.month((a-1)*3+this.month()%3)}addFormatToken("D",["DD",2],"Do","date"),addRegexToken("D",match1to2,match1to2NoLeadingZero),addRegexToken("DD",match1to2,match2),addRegexToken("Do",function(a,s){return a?s._dayOfMonthOrdinalParse||s._ordinalParse:s._dayOfMonthOrdinalParseLenient}),addParseToken(["D","DD"],DATE),addParseToken("Do",function(a,s){s[DATE]=toInt(a.match(match1to2)[0])});var getSetDayOfMonth=makeGetSet("Date",!0);addFormatToken("DDD",["DDDD",3],"DDDo","dayOfYear"),addRegexToken("DDD",match1to3),addRegexToken("DDDD",match3),addParseToken(["DDD","DDDD"],function(a,s,c){c._dayOfYear=toInt(a)});function getSetDayOfYear(a){var s=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return a==null?s:this.add(a-s,"d")}addFormatToken("m",["mm",2],0,"minute"),addRegexToken("m",match1to2,match1to2HasZero),addRegexToken("mm",match1to2,match2),addParseToken(["m","mm"],MINUTE);var getSetMinute=makeGetSet("Minutes",!1);addFormatToken("s",["ss",2],0,"second"),addRegexToken("s",match1to2,match1to2HasZero),addRegexToken("ss",match1to2,match2),addParseToken(["s","ss"],SECOND);var getSetSecond=makeGetSet("Seconds",!1);addFormatToken("S",0,0,function(){return~~(this.millisecond()/100)}),addFormatToken(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),addFormatToken(0,["SSS",3],0,"millisecond"),addFormatToken(0,["SSSS",4],0,function(){return this.millisecond()*10}),addFormatToken(0,["SSSSS",5],0,function(){return this.millisecond()*100}),addFormatToken(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3}),addFormatToken(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4}),addFormatToken(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5}),addFormatToken(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6}),addRegexToken("S",match1to3,match1),addRegexToken("SS",match1to3,match2),addRegexToken("SSS",match1to3,match3);var token,getSetMillisecond;for(token="SSSS";token.length<=9;token+="S")addRegexToken(token,matchUnsigned);function parseMs(a,s){s[MILLISECOND]=toInt(("0."+a)*1e3)}for(token="S";token.length<=9;token+="S")addParseToken(token,parseMs);getSetMillisecond=makeGetSet("Milliseconds",!1),addFormatToken("z",0,0,"zoneAbbr"),addFormatToken("zz",0,0,"zoneName");function getZoneAbbr(){return this._isUTC?"UTC":""}function getZoneName(){return this._isUTC?"Coordinated Universal Time":""}var proto=Moment.prototype;proto.add=add$1,proto.calendar=calendar$1,proto.clone=clone$1,proto.diff=diff,proto.endOf=endOf,proto.format=format$1,proto.from=from,proto.fromNow=fromNow,proto.to=to,proto.toNow=toNow,proto.get=stringGet,proto.invalidAt=invalidAt,proto.isAfter=isAfter,proto.isBefore=isBefore,proto.isBetween=isBetween,proto.isSame=isSame,proto.isSameOrAfter=isSameOrAfter,proto.isSameOrBefore=isSameOrBefore,proto.isValid=isValid$2,proto.lang=lang,proto.locale=locale,proto.localeData=localeData,proto.max=prototypeMax,proto.min=prototypeMin,proto.parsingFlags=parsingFlags,proto.set=stringSet,proto.startOf=startOf,proto.subtract=subtract$1,proto.toArray=toArray,proto.toObject=toObject,proto.toDate=toDate,proto.toISOString=toISOString,proto.inspect=inspect,typeof Symbol<"u"&&Symbol.for!=null&&(proto[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"}),proto.toJSON=toJSON,proto.toString=toString,proto.unix=unix,proto.valueOf=valueOf,proto.creationData=creationData,proto.eraName=getEraName,proto.eraNarrow=getEraNarrow,proto.eraAbbr=getEraAbbr,proto.eraYear=getEraYear,proto.year=getSetYear,proto.isLeapYear=getIsLeapYear,proto.weekYear=getSetWeekYear,proto.isoWeekYear=getSetISOWeekYear,proto.quarter=proto.quarters=getSetQuarter,proto.month=getSetMonth,proto.daysInMonth=getDaysInMonth$1,proto.week=proto.weeks=getSetWeek,proto.isoWeek=proto.isoWeeks=getSetISOWeek,proto.weeksInYear=getWeeksInYear,proto.weeksInWeekYear=getWeeksInWeekYear,proto.isoWeeksInYear=getISOWeeksInYear,proto.isoWeeksInISOWeekYear=getISOWeeksInISOWeekYear,proto.date=getSetDayOfMonth,proto.day=proto.days=getSetDayOfWeek,proto.weekday=getSetLocaleDayOfWeek,proto.isoWeekday=getSetISODayOfWeek,proto.dayOfYear=getSetDayOfYear,proto.hour=proto.hours=getSetHour,proto.minute=proto.minutes=getSetMinute,proto.second=proto.seconds=getSetSecond,proto.millisecond=proto.milliseconds=getSetMillisecond,proto.utcOffset=getSetOffset,proto.utc=setOffsetToUTC,proto.local=setOffsetToLocal,proto.parseZone=setOffsetToParsedOffset,proto.hasAlignedHourOffset=hasAlignedHourOffset,proto.isDST=isDaylightSavingTime,proto.isLocal=isLocal,proto.isUtcOffset=isUtcOffset,proto.isUtc=isUtc,proto.isUTC=isUtc,proto.zoneAbbr=getZoneAbbr,proto.zoneName=getZoneName,proto.dates=deprecate("dates accessor is deprecated. Use date instead.",getSetDayOfMonth),proto.months=deprecate("months accessor is deprecated. Use month instead",getSetMonth),proto.years=deprecate("years accessor is deprecated. Use year instead",getSetYear),proto.zone=deprecate("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",getSetZone),proto.isDSTShifted=deprecate("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",isDaylightSavingTimeShifted);function createUnix(a){return createLocal(a*1e3)}function createInZone(){return createLocal.apply(null,arguments).parseZone()}function preParsePostFormat(a){return a}var proto$1=Locale.prototype;proto$1.calendar=calendar,proto$1.longDateFormat=longDateFormat,proto$1.invalidDate=invalidDate,proto$1.ordinal=ordinal,proto$1.preparse=preParsePostFormat,proto$1.postformat=preParsePostFormat,proto$1.relativeTime=relativeTime,proto$1.pastFuture=pastFuture,proto$1.set=set$1,proto$1.eras=localeEras,proto$1.erasParse=localeErasParse,proto$1.erasConvertYear=localeErasConvertYear,proto$1.erasAbbrRegex=erasAbbrRegex,proto$1.erasNameRegex=erasNameRegex,proto$1.erasNarrowRegex=erasNarrowRegex,proto$1.months=localeMonths,proto$1.monthsShort=localeMonthsShort,proto$1.monthsParse=localeMonthsParse,proto$1.monthsRegex=monthsRegex,proto$1.monthsShortRegex=monthsShortRegex,proto$1.week=localeWeek,proto$1.firstDayOfYear=localeFirstDayOfYear,proto$1.firstDayOfWeek=localeFirstDayOfWeek,proto$1.weekdays=localeWeekdays,proto$1.weekdaysMin=localeWeekdaysMin,proto$1.weekdaysShort=localeWeekdaysShort,proto$1.weekdaysParse=localeWeekdaysParse,proto$1.weekdaysRegex=weekdaysRegex,proto$1.weekdaysShortRegex=weekdaysShortRegex,proto$1.weekdaysMinRegex=weekdaysMinRegex,proto$1.isPM=localeIsPM,proto$1.meridiem=localeMeridiem;function get$1(a,s,c,u){var d=getLocale(),h=createUTC().set(u,s);return d[c](h,a)}function listMonthsImpl(a,s,c){if(isNumber(a)&&(s=a,a=void 0),a=a||"",s!=null)return get$1(a,s,c,"month");var u,d=[];for(u=0;u<12;u++)d[u]=get$1(a,u,c,"month");return d}function listWeekdaysImpl(a,s,c,u){typeof a=="boolean"?(isNumber(s)&&(c=s,s=void 0),s=s||""):(s=a,c=s,a=!1,isNumber(s)&&(c=s,s=void 0),s=s||"");var d=getLocale(),h=a?d._week.dow:0,f,g=[];if(c!=null)return get$1(s,(c+h)%7,u,"day");for(f=0;f<7;f++)g[f]=get$1(s,(f+h)%7,u,"day");return g}function listMonths(a,s){return listMonthsImpl(a,s,"months")}function listMonthsShort(a,s){return listMonthsImpl(a,s,"monthsShort")}function listWeekdays(a,s,c){return listWeekdaysImpl(a,s,c,"weekdays")}function listWeekdaysShort(a,s,c){return listWeekdaysImpl(a,s,c,"weekdaysShort")}function listWeekdaysMin(a,s,c){return listWeekdaysImpl(a,s,c,"weekdaysMin")}getSetGlobalLocale("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(a){var s=a%10,c=toInt(a%100/10)===1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th";return a+c}}),hooks.lang=deprecate("moment.lang is deprecated. Use moment.locale instead.",getSetGlobalLocale),hooks.langData=deprecate("moment.langData is deprecated. Use moment.localeData instead.",getLocale);var mathAbs=Math.abs;function abs(){var a=this._data;return this._milliseconds=mathAbs(this._milliseconds),this._days=mathAbs(this._days),this._months=mathAbs(this._months),a.milliseconds=mathAbs(a.milliseconds),a.seconds=mathAbs(a.seconds),a.minutes=mathAbs(a.minutes),a.hours=mathAbs(a.hours),a.months=mathAbs(a.months),a.years=mathAbs(a.years),this}function addSubtract$1(a,s,c,u){var d=createDuration(s,c);return a._milliseconds+=u*d._milliseconds,a._days+=u*d._days,a._months+=u*d._months,a._bubble()}function add$1$1(a,s){return addSubtract$1(this,a,s,1)}function subtract$1$1(a,s){return addSubtract$1(this,a,s,-1)}function absCeil(a){return a<0?Math.floor(a):Math.ceil(a)}function bubble(){var a=this._milliseconds,s=this._days,c=this._months,u=this._data,d,h,f,g,m;return a>=0&&s>=0&&c>=0||a<=0&&s<=0&&c<=0||(a+=absCeil(monthsToDays(c)+s)*864e5,s=0,c=0),u.milliseconds=a%1e3,d=absFloor(a/1e3),u.seconds=d%60,h=absFloor(d/60),u.minutes=h%60,f=absFloor(h/60),u.hours=f%24,s+=absFloor(f/24),m=absFloor(daysToMonths(s)),c+=m,s-=absCeil(monthsToDays(m)),g=absFloor(c/12),c%=12,u.days=s,u.months=c,u.years=g,this}function daysToMonths(a){return a*4800/146097}function monthsToDays(a){return a*146097/4800}function as(a){if(!this.isValid())return NaN;var s,c,u=this._milliseconds;if(a=normalizeUnits(a),a==="month"||a==="quarter"||a==="year")switch(s=this._days+u/864e5,c=this._months+daysToMonths(s),a){case"month":return c;case"quarter":return c/3;case"year":return c/12}else switch(s=this._days+Math.round(monthsToDays(this._months)),a){case"week":return s/7+u/6048e5;case"day":return s+u/864e5;case"hour":return s*24+u/36e5;case"minute":return s*1440+u/6e4;case"second":return s*86400+u/1e3;case"millisecond":return Math.floor(s*864e5)+u;default:throw new Error("Unknown unit "+a)}}function makeAs(a){return function(){return this.as(a)}}var asMilliseconds=makeAs("ms"),asSeconds=makeAs("s"),asMinutes=makeAs("m"),asHours=makeAs("h"),asDays=makeAs("d"),asWeeks=makeAs("w"),asMonths=makeAs("M"),asQuarters=makeAs("Q"),asYears=makeAs("y"),valueOf$1=asMilliseconds;function clone$1$1(){return createDuration(this)}function get$2(a){return a=normalizeUnits(a),this.isValid()?this[a+"s"]():NaN}function makeGetter(a){return function(){return this.isValid()?this._data[a]:NaN}}var milliseconds=makeGetter("milliseconds"),seconds=makeGetter("seconds"),minutes=makeGetter("minutes"),hours=makeGetter("hours"),days=makeGetter("days"),months=makeGetter("months"),years=makeGetter("years");function weeks(){return absFloor(this.days()/7)}var round=Math.round,thresholds={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function substituteTimeAgo(a,s,c,u,d){return d.relativeTime(s||1,!!c,a,u)}function relativeTime$1(a,s,c,u){var d=createDuration(a).abs(),h=round(d.as("s")),f=round(d.as("m")),g=round(d.as("h")),m=round(d.as("d")),p=round(d.as("M")),v=round(d.as("w")),w=round(d.as("y")),E=h<=c.ss&&["s",h]||h<c.s&&["ss",h]||f<=1&&["m"]||f<c.m&&["mm",f]||g<=1&&["h"]||g<c.h&&["hh",g]||m<=1&&["d"]||m<c.d&&["dd",m];return c.w!=null&&(E=E||v<=1&&["w"]||v<c.w&&["ww",v]),E=E||p<=1&&["M"]||p<c.M&&["MM",p]||w<=1&&["y"]||["yy",w],E[2]=s,E[3]=+a>0,E[4]=u,substituteTimeAgo.apply(null,E)}function getSetRelativeTimeRounding(a){return a===void 0?round:typeof a=="function"?(round=a,!0):!1}function getSetRelativeTimeThreshold(a,s){return thresholds[a]===void 0?!1:s===void 0?thresholds[a]:(thresholds[a]=s,a==="s"&&(thresholds.ss=s-1),!0)}function humanize(a,s){if(!this.isValid())return this.localeData().invalidDate();var c=!1,u=thresholds,d,h;return typeof a=="object"&&(s=a,a=!1),typeof a=="boolean"&&(c=a),typeof s=="object"&&(u=Object.assign({},thresholds,s),s.s!=null&&s.ss==null&&(u.ss=s.s-1)),d=this.localeData(),h=relativeTime$1(this,!c,u,d),c&&(h=d.pastFuture(+this,h)),d.postformat(h)}var abs$1=Math.abs;function sign(a){return(a>0)-(a<0)||+a}function toISOString$1(){if(!this.isValid())return this.localeData().invalidDate();var a=abs$1(this._milliseconds)/1e3,s=abs$1(this._days),c=abs$1(this._months),u,d,h,f,g=this.asSeconds(),m,p,v,w;return g?(u=absFloor(a/60),d=absFloor(u/60),a%=60,u%=60,h=absFloor(c/12),c%=12,f=a?a.toFixed(3).replace(/\.?0+$/,""):"",m=g<0?"-":"",p=sign(this._months)!==sign(g)?"-":"",v=sign(this._days)!==sign(g)?"-":"",w=sign(this._milliseconds)!==sign(g)?"-":"",m+"P"+(h?p+h+"Y":"")+(c?p+c+"M":"")+(s?v+s+"D":"")+(d||u||a?"T":"")+(d?w+d+"H":"")+(u?w+u+"M":"")+(a?w+f+"S":"")):"P0D"}var proto$2=Duration.prototype;proto$2.isValid=isValid$1$1,proto$2.abs=abs,proto$2.add=add$1$1,proto$2.subtract=subtract$1$1,proto$2.as=as,proto$2.asMilliseconds=asMilliseconds,proto$2.asSeconds=asSeconds,proto$2.asMinutes=asMinutes,proto$2.asHours=asHours,proto$2.asDays=asDays,proto$2.asWeeks=asWeeks,proto$2.asMonths=asMonths,proto$2.asQuarters=asQuarters,proto$2.asYears=asYears,proto$2.valueOf=valueOf$1,proto$2._bubble=bubble,proto$2.clone=clone$1$1,proto$2.get=get$2,proto$2.milliseconds=milliseconds,proto$2.seconds=seconds,proto$2.minutes=minutes,proto$2.hours=hours,proto$2.days=days,proto$2.weeks=weeks,proto$2.months=months,proto$2.years=years,proto$2.humanize=humanize,proto$2.toISOString=toISOString$1,proto$2.toString=toISOString$1,proto$2.toJSON=toISOString$1,proto$2.locale=locale,proto$2.localeData=localeData,proto$2.toIsoString=deprecate("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",toISOString$1),proto$2.lang=lang,addFormatToken("X",0,0,"unix"),addFormatToken("x",0,0,"valueOf"),addRegexToken("x",matchSigned),addRegexToken("X",matchTimestamp),addParseToken("X",function(a,s,c){c._d=new Date(parseFloat(a)*1e3)}),addParseToken("x",function(a,s,c){c._d=new Date(toInt(a))});hooks.version="2.30.1",setHookCallback(createLocal),hooks.fn=proto,hooks.min=min,hooks.max=max,hooks.now=now,hooks.utc=createUTC,hooks.unix=createUnix,hooks.months=listMonths,hooks.isDate=isDate$2,hooks.locale=getSetGlobalLocale,hooks.invalid=createInvalid,hooks.duration=createDuration,hooks.isMoment=isMoment,hooks.weekdays=listWeekdays,hooks.parseZone=createInZone,hooks.localeData=getLocale,hooks.isDuration=isDuration,hooks.monthsShort=listMonthsShort,hooks.weekdaysMin=listWeekdaysMin,hooks.defineLocale=defineLocale,hooks.updateLocale=updateLocale,hooks.locales=listLocales,hooks.weekdaysShort=listWeekdaysShort,hooks.normalizeUnits=normalizeUnits,hooks.relativeTimeRounding=getSetRelativeTimeRounding,hooks.relativeTimeThreshold=getSetRelativeTimeThreshold,hooks.calendarFormat=getCalendarFormat,hooks.prototype=proto,hooks.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var esnext_iterator_reduce={},es_iterator_reduce={},hasRequiredEs_iterator_reduce;function requireEs_iterator_reduce(){if(hasRequiredEs_iterator_reduce)return es_iterator_reduce;hasRequiredEs_iterator_reduce=1;var a=require_export(),s=requireIterate(),c=requireACallable(),u=requireAnObject(),d=requireGetIteratorDirect(),h=requireIteratorClose(),f=requireIteratorHelperWithoutClosingOnEarlyError(),g=requireFunctionApply(),m=requireFails(),p=TypeError,v=m(function(){[].keys().reduce(function(){},void 0)}),w=!v&&f("reduce",p);return a({target:"Iterator",proto:!0,real:!0,forced:v||w},{reduce:function(C){u(this);try{c(C)}catch(I){h(this,"throw",I)}var b=arguments.length<2,P=b?void 0:arguments[1];if(w)return g(w,this,b?[C]:[C,P]);var R=d(this),T=0;if(s(R,function(I){b?(b=!1,P=I):P=C(P,I,T),T++},{IS_RECORD:!0}),b)throw new p("Reduce of empty iterator with no initial value");return P}}),es_iterator_reduce}var hasRequiredEsnext_iterator_reduce;function requireEsnext_iterator_reduce(){return hasRequiredEsnext_iterator_reduce||(hasRequiredEsnext_iterator_reduce=1,requireEs_iterator_reduce()),esnext_iterator_reduce}requireEsnext_iterator_reduce();function to2dArray(a){const s=a.length;let c=0;for(;c<s;)a[c]=[a[c]],c+=1}function extendArray(a,s){const c=s.length;let u=0;for(;u<c;)a.push(s[u]),u+=1}function pivot(a){const s=[];if(!a||a.length===0||!a[0]||a[0].length===0)return s;const c=a.length,u=a[0].length;for(let d=0;d<c;d++)for(let h=0;h<u;h++)s[h]||(s[h]=[]),s[h][d]=a[d][h];return s}function arrayReduce(a,s,c,u){let d=-1,h=a,f=c;Array.isArray(a)||(h=Array.from(a));const g=h.length;for(d+=1;d<g;)f=s(f,h[d],d,h),d+=1;return f}function arrayFilter(a,s){let c=0,u=a;Array.isArray(a)||(u=Array.from(a));const d=u.length,h=[];let f=-1;for(;c<d;){const g=u[c];s(g,c,u)&&(f+=1,h[f]=g),c+=1}return h}function arrayMap(a,s){let c=0,u=a;Array.isArray(a)||(u=Array.from(a));const d=u.length,h=[];let f=-1;for(;c<d;){const g=u[c];f+=1,h[f]=s(g,c,u),c+=1}return h}function arrayEach(a,s){let c=0,u=a;Array.isArray(a)||(u=Array.from(a));const d=u.length;for(;c<d&&s(u[c],c,u)!==!1;)c+=1;return a}function arrayUnique(a){const s=[];return arrayEach(a,c=>{s.indexOf(c)===-1&&s.push(c)}),s}function getDifferenceOfArrays(){for(var a=arguments.length,s=new Array(a),c=0;c<a;c++)s[c]=arguments[c];const[u,...d]=[...s];let h=u;return arrayEach(d,f=>{h=h.filter(g=>!f.includes(g))}),h}function stringToArray(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return a.split(s)}function toSingleLine(a){for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return arrayReduce(a,(h,f,g)=>{const m=f.replace(/\r?\n\s*/g,""),p=c[g]?c[g]:"";return h+m+p},"").trim()}function html(a){for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];const d=document.createElement("template");d.innerHTML=a.reduce((g,m,p)=>{var v;return g+m+((v=c[p])!==null&&v!==void 0?v:"")},"");const h=d.content.cloneNode(!0),f={};return h.querySelectorAll("[data-ref]").forEach(g=>{const m=g.getAttribute("data-ref");g.removeAttribute("data-ref"),f[m]=g}),{fragment:h,refs:f}}function stringify$1(a){let s;switch(typeof a){case"string":case"number":s=`${a}`;break;case"object":s=a===null?"":a.toString();break;case"undefined":s="";break;default:s=a.toString();break}return s}function isDefined(a){return typeof a<"u"}function isUndefined(a){return typeof a>"u"}function isEmpty(a){return a===null||a===""||isUndefined(a)}function isRegExp(a){return Object.prototype.toString.call(a)==="[object RegExp]"}const _m="length",_hd=a=>parseInt(a,16),_pi=a=>parseInt(a,10),_ss=(a,s,c)=>a.substr(s,c),_cp=a=>a.codePointAt(0)-65,_norm=a=>`${a}`.replace(/\-/g,""),_extractTime=a=>_hd(_ss(_norm(a),_hd("12"),_cp("F")))/(_hd(_ss(_norm(a),_cp("B"),~~![][_m]))||9),_ignored=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let _notified=!1;const consoleMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:a=>{let{keyValidityDate:s,hotVersion:c}=a;return toSingleLine`
    The license key for Handsontable expired on ${s}, and is not valid for the installed\x20
    version ${c}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${s}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},domMessages={invalid:()=>toSingleLine`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:a=>{let{keyValidityDate:s,hotVersion:c}=a;return toSingleLine`
    The license key for Handsontable expired on ${s}, and is not valid for the installed\x20
    version ${c}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${s}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>toSingleLine`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function _injectProductInfo(a,s){const c=!isEmpty(a),u=typeof a=="string"&&a.toLowerCase()==="non-commercial-and-evaluation",d="16.2.0";let h,f="invalid",g="invalid";a=_norm(a||"");const m=_checkKeySchema(a);if(c||u||m)if(m){const p=hooks("25/11/2025","DD/MM/YYYY"),v=Math.floor(p.toDate().getTime()/864e5),w=_extractTime(a);h=hooks((w+1)*864e5,"x").format("MMMM DD, YYYY"),v>w?(f="expired",g="expired"):(f="valid",g="valid")}else u?(f="non_commercial",g="valid"):(f="invalid",g="invalid");else f="missing",g="missing";if(_ignored()&&(f="valid",g="valid"),!_notified&&f!=="valid"&&(consoleMessages[f]({keyValidityDate:h,hotVersion:d})&&console[f==="non_commercial"?"info":"warn"](consoleMessages[f]({keyValidityDate:h,hotVersion:d})),_notified=!0),g!=="valid"&&s&&domMessages[g]({keyValidityDate:h,hotVersion:d})){const v=document.createElement("div");v.className="handsontable hot-display-license-info",v.innerHTML=domMessages[g]({keyValidityDate:h,hotVersion:d}),s.appendChild(v)}}function _checkKeySchema(a){let s=[][_m],c=s;if(a[_m]!==_cp("Z"))return!1;for(let u="",d="B<H4P+".split(""),h=_cp(d.shift());h;h=_cp(d.shift()||"A"))--h<""[_m]?c=c|(_pi(`${_pi(_hd(u)+(_hd(_ss(a,Math.abs(h),2))+[]).padStart(2,"0"))}`)%97||2)>>1:u=_ss(a,h,h?d[_m]===1?9:8:6);return c===s}function toUpperCaseFirst(a){return a[0].toUpperCase()+a.substr(1)}function randomString(){function a(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return a()+a()+a()+a()}function isJSON(a){if(typeof a!="string")return!1;try{const s=JSON.parse(a);return typeof s=="object"&&s!==null}catch{return!1}}function isPercentValue(a){return/^([0-9][0-9]?%$)|(^100%$)/.test(a)}function substitute(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${a}`.replace(/(?:\\)?\[([^[\]]+)]/g,(c,u)=>c.charAt(0)==="\\"?c.substr(1,c.length-1):s[u]===void 0?"":s[u])}function stripTags(a){return sanitize(`${a}`,{ALLOWED_TAGS:[]})}function sanitize(a,s){return purify.sanitize(a,s)}const A11Y_TABINDEX=a=>["tabindex",a],A11Y_TREEGRID=()=>["role","treegrid"],A11Y_PRESENTATION=()=>["role","presentation"],A11Y_GRIDCELL=()=>["role","gridcell"],A11Y_GRIDCELL_BUTTON=()=>["role","gridcell button"],A11Y_ROWHEADER=()=>["role","rowheader"],A11Y_ROWGROUP=()=>["role","rowgroup"],A11Y_COLUMNHEADER=()=>["role","columnheader"],A11Y_ROW=()=>["role","row"],A11Y_MENU=()=>["role","menu"],A11Y_MENU_ITEM=()=>["role","menuitem"],A11Y_MENU_ITEM_CHECKBOX=()=>["role","menuitemcheckbox"],A11Y_COMBOBOX=()=>["role","combobox"],A11Y_LISTBOX=()=>["role","listbox"],A11Y_OPTION=()=>["role","option"],A11Y_CHECKBOX=()=>["role","checkbox"],A11Y_DIALOG=()=>["role","dialog"],A11Y_ALERTDIALOG=()=>["role","alertdialog"],A11Y_SCOPE_COL=()=>["scope","col"],A11Y_SCOPE_ROW=()=>["scope","row"],A11Y_TEXT=()=>["type","text"],A11Y_LABEL=a=>["aria-label",a],A11Y_LABELED_BY=a=>["aria-labelledby",a],A11Y_DESCRIBED_BY=a=>["aria-describedby",a],A11Y_HIDDEN=()=>["aria-hidden","true"],A11Y_DISABLED=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},A11Y_MULTISELECTABLE=()=>["aria-multiselectable","true"],A11Y_HASPOPUP=a=>["aria-haspopup",a],A11Y_ROWCOUNT=a=>["aria-rowcount",a],A11Y_COLCOUNT=a=>["aria-colcount",a],A11Y_ROWINDEX=a=>["aria-rowindex",a],A11Y_COLINDEX=a=>["aria-colindex",a],A11Y_EXPANDED=a=>["aria-expanded",a],A11Y_SORT=a=>["aria-sort",a],A11Y_READONLY=()=>["aria-readonly","true"],A11Y_INVALID=()=>["aria-invalid","true"],A11Y_CHECKED=a=>["aria-checked",a],A11Y_SELECTED=()=>["aria-selected","true"],A11Y_AUTOCOMPLETE=()=>["aria-autocomplete","list"],A11Y_CONTROLS=a=>["aria-controls",a],A11Y_ACTIVEDESCENDANT=a=>["aria-activedescendant",a],A11Y_LIVE=a=>["aria-live",a],A11Y_RELEVANT=a=>["aria-relevant",a],A11Y_SETSIZE=a=>["aria-setsize",a],A11Y_POSINSET=a=>["aria-posinset",a],A11Y_MODAL=()=>["aria-modal","true"];var es_json_stringify={},isRawJson,hasRequiredIsRawJson;function requireIsRawJson(){if(hasRequiredIsRawJson)return isRawJson;hasRequiredIsRawJson=1;var a=requireIsObject(),s=requireInternalState().get;return isRawJson=function(u){if(!a(u))return!1;var d=s(u);return!!d&&d.type==="RawJSON"},isRawJson}var parseJsonString,hasRequiredParseJsonString;function requireParseJsonString(){if(hasRequiredParseJsonString)return parseJsonString;hasRequiredParseJsonString=1;var a=requireFunctionUncurryThis(),s=requireHasOwnProperty(),c=SyntaxError,u=parseInt,d=String.fromCharCode,h=a("".charAt),f=a("".slice),g=a(/./.exec),m={'\\"':'"',"\\\\":"\\","\\/":"/","\\b":"\b","\\f":"\f","\\n":`
`,"\\r":"\r","\\t":"	"},p=/^[\da-f]{4}$/i,v=/^[\u0000-\u001F]$/;return parseJsonString=function(w,E){for(var C=!0,b="";E<w.length;){var P=h(w,E);if(P==="\\"){var R=f(w,E,E+2);if(s(m,R))b+=m[R],E+=2;else if(R==="\\u"){E+=2;var T=f(w,E,E+4);if(!g(p,T))throw new c("Bad Unicode escape at: "+E);b+=d(u(T,16)),E+=4}else throw new c('Unknown escape sequence: "'+R+'"')}else if(P==='"'){C=!1,E++;break}else{if(g(v,P))throw new c("Bad control character in string literal at: "+E);b+=P,E++}}if(C)throw new c("Unterminated string at: "+E);return{value:b,end:E}},parseJsonString}var nativeRawJson,hasRequiredNativeRawJson;function requireNativeRawJson(){if(hasRequiredNativeRawJson)return nativeRawJson;hasRequiredNativeRawJson=1;var a=requireFails();return nativeRawJson=!a(function(){var s="9007199254740993",c=JSON.rawJSON(s);return!JSON.isRawJSON(c)||JSON.stringify(c)!==s}),nativeRawJson}var hasRequiredEs_json_stringify;function requireEs_json_stringify(){if(hasRequiredEs_json_stringify)return es_json_stringify;hasRequiredEs_json_stringify=1;var a=require_export(),s=requireGetBuiltIn(),c=requireFunctionApply(),u=requireFunctionCall(),d=requireFunctionUncurryThis(),h=requireFails(),f=requireIsArray(),g=requireIsCallable(),m=requireIsRawJson(),p=requireIsSymbol(),v=requireClassofRaw(),w=requireToString(),E=requireArraySlice(),C=requireParseJsonString(),b=requireUid(),P=requireSymbolConstructorDetection(),R=requireNativeRawJson(),T=String,I=s("JSON","stringify"),M=d(/./.exec),N=d("".charAt),H=d("".charCodeAt),L=d("".replace),A=d("".slice),k=d([].push),W=d(1.1.toString),G=/[\uD800-\uDFFF]/g,oe=/^[\uD800-\uDBFF]$/,ae=/^[\uDC00-\uDFFF]$/,X=b(),le=X.length,ye=!P||h(function(){var Xe=s("Symbol")("stringify detection");return I([Xe])!=="[null]"||I({a:Xe})!=="{}"||I(Object(Xe))!=="{}"}),pe=h(function(){return I("\uDF06\uD834")!=='"\\udf06\\ud834"'||I("\uDEAD")!=='"\\udead"'}),he=ye?function(Xe,Ke){var it=E(arguments),te=Qe(Ke);if(!(!g(te)&&(Xe===void 0||p(Xe))))return it[1]=function(Pe,U){if(g(te)&&(U=u(te,this,T(Pe),U)),!p(U))return U},c(I,null,it)}:I,Me=function(Xe,Ke,it){var te=N(it,Ke-1),Pe=N(it,Ke+1);return M(oe,Xe)&&!M(ae,Pe)||M(ae,Xe)&&!M(oe,te)?"\\u"+W(H(Xe,0),16):Xe},Qe=function(Xe){if(g(Xe))return Xe;if(f(Xe)){for(var Ke=Xe.length,it=[],te=0;te<Ke;te++){var Pe=Xe[te];typeof Pe=="string"?k(it,Pe):(typeof Pe=="number"||v(Pe)==="Number"||v(Pe)==="String")&&k(it,w(Pe))}var U=it.length,Q=!0;return function(ee,ce){if(Q)return Q=!1,ce;if(f(this))return ce;for(var ve=0;ve<U;ve++)if(it[ve]===ee)return ce}}};return I&&a({target:"JSON",stat:!0,arity:3,forced:ye||pe||!R},{stringify:function(Ke,it,te){var Pe=Qe(it),U=[],Q=he(Ke,function(Oe,Se){var ge=g(Pe)?u(Pe,this,T(Oe),Se):Se;return!R&&m(ge)?X+(k(U,ge.rawJSON)-1):ge},te);if(typeof Q!="string"||(pe&&(Q=L(Q,G,Me)),R))return Q;for(var ee="",ce=Q.length,ve=0;ve<ce;ve++){var K=N(Q,ve);if(K==='"'){var ne=C(Q,++ve).end-1,de=A(Q,ve,ne);ee+=A(de,0,le)===X?U[A(de,le)]:'"'+de+'"',ve=ne}else ee+=K}return ee}}),es_json_stringify}requireEs_json_stringify();function duckSchema(a){let s;return Array.isArray(a)?s=a.length?new Array(a.length).fill(null):[]:(s={},objectEach(a,(c,u)=>{u!=="__children"&&(c&&typeof c=="object"&&!Array.isArray(c)?s[u]=duckSchema(c):Array.isArray(c)?c.length&&typeof c[0]=="object"&&!Array.isArray(c[0])?s[u]=[duckSchema(c[0])]:s[u]=[]:s[u]=null)})),s}function inherit(a,s){return s.prototype.constructor=s,a.prototype=new s,a.prototype.constructor=a,a}function extend$1(a,s,c){const u=Array.isArray(c);return objectEach(s,(d,h)=>{(u===!1||c.includes(h))&&(a[h]=d)}),a}function deepExtend(a,s){objectEach(s,(c,u)=>{s[u]&&typeof s[u]=="object"?(a[u]||(Array.isArray(s[u])?a[u]=[]:Object.prototype.toString.call(s[u])==="[object Date]"?a[u]=s[u]:a[u]={}),deepExtend(a[u],s[u])):a[u]=s[u]})}function deepClone(a){return typeof a=="object"?JSON.parse(JSON.stringify(a)):a}function clone(a){const s={};return objectEach(a,(c,u)=>{s[u]=c}),s}function mixin(a){a.MIXINS||(a.MIXINS=[]);for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return arrayEach(c,d=>{a.MIXINS.push(d.MIXIN_NAME),objectEach(d,(h,f)=>{if(a.prototype[f]!==void 0)throw new Error(`Mixin conflict. Property '${f}' already exist and cannot be overwritten.`);if(typeof h=="function")a.prototype[f]=h;else{const g=function(v,w){const E=`_${v}`,C=b=>{let P=b;return(Array.isArray(P)||isObject(P))&&(P=deepClone(P)),P};return function(){return this[E]===void 0&&(this[E]=C(w)),this[E]}},m=function(v){const w=`_${v}`;return function(E){this[w]=E}};Object.defineProperty(a.prototype,f,{get:g(f,h),set:m(f),configurable:!0})}})}),a}function isObjectEqual(a,s){return JSON.stringify(a)===JSON.stringify(s)}function isObject(a){return Object.prototype.toString.call(a)==="[object Object]"}function defineGetter(a,s,c,u){u.value=c,u.writable=u.writable!==!1,u.enumerable=u.enumerable!==!1,u.configurable=u.configurable!==!1,Object.defineProperty(a,s,u)}function objectEach(a,s){for(const c in a)if((!a.hasOwnProperty||a.hasOwnProperty&&Object.prototype.hasOwnProperty.call(a,c))&&s(a[c],c,a)===!1)break;return a}function getProperty(a,s){const c=s.split(".");let u=a;return objectEach(c,d=>{if(u=u[d],u===void 0)return u=void 0,!1}),u}function setProperty(a,s,c){if(typeof s!="string")return;const u=s.split(".");let d=a;u.forEach((h,f)=>{h==="__proto__"||h==="constructor"||h==="prototype"||(f!==u.length-1?(hasOwnProperty(d,h)||(d[h]={}),d=d[h]):d[h]=c)})}function deepObjectSize(a){if(!isObject(a))return 0;const s=function(c){let u=0;return isObject(c)?objectEach(c,(d,h)=>{h!=="__children"&&(u+=s(d))}):u+=1,u};return s(a)}function createObjectPropListener(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const c=`_${s}`,u={_touched:!1,[c]:a,isTouched(){return this._touched}};return Object.defineProperty(u,s,{get(){return this[c]},set(d){this._touched=!0,this[c]=d},enumerable:!0,configurable:!0}),u}function hasOwnProperty(a,s){return Object.prototype.hasOwnProperty.call(a,s)}function assignObjectDefaults(a,s){if(typeof a!="object"||a===null)return s;if(typeof s!="object"||s===null)return a;const c={};return Object.keys(s).forEach(u=>{typeof s[u]=="object"&&s[u]!==null&&!Array.isArray(s[u])?c[u]=assignObjectDefaults(a[u],s[u]):c[u]=hasOwnProperty(a,u)&&a[u]!==void 0?a[u]:s[u]}),Object.keys(a).forEach(u=>{hasOwnProperty(c,u)||(c[u]=a[u])}),c}function requestAnimationFrame$1(a){return window.requestAnimationFrame(a)}function cancelAnimationFrame(a){window.cancelAnimationFrame(a)}function isTouchSupported(){return"ontouchstart"in window}function isCSR$1(){return typeof window<"u"}let comparisonFunction;function getComparisonFunction(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return comparisonFunction||(typeof Intl=="object"?comparisonFunction=new Intl.Collator(a,s).compare:typeof String.prototype.localeCompare=="function"?comparisonFunction=(c,u)=>`${c}`.localeCompare(u):comparisonFunction=(c,u)=>c===u?0:c>u?-1:1,comparisonFunction)}const tester=a=>{const s={value:!1};return s.test=(c,u)=>{s.value=a(c,u)},s},browsers={chrome:tester((a,s)=>/Chrome/.test(a)&&/Google/.test(s)),chromeWebKit:tester(a=>/CriOS/.test(a)),edge:tester(a=>/Edge/.test(a)),edgeWebKit:tester(a=>/EdgiOS/.test(a)),firefox:tester(a=>/Firefox/.test(a)),firefoxWebKit:tester(a=>/FxiOS/.test(a)),mobile:tester(a=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(a)),safari:tester((a,s)=>/Safari/.test(a)&&/Apple Computer/.test(s))},platforms={mac:tester(a=>/^Mac/.test(a)),win:tester(a=>/^Win/.test(a)),linux:tester(a=>/^Linux/.test(a)),ios:tester(a=>/iPhone|iPad|iPod/i.test(a))};function setBrowserMeta(){let{userAgent:a=navigator.userAgent,vendor:s=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(browsers,c=>{let{test:u}=c;return void u(a,s)})}function setPlatformMeta(){let{platform:a=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};objectEach(platforms,s=>{let{test:c}=s;return void c(a)})}isCSR$1()&&(setBrowserMeta(),setPlatformMeta());function isChrome(){return browsers.chrome.value}function isChromeWebKit(){return browsers.chromeWebKit.value}function isFirefox(){return browsers.firefox.value}function isFirefoxWebKit(){return browsers.firefoxWebKit.value}function isSafari(){return browsers.safari.value}function isEdge(){return browsers.edge.value}function isMobileBrowser(){return browsers.mobile.value}function isIOS(){return platforms.ios.value}function isIpadOS(){let{maxTouchPoints:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return a>2&&platforms.mac.value}function isWindowsOS(){return platforms.win.value}function isMacOS(){return platforms.mac.value}function getParent(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=-1,u=null,d=a;for(;d!==null;){if(c===s){u=d;break}d.host&&d.nodeType===Node.DOCUMENT_FRAGMENT_NODE?d=d.host:(c+=1,d=d.parentNode)}return u}function isInternalElement(a,s){const c=a.closest(".handsontable");return!!c&&(c.parentNode===s||c===s)}function getFrameElement(a){return Object.getPrototypeOf(a.parent)&&a.frameElement}function getParentWindow(a){return getFrameElement(a)&&a.parent}function closest(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:u,DOCUMENT_FRAGMENT_NODE:d}=Node;let h=a;for(;h!=null&&h!==c;){const{nodeType:f,nodeName:g}=h;if(f===u&&(s.includes(g)||s.includes(h)))return h;const{host:m}=h;m&&f===d?h=m:h=h.parentNode}return null}function closestDown(a,s,c){const u=[];let d=a;for(;d&&(d=closest(d,s,c),!(!d||c&&!c.contains(d)));)u.push(d),d.host&&d.nodeType===Node.DOCUMENT_FRAGMENT_NODE?d=d.host:d=d.parentNode;const h=u.length;return h?u[h-1]:null}function findFirstParentWithClass(a,s){const c={element:void 0,classNames:[]};let u=a;for(;u!==null&&u!==a.ownerDocument.documentElement&&!c.element;){if(typeof s=="string"&&u.classList.contains(s))c.element=u,c.classNames.push(s);else if(s instanceof RegExp){const d=Array.from(u.classList).filter(h=>s.test(h));d.length&&(c.element=u,c.classNames.push(...d))}u=u.parentElement}return c}function isChildOf(a,s){let c=a.parentNode,u=[];for(typeof s=="string"?a.defaultView?u=Array.prototype.slice.call(a.querySelectorAll(s),0):u=Array.prototype.slice.call(a.ownerDocument.querySelectorAll(s),0):u.push(s);c!==null;){if(u.indexOf(c)>-1)return!0;c=c.parentNode}return!1}function index(a){let s=0,c=a;if(c.previousSibling)for(;c=c.previousSibling;)s+=1;return s}function overlayContainsElement(a,s,c){const u=c.parentElement.querySelector(`.ht_clone_${a}`);return u?u.contains(s):null}function filterEmptyClassNames(a){return!a||!a.length?[]:a.filter(s=>!!s)}function filterRegexes(a,s){if(!a||!a.length)return{regexFree:[],regexes:[]};const c=[],u=[];return u.push(...a.filter(d=>{const h=d instanceof RegExp;return h&&s&&c.push(d),!h})),{regexFree:u,regexes:c}}function hasClass$1(a,s){return a.classList===void 0||typeof s!="string"||s===""?!1:a.classList.contains(s)}function addClass$1(a,s){typeof s=="string"&&(s=s.split(" ")),s=filterEmptyClassNames(s),s.length>0&&a.classList.add(...s)}function removeClass$1(a,s){typeof s=="string"?s=s.split(" "):s instanceof RegExp&&(s=[s]);let{regexFree:c,regexes:u}=filterRegexes(s,!0);c=filterEmptyClassNames(c),c.length>0&&a.classList.remove(...c),u.forEach(d=>{a.classList.forEach(h=>{d.test(h)&&a.classList.remove(h)})})}function setAttribute(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2?arguments[2]:void 0;Array.isArray(s)||(s=[[s,c]]),s.forEach(u=>{Array.isArray(u)&&u[0]!==""&&a.setAttribute(...u)})}function removeAttribute(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof s=="string"?s=s.split(" "):s instanceof RegExp&&(s=[s]);const{regexFree:c,regexes:u}=filterRegexes(s,!0);c.forEach(d=>{d!==""&&a.removeAttribute(d)}),u.forEach(d=>{a.getAttributeNames().forEach(h=>{d.test(h)&&a.removeAttribute(h)})})}function removeTextNodes(a){if(a.nodeType===3)a.parentNode.removeChild(a);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(a.nodeName)>-1){const s=a.childNodes;for(let c=s.length-1;c>=0;c--)removeTextNodes(s[c])}}function empty(a){let s;for(;s=a.lastChild;)a.removeChild(s)}const HTML_CHARACTERS=/(<(.*)>|&(.*);)/;function fastInnerHTML(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;HTML_CHARACTERS.test(s)?a.innerHTML=c?sanitize(s):s:fastInnerText(a,s)}function fastInnerText(a,s){const c=a.firstChild;c&&c.nodeType===3&&c.nextSibling===null?c.textContent=s:(empty(a),a.appendChild(a.ownerDocument.createTextNode(s)))}function isVisible(a){const s=a.ownerDocument.documentElement,c=a.ownerDocument.defaultView;let u=a;for(;u!==s;){if(u===null)return!1;if(u.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(u.host){if(u.host.impl)return isVisible(u.host.impl);if(u.host)return isVisible(u.host);throw new Error("Lost in Web Components world")}else return!1;else if(c.getComputedStyle(u).display==="none")return!1;u=u.parentNode}return!0}function hasZeroHeight(a){const c=a.ownerDocument.defaultView;let u=a;for(;u.parentNode;){if(u.style.height==="0px"||u.style.height==="0")return c.getComputedStyle(u).overflow==="hidden";u=u.parentNode}return!1}function offset(a){const s=a.ownerDocument,c=s.defaultView,u=s.documentElement;let d=a,h,f,g;for(h=d.offsetLeft,f=d.offsetTop,g=d;(d=d.offsetParent)&&!(d===s.body||!("offsetLeft"in d));)h+=d.offsetLeft,f+=d.offsetTop,g=d;return g&&g.style.position==="fixed"&&(h+=c.pageXOffset||u.scrollLeft,f+=c.pageYOffset||u.scrollTop),{left:h,top:f}}function getWindowScrollTop(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function getWindowScrollLeft(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function getScrollTop(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return a===s?getWindowScrollTop(s):a.scrollTop}function getScrollLeft(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return a===s?getWindowScrollLeft(s):a.scrollLeft}function getScrollableElement(a){let s=a.ownerDocument,c=s?s.defaultView:void 0;s||(s=a.document?a.document:a,c=s.defaultView);const u=["auto","scroll"];let d=a.parentNode;for(;d&&d.style&&s.body!==d;){let{overflow:h,overflowX:f,overflowY:g}=d.style;if([h,f,g].includes("scroll"))return d;if({overflow:h,overflowX:f,overflowY:g}=c.getComputedStyle(d),u.includes(h)||u.includes(f)||u.includes(g)||d.clientHeight<=d.scrollHeight+1&&(u.includes(g)||u.includes(h))||d.clientWidth<=d.scrollWidth+1&&(u.includes(f)||u.includes(h)))return d;d=d.parentNode}return c}function getMaximumScrollTop(a){return a.scrollHeight-a.clientHeight}function getMaximumScrollLeft(a){return a.scrollWidth-a.clientWidth}function getTrimmingContainer(a){const s=a.ownerDocument,c=s.defaultView;let u=a.parentNode;for(;u&&u.style&&s.body!==u;){if(u.style.overflow!=="visible"&&u.style.overflow!=="")return u;const d=c.getComputedStyle(u),h=["scroll","hidden","auto"],f=d.getPropertyValue("overflow"),g=d.getPropertyValue("overflow-y"),m=d.getPropertyValue("overflow-x");if(h.includes(f)||h.includes(g)||h.includes(m))return u;u=u.parentNode}return c}function getStyle(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(a){if(a===c)return s==="width"?`${c.innerWidth}px`:s==="height"?`${c.innerHeight}px`:void 0}else return;const u=a.style[s];if(u!==""&&u!==void 0)return u;const d=c.getComputedStyle(a);if(d[s]!==""&&d[s]!==void 0)return d[s]}function outerWidth(a){return a.offsetWidth}function outerHeight(a){return a.getBoundingClientRect().height}function innerHeight$1(a){return a.clientHeight||a.innerHeight}function innerWidth$1(a){return a.clientWidth||a.innerWidth}function getCaretPosition(a){return a.selectionStart?a.selectionStart:0}function getSelectionEndPosition(a){return a.selectionEnd?a.selectionEnd:0}function clearTextSelection(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;a.getSelection&&(a.getSelection().empty?a.getSelection().empty():a.getSelection().removeAllRanges&&a.getSelection().removeAllRanges())}function setCaretPosition(a,s,c){if(c===void 0&&(c=s),a.setSelectionRange){a.focus();try{a.setSelectionRange(s,c)}catch{const d=a.parentNode,h=d.style.display;d.style.display="block",a.setSelectionRange(s,c),d.style.display=h}}}let cachedScrollbarWidth;function getFractionalScalingCompensation(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return isWindowsOS()?Number.isInteger(a.defaultView.devicePixelRatio||1)?0:2:0}function walkontableCalculateScrollbarWidth(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const s=a.createElement("div");s.style.height="200px",s.style.width="100%";const c=a.createElement("div");isSafari()&&!isMobileBrowser()&&!isIpadOS()&&c.classList.add("htScrollbarSafariTest"),c.style.boxSizing="content-box",c.style.height="150px",c.style.left="0px",c.style.overflow="hidden",c.style.position="absolute",c.style.top="0px",c.style.width="200px",c.style.visibility="hidden",c.appendChild(s),(a.body||a.documentElement).appendChild(c);const u=s.getBoundingClientRect().width;c.style.overflow="scroll";let d=s.getBoundingClientRect().width;return u===d&&(d=c.clientWidth),(a.body||a.documentElement).removeChild(c),parseFloat((u-d).toFixed(3))}function getScrollbarWidth(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return cachedScrollbarWidth===void 0&&(cachedScrollbarWidth=walkontableCalculateScrollbarWidth(a)),cachedScrollbarWidth}function hasVerticalScrollbar(a){return a instanceof Window?a.document.body.scrollHeight>a.innerHeight:a.offsetWidth!==a.clientWidth}function hasHorizontalScrollbar(a){return a instanceof Window?a.document.body.scrollWidth>a.innerWidth:a.offsetHeight!==a.clientHeight}function setOverlayPosition(a,s,c){a.style.transform=`translate3d(${s},${c},0)`}function resetCssTransform(a){a.style.transform&&a.style.transform!==""&&(a.style.transform="")}function isInput(a){return a&&(["INPUT","SELECT","TEXTAREA"].indexOf(a.nodeName)>-1||a.contentEditable==="true")}function isOutsideInput(a){return isInput(a)&&a.hasAttribute("data-hot-input")===!1}function isDetached(a){return!a.parentNode}function observeVisibilityChangeOnce(a,s){new IntersectionObserver((u,d)=>{u.forEach(h=>{h.isIntersecting&&a.offsetParent!==null&&(s(),d.unobserve(a))})},{root:a.ownerDocument.body}).observe(a)}function makeElementContentEditableAndSelectItsContent(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const u=a.ownerDocument,d=u.createRange(),h=u.defaultView.getSelection();setAttribute(a,"contenteditable",!0),c&&setAttribute(a,...A11Y_HIDDEN()),s&&addClass$1(a,"invisibleSelection"),d.selectNodeContents(a),h.removeAllRanges(),h.addRange(d)}function removeContentEditableFromElementAndDeselect(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const c=a.ownerDocument.defaultView.getSelection();a.hasAttribute("aria-hidden")&&a.removeAttribute("aria-hidden"),c.removeAllRanges(),s&&removeClass$1(a,"invisibleSelection"),a.removeAttribute("contenteditable")}function runWithSelectedContendEditableElement(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;makeElementContentEditableAndSelectItsContent(a,c),s(),removeContentEditableFromElementAndDeselect(a,c)}function isHTMLElement(a){var s;const c=a==null||(s=a.ownerDocument)===null||s===void 0?void 0:s.defaultView.Element;return!!(c&&c!==null&&a instanceof c)}function isFunction(a){return typeof a=="function"}function debounce(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,c=null,u;function d(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return c&&clearTimeout(c),c=setTimeout(()=>{u=a.apply(this,f)},s),u}return d}function partial(a){for(var s=arguments.length,c=new Array(s>1?s-1:0),u=1;u<s;u++)c[u-1]=arguments[u];return function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return a.apply(this,c.concat(f))}}function curry(a){const s=a.length;function c(u){return function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];const m=u.concat(f);let p;return m.length>=s?p=a.apply(this,m):p=c(m),p}}return c([])}function fastCall(a,s,c,u,d,h,f,g){return isDefined(g)?a.call(s,c,u,d,h,f,g):isDefined(f)?a.call(s,c,u,d,h,f):isDefined(h)?a.call(s,c,u,d,h):isDefined(d)?a.call(s,c,u,d):isDefined(u)?a.call(s,c,u):isDefined(c)?a.call(s,c):a.call(s)}const KEY_CODES={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:isFirefox()?182:174,AUDIO_MUTE:isFirefox()?181:173,AUDIO_UP:isFirefox()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},FUNCTION_KEYS=[KEY_CODES.ALT,KEY_CODES.ARROW_DOWN,KEY_CODES.ARROW_LEFT,KEY_CODES.ARROW_RIGHT,KEY_CODES.ARROW_UP,KEY_CODES.AUDIO_DOWN,KEY_CODES.AUDIO_MUTE,KEY_CODES.AUDIO_UP,KEY_CODES.BACKSPACE,KEY_CODES.CAPS_LOCK,KEY_CODES.DELETE,KEY_CODES.END,KEY_CODES.ENTER,KEY_CODES.ESCAPE,KEY_CODES.F1,KEY_CODES.F2,KEY_CODES.F3,KEY_CODES.F4,KEY_CODES.F5,KEY_CODES.F6,KEY_CODES.F7,KEY_CODES.F8,KEY_CODES.F9,KEY_CODES.F10,KEY_CODES.F11,KEY_CODES.F12,KEY_CODES.F13,KEY_CODES.F14,KEY_CODES.F15,KEY_CODES.F16,KEY_CODES.F17,KEY_CODES.F18,KEY_CODES.F19,KEY_CODES.HOME,KEY_CODES.INSERT,KEY_CODES.MEDIA_NEXT,KEY_CODES.MEDIA_PLAY_PAUSE,KEY_CODES.MEDIA_PREV,KEY_CODES.MEDIA_STOP,KEY_CODES.NULL,KEY_CODES.NUM_LOCK,KEY_CODES.PAGE_DOWN,KEY_CODES.PAGE_UP,KEY_CODES.PAUSE,KEY_CODES.SCROLL_LOCK,KEY_CODES.SHIFT,KEY_CODES.TAB];function isPrintableChar(a){return a===32||a>=48&&a<=57||a>=96&&a<=111||a>=186&&a<=192||a>=219&&a<=222||a>=226||a>=65&&a<=90}function isFunctionKey(a){return FUNCTION_KEYS.includes(a)}function isCtrlMetaKey(a){return[KEY_CODES.CONTROL,KEY_CODES.COMMAND_LEFT,KEY_CODES.COMMAND_RIGHT,KEY_CODES.COMMAND_FIREFOX].includes(a)}function isKey(a,s){const c=s.split("|");let u=!1;return arrayEach(c,d=>{if(a===KEY_CODES[d])return u=!0,!1}),u}function stopImmediatePropagation(a){a.isImmediatePropagationEnabled=!1,a.cancelBubble=!0}function isImmediatePropagationStopped(a){return a.isImmediatePropagationEnabled===!1}function isRightClick(a){return a.button===2}function isLeftClick(a){return a.button===0}function isTouchEvent(a){return typeof TouchEvent<"u"&&a instanceof TouchEvent}function offsetRelativeTo(a,s){const c={x:a.offsetX,y:a.offsetY};let u=a.target;if(!isHTMLElement(s)||u!==s&&u.contains(s))return c;for(;u!==s;)c.x+=u.offsetLeft,c.y+=u.offsetTop,u=u.offsetParent;return c}function warn$1(){isDefined(console)&&console.warn(...arguments)}function deprecatedWarn(a){isDefined(console)&&console.warn(`Deprecated: ${a}`)}function error(){isDefined(console)&&console.error(...arguments)}const REGISTERED_HOOKS=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceCacheUpdate","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceCacheUpdate","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","beforeEmptyDataStateShow","afterEmptyDataStateShow","beforeEmptyDataStateHide","afterEmptyDataStateHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],REMOVED_HOOKS=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),DEPRECATED_HOOKS=new Map([[]]);var es_array_toSorted={},arrayFromConstructorAndList,hasRequiredArrayFromConstructorAndList;function requireArrayFromConstructorAndList(){if(hasRequiredArrayFromConstructorAndList)return arrayFromConstructorAndList;hasRequiredArrayFromConstructorAndList=1;var a=requireLengthOfArrayLike();return arrayFromConstructorAndList=function(s,c,u){for(var d=0,h=arguments.length>2?u:a(c),f=new s(h);h>d;)f[d]=c[d++];return f},arrayFromConstructorAndList}var getBuiltInPrototypeMethod,hasRequiredGetBuiltInPrototypeMethod;function requireGetBuiltInPrototypeMethod(){if(hasRequiredGetBuiltInPrototypeMethod)return getBuiltInPrototypeMethod;hasRequiredGetBuiltInPrototypeMethod=1;var a=requireGlobalThis();return getBuiltInPrototypeMethod=function(s,c){var u=a[s],d=u&&u.prototype;return d&&d[c]},getBuiltInPrototypeMethod}var addToUnscopables,hasRequiredAddToUnscopables;function requireAddToUnscopables(){if(hasRequiredAddToUnscopables)return addToUnscopables;hasRequiredAddToUnscopables=1;var a=requireWellKnownSymbol(),s=requireObjectCreate(),c=requireObjectDefineProperty().f,u=a("unscopables"),d=Array.prototype;return d[u]===void 0&&c(d,u,{configurable:!0,value:s(null)}),addToUnscopables=function(h){d[u][h]=!0},addToUnscopables}var hasRequiredEs_array_toSorted;function requireEs_array_toSorted(){if(hasRequiredEs_array_toSorted)return es_array_toSorted;hasRequiredEs_array_toSorted=1;var a=require_export(),s=requireFunctionUncurryThis(),c=requireACallable(),u=requireToIndexedObject(),d=requireArrayFromConstructorAndList(),h=requireGetBuiltInPrototypeMethod(),f=requireAddToUnscopables(),g=Array,m=s(h("Array","sort"));return a({target:"Array",proto:!0},{toSorted:function(v){v!==void 0&&c(v);var w=u(this),E=d(g,w);return m(E,v)}}),f("toSorted"),es_array_toSorted}requireEs_array_toSorted();var esnext_iterator_find={},es_iterator_find={},hasRequiredEs_iterator_find;function requireEs_iterator_find(){if(hasRequiredEs_iterator_find)return es_iterator_find;hasRequiredEs_iterator_find=1;var a=require_export(),s=requireFunctionCall(),c=requireIterate(),u=requireACallable(),d=requireAnObject(),h=requireGetIteratorDirect(),f=requireIteratorClose(),g=requireIteratorHelperWithoutClosingOnEarlyError(),m=g("find",TypeError);return a({target:"Iterator",proto:!0,real:!0,forced:m},{find:function(v){d(this);try{u(v)}catch(C){f(this,"throw",C)}if(m)return s(m,this,v);var w=h(this),E=0;return c(w,function(C,b){if(v(C,E++))return b(C)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),es_iterator_find}var hasRequiredEsnext_iterator_find;function requireEsnext_iterator_find(){return hasRequiredEsnext_iterator_find||(hasRequiredEsnext_iterator_find=1,requireEs_iterator_find()),esnext_iterator_find}requireEsnext_iterator_find();function _classPrivateMethodInitSpec$$(a,s){_checkPrivateRedeclaration$1l(a,s),s.add(a)}function _classPrivateFieldInitSpec$$(a,s,c){_checkPrivateRedeclaration$1l(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1l(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$Y(a,s,c){return a.set(_assertClassBrand$1l(a,s),c),c}function _classPrivateFieldGet$$(a,s){return a.get(_assertClassBrand$1l(a,s))}function _assertClassBrand$1l(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const MAX_SKIPPED_HOOKS_COUNT=100;var _hooks$1=new WeakMap,_skippedHooksCount=new WeakMap,_needsSort=new WeakMap,_HooksBucket_brand=new WeakSet;class HooksBucket{constructor(){_classPrivateMethodInitSpec$$(this,_HooksBucket_brand),_classPrivateFieldInitSpec$$(this,_hooks$1,new Map),_classPrivateFieldInitSpec$$(this,_skippedHooksCount,new Map),_classPrivateFieldInitSpec$$(this,_needsSort,new Set),REGISTERED_HOOKS.forEach(s=>_assertClassBrand$1l(_HooksBucket_brand,this,_createHooksCollection).call(this,s))}getHooks(s){var c;return(c=_classPrivateFieldGet$$(_hooks$1,this).get(s))!==null&&c!==void 0?c:[]}add(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};_classPrivateFieldGet$$(_hooks$1,this).has(s)||(_assertClassBrand$1l(_HooksBucket_brand,this,_createHooksCollection).call(this,s),REGISTERED_HOOKS.push(s));const d=_classPrivateFieldGet$$(_hooks$1,this).get(s),h=d.find(v=>v.callback===c);if(h){h.skip===!0&&(h.skip=!1);return}const f=Number.isInteger(u.orderIndex)?u.orderIndex:0,g=!!u.runOnce,m=!!u.initialHook;let p=!1;if(m){const v=d.find(w=>w.initialHook);v&&(v.callback=c,p=!0)}if(!p){d.push({callback:c,orderIndex:f,runOnce:g,initialHook:m,skip:!1});let v=_classPrivateFieldGet$$(_needsSort,this).has(s);!v&&f!==0&&(v=!0,_classPrivateFieldGet$$(_needsSort,this).add(s)),v&&d.length>1&&_classPrivateFieldGet$$(_hooks$1,this).set(s,d.toSorted((w,E)=>w.orderIndex-E.orderIndex))}}has(s){return _classPrivateFieldGet$$(_hooks$1,this).has(s)&&_classPrivateFieldGet$$(_hooks$1,this).get(s).length>0}remove(s,c){if(!_classPrivateFieldGet$$(_hooks$1,this).has(s))return!1;const u=_classPrivateFieldGet$$(_hooks$1,this).get(s),d=u.find(h=>h.callback===c);if(d){let h=_classPrivateFieldGet$$(_skippedHooksCount,this).get(s);return d.skip=!0,h+=1,h>MAX_SKIPPED_HOOKS_COUNT&&(_classPrivateFieldGet$$(_hooks$1,this).set(s,u.filter(f=>!f.skip)),h=0),_classPrivateFieldGet$$(_skippedHooksCount,this).set(s,h),!0}return!1}destroy(){_classPrivateFieldGet$$(_hooks$1,this).clear(),_classPrivateFieldGet$$(_skippedHooksCount,this).clear(),_classPrivateFieldSet$Y(_hooks$1,this,null),_classPrivateFieldSet$Y(_skippedHooksCount,this,null)}}function _createHooksCollection(a){_classPrivateFieldGet$$(_hooks$1,this).set(a,[]),_classPrivateFieldGet$$(_skippedHooksCount,this).set(a,0)}function _defineProperty$2e(a,s,c){return(s=_toPropertyKey$2f(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2f(a){var s=_toPrimitive$2f(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2f(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const REMOVED_MESSAGE=toSingleLine`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class Hooks{constructor(){_defineProperty$2e(this,"globalBucket",new HooksBucket)}static getSingleton(){return getGlobalSingleton()}getBucket(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return s?(s.pluginHookBucket||(s.pluginHookBucket=new HooksBucket),s.pluginHookBucket):this.globalBucket}add(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,d=arguments.length>3?arguments[3]:void 0;return Array.isArray(c)?arrayEach(c,h=>this.add(s,h,u)):(REMOVED_HOOKS.has(s)&&warn$1(substitute(REMOVED_MESSAGE,{hookName:s,removedInVersion:REMOVED_HOOKS.get(s)})),DEPRECATED_HOOKS.has(s)&&warn$1(DEPRECATED_HOOKS.get(s)),this.getBucket(u).add(s,c,{orderIndex:d,runOnce:!1})),this}once(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,d=arguments.length>3?arguments[3]:void 0;return Array.isArray(c)?arrayEach(c,h=>this.once(s,h,u)):this.getBucket(u).add(s,c,{orderIndex:d,runOnce:!0}),this}addAsFixed(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(c)?arrayEach(c,d=>this.addAsFixed(s,d,u)):this.getBucket(u).add(s,c,{initialHook:!0}),this}remove(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(u).remove(s,c)}has(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(c).has(s)}run(s,c,u,d,h,f,g,m){{const p=this.getBucket().getHooks(c),v=p?p.length:0;let w=0;if(v)for(;w<v;){if(!p[w]||p[w].skip){w+=1;continue}const E=fastCall(p[w].callback,s,u,d,h,f,g,m);E!==void 0&&(u=E),p[w]&&p[w].runOnce&&this.remove(c,p[w].callback),w+=1}}{const p=this.getBucket(s).getHooks(c),v=p?p.length:0;let w=0;if(v)for(;w<v;){if(!p[w]||p[w].skip){w+=1;continue}const E=fastCall(p[w].callback,s,u,d,h,f,g,m);E!==void 0&&(u=E),p[w]&&p[w].runOnce&&this.remove(c,p[w].callback,s),w+=1}}return u}destroy(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(s).destroy()}register(s){this.isRegistered(s)||REGISTERED_HOOKS.push(s)}deregister(s){this.isRegistered(s)&&REGISTERED_HOOKS.splice(REGISTERED_HOOKS.indexOf(s),1)}isDeprecated(s){return DEPRECATED_HOOKS.has(s)||REMOVED_HOOKS.has(s)}isRegistered(s){return REGISTERED_HOOKS.indexOf(s)>=0}getRegistered(){return REGISTERED_HOOKS}}const globalSingleton=new Hooks;function getGlobalSingleton(){return globalSingleton}const collection=new Map;function staticRegister(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";collection.has(a)||collection.set(a,new Map);const s=collection.get(a);function c(m,p){s.set(m,p)}function u(m){return s.get(m)}function d(m){return s.has(m)}function h(){return[...s.keys()]}function f(){return[...s.values()]}function g(){collection.delete(a),s.clear()}return{register:c,getItem:u,hasItem:d,getNames:h,getValues:f,clear:g}}function resolveWithInstance(a,s){var c;return collection==null||(c=collection.get(a.guid))===null||c===void 0?void 0:c.get(s)}const registeredEditorClasses=new WeakMap,{register:register$4,getItem:getItem$3,hasItem:hasItem$3,getNames:getNames$3,getValues:getValues$3}=staticRegister("editors");function RegisteredEditor(a){const s={},c=a;this.getConstructor=function(){return a},this.getInstance=function(u){return u.guid in s||(s[u.guid]=new c(u)),s[u.guid]},Hooks.getSingleton().add("afterDestroy",function(){s[this.guid]=null})}function _getEditorInstance(a,s){let c;if(typeof a=="function")registeredEditorClasses.get(a)||_register$3(null,a),c=registeredEditorClasses.get(a);else if(typeof a=="string")c=getItem$3(a);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!c)throw Error(`No editor registered under name "${a}"`);return c.getInstance(s)}function _getItem$3(a){if(typeof a=="function")return a;if(!hasItem$3(a))throw Error(`No registered editor found under "${a}" name`);return getItem$3(a).getConstructor()}function _register$3(a,s){a&&typeof a!="string"&&(s=a,a=s.EDITOR_TYPE);const c=new RegisteredEditor(s);typeof a=="string"&&register$4(a,c),registeredEditorClasses.set(s,c)}function _defineProperty$2d(a,s,c){return(s=_toPropertyKey$2e(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2e(a){var s=_toPrimitive$2e(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2e(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class EventManager{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$2d(this,"context",void 0),this.context=s||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(s,c,u){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function h(f){u.call(this,extendEvent(f))}return this.context.eventListeners.push({element:s,event:c,callback:u,callbackProxy:h,options:d,eventManager:this}),s.addEventListener(c,h,d),()=>{this.removeEventListener(s,c,u)}}removeEventListener(s,c,u){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,h=this.context.eventListeners.length,f;for(;h;)if(h-=1,f=this.context.eventListeners[h],f.event===c&&f.element===s){if(u&&u!==f.callback||d&&f.eventManager!==this)continue;this.context.eventListeners.splice(h,1),f.element.removeEventListener(f.event,f.callbackProxy,f.options)}}clearEvents(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let c=this.context.eventListeners.length;for(;c;){c-=1;const u=this.context.eventListeners[c];s&&u.eventManager!==this||(this.context.eventListeners.splice(c,1),u.element.removeEventListener(u.event,u.callbackProxy,u.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(s,c){let u=s.document,d=s;u||(u=s.ownerDocument?s.ownerDocument:s,d=u.defaultView);const h={bubbles:!0,cancelable:c!=="mousemove",view:d,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let f;u.createEvent?(f=u.createEvent("MouseEvents"),f.initMouseEvent(c,h.bubbles,h.cancelable,h.view,h.detail,h.screenX,h.screenY,h.clientX,h.clientY,h.ctrlKey,h.altKey,h.shiftKey,h.metaKey,h.button,u.body.parentNode)):f=u.createEventObject(),s.dispatchEvent?s.dispatchEvent(f):s.fireEvent(`on${c}`,f)}}function extendEvent(a){const s=a.stopImmediatePropagation;return a.stopImmediatePropagation=function(){s.apply(this),stopImmediatePropagation(this)},a}function _classPrivateMethodInitSpec$_(a,s){_checkPrivateRedeclaration$1k(a,s),s.add(a)}function _checkPrivateRedeclaration$1k(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$2c(a,s,c){return(s=_toPropertyKey$2d(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2d(a){var s=_toPrimitive$2d(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2d(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$1k(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _EditorManager_brand=new WeakSet;class EditorManager{constructor(s,c,u){_classPrivateMethodInitSpec$_(this,_EditorManager_brand),_defineProperty$2c(this,"hot",void 0),_defineProperty$2c(this,"tableMeta",void 0),_defineProperty$2c(this,"selection",void 0),_defineProperty$2c(this,"eventManager",void 0),_defineProperty$2c(this,"destroyed",!1),_defineProperty$2c(this,"activeEditor",void 0),_defineProperty$2c(this,"cellProperties",void 0),this.hot=s,this.tableMeta=c,this.selection=u,this.eventManager=new EventManager(s),this.hot.addHook("afterDocumentKeyDown",d=>_assertClassBrand$1k(_EditorManager_brand,this,_onAfterDocumentKeyDown$1).call(this,d)),this.hot.addHook("beforeCompositionStart",d=>_assertClassBrand$1k(_EditorManager_brand,this,_onAfterDocumentKeyDown$1).call(this,d)),this.hot.view._wt.update("onCellDblClick",(d,h,f)=>_assertClassBrand$1k(_EditorManager_brand,this,_onCellDblClick).call(this,d,h,f))}getActiveEditor(){return this.activeEditor}prepareEditor(){var s;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,p=>{p&&this.prepareEditor()});return}const c=(s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;if(!c||c.isHeader())return;const{row:u,col:d}=c,h=this.hot.runHooks("modifyGetCellCoords",u,d,!1,"meta");let f=u,g=d;if(Array.isArray(h)&&([f,g]=h),this.cellProperties=this.hot.getCellMeta(f,g),!this.isCellEditable()){this.clearActiveEditor();return}const m=this.hot.getCell(u,d,!0);if(m){const p=this.hot.getCellEditor(this.cellProperties),v=this.hot.colToProp(g),w=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(f),g);this.activeEditor=_getEditorInstance(p,this.hot),this.activeEditor.prepare(u,d,v,m,w,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const d=this.hot.getSelectedRangeActive();let h=this.hot.runHooks("beforeBeginEditing",d.highlight.row,d.highlight.col,s,c,u);if(c instanceof MouseEvent&&typeof h!="boolean"&&(h=this.hot.selection.getLayerLevel()===0&&d.isSingle()),h===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(u&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(s,c))}closeEditor(s,c,u){this.activeEditor?this.activeEditor.finishEditing(s,c,u):u&&u(!1)}closeEditorAndSaveChanges(s){this.closeEditor(!1,s)}closeEditorAndRestoreOriginalValue(s){this.closeEditor(!0,s)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const s=this.hot.getSelectedRangeActive();if(!s)return!1;const c=this.hot.getCellEditor(this.cellProperties),{row:u,col:d}=s.highlight,{rowIndexMapper:h,columnIndexMapper:f}=this.hot,g=h.isHidden(this.hot.toPhysicalRow(u))||f.isHidden(this.hot.toPhysicalColumn(d));return!(this.cellProperties.readOnly||!c||g)}moveSelectionAfterEnter(s){const c={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(s):this.tableMeta.enterMoves};s.shiftKey&&(c.row=-c.row,c.col=-c.col),this.hot.selection.isMultiple()?this.selection.transformFocus(c.row,c.col):this.selection.transformStart(c.row,c.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function _onAfterDocumentKeyDown$1(a){const s=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!s||s.highlight.isHeader()||isImmediatePropagationStopped(a))return;const{keyCode:c}=a,u=(a.ctrlKey||a.metaKey)&&!a.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!isFunctionKey(c)&&!isCtrlMetaKey(c)&&!u&&!this.isEditorOpened()&&this.openEditor("",a)}function _onCellDblClick(a,s){s.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,a,!0))}const instances=new WeakMap;EditorManager.getInstance=function(a,s,c){let u=instances.get(a);return u||(u=new EditorManager(a,s,c),instances.set(a,u)),u};var es_string_replaceAll={},isRegexp,hasRequiredIsRegexp;function requireIsRegexp(){if(hasRequiredIsRegexp)return isRegexp;hasRequiredIsRegexp=1;var a=requireIsObject(),s=requireClassofRaw(),c=requireWellKnownSymbol(),u=c("match");return isRegexp=function(d){var h;return a(d)&&((h=d[u])!==void 0?!!h:s(d)==="RegExp")},isRegexp}var regexpFlagsDetection,hasRequiredRegexpFlagsDetection;function requireRegexpFlagsDetection(){if(hasRequiredRegexpFlagsDetection)return regexpFlagsDetection;hasRequiredRegexpFlagsDetection=1;var a=requireGlobalThis(),s=requireFails(),c=a.RegExp,u=!s(function(){var d=!0;try{c(".","d")}catch{d=!1}var h={},f="",g=d?"dgimsy":"gimsy",m=function(E,C){Object.defineProperty(h,E,{get:function(){return f+=C,!0}})},p={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};d&&(p.hasIndices="d");for(var v in p)m(v,p[v]);var w=Object.getOwnPropertyDescriptor(c.prototype,"flags").get.call(h);return w!==g||f!==g});return regexpFlagsDetection={correct:u},regexpFlagsDetection}var regexpFlags,hasRequiredRegexpFlags;function requireRegexpFlags(){if(hasRequiredRegexpFlags)return regexpFlags;hasRequiredRegexpFlags=1;var a=requireAnObject();return regexpFlags=function(){var s=a(this),c="";return s.hasIndices&&(c+="d"),s.global&&(c+="g"),s.ignoreCase&&(c+="i"),s.multiline&&(c+="m"),s.dotAll&&(c+="s"),s.unicode&&(c+="u"),s.unicodeSets&&(c+="v"),s.sticky&&(c+="y"),c},regexpFlags}var regexpGetFlags,hasRequiredRegexpGetFlags;function requireRegexpGetFlags(){if(hasRequiredRegexpGetFlags)return regexpGetFlags;hasRequiredRegexpGetFlags=1;var a=requireFunctionCall(),s=requireHasOwnProperty(),c=requireObjectIsPrototypeOf(),u=requireRegexpFlagsDetection(),d=requireRegexpFlags(),h=RegExp.prototype;return regexpGetFlags=u.correct?function(f){return f.flags}:function(f){return!u.correct&&c(h,f)&&!s(f,"flags")?a(d,f):f.flags},regexpGetFlags}var getSubstitution,hasRequiredGetSubstitution;function requireGetSubstitution(){if(hasRequiredGetSubstitution)return getSubstitution;hasRequiredGetSubstitution=1;var a=requireFunctionUncurryThis(),s=requireToObject(),c=Math.floor,u=a("".charAt),d=a("".replace),h=a("".slice),f=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,g=/\$([$&'`]|\d{1,2})/g;return getSubstitution=function(m,p,v,w,E,C){var b=v+m.length,P=w.length,R=g;return E!==void 0&&(E=s(E),R=f),d(C,R,function(T,I){var M;switch(u(I,0)){case"$":return"$";case"&":return m;case"`":return h(p,0,v);case"'":return h(p,b);case"<":M=E[h(I,1,-1)];break;default:var N=+I;if(N===0)return T;if(N>P){var H=c(N/10);return H===0?T:H<=P?w[H-1]===void 0?u(I,1):w[H-1]+u(I,1):T}M=w[N-1]}return M===void 0?"":M})},getSubstitution}var hasRequiredEs_string_replaceAll;function requireEs_string_replaceAll(){if(hasRequiredEs_string_replaceAll)return es_string_replaceAll;hasRequiredEs_string_replaceAll=1;var a=require_export(),s=requireFunctionCall(),c=requireFunctionUncurryThis(),u=requireRequireObjectCoercible(),d=requireIsCallable(),h=requireIsObject(),f=requireIsRegexp(),g=requireToString(),m=requireGetMethod(),p=requireRegexpGetFlags(),v=requireGetSubstitution(),w=requireWellKnownSymbol(),E=requireIsPure(),C=w("replace"),b=TypeError,P=c("".indexOf),R=c("".replace),T=c("".slice),I=Math.max;return a({target:"String",proto:!0},{replaceAll:function(N,H){var L=u(this),A,k,W,G,oe,ae,X,le,ye,pe,he=0,Me="";if(h(N)){if(A=f(N),A&&(k=g(u(p(N))),!~P(k,"g")))throw new b("`.replaceAll` does not allow non-global regexes");if(W=m(N,C),W)return s(W,N,L,H);if(E&&A)return R(g(L),N,H)}for(G=g(L),oe=g(N),ae=d(H),ae||(H=g(H)),X=oe.length,le=I(1,X),ye=P(G,oe);ye!==-1;)pe=ae?g(H(oe,ye,G)):v(oe,G,ye,[],void 0,H),Me+=T(G,he,ye)+pe,he=ye+X,ye=ye+le>G.length?-1:P(G,oe,ye+le);return he<G.length&&(Me+=T(G,he)),Me}}),es_string_replaceAll}requireEs_string_replaceAll();const ESCAPED_HTML_CHARS={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},regEscapedChars=new RegExp(Object.keys(ESCAPED_HTML_CHARS).map(a=>`(${a})`).join("|"),"gi");function isHTMLTable(a){return(a&&a.nodeName||"")==="TABLE"}function instanceToHTML(a){const s=a.hasColHeaders(),c=a.hasRowHeaders(),u=[s?-1:0,c?-1:0,a.countRows()-1,a.countCols()-1],d=a.getData(...u),h=d.length,f=h>0?d[0].length:0,g=["<table>","</table>"],m=s?["<thead>","</thead>"]:[],p=["<tbody>","</tbody>"],v=c?1:0,w=s?1:0;for(let E=0;E<h;E+=1){const C=s&&E===0,b=[];for(let R=0;R<f;R+=1){const T=!C&&c&&R===0;let I="";if(C)I=`<th>${a.getColHeader(R-v)}</th>`;else if(T)I=`<th>${a.getRowHeader(E-w)}</th>`;else{const M=d[E][R],{hidden:N,rowspan:H,colspan:L}=a.getCellMeta(E-w,R-v);if(!N){const A=[];if(H&&A.push(`rowspan="${H}"`),L&&A.push(`colspan="${L}"`),isEmpty(M))I=`<td ${A.join(" ")}></td>`;else{const k=M.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");I=`<td ${A.join(" ")}>${k}</td>`}}}b.push(I)}const P=["<tr>",...b,"</tr>"].join("");C?m.splice(1,0,P):p.splice(-1,0,P)}return g.splice(1,0,m.join(""),p.join("")),g.join("")}function _dataToHTML(a){const s=a.length,c=["<table>"];for(let u=0;u<s;u+=1){const d=a[u],h=d.length,f=[];u===0&&c.push("<tbody>");for(let g=0;g<h;g+=1){const m=d[g],p=isEmpty(m)?"":m.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,v=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(v.length-1)} </span>`).replace(/\t/gi,"&#9;");f.push(`<td>${p}</td>`)}c.push("<tr>",...f,"</tr>"),u+1===s&&c.push("</tbody>")}return c.push("</table>"),c.join("")}function htmlToGridSettings(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const c={},u=s.createDocumentFragment(),d=s.createElement("div");u.appendChild(d);let h=a;if(typeof h=="string"){const M=h.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,N=>{const H=N.match(/<td\b[^>]*?>/g)[0],L=/<p.*?>/g,A=N.substring(H.length,N.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(L,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${H}${A}</td>`});d.insertAdjacentHTML("afterbegin",`${M}`),h=d.querySelector("table")}if(!h||!isHTMLTable(h))return;const f=d.querySelector('meta[name$="enerator"]'),g=h.querySelector("tbody th")!==null,m=h.querySelector("tr"),p=m?Array.from(m.cells).reduce((M,N)=>M+N.colSpan,0)-(g?1:0):0,v=h.tFoot&&Array.from(h.tFoot.rows)||[],w=[];let E=!1,C=0,b=0;if(h.tHead){const M=Array.from(h.tHead.rows).filter(N=>{const H=N.querySelector("td")!==null;return H&&w.push(N),!H});C=M.length,E=C>0,C>1?c.nestedHeaders=Array.from(M).reduce((N,H)=>{const L=Array.from(H.cells).reduce((A,k,W)=>{if(g&&W===0)return A;const{colSpan:G,innerHTML:oe}=k,ae=G>1?{label:oe,colspan:G}:oe;return A.push(ae),A},[]);return N.push(L),N},[]):E&&(c.colHeaders=Array.from(M[0].children).reduce((N,H,L)=>(g&&L===0||N.push(H.innerHTML),N),[]))}w.length&&(c.fixedRowsTop=w.length),v.length&&(c.fixedRowsBottom=v.length);const P=[...w,...Array.from(h.tBodies).reduce((M,N)=>(M.push(...Array.from(N.rows)),M),[]),...v];b=P.length;const R=new Array(b);for(let M=0;M<b;M++)R[M]=new Array(p);const T=[],I=[];for(let M=0;M<b;M++){const N=P[M],H=Array.from(N.cells),L=H.length;for(let A=0;A<L;A++){const k=H[A],{nodeName:W,innerHTML:G,rowSpan:oe,colSpan:ae}=k,X=R[M].findIndex(le=>le===void 0);if(W==="TD"){if(oe>1||ae>1){for(let he=M;he<M+oe;he++)if(he<b)for(let Me=X;Me<X+ae;Me++)R[he][Me]=null;const ye=k.getAttribute("style");ye&&ye.includes("mso-ignore:colspan")||T.push({col:X,row:M,rowspan:oe,colspan:ae})}let le="";f&&/excel/gi.test(f.content)?le=G.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):le=G.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),R[M][X]=le.replace(regEscapedChars,ye=>ESCAPED_HTML_CHARS[ye])}else I.push(G)}}return T.length&&(c.mergeCells=T),I.length&&(c.rowHeaders=I),R.length&&(c.data=R),c}function isNumeric(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const c=typeof a;if(c==="number")return!isNaN(a)&&isFinite(a);if(c==="string"){if(a.length===0)return!1;if(a.length===1)return/\d/.test(a);const u=Array.from(new Set([".",...s])).map(d=>`\\${d}`).join("|");return new RegExp(`^[+-]?(((${u})?\\d+((${u})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(a.trim())}else if(c==="object")return!!a&&typeof a.valueOf()=="number"&&!(a instanceof Date);return!1}function isNumericLike(a){return isNumeric(a,[","])}function rangeEach(a,s,c){let u=-1;for(typeof s=="function"?(c=s,s=a):u=a-1;++u<=s&&c(u)!==!1;);}function rangeEachReverse(a,s,c){let u=a+1;for(typeof s=="function"&&(c=s,s=0);--u>=s&&c(u)!==!1;);}function valueAccordingPercent(a,s){return s=parseInt(s.toString().replace("%",""),10),s=isNaN(s)?0:s,parseInt(a*s/100,10)}function clamp(a,s,c){return Math.min(a,s)===a?s:Math.max(a,c)===a?c:a}function getParsedNumber(a){const s=a.replace(",",".");return isNaN(parseFloat(s))===!1?parseFloat(s):null}function isUnsignedNumber(a){return Number.isInteger(a)&&a>=0}const ASC="asc",DESC="desc",ORDER_MAP=new Map([[ASC,[-1,1]],[DESC,[1,-1]]]),DEFAULT_ERROR_PRIORITY_EXISTS=a=>`The priority '${a}' is already declared in a map.`,DEFAULT_ERROR_PRIORITY_NAN=a=>`The priority '${a}' is not a number.`;function createPriorityMap(){let{errorPriorityExists:a,errorPriorityNaN:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const c=new Map;a=isFunction(a)?a:DEFAULT_ERROR_PRIORITY_EXISTS,s=isFunction(s)?s:DEFAULT_ERROR_PRIORITY_NAN;function u(h,f){if(!isNumeric(h))throw new Error(s(h));if(c.has(h))throw new Error(a(h));c.set(h,f)}function d(){let h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ASC;const[f,g]=ORDER_MAP.get(h)||ORDER_MAP.get(ASC);return[...c].sort((m,p)=>m[0]<p[0]?f:g).map(m=>m[1])}return{addItem:u,getItems:d}}const DEFAULT_ERROR_ID_EXISTS=a=>`The id '${a}' is already declared in a map.`;function createUniqueMap(){let{errorIdExists:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=new Map;a=isFunction(a)?a:DEFAULT_ERROR_ID_EXISTS;function c(v,w){if(p(v))throw new Error(a(v));s.set(v,w)}function u(v){return s.delete(v)}function d(){s.clear()}function h(v){const[w]=g().find(E=>{let[C,b]=E;return v===b?C:!1})||[null];return w}function f(v){return s.get(v)}function g(){return[...s]}function m(){return[...s.values()]}function p(v){return s.has(v)}return{addItem:c,clear:d,getId:h,getItem:f,getItems:g,getValues:m,hasItem:p,removeItem:u}}const DEFAULT_ERROR_ITEM_EXISTS=a=>`'${a}' value is already declared in a unique set.`;function createUniqueSet(){let{errorItemExists:a}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const s=new Set;a=isFunction(a)?a:DEFAULT_ERROR_ITEM_EXISTS;function c(h){if(s.has(h))throw new Error(a(h));s.add(h)}function u(){return[...s]}function d(){s.clear()}return{addItem:c,clear:d,getItems:u}}const ERROR_PLUGIN_REGISTERED=a=>`There is already registered "${a}" plugin.`,ERROR_PRIORITY_REGISTERED=a=>`There is already registered plugin on priority "${a}".`,ERROR_PRIORITY_NAN=a=>`The priority "${a}" is not a number.`,priorityPluginsQueue=createPriorityMap({errorPriorityExists:ERROR_PRIORITY_REGISTERED,errorPriorityNaN:ERROR_PRIORITY_NAN}),uniquePluginsQueue=createUniqueSet({errorItemExists:ERROR_PLUGIN_REGISTERED}),uniquePluginsList=createUniqueMap({errorIdExists:ERROR_PLUGIN_REGISTERED});function getPluginsNames(){return[...priorityPluginsQueue.getItems(),...uniquePluginsQueue.getItems()]}function getPlugin(a){const s=toUpperCaseFirst(a);return uniquePluginsList.getItem(s)}function hasPlugin(a){return!!getPlugin(a)}function registerPlugin(a,s,c){[a,s,c]=unifyPluginArguments(a,s,c),getPlugin(a)===void 0&&_registerPlugin(a,s,c)}function _registerPlugin(a,s,c){const u=toUpperCaseFirst(a);if(uniquePluginsList.hasItem(u))throw new Error(ERROR_PLUGIN_REGISTERED(u));c===void 0?uniquePluginsQueue.addItem(u):priorityPluginsQueue.addItem(c,u),uniquePluginsList.addItem(u,s)}function unifyPluginArguments(a,s,c){return typeof a=="function"&&(s=a,a=s.PLUGIN_KEY,c=s.PLUGIN_PRIORITY),[a,s,c]}const{register:register$3,getItem:getItem$2,hasItem:hasItem$2,getNames:getNames$2,getValues:getValues$2}=staticRegister("renderers");function _getItem$2(a){if(typeof a=="function")return a;if(!hasItem$2(a))throw Error(`No registered renderer found under "${a}" name`);return getItem$2(a)}function _register$2(a,s){typeof a!="string"&&(s=a,a=s.RENDERER_TYPE),register$3(a,s)}const{register:register$2,getItem:getItem$1,hasItem:hasItem$1,getNames:getNames$1,getValues:getValues$1}=staticRegister("validators");function _getItem$1(a){if(typeof a=="function")return a;if(!hasItem$1(a))throw Error(`No registered validator found under "${a}" name`);return getItem$1(a)}function _register$1(a,s){typeof a!="string"&&(s=a,a=s.VALIDATOR_TYPE),register$2(a,s)}var es_array_at={},hasRequiredEs_array_at;function requireEs_array_at(){if(hasRequiredEs_array_at)return es_array_at;hasRequiredEs_array_at=1;var a=require_export(),s=requireToObject(),c=requireLengthOfArrayLike(),u=requireToIntegerOrInfinity(),d=requireAddToUnscopables();return a({target:"Array",proto:!0},{at:function(f){var g=s(this),m=c(g),p=u(f),v=p>=0?p:m+p;return v<0||v>=m?void 0:g[v]}}),d("at"),es_array_at}requireEs_array_at();var es_string_atAlternative={},hasRequiredEs_string_atAlternative;function requireEs_string_atAlternative(){if(hasRequiredEs_string_atAlternative)return es_string_atAlternative;hasRequiredEs_string_atAlternative=1;var a=require_export(),s=requireFunctionUncurryThis(),c=requireRequireObjectCoercible(),u=requireToIntegerOrInfinity(),d=requireToString(),h=requireFails(),f=s("".charAt),g=h(function(){return"𠮷".at(-2)!=="\uD842"});return a({target:"String",proto:!0,forced:g},{at:function(p){var v=d(c(this)),w=v.length,E=u(p),C=E>=0?E:w+E;return C<0||C>=w?void 0:f(v,C)}}),es_string_atAlternative}requireEs_string_atAlternative();function _defineProperty$2b(a,s,c){return(s=_toPropertyKey$2c(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2c(a){var s=_toPrimitive$2c(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2c(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class FullyVisibleColumnsCalculationType{constructor(){_defineProperty$2b(this,"count",0),_defineProperty$2b(this,"startColumn",null),_defineProperty$2b(this,"endColumn",null),_defineProperty$2b(this,"startPosition",null),_defineProperty$2b(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(s,c){const{totalCalculatedWidth:u,zeroBasedScrollOffset:d,viewportWidth:h,columnWidth:f}=c,g=d>0?h+1:h;u>=d&&u+f<=d+g&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=s),this.endColumn=s)}finalize(s){var c;const{scrollOffset:u,viewportWidth:d,inlineStartOffset:h,zeroBasedScrollOffset:f,totalColumns:g,needReverse:m,startPositions:p,columnWidth:v}=s;if(this.endColumn===g-1&&m)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=p[this.endColumn]+v-p[this.startColumn-1];if(b<=d&&(this.startColumn-=1),b>=d)break}this.startPosition=(c=p[this.startColumn])!==null&&c!==void 0?c:null;const w=f>0?d+1:d,E=u+d-w,C=this.startColumn===null?0:s.getColumnWidth(this.startColumn);E<-1*h||u>p.at(-1)||-1*u-d>-1*C?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,g<this.endColumn&&(this.endColumn=g-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$2a(a,s,c){return(s=_toPropertyKey$2b(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2b(a){var s=_toPrimitive$2b(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2b(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class FullyVisibleRowsCalculationType{constructor(){_defineProperty$2a(this,"count",0),_defineProperty$2a(this,"startRow",null),_defineProperty$2a(this,"endRow",null),_defineProperty$2a(this,"startPosition",null),_defineProperty$2a(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(s,c){const{totalCalculatedHeight:u,zeroBasedScrollOffset:d,innerViewportHeight:h,rowHeight:f}=c;u>=d&&u+f<=h&&(this.startRow===null&&(this.startRow=s),this.endRow=s)}finalize(s){var c;const{scrollOffset:u,viewportHeight:d,horizontalScrollbarHeight:h,totalRows:f,needReverse:g,startPositions:m,rowHeight:p}=s;if(this.endRow===f-1&&g)for(this.startRow=this.endRow;this.startRow>0;){const E=m[this.endRow]+p-m[this.startRow-1];if(E<=d-h&&(this.startRow-=1),E>=d-h)break}this.startPosition=(c=m[this.startRow])!==null&&c!==void 0?c:null;const v=u+d-h,w=this.startRow===null?0:s.getRowHeight(this.startRow);v<w||u>m.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,f<this.endRow&&(this.endRow=f-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$29(a,s,c){return(s=_toPropertyKey$2a(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2a(a){var s=_toPrimitive$2a(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2a(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class PartiallyVisibleColumnsCalculationType{constructor(){_defineProperty$29(this,"count",0),_defineProperty$29(this,"startColumn",null),_defineProperty$29(this,"endColumn",null),_defineProperty$29(this,"startPosition",null),_defineProperty$29(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(s,c){const{totalCalculatedWidth:u,zeroBasedScrollOffset:d,viewportWidth:h}=c;u<=d&&(this.startColumn=s);const f=d>0?h+1:h;u>=d&&u<=d+f&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=s),this.endColumn=s}finalize(s){var c;const{scrollOffset:u,viewportWidth:d,inlineStartOffset:h,zeroBasedScrollOffset:f,totalColumns:g,needReverse:m,startPositions:p,columnWidth:v}=s;if(this.endColumn===g-1&&m)for(this.startColumn=this.endColumn;this.startColumn>0;){const C=p[this.endColumn]+v-p[this.startColumn-1];if(this.startColumn-=1,C>d)break}this.startPosition=(c=p[this.startColumn])!==null&&c!==void 0?c:null;const w=f>0?d+1:d;u+d-w<-1*h||u>p.at(-1)+v||-1*u-d>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,g<this.endColumn&&(this.endColumn=g-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$28(a,s,c){return(s=_toPropertyKey$29(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$29(a){var s=_toPrimitive$29(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$29(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class PartiallyVisibleRowsCalculationType{constructor(){_defineProperty$28(this,"count",0),_defineProperty$28(this,"startRow",null),_defineProperty$28(this,"endRow",null),_defineProperty$28(this,"startPosition",null),_defineProperty$28(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(s,c){const{totalCalculatedHeight:u,zeroBasedScrollOffset:d,innerViewportHeight:h}=c;u<=d&&(this.startRow=s),u>=d&&u<=h&&this.startRow===null&&(this.startRow=s),this.endRow=s}finalize(s){var c;const{scrollOffset:u,viewportHeight:d,horizontalScrollbarHeight:h,totalRows:f,needReverse:g,startPositions:m,rowHeight:p}=s;if(this.endRow===f-1&&g)for(this.startRow=this.endRow;this.startRow>0;){const w=m[this.endRow]+p-m[this.startRow-1];if(this.startRow-=1,w>=d-h)break}this.startPosition=(c=m[this.startRow])!==null&&c!==void 0?c:null,u+d-h<0||u>m.at(-1)+p?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,f<this.endRow&&(this.endRow=f-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$27(a,s,c){return(s=_toPropertyKey$28(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$28(a){var s=_toPrimitive$28(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$28(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RenderedAllColumnsCalculationType{constructor(){_defineProperty$27(this,"count",0),_defineProperty$27(this,"startColumn",0),_defineProperty$27(this,"endColumn",0),_defineProperty$27(this,"startPosition",0),_defineProperty$27(this,"isVisibleInTrimmingContainer",!0)}initialize(s){let{totalColumns:c}=s;this.count=c,this.endColumn=this.count-1}process(){}finalize(){}}function _defineProperty$26(a,s,c){return(s=_toPropertyKey$27(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$27(a){var s=_toPrimitive$27(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$27(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RenderedAllRowsCalculationType{constructor(){_defineProperty$26(this,"count",0),_defineProperty$26(this,"startRow",0),_defineProperty$26(this,"endRow",0),_defineProperty$26(this,"startPosition",0),_defineProperty$26(this,"isVisibleInTrimmingContainer",!0)}initialize(s){let{totalRows:c}=s;this.count=c,this.endRow=this.count-1}process(){}finalize(){}}function _defineProperty$25(a,s,c){return(s=_toPropertyKey$26(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$26(a){var s=_toPrimitive$26(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$26(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RenderedColumnsCalculationType extends PartiallyVisibleColumnsCalculationType{constructor(){super(...arguments),_defineProperty$25(this,"columnStartOffset",0),_defineProperty$25(this,"columnEndOffset",0)}finalize(s){var c;super.finalize(s);const{overrideFn:u,totalColumns:d,startPositions:h}=s;if(this.startColumn!==null&&typeof u=="function"){const f=this.startColumn,g=this.endColumn;u(this),this.columnStartOffset=f-this.startColumn,this.columnEndOffset=this.endColumn-g}this.startColumn<0&&(this.startColumn=0),this.startPosition=(c=h[this.startColumn])!==null&&c!==void 0?c:null,d<this.endColumn&&(this.endColumn=d-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function _defineProperty$24(a,s,c){return(s=_toPropertyKey$25(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$25(a){var s=_toPrimitive$25(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$25(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RenderedRowsCalculationType extends PartiallyVisibleRowsCalculationType{constructor(){super(...arguments),_defineProperty$24(this,"rowStartOffset",0),_defineProperty$24(this,"rowEndOffset",0)}finalize(s){var c;super.finalize(s);const{overrideFn:u,totalRows:d,startPositions:h}=s;if(this.startRow!==null&&typeof u=="function"){const f=this.startRow,g=this.endRow;u(this),this.rowStartOffset=f-this.startRow,this.rowEndOffset=this.endRow-g}this.startRow<0&&(this.startRow=0),this.startPosition=(c=h[this.startRow])!==null&&c!==void 0?c:null,d<this.endRow&&(this.endRow=d-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function _defineProperty$23(a,s,c){return(s=_toPropertyKey$24(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$24(a){var s=_toPrimitive$24(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$24(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ViewportBaseCalculator{constructor(s){_defineProperty$23(this,"calculationTypes",[]),_defineProperty$23(this,"calculationResults",new Map),this.calculationTypes=s}_initialize(s){this.calculationTypes.forEach(c=>{let[u,d]=c;this.calculationResults.set(u,d),d.initialize(s)})}_process(s,c){this.calculationTypes.forEach(u=>{let[,d]=u;return d.process(s,c)})}_finalize(s){this.calculationTypes.forEach(c=>{let[,u]=c;return u.finalize(s)})}getResultsFor(s){return this.calculationResults.get(s)}}function _defineProperty$22(a,s,c){return(s=_toPropertyKey$23(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$23(a){var s=_toPrimitive$23(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$23(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const DEFAULT_WIDTH=50;class ViewportColumnsCalculator extends ViewportBaseCalculator{constructor(s){let{calculationTypes:c,viewportWidth:u,scrollOffset:d,totalColumns:h,columnWidthFn:f,overrideFn:g,inlineStartOffset:m}=s;super(c),_defineProperty$22(this,"viewportWidth",0),_defineProperty$22(this,"scrollOffset",0),_defineProperty$22(this,"zeroBasedScrollOffset",0),_defineProperty$22(this,"totalColumns",0),_defineProperty$22(this,"columnWidthFn",null),_defineProperty$22(this,"columnWidth",0),_defineProperty$22(this,"overrideFn",null),_defineProperty$22(this,"inlineStartOffset",0),_defineProperty$22(this,"totalCalculatedWidth",0),_defineProperty$22(this,"startPositions",[]),_defineProperty$22(this,"needReverse",!0),this.viewportWidth=u,this.scrollOffset=d,this.zeroBasedScrollOffset=Math.max(d,0),this.totalColumns=h,this.columnWidthFn=f,this.overrideFn=g,this.inlineStartOffset=m,this.calculate()}calculate(){this._initialize(this);for(let s=0;s<this.totalColumns;s++)if(this.columnWidth=this.getColumnWidth(s),this._process(s,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(s){const c=this.columnWidthFn(s);return isNaN(c)?DEFAULT_WIDTH:c}}function _defineProperty$21(a,s,c){return(s=_toPropertyKey$22(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$22(a){var s=_toPrimitive$22(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$22(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ViewportRowsCalculator extends ViewportBaseCalculator{constructor(s){let{calculationTypes:c,viewportHeight:u,scrollOffset:d,totalRows:h,defaultRowHeight:f,rowHeightFn:g,overrideFn:m,horizontalScrollbarHeight:p}=s;super(c),_defineProperty$21(this,"viewportHeight",0),_defineProperty$21(this,"scrollOffset",0),_defineProperty$21(this,"zeroBasedScrollOffset",0),_defineProperty$21(this,"totalRows",0),_defineProperty$21(this,"rowHeightFn",null),_defineProperty$21(this,"rowHeight",0),_defineProperty$21(this,"overrideFn",null),_defineProperty$21(this,"horizontalScrollbarHeight",0),_defineProperty$21(this,"innerViewportHeight",0),_defineProperty$21(this,"totalCalculatedHeight",0),_defineProperty$21(this,"startPositions",[]),_defineProperty$21(this,"needReverse",!0),this.defaultHeight=f,this.viewportHeight=u,this.scrollOffset=d,this.zeroBasedScrollOffset=Math.max(d,0),this.totalRows=h,this.rowHeightFn=g,this.overrideFn=m,this.horizontalScrollbarHeight=p??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let s=0;s<this.totalRows;s++)if(this.rowHeight=this.getRowHeight(s),this._process(s,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(s){const c=this.rowHeightFn(s);return isNaN(c)?this.defaultHeight:c}}function _classPrivateFieldInitSpec$_(a,s,c){_checkPrivateRedeclaration$1j(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1j(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$20(a,s,c){return(s=_toPropertyKey$21(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$21(a){var s=_toPrimitive$21(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$21(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$_(a,s){return a.get(_assertClassBrand$1j(a,s))}function _classPrivateFieldSet$X(a,s,c){return a.set(_assertClassBrand$1j(a,s),c),c}function _assertClassBrand$1j(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _isRtl$4=new WeakMap;class CellCoords{constructor(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_defineProperty$20(this,"row",null),_defineProperty$20(this,"col",null),_classPrivateFieldInitSpec$_(this,_isRtl$4,!1),_classPrivateFieldSet$X(_isRtl$4,this,u),typeof s<"u"&&typeof c<"u"&&(this.row=s,this.col=c)}isValid(s){const{countRows:c,countCols:u,countRowHeaders:d,countColHeaders:h}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...s};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-h||this.col<-d||this.row>=c||this.col>=u)}isEqual(s){return s===this?!0:this.row===s.row&&this.col===s.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return _classPrivateFieldGet$_(_isRtl$4,this)}isSouthEastOf(s){return this.row>=s.row&&(_classPrivateFieldGet$_(_isRtl$4,this)?this.col<=s.col:this.col>=s.col)}isNorthWestOf(s){return this.row<=s.row&&(_classPrivateFieldGet$_(_isRtl$4,this)?this.col>=s.col:this.col<=s.col)}isSouthWestOf(s){return this.row>=s.row&&(_classPrivateFieldGet$_(_isRtl$4,this)?this.col>=s.col:this.col<=s.col)}isNorthEastOf(s){return this.row<=s.row&&(_classPrivateFieldGet$_(_isRtl$4,this)?this.col<=s.col:this.col>=s.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(s){return Number.isInteger(s?.row)&&(this.row=s.row),Number.isInteger(s?.col)&&(this.col=s.col),s instanceof CellCoords&&_classPrivateFieldSet$X(_isRtl$4,this,s.isRtl()),this}clone(){return new CellCoords(this.row,this.col,_classPrivateFieldGet$_(_isRtl$4,this))}toObject(){return{row:this.row,col:this.col}}}function _classPrivateFieldInitSpec$Z(a,s,c){_checkPrivateRedeclaration$1i(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1i(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1$(a,s,c){return(s=_toPropertyKey$20(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$20(a){var s=_toPrimitive$20(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$20(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$Z(a,s){return a.get(_assertClassBrand$1i(a,s))}function _classPrivateFieldSet$W(a,s,c){return a.set(_assertClassBrand$1i(a,s),c),c}function _assertClassBrand$1i(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _isRtl$3=new WeakMap;class CellRange{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;_defineProperty$1$(this,"highlight",null),_defineProperty$1$(this,"from",null),_defineProperty$1$(this,"to",null),_classPrivateFieldInitSpec$Z(this,_isRtl$3,!1),this.highlight=s.clone(),this.from=c.clone(),this.to=u.clone(),_classPrivateFieldSet$W(_isRtl$3,this,d)}setHighlight(s){return this.highlight=s.clone(),this}setFrom(s){return this.from=s.clone(),this}setTo(s){return this.to=s.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(s){return this.from.isValid(s)&&this.to.isValid(s)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const s=Math.max(this.from.row,0),c=Math.max(this.to.row,0);return Math.max(s,c)-Math.min(s,c)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const s=Math.max(this.from.col,0),c=Math.max(this.to.col,0);return Math.max(s,c)-Math.min(s,c)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(s){const{row:c,col:u}=s,d=this.getOuterTopStartCorner(),h=this.getOuterBottomEndCorner();return d.row<=c&&h.row>=c&&d.col<=u&&h.col>=u}includesRange(s){return this.includes(s.getOuterTopStartCorner())&&this.includes(s.getOuterBottomEndCorner())}isEqual(s){return Math.min(this.from.row,this.to.row)===Math.min(s.from.row,s.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(s.from.row,s.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(s.from.col,s.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(s.from.col,s.to.col)}overlaps(s){return s.isSouthEastOf(this.getOuterTopLeftCorner())&&s.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(s){return this.getOuterTopLeftCorner().isSouthEastOf(s)||this.getOuterBottomRightCorner().isSouthEastOf(s)}isNorthWestOf(s){return this.getOuterTopLeftCorner().isNorthWestOf(s)||this.getOuterBottomRightCorner().isNorthWestOf(s)}isOverlappingHorizontally(s){return this.getOuterTopEndCorner().col>=s.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=s.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=s.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=s.getOuterTopStartCorner().col}isOverlappingVertically(s){return this.getOuterBottomStartCorner().row>=s.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=s.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=s.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=s.getOuterTopRightCorner().row}expand(s){const c=this.getOuterTopStartCorner(),u=this.getOuterBottomEndCorner();return s.row<c.row||s.col<c.col||s.row>u.row||s.col>u.col?(this.from=this._createCellCoords(Math.min(c.row,s.row),Math.min(c.col,s.col)),this.to=this._createCellCoords(Math.max(u.row,s.row),Math.max(u.col,s.col)),!0):!1}expandByRange(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(s)||!this.overlaps(s))return!1;const u=this.getOuterTopStartCorner(),d=this.getOuterBottomEndCorner(),h=this.getDirection(),f=s.getOuterTopStartCorner(),g=s.getOuterBottomEndCorner(),m=Math.min(u.row,f.row),p=Math.min(u.col,f.col),v=Math.max(d.row,g.row),w=Math.max(d.col,g.col),E=this._createCellCoords(m,p),C=this._createCellCoords(v,w);return this.from=E,this.to=C,this.setDirection(h),c&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(s){switch(s){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return _classPrivateFieldGet$Z(_isRtl$3,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(s){return s.isEqual(this.getOuterTopLeftCorner())||s.isEqual(this.getOuterTopRightCorner())||s.isEqual(this.getOuterBottomLeftCorner())||s.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(s){if(!(s instanceof CellCoords))return!1;if(s.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(s.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(s.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(s.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(s){if(!this.includesRange(s))return[];const c={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},u={top:Math.min(s.from.row,s.to.row),bottom:Math.max(s.from.row,s.to.row),left:Math.min(s.from.col,s.to.col),right:Math.max(s.from.col,s.to.col)},d=[];return c.top===u.top&&d.push("top"),c.right===u.right&&d.push(_classPrivateFieldGet$Z(_isRtl$3,this)?"left":"right"),c.bottom===u.bottom&&d.push("bottom"),c.left===u.left&&d.push(_classPrivateFieldGet$Z(_isRtl$3,this)?"right":"left"),d}getInner(){const s=this.getOuterTopStartCorner(),c=this.getOuterBottomEndCorner(),u=[];for(let d=s.row;d<=c.row;d++)for(let h=s.col;h<=c.col;h++)!(this.from.row===d&&this.from.col===h)&&!(this.to.row===d&&this.to.col===h)&&u.push(this._createCellCoords(d,h));return u}getAll(){const s=this.getOuterTopStartCorner(),c=this.getOuterBottomEndCorner(),u=[];for(let d=s.row;d<=c.row;d++)for(let h=s.col;h<=c.col;h++)s.row===d&&s.col===h?u.push(s):c.row===d&&c.col===h?u.push(c):u.push(this._createCellCoords(d,h));return u}forAll(s){const c=this.getOuterTopStartCorner(),u=this.getOuterBottomEndCorner();for(let d=c.row;d<=u.row;d++)for(let h=c.col;h<=u.col;h++)if(s(d,h)===!1)return}clone(){return new CellRange(this.highlight,this.from,this.to,_classPrivateFieldGet$Z(_isRtl$3,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(s,c){return new CellCoords(s,c,_classPrivateFieldGet$Z(_isRtl$3,this))}}function _classPrivateFieldInitSpec$Y(a,s,c){_checkPrivateRedeclaration$1h(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1h(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$Y(a,s){return a.get(_assertClassBrand$1h(a,s))}function _classPrivateFieldSet$V(a,s,c){return a.set(_assertClassBrand$1h(a,s),c),c}function _assertClassBrand$1h(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _wtSettings=new WeakMap,_domBindings=new WeakMap,_wtTable=new WeakMap,_selectionManager=new WeakMap,_parent=new WeakMap,_eventManager=new WeakMap,_facadeGetter=new WeakMap,_selectedCellBeforeTouchEnd=new WeakMap,_dblClickTimeout=new WeakMap,_dblClickOrigin=new WeakMap;let Event$1=class{constructor(s,c,u,d,h,f){let g=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;_classPrivateFieldInitSpec$Y(this,_wtSettings,void 0),_classPrivateFieldInitSpec$Y(this,_domBindings,void 0),_classPrivateFieldInitSpec$Y(this,_wtTable,void 0),_classPrivateFieldInitSpec$Y(this,_selectionManager,void 0),_classPrivateFieldInitSpec$Y(this,_parent,void 0),_classPrivateFieldInitSpec$Y(this,_eventManager,void 0),_classPrivateFieldInitSpec$Y(this,_facadeGetter,void 0),_classPrivateFieldInitSpec$Y(this,_selectedCellBeforeTouchEnd,void 0),_classPrivateFieldInitSpec$Y(this,_dblClickTimeout,[null,null]),_classPrivateFieldInitSpec$Y(this,_dblClickOrigin,[null,null]),_classPrivateFieldSet$V(_wtSettings,this,u),_classPrivateFieldSet$V(_domBindings,this,c),_classPrivateFieldSet$V(_wtTable,this,h),_classPrivateFieldSet$V(_selectionManager,this,f),_classPrivateFieldSet$V(_parent,this,g),_classPrivateFieldSet$V(_eventManager,this,d),_classPrivateFieldSet$V(_facadeGetter,this,s),this.registerEvents()}registerEvents(){_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).holder,"contextmenu",u=>this.onContextMenu(u)),_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).TABLE,"mouseover",u=>this.onMouseOver(u)),_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).TABLE,"mouseout",u=>this.onMouseOut(u));const s=()=>{_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).holder,"touchstart",u=>this.onTouchStart(u)),_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).holder,"touchend",u=>this.onTouchEnd(u)),this.momentumScrolling||(this.momentumScrolling={}),_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||_classPrivateFieldGet$Y(_wtSettings,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,_classPrivateFieldGet$Y(_wtSettings,this).getSetting("onAfterMomentumScroll"))},200)})},c=()=>{_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).holder,"mouseup",u=>this.onMouseUp(u)),_classPrivateFieldGet$Y(_eventManager,this).addEventListener(_classPrivateFieldGet$Y(_wtTable,this).holder,"mousedown",u=>this.onMouseDown(u))};isMobileBrowser()?s():(isTouchSupported()&&s(),c())}selectedCellWasTouched(s){const u=this.parentCell(s).coords;if(_classPrivateFieldGet$Y(_selectedCellBeforeTouchEnd,this)&&u){const[d,h]=[u.row,_classPrivateFieldGet$Y(_selectedCellBeforeTouchEnd,this).from.row],[f,g]=[u.col,_classPrivateFieldGet$Y(_selectedCellBeforeTouchEnd,this).from.col];return d===h&&f===g}return!1}parentCell(s){const c={},u=_classPrivateFieldGet$Y(_wtTable,this).TABLE,d=closestDown(s,["TD","TH"],u);return d?(c.coords=_classPrivateFieldGet$Y(_wtTable,this).getCoords(d),c.TD=d):hasClass$1(s,"wtBorder")&&hasClass$1(s,"current")?(c.coords=_classPrivateFieldGet$Y(_selectionManager,this).getFocusSelection().cellRange.highlight,c.TD=_classPrivateFieldGet$Y(_wtTable,this).getCell(c.coords)):hasClass$1(s,"wtBorder")&&hasClass$1(s,"area")&&_classPrivateFieldGet$Y(_selectionManager,this).getAreaSelection().cellRange&&(c.coords=_classPrivateFieldGet$Y(_selectionManager,this).getAreaSelection().cellRange.to,c.TD=_classPrivateFieldGet$Y(_wtTable,this).getCell(c.coords)),c}onMouseDown(s){const c=_classPrivateFieldGet$Y(_domBindings,this).rootDocument.activeElement,u=partial(getParent,s.target),d=s.target;if(!["TD","TH"].includes(c.nodeName)&&(d===c||u(0)===c||u(1)===c))return;const h=this.parentCell(d);hasClass$1(d,"corner")?_classPrivateFieldGet$Y(_wtSettings,this).getSetting("onCellCornerMouseDown",s,d):h.TD&&_classPrivateFieldGet$Y(_wtSettings,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",s,h.coords,h.TD),(s.button===0||this.touchApplied)&&h.TD&&(_classPrivateFieldGet$Y(_dblClickOrigin,this)[0]=h.TD,clearTimeout(_classPrivateFieldGet$Y(_dblClickTimeout,this)[0]),_classPrivateFieldGet$Y(_dblClickTimeout,this)[0]=setTimeout(()=>{_classPrivateFieldGet$Y(_dblClickOrigin,this)[0]=null},1e3))}onContextMenu(s){if(_classPrivateFieldGet$Y(_wtSettings,this).has("onCellContextMenu")){const c=this.parentCell(s.target);c.TD&&this.callListener("onCellContextMenu",s,c.coords,c.TD)}}onMouseOver(s){if(!_classPrivateFieldGet$Y(_wtSettings,this).has("onCellMouseOver"))return;const c=_classPrivateFieldGet$Y(_wtTable,this).TABLE,u=closestDown(s.target,["TD","TH"],c),d=_classPrivateFieldGet$Y(_parent,this)||this;u&&u!==d.lastMouseOver&&isChildOf(u,c)&&(d.lastMouseOver=u,this.callListener("onCellMouseOver",s,_classPrivateFieldGet$Y(_wtTable,this).getCoords(u),u))}onMouseOut(s){if(!_classPrivateFieldGet$Y(_wtSettings,this).has("onCellMouseOut"))return;const c=_classPrivateFieldGet$Y(_wtTable,this).TABLE,u=closestDown(s.target,["TD","TH"],c),d=closestDown(s.relatedTarget,["TD","TH"],c),h=_classPrivateFieldGet$Y(_parent,this)||this;u&&u!==d&&isChildOf(u,c)&&(this.callListener("onCellMouseOut",s,_classPrivateFieldGet$Y(_wtTable,this).getCoords(u),u),d===null&&(h.lastMouseOver=null))}onMouseUp(s){const c=this.parentCell(s.target);c.TD&&_classPrivateFieldGet$Y(_wtSettings,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",s,c.coords,c.TD),!(s.button!==0&&!this.touchApplied)&&(c.TD===_classPrivateFieldGet$Y(_dblClickOrigin,this)[0]&&c.TD===_classPrivateFieldGet$Y(_dblClickOrigin,this)[1]?(hasClass$1(s.target,"corner")?this.callListener("onCellCornerDblClick",s,c.coords,c.TD):this.callListener("onCellDblClick",s,c.coords,c.TD),_classPrivateFieldGet$Y(_dblClickOrigin,this)[0]=null,_classPrivateFieldGet$Y(_dblClickOrigin,this)[1]=null):c.TD===_classPrivateFieldGet$Y(_dblClickOrigin,this)[0]&&(_classPrivateFieldGet$Y(_dblClickOrigin,this)[1]=c.TD,clearTimeout(_classPrivateFieldGet$Y(_dblClickTimeout,this)[1]),_classPrivateFieldGet$Y(_dblClickTimeout,this)[1]=setTimeout(()=>{_classPrivateFieldGet$Y(_dblClickOrigin,this)[1]=null},500)))}onTouchStart(s){_classPrivateFieldSet$V(_selectedCellBeforeTouchEnd,this,_classPrivateFieldGet$Y(_selectionManager,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(s)}onTouchEnd(s){var c;const u=s.target,d=(c=this.parentCell(u))===null||c===void 0?void 0:c.coords,h=isDefined(d)&&d.row>=0&&d.col>=0;if(s.cancelable&&h&&_classPrivateFieldGet$Y(_wtSettings,this).getSetting("isDataViewInstance")){const g=["A","BUTTON","INPUT"];isIOS()&&(isChromeWebKit()||isFirefoxWebKit())&&this.selectedCellWasTouched(u)&&!g.includes(u.tagName)?s.preventDefault():this.selectedCellWasTouched(u)||s.preventDefault()}this.onMouseUp(s),this.touchApplied=!1}callListener(s,c,u,d){const h=_classPrivateFieldGet$Y(_wtSettings,this).getSettingPure(s);h&&h(c,u,d,_classPrivateFieldGet$Y(_facadeGetter,this).call(this))}destroy(){clearTimeout(_classPrivateFieldGet$Y(_dblClickTimeout,this)[0]),clearTimeout(_classPrivateFieldGet$Y(_dblClickTimeout,this)[1]),_classPrivateFieldGet$Y(_eventManager,this).destroy()}};function _defineProperty$1_(a,s,c){return(s=_toPropertyKey$1$(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1$(a){var s=_toPrimitive$1$(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1$(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ColumnFilter{constructor(s,c,u){_defineProperty$1_(this,"offset",void 0),_defineProperty$1_(this,"total",void 0),_defineProperty$1_(this,"countTH",void 0),this.offset=s,this.total=c,this.countTH=u}offsetted(s){return s+this.offset}unOffsetted(s){return s-this.offset}renderedToSource(s){return this.offsetted(s)}sourceToRendered(s){return this.unOffsetted(s)}offsettedTH(s){return s-this.countTH}unOffsettedTH(s){return s+this.countTH}visibleRowHeadedColumnToSourceColumn(s){return this.renderedToSource(this.offsettedTH(s))}sourceColumnToVisibleRowHeadedColumn(s){return this.unOffsettedTH(this.sourceToRendered(s))}}function _defineProperty$1Z(a,s,c){return(s=_toPropertyKey$1_(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1_(a){var s=_toPrimitive$1_(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1_(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RowFilter{constructor(s,c,u){_defineProperty$1Z(this,"offset",void 0),_defineProperty$1Z(this,"total",void 0),_defineProperty$1Z(this,"countTH",void 0),this.offset=s,this.total=c,this.countTH=u}offsetted(s){return s+this.offset}unOffsetted(s){return s-this.offset}renderedToSource(s){return this.offsetted(s)}sourceToRendered(s){return this.unOffsetted(s)}offsettedTH(s){return s-this.countTH}unOffsettedTH(s){return s+this.countTH}visibleColHeadedRowToSourceRow(s){return this.renderedToSource(this.offsettedTH(s))}sourceRowToVisibleColHeadedRow(s){return this.unOffsettedTH(this.sourceToRendered(s))}}function _defineProperty$1Y(a,s,c){return(s=_toPropertyKey$1Z(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1Z(a){var s=_toPrimitive$1Z(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1Z(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ViewSize{constructor(){_defineProperty$1Y(this,"currentSize",0),_defineProperty$1Y(this,"nextSize",0),_defineProperty$1Y(this,"currentOffset",0),_defineProperty$1Y(this,"nextOffset",0)}setSize(s){this.currentSize=this.nextSize,this.nextSize=s}setOffset(s){this.currentOffset=this.nextOffset,this.nextOffset=s}}const WORKING_SPACE_ALL=0,WORKING_SPACE_TOP=1,WORKING_SPACE_BOTTOM=2;function _defineProperty$1X(a,s,c){return(s=_toPropertyKey$1Y(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1Y(a){var s=_toPrimitive$1Y(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1Y(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ViewSizeSet{constructor(){_defineProperty$1X(this,"size",new ViewSize),_defineProperty$1X(this,"workingSpace",WORKING_SPACE_ALL),_defineProperty$1X(this,"sharedSize",null)}setSize(s){this.size.setSize(s)}setOffset(s){this.size.setOffset(s)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(s){return this.workingSpace===s}append(s){this.workingSpace=WORKING_SPACE_TOP,s.workingSpace=WORKING_SPACE_BOTTOM,this.sharedSize=s.getViewSize()}prepend(s){this.workingSpace=WORKING_SPACE_BOTTOM,s.workingSpace=WORKING_SPACE_TOP,this.sharedSize=s.getViewSize()}}var es_array_unshift={},deletePropertyOrThrow,hasRequiredDeletePropertyOrThrow;function requireDeletePropertyOrThrow(){if(hasRequiredDeletePropertyOrThrow)return deletePropertyOrThrow;hasRequiredDeletePropertyOrThrow=1;var a=requireTryToString(),s=TypeError;return deletePropertyOrThrow=function(c,u){if(!delete c[u])throw new s("Cannot delete property "+a(u)+" of "+a(c))},deletePropertyOrThrow}var hasRequiredEs_array_unshift;function requireEs_array_unshift(){if(hasRequiredEs_array_unshift)return es_array_unshift;hasRequiredEs_array_unshift=1;var a=require_export(),s=requireToObject(),c=requireLengthOfArrayLike(),u=requireArraySetLength(),d=requireDeletePropertyOrThrow(),h=requireDoesNotExceedSafeInteger(),f=[].unshift(0)!==1,g=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(p){return p instanceof TypeError}},m=f||!g();return a({target:"Array",proto:!0,arity:1,forced:m},{unshift:function(v){var w=s(this),E=c(w),C=arguments.length;if(C){h(E+C);for(var b=E;b--;){var P=b+C;b in w?w[P]=w[b]:d(w,P)}for(var R=0;R<C;R++)w[R]=arguments[R]}return u(w,E+C)}}),es_array_unshift}requireEs_array_unshift();function _defineProperty$1W(a,s,c){return(s=_toPropertyKey$1X(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1X(a){var s=_toPrimitive$1X(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1X(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ViewOrder{constructor(s,c){_defineProperty$1W(this,"order",[]),this.order=[...Array(c).keys()].map(u=>s+u)}get length(){return this.order.length}has(s){return this.order.indexOf(s)>-1}get(s){return s<this.order.length?this.order[s]:-1}remove(s){this.order.splice(this.order.indexOf(s),1)}prepend(s){return this.order.unshift(s),this.order.pop()}}function _defineProperty$1V(a,s,c){return(s=_toPropertyKey$1W(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1W(a){var s=_toPrimitive$1W(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1W(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ViewDiffer{constructor(s){_defineProperty$1V(this,"sizeSet",void 0),this.sizeSet=s}diff(){const{sizeSet:s}=this,{currentSize:c,nextSize:u}=s.getViewSize();let d=Math.max(u,c);if(d===0)return[];const{currentOffset:h,nextOffset:f}=s.getViewSize(),g=new ViewOrder(h,c),m=new ViewOrder(f,u),p=[];for(let v=0;v<d;v++){const w=g.get(v),E=m.get(v);if(E===-1)p.push(["remove",w]);else if(w===-1)!s.isShared()||s.isShared()&&s.isPlaceOn(WORKING_SPACE_BOTTOM)?p.push(["append",E]):p.push(["prepend",E]);else if(E>w)g.has(E)&&(g.remove(E),u<=g.length&&(d-=1)),p.push(["replace",E,w]);else if(E<w){const C=g.prepend(E);p.push(["insert_before",E,w,C])}else p.push(["none",E])}return p}}function _defineProperty$1U(a,s,c){return(s=_toPropertyKey$1V(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1V(a){var s=_toPrimitive$1V(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1V(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class OrderView{constructor(s,c){_defineProperty$1U(this,"rootNode",void 0),_defineProperty$1U(this,"nodesPool",void 0),_defineProperty$1U(this,"sizeSet",new ViewSizeSet),_defineProperty$1U(this,"collectedNodes",[]),_defineProperty$1U(this,"viewDiffer",new ViewDiffer(this.sizeSet)),_defineProperty$1U(this,"leads",[]),this.rootNode=s,this.nodesPool=c}setSize(s){return this.sizeSet.setSize(s),this}setOffset(s){return this.sizeSet.setOffset(s),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(s){return s<this.collectedNodes.length?this.collectedNodes[s]:null}getCurrentNode(){const s=this.collectedNodes.length;return s>0?this.collectedNodes[s-1]:null}applyCommand(s){const{rootNode:c}=this,[u,d,h,f]=s,g=this.nodesPool(d);switch(this.collectedNodes.push(g),u){case"prepend":c.insertBefore(g,c.firstChild);break;case"append":c.appendChild(g);break;case"insert_before":c.insertBefore(g,this.nodesPool(h)),c.removeChild(this.nodesPool(f));break;case"replace":c.replaceChild(g,this.nodesPool(h));break;case"remove":c.removeChild(g);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class SharedOrderView extends OrderView{prependView(s){return this.sizeSet.prepend(s.sizeSet),s.sizeSet.append(this.sizeSet),this}appendView(s){return this.sizeSet.append(s.sizeSet),s.sizeSet.prepend(this.sizeSet),this}}function _defineProperty$1T(a,s,c){return(s=_toPropertyKey$1U(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1U(a){var s=_toPrimitive$1U(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1U(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class NodesPool{constructor(s){_defineProperty$1T(this,"nodeType",void 0),_defineProperty$1T(this,"pool",new Map),this.nodeType=s.toUpperCase()}setRootDocument(s){this.rootDocument=s}obtain(s,c){const d=typeof c=="number"?`${s}x${c}`:s.toString();if(this.pool.has(d))return this.pool.get(d);const h=this.rootDocument.createElement(this.nodeType);return this.pool.set(d,h),h}}function _defineProperty$1S(a,s,c){return(s=_toPropertyKey$1T(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1T(a){var s=_toPrimitive$1T(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1T(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class BaseRenderer{constructor(s,c){_defineProperty$1S(this,"nodesPool",null),_defineProperty$1S(this,"nodeType",void 0),_defineProperty$1S(this,"rootNode",void 0),_defineProperty$1S(this,"table",null),_defineProperty$1S(this,"renderedNodes",0),this.nodesPool=typeof s=="string"?new NodesPool(s):null,this.nodeType=s,this.rootNode=c}setTable(s){this.nodesPool&&this.nodesPool.setRootDocument(s.rootDocument),this.table=s}adjust(){}render(){}}function _defineProperty$1R(a,s,c){return(s=_toPropertyKey$1S(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1S(a){var s=_toPrimitive$1S(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1S(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RowHeadersRenderer extends BaseRenderer{constructor(){super("TH"),_defineProperty$1R(this,"orderViews",new WeakMap),_defineProperty$1R(this,"sourceRowIndex",0)}obtainOrderView(s){let c;return this.orderViews.has(s)?c=this.orderViews.get(s):(c=new SharedOrderView(s,u=>this.nodesPool.obtain(this.sourceRowIndex,u)),this.orderViews.set(s,c)),c}render(){const{rowsToRender:s,rowHeaderFunctions:c,rowHeadersCount:u,rows:d,cells:h}=this.table;for(let f=0;f<s;f++){const g=this.table.renderedRowToSource(f),m=d.getRenderedNode(f);this.sourceRowIndex=g;const p=this.obtainOrderView(m),v=h.obtainOrderView(m);p.appendView(v).setSize(u).setOffset(0).start();for(let w=u-1;w>=0;w--){p.render();const E=p.getCurrentNode();E.className="",E.removeAttribute("style"),removeAttribute(E,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(E,[A11Y_ROWHEADER(),A11Y_SCOPE_ROW(),A11Y_COLINDEX(w+1),A11Y_TABINDEX(-1)]),c[w](g,E,w)}p.end()}}}class ColumnHeadersRenderer extends BaseRenderer{constructor(s){super(null,s)}adjust(){const{columnHeadersCount:s,rowHeadersCount:c}=this.table;let u=this.rootNode.firstChild;if(s){const{columnsToRender:d}=this.table,h=d+c;for(let g=0,m=s;g<m;g++){for(u=this.rootNode.childNodes[g],u||(u=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(u)),this.renderedNodes=u.childNodes.length;this.renderedNodes<h;)u.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>h;)u.removeChild(u.lastChild),this.renderedNodes-=1}const f=this.rootNode.childNodes.length;if(f>s)for(let g=s;g<f;g++)this.rootNode.removeChild(this.rootNode.lastChild)}else u&&empty(u)}render(){const{columnHeadersCount:s}=this.table;this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]);for(let c=0;c<s;c+=1){const{columnHeaderFunctions:u,columnsToRender:d,rowHeadersCount:h}=this.table,f=this.rootNode.childNodes[c];this.table.isAriaEnabled()&&setAttribute(f,[A11Y_ROW(),A11Y_ROWINDEX(c+1)]);for(let g=-1*h;g<d;g+=1){const m=this.table.renderedColumnToSource(g),p=f.childNodes[g+h];p.className="",p.removeAttribute("style"),removeAttribute(p,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&setAttribute(p,[A11Y_COLINDEX(g+1+this.table.rowHeadersCount),A11Y_TABINDEX(-1),A11Y_COLUMNHEADER(),...g>=0?[A11Y_SCOPE_COL()]:[A11Y_GRIDCELL_BUTTON(),A11Y_LABEL("Select whole grid")]]),u[c](m,p,c)}}}}let performanceWarningAppeared$1=!1;class ColGroupRenderer extends BaseRenderer{constructor(s){super(null,s)}adjust(){const{columnsToRender:s,rowHeadersCount:c}=this.table,u=s+c;for(;this.renderedNodes<u;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>u;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:s,rowHeadersCount:c}=this.table;!performanceWarningAppeared$1&&s>1e3&&(performanceWarningAppeared$1=!0,warn$1(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let d=0;d<c;d++){const h=this.table.renderedColumnToSource(d),f=this.table.columnUtils.getHeaderWidth(h);this.rootNode.childNodes[d].style.width=`${f}px`}for(let d=0;d<s;d++){const h=this.table.renderedColumnToSource(d),f=this.table.columnUtils.getWidth(h);this.rootNode.childNodes[d+c].style.width=`${f}px`}const u=this.rootNode.firstChild;u&&addClass$1(u,"rowHeader")}}function _defineProperty$1Q(a,s,c){return(s=_toPropertyKey$1R(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1R(a){var s=_toPrimitive$1R(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1R(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const ROW_CLASSNAMES={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let performanceWarningAppeared=!1;class RowsRenderer extends BaseRenderer{constructor(s){super("TR",s),_defineProperty$1Q(this,"orderView",void 0),this.orderView=new OrderView(s,c=>this.nodesPool.obtain(c))}getRenderedNode(s){return this.orderView.getNode(s)}hasStaleContent(s){return this.orderView.hasStaleContent(s)}render(){const{rowsToRender:s}=this.table;!performanceWarningAppeared&&s>1e3&&(performanceWarningAppeared=!0,warn$1(toSingleLine`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&setAttribute(this.rootNode,[A11Y_ROWGROUP()]),this.orderView.setSize(s).setOffset(this.table.renderedRowToSource(0)).start();for(let d=0;d<s;d++){this.orderView.render();const h=this.orderView.getCurrentNode(),f=this.table.renderedRowToSource(d);if(this.table.isAriaEnabled()){var c,u;setAttribute(h,[A11Y_ROW(),A11Y_ROWINDEX(f+((c=(u=this.table.rowUtils)===null||u===void 0||(u=u.dataAccessObject)===null||u===void 0?void 0:u.columnHeaders.length)!==null&&c!==void 0?c:0)+1)])}(f+1)%2===0?hasClass$1(h,ROW_CLASSNAMES.rowEven)||(removeClass$1(h,ROW_CLASSNAMES.rowOdd),addClass$1(h,ROW_CLASSNAMES.rowEven)):hasClass$1(h,ROW_CLASSNAMES.rowOdd)||(removeClass$1(h,ROW_CLASSNAMES.rowEven),addClass$1(h,ROW_CLASSNAMES.rowOdd))}this.orderView.end()}}function _defineProperty$1P(a,s,c){return(s=_toPropertyKey$1Q(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1Q(a){var s=_toPrimitive$1Q(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1Q(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CellsRenderer extends BaseRenderer{constructor(){super("TD"),_defineProperty$1P(this,"orderViews",new WeakMap),_defineProperty$1P(this,"sourceRowIndex",0)}obtainOrderView(s){let c;return this.orderViews.has(s)?c=this.orderViews.get(s):(c=new SharedOrderView(s,u=>this.nodesPool.obtain(this.sourceRowIndex,u),this.nodeType),this.orderViews.set(s,c)),c}render(){const{rowsToRender:s,columnsToRender:c,rows:u,rowHeaders:d}=this.table;for(let g=0;g<s;g++){const m=this.table.renderedRowToSource(g),p=u.getRenderedNode(g);this.sourceRowIndex=m;const v=this.obtainOrderView(p),w=d.obtainOrderView(p);v.prependView(w).setSize(c).setOffset(0).start();for(let E=0;E<c;E++){v.render();const C=this.table.renderedColumnToSource(E),b=v.getCurrentNode();if(hasClass$1(b,"hide")||(b.className=""),b.removeAttribute("style"),b.removeAttribute("dir"),removeAttribute(b,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(m,C,b),this.table.isAriaEnabled()){var h,f;setAttribute(b,[...b.hasAttribute("role")?[]:[A11Y_GRIDCELL()],A11Y_TABINDEX(-1),A11Y_COLINDEX(C+((h=(f=this.table.rowUtils)===null||f===void 0||(f=f.dataAccessObject)===null||f===void 0?void 0:f.rowHeaders.length)!==null&&h!==void 0?h:0)+1)])}}v.end()}}}function _defineProperty$1O(a,s,c){return(s=_toPropertyKey$1P(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1P(a){var s=_toPrimitive$1P(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1P(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class TableRenderer{constructor(s){let{cellRenderer:c,stylesHandler:u}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};_defineProperty$1O(this,"rootNode",void 0),_defineProperty$1O(this,"rootDocument",void 0),_defineProperty$1O(this,"rowHeaders",null),_defineProperty$1O(this,"columnHeaders",null),_defineProperty$1O(this,"colGroup",null),_defineProperty$1O(this,"rows",null),_defineProperty$1O(this,"cells",null),_defineProperty$1O(this,"rowFilter",null),_defineProperty$1O(this,"columnFilter",null),_defineProperty$1O(this,"rowUtils",null),_defineProperty$1O(this,"columnUtils",null),_defineProperty$1O(this,"rowsToRender",0),_defineProperty$1O(this,"columnsToRender",0),_defineProperty$1O(this,"rowHeaderFunctions",[]),_defineProperty$1O(this,"rowHeadersCount",0),_defineProperty$1O(this,"columnHeaderFunctions",[]),_defineProperty$1O(this,"columnHeadersCount",0),_defineProperty$1O(this,"cellRenderer",void 0),_defineProperty$1O(this,"activeOverlayName",void 0),_defineProperty$1O(this,"stylesHandler",void 0),this.rootNode=s,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=c,this.stylesHandler=u}setActiveOverlayName(s){this.activeOverlayName=s}setAxisUtils(s,c){this.rowUtils=s,this.columnUtils=c}setViewportSize(s,c){this.rowsToRender=s,this.columnsToRender=c}setFilters(s,c){this.rowFilter=s,this.columnFilter=c}setHeaderContentRenderers(s,c){this.rowHeaderFunctions=s,this.rowHeadersCount=s.length,this.columnHeaderFunctions=c,this.columnHeadersCount=c.length}setRenderers(){let{rowHeaders:s,columnHeaders:c,colGroup:u,rows:d,cells:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};s.setTable(this),c.setTable(this),u.setTable(this),d.setTable(this),h.setTable(this),this.rowHeaders=s,this.columnHeaders=c,this.colGroup=u,this.rows=d,this.cells=h}renderedRowToSource(s){return this.rowFilter.renderedToSource(s)}renderedColumnToSource(s){return this.columnFilter.renderedToSource(s)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:s,rows:c}=this;for(let u=0;u<s;u++){const d=c.getRenderedNode(u),h=this.rowUtils;if(d.firstChild){const f=this.renderedRowToSource(u),g=h.getHeightByOverlayName(f,this.activeOverlayName),p=this.stylesHandler.areCellsBorderBox()?0:1;g?d.firstChild.style.height=`${g-p}px`:d.firstChild.style.height=""}}}}class Renderer{constructor(){let{TABLE:s,THEAD:c,COLGROUP:u,TBODY:d,rowUtils:h,columnUtils:f,cellRenderer:g,stylesHandler:m}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new TableRenderer(s,{cellRenderer:g,stylesHandler:m}),this.renderer.setRenderers({rowHeaders:new RowHeadersRenderer,columnHeaders:new ColumnHeadersRenderer(c),colGroup:new ColGroupRenderer(u),rows:new RowsRenderer(d),cells:new CellsRenderer}),this.renderer.setAxisUtils(h,f)}setActiveOverlayName(s){return this.renderer.setActiveOverlayName(s),this}setFilters(s,c){return this.renderer.setFilters(s,c),this}setViewportSize(s,c){return this.renderer.setViewportSize(s,c),this}setHeaderContentRenderers(s,c){return this.renderer.setHeaderContentRenderers(s,c),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function _defineProperty$1N(a,s,c){return(s=_toPropertyKey$1O(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1O(a){var s=_toPrimitive$1O(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1O(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ColumnUtils{constructor(s,c){_defineProperty$1N(this,"dataAccessObject",void 0),_defineProperty$1N(this,"wtSettings",void 0),_defineProperty$1N(this,"headerWidths",new Map),this.dataAccessObject=s,this.wtSettings=c}getWidth(s){return this.wtSettings.getSetting("columnWidth",s)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(s){let c=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const u=this.dataAccessObject.wtViewport.oversizedColumnHeaders[s];return u!==void 0&&(c=c?Math.max(c,u):u),c}getHeaderWidth(s){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(s))}calculateWidths(){const{wtSettings:s}=this;let c=s.getSetting("rowHeaderWidth");if(c=s.getSetting("onModifyRowHeaderWidth",c),c!=null){const u=s.getSetting("rowHeaders").length,d=s.getSetting("defaultColumnWidth");for(let h=0;h<u;h++){let f=Array.isArray(c)?c[h]:c;f=f??d,this.headerWidths.set(h,f)}}}}function _defineProperty$1M(a,s,c){return(s=_toPropertyKey$1N(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1N(a){var s=_toPrimitive$1N(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1N(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RowUtils{constructor(s,c){_defineProperty$1M(this,"dataAccessObject",void 0),_defineProperty$1M(this,"wtSettings",void 0),this.dataAccessObject=s,this.wtSettings=c}getHeight(s){let c=this.wtSettings.getSetting("rowHeight",s);const u=this.dataAccessObject.wtViewport.oversizedRows[s];return u!==void 0&&(c=c===void 0?u:Math.max(c,u)),c}getHeightByOverlayName(s,c){let u=this.wtSettings.getSetting("rowHeightByOverlayName",s,c);const d=this.dataAccessObject.wtViewport.oversizedRows[s];return d!==void 0&&(u=u===void 0?d:Math.max(u,d)),u}}function _defineProperty$1L(a,s,c){return(s=_toPropertyKey$1M(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1M(a){var s=_toPrimitive$1M(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1M(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Table{constructor(s,c,u,d,h){_defineProperty$1L(this,"wtSettings",null),_defineProperty$1L(this,"domBindings",void 0),_defineProperty$1L(this,"TBODY",null),_defineProperty$1L(this,"THEAD",null),_defineProperty$1L(this,"COLGROUP",null),_defineProperty$1L(this,"hasTableHeight",!0),_defineProperty$1L(this,"hasTableWidth",!0),_defineProperty$1L(this,"isTableVisible",!1),_defineProperty$1L(this,"tableOffset",0),_defineProperty$1L(this,"holderOffset",0),this.domBindings=u,this.isMaster=h==="master",this.name=h,this.dataAccessObject=s,this.facadeGetter=c,this.wtSettings=d,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=u.rootTable,removeTextNodes(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const f=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(f)),this.rowUtils=new RowUtils(this.dataAccessObject,this.wtSettings),this.columnUtils=new ColumnUtils(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Renderer({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(s){return this.name===s}fixTableDomTree(){const s=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=s.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=s.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=s.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(s){const c=s.parentNode;let u;return(!c||c.nodeType!==Node.ELEMENT_NODE||!hasClass$1(c,"wtHolder"))&&(u=this.domBindings.rootDocument.createElement("div"),u.className="wtSpreader",c&&c.insertBefore(u,s),u.appendChild(s)),u.style.position="relative",this.wtSettings.getSetting("ariaTags")&&setAttribute(u,[A11Y_PRESENTATION()]),u}createHider(s){const c=s.parentNode;let u;return(!c||c.nodeType!==Node.ELEMENT_NODE||!hasClass$1(c,"wtHolder"))&&(u=this.domBindings.rootDocument.createElement("div"),u.className="wtHider",c&&c.insertBefore(u,s),u.appendChild(s)),this.wtSettings.getSetting("ariaTags")&&setAttribute(u,[A11Y_PRESENTATION()]),u}createHolder(s){const c=s.parentNode;let u;return(!c||c.nodeType!==Node.ELEMENT_NODE||!hasClass$1(c,"wtHolder"))&&(u=this.domBindings.rootDocument.createElement("div"),u.style.position="relative",u.className="wtHolder",this.isMaster&&setAttribute(u,[A11Y_TABINDEX(-1)]),c&&c.insertBefore(u,s),this.isMaster&&(u.parentNode.className+="ht_master handsontable",u.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&setAttribute(u.parentNode,[A11Y_PRESENTATION()])),u.appendChild(s)),this.wtSettings.getSetting("ariaTags")&&setAttribute(u,[A11Y_PRESENTATION()]),u}draw(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:c}=this,{wtOverlays:u,wtViewport:d}=this.dataAccessObject,h=c.getSetting("totalRows"),f=c.getSetting("totalColumns"),g=c.getSetting("rowHeaders"),m=g.length,p=c.getSetting("columnHeaders"),v=p.length;let w=s;if(this.isMaster&&(u.beforeDraw(),this.holderOffset=offset(this.holder),w=d.createCalculators(w),m&&!c.getSetting("fixedColumnsStart"))){const C=u.inlineStartOverlay.getScrollPosition(),b=this.correctHeaderWidth;this.correctHeaderWidth=C!==0,b!==this.correctHeaderWidth&&(w=!1)}if(w)this.isMaster&&u.refresh(!0);else{this.isMaster?this.tableOffset=offset(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const C=Math.max(this.getFirstRenderedRow(),0),b=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new RowFilter(C,h,v),this.columnFilter=new ColumnFilter(b,f,m);let P=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const R={};this.wtSettings.getSetting("beforeDraw",!0,R),P=R.skipRender!==!0}P&&(this.tableRenderer.setHeaderContentRenderers(g,p),(this.is(CLONE_BOTTOM)||this.is(CLONE_BOTTOM_INLINE_START_CORNER))&&this.tableRenderer.setHeaderContentRenderers(g,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(CLONE_BOTTOM))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||d.createVisibleCalculators(),u.refresh(!1),u.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(CLONE_BOTTOM)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let E=!1;return this.isMaster&&(E=u.topOverlay.resetFixedPosition(),u.bottomOverlay.clone&&(E=u.bottomOverlay.resetFixedPosition()||E),E=u.inlineStartOverlay.resetFixedPosition()||E,u.topInlineStartCornerOverlay&&u.topInlineStartCornerOverlay.resetFixedPosition(),u.bottomInlineStartCornerOverlay&&u.bottomInlineStartCornerOverlay.clone&&u.bottomInlineStartCornerOverlay.resetFixedPosition()),E?(u.refreshAll(),u.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(w),this.isMaster&&u.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(s){const c=this.columnFilter.renderedToSource(s);let u=this.wtSettings.getSetting("columnHeaders").length;const d=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let h,f,g;const m=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;u;)u-=1,h=this.getColumnHeaderHeight(u),f=this.getColumnHeader(c,u),f&&(g=innerHeight$1(f),(!h&&d<g||h<g)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[u]=g),Array.isArray(m)?m[u]!==null&&m[u]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[u]=m[u]):isNaN(m)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[u]=m),this.dataAccessObject.wtViewport.oversizedColumnHeaders[u]<(m[u]||m)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[u]=m[u]||m))}adjustColumnHeaderHeights(){const{wtSettings:s}=this,c=this.THEAD.childNodes,u=this.dataAccessObject.wtViewport.oversizedColumnHeaders,d=s.getSetting("columnHeaders");for(let h=0,f=d.length;h<f;h++)if(u[h]){if(!c[h]||c[h].childNodes.length===0)return;c[h].childNodes[0].style.height=`${u[h]}px`}}resetOversizedRows(){const{wtSettings:s}=this,{wtViewport:c}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(CLONE_BOTTOM))&&!s.getSetting("externalRowCalculator")){const u=this.getRenderedRowsCount();for(let d=0;d<u;d++){const h=this.rowFilter.renderedToSource(d);c.oversizedRows&&c.oversizedRows[h]&&(c.oversizedRows[h]=void 0)}}}getCell(s){let c=s.row,u=s.col;const d=this.wtSettings.getSetting("onModifyGetCellCoords",c,u,!this.isMaster,"render");if(d&&Array.isArray(d)&&([c,u]=d),this.isRowBeforeRenderedRows(c))return-1;if(this.isRowAfterRenderedRows(c))return-2;if(this.isColumnBeforeRenderedColumns(u))return-3;if(this.isColumnAfterRenderedColumns(u))return-4;const h=this.getRow(c);if(!h&&c>=0)throw new Error("TR was expected to be rendered but is not");const f=h.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(u)];if(!f&&u>=0)throw new Error("TD or TH was expected to be rendered but is not");return f}getRow(s){let c=null,u=null;if(s<0){var d;c=(d=this.rowFilter)===null||d===void 0?void 0:d.sourceRowToVisibleColHeadedRow(s),u=this.THEAD}else{var h;c=(h=this.rowFilter)===null||h===void 0?void 0:h.sourceToRendered(s),u=this.TBODY}return c!==void 0&&u!==void 0?u.childNodes.length<c+1?!1:u.childNodes[c]:!1}getColumnHeader(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const u=this.THEAD.childNodes[c];return u?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(s)]}getColumnHeaders(s){const c=[],u=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(s);return this.THEAD.childNodes.forEach(d=>{const h=d.childNodes[u];h&&c.push(h)}),c}getRowHeader(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const u=this.wtSettings.getSetting("rowHeaders").length;if(c>=u)return;const d=this.rowFilter.sourceToRendered(s),h=d<0?this.rowFilter.sourceRowToVisibleColHeadedRow(s):d,g=(d<0?this.THEAD:this.TBODY).childNodes[h];return g?.childNodes[c]}getRowHeaders(s){const c=[],u=this.wtSettings.getSetting("rowHeaders").length;for(let d=0;d<u;d++){const h=this.TBODY.childNodes[this.rowFilter.sourceToRendered(s)],f=h?.childNodes[d];f&&c.push(f)}return c}getCoords(s){let c=s;if(c.nodeName!=="TD"&&c.nodeName!=="TH"&&(c=closest(c,["TD","TH"])),c===null)return null;const u=c.parentNode;if(!u)return null;const d=u.parentNode;let h=index(u),f=c.cellIndex;overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,c,this.wtRootElement)||overlayContainsElement(CLONE_TOP,c,this.wtRootElement)?d.nodeName==="THEAD"&&(h-=d.childNodes.length):overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,c,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM,c,this.wtRootElement)?h=this.wtSettings.getSetting("totalRows")-d.childNodes.length+h:d===this.THEAD?h=this.rowFilter.visibleColHeadedRowToSourceRow(h):this.rowFilter&&(h=this.rowFilter.renderedToSource(h)),overlayContainsElement(CLONE_TOP_INLINE_START_CORNER,c,this.wtRootElement)||overlayContainsElement(CLONE_INLINE_START,c,this.wtRootElement)||overlayContainsElement(CLONE_BOTTOM_INLINE_START_CORNER,c,this.wtRootElement)?f=this.columnFilter.offsettedTH(f):this.columnFilter&&(f=this.columnFilter.visibleRowHeadedColumnToSourceColumn(f));const g=this.wtSettings.getSetting("onModifyGetCoordsElement",h,f);return g&&Array.isArray(g)&&([h,f]=g),this.wot.createCellCoords(h,f)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let s=this.TBODY.childNodes.length;const c=this.wtSettings.getSetting("stylesHandler"),u=s*c.getDefaultRowHeight(),d=innerHeight$1(this.TBODY)-1,h=c.areCellsBorderBox(),f=h?outerHeight:innerHeight$1,g=h?0:1,m=h?1:0;let p,v,w,E,C;if(!(u===d&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;s;){s-=1,w=this.rowFilter.renderedToSource(s),p=this.getRowHeight(w),E=this.getTrForRow(w),C=E.querySelector("th");const b=w===0?m:0;C?v=f(C):v=f(E)-g,(!p&&c.getDefaultRowHeight()<v-b||p<v)&&(h||(v+=1),this.dataAccessObject.wtViewport.oversizedRows[w]=v)}}getTrForRow(s){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(s)]}isColumnHeaderRendered(s){if(s>=0)return!1;const u=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(s)<=u}isRowHeaderRendered(s){if(s>=0)return!1;const u=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(s)<=u}isRowBeforeRenderedRows(s){const c=this.getFirstRenderedRow();return s<0&&c<=0?!this.isRowHeaderRendered(s):s<c}isRowAfterRenderedRows(s){return s>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(s){const c=this.getFirstRenderedColumn();return s<0&&c<=0?!this.isColumnHeaderRendered(s):s<c}isColumnAfterRenderedColumns(s){return this.columnFilter&&s>this.getLastRenderedColumn()}isColumnAfterViewport(s){return this.columnFilter&&s>this.getLastVisibleColumn()}isRowAfterViewport(s){return this.rowFilter&&s>this.getLastVisibleRow()}isColumnBeforeViewport(s){return this.columnFilter&&this.columnFilter.sourceToRendered(s)<0&&s>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(s){return this.rowUtils.getHeight(s)}getColumnHeaderHeight(s){return this.columnUtils.getHeaderHeight(s)}getColumnWidth(s){return this.columnUtils.getWidth(s)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return outerWidth(this.TABLE)}getHeight(){return outerHeight(this.TABLE)}getTotalWidth(){const s=outerWidth(this.hider);return s!==0?s:this.getWidth()}getTotalHeight(){const s=outerHeight(this.hider);return s!==0?s:this.getHeight()}isVisible(){return isVisible(this.TABLE)}_modifyRowHeaderWidth(s){let c=isFunction(s)?s():null;return Array.isArray(c)?(c=[...c],c[c.length-1]=this._correctRowHeaderWidth(c[c.length-1])):c=this._correctRowHeaderWidth(c),c}_correctRowHeaderWidth(s){let c=s;return typeof s!="number"&&(c=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(c+=1),c}}const MIXIN_NAME$6="stickyRowsBottom",stickyRowsBottom={getFirstRenderedRow(){const a=this.getRenderedRowsCount();return a===0?-1:this.wtSettings.getSetting("totalRows")-a},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};defineGetter(stickyRowsBottom,"MIXIN_NAME",MIXIN_NAME$6,{writable:!1,enumerable:!1});const MIXIN_NAME$5="stickyColumnsStart",stickyColumnsStart={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(stickyColumnsStart,"MIXIN_NAME",MIXIN_NAME$5,{writable:!1,enumerable:!1});class BottomInlineStartCornerOverlayTable extends Table{constructor(s,c,u,d){super(s,c,u,d,CLONE_BOTTOM_INLINE_START_CORNER)}}mixin(BottomInlineStartCornerOverlayTable,stickyRowsBottom),mixin(BottomInlineStartCornerOverlayTable,stickyColumnsStart);const CLONE_TOP="top",CLONE_BOTTOM="bottom",CLONE_INLINE_START="inline_start",CLONE_TOP_INLINE_START_CORNER="top_inline_start_corner",CLONE_BOTTOM_INLINE_START_CORNER="bottom_inline_start_corner",CLONE_TYPES=[CLONE_TOP,CLONE_BOTTOM,CLONE_INLINE_START,CLONE_TOP_INLINE_START_CORNER,CLONE_BOTTOM_INLINE_START_CORNER],CLONE_CLASS_NAMES=new Map([[CLONE_TOP,`ht_clone_${CLONE_TOP}`],[CLONE_BOTTOM,`ht_clone_${CLONE_BOTTOM}`],[CLONE_INLINE_START,`ht_clone_${CLONE_INLINE_START} ht_clone_left`],[CLONE_TOP_INLINE_START_CORNER,`ht_clone_${CLONE_TOP_INLINE_START_CORNER} ht_clone_top_left_corner`],[CLONE_BOTTOM_INLINE_START_CORNER,`ht_clone_${CLONE_BOTTOM_INLINE_START_CORNER} ht_clone_bottom_left_corner`]]);function _classPrivateMethodInitSpec$Z(a,s){_checkPrivateRedeclaration$1g(a,s),s.add(a)}function _checkPrivateRedeclaration$1g(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1K(a,s,c){return(s=_toPropertyKey$1L(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1L(a){var s=_toPrimitive$1L(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1L(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$1g(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _Scroll_brand=new WeakSet;class Scroll{constructor(s){_classPrivateMethodInitSpec$Z(this,_Scroll_brand),_defineProperty$1K(this,"dataAccessObject",void 0),this.dataAccessObject=s}scrollViewport(s,c,u){if(s.col<0||s.row<0)return!1;const d=this.scrollViewportHorizontally(s.col,c),h=this.scrollViewportVertically(s.row,u);return d||h}scrollViewportHorizontally(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:u,totalColumns:d}=this.dataAccessObject;if(!u)return!1;const h=createObjectPropListener(c);if(s=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",s,h),!Number.isInteger(s)||s<0||s>d)return!1;c=h.value;const{fixedColumnsStart:f,inlineStartOverlay:g}=this.dataAccessObject,m=c==="auto";if(m&&s<f)return!1;const p=this.getFirstVisibleColumn(),v=this.getLastVisibleColumn();let w=!1;return(m&&(s<p||s>v)||!m)&&(w=g.scrollTo(s,m?s>=this.getLastPartiallyVisibleColumn():c==="end")),w}scrollViewportVertically(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:u,totalRows:d}=this.dataAccessObject;if(!u)return!1;const h=createObjectPropListener(c);if(s=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",s,h),!Number.isInteger(s)||s<0||s>d)return!1;c=h.value;const{fixedRowsBottom:f,fixedRowsTop:g,topOverlay:m}=this.dataAccessObject,p=c==="auto";if(p&&(s<g||s>d-f-1))return!1;const v=this.getFirstVisibleRow(),w=this.getLastVisibleRow();let E=!1;return(p&&(s<v||s>w)||!p)&&(E=m.scrollTo(s,p?s>=this.getLastPartiallyVisibleRow():c==="bottom")),E}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return _assertClassBrand$1g(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return _assertClassBrand$1g(_Scroll_brand,this,_getLastRowIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return _assertClassBrand$1g(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return _assertClassBrand$1g(_Scroll_brand,this,_getLastColumnIndex).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function _getLastColumnIndex(a){const{wtSettings:s,inlineStartOverlay:c,wtTable:u,wtViewport:d,totalColumns:h,rootWindow:f}=this.dataAccessObject;if(c.mainTableScrollableElement===f){const g=s.getSetting("rtlMode");let m=null;if(g){const v=u.TABLE.getBoundingClientRect(),E=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;m=Math.abs(v.right-E)}else m=offset(u.wtRootElement).left;const p=Math.abs(getScrollLeft(f,f));if(m>p){const v=innerWidth$1(f);let w=d.getRowHeaderWidth();for(let E=1;E<=h;E++)if(w+=c.sumCellSizes(E-1,E),m+w-p>=v){a=E-2;break}}}return a}function _getLastRowIndex(a){const{topOverlay:s,wtTable:c,wtViewport:u,totalRows:d,rootWindow:h}=this.dataAccessObject;if(s.mainTableScrollableElement===h){const f=offset(c.wtRootElement),g=getScrollTop(h,h);if(f.top>g){const m=innerHeight$1(h);let p=u.getColumnHeaderHeight();for(let v=1;v<=d;v++)if(p+=s.sumCellSizes(v-1,v),f.top+p-g>=m){a=v-2;break}}}return a}function _defineProperty$1J(a,s,c){return(s=_toPropertyKey$1K(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1K(a){var s=_toPrimitive$1K(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1K(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CoreAbstract{get eventManager(){return new EventManager(this)}constructor(s,c){_defineProperty$1J(this,"wtTable",void 0),_defineProperty$1J(this,"wtScroll",void 0),_defineProperty$1J(this,"wtViewport",void 0),_defineProperty$1J(this,"wtOverlays",void 0),_defineProperty$1J(this,"selectionManager",void 0),_defineProperty$1J(this,"wtEvent",void 0),_defineProperty$1J(this,"guid",`wt_${randomString()}`),_defineProperty$1J(this,"drawInterrupted",!1),_defineProperty$1J(this,"drawn",!1),_defineProperty$1J(this,"activeOverlayName","master"),_defineProperty$1J(this,"domBindings",void 0),_defineProperty$1J(this,"wtSettings",void 0),this.domBindings={rootTable:s,rootDocument:s.ownerDocument,rootWindow:s.ownerDocument.defaultView},this.wtSettings=c,this.wtScroll=new Scroll(this.createScrollDao())}findOriginalHeaders(){const s=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let c=0,u=this.wtTable.THEAD.childNodes[0].childNodes.length;c<u;c++)s.push(this.wtTable.THEAD.childNodes[0].childNodes[c].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(c,u){fastInnerText(u,s[c])}])}}createCellCoords(s,c){return new CellCoords(s,c,this.wtSettings.getSetting("rtlMode"))}createCellRange(s,c,u){return new CellRange(s,c,u,this.wtSettings.getSetting("rtlMode"))}draw(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||hasZeroHeight(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(s),this}getCell(s){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(s);const u=this.wtSettings.getSetting("totalRows"),d=this.wtSettings.getSetting("fixedRowsTop"),h=this.wtSettings.getSetting("fixedRowsBottom"),f=this.wtSettings.getSetting("fixedColumnsStart");if(s.row<d&&s.col<f)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(s);if(s.row<d)return this.wtOverlays.topOverlay.clone.wtTable.getCell(s);if(s.col<f&&s.row>=u-h){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(s)}else{if(s.col<f)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(s);if(s.row<u&&s.row>=u-h&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(s)}return this.wtTable.getCell(s)}scrollViewport(s,c,u){return this.wtScroll.scrollViewport(s,c,u)}scrollViewportHorizontally(s,c){return this.wtScroll.scrollViewportHorizontally(s,c)}scrollViewportVertically(s,c){return this.wtScroll.scrollViewportVertically(s,c)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const s=this;return{get drawn(){return s.drawn},get topOverlay(){return s.wtOverlays.topOverlay},get inlineStartOverlay(){return s.wtOverlays.inlineStartOverlay},get wtTable(){return s.wtTable},get wtViewport(){return s.wtViewport},get wtSettings(){return s.wtSettings},get rootWindow(){return s.domBindings.rootWindow},get totalRows(){return s.wtSettings.getSetting("totalRows")},get totalColumns(){return s.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return s.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return s.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return s.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const s=this;return{get wot(){return s},get parentTableOffset(){return s.cloneSource.wtTable.tableOffset},get cloneSource(){return s.cloneSource},get workspaceWidth(){return s.wtViewport.getWorkspaceWidth()},get wtViewport(){return s.wtViewport},get wtOverlays(){return s.wtOverlays},get selectionManager(){return s.selectionManager},get drawn(){return s.drawn},set drawn(c){s.drawn=c},get wtTable(){return s.wtTable},get startColumnRendered(){return s.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return s.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return s.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return s.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return s.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return s.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return s.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return s.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return s.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return s.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return s.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return s.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return s.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return s.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return s.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return s.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return s.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return s.wtSettings.getSetting("rowHeaders")}}}}function _defineProperty$1I(a,s,c){return(s=_toPropertyKey$1J(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1J(a){var s=_toPrimitive$1J(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1J(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Clone extends CoreAbstract{constructor(s,c,u){super(s,c),_defineProperty$1I(this,"cloneSource",void 0),_defineProperty$1I(this,"cloneOverlay",void 0);const d=this.wtSettings.getSetting("facade",this);this.cloneSource=u.source,this.cloneOverlay=u.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),d,this.domBindings,this.wtSettings),this.wtViewport=u.viewport,this.selectionManager=u.selectionManager,this.wtEvent=new Event$1(d,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,u.event),this.findOriginalHeaders()}}function _defineProperty$1H(a,s,c){return(s=_toPropertyKey$1I(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1I(a){var s=_toPrimitive$1I(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1I(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Overlay{constructor(s,c,u,d,h){_defineProperty$1H(this,"wtSettings",null),defineGetter(this,"wot",s,{writable:!1}),this.domBindings=h,this.facadeGetter=c,this.wtSettings=d;const{TABLE:f,hider:g,spreader:m,holder:p,wtRootElement:v}=this.wot.wtTable;this.instance=this.wot,this.type=u,this.mainTableScrollableElement=null,this.TABLE=f,this.hider=g,this.spreader=m,this.holder=p,this.wtRootElement=v,this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(s){s==="before"&&this.shouldBeRendered()?this.needFullRender=!0:s==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=getTrimmingContainer(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:s}=this.wot,{rootWindow:c}=this.domBindings;c.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=getScrollableElement(s.TABLE)}getRelativeCellPosition(s,c,u){if(this.clone.wtTable.holder.contains(s)===!1){warn$1(`The provided element is not a child of the ${this.type} overlay`);return}const d=this.mainTableScrollableElement===this.domBindings.rootWindow,h=u<this.wtSettings.getSetting("fixedColumnsStart"),f=c<this.wtSettings.getSetting("fixedRowsTop"),g=c>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),m=this.clone.wtTable.spreader,p={start:this.getRelativeStartPosition(m),top:m.offsetTop},v={start:this.getRelativeStartPosition(s),top:s.offsetTop};let w=null;return d?w=this.getRelativeCellPositionWithinWindow(f,h,v,p):w=this.getRelativeCellPositionWithinHolder(f,g,h,v,p),w}getRelativeStartPosition(s){return this.isRtl()?s.offsetParent.offsetWidth-s.offsetLeft-s.offsetWidth:s.offsetLeft}getRelativeCellPositionWithinWindow(s,c,u,d){const h=this.wot.wtTable.wtRootElement.getBoundingClientRect();let f=0,g=0;if(!c)f=d.start;else{let m=h.left;this.isRtl()&&(m=this.domBindings.rootWindow.innerWidth-(h.left+h.width+getScrollbarWidth())),f=m<=0?-1*m:0}return s?g=this.clone.wtTable.TABLE.getBoundingClientRect().top-h.top:g=d.top,{start:u.start+f,top:u.top+g}}getRelativeCellPositionWithinHolder(s,c,u,d,h){const f={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let g=0,m=0;if(u||(g=f.horizontal-h.start),c){const p=this.wot.wtTable.wtRootElement.getBoundingClientRect();m=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+p.top}else s||(m=f.vertical-h.top);return{start:d.start-g,top:d.top-m}}makeClone(){if(CLONE_TYPES.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:s,wtSettings:c}=this.wot,{rootDocument:u,rootWindow:d}=this.domBindings,h=u.createElement("div"),f=u.createElement("table"),g=s.wtRootElement.parentNode;h.className=`${CLONE_CLASS_NAMES.get(this.type)} handsontable`,h.setAttribute("dir",this.isRtl()?"rtl":"ltr"),h.style.position="absolute",h.style.top=0,h.style.overflow="visible",this.isRtl()?h.style.right=0:h.style.left=0,c.getSetting("ariaTags")&&setAttribute(h,[A11Y_PRESENTATION()]),f.className=s.TABLE.className,s.TABLE.getAttribute("role")&&f.setAttribute("role",s.TABLE.getAttribute("role")),h.appendChild(f),g.appendChild(h);const p=this.wtSettings.getSetting("preventOverflow");return p===!0||p==="horizontal"&&this.type===CLONE_TOP||p==="vertical"&&this.type===CLONE_INLINE_START?this.mainTableScrollableElement=d:d.getComputedStyle(g).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=s.holder:this.mainTableScrollableElement=getScrollableElement(s.TABLE),new Clone(f,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const c=this.clone.cloneSource;c.activeOverlayName=this.clone.wtTable.name,this.clone.draw(s),c.activeOverlayName="master"}}reset(){const s=this.clone.wtTable.holder,c=this.clone.wtTable.hider,u=s.style,d=c.style,h=s.parentNode.style;[u,d,h].forEach(f=>{f.width="",f.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class BottomInlineStartCornerOverlay extends Overlay{constructor(s,c,u,d,h,f){super(s,c,CLONE_BOTTOM_INLINE_START_CORNER,u,d),this.bottomOverlay=h,this.inlineStartOverlay=f}createTable(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return new BottomInlineStartCornerOverlayTable(...c)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:s}=this;if(this.updateTrimmingContainer(),!s.wtTable.holder.parentNode)return!1;const c=this.clone.wtTable.holder.parentNode;if(c.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const h=this.inlineStartOverlay.getOverlayOffset(),f=this.bottomOverlay.getOverlayOffset();c.style[this.isRtl()?"right":"left"]=`${h}px`,c.style.bottom=`${f}px`}else resetCssTransform(c),this.repositionOverlay();let u=outerHeight(this.clone.wtTable.TABLE);const d=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(u=0),c.style.height=`${u}px`,c.style.width=`${d}px`,!1}repositionOverlay(){const{wtTable:s,wtViewport:c}=this.wot,{rootDocument:u}=this.domBindings,d=this.clone.wtTable.holder.parentNode;let h=0;c.hasVerticalScroll()||(h+=c.getWorkspaceHeight()-s.getTotalHeight()),c.hasVerticalScroll()&&c.hasHorizontalScroll()&&(h+=getScrollbarWidth(u)),d.style.bottom=`${h}px`}}const MIXIN_NAME$4="calculatedColumns",calculatedColumns={getFirstRenderedColumn(){const a=this.dataAccessObject.startColumnRendered;return a===null?-1:a},getFirstVisibleColumn(){const a=this.dataAccessObject.startColumnVisible;return a===null?-1:a},getFirstPartiallyVisibleColumn(){const a=this.dataAccessObject.startColumnPartiallyVisible;return a===null?-1:a},getLastRenderedColumn(){const a=this.dataAccessObject.endColumnRendered;return a===null?-1:a},getLastVisibleColumn(){const a=this.dataAccessObject.endColumnVisible;return a===null?-1:a},getLastPartiallyVisibleColumn(){const a=this.dataAccessObject.endColumnPartiallyVisible;return a===null?-1:a},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};defineGetter(calculatedColumns,"MIXIN_NAME",MIXIN_NAME$4,{writable:!1,enumerable:!1});class BottomOverlayTable extends Table{constructor(s,c,u,d){super(s,c,u,d,CLONE_BOTTOM)}}mixin(BottomOverlayTable,stickyRowsBottom),mixin(BottomOverlayTable,calculatedColumns);function _defineProperty$1G(a,s,c){return(s=_toPropertyKey$1H(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1H(a){var s=_toPrimitive$1H(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1H(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class BottomOverlay extends Overlay{constructor(s,c,u,d){super(s,c,CLONE_BOTTOM,u,d),_defineProperty$1G(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return new BottomOverlayTable(...c)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:s}=this.domBindings,c=this.clone.wtTable.holder.parentNode;c.style.top="";let u=0;const d=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===s&&(!d||d!=="vertical")?(u=this.getOverlayOffset(),c.style.bottom=`${u}px`):(u=this.getScrollPosition(),this.repositionOverlay());const h=this.adjustHeaderBordersPosition(u);return this.adjustElementsSize(),h}repositionOverlay(){const{wtTable:s,wtViewport:c}=this.wot,{rootDocument:u}=this.domBindings,d=this.clone.wtTable.holder.parentNode;let h=0;c.hasVerticalScroll()||(h+=c.getWorkspaceHeight()-s.getTotalHeight()),c.hasVerticalScroll()&&c.hasHorizontalScroll()&&(h+=getScrollbarWidth(u)),d.style.bottom=`${h}px`}setScrollPosition(s){const{rootWindow:c}=this.domBindings,u=this.mainTableScrollableElement;let d=!1;if(u===c&&s!==c.scrollY){const h=c.scrollY;c.scrollTo(getWindowScrollLeft(c),top),d=h!==c.scrollY}else if(s!==u.scrollTop){const h=u.scrollTop;u.scrollTop=s,d=h!==u.scrollTop}return d}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(s,c){const{wtTable:u,wtSettings:d}=this.wot,h=d.getSetting("stylesHandler").getDefaultRowHeight();let f=s,g=0;for(;f<c;){const m=u.getRowHeight(f);g+=m===void 0?h:m,f+=1}return g}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:s,wtViewport:c}=this.wot,{rootDocument:u,rootWindow:d}=this.domBindings,f=this.clone.wtTable.holder.parentNode.style,g=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==d||g==="horizontal"){let p=c.getWorkspaceWidth();c.hasVerticalScroll()&&(p-=getScrollbarWidth(u)),p=Math.min(p,s.wtRootElement.scrollWidth),f.width=`${p}px`}else f.width="";this.clone.wtTable.holder.style.width=f.width;let m=outerHeight(this.clone.wtTable.TABLE);s.hasDefinedSize()||(m=0),f.height=`${m}px`}adjustRootChildrenSize(){const{holder:s}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,s.style.width=s.parentNode.style.width,s.style.height=s.parentNode.style.height}applyToDOM(){const s=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(s===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const s=this.isRtl()?"right":"left",{spreader:c}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?c.style[s]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:c.style[s]=""}scrollTo(s,c){let u=this.getTableParentOffset();const h=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let f=0;c&&h.offsetHeight!==h.clientHeight&&(f=getScrollbarWidth(this.domBindings.rootDocument)),c?(u+=this.sumCellSizes(0,s+1),u-=this.wot.wtViewport.getViewportHeight(),u+=1):u+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),s),u+=f,this.setScrollPosition(u)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:s}=this.domBindings,c=this.wtSettings.getSetting("preventOverflow");let u=0;if(this.trimmingContainer===s&&(!c||c!=="vertical")){const d=this.wot.wtTable.getTotalHeight(),h=this.clone.wtTable.getTotalHeight(),f=d-h,g=this.domBindings.rootDocument.documentElement.clientHeight;u=Math.max(this.getTableParentOffset()-this.getScrollPosition()-g+d,0),u>f&&(u=0)}return u}adjustHeaderBordersPosition(s){const c=this.wtSettings.getSetting("fixedRowsBottom"),u=this.cachedFixedRowsBottom!==c,d=this.wtSettings.getSetting("columnHeaders");let h=!1;if((u||c===0)&&d.length>0){const f=this.wot.wtTable.holder.parentNode,g=hasClass$1(f,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),s||this.wtSettings.getSetting("totalRows")===0?(addClass$1(f,"innerBorderBottom"),h=!g):(removeClass$1(f,"innerBorderBottom"),h=g)}return h}}const MIXIN_NAME$3="calculatedRows",calculatedRows={getFirstRenderedRow(){const a=this.dataAccessObject.startRowRendered;return a===null?-1:a},getFirstVisibleRow(){const a=this.dataAccessObject.startRowVisible;return a===null?-1:a},getFirstPartiallyVisibleRow(){const a=this.dataAccessObject.startRowPartiallyVisible;return a===null?-1:a},getLastRenderedRow(){const a=this.dataAccessObject.endRowRendered;return a===null?-1:a},getLastVisibleRow(){const a=this.dataAccessObject.endRowVisible;return a===null?-1:a},getLastPartiallyVisibleRow(){const a=this.dataAccessObject.endRowPartiallyVisible;return a===null?-1:a},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(calculatedRows,"MIXIN_NAME",MIXIN_NAME$3,{writable:!1,enumerable:!1});class InlineStartOverlayTable extends Table{constructor(s,c,u,d){super(s,c,u,d,CLONE_INLINE_START)}}mixin(InlineStartOverlayTable,calculatedRows),mixin(InlineStartOverlayTable,stickyColumnsStart);const MIXIN_NAME$2="localHooks",localHooks={_localHooks:Object.create(null),addLocalHook(a,s){return this._localHooks[a]||(this._localHooks[a]=[]),this._localHooks[a].push(s),this},removeLocalHook(a,s){if(this._localHooks[a]){const c=this._localHooks[a].indexOf(s);c>-1&&this._localHooks[a].splice(c,1)}return this},runLocalHooks(a,s,c,u,d,h,f){if(this._localHooks[a]){const g=this._localHooks[a].length;for(let m=0;m<g;m++)fastCall(this._localHooks[a][m],this,s,c,u,d,h,f)}},clearLocalHooks(){return this._localHooks={},this}};defineGetter(localHooks,"MIXIN_NAME",MIXIN_NAME$2,{writable:!1,enumerable:!1});let Selection$1=class{constructor(s,c){this.settings=s,this.cellRange=c||null}isEmpty(){return this.cellRange===null}add(s){return this.isEmpty()?this.cellRange=this.settings.createCellRange(s):this.cellRange.expand(s),this}replace(s,c){if(!this.isEmpty()){if(this.cellRange.from.isEqual(s))return this.cellRange.from=c,!0;if(this.cellRange.to.isEqual(s))return this.cellRange.to=c,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const s=this.cellRange.getOuterTopStartCorner(),c=this.cellRange.getOuterBottomEndCorner();return[s.row,s.col,c.row,c.col]}destroy(){this.runLocalHooks("destroy")}};mixin(Selection$1,localHooks);const ACTIVE_HEADER_TYPE="active-header",HEADER_TYPE="header",AREA_TYPE="area",FOCUS_TYPE="focus",FILL_TYPE="fill",ROW_TYPE="row",COLUMN_TYPE="column",CUSTOM_SELECTION_TYPE="custom-selection",getCornerStyle=a=>{const s=a.wtSettings.getSetting("stylesHandler");if(s.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const c=s.getCSSVariableValue("cell-autofill-size"),u=s.getCSSVariableValue("cell-autofill-border-width"),d=s.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:c,height:c,borderWidth:u,borderStyle:"solid",borderColor:d})};var es_array_unscopables_flat={},hasRequiredEs_array_unscopables_flat;function requireEs_array_unscopables_flat(){if(hasRequiredEs_array_unscopables_flat)return es_array_unscopables_flat;hasRequiredEs_array_unscopables_flat=1;var a=requireAddToUnscopables();return a("flat"),es_array_unscopables_flat}requireEs_array_unscopables_flat();function _classPrivateMethodInitSpec$Y(a,s){_checkPrivateRedeclaration$1f(a,s),s.add(a)}function _classPrivateFieldInitSpec$X(a,s,c){_checkPrivateRedeclaration$1f(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1f(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$X(a,s){return a.get(_assertClassBrand$1f(a,s))}function _classPrivateFieldSet$U(a,s,c){return a.set(_assertClassBrand$1f(a,s),c),c}function _assertClassBrand$1f(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _selection=new WeakMap,_activeOverlaysWot$1=new WeakMap,_SelectionScanner_brand=new WeakSet;class SelectionScanner{constructor(){_classPrivateMethodInitSpec$Y(this,_SelectionScanner_brand),_classPrivateFieldInitSpec$X(this,_selection,void 0),_classPrivateFieldInitSpec$X(this,_activeOverlaysWot$1,void 0)}setActiveOverlay(s){return _classPrivateFieldSet$U(_activeOverlaysWot$1,this,s),this}setActiveSelection(s){return _classPrivateFieldSet$U(_selection,this,s),this}scan(){const s=_classPrivateFieldGet$X(_selection,this).settings.selectionType,c=new Set;return s==="active-header"?(this.scanColumnsInHeadersRange(u=>c.add(u)),this.scanRowsInHeadersRange(u=>c.add(u))):s==="area"?this.scanCellsRange(u=>c.add(u)):s==="focus"?(this.scanColumnsInHeadersRange(u=>c.add(u)),this.scanRowsInHeadersRange(u=>c.add(u)),this.scanCellsRange(u=>c.add(u))):s==="fill"?this.scanCellsRange(u=>c.add(u)):s==="header"?(this.scanColumnsInHeadersRange(u=>c.add(u)),this.scanRowsInHeadersRange(u=>c.add(u))):s==="row"?(this.scanRowsInHeadersRange(u=>c.add(u)),this.scanRowsInCellsRange(u=>c.add(u))):s==="column"&&(this.scanColumnsInHeadersRange(u=>c.add(u)),this.scanColumnsInCellsRange(u=>c.add(u))),c}scanColumnsInHeadersRange(s){const[c,u,d,h]=_classPrivateFieldGet$X(_selection,this).getCorners(),{wtTable:f}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this),g=f.getRenderedColumnsCount(),m=f.getColumnHeadersCount();let p=0;for(let v=-f.getRowHeadersCount();v<g;v++){const w=f.columnFilter.renderedToSource(v);if(!(w<u||w>h)){for(let E=-m;E<0;E++){if(E<c||E>d)continue;const C=E+m;let b=f.getColumnHeader(w,C);const P=_classPrivateFieldGet$X(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingColumnHeader",w,C,{selectionType:_classPrivateFieldGet$X(_selection,this).settings.selectionType,columnCursor:p,selectionWidth:h-u+1});P!==null&&(P!==w&&(b=f.getColumnHeader(P,C)),s(b))}p+=1}}}scanRowsInHeadersRange(s){const[c,u,d,h]=_classPrivateFieldGet$X(_selection,this).getCorners(),{wtTable:f}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this),g=f.getRenderedRowsCount(),m=f.getRowHeadersCount();let p=0;for(let v=-f.getColumnHeadersCount();v<g;v++){const w=f.rowFilter.renderedToSource(v);if(!(w<c||w>d)){for(let E=-m;E<0;E++){if(E<u||E>h)continue;const C=E+m;let b=f.getRowHeader(w,C);const P=_classPrivateFieldGet$X(_activeOverlaysWot$1,this).getSetting("onBeforeHighlightingRowHeader",w,C,{selectionType:_classPrivateFieldGet$X(_selection,this).settings.selectionType,rowCursor:p,selectionHeight:d-c+1});P!==null&&(P!==w&&(b=f.getRowHeader(P,C)),s(b))}p+=1}}}scanCellsRange(s){const{wtTable:c}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this);_assertClassBrand$1f(_SelectionScanner_brand,this,_scanCellsRange).call(this,(u,d)=>{const h=c.getCell(_classPrivateFieldGet$X(_activeOverlaysWot$1,this).createCellCoords(u,d)),f=_classPrivateFieldGet$X(_activeOverlaysWot$1,this).getSetting("onAfterDrawSelection",u,d,_classPrivateFieldGet$X(_selection,this).settings.layerLevel);typeof f=="string"&&addClass$1(h,f),s(h)})}scanRowsInCellsRange(s){const[c,,u]=_classPrivateFieldGet$X(_selection,this).getCorners(),{wtTable:d}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this);_assertClassBrand$1f(_SelectionScanner_brand,this,_scanViewportRange).call(this,(h,f)=>{if(h>=c&&h<=u){const g=d.getCell(_classPrivateFieldGet$X(_activeOverlaysWot$1,this).createCellCoords(h,f));s(g)}})}scanColumnsInCellsRange(s){const[,c,,u]=_classPrivateFieldGet$X(_selection,this).getCorners(),{wtTable:d}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this);_assertClassBrand$1f(_SelectionScanner_brand,this,_scanViewportRange).call(this,(h,f)=>{if(f>=c&&f<=u){const g=d.getCell(_classPrivateFieldGet$X(_activeOverlaysWot$1,this).createCellCoords(h,f));s(g)}})}}function _scanCellsRange(a){let[s,c,u,d]=_classPrivateFieldGet$X(_selection,this).getCorners();if(s<0&&u<0||c<0&&d<0)return;const{wtTable:h}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this),f=s!==u||c!==d;if(c=Math.max(c,0),d=Math.max(d,0),s=Math.max(s,0),u=Math.max(u,0),f){if(c=Math.max(c,h.getFirstRenderedColumn()),d=Math.min(d,h.getLastRenderedColumn()),s=Math.max(s,h.getFirstRenderedRow()),u=Math.min(u,h.getLastRenderedRow()),d<c||u<s)return}else{const g=h.getCell(_classPrivateFieldGet$X(_activeOverlaysWot$1,this).createCellCoords(s,c));if(!isHTMLElement(g))return}for(let g=s;g<=u;g+=1)for(let m=c;m<=d;m+=1)a(g,m)}function _scanViewportRange(a){const{wtTable:s}=_classPrivateFieldGet$X(_activeOverlaysWot$1,this),c=s.getRenderedRowsCount(),u=s.getRenderedColumnsCount();for(let d=0;d<c;d+=1){const h=s.rowFilter.renderedToSource(d);for(let f=0;f<u;f+=1)a(h,s.columnFilter.renderedToSource(f))}}const BORDER_STYLE_CLASS_PREFIX="ht-border-style-",BORDER_STYLE_VERTICAL_SUFFIX="-vertical",BORDER_STYLE_HORIZONTAL_SUFFIX="-horizontal";class Border{constructor(s,c){c&&(this.eventManager=s.eventManager,this.instance=s,this.wot=s,this.settings=c,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=getCornerStyle(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(c),this.registerListeners())}registerListeners(){const s=this.wot.rootDocument.body;this.eventManager.addEventListener(s,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(s,"mouseup",()=>this.onMouseUp());for(let c=0,u=this.main.childNodes.length;c<u;c++){const d=this.main.childNodes[c];this.eventManager.addEventListener(d,"mouseenter",h=>this.onMouseEnter(h,this.main.childNodes[c]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(s,c){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;s.preventDefault(),stopImmediatePropagation(s);const u=this,d=this.wot.rootDocument.body,h=c.getBoundingClientRect();c.style.display="none";function f(m){if(m.clientY<Math.floor(h.top)||m.clientY>Math.ceil(h.top+h.height)||m.clientX<Math.floor(h.left)||m.clientX>Math.ceil(h.left+h.width))return!0}function g(m){f(m)&&(u.eventManager.removeEventListener(d,"mousemove",g),c.style.display="block")}this.eventManager.addEventListener(d,"mousemove",g)}createBorders(s){const{rootDocument:c}=this.wot;this.main=c.createElement("div");const u=["top","start","bottom","end","corner"];let d=this.main.style;d.position="absolute",d.top=0,d.left=0;for(let g=0;g<5;g++){const m=u[g],p=c.createElement("div"),v=E=>this.settings[m]&&this.settings[m][E]?this.settings[m][E]:s.border[E];p.className=`wtBorder ${this.settings.className||""}`,this.settings[m]&&this.settings[m].hide&&(p.className+=" hidden"),d=p.style;const w=v("style");w?(["start","end"].includes(m)?p.className+=` ${BORDER_STYLE_CLASS_PREFIX}${w}${BORDER_STYLE_VERTICAL_SUFFIX}`:p.className+=` ${BORDER_STYLE_CLASS_PREFIX}${w}${BORDER_STYLE_HORIZONTAL_SUFFIX}`,d.setProperty("--ht-custom-border-size",`${v("width")}px`),d.setProperty("--ht-custom-border-color",v("color"))):d.backgroundColor=v("color"),d.height=`${v("width")}px`,d.width=`${v("width")}px`,this.main.appendChild(p)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:h}=this.wot;let f=h.bordersHolder;f||(f=c.createElement("div"),f.className="htBorders",h.bordersHolder=f,h.spreader.appendChild(f)),f.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:s,wtSettings:c}=this.wot,u=c.getSetting("stylesHandler"),d=u.getCSSVariableValue("cell-mobile-handle-size"),h=u.getCSSVariableValue("cell-mobile-handle-border-radius"),f=u.getCSSVariableValue("cell-mobile-handle-background-color"),g=u.getCSSVariableValue("cell-mobile-handle-border-width"),m=u.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:s.createElement("DIV"),topHitArea:s.createElement("DIV"),bottom:s.createElement("DIV"),bottomHitArea:s.createElement("DIV")};const p=10,v=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const w={position:"absolute",height:`${v}px`,width:`${v}px`,"border-radius":`${parseInt(v/1.5,10)}px`};objectEach(w,(C,b)=>{this.selectionHandles.styles.bottomHitArea[b]=C,this.selectionHandles.styles.topHitArea[b]=C});const E=u.isClassicTheme()?{position:"absolute",height:`${p}px`,width:`${p}px`,"border-radius":`${parseInt(p/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${d}px`,width:`${d}px`,"border-radius":`${h}px`,background:`${f}`,border:`${g}px solid ${m}`};objectEach(E,(C,b)=>{this.selectionHandles.styles.bottom[b]=C,this.selectionHandles.styles.top[b]=C}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(s,c){const u=this.wot.selectionManager.getAreaSelection();return!!(u.cellRange&&(s!==u.cellRange.to.row||c!==u.cellRange.to.col))}updateMultipleSelectionHandlesPosition(s,c,u,d,h,f){const m=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:p,topHitArea:v,bottom:w,bottomHitArea:E}=this.selectionHandles.styles,C=parseInt(p.borderWidth,10),b=parseInt(p.width,10),P=parseInt(v.width,10),R=this.wot.wtTable.getWidth(),T=this.wot.wtTable.getHeight();p.top=`${parseInt(u-b-1,10)}px`,p[m]=`${parseInt(d-b-1,10)}px`,v.top=`${parseInt(u-P/4*3,10)}px`,v[m]=`${parseInt(d-P/4*3,10)}px`;const I=Math.min(parseInt(d+h,10),R-b-C*2),M=Math.min(parseInt(d+h-P/4,10),R-P-C*2);w[m]=`${I}px`,E[m]=`${M}px`;const N=Math.min(parseInt(u+f,10),T-b-C*2),H=Math.min(parseInt(u+f-P/4,10),T-P-C*2);w.top=`${N}px`,E.top=`${H}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(p.display="block",v.display="block",this.isPartRange(s,c)?(w.display="none",E.display="none"):(w.display="block",E.display="block")):(p.display="none",w.display="none",v.display="none",E.display="none"),s===this.wot.wtSettings.getSetting("fixedRowsTop")||c===this.wot.wtSettings.getSetting("fixedColumnsStart")?(p.zIndex="9999",v.zIndex="9999"):(p.zIndex="",v.zIndex="")}appear(s){if(this.disabled)return;let[c,u,d,h]=s;if(c<0&&d<0||u<0&&h<0){this.disappear();return}const{wtTable:f,rootDocument:g,rootWindow:m}=this.wot,p=c!==d||u!==h,v=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),w=f.getFirstRenderedRow(),E=f.getLastRenderedRow(),C=f.getFirstRenderedColumn(),b=f.getLastRenderedColumn();if(C<0&&b<0||w<0&&E<0){this.disappear();return}let P;if(p){if(u=Math.max(u,C),h=Math.min(h,b),c=Math.max(c,w),d=Math.min(d,E),h<u||d<c){this.disappear();return}P=f.getCell(this.wot.createCellCoords(c,u))}else if(P=f.getCell(this.wot.createCellCoords(c,u)),!isHTMLElement(P)){this.disappear();return}const R=p?f.getCell(this.wot.createCellCoords(d,h)):P,T=offset(P),I=p?offset(R):T,M=offset(f.TABLE),N=T.top,H=T.left,L=this.wot.wtSettings.getSetting("rtlMode");let A=0,k=0;if(L){const Me=outerWidth(f.TABLE),Qe=outerWidth(P),Xe=m.innerWidth-M.left-Me;k=H+Qe-I.left,A=m.innerWidth-H-Qe-Xe-1}else k=I.left+outerWidth(R)-H,A=H-M.left-1;if(this.isEntireColumnSelected(c,d)){const Me=c,Qe=this.getDimensionsFromHeader("columns",u,h,Me,M);let Xe=null;Qe&&([Xe,A,k]=Qe),Xe&&(P=Xe)}let W=N-M.top-1,G=I.top+outerHeight(R)-N;if(this.isEntireRowSelected(u,h)){const Me=u,Qe=this.getDimensionsFromHeader("rows",c,d,Me,M);let Xe=null;Qe&&([Xe,W,G]=Qe),Xe&&(P=Xe)}const oe=m.getComputedStyle(P);parseInt(oe.borderTopWidth,10)>0&&(W+=1,G=G>0?G-1:0),parseInt(oe[L?"borderRightWidth":"borderLeftWidth"],10)>0&&(A+=1,k=k>0?k-1:0);const ae=L?"right":"left",X=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${W}px`,this.topStyle[ae]=`${A}px`,this.topStyle.width=`${k+X}px`,this.topStyle.display="block",this.startStyle.top=`${W}px`,this.startStyle[ae]=`${A}px`,this.startStyle.height=`${G+X}px`,this.startStyle.display="block",this.bottomStyle.top=`${W+G-parseInt(this.bottomStyle.height,10)+X}px`,this.bottomStyle[ae]=`${A}px`,this.bottomStyle.width=`${k+X}px`,this.bottomStyle.display="block",this.endStyle.top=`${W}px`,this.endStyle[ae]=`${A+k-parseInt(this.endStyle.width,10)+X}px`,this.endStyle.height=`${G+X}px`,this.endStyle.display="block";let le=this.settings.border.cornerVisible;le=typeof le=="function"?le(this.settings.layerLevel):le;const ye=this.wot.getSetting("onModifyGetCellCoords",d,h,!1,"render");let[pe,he]=[d,h];if(ye&&Array.isArray(ye)&&([,,pe,he]=ye),isMobileBrowser()||!le||this.isPartRange(pe,he))this.cornerStyle.display="none";else{this.cornerStyle.top=`${W+G+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[ae]=`${A+k+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Me=getTrimmingContainer(f.TABLE);const Qe=Me===m;Qe&&(Me=g.documentElement);const Xe=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,Ke=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),it=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(h===this.wot.getSetting("totalColumns")-1){const te=Qe?R.getBoundingClientRect().left:R.offsetLeft;let Pe=!1,U=0;if(L?(U=te-parseInt(this.cornerDefaultStyle.width,10)/2,Pe=U<0):(U=te+outerWidth(R)+parseInt(this.cornerDefaultStyle.width,10)/2,Pe=U>=innerWidth$1(Me)),Pe){const Q=Math.floor(A+k+this.cornerCenterPointOffset-Ke-Xe);v?(this.cornerStyle[ae]=`${Q}px`,this.cornerStyle[L?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[ae]=`${Q-1}px`}}if(d===this.wot.getSetting("totalRows")-1&&(Qe?R.getBoundingClientRect().top:R.offsetTop)+outerHeight(R)+parseInt(this.cornerDefaultStyle.height,10)/2>=innerHeight$1(Me)){const Q=Math.floor(W+G+this.cornerCenterPointOffset-it-Xe);v?(this.cornerStyle.top=`${Q}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${Q-1}px`}this.cornerStyle.display="block"}isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(d,h,W,A,k,G)}isEntireColumnSelected(s,c){return s===this.wot.wtTable.getFirstRenderedRow()&&c===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(s,c){return s===this.wot.wtTable.getFirstRenderedColumn()&&c===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(s,c,u,d,h){const{wtTable:f}=this.wot,g=f.wtRootElement.parentNode;let m=null,p=null,v=null,w=null,E=null,C=null,b=null,P=null;switch(s){case"rows":m=function(){return f.getRowHeader(...arguments)},p=function(){return outerHeight(...arguments)},v="ht__selection--rows",C="top";break;case"columns":m=function(){return f.getColumnHeader(...arguments)},p=function(){return outerWidth(...arguments)},v="ht__selection--columns",C="left";break}if(g.classList.contains(v)){const R=this.wot.getSetting("columnHeaders").length;if(b=m(c,R-d),P=m(u,R-d),!b||!P)return!1;const T=offset(b),I=offset(P);return b&&P&&(w=T[C]-h[C]-1,E=I[C]+p(P)-T[C]),[b,w,E]}return!1}changeBorderStyle(s,c){const u=this[s].style,d=c[s];!d||d.hide?addClass$1(this[s],"hidden"):(hasClass$1(this[s],"hidden")&&removeClass$1(this[s],"hidden"),u.backgroundColor=d.color,(s==="top"||s==="bottom")&&(u.height=`${d.width}px`),(s==="start"||s==="end")&&(u.width=`${d.width}px`))}changeBorderToDefaultStyle(s){const c={width:1,color:"#000"},u=this[s].style;u.backgroundColor=c.color,u.width=`${c.width}px`,u.height=`${c.width}px`}toggleHiddenClass(s,c){this.changeBorderToDefaultStyle(s),c?addClass$1(this[s],"hidden"):removeClass$1(this[s],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",isMobileBrowser()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function _classPrivateMethodInitSpec$X(a,s){_checkPrivateRedeclaration$1e(a,s),s.add(a)}function _classPrivateFieldInitSpec$W(a,s,c){_checkPrivateRedeclaration$1e(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1e(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$W(a,s){return a.get(_assertClassBrand$1e(a,s))}function _classPrivateFieldSet$T(a,s,c){return a.set(_assertClassBrand$1e(a,s),c),c}function _assertClassBrand$1e(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _activeOverlaysWot=new WeakMap,_selections=new WeakMap,_scanner=new WeakMap,_appliedClasses=new WeakMap,_destroyListeners=new WeakMap,_selectionBorders=new WeakMap,_SelectionManager_brand=new WeakSet;class SelectionManager{constructor(s){_classPrivateMethodInitSpec$X(this,_SelectionManager_brand),_classPrivateFieldInitSpec$W(this,_activeOverlaysWot,void 0),_classPrivateFieldInitSpec$W(this,_selections,void 0),_classPrivateFieldInitSpec$W(this,_scanner,new SelectionScanner),_classPrivateFieldInitSpec$W(this,_appliedClasses,new WeakMap),_classPrivateFieldInitSpec$W(this,_destroyListeners,new WeakSet),_classPrivateFieldInitSpec$W(this,_selectionBorders,new Map),_classPrivateFieldSet$T(_selections,this,s)}setActiveOverlay(s){return _classPrivateFieldSet$T(_activeOverlaysWot,this,s),_classPrivateFieldGet$W(_scanner,this).setActiveOverlay(_classPrivateFieldGet$W(_activeOverlaysWot,this)),_classPrivateFieldGet$W(_appliedClasses,this).has(_classPrivateFieldGet$W(_activeOverlaysWot,this))||_classPrivateFieldGet$W(_appliedClasses,this).set(_classPrivateFieldGet$W(_activeOverlaysWot,this),new Set),this}getFocusSelection(){return _classPrivateFieldGet$W(_selections,this)!==null?_classPrivateFieldGet$W(_selections,this).getFocus():null}getAreaSelection(){return _classPrivateFieldGet$W(_selections,this)!==null?_classPrivateFieldGet$W(_selections,this).createLayeredArea():null}getBorderInstance(s){if(!s.settings.border)return null;if(_classPrivateFieldGet$W(_selectionBorders,this).has(s)){const u=_classPrivateFieldGet$W(_selectionBorders,this).get(s);if(u.has(_classPrivateFieldGet$W(_activeOverlaysWot,this)))return u.get(_classPrivateFieldGet$W(_activeOverlaysWot,this));const d=new Border(_classPrivateFieldGet$W(_activeOverlaysWot,this),s.settings);return u.set(_classPrivateFieldGet$W(_activeOverlaysWot,this),d),d}const c=new Border(_classPrivateFieldGet$W(_activeOverlaysWot,this),s.settings);return _classPrivateFieldGet$W(_selectionBorders,this).set(s,new Map([[_classPrivateFieldGet$W(_activeOverlaysWot,this),c]])),c}getBorderInstances(s){var c,u;return Array.from((c=(u=_classPrivateFieldGet$W(_selectionBorders,this).get(s))===null||u===void 0?void 0:u.values())!==null&&c!==void 0?c:[])}destroyBorders(s){_classPrivateFieldGet$W(_selectionBorders,this).get(s).forEach(c=>c.destroy()),_classPrivateFieldGet$W(_selectionBorders,this).delete(s)}render(s){if(_classPrivateFieldGet$W(_selections,this)===null)return;s&&_assertClassBrand$1e(_SelectionManager_brand,this,_resetCells).call(this);const c=Array.from(_classPrivateFieldGet$W(_selections,this)),u=new Map,d=new Map;for(let h=0;h<c.length;h++){const f=c[h],{className:g,headerAttributes:m,createLayers:p,selectionType:v}=f.settings;_classPrivateFieldGet$W(_destroyListeners,this).has(f)||(_classPrivateFieldGet$W(_destroyListeners,this).add(f),f.addLocalHook("destroy",()=>this.destroyBorders(f)));const w=this.getBorderInstance(f);if(f.isEmpty()){w?.disappear();continue}g&&_classPrivateFieldGet$W(_scanner,this).setActiveSelection(f).scan().forEach(b=>{if(u.has(b)){const P=u.get(b);P.has(g)&&p===!0?P.set(g,P.get(g)+1):P.set(g,1)}else u.set(b,new Map([[g,1]]));m&&(d.has(b)||d.set(b,[]),b.nodeName==="TH"&&d.get(b).push(...m))});const E=f.getCorners();_classPrivateFieldGet$W(_activeOverlaysWot,this).getSetting("onBeforeDrawBorders",E,v),w?.appear(E)}u.forEach((h,f)=>{var g;const m=Array.from(h).map(p=>{let[v,w]=p;return w===1?v:[v,...Array.from({length:w-1},(E,C)=>`${v}-${C+1}`)]}).flat();m.forEach(p=>_classPrivateFieldGet$W(_appliedClasses,this).get(_classPrivateFieldGet$W(_activeOverlaysWot,this)).add(p)),addClass$1(f,m),f.nodeName==="TD"&&Array.isArray((g=_classPrivateFieldGet$W(_selections,this).options)===null||g===void 0?void 0:g.cellAttributes)&&setAttribute(f,_classPrivateFieldGet$W(_selections,this).options.cellAttributes)}),Array.from(d.keys()).forEach(h=>{setAttribute(h,[...d.get(h)])})}}function _resetCells(){const a=_classPrivateFieldGet$W(_appliedClasses,this).get(_classPrivateFieldGet$W(_activeOverlaysWot,this)),s=_classPrivateFieldGet$W(_activeOverlaysWot,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(s))for(let c=0;c<s.length;c++)a.add(s[c]);a.forEach(c=>{var u,d;const h=_classPrivateFieldGet$W(_activeOverlaysWot,this).wtTable.TABLE.querySelectorAll(`.${c}`);let f=[];Array.isArray((u=_classPrivateFieldGet$W(_selections,this).options)===null||u===void 0?void 0:u.cellAttributes)&&(f=_classPrivateFieldGet$W(_selections,this).options.cellAttributes.map(g=>g[0])),Array.isArray((d=_classPrivateFieldGet$W(_selections,this).options)===null||d===void 0?void 0:d.headerAttributes)&&(f=[...f,..._classPrivateFieldGet$W(_selections,this).options.headerAttributes.map(g=>g[0])]);for(let g=0,m=h.length;g<m;g++)removeClass$1(h[g],c),removeAttribute(h[g],f)}),a.clear()}class InlineStartOverlay extends Overlay{constructor(s,c,u,d){super(s,c,CLONE_INLINE_START,u,d)}createTable(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return new InlineStartOverlayTable(...c)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:s}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!s.holder.parentNode)return!1;const{rootWindow:c}=this.domBindings,u=this.clone.wtTable.holder.parentNode,d=this.wtSettings.getSetting("preventOverflow");let h=0;this.trimmingContainer===c&&(!d||d!=="horizontal")?(h=this.getOverlayOffset()*(this.isRtl()?-1:1),setOverlayPosition(u,`${h}px`,"0px")):(h=this.getScrollPosition(),resetCssTransform(u));const f=this.adjustHeaderBordersPosition(h);return this.adjustElementsSize(),f}setScrollPosition(s){const{rootWindow:c}=this.domBindings;let u=!1;this.isRtl()&&(s=-s);const d=this.mainTableScrollableElement;if(d===c&&s!==c.scrollX){const h=c.scrollX;c.scrollTo(s,getWindowScrollTop(c)),u=h!==c.scrollX}else if(s!==d.scrollLeft){const h=d.scrollLeft;d.scrollLeft=s,u=h!==d.scrollLeft}return u}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(s,c){const u=this.wtSettings.getSetting("defaultColumnWidth");let d=s,h=0;for(;d<c;)h+=this.wot.wtTable.getColumnWidth(d)||u,d+=1;return h}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:s,wtViewport:c}=this.wot,{rootDocument:u,rootWindow:d}=this.domBindings,f=this.clone.wtTable.holder.parentNode.style,g=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==d||g==="vertical"){let p=c.getWorkspaceHeight();c.hasHorizontalScroll()&&(p-=getScrollbarWidth(u)),p=Math.min(p,s.wtRootElement.scrollHeight),f.height=`${p}px`}else f.height="";this.clone.wtTable.holder.style.height=f.height;const m=outerWidth(this.clone.wtTable.TABLE);f.width=`${m}px`}adjustRootChildrenSize(){const{holder:s}=this.clone.wtTable,c=getCornerStyle(this.wot),u=this.wot.selectionManager.getFocusSelection()?parseInt(c.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,s.style.height=s.parentNode.style.height,s.style.width=`${parseInt(s.parentNode.style.width,10)+u}px`}applyToDOM(){const s=this.wtSettings.getSetting("totalColumns"),c=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[c]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(s===0)this.spreader.style[c]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(s,c){const{wtSettings:u}=this,d=u.getSetting("rowHeaders"),h=u.getSetting("fixedColumnsStart"),g=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,m=h===0&&d.length>0&&!hasClass$1(g.parentNode,"innerBorderInlineStart")?1:0;let p=this.getTableParentOffset(),v=0;if(c){const w=this.wot.wtTable.getColumnWidth(s),E=this.wot.wtViewport.getViewportWidth();w>E&&(c=!1)}return c&&g.offsetWidth!==g.clientWidth&&(v=getScrollbarWidth(this.domBindings.rootDocument)),c?(p+=this.sumCellSizes(0,s+1),p-=this.wot.wtViewport.getViewportWidth(),p+=m):p+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),s),p+=v,getMaximumScrollLeft(this.mainTableScrollableElement)===p-m&&m>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(m),this.setScrollPosition(p)}getTableParentOffset(){const s=this.wtSettings.getSetting("preventOverflow");let c=0;return!s&&this.trimmingContainer===this.domBindings.rootWindow&&(c=this.wot.wtTable.holderOffset.left),c}getScrollPosition(){return Math.abs(getScrollLeft(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:s}=this.domBindings,c=this.wtSettings.getSetting("preventOverflow");let u=0;if(this.trimmingContainer===s&&(!c||c!=="horizontal")){this.isRtl()?u=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):u=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const d=this.wot.wtTable.getTotalWidth(),h=this.clone.wtTable.getTotalWidth(),f=d-h;u>f&&(u=0)}return u}adjustHeaderBordersPosition(s){const{wtSettings:c}=this,u=this.wot.wtTable.holder.parentNode,d=c.getSetting("rowHeaders"),h=c.getSetting("fixedColumnsStart"),f=c.getSetting("totalRows"),g=c.getSetting("preventOverflow")==="vertical";f?removeClass$1(u,"emptyRows"):addClass$1(u,"emptyRows");let m=!1;if(!g){if(h&&!d.length)addClass$1(u,"innerBorderLeft innerBorderInlineStart");else if(!h&&d.length){const p=hasClass$1(u,"innerBorderInlineStart");s?(addClass$1(u,"innerBorderLeft innerBorderInlineStart"),m=!p):(removeClass$1(u,"innerBorderLeft innerBorderInlineStart"),m=p)}}return m}}const MIXIN_NAME$1="stickyRowsTop",stickyRowsTop={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};defineGetter(stickyRowsTop,"MIXIN_NAME",MIXIN_NAME$1,{writable:!1,enumerable:!1});class TopInlineStartCornerOverlayTable extends Table{constructor(s,c,u,d){super(s,c,u,d,CLONE_TOP_INLINE_START_CORNER)}}mixin(TopInlineStartCornerOverlayTable,stickyRowsTop),mixin(TopInlineStartCornerOverlayTable,stickyColumnsStart);function _defineProperty$1F(a,s,c){return(s=_toPropertyKey$1G(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1G(a){var s=_toPrimitive$1G(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1G(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class TopInlineStartCornerOverlay extends Overlay{constructor(s,c,u,d,h,f){super(s,c,CLONE_TOP_INLINE_START_CORNER,u,d),_defineProperty$1F(this,"topOverlay",void 0),_defineProperty$1F(this,"inlineStartOverlay",void 0),this.topOverlay=h,this.inlineStartOverlay=f}createTable(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return new TopInlineStartCornerOverlayTable(...c)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const s=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const d=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),h=this.topOverlay.getOverlayOffset();setOverlayPosition(s,`${d}px`,`${h}px`)}else resetCssTransform(s);let c=outerHeight(this.clone.wtTable.TABLE);const u=outerWidth(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(c=0),s.style.height=`${c}px`,s.style.width=`${u}px`,!1}}class TopOverlayTable extends Table{constructor(s,c,u,d){super(s,c,u,d,CLONE_TOP)}}mixin(TopOverlayTable,stickyRowsTop),mixin(TopOverlayTable,calculatedColumns);function _defineProperty$1E(a,s,c){return(s=_toPropertyKey$1F(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1F(a){var s=_toPrimitive$1F(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1F(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class TopOverlay extends Overlay{constructor(s,c,u,d){super(s,c,CLONE_TOP,u,d),_defineProperty$1E(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];return new TopOverlayTable(...c)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const s=this.clone.wtTable.holder.parentNode,{rootWindow:c}=this.domBindings,u=this.wtSettings.getSetting("preventOverflow");let d=0,h=!1;if(this.trimmingContainer===c&&(!u||u!=="vertical")){const{wtTable:g}=this.wot,m=g.hider.getBoundingClientRect(),p=Math.ceil(m.bottom),v=s.offsetHeight;h=p===v,d=this.getOverlayOffset(),setOverlayPosition(s,"0px",`${d}px`)}else d=this.getScrollPosition(),resetCssTransform(s);const f=this.adjustHeaderBordersPosition(d,h);return this.adjustElementsSize(),f}setScrollPosition(s){const{rootWindow:c}=this.domBindings,u=this.mainTableScrollableElement;let d=!1;if(u===c&&s!==c.scrollY){const h=c.scrollY;c.scrollTo(getWindowScrollLeft(c),s),d=h!==c.scrollY}else if(s!==u.scrollTop){const h=u.scrollTop;u.scrollTop=s,d=h!==u.scrollTop}return d}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(s,c){const u=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let d=s,h=0;for(;d<c;){const f=this.wot.wtTable.getRowHeight(d);h+=f===void 0?u:f,d+=1}return h}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:s,wtViewport:c}=this.wot,{rootDocument:u,rootWindow:d}=this.domBindings,f=this.clone.wtTable.holder.parentNode.style,g=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==d||g==="horizontal"){let p=c.getWorkspaceWidth();c.hasVerticalScroll()&&(p-=getScrollbarWidth(u)),p=Math.min(p,s.wtRootElement.scrollWidth),f.width=`${p}px`}else f.width="";this.clone.wtTable.holder.style.width=f.width;let m=outerHeight(this.clone.wtTable.TABLE);s.hasDefinedSize()||(m=0),f.height=`${m}px`}adjustRootChildrenSize(){const{holder:s}=this.clone.wtTable,c=getCornerStyle(this.wot),u=this.wot.selectionManager.getFocusSelection()?parseInt(c.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,s.style.width=s.parentNode.style.width,s.style.height=`${parseInt(s.parentNode.style.height,10)+u}px`}applyToDOM(){const s=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(s===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const s=this.isRtl()?"right":"left",{spreader:c}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?c.style[s]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:c.style[s]=""}scrollTo(s,c){const{wot:u,wtSettings:d}=this,f=(u.cloneSource?u.cloneSource:u).wtTable.holder,g=d.getSetting("columnHeaders"),p=d.getSetting("fixedRowsTop")===0&&g.length>0&&!hasClass$1(f.parentNode,"innerBorderTop")?1:0;let v=this.getTableParentOffset(),w=0;if(c){const E=this.wot.wtTable.getRowHeight(s),C=this.wot.wtViewport.getViewportHeight();E>C&&(c=!1)}if(c&&f.offsetHeight!==f.clientHeight&&(w=getScrollbarWidth(this.domBindings.rootDocument)),c){const E=d.getSetting("fixedRowsBottom"),C=d.getSetting("totalRows");v+=this.sumCellSizes(0,s+1),v-=u.wtViewport.getViewportHeight()-this.sumCellSizes(C-E,C),v+=1,v+=p}else v+=this.sumCellSizes(d.getSetting("fixedRowsTop"),s);return v+=w,getMaximumScrollTop(this.mainTableScrollableElement)===v-p&&p>0&&this.wot.wtOverlays.expandHiderVerticallyBy(p),this.setScrollPosition(v)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return getScrollTop(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:s}=this.domBindings,c=this.wtSettings.getSetting("preventOverflow");let u=0;if(this.trimmingContainer===s&&(!c||c!=="vertical")){const d=this.wot.wtTable.getTotalHeight(),h=this.clone.wtTable.getTotalHeight(),f=d-h;u=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),u>f&&(u=0)}return u}adjustHeaderBordersPosition(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:u}=this,d=this.wot.wtTable.holder.parentNode,h=u.getSetting("totalColumns"),f=u.getSetting("preventOverflow")==="horizontal";h?removeClass$1(d,"emptyColumns"):addClass$1(d,"emptyColumns");let g=!1;if(!c&&!f){const m=u.getSetting("fixedRowsTop"),p=this.cachedFixedRowsTop!==m,v=u.getSetting("columnHeaders");if((p||m===0)&&v.length>0){const w=hasClass$1(d,"innerBorderTop");this.cachedFixedRowsTop=u.getSetting("fixedRowsTop"),s||u.getSetting("totalRows")===0?(addClass$1(d,"innerBorderTop"),g=!w):(removeClass$1(d,"innerBorderTop"),g=w)}}return g}}function _classPrivateFieldInitSpec$V(a,s,c){_checkPrivateRedeclaration$1d(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1d(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1D(a,s,c){return(s=_toPropertyKey$1E(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1E(a){var s=_toPrimitive$1E(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1E(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldSet$S(a,s,c){return a.set(_assertClassBrand$1d(a,s),c),c}function _classPrivateFieldGet$V(a,s){return a.get(_assertClassBrand$1d(a,s))}function _assertClassBrand$1d(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _overlays=new WeakMap,_hasRenderingStateChanged=new WeakMap,_containerDomResizeCount=new WeakMap,_containerDomResizeCountTimeout=new WeakMap;class Overlays{constructor(s,c,u,d,h,f){_defineProperty$1D(this,"wot",null),_classPrivateFieldInitSpec$V(this,_overlays,[]),_defineProperty$1D(this,"topOverlay",null),_defineProperty$1D(this,"bottomOverlay",null),_defineProperty$1D(this,"inlineStartOverlay",null),_defineProperty$1D(this,"topInlineStartCornerOverlay",null),_defineProperty$1D(this,"bottomInlineStartCornerOverlay",null),_defineProperty$1D(this,"browserLineHeight",void 0),_defineProperty$1D(this,"wtSettings",null),_classPrivateFieldInitSpec$V(this,_hasRenderingStateChanged,!1),_classPrivateFieldInitSpec$V(this,_containerDomResizeCount,0),_classPrivateFieldInitSpec$V(this,_containerDomResizeCountTimeout,null),_defineProperty$1D(this,"resizeObserver",new ResizeObserver(v=>{requestAnimationFrame$1(()=>{!Array.isArray(v)||!v.length||(_classPrivateFieldSet$S(_containerDomResizeCount,this,_classPrivateFieldGet$V(_containerDomResizeCount,this)+1),_classPrivateFieldGet$V(_containerDomResizeCount,this)===300&&(warn$1("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),_classPrivateFieldGet$V(_containerDomResizeCountTimeout,this)!==null&&clearTimeout(_classPrivateFieldGet$V(_containerDomResizeCountTimeout,this)),_classPrivateFieldSet$S(_containerDomResizeCountTimeout,this,setTimeout(()=>{_classPrivateFieldSet$S(_containerDomResizeCount,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=s,this.wtSettings=d,this.domBindings=u,this.facadeGetter=c,this.wtTable=f;const{rootDocument:g,rootWindow:m}=this.domBindings;this.instance=this.wot,this.eventManager=h,this.scrollbarSize=getScrollbarWidth(g);const p=m.getComputedStyle(f.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=p?f.holder:getScrollableElement(f.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=m.scrollX,this.lastScrollY=m.scrollY}getOverlays(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const c=[..._classPrivateFieldGet$V(_overlays,this)];return s&&c.push(this.wtTable),c}initBrowserLineHeight(){const{rootWindow:s,rootDocument:c}=this.domBindings,u=s.getComputedStyle(c.body),d=parseInt(u.lineHeight,10),h=parseInt(u.fontSize,10)*1.2;this.browserLineHeight=d||h}initOverlays(){const s=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new TopOverlay(...s),this.bottomOverlay=new BottomOverlay(...s),this.inlineStartOverlay=new InlineStartOverlay(...s),this.topInlineStartCornerOverlay=new TopInlineStartCornerOverlay(...s,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new BottomInlineStartCornerOverlay(...s,this.bottomOverlay,this.inlineStartOverlay),_classPrivateFieldSet$S(_overlays,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){_classPrivateFieldSet$S(_hasRenderingStateChanged,this,_classPrivateFieldGet$V(_overlays,this).reduce((s,c)=>c.hasRenderingStateChanged()||s,!1)),_classPrivateFieldGet$V(_overlays,this).forEach(s=>s.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),_classPrivateFieldGet$V(_overlays,this).forEach(s=>{const c=s.hasRenderingStateChanged();s.updateStateOfRendering("after"),c&&!s.needFullRender&&s.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:s,rootWindow:c}=this.domBindings,{mainTableScrollableElement:u}=this.topOverlay,{mainTableScrollableElement:d}=this.inlineStartOverlay;this.eventManager.addEventListener(s.documentElement,"keydown",w=>this.onKeyDown(w)),this.eventManager.addEventListener(s.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(s,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(u,"scroll",w=>this.onTableScroll(w),{passive:!0}),u!==d&&this.eventManager.addEventListener(d,"scroll",w=>this.onTableScroll(w),{passive:!0});const h=c.devicePixelRatio&&c.devicePixelRatio>1,f=this.scrollableElement===c,g=this.wtSettings.getSetting("preventWheel"),m={passive:f};(g||h||!isChrome())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",w=>this.onCloneWheel(w,g),m),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(w=>{this.eventManager.addEventListener(w.clone.wtTable.holder,"wheel",E=>this.onCloneWheel(E,g),m)});let v;this.eventManager.addEventListener(c,"resize",()=>{requestAnimationFrame$1(()=>{clearTimeout(v),this.wtSettings.getSetting("onWindowResize"),v=setTimeout(()=>{_classPrivateFieldSet$S(_containerDomResizeCount,this,0)},200)})}),f||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(s){const c=this.domBindings.rootWindow,u=this.inlineStartOverlay.mainTableScrollableElement,d=this.topOverlay.mainTableScrollableElement,h=s.target;this.keyPressed&&(d!==c&&h!==c&&!s.target.contains(d)||u!==c&&h!==c&&!s.target.contains(u))||this.syncScrollPositions(s)}onCloneWheel(s,c){if(s.ctrlKey)return;const{rootWindow:u}=this.domBindings,d=this.inlineStartOverlay.mainTableScrollableElement,h=this.topOverlay.mainTableScrollableElement,f=s.target,g=h!==u&&f!==u&&!f.contains(h),m=d!==u&&f!==u&&!f.contains(d);if(this.keyPressed&&(g||m)||this.scrollableElement===u)return;const p=this.translateMouseWheelToScroll(s);(c||this.scrollableElement!==u&&p)&&s.preventDefault()}onKeyDown(s){this.keyPressed=isKey(s.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(s){let c=isNaN(s.deltaY)?-1*s.wheelDeltaY:s.deltaY,u=isNaN(s.deltaX)?-1*s.wheelDeltaX:s.deltaX;s.deltaMode===1&&(u+=u*this.browserLineHeight,c+=c*this.browserLineHeight);const d=this.scrollVertically(c),h=this.scrollHorizontally(u);return d||h}scrollVertically(s){const c=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=s,c!==this.scrollableElement.scrollTop}scrollHorizontally(s){const c=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=s,c!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const s=this.topOverlay.clone.wtTable.holder,c=this.inlineStartOverlay.clone.wtTable.holder;let u=this.scrollableElement.scrollLeft,d=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(u=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(d=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==u,this.verticalScrolling=this.lastScrollY!==d,this.lastScrollX=u,this.lastScrollY=d,this.horizontalScrolling){s.scrollLeft=u;const h=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;h&&(h.scrollLeft=u)}this.verticalScrolling&&(c.scrollTop=d),this.refreshAll()}syncScrollWithMaster(){if(!_classPrivateFieldGet$V(_hasRenderingStateChanged,this))return;const s=this.topOverlay.mainTableScrollableElement,{scrollLeft:c,scrollTop:u}=s;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=c),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=c),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=u),_classPrivateFieldSet$S(_hasRenderingStateChanged,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:s}=this,{rootWindow:c}=this.domBindings;c.getComputedStyle(s.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=s.holder:this.scrollableElement=getScrollableElement(s.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(s),this.inlineStartOverlay.refresh(s),this.topOverlay.refresh(s),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(s),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(s)}updateLastSpreaderSize(){const s=this.wtTable.spreader,c=s.clientWidth,u=s.clientHeight,d=c!==this.spreaderLastSize.width||u!==this.spreaderLastSize.height;return d&&(this.spreaderLastSize.width=c,this.spreaderLastSize.height=u),d}adjustElementsSize(){const{wtViewport:s}=this.wot,{wtTable:c}=this,{rootWindow:u}=this.domBindings,d=this.scrollableElement===u,h=this.wtSettings.getSetting("totalColumns"),f=this.wtSettings.getSetting("totalRows"),g=s.getRowHeaderWidth(),m=s.getColumnHeaderHeight(),p=this.wtSettings.getSetting("externalRowCalculator")?0:1,v=m+this.topOverlay.sumCellSizes(0,f)+p,w=g+this.inlineStartOverlay.sumCellSizes(0,h),C=c.hider.style,b=()=>d?!1:this.scrollableElement.scrollTop>Math.max(0,v-c.holder.clientHeight),P=()=>d?!1:this.scrollableElement.scrollLeft>Math.max(0,w-c.holder.clientWidth),R=b()?1:0,T=P()?1:0;C.width=`${w+T}px`,C.height=`${v+R}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(s){const{wtTable:c}=this;c.hider.style.height=`${parseInt(c.hider.style.height,10)+s}px`}expandHiderHorizontallyBy(s){const{wtTable:c}=this;c.hider.style.width=`${parseInt(c.hider.style.width,10)+s}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(s){if(!s)return null;const c=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let u=null;return arrayEach(c,d=>{d&&d.clone&&d.clone.wtTable.TABLE.contains(s)&&(u=d.clone)}),u}syncOverlayTableClassNames(){const s=this.wtTable.TABLE,c=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];arrayEach(c,u=>{u&&(u.clone.wtTable.TABLE.className=s.className)})}}function _defineProperty$1C(a,s,c){return(s=_toPropertyKey$1D(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1D(a){var s=_toPrimitive$1D(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1D(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Settings{constructor(s){_defineProperty$1C(this,"settings",{}),_defineProperty$1C(this,"defaults",Object.freeze(this.getDefaults())),objectEach(this.defaults,(c,u)=>{if(s[u]!==void 0)this.settings[u]=s[u];else{if(c===void 0)throw new Error(`A required setting "${u}" was not provided`);this.settings[u]=c}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(s,c,u)=>{const d=this.getSetting("data",s,c);fastInnerText(u,d??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:s=>s,onBeforeViewportScrollVertically:s=>s,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:s=>s,onBeforeHighlightingColumnHeader:s=>s,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(s,c){return c===void 0?objectEach(s,(u,d)=>{this.settings[d]=u}):this.settings[s]=c,this}getSetting(s,c,u,d,h){return typeof this.settings[s]=="function"?this.settings[s](c,u,d,h):c!==void 0&&Array.isArray(this.settings[s])?this.settings[s][c]:this.settings[s]}getSettingPure(s){return this.settings[s]}has(s){return!!this.settings[s]}}class MasterTable extends Table{constructor(s,c,u,d){super(s,c,u,d,"master")}alignOverlaysWithTrimmingContainer(){const s=getTrimmingContainer(this.wtRootElement),{rootWindow:c}=this.domBindings;if(s===c)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const u=s.parentElement,d=getStyle(s,"height",c),h=getStyle(s,"overflow",c),f=this.holder.style,{scrollWidth:g,scrollHeight:m}=s;let p=s.offsetWidth,v=s.offsetHeight;if(u&&["auto","hidden","scroll"].includes(h)){const E=s.cloneNode(!1);E.style.overflow="auto",E.style.position="absolute",s.nextElementSibling?u.insertBefore(E,s.nextElementSibling):u.appendChild(E);const C=parseInt(c.getComputedStyle(E).height,10);u.removeChild(E),C===0&&(v=0)}v=Math.min(v,m),f.height=d==="auto"?"auto":`${v}px`,p=Math.min(p,g),f.width=`${p}px`,f.overflow="",this.hasTableHeight=f.height==="auto"?!0:v>0,this.hasTableWidth=p>0}this.isTableVisible=isVisible(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:s}=this,{wtViewport:c}=this.dataAccessObject,u="master",h=s.getSetting("columnHeaders").length;if(h&&!c.hasOversizedColumnHeadersMarked[u]){const g=s.getSetting("rowHeaders").length,m=this.getRenderedColumnsCount();for(let p=0;p<h;p++)for(let v=-1*g;v<m;v++)this.markIfOversizedColumnHeader(v);c.hasOversizedColumnHeadersMarked[u]=!0}}}mixin(MasterTable,calculatedRows),mixin(MasterTable,calculatedColumns);class Viewport{constructor(s,c,u,d,h){this.dataAccessObject=s,this.wot=s.wot,this.instance=this.wot,this.domBindings=c,this.wtSettings=u,this.wtTable=h,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new RenderedAllRowsCalculationType:new RenderedRowsCalculationType],["fullyVisible",()=>new FullyVisibleRowsCalculationType],["partiallyVisible",()=>new PartiallyVisibleRowsCalculationType]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new RenderedAllColumnsCalculationType:new RenderedColumnsCalculationType],["fullyVisible",()=>new FullyVisibleColumnsCalculationType],["partiallyVisible",()=>new PartiallyVisibleColumnsCalculationType]]),this.eventManager=d,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const s=this.domBindings.rootDocument,c=this.dataAccessObject.topOverlayTrimmingContainer;let u=0;return c===this.domBindings.rootWindow?u=s.documentElement.clientHeight:u=outerHeight(c)>0&&c.clientHeight>0?c.clientHeight:1/0,u}getViewportHeight(){let s=this.getWorkspaceHeight();if(s===1/0)return s;const c=this.getColumnHeaderHeight();return c>0&&(s-=c),s}getWorkspaceWidth(){const{rootDocument:s,rootWindow:c}=this.domBindings,u=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let d;if(u===c){const h=this.wtSettings.getSetting("totalColumns");d=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,h)>d&&(d=s.documentElement.clientWidth)}else d=u.clientWidth;return d}getViewportWidth(){const s=this.getWorkspaceWidth();if(s===1/0)return s;const c=this.getRowHeaderWidth();return c>0?s-c:s}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const h=this.domBindings.rootDocument.documentElement;return h.scrollHeight>h.clientHeight}const{holder:s,hider:c}=this.wtTable,u=s.clientHeight,d=c.offsetHeight;return u<d?!0:d>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const d=this.domBindings.rootDocument.documentElement;return d.scrollWidth>d.clientWidth}const{hider:s}=this.wtTable,c=s.offsetWidth,u=this.hasVerticalScroll()?getScrollbarWidth():0;return c>this.getWorkspaceWidth()-u}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(s,c){let u=0,d=s;for(;d<c;)u+=this.wtTable.getColumnWidth(d),d+=1;return u}getWorkspaceOffset(){return offset(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=outerHeight(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const s=this.wtSettings.getSetting("rowHeaderWidth"),c=this.wtSettings.getSetting("rowHeaders");if(s){this.rowHeaderWidth=0;for(let u=0,d=c.length;u<d;u++)this.rowHeaderWidth+=s[u]||s}if(isNaN(this.rowHeaderWidth))if(c.length){let u=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let d=0,h=c.length;d<h;d++)u?(this.rowHeaderWidth+=outerWidth(u),u=u.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:c,wtTable:u}=this;let d=this.getViewportHeight(),h,f;this.rowHeaderWidth=NaN;let g=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const m=c.getSetting("fixedRowsTop"),p=c.getSetting("fixedRowsBottom"),v=c.getSetting("totalRows");return m&&g>=0&&(f=this.dataAccessObject.topOverlay.sumCellSizes(0,m),g+=f,d-=f),p&&this.dataAccessObject.bottomOverlay.clone&&(f=this.dataAccessObject.bottomOverlay.sumCellSizes(v-p,v),d-=f),u.holder.clientHeight===u.holder.offsetHeight?h=0:h=getScrollbarWidth(this.domBindings.rootDocument),new ViewportRowsCalculator({calculationTypes:s.map(w=>[w,this.rowsCalculatorTypes.get(w)()]),viewportHeight:d,scrollOffset:g,totalRows:c.getSetting("totalRows"),defaultRowHeight:c.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:w=>u.getRowHeight(w),overrideFn:c.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:h})}createColumnsCalculator(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:c,wtTable:u}=this;let d=this.getViewportWidth(),h=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const f=c.getSetting("fixedColumnsStart");if(f&&h>=0){const g=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,f);h+=g,d-=g}return u.holder.clientWidth!==u.holder.offsetWidth&&(d-=getScrollbarWidth(this.domBindings.rootDocument)),new ViewportColumnsCalculator({calculationTypes:s.map(g=>[g,this.columnsCalculatorTypes.get(g)()]),viewportWidth:d,scrollOffset:h,totalColumns:c.getSetting("totalColumns"),columnWidthFn:g=>u.getColumnWidth(g),overrideFn:c.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:c}=this,u=this.createRowsCalculator(),d=this.createColumnsCalculator();if(s&&!c.getSetting("renderAllRows")){const h=u.getResultsFor("fullyVisible"),f=u.getResultsFor("partiallyVisible");s=this.areAllProposedVisibleRowsAlreadyRendered(h,f)}if(s&&!c.getSetting("renderAllColumns")){const h=d.getResultsFor("fullyVisible"),f=d.getResultsFor("partiallyVisible");s=this.areAllProposedVisibleColumnsAlreadyRendered(h,f)}return s||(this.rowsRenderCalculator=u.getResultsFor("rendered"),this.columnsRenderCalculator=d.getResultsFor("rendered")),this.rowsVisibleCalculator=u.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=d.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=u.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=d.getResultsFor("partiallyVisible"),s}createVisibleCalculators(){const s=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),c=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=s.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=c.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=s.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=c.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(s,c){if(!this.rowsVisibleCalculator)return!1;let{startRow:u,endRow:d}=s;const{startRow:h,endRow:f}=c;if(u===null&&d===null){if(!s.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(h)&&!this.wtTable.isRowAfterRenderedRows(f))return!0;u=h,d=f}const{startRow:g,endRow:m,rowStartOffset:p,rowEndOffset:v}=this.rowsRenderCalculator,w=this.wtSettings.getSetting("totalRows")-1,E=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(E)&&E>0?(u=Math.max(0,u-Math.min(p,E)),d=Math.min(w,d+Math.min(v,E))):E==="auto"&&(u=Math.max(0,u-Math.ceil(p/2)),d=Math.min(w,d+Math.ceil(v/2))),u<g||u===g&&u>0?!1:!(d>m||d===m&&d<w)}areAllProposedVisibleColumnsAlreadyRendered(s,c){if(!this.columnsVisibleCalculator)return!1;let{startColumn:u,endColumn:d}=s;const{startColumn:h,endColumn:f}=c;if(u===null&&d===null){if(!s.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(h)&&!this.wtTable.isColumnAfterRenderedColumns(f))return!0;u=h,d=f}const{startColumn:g,endColumn:m,columnStartOffset:p,columnEndOffset:v}=this.columnsRenderCalculator,w=this.wtSettings.getSetting("totalColumns")-1,E=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(E)&&E>0?(u=Math.max(0,u-Math.min(p,E)),d=Math.min(w,d+Math.min(v,E))):E==="auto"&&(u=Math.max(0,u-Math.ceil(p/2)),d=Math.min(w,d+Math.ceil(v/2))),u<g||u===g&&u>0?!1:!(d>m||d===m&&d<w)}resetHasOversizedColumnHeadersMarked(){objectEach(this.hasOversizedColumnHeadersMarked,(s,c,u)=>{u[c]=void 0})}}class Walkontable extends CoreAbstract{constructor(s,c){super(s,new Settings(c));const u=this.wtSettings.getSetting("facade",this);this.wtTable=new MasterTable(this.getTableDao(),u,this.domBindings,this.wtSettings),this.wtViewport=new Viewport(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new SelectionManager(this.wtSettings.getSetting("selections")),this.wtEvent=new Event$1(u,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Overlays(this,u,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const s={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},c=[],u=[];objectEach(s,(d,h)=>{this.wtSettings.getSetting(h).length&&u.push(d),c.push(d)}),removeClass$1(this.wtTable.wtRootElement.parentNode,c),addClass$1(this.wtTable.wtRootElement.parentNode,u)}getOverlayByName(s){var c;if(!CLONE_TYPES.includes(s))return null;const u=s.replace(/_([a-z])/g,d=>d[1].toUpperCase());return(c=this.wtOverlays[`${u}Overlay`])!==null&&c!==void 0?c:null}getViewportDao(){const s=this;return{get wot(){return s},get topOverlayTrimmingContainer(){return s.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return s.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return s.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return s.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return s.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return s.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return s.wtOverlays.topOverlay},get inlineStartOverlay(){return s.wtOverlays.inlineStartOverlay},get bottomOverlay(){return s.wtOverlays.bottomOverlay}}}}class WalkontableFacade{constructor(s){s instanceof CoreAbstract?this._wot=s:this._initFromSettings(s)}_initFromSettings(s){s.facade=c=>{const u=new WalkontableFacade(c);return()=>u},this._wot=new Walkontable(s.table,s)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(s){this._wot.drawn=s}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(s){this._wot.drawInterrupted=s}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(s){this._wot.lastMouseOver=s}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(s){this._wot.momentumScrolling=s}get touchApplied(){return this._wot.touchApplied}set touchApplied(s){this._wot.touchApplied=s}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(s){this._wot.eventListeners=s}get eventManager(){return this._wot.eventManager}createCellCoords(s,c){return this._wot.createCellCoords(s,c)}createCellRange(s,c,u){return this._wot.createCellRange(s,c,u)}draw(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(s),this}getCell(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(s,c)}scrollViewport(s,c,u){return this._wot.scrollViewport(s,c,u)}scrollViewportHorizontally(s,c){return this._wot.scrollViewportHorizontally(s,c)}scrollViewportVertically(s,c){return this._wot.scrollViewportVertically(s,c)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(s){return this._wot.getOverlayByName(s)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(s,c){return this._wot.wtSettings.update(s,c),this}getSetting(s,c,u,d,h){return this._wot.wtSettings.getSetting(s,c,u,d,h)}hasSetting(s){return this._wot.wtSettings.hasSetting(s)}destroy(){this._wot.destroy()}}function mouseDown(a){let{isShiftKey:s,isLeftClick:c,isRightClick:u,coords:d,selection:h,controller:f,cellCoordsFactory:g}=a;const m=h.isSelected()?h.getSelectedRange().current():null,p=h.isSelectedByCorner(),v=h.isSelectedByRowHeader();if(h.markSource("mouse"),s&&m)d.row>=0&&d.col>=0&&!f.cell?h.setRangeEnd(d):(p||v)&&d.row>=0&&d.col>=0&&!f.cell?h.setRangeEnd(g(d.row,d.col)):p&&d.row<0&&!f.column?h.setRangeEnd(g(m.to.row,d.col)):v&&d.col<0&&!f.row?h.setRangeEnd(g(d.row,m.to.col)):(!p&&!v&&d.col<0||p&&d.col<0)&&!f.row?h.selectRows(Math.max(m.from.row,0),d.row,d.col):(!p&&!v&&d.row<0||v&&d.row<0)&&!f.column&&h.selectColumns(Math.max(m.from.col,0),d.col,d.row);else{const w=!h.inInSelection(d),E=c||u&&w;d.row<0&&d.col>=0&&!f.column?E&&h.selectColumns(d.col,d.col,d.row):d.col<0&&d.row>=0&&!f.row?E&&h.selectRows(d.row,d.row,d.col):d.col>=0&&d.row>=0&&!f.cell?E&&h.setRangeStart(d):d.col<0&&d.row<0&&h.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}h.markEndSource()}function mouseOver(a){let{isLeftClick:s,coords:c,selection:u,controller:d,cellCoordsFactory:h}=a;if(!s)return;const f=u.isSelectedByRowHeader(),g=u.isSelectedByColumnHeader(),m=u.tableProps.countCols(),p=u.tableProps.countRows();u.markSource("mouse"),g&&!d.column?u.setRangeEnd(h(p-1,c.col)):f&&!d.row?u.setRangeEnd(h(c.row,m-1)):d.cell||u.setRangeEnd(c),u.markEndSource()}function mouseUp(a){let{isLeftClick:s,selection:c,cellRangeMapper:u}=a;if(!s||c.settings.selectionMode!=="multiple")return;const d=c.getSelectedRange(),h=d.clone().map(g=>u.toRenderable(g)),f=h.current();if(h.size()>1&&!f.isHeader()&&!c.isMultiple(f)){const g=h.findAll(f);g.length===h.size()?(d.pop(),c.refresh()):g.length>1&&(d.removeLayers(g.map(m=>{let{layer:p}=m;return p})),c.refresh())}}const handlers=new Map([["touchstart",mouseDown],["touchend",mouseUp],["mousedown",mouseDown],["mouseover",mouseOver],["mouseup",mouseUp]]);function handleMouseEvent(a,s){handlers.get(a.type)({isShiftKey:a.shiftKey,isLeftClick:isLeftClick(a)||a.type==="touchstart",isRightClick:isRightClick(a),...s})}const holder=new WeakMap,rootInstanceSymbol=Symbol("rootInstance");function registerAsRootInstance(a){holder.set(a,!0)}function hasValidParameter(a){return a===rootInstanceSymbol}function isRootInstance(a){return holder.has(a)}function _classPrivateMethodInitSpec$W(a,s){_checkPrivateRedeclaration$1c(a,s),s.add(a)}function _classPrivateFieldInitSpec$U(a,s,c){_checkPrivateRedeclaration$1c(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1c(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1B(a,s,c){return(s=_toPropertyKey$1C(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1C(a){var s=_toPrimitive$1C(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1C(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$U(a,s){return a.get(_assertClassBrand$1c(a,s))}function _classPrivateFieldSet$R(a,s,c){return a.set(_assertClassBrand$1c(a,s),c),c}function _assertClassBrand$1c(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _columnHeadersCount=new WeakMap,_rowHeadersCount=new WeakMap,_selectionMouseDown=new WeakMap,_mouseDown=new WeakMap,_table=new WeakMap,_lastWidth=new WeakMap,_lastHeight=new WeakMap,_mouseDownLastPos=new WeakMap,_TableView_brand=new WeakSet;class TableView{constructor(s){_classPrivateMethodInitSpec$W(this,_TableView_brand),_defineProperty$1B(this,"hot",void 0),_defineProperty$1B(this,"eventManager",void 0),_defineProperty$1B(this,"settings",void 0),_defineProperty$1B(this,"THEAD",void 0),_defineProperty$1B(this,"TBODY",void 0),_defineProperty$1B(this,"_wt",void 0),_defineProperty$1B(this,"activeWt",void 0),_classPrivateFieldInitSpec$U(this,_columnHeadersCount,0),_classPrivateFieldInitSpec$U(this,_rowHeadersCount,0),_defineProperty$1B(this,"postponedAdjustElementsSize",!1),_classPrivateFieldInitSpec$U(this,_selectionMouseDown,!1),_classPrivateFieldInitSpec$U(this,_mouseDown,void 0),_classPrivateFieldInitSpec$U(this,_table,void 0),_classPrivateFieldInitSpec$U(this,_lastWidth,0),_classPrivateFieldInitSpec$U(this,_lastHeight,0),_classPrivateFieldInitSpec$U(this,_mouseDownLastPos,null),this.hot=s,this.eventManager=new EventManager(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const s=this.hot.forceFullRender;this.hot.runHooks("beforeRender",s),this._wt.draw(!s),_assertClassBrand$1c(_TableView_brand,this,_updateScrollbarClassNames).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",s),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(s,c){const u=this._wt.getCell(s,c);return u<0?null:u}scrollViewport(s,c,u){return this._wt.scrollViewport(s,c,u)}scrollViewportHorizontally(s,c){return this._wt.scrollViewportHorizontally(s,c)}scrollViewportVertically(s,c){return this._wt.scrollViewportVertically(s,c)}createElements(){const{rootElement:s,rootDocument:c}=this.hot,u=s.getAttribute("style");u&&s.setAttribute("data-originalstyle",u),addClass$1(s,"handsontable"),_classPrivateFieldSet$R(_table,this,c.createElement("TABLE")),addClass$1(_classPrivateFieldGet$U(_table,this),"htCore"),this.hot.getSettings().tableClassName&&addClass$1(_classPrivateFieldGet$U(_table,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(setAttribute(_classPrivateFieldGet$U(_table,this),[A11Y_PRESENTATION()]),setAttribute(s,[A11Y_TREEGRID(),A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(this.hot.countCols()),A11Y_MULTISELECTABLE()])),this.THEAD=c.createElement("THEAD"),_classPrivateFieldGet$U(_table,this).appendChild(this.THEAD),this.TBODY=c.createElement("TBODY"),_classPrivateFieldGet$U(_table,this).appendChild(this.TBODY),this.hot.table=_classPrivateFieldGet$U(_table,this),this.hot.container.insertBefore(_classPrivateFieldGet$U(_table,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:s,rootElement:c,rootDocument:u,selection:d,rootWindow:h}=this.hot,f=u.documentElement;this.eventManager.addEventListener(c,"mousedown",m=>{_classPrivateFieldSet$R(_selectionMouseDown,this,!0),this.isTextSelectionAllowed(m.target)||(clearTextSelection(h),m.preventDefault(),h.focus())}),this.eventManager.addEventListener(c,"mouseup",()=>{_classPrivateFieldSet$R(_selectionMouseDown,this,!1)}),this.eventManager.addEventListener(c,"mousemove",m=>{_classPrivateFieldGet$U(_selectionMouseDown,this)&&!this.isTextSelectionAllowed(m.target)&&(this.settings.fragmentSelection&&clearTextSelection(h),m.preventDefault())}),this.eventManager.addEventListener(f,"keyup",m=>{d.isInProgress()&&!m.shiftKey&&d.finish()}),this.eventManager.addEventListener(f,"mouseup",m=>{d.isInProgress()&&isLeftClick(m)&&d.finish(),_classPrivateFieldSet$R(_mouseDown,this,!1);const p=isOutsideInput(u.activeElement);isInput(u.activeElement)&&!p||(p||!d.isSelected()&&!d.isSelectedByAnyHeader()&&!(s??c).contains(m.target)&&!isRightClick(m))&&this.hot.unlisten()}),this.eventManager.addEventListener(f,"contextmenu",m=>{d.isInProgress()&&isRightClick(m)&&(d.finish(),_classPrivateFieldSet$R(_mouseDown,this,!1))}),this.eventManager.addEventListener(f,"touchend",()=>{d.isInProgress()&&d.finish(),_classPrivateFieldSet$R(_mouseDown,this,!1)}),this.eventManager.addEventListener(f,"mousedown",m=>{const p=m.target,v=m.x||m.clientX,w=m.y||m.clientY;let E=m.target;if(_classPrivateFieldGet$U(_mouseDown,this)||!c||!this.hot.view)return;const{holder:C}=this._wt.wtTable;if(E===C){const P=getScrollbarWidth(u);if(u.elementFromPoint(v+P,w)!==C||u.elementFromPoint(v,w+P)!==C)return}else for(;E!==f;){if(E===null){if(m.isTargetWebComponent)break;return}if(E===c)return;E=E.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(p):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let g=getParentWindow(h);for(;g!==null;)this.eventManager.addEventListener(g.document.documentElement,"click",()=>{this.hot.unlisten()}),g=getParentWindow(g);this.eventManager.addEventListener(_classPrivateFieldGet$U(_table,this),"selectstart",m=>{this.settings.fragmentSelection||isInput(m.target)||m.preventDefault()})}translateFromRenderableToVisualCoords(s){let{row:c,col:u}=s;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(c,u))}translateFromRenderableToVisualIndex(s,c){let u=s>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(s):s,d=c>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(c):c;return u===null&&(u=s),d===null&&(d=c),[u,d]}countRenderableIndexes(s,c){const u=Math.min(s.getNotTrimmedIndexesLength(),c),d=s.getNearestNotHiddenIndex(u-1,-1);return d===null?0:s.getRenderableFromVisualIndex(d)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(s,c){return this.countNotHiddenIndexes(s,c,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(s,c){return this.countNotHiddenIndexes(s,c,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(s,c,u,d){if(isNaN(s)||s<0)return 0;const h=u.getNearestNotHiddenIndex(s,c),f=u.getRenderableFromVisualIndex(h);if(!Number.isInteger(f))return 0;let g=0;return c<0?g=f+1:c>0&&(g=d-f),g}countNotHiddenFixedColumnsStart(){const s=this.hot.countCols(),c=Math.min(parseInt(this.settings.fixedColumnsStart,10),s)-1;return this.countNotHiddenColumnIndexes(c,-1)}countNotHiddenFixedRowsTop(){const s=this.hot.countRows(),c=Math.min(parseInt(this.settings.fixedRowsTop,10),s)-1;return this.countNotHiddenRowIndexes(c,-1)}countNotHiddenFixedRowsBottom(){const s=this.hot.countRows(),c=Math.max(s-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(c,1)}countRenderableColumnsInRange(s,c){let u=0;for(let d=s;d<=c;d++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(d)!==null&&(u+=1);return u}countRenderableRowsInRange(s,c){let u=0;for(let d=s;d<=c;d++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(d)!==null&&(u+=1);return u}addClassNameToLicenseElement(s){var c;const u=(c=this.hot.rootElement.parentNode)===null||c===void 0?void 0:c.querySelector(".hot-display-license-info");u&&addClass$1(u,s)}removeClassNameFromLicenseElement(s){var c;const u=(c=this.hot.rootElement.parentNode)===null||c===void 0?void 0:c.querySelector(".hot-display-license-info");u&&removeClass$1(u,s)}isMainTableNotFullyCoveredByOverlays(){const s=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),c=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>s&&this.hot.countRenderedCols()>c}initializeWalkontable(){const s={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:_classPrivateFieldGet$U(_table,this),isDataViewInstance:()=>isRootInstance(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(h,f)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(h,f)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||s.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||s.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const h=[];return this.hot.hasRowHeaders()&&h.push((f,g)=>{const m=f>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(f):f;this.appendRowHeader(m,g)}),this.hot.runHooks("afterGetRowHeaderRenderers",h),_classPrivateFieldSet$R(_rowHeadersCount,this,h.length),this.hot.getSettings().ariaTags&&_assertClassBrand$1c(_TableView_brand,this,_getAriaColcount).call(this)===this.hot.countCols()&&_assertClassBrand$1c(_TableView_brand,this,_updateAriaColcount).call(this,_classPrivateFieldGet$U(_rowHeadersCount,this)),h},columnHeaders:()=>{const h=[];return this.hot.hasColHeaders()&&h.push((f,g)=>{const m=f>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(f):f;this.appendColHeader(m,g)}),this.hot.runHooks("afterGetColumnHeaderRenderers",h),_classPrivateFieldSet$R(_columnHeadersCount,this,h.length),h},columnWidth:h=>{const f=this.hot.columnIndexMapper.getVisualFromRenderableIndex(h);return this.hot.getColWidth(f===null?h:f)},rowHeight:h=>{const f=this.hot.rowIndexMapper.getVisualFromRenderableIndex(h);return this.hot.getRowHeight(f===null?h:f)},rowHeightByOverlayName:(h,f)=>{const g=this.hot.rowIndexMapper.getVisualFromRenderableIndex(h),m=g===null?h:g;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(m),m,f)},cellRenderer:(h,f,g)=>{const[m,p]=this.translateFromRenderableToVisualIndex(h,f),v=this.hot.runHooks("modifyGetCellCoords",m,p,!1,"meta");let w=m,E=p;Array.isArray(v)&&([w,E]=v);const C=this.hot.getCellMeta(w,E),b=this.hot.colToProp(E);let P=this.hot.getDataAtRowProp(w,b);this.hot.hasHook("beforeValueRender")&&(P=this.hot.runHooks("beforeValueRender",P,C)),this.hot.runHooks("beforeRenderer",g,m,p,b,P,C),this.hot.getCellRenderer(C)(this.hot,g,m,p,b,P,C),this.hot.runHooks("afterRenderer",g,m,p,b,P,C)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&isVisible(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(h,f,g,m)=>{const p=this.translateFromRenderableToVisualCoords(f),v={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=m,_classPrivateFieldSet$R(_mouseDown,this,!0),_classPrivateFieldSet$R(_mouseDownLastPos,this,{x:h.clientX,y:h.clientY}),this.hot.runHooks("beforeOnCellMouseDown",h,p,g,v),!isImmediatePropagationStopped(h)&&(handleMouseEvent(h,{coords:p,selection:this.hot.selection,controller:v,cellCoordsFactory:(w,E)=>this.hot._createCellCoords(w,E)}),this.hot.runHooks("afterOnCellMouseDown",h,p,g),this.activeWt=this._wt)},onCellContextMenu:(h,f,g,m)=>{const p=this.translateFromRenderableToVisualCoords(f);this.activeWt=m,_classPrivateFieldSet$R(_mouseDown,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",h,p,g),!isImmediatePropagationStopped(h)&&(this.hot.runHooks("afterOnCellContextMenu",h,p,g),this.activeWt=this._wt)},onCellMouseOut:(h,f,g,m)=>{const p=this.translateFromRenderableToVisualCoords(f);this.activeWt=m,this.hot.runHooks("beforeOnCellMouseOut",h,p,g),!isImmediatePropagationStopped(h)&&(this.hot.runHooks("afterOnCellMouseOut",h,p,g),this.activeWt=this._wt)},onCellMouseOver:(h,f,g,m)=>{const p=this.translateFromRenderableToVisualCoords(f),v={row:!1,column:!1,cell:!1};this.activeWt=m,this.hot.runHooks("beforeOnCellMouseOver",h,p,g,v),!isImmediatePropagationStopped(h)&&(_classPrivateFieldGet$U(_mouseDown,this)&&(!_classPrivateFieldGet$U(_mouseDownLastPos,this)||_classPrivateFieldGet$U(_mouseDownLastPos,this).x!==h.clientX||_classPrivateFieldGet$U(_mouseDownLastPos,this).y!==h.clientY)&&handleMouseEvent(h,{coords:p,selection:this.hot.selection,controller:v,cellCoordsFactory:(w,E)=>this.hot._createCellCoords(w,E)}),this.hot.runHooks("afterOnCellMouseOver",h,p,g),this.activeWt=this._wt,_classPrivateFieldSet$R(_mouseDownLastPos,this,null))},onCellMouseUp:(h,f,g,m)=>{const p=this.translateFromRenderableToVisualCoords(f);this.activeWt=m,this.hot.runHooks("beforeOnCellMouseUp",h,p,g),!(isImmediatePropagationStopped(h)||this.hot.isDestroyed)&&(handleMouseEvent(h,{coords:p,selection:this.hot.selection,cellRangeMapper:resolveWithInstance(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",h,p,g),this.activeWt=this._wt)},onCellCornerMouseDown:h=>{h.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",h)},onCellCornerDblClick:h=>{h.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",h)},beforeDraw:(h,f)=>this.beforeRender(h,f),onDraw:h=>this.afterRender(h),onBeforeViewportScrollVertically:(h,f)=>{const g=this.hot.rowIndexMapper,m=h<0;let p=h;return!m&&(p=g.getVisualFromRenderableIndex(h),p===null)?h:(p=this.hot.runHooks("beforeViewportScrollVertically",p,f),this.hot.runHooks("beforeViewportScroll"),m?p:g.getRenderableFromVisualIndex(p))},onBeforeViewportScrollHorizontally:(h,f)=>{const g=this.hot.columnIndexMapper,m=h<0;let p=h;return!m&&(p=g.getVisualFromRenderableIndex(h),p===null)?h:(p=this.hot.runHooks("beforeViewportScrollHorizontally",p,f),this.hot.runHooks("beforeViewportScroll"),m?p:g.getRenderableFromVisualIndex(p))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(h,f,g)=>{const m=this.hot.rowIndexMapper,p=h<0;let v=h;p||(v=m.getVisualFromRenderableIndex(h));const w=this.hot.runHooks("beforeHighlightingRowHeader",v,f,g);return p?w:m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(w,1))},onBeforeHighlightingColumnHeader:(h,f,g)=>{const m=this.hot.columnIndexMapper,p=h<0;let v=h;p||(v=m.getVisualFromRenderableIndex(h));const w=this.hot.runHooks("beforeHighlightingColumnHeader",v,f,g);return p?w:m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(w,1))},onAfterDrawSelection:(h,f,g)=>{let m;const[p,v]=this.translateFromRenderableToVisualIndex(h,f),w=this.hot.selection.getSelectedRange();if(w.size()>0){const C=w.peekByIndex(g??0);m=[C.from.row,C.from.col,C.to.row,C.to.col]}return this.hot.runHooks("afterDrawSelection",p,v,m,g)},onBeforeDrawBorders:(h,f)=>{const[g,m,p,v]=h,w=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(g),this.hot.columnIndexMapper.getVisualFromRenderableIndex(m),this.hot.rowIndexMapper.getVisualFromRenderableIndex(p),this.hot.columnIndexMapper.getVisualFromRenderableIndex(v)];return this.hot.runHooks("beforeDrawBorders",w,f)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:h=>this.hot.runHooks("modifyRowHeaderWidth",h),onModifyGetCellCoords:(h,f,g,m)=>{const p=this.hot.rowIndexMapper,v=this.hot.columnIndexMapper,w=f>=0?v.getVisualFromRenderableIndex(f):f,E=h>=0?p.getVisualFromRenderableIndex(h):h,C=this.hot.runHooks("modifyGetCellCoords",E,w,g,m);if(Array.isArray(C)){const[b,P,R,T]=C;return[b>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(b,1)):b,P>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(P,1)):P,R>=0?p.getRenderableFromVisualIndex(p.getNearestNotHiddenIndex(R,-1)):R,T>=0?v.getRenderableFromVisualIndex(v.getNearestNotHiddenIndex(T,-1)):T]}},onModifyGetCoordsElement:(h,f)=>{const g=this.hot.rowIndexMapper,m=this.hot.columnIndexMapper,p=f>=0?m.getVisualFromRenderableIndex(f):f,v=h>=0?g.getVisualFromRenderableIndex(h):h,w=this.hot.runHooks("modifyGetCoordsElement",v,p);if(Array.isArray(w)){const[E,C]=w;return[E>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(E,1)):E,C>=0?m.getRenderableFromVisualIndex(m.getNearestNotHiddenIndex(C,1)):C]}},viewportRowCalculatorOverride:h=>{let f=this.settings.viewportRowRenderingOffset;if(f==="auto"&&this.settings.fixedRowsTop&&(f=10),f>0||f==="auto"){const g=this.countRenderableRows(),m=h.startRow,p=h.endRow;if(typeof f=="number")h.startRow=Math.max(m-f,0),h.endRow=Math.min(p+f,g-1);else if(f==="auto"){const v=Math.max(1,Math.ceil(p/g*12));h.startRow=Math.max(m-v,0),h.endRow=Math.min(p+v,g-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",h)},viewportColumnCalculatorOverride:h=>{let f=this.settings.viewportColumnRenderingOffset;if(f==="auto"&&this.settings.fixedColumnsStart&&(f=10),f>0||f==="auto"){const g=this.countRenderableColumns(),m=h.startColumn,p=h.endColumn;if(typeof f=="number"&&(h.startColumn=Math.max(m-f,0),h.endColumn=Math.min(p+f,g-1)),f==="auto"){const v=Math.max(1,Math.ceil(p/g*6));h.startColumn=Math.max(m-v,0),h.endColumn=Math.min(p+v,g-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",h)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const h=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||h},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",s),this._wt=new WalkontableFacade(s),this.activeWt=this._wt;const c=this._wt.wtTable.spreader,{width:u,height:d}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(u,d),this.eventManager.addEventListener(c,"mousedown",h=>{h.target===c&&h.which===3&&h.stopPropagation()}),this.eventManager.addEventListener(c,"contextmenu",h=>{h.target===c&&h.which===3&&h.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(s){var c,u;if(isInput(s))return!0;const d=isChildOf(s,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&d)return!0;const h=(c=(u=this.hot.getSelectedRangeActive())===null||u===void 0?void 0:u.isSingleCell())!==null&&c!==void 0?c:!1;return!!(this.settings.fragmentSelection==="cell"&&h&&d||!this.settings.fragmentSelection&&this.isCellEdited()&&h)}isMouseDown(){return _classPrivateFieldGet$U(_mouseDown,this)}isCellEdited(){const s=this.hot.getActiveEditor();return s&&s.isOpened()}beforeRender(s,c){s&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,c)}afterRender(s){s&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(s,c){if(c.firstChild){const u=c.firstChild;if(!hasClass$1(u,"relative")){empty(c),this.appendRowHeader(s,c);return}this.updateCellHeader(u.querySelector(".rowHeader"),s,this.hot.getRowHeader)}else{const{rootDocument:u,getRowHeader:d}=this.hot,h=u.createElement("div"),f=u.createElement("span");h.className="relative",f.className="rowHeader",this.updateCellHeader(f,s,d),h.appendChild(f),c.appendChild(h)}this.hot.runHooks("afterGetRowHeader",s,c)}appendColHeader(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const h=()=>{const f=s>=0?this.hot.getColumnMeta(s).headerClassName:null;return f?f.split(" "):[]};if(c.firstChild){const f=c.firstChild;hasClass$1(f,"relative")?(this.updateCellHeader(f.querySelector(".colHeader"),s,u,d),f.className="",addClass$1(f,["relative",...h()])):(empty(c),this.appendColHeader(s,c,u,d))}else{const{rootDocument:f}=this.hot,g=f.createElement("div"),m=f.createElement("span"),p=h();g.classList.add("relative",...p),m.className="colHeader",this.settings.ariaTags&&(setAttribute(g,...A11Y_PRESENTATION()),setAttribute(m,...A11Y_PRESENTATION())),this.updateCellHeader(m,s,u,d),g.appendChild(m),c.appendChild(g)}this.hot.runHooks("afterGetColHeader",s,c,d)}updateCellHeader(s,c,u){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,h=c;const f=this._wt.wtOverlays.getParentOverlay(s)||this._wt;s.parentNode&&(hasClass$1(s,"colHeader")?h=f.wtTable.columnFilter.sourceToRendered(c):hasClass$1(s,"rowHeader")&&(h=f.wtTable.rowFilter.sourceToRendered(c))),h>-1?fastInnerHTML(s,u(c,d)):(fastInnerText(s," "),addClass$1(s,"cornerHeader"))}maximumVisibleElementWidth(s){const u=this._wt.wtViewport.getWorkspaceWidth()-s;return u>0?u:0}maximumVisibleElementHeight(s){const u=this._wt.wtViewport.getWorkspaceHeight()-s;return u>0?u:0}setLastSize(s,c){_classPrivateFieldSet$R(_lastWidth,this,s),_classPrivateFieldSet$R(_lastHeight,this,c)}getLastSize(){return{width:_classPrivateFieldGet$U(_lastWidth,this),height:_classPrivateFieldGet$U(_lastHeight,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const s=this.hot.rowIndexMapper,c=s.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return s.getNearestNotHiddenIndex(c??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const s=this.hot.rowIndexMapper,c=s.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return s.getNearestNotHiddenIndex(c??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const s=this.hot.columnIndexMapper,c=s.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return s.getNearestNotHiddenIndex(c??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const s=this.hot.columnIndexMapper,c=s.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return s.getNearestNotHiddenIndex(c??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return _classPrivateFieldGet$U(_columnHeadersCount,this)}getRowHeadersCount(){return _classPrivateFieldGet$U(_rowHeadersCount,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(s){var c;return((c=this._wt.wtOverlays.getParentOverlay(s))!==null&&c!==void 0?c:this._wt).wtTable.name}getOverlayByName(s){return this._wt.getOverlayByName(s)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getTableScrollPosition(){return{left:this._wt.wtTable.holder.scrollLeft,top:this._wt.wtTable.holder.scrollTop}}setTableScrollPosition(s){this._wt.wtTable.holder.scrollLeft=s.left,this._wt.wtTable.holder.scrollTop=s.top}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function _getAriaColcount(){return parseInt(this.hot.rootElement.getAttribute(A11Y_COLCOUNT()[0]),10)}function _updateAriaColcount(a){const s=_assertClassBrand$1c(_TableView_brand,this,_getAriaColcount).call(this)+a;setAttribute(this.hot.rootElement,...A11Y_COLCOUNT(s))}function _updateScrollbarClassNames(){const a=this.hot.rootElement;this.hasVerticalScroll()?addClass$1(a,"htHasScrollY"):removeClass$1(a,"htHasScrollY"),this.isVerticallyScrollableByWindow()?addClass$1(a,"htVerticallyScrollableByWindow"):removeClass$1(a,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?addClass$1(a,"htHasScrollX"):removeClass$1(a,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?addClass$1(a,"htHorizontallyScrollableByWindow"):removeClass$1(a,"htHorizontallyScrollableByWindow")}var esnext_iterator_every={},es_iterator_every={},hasRequiredEs_iterator_every;function requireEs_iterator_every(){if(hasRequiredEs_iterator_every)return es_iterator_every;hasRequiredEs_iterator_every=1;var a=require_export(),s=requireFunctionCall(),c=requireIterate(),u=requireACallable(),d=requireAnObject(),h=requireGetIteratorDirect(),f=requireIteratorClose(),g=requireIteratorHelperWithoutClosingOnEarlyError(),m=g("every",TypeError);return a({target:"Iterator",proto:!0,real:!0,forced:m},{every:function(v){d(this);try{u(v)}catch(C){f(this,"throw",C)}if(m)return s(m,this,v);var w=h(this),E=0;return!c(w,function(C,b){if(!v(C,E++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_every}var hasRequiredEsnext_iterator_every;function requireEsnext_iterator_every(){return hasRequiredEsnext_iterator_every||(hasRequiredEsnext_iterator_every=1,requireEs_iterator_every()),esnext_iterator_every}requireEsnext_iterator_every();const COLUMN_LABEL_BASE="ABCDEFGHIJKLMNOPQRSTUVWXYZ",COLUMN_LABEL_BASE_LENGTH=COLUMN_LABEL_BASE.length;function spreadsheetColumnLabel(a){let s=a+1,c="",u;for(;s>0;)u=(s-1)%COLUMN_LABEL_BASE_LENGTH,c=String.fromCharCode(65+u)+c,s=parseInt((s-u)/COLUMN_LABEL_BASE_LENGTH,10);return c}function dataRowToChangesArray(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,c=a;const u=[];return(!Array.isArray(a)||!Array.isArray(a[0]))&&(c=[a]),c.forEach((d,h)=>{Array.isArray(d)?d.forEach((f,g)=>{u.push([h+s,g,f])}):Object.keys(d).forEach(f=>{u.push([h+s,f,d[f]])})}),u}function countFirstRowKeys(a){let s=0;return Array.isArray(a)&&(a[0]&&Array.isArray(a[0])?s=a[0].length:a[0]&&isObject(a[0])&&(s=deepObjectSize(a[0]))),s}function isArrayOfArrays(a){return!!(Array.isArray(a)&&a.length&&a.every(s=>Array.isArray(s)))}function isArrayOfObjects(a){return!!(Array.isArray(a)&&a.length&&a.every(s=>typeof s=="object"&&!Array.isArray(s)&&s!==null))}function _defineProperty$1A(a,s,c){return(s=_toPropertyKey$1B(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1B(a){var s=_toPrimitive$1B(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1B(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DataSource{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];_defineProperty$1A(this,"hot",void 0),_defineProperty$1A(this,"data",void 0),_defineProperty$1A(this,"dataType","array"),_defineProperty$1A(this,"colToProp",()=>{}),_defineProperty$1A(this,"propToCol",()=>{}),this.hot=s,this.data=c}modifyRowData(s){let c;return this.hot.hasHook("modifyRowData")&&(c=this.hot.runHooks("modifyRowData",s)),c!==void 0&&!Number.isInteger(c)?c:this.data[s]}getData(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,s)}setData(s){this.data=s}getAtColumn(s){const c=[];return arrayEach(this.data,(u,d)=>{const h=this.getAtCell(d,s);c.push(h)}),c}getAtRow(s,c,u){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const h=c===void 0&&u===void 0,{dataDotNotation:f}=this.hot.getSettings();let g=null,m=null;if(g=this.modifyRowData(s),Array.isArray(g))m=[],h?g.forEach((p,v)=>{m[v]=this.getAtPhysicalCell(s,v,g)}):rangeEach(c,u,p=>{m[p-c]=this.getAtPhysicalCell(s,p,g)});else if(isObject(g)||isFunction(g))if(d?m=[]:m={},!h||d){const v=this.countFirstRowKeys()-1;rangeEach(0,v,w=>{const E=this.colToProp(w);if(w>=(c||0)&&w<=(u||v)&&!Number.isInteger(E)){const C=this.getAtPhysicalCell(s,E,g);d?m.push(C):f?setProperty(m,E,C):m[E]=C}})}else objectEach(g,(p,v)=>{const w=this.getAtPhysicalCell(s,v,g);f?setProperty(m,v,w):m[v]=w});return m}setAtCell(s,c,u){if(!(s>=this.countRows()||c>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const d=createObjectPropListener(u);this.hot.runHooks("modifySourceData",s,c,d,"set"),d.isTouched()&&(u=d.value)}["__proto__","constructor","prototype"].includes(s)||(Number.isInteger(c)?this.data[s][c]=u:setProperty(this.data[s],c,u))}}getAtPhysicalCell(s,c,u){let d=null;if(u)if(typeof c=="string"){const{dataDotNotation:h}=this.hot.getSettings();d=h?getProperty(u,c):u[c]}else typeof c=="function"?d=c(u):d=u[c];if(this.hot.hasHook("modifySourceData")){const h=createObjectPropListener(d);this.hot.runHooks("modifySourceData",s,c,h,"get"),h.isTouched()&&(d=h.value)}return d}getAtCell(s,c){const u=this.modifyRowData(s);return this.getAtPhysicalCell(s,this.colToProp(c),u)}getByRange(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=!1,h=null,f=null,g=null,m=null;s===null||c===null?(d=!0,h=0,g=this.countRows()-1):(h=Math.min(s.row,c.row),f=Math.min(s.col,c.col),g=Math.max(s.row,c.row),m=Math.max(s.col,c.col));const p=[];return rangeEach(h,g,v=>{p.push(d?this.getAtRow(v,void 0,void 0,u):this.getAtRow(v,f,m,u))}),p}getCopyable(s,c){const u=this.propToCol(c);return this.hot.getCellMeta(s,u).copyable?this.getAtCell(this.hot.toPhysicalRow(s),u):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const s=this.hot.runHooks("modifySourceLength");if(Number.isInteger(s))return s}return this.data.length}countFirstRowKeys(){return countFirstRowKeys(this.data)}destroy(){this.data=null,this.hot=null}}var esnext_iterator_some={},es_iterator_some={},hasRequiredEs_iterator_some;function requireEs_iterator_some(){if(hasRequiredEs_iterator_some)return es_iterator_some;hasRequiredEs_iterator_some=1;var a=require_export(),s=requireFunctionCall(),c=requireIterate(),u=requireACallable(),d=requireAnObject(),h=requireGetIteratorDirect(),f=requireIteratorClose(),g=requireIteratorHelperWithoutClosingOnEarlyError(),m=g("some",TypeError);return a({target:"Iterator",proto:!0,real:!0,forced:m},{some:function(v){d(this);try{u(v)}catch(C){f(this,"throw",C)}if(m)return s(m,this,v);var w=h(this),E=0;return c(w,function(C,b){if(v(C,E++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),es_iterator_some}var hasRequiredEsnext_iterator_some;function requireEsnext_iterator_some(){return hasRequiredEsnext_iterator_some||(hasRequiredEsnext_iterator_some=1,requireEs_iterator_some()),esnext_iterator_some}requireEsnext_iterator_some();function _defineProperty$1z(a,s,c){return(s=_toPropertyKey$1A(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1A(a){var s=_toPrimitive$1A(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1A(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class IndexMap{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;_defineProperty$1z(this,"indexedValues",[]),_defineProperty$1z(this,"initValueOrFn",void 0),this.initValueOrFn=s}getValues(){return this.indexedValues}getValueAtIndex(s){const c=this.indexedValues;if(s<c.length)return c[s]}setValues(s){this.indexedValues=s.slice(),this.runLocalHooks("change")}setValueAtIndex(s,c){return s<this.indexedValues.length?(this.indexedValues[s]=c,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,isFunction(this.initValueOrFn)?rangeEach(s-1,c=>this.indexedValues.push(this.initValueOrFn(c))):rangeEach(s-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(s){return this.setDefaultValues(s),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}mixin(IndexMap,localHooks);function getListWithInsertedItems$3(a,s,c,u){const d=c.length?c[0]:void 0;return[...a.slice(0,d),...c.map((h,f)=>isFunction(u)?u(h,f):u),...d===void 0?[]:a.slice(d)]}function getListWithRemovedItems$3(a,s){return arrayFilter(a,(c,u)=>s.includes(u)===!1)}class PhysicalIndexToValueMap extends IndexMap{insert(s,c){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,s,c,this.initValueOrFn),super.insert(s,c)}remove(s){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,s),super.remove(s)}}class HidingMap extends PhysicalIndexToValueMap{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(s)}getHiddenIndexes(){return arrayReduce(this.getValues(),(s,c,u)=>(c&&s.push(u),s),[])}}function getListWithInsertedItems$2(a,s,c){return[...a.slice(0,s),...c,...a.slice(s)]}function getListWithRemovedItems$2(a,s){return arrayFilter(a,c=>s.includes(c)===!1)}function getDecreasedIndexes(a,s){return arrayMap(a,c=>c-s.filter(u=>u<c).length)}function getIncreasedIndexes(a,s){const c=s[0],u=s.length;return arrayMap(a,d=>d>=c?d+u:d)}function _defineProperty$1y(a,s,c){return(s=_toPropertyKey$1z(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1z(a){var s=_toPrimitive$1z(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1z(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class LinkedPhysicalIndexToValueMap extends IndexMap{constructor(){super(...arguments),_defineProperty$1y(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(s=>this.indexedValues[s])}setValues(s){this.orderOfIndexes=[...Array(s.length).keys()],super.setValues(s)}setValueAtIndex(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return s<this.indexedValues.length?(this.indexedValues[s]=c,this.orderOfIndexes.includes(s)===!1&&this.orderOfIndexes.splice(u,0,s),this.runLocalHooks("change"),!0):!1}clearValue(s){this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,[s]),isFunction(this.initValueOrFn)?super.setValueAtIndex(s,this.initValueOrFn(s)):super.setValueAtIndex(s,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(s)}insert(s,c){this.indexedValues=getListWithInsertedItems$3(this.indexedValues,s,c,this.initValueOrFn),this.orderOfIndexes=getIncreasedIndexes(this.orderOfIndexes,c),super.insert(s,c)}remove(s){this.indexedValues=getListWithRemovedItems$3(this.indexedValues,s),this.orderOfIndexes=getListWithRemovedItems$2(this.orderOfIndexes,s),this.orderOfIndexes=getDecreasedIndexes(this.orderOfIndexes,s),super.remove(s)}getEntries(){return this.orderOfIndexes.map(s=>[s,this.getValueAtIndex(s)])}}class TrimmingMap extends PhysicalIndexToValueMap{constructor(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(s)}getTrimmedIndexes(){return arrayReduce(this.getValues(),(s,c,u)=>(c&&s.push(u),s),[])}}const alterStrategies=new Map([["indexesSequence",{getListWithInsertedItems:getListWithInsertedItems$2,getListWithRemovedItems:getListWithRemovedItems$2}],["physicallyIndexed",{getListWithInsertedItems:getListWithInsertedItems$3,getListWithRemovedItems:getListWithRemovedItems$3}]]),alterUtilsFactory=a=>{if(alterStrategies.has(a)===!1)throw new Error(`Alter strategy with ID '${a}' does not exist.`);return alterStrategies.get(a)};class IndexesSequence extends IndexMap{constructor(){super(s=>s)}insert(s,c){const u=getIncreasedIndexes(this.indexedValues,c);this.indexedValues=getListWithInsertedItems$2(u,s,c),super.insert(s,c)}remove(s){const c=getListWithRemovedItems$2(this.indexedValues,s);this.indexedValues=getDecreasedIndexes(c,s),super.remove(s)}}const availableIndexMapTypes=new Map([["hiding",HidingMap],["index",IndexMap],["linkedPhysicalIndexToValue",LinkedPhysicalIndexToValueMap],["physicalIndexToValue",PhysicalIndexToValueMap],["trimming",TrimmingMap]]);function createIndexMap(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!availableIndexMapTypes.has(a))throw new Error(`The provided map type ("${a}") does not exist.`);return new(availableIndexMapTypes.get(a))(s)}function _defineProperty$1x(a,s,c){return(s=_toPropertyKey$1y(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1y(a){var s=_toPrimitive$1y(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1y(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class MapCollection{constructor(){_defineProperty$1x(this,"collection",new Map)}register(s,c){this.collection.has(s)===!1&&(this.collection.set(s,c),c.addLocalHook("change",()=>this.runLocalHooks("change",c)))}unregister(s){const c=this.collection.get(s);isDefined(c)&&(c.destroy(),this.collection.delete(s),this.runLocalHooks("change",c))}unregisterAll(){this.collection.forEach((s,c)=>this.unregister(c)),this.collection.clear()}get(s){return isUndefined(s)?Array.from(this.collection.values()):this.collection.get(s)}getLength(){return this.collection.size}removeFromEvery(s){this.collection.forEach(c=>{c.remove(s)})}insertToEvery(s,c){this.collection.forEach(u=>{u.insert(s,c)})}initEvery(s){this.collection.forEach(c=>{c.init(s)})}}mixin(MapCollection,localHooks);function _defineProperty$1w(a,s,c){return(s=_toPropertyKey$1x(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1x(a){var s=_toPrimitive$1x(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1x(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class AggregatedCollection extends MapCollection{constructor(s,c){super(),_defineProperty$1w(this,"mergedValuesCache",[]),_defineProperty$1w(this,"aggregationFunction",void 0),_defineProperty$1w(this,"fallbackValue",void 0),this.aggregationFunction=s,this.fallbackValue=c}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const c=arrayMap(this.get(),h=>h.getValues()),u=[],d=isDefined(c[0])&&c[0].length||0;for(let h=0;h<d;h+=1){const f=[];for(let g=0;g<this.getLength();g+=1)f.push(c[g][h]);u.push(f)}return arrayMap(u,this.aggregationFunction)}getMergedValueAtIndex(s,c){const u=this.getMergedValues(c)[s];return isDefined(u)?u:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function _classPrivateFieldInitSpec$T(a,s,c){_checkPrivateRedeclaration$1b(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1b(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$Q(a,s,c){return a.set(_assertClassBrand$1b(a,s),c),c}function _classPrivateFieldGet$T(a,s){return a.get(_assertClassBrand$1b(a,s))}function _assertClassBrand$1b(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _currentInitialChanges=new WeakMap;class ChangesObserver{constructor(){_classPrivateFieldInitSpec$T(this,_currentInitialChanges,[])}subscribe(s){return this.addLocalHook("change",s),this._write(_classPrivateFieldGet$T(_currentInitialChanges,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(s){return s.length>0&&this.runLocalHooks("change",s),this}_writeInitialChanges(s){_classPrivateFieldSet$Q(_currentInitialChanges,this,s)}}mixin(ChangesObserver,localHooks);function arrayDiff(a,s){const c=[];let u=0,d=0;for(;u<a.length&&d<s.length;u++,d++)a[u]!==s[d]&&c.push({op:"replace",index:d,oldValue:a[u],newValue:s[d]});for(;u<s.length;u++)c.push({op:"insert",index:u,oldValue:void 0,newValue:s[u]});for(;d<a.length;d++)c.push({op:"remove",index:d,oldValue:a[d],newValue:void 0});return c}function _classPrivateFieldInitSpec$S(a,s,c){_checkPrivateRedeclaration$1a(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1a(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$S(a,s){return a.get(_assertClassBrand$1a(a,s))}function _classPrivateFieldSet$P(a,s,c){return a.set(_assertClassBrand$1a(a,s),c),c}function _assertClassBrand$1a(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _observers=new WeakMap,_indexMatrix=new WeakMap,_currentIndexState=new WeakMap,_isMatrixIndexesInitialized=new WeakMap,_initialIndexValue=new WeakMap;class ChangesObservable{constructor(){let{initialIndexValue:s}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};_classPrivateFieldInitSpec$S(this,_observers,new Set),_classPrivateFieldInitSpec$S(this,_indexMatrix,[]),_classPrivateFieldInitSpec$S(this,_currentIndexState,[]),_classPrivateFieldInitSpec$S(this,_isMatrixIndexesInitialized,!1),_classPrivateFieldInitSpec$S(this,_initialIndexValue,!1),_classPrivateFieldSet$P(_initialIndexValue,this,s??!1)}createObserver(){const s=new ChangesObserver;return _classPrivateFieldGet$S(_observers,this).add(s),s.addLocalHook("unsubscribe",()=>{_classPrivateFieldGet$S(_observers,this).delete(s)}),s._writeInitialChanges(arrayDiff(_classPrivateFieldGet$S(_indexMatrix,this),_classPrivateFieldGet$S(_currentIndexState,this))),s}emit(s){let c=_classPrivateFieldGet$S(_currentIndexState,this);(!_classPrivateFieldGet$S(_isMatrixIndexesInitialized,this)||_classPrivateFieldGet$S(_indexMatrix,this).length!==s.length)&&(s.length===0?s=new Array(c.length).fill(_classPrivateFieldGet$S(_initialIndexValue,this)):_classPrivateFieldSet$P(_indexMatrix,this,new Array(s.length).fill(_classPrivateFieldGet$S(_initialIndexValue,this))),_classPrivateFieldGet$S(_isMatrixIndexesInitialized,this)||(_classPrivateFieldSet$P(_isMatrixIndexesInitialized,this,!0),c=_classPrivateFieldGet$S(_indexMatrix,this)));const u=arrayDiff(c,s);_classPrivateFieldGet$S(_observers,this).forEach(d=>d._write(u)),_classPrivateFieldSet$P(_currentIndexState,this,s)}}function _defineProperty$1v(a,s,c){return(s=_toPropertyKey$1w(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1w(a){var s=_toPrimitive$1w(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1w(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class IndexMapper{constructor(){_defineProperty$1v(this,"indexesSequence",new IndexesSequence),_defineProperty$1v(this,"trimmingMapsCollection",new AggregatedCollection(s=>s.some(c=>c===!0),!1)),_defineProperty$1v(this,"hidingMapsCollection",new AggregatedCollection(s=>s.some(c=>c===!0),!1)),_defineProperty$1v(this,"variousMapsCollection",new MapCollection),_defineProperty$1v(this,"hidingChangesObservable",new ChangesObservable({initialIndexValue:!1})),_defineProperty$1v(this,"notTrimmedIndexesCache",[]),_defineProperty$1v(this,"notHiddenIndexesCache",[]),_defineProperty$1v(this,"isBatched",!1),_defineProperty$1v(this,"indexesSequenceChanged",!1),_defineProperty$1v(this,"indexesChangeSource",void 0),_defineProperty$1v(this,"trimmedIndexesChanged",!1),_defineProperty$1v(this,"hiddenIndexesChanged",!1),_defineProperty$1v(this,"renderablePhysicalIndexesCache",[]),_defineProperty$1v(this,"fromPhysicalToVisualIndexesCache",new Map),_defineProperty$1v(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",s=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",s,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",s=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",s,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",s=>{this.runLocalHooks("change",s,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(s){if(s!=="hiding")throw new Error(`Unsupported index map type "${s}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(s,c,u){return this.registerMap(s,createIndexMap(c,u))}registerMap(s,c){if(this.trimmingMapsCollection.get(s)||this.hidingMapsCollection.get(s)||this.variousMapsCollection.get(s))throw Error(`Map with name "${s}" has been already registered.`);c instanceof TrimmingMap?this.trimmingMapsCollection.register(s,c):c instanceof HidingMap?this.hidingMapsCollection.register(s,c):this.variousMapsCollection.register(s,c);const u=this.getNumberOfIndexes();return u>0&&c.init(u),c}unregisterMap(s){this.trimmingMapsCollection.unregister(s),this.hidingMapsCollection.unregister(s),this.variousMapsCollection.unregister(s)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(s){const c=this.notTrimmedIndexesCache[s];return isDefined(c)?c:null}getPhysicalFromRenderableIndex(s){const c=this.renderablePhysicalIndexesCache[s];return isDefined(c)?c:null}getVisualFromPhysicalIndex(s){const c=this.fromPhysicalToVisualIndexesCache.get(s);return isDefined(c)?c:null}getVisualFromRenderableIndex(s){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(s))}getRenderableFromVisualIndex(s){const c=this.fromVisualToRenderableIndexesCache.get(s);return isDefined(c)?c:null}getNearestNotHiddenIndex(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(s)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(s))return s;const h=Array.from(this.fromVisualToRenderableIndexesCache.keys());let f=-1;return c>0?f=h.findIndex(g=>g>s):f=h.reverse().findIndex(g=>g<s),f===-1?u?this.getNearestNotHiddenIndex(s,-c,!1):null:h[f]}initToLength(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(s).keys()],this.notHiddenIndexesCache=[...new Array(s).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(s),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(s),this.variousMapsCollection.initEvery(s),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(s){const c=this.getNumberOfIndexes();if(s<c){const u=[...Array(this.getNumberOfIndexes()-s).keys()].map(d=>d+s);this.removeIndexes(u)}else this.insertIndexes(c,s-c)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(s){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(s),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(u=>this.isTrimmed(u)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(u=>this.isHidden(u)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(u=>this.isHidden(u)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(s,c){typeof s=="number"&&(s=[s]);const u=arrayMap(s,p=>this.getPhysicalFromVisualIndex(p)),d=this.getNotTrimmedIndexesLength(),h=s.length,f=getListWithRemovedItems$2(this.getIndexesSequence(),u),g=f.filter(p=>this.isTrimmed(p)===!1);let m=f.indexOf(g[g.length-1])+1;if(c+h<d){const p=g[c];m=f.indexOf(p)}this.indexesChangeSource="move",this.setIndexesSequence(getListWithInsertedItems$2(f,m,u)),this.indexesChangeSource=void 0}isTrimmed(s){return this.trimmingMapsCollection.getMergedValueAtIndex(s)}isHidden(s){return this.hidingMapsCollection.getMergedValueAtIndex(s)}insertIndexes(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const d=this.getNotTrimmedIndexes()[s],h=isDefined(d)?d:this.getNumberOfIndexes(),f=this.getIndexesSequence().includes(d)?this.getIndexesSequence().indexOf(d):this.getNumberOfIndexes(),g=arrayMap(new Array(c).fill(h),(p,v)=>p+v);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(f,g),this.indexesChangeSource=void 0;const m=u==="end"?g.map(p=>p+1):g;this.trimmingMapsCollection.insertToEvery(f,m),this.hidingMapsCollection.insertToEvery(f,m),this.variousMapsCollection.insertToEvery(f,m),this.resumeOperations()}removeIndexes(s){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(s),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(s),this.hidingMapsCollection.removeFromEvery(s),this.variousMapsCollection.removeFromEvery(s),this.resumeOperations()}updateCache(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const c=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(s===!0||this.isBatched===!1&&c===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const s=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let c=0;c<s;c+=1){const u=this.getPhysicalFromVisualIndex(c);this.fromPhysicalToVisualIndexesCache.set(u,c)}}cacheFromVisualToRenderableIndexes(){const s=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let c=0;c<s;c+=1){const u=this.getPhysicalFromRenderableIndex(c),d=this.getVisualFromPhysicalIndex(u);this.fromVisualToRenderableIndexesCache.set(d,c)}}}mixin(IndexMapper,localHooks);function extendNotExistingKeys(a,s){return objectEach(s,(c,u)=>{isUndefined(a[u])&&(a[u]=c)}),a}function normalizeLanguageCode(a){const c=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(a);return c?`${c[1].toLowerCase()}-${c[2].toUpperCase()}`:a}function warnUserAboutLanguageRegistration(a){isDefined(a)&&error(toSingleLine`Language with code "${a}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function pluralize(a,s){return Array.isArray(a)&&Number.isInteger(s)?a[s]:a}function substituteVariables(a,s){return Array.isArray(a)?a.map(c=>substituteVariables(c,s)):substitute(a,s)}const{register:registerGloballyPhraseFormatter,getValues:getGlobalPhraseFormatters}=staticRegister("phraseFormatters");function register$1(a,s){registerGloballyPhraseFormatter(a,s)}function getAll(){return getGlobalPhraseFormatters()}register$1("pluralize",pluralize),register$1("substitute",substituteVariables);const COMMON_NAMESPACE="Common:",OK=`${COMMON_NAMESPACE}ok`,CANCEL=`${COMMON_NAMESPACE}cancel`,CONTEXT_MENU_ITEMS_NAMESPACE="ContextMenu:items",CM_ALIAS=CONTEXT_MENU_ITEMS_NAMESPACE,CONTEXTMENU_ITEMS_NO_ITEMS=`${CM_ALIAS}.noItems`,CONTEXTMENU_ITEMS_ROW_ABOVE=`${CM_ALIAS}.insertRowAbove`,CONTEXTMENU_ITEMS_ROW_BELOW=`${CM_ALIAS}.insertRowBelow`,CONTEXTMENU_ITEMS_INSERT_LEFT=`${CM_ALIAS}.insertColumnOnTheLeft`,CONTEXTMENU_ITEMS_INSERT_RIGHT=`${CM_ALIAS}.insertColumnOnTheRight`,CONTEXTMENU_ITEMS_REMOVE_ROW=`${CM_ALIAS}.removeRow`,CONTEXTMENU_ITEMS_REMOVE_COLUMN=`${CM_ALIAS}.removeColumn`,CONTEXTMENU_ITEMS_UNDO=`${CM_ALIAS}.undo`,CONTEXTMENU_ITEMS_REDO=`${CM_ALIAS}.redo`,CONTEXTMENU_ITEMS_READ_ONLY=`${CM_ALIAS}.readOnly`,CONTEXTMENU_ITEMS_CLEAR_COLUMN=`${CM_ALIAS}.clearColumn`,CONTEXTMENU_ITEMS_COPY=`${CM_ALIAS}.copy`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS=`${CM_ALIAS}.copyWithHeaders`,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS=`${CM_ALIAS}.copyWithGroupHeaders`,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY=`${CM_ALIAS}.copyHeadersOnly`,CONTEXTMENU_ITEMS_CUT=`${CM_ALIAS}.cut`,CONTEXTMENU_ITEMS_FREEZE_COLUMN=`${CM_ALIAS}.freezeColumn`,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN=`${CM_ALIAS}.unfreezeColumn`,CONTEXTMENU_ITEMS_MERGE_CELLS=`${CM_ALIAS}.mergeCells`,CONTEXTMENU_ITEMS_UNMERGE_CELLS=`${CM_ALIAS}.unmergeCells`,CONTEXTMENU_ITEMS_ADD_COMMENT=`${CM_ALIAS}.addComment`,CONTEXTMENU_ITEMS_EDIT_COMMENT=`${CM_ALIAS}.editComment`,CONTEXTMENU_ITEMS_REMOVE_COMMENT=`${CM_ALIAS}.removeComment`,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT=`${CM_ALIAS}.readOnlyComment`,CONTEXTMENU_ITEMS_ALIGNMENT=`${CM_ALIAS}.align`,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT=`${CM_ALIAS}.align.left`,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER=`${CM_ALIAS}.align.center`,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT=`${CM_ALIAS}.align.right`,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY=`${CM_ALIAS}.align.justify`,CONTEXTMENU_ITEMS_ALIGNMENT_TOP=`${CM_ALIAS}.align.top`,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE=`${CM_ALIAS}.align.middle`,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM=`${CM_ALIAS}.align.bottom`,CONTEXTMENU_ITEMS_BORDERS=`${CM_ALIAS}.borders`,CONTEXTMENU_ITEMS_BORDERS_TOP=`${CM_ALIAS}.borders.top`,CONTEXTMENU_ITEMS_BORDERS_RIGHT=`${CM_ALIAS}.borders.right`,CONTEXTMENU_ITEMS_BORDERS_BOTTOM=`${CM_ALIAS}.borders.bottom`,CONTEXTMENU_ITEMS_BORDERS_LEFT=`${CM_ALIAS}.borders.left`,CONTEXTMENU_ITEMS_REMOVE_BORDERS=`${CM_ALIAS}.borders.remove`,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD=`${CM_ALIAS}.nestedHeaders.insertChildRow`,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD=`${CM_ALIAS}.nestedHeaders.detachFromParent`,CONTEXTMENU_ITEMS_HIDE_COLUMN=`${CM_ALIAS}.hideColumn`,CONTEXTMENU_ITEMS_SHOW_COLUMN=`${CM_ALIAS}.showColumn`,CONTEXTMENU_ITEMS_HIDE_ROW=`${CM_ALIAS}.hideRow`,CONTEXTMENU_ITEMS_SHOW_ROW=`${CM_ALIAS}.showRow`,FILTERS_NAMESPACE="Filters:",FILTERS_CONDITIONS_NAMESPACE=`${FILTERS_NAMESPACE}conditions`,FILTERS_CONDITIONS_NONE=`${FILTERS_CONDITIONS_NAMESPACE}.none`,FILTERS_CONDITIONS_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isEmpty`,FILTERS_CONDITIONS_NOT_EMPTY=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEmpty`,FILTERS_CONDITIONS_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isEqualTo`,FILTERS_CONDITIONS_NOT_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.isNotEqualTo`,FILTERS_CONDITIONS_BEGINS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.beginsWith`,FILTERS_CONDITIONS_ENDS_WITH=`${FILTERS_CONDITIONS_NAMESPACE}.endsWith`,FILTERS_CONDITIONS_CONTAINS=`${FILTERS_CONDITIONS_NAMESPACE}.contains`,FILTERS_CONDITIONS_NOT_CONTAIN=`${FILTERS_CONDITIONS_NAMESPACE}.doesNotContain`,FILTERS_CONDITIONS_BY_VALUE=`${FILTERS_CONDITIONS_NAMESPACE}.byValue`,FILTERS_CONDITIONS_GREATER_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThan`,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.greaterThanOrEqualTo`,FILTERS_CONDITIONS_LESS_THAN=`${FILTERS_CONDITIONS_NAMESPACE}.lessThan`,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL=`${FILTERS_CONDITIONS_NAMESPACE}.lessThanOrEqualTo`,FILTERS_CONDITIONS_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isBetween`,FILTERS_CONDITIONS_NOT_BETWEEN=`${FILTERS_CONDITIONS_NAMESPACE}.isNotBetween`,FILTERS_CONDITIONS_AFTER=`${FILTERS_CONDITIONS_NAMESPACE}.after`,FILTERS_CONDITIONS_BEFORE=`${FILTERS_CONDITIONS_NAMESPACE}.before`,FILTERS_CONDITIONS_TODAY=`${FILTERS_CONDITIONS_NAMESPACE}.today`,FILTERS_CONDITIONS_TOMORROW=`${FILTERS_CONDITIONS_NAMESPACE}.tomorrow`,FILTERS_CONDITIONS_YESTERDAY=`${FILTERS_CONDITIONS_NAMESPACE}.yesterday`,FILTERS_DIVS_FILTER_BY_CONDITION=`${FILTERS_NAMESPACE}labels.filterByCondition`,FILTERS_DIVS_FILTER_BY_VALUE=`${FILTERS_NAMESPACE}labels.filterByValue`,FILTERS_LABELS_CONJUNCTION=`${FILTERS_NAMESPACE}labels.conjunction`,FILTERS_LABELS_DISJUNCTION=`${FILTERS_NAMESPACE}labels.disjunction`,FILTERS_VALUES_BLANK_CELLS=`${FILTERS_NAMESPACE}values.blankCells`,FILTERS_BUTTONS_SELECT_ALL=`${FILTERS_NAMESPACE}buttons.selectAll`,FILTERS_BUTTONS_CLEAR=`${FILTERS_NAMESPACE}buttons.clear`,FILTERS_BUTTONS_OK=`${FILTERS_NAMESPACE}buttons.ok`,FILTERS_BUTTONS_CANCEL=`${FILTERS_NAMESPACE}buttons.cancel`,FILTERS_BUTTONS_PLACEHOLDER_SEARCH=`${FILTERS_NAMESPACE}buttons.placeholder.search`,FILTERS_BUTTONS_PLACEHOLDER_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.value`,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE=`${FILTERS_NAMESPACE}buttons.placeholder.secondValue`,PAGINATION_NAMESPACE="Pagination:",PAGINATION_SECTION=`${PAGINATION_NAMESPACE}section.pagination`,PAGINATION_PAGE_SIZE_AUTO=`${PAGINATION_NAMESPACE}.pageSize.auto`,PAGINATION_PAGE_SIZE_SECTION=`${PAGINATION_NAMESPACE}section.pageSize`,PAGINATION_COUNTER_SECTION=`${PAGINATION_NAMESPACE}section.counter`,PAGINATION_NAV_SECTION=`${PAGINATION_NAMESPACE}section.navigation`,PAGINATION_FIRST_PAGE=`${PAGINATION_NAMESPACE}firstPage`,PAGINATION_PREV_PAGE=`${PAGINATION_NAMESPACE}prevPage`,PAGINATION_NEXT_PAGE=`${PAGINATION_NAMESPACE}nextPage`,PAGINATION_LAST_PAGE=`${PAGINATION_NAMESPACE}lastPage`,CHECKBOX_RENDERER_NAMESPACE="CheckboxRenderer:",CHECKBOX_CHECKED=`${CHECKBOX_RENDERER_NAMESPACE}checked`,CHECKBOX_UNCHECKED=`${CHECKBOX_RENDERER_NAMESPACE}unchecked`,LOADING_NAMESPACE="Loading:",LOADING_TITLE=`${LOADING_NAMESPACE}title`,EMPTY_DATA_STATE_NAMESPACE="EmptyDataState:",EMPTY_DATA_STATE_TITLE=`${EMPTY_DATA_STATE_NAMESPACE}title`,EMPTY_DATA_STATE_DESCRIPTION=`${EMPTY_DATA_STATE_NAMESPACE}description`,EMPTY_DATA_STATE_TITLE_FILTERS=`${EMPTY_DATA_STATE_NAMESPACE}title.filters`,EMPTY_DATA_STATE_DESCRIPTION_FILTERS=`${EMPTY_DATA_STATE_NAMESPACE}description.filters`,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET=`${EMPTY_DATA_STATE_NAMESPACE}buttons.filters.reset`,_dictionaryKeys=Object.freeze(Object.defineProperty({__proto__:null,CANCEL,CHECKBOX_CHECKED,CHECKBOX_RENDERER_NAMESPACE,CHECKBOX_UNCHECKED,COMMON_NAMESPACE,CONTEXTMENU_ITEMS_ADD_COMMENT,CONTEXTMENU_ITEMS_ALIGNMENT,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT,CONTEXTMENU_ITEMS_ALIGNMENT_TOP,CONTEXTMENU_ITEMS_BORDERS,CONTEXTMENU_ITEMS_BORDERS_BOTTOM,CONTEXTMENU_ITEMS_BORDERS_LEFT,CONTEXTMENU_ITEMS_BORDERS_RIGHT,CONTEXTMENU_ITEMS_BORDERS_TOP,CONTEXTMENU_ITEMS_CLEAR_COLUMN,CONTEXTMENU_ITEMS_COPY,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,CONTEXTMENU_ITEMS_CUT,CONTEXTMENU_ITEMS_EDIT_COMMENT,CONTEXTMENU_ITEMS_FREEZE_COLUMN,CONTEXTMENU_ITEMS_HIDE_COLUMN,CONTEXTMENU_ITEMS_HIDE_ROW,CONTEXTMENU_ITEMS_INSERT_LEFT,CONTEXTMENU_ITEMS_INSERT_RIGHT,CONTEXTMENU_ITEMS_MERGE_CELLS,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD,CONTEXTMENU_ITEMS_NO_ITEMS,CONTEXTMENU_ITEMS_READ_ONLY,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT,CONTEXTMENU_ITEMS_REDO,CONTEXTMENU_ITEMS_REMOVE_BORDERS,CONTEXTMENU_ITEMS_REMOVE_COLUMN,CONTEXTMENU_ITEMS_REMOVE_COMMENT,CONTEXTMENU_ITEMS_REMOVE_ROW,CONTEXTMENU_ITEMS_ROW_ABOVE,CONTEXTMENU_ITEMS_ROW_BELOW,CONTEXTMENU_ITEMS_SHOW_COLUMN,CONTEXTMENU_ITEMS_SHOW_ROW,CONTEXTMENU_ITEMS_UNDO,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN,CONTEXTMENU_ITEMS_UNMERGE_CELLS,CONTEXT_MENU_ITEMS_NAMESPACE,EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET,EMPTY_DATA_STATE_DESCRIPTION,EMPTY_DATA_STATE_DESCRIPTION_FILTERS,EMPTY_DATA_STATE_NAMESPACE,EMPTY_DATA_STATE_TITLE,EMPTY_DATA_STATE_TITLE_FILTERS,FILTERS_BUTTONS_CANCEL,FILTERS_BUTTONS_CLEAR,FILTERS_BUTTONS_OK,FILTERS_BUTTONS_PLACEHOLDER_SEARCH,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE,FILTERS_BUTTONS_PLACEHOLDER_VALUE,FILTERS_BUTTONS_SELECT_ALL,FILTERS_CONDITIONS_AFTER,FILTERS_CONDITIONS_BEFORE,FILTERS_CONDITIONS_BEGINS_WITH,FILTERS_CONDITIONS_BETWEEN,FILTERS_CONDITIONS_BY_VALUE,FILTERS_CONDITIONS_CONTAINS,FILTERS_CONDITIONS_EMPTY,FILTERS_CONDITIONS_ENDS_WITH,FILTERS_CONDITIONS_EQUAL,FILTERS_CONDITIONS_GREATER_THAN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,FILTERS_CONDITIONS_LESS_THAN,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,FILTERS_CONDITIONS_NAMESPACE,FILTERS_CONDITIONS_NONE,FILTERS_CONDITIONS_NOT_BETWEEN,FILTERS_CONDITIONS_NOT_CONTAIN,FILTERS_CONDITIONS_NOT_EMPTY,FILTERS_CONDITIONS_NOT_EQUAL,FILTERS_CONDITIONS_TODAY,FILTERS_CONDITIONS_TOMORROW,FILTERS_CONDITIONS_YESTERDAY,FILTERS_DIVS_FILTER_BY_CONDITION,FILTERS_DIVS_FILTER_BY_VALUE,FILTERS_LABELS_CONJUNCTION,FILTERS_LABELS_DISJUNCTION,FILTERS_NAMESPACE,FILTERS_VALUES_BLANK_CELLS,LOADING_NAMESPACE,LOADING_TITLE,OK,PAGINATION_COUNTER_SECTION,PAGINATION_FIRST_PAGE,PAGINATION_LAST_PAGE,PAGINATION_NAMESPACE,PAGINATION_NAV_SECTION,PAGINATION_NEXT_PAGE,PAGINATION_PAGE_SIZE_AUTO,PAGINATION_PAGE_SIZE_SECTION,PAGINATION_PREV_PAGE,PAGINATION_SECTION},Symbol.toStringTag,{value:"Module"}));const dictionary={languageCode:"en-US",[OK]:"OK",[CANCEL]:"Cancel",[CONTEXTMENU_ITEMS_NO_ITEMS]:"No available options",[CONTEXTMENU_ITEMS_ROW_ABOVE]:"Insert row above",[CONTEXTMENU_ITEMS_ROW_BELOW]:"Insert row below",[CONTEXTMENU_ITEMS_INSERT_LEFT]:"Insert column left",[CONTEXTMENU_ITEMS_INSERT_RIGHT]:"Insert column right",[CONTEXTMENU_ITEMS_REMOVE_ROW]:["Remove row","Remove rows"],[CONTEXTMENU_ITEMS_REMOVE_COLUMN]:["Remove column","Remove columns"],[CONTEXTMENU_ITEMS_UNDO]:"Undo",[CONTEXTMENU_ITEMS_REDO]:"Redo",[CONTEXTMENU_ITEMS_READ_ONLY]:"Read only",[CONTEXTMENU_ITEMS_CLEAR_COLUMN]:"Clear column",[CONTEXTMENU_ITEMS_ALIGNMENT]:"Alignment",[CONTEXTMENU_ITEMS_ALIGNMENT_LEFT]:"Left",[CONTEXTMENU_ITEMS_ALIGNMENT_CENTER]:"Center",[CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT]:"Right",[CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY]:"Justify",[CONTEXTMENU_ITEMS_ALIGNMENT_TOP]:"Top",[CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE]:"Middle",[CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_FREEZE_COLUMN]:"Freeze column",[CONTEXTMENU_ITEMS_UNFREEZE_COLUMN]:"Unfreeze column",[CONTEXTMENU_ITEMS_BORDERS]:"Borders",[CONTEXTMENU_ITEMS_BORDERS_TOP]:"Top",[CONTEXTMENU_ITEMS_BORDERS_RIGHT]:"Right",[CONTEXTMENU_ITEMS_BORDERS_BOTTOM]:"Bottom",[CONTEXTMENU_ITEMS_BORDERS_LEFT]:"Left",[CONTEXTMENU_ITEMS_REMOVE_BORDERS]:"Remove border(s)",[CONTEXTMENU_ITEMS_ADD_COMMENT]:"Add comment",[CONTEXTMENU_ITEMS_EDIT_COMMENT]:"Edit comment",[CONTEXTMENU_ITEMS_REMOVE_COMMENT]:"Delete comment",[CONTEXTMENU_ITEMS_READ_ONLY_COMMENT]:"Read-only comment",[CONTEXTMENU_ITEMS_MERGE_CELLS]:"Merge cells",[CONTEXTMENU_ITEMS_UNMERGE_CELLS]:"Unmerge cells",[CONTEXTMENU_ITEMS_COPY]:"Copy",[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS]:["Copy with header","Copy with headers"],[CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS]:["Copy with group header","Copy with group headers"],[CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY]:["Copy header only","Copy headers only"],[CONTEXTMENU_ITEMS_CUT]:"Cut",[CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD]:"Insert child row",[CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD]:"Detach from parent",[CONTEXTMENU_ITEMS_HIDE_COLUMN]:["Hide column","Hide columns"],[CONTEXTMENU_ITEMS_SHOW_COLUMN]:["Show column","Show columns"],[CONTEXTMENU_ITEMS_HIDE_ROW]:["Hide row","Hide rows"],[CONTEXTMENU_ITEMS_SHOW_ROW]:["Show row","Show rows"],[FILTERS_CONDITIONS_NONE]:"None",[FILTERS_CONDITIONS_EMPTY]:"Is empty",[FILTERS_CONDITIONS_NOT_EMPTY]:"Is not empty",[FILTERS_CONDITIONS_EQUAL]:"Is equal to",[FILTERS_CONDITIONS_NOT_EQUAL]:"Is not equal to",[FILTERS_CONDITIONS_BEGINS_WITH]:"Begins with",[FILTERS_CONDITIONS_ENDS_WITH]:"Ends with",[FILTERS_CONDITIONS_CONTAINS]:"Contains",[FILTERS_CONDITIONS_NOT_CONTAIN]:"Does not contain",[FILTERS_CONDITIONS_GREATER_THAN]:"Greater than",[FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL]:"Greater than or equal to",[FILTERS_CONDITIONS_LESS_THAN]:"Less than",[FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL]:"Less than or equal to",[FILTERS_CONDITIONS_BETWEEN]:"Is between",[FILTERS_CONDITIONS_NOT_BETWEEN]:"Is not between",[FILTERS_CONDITIONS_AFTER]:"After",[FILTERS_CONDITIONS_BEFORE]:"Before",[FILTERS_CONDITIONS_TODAY]:"Today",[FILTERS_CONDITIONS_TOMORROW]:"Tomorrow",[FILTERS_CONDITIONS_YESTERDAY]:"Yesterday",[FILTERS_VALUES_BLANK_CELLS]:"Blank cells",[FILTERS_DIVS_FILTER_BY_CONDITION]:"Filter by condition",[FILTERS_DIVS_FILTER_BY_VALUE]:"Filter by value",[FILTERS_LABELS_CONJUNCTION]:"And",[FILTERS_LABELS_DISJUNCTION]:"Or",[FILTERS_BUTTONS_SELECT_ALL]:"Select all",[FILTERS_BUTTONS_CLEAR]:"Clear",[FILTERS_BUTTONS_OK]:"OK",[FILTERS_BUTTONS_CANCEL]:"Cancel",[FILTERS_BUTTONS_PLACEHOLDER_SEARCH]:"Search",[FILTERS_BUTTONS_PLACEHOLDER_VALUE]:"Value",[FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE]:"Second value",[PAGINATION_SECTION]:"Pagination",[PAGINATION_PAGE_SIZE_SECTION]:"Page size",[PAGINATION_PAGE_SIZE_AUTO]:"Auto",[PAGINATION_COUNTER_SECTION]:"[start] - [end] of [total]",[PAGINATION_NAV_SECTION]:"Page [currentPage] of [totalPages]",[PAGINATION_FIRST_PAGE]:"Go to first page",[PAGINATION_PREV_PAGE]:"Go to previous page",[PAGINATION_NEXT_PAGE]:"Go to next page",[PAGINATION_LAST_PAGE]:"Go to last page",[CHECKBOX_CHECKED]:"Checked",[CHECKBOX_UNCHECKED]:"Unchecked",[LOADING_TITLE]:"Loading...",[EMPTY_DATA_STATE_TITLE]:"No data available",[EMPTY_DATA_STATE_DESCRIPTION]:"There’s nothing to display yet.",[EMPTY_DATA_STATE_TITLE_FILTERS]:"No results found",[EMPTY_DATA_STATE_DESCRIPTION_FILTERS]:"It looks like your current filters are hiding all results.",[EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET]:"Reset filters"},dictionaryKeys=_dictionaryKeys,DEFAULT_LANGUAGE_CODE=dictionary.languageCode,{register:registerGloballyLanguageDictionary,getItem:getGlobalLanguageDictionary,hasItem:hasGlobalLanguageDictionary,getValues:getGlobalLanguagesDictionaries}=staticRegister("languagesDictionaries");registerLanguageDictionary(dictionary);function registerLanguageDictionary(a,s){let c=a,u=s;return isObject(a)&&(u=a,c=u.languageCode),extendLanguageDictionary(c,u),registerGloballyLanguageDictionary(c,deepClone(u)),deepClone(u)}function extendLanguageDictionary(a,s){a!==DEFAULT_LANGUAGE_CODE&&extendNotExistingKeys(s,getGlobalLanguageDictionary(DEFAULT_LANGUAGE_CODE))}function getLanguageDictionary(a){return hasLanguageDictionary(a)?deepClone(getGlobalLanguageDictionary(a)):null}function hasLanguageDictionary(a){return hasGlobalLanguageDictionary(a)}function getLanguagesDictionaries(){return getGlobalLanguagesDictionaries()}function getTranslatedPhrase(a,s,c){const u=getLanguageDictionary(a);if(u===null)return null;const d=u[s];if(isUndefined(d))return null;const h=getFormattedPhrase(d,c);return Array.isArray(h)?h[0]:h}function getFormattedPhrase(a,s){return getAll().reduce((c,u)=>u(c,s),a)}function getValidLanguageCode(a){let s=normalizeLanguageCode(a);return hasLanguageDictionary(s)||(s=DEFAULT_LANGUAGE_CODE,warnUserAboutLanguageRegistration(a)),s}function _defineProperty$1u(a,s,c){return(s=_toPropertyKey$1v(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1v(a){var s=_toPrimitive$1v(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1v(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class VisualSelection extends Selection$1{constructor(s,c){super(s,null),_defineProperty$1u(this,"visualCellRange",null),this.visualCellRange=c||null,this.commit()}add(s){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(s):this.visualCellRange.expand(s),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(s){let{from:c,to:u}=s,d=this.getNearestNotHiddenCoords(c,1),h=this.getNearestNotHiddenCoords(u,-1);return d===null||h===null?null:((d.row>h.row||d.col>h.col)&&(d=c,h=u),this.settings.createCellRange(d,d,h))}getNearestNotHiddenCoords(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:c;const d=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,s.row,c);if(d===null)return null;const h=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,s.col,u);return h===null?null:this.settings.createCellCoords(d,h)}getNearestNotHiddenIndex(s,c,u){return c<0?c:s.getNearestNotHiddenIndex(c,u)}commit(){if(this.visualCellRange===null)return this;const s=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return s===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(s.from,s.to),this}syncWith(s){const c=s.from.clone().normalize(),u=s.getVerticalDirection()==="N-S"?1:-1,d=s.getHorizontalDirection()==="W-E"?1:-1,h=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let f=null;if((h===null||h.col===null||h.row===null)&&(f=this.getNearestNotHiddenCoords(c,u,d)),f!==null&&s.overlaps(f)){const g=s.highlight.clone();if(g.row>=0&&(g.row=f.row),g.col>=0&&(g.col=f.col),this.cellRange===null){const m=this.settings.visualToRenderableCoords(g);this.cellRange=this.settings.createCellRange(m)}s.setHighlight(g)}return this.settings.selectionType==="focus"&&h!==null&&f===null&&s.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:s,to:c}=this.cellRange;return[Math.min(s.row,c.row),Math.min(s.col,c.col),Math.max(s.row,c.row),Math.max(s.col,c.col)]}getVisualCorners(){const s=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),c=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[s.row,s.col,c.row,c.col]}createRenderableCellRange(s,c){const u=this.settings.visualToRenderableCoords(s),d=this.settings.visualToRenderableCoords(c);return u.row===null||u.col===null||d.row===null||d.col===null?null:this.settings.createCellRange(u,u,d)}}function createHighlight$8(a){let{activeHeaderClassName:s,...c}=a;return new VisualSelection({className:s,...c,selectionType:ACTIVE_HEADER_TYPE})}function createHighlight$7(a){let{areaCornerVisible:s,...c}=a;return new VisualSelection({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:s},...c,selectionType:AREA_TYPE})}function createHighlight$6(a){let{...s}=a;return new VisualSelection({className:"highlight",...s,selectionType:AREA_TYPE})}function createHighlight$5(a){let{columnClassName:s,...c}=a;return new VisualSelection({className:s,...c,selectionType:COLUMN_TYPE})}function createHighlight$4(a){let{cellCornerVisible:s,...c}=a;return new VisualSelection({className:"current",headerAttributes:[A11Y_SELECTED()],border:{width:2,color:"#4b89ff",cornerVisible:s},...c,selectionType:FOCUS_TYPE})}function createHighlight$3(a){let{border:s,visualCellRange:c,...u}=a;return new VisualSelection({...s,...u,selectionType:CUSTOM_SELECTION_TYPE},c)}function createHighlight$2(a){let{...s}=a;return new VisualSelection({className:"fill",border:{width:1,color:"#ff0000"},...s,selectionType:FILL_TYPE})}function createHighlight$1(a){let{headerClassName:s,...c}=a;return new VisualSelection({className:s,...c,selectionType:HEADER_TYPE})}function createHighlight(a){let{rowClassName:s,...c}=a;return new VisualSelection({className:s,...c,selectionType:ROW_TYPE})}function _classPrivateMethodInitSpec$V(a,s){_checkPrivateRedeclaration$19(a,s),s.add(a)}function _checkPrivateRedeclaration$19(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1t(a,s,c){return(s=_toPropertyKey$1u(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1u(a){var s=_toPrimitive$1u(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1u(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$19(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _Highlight_brand=new WeakSet;class Highlight{constructor(s){_classPrivateMethodInitSpec$V(this,_Highlight_brand),_defineProperty$1t(this,"options",void 0),_defineProperty$1t(this,"layerLevel",0),_defineProperty$1t(this,"focus",void 0),_defineProperty$1t(this,"fill",void 0),_defineProperty$1t(this,"layeredAreas",new Map),_defineProperty$1t(this,"areas",new Map),_defineProperty$1t(this,"rowHeaders",new Map),_defineProperty$1t(this,"columnHeaders",new Map),_defineProperty$1t(this,"activeRowHeaders",new Map),_defineProperty$1t(this,"activeColumnHeaders",new Map),_defineProperty$1t(this,"activeCornerHeaders",new Map),_defineProperty$1t(this,"rowHighlights",new Map),_defineProperty$1t(this,"columnHighlights",new Map),_defineProperty$1t(this,"customSelections",[]),this.options=s,this.focus=createHighlight$4(s),this.fill=createHighlight$2(s)}isEnabledFor(s,c){let u=s;s===FOCUS_TYPE&&(u="current");let d=this.options.disabledCellSelection(c.row,c.col);return typeof d=="string"&&(d=[d]),d===!1||Array.isArray(d)&&!d.includes(u)}useLayerLevel(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=s,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.layeredAreas,createHighlight$7)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.areas,createHighlight$6)}getAreas(){return[...this.areas.values()]}createRowHeader(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.rowHeaders,createHighlight$1)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.columnHeaders,createHighlight$1)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.activeRowHeaders,createHighlight$8)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.activeColumnHeaders,createHighlight$8)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.activeCornerHeaders,createHighlight$8)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.rowHighlights,createHighlight)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return _assertClassBrand$19(_Highlight_brand,this,_createHighlight).call(this,this.columnHighlights,createHighlight$5)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(s){this.customSelections.push(createHighlight$3({...this.options,...s}))}clear(){this.focus.clear(),this.fill.clear(),arrayEach(this.areas.values(),s=>void s.clear()),arrayEach(this.layeredAreas.values(),s=>void s.clear()),arrayEach(this.rowHeaders.values(),s=>void s.clear()),arrayEach(this.columnHeaders.values(),s=>void s.clear()),arrayEach(this.activeRowHeaders.values(),s=>void s.clear()),arrayEach(this.activeColumnHeaders.values(),s=>void s.clear()),arrayEach(this.activeCornerHeaders.values(),s=>void s.clear()),arrayEach(this.rowHighlights.values(),s=>void s.clear()),arrayEach(this.columnHighlights.values(),s=>void s.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function _createHighlight(a,s){const c=this.layerLevel;if(a.has(c))return a.get(c);const u=s({layerLevel:c,...this.options});return a.set(c,u),u}function _defineProperty$1s(a,s,c){return(s=_toPropertyKey$1t(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1t(a){var s=_toPrimitive$1t(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1t(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class SelectionRange{constructor(s){_defineProperty$1s(this,"ranges",[]),_defineProperty$1s(this,"createCellRange",void 0),this.createCellRange=s}isEmpty(){return this.size()===0}set(s){return this.clear(),this.ranges.push(this.createCellRange(s)),this}add(s){return this.ranges.push(this.createCellRange(s)),this}push(s){return this.ranges.push(s),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((u,d)=>u.includes(s)&&c(u,d))}findAll(s){const c=[];return this.ranges.forEach((u,d)=>{u.isEqual(s)&&c.push({range:u,layer:d})}),c}remove(s){return this.ranges=this.ranges.filter(c=>!s.some(u=>u.isEqual(c))),this}removeLayers(s){return this.ranges=this.ranges.filter((c,u)=>!s.includes(u)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const s=new SelectionRange(this.createCellRange);return s.ranges=this.ranges.map(c=>c.clone()),s}map(s){return this.ranges=this.ranges.map((c,u)=>s(c,u)),this}peekByIndex(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,c;return s>=0&&s<this.size()&&(c=this.ranges[s]),c}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function _classPrivateMethodInitSpec$U(a,s){_checkPrivateRedeclaration$18(a,s),s.add(a)}function _defineProperty$1r(a,s,c){return(s=_toPropertyKey$1s(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1s(a){var s=_toPrimitive$1s(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1s(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldInitSpec$R(a,s,c){_checkPrivateRedeclaration$18(a,s),s.set(a,c)}function _checkPrivateRedeclaration$18(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$R(a,s){return a.get(_assertClassBrand$18(a,s))}function _classPrivateFieldSet$O(a,s,c){return a.set(_assertClassBrand$18(a,s),c),c}function _assertClassBrand$18(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _range=new WeakMap,_activeLayerIndex=new WeakMap,_offset$1=new WeakMap,_BaseTransformation_brand=new WeakSet;class BaseTransformation{constructor(s,c){_classPrivateMethodInitSpec$U(this,_BaseTransformation_brand),_classPrivateFieldInitSpec$R(this,_range,void 0),_classPrivateFieldInitSpec$R(this,_activeLayerIndex,0),_classPrivateFieldInitSpec$R(this,_offset$1,{x:0,y:0}),_defineProperty$1r(this,"tableApi",void 0),_classPrivateFieldSet$O(_range,this,s),this.tableApi=c}setActiveLayerIndex(s){_classPrivateFieldSet$O(_activeLayerIndex,this,s)}getCurrentSelection(){return _classPrivateFieldGet$R(_range,this).peekByIndex(_classPrivateFieldGet$R(_activeLayerIndex,this))}transformStart(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;_classPrivateFieldSet$O(_offset$1,this,this.calculateOffset());const d=this.tableApi.createCellCoords(s,c);let h=this.getCurrentSelection().highlight;const f=this.tableApi.visualToRenderableCoords(h);let g=0,m=0;if(this.runLocalHooks("beforeTransformStart",d),f.row!==null&&f.col!==null){let{width:p,height:v}=_assertClassBrand$18(_BaseTransformation_brand,this,_getTableSize).call(this);const{row:w,col:E}=_assertClassBrand$18(_BaseTransformation_brand,this,_visualToZeroBasedCoords).call(this,h),C=this.tableApi.fixedRowsBottom(),b=this.tableApi.minSpareRows(),P=this.tableApi.minSpareCols(),R=this.tableApi.autoWrapRow(),T=this.tableApi.autoWrapCol(),I=this.tableApi.createCellCoords(w+d.row,E+d.col);if(I.row>=v){const H=createObjectPropListener(u&&b>0&&C===0),L=I.col+1,A=L>=p,k=this.tableApi.createCellCoords(I.row-v,A?L-p:L);if(this.runLocalHooks("beforeColumnWrap",H,_assertClassBrand$18(_BaseTransformation_brand,this,_zeroBasedToVisualCoords).call(this,k),A),H.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(T){if(this.shouldSwitchSelectionLayer()&&A&&_classPrivateFieldGet$R(_range,this).size()>1){_assertClassBrand$18(_BaseTransformation_brand,this,_chooseNextSelectionLayer).call(this);const W=_assertClassBrand$18(_BaseTransformation_brand,this,_findNonHiddenZeroBasedCoordsInSelection).call(this,"forward");W!==null&&k.assign(W)}I.assign(k)}}else if(I.row<0){const H=createObjectPropListener(T),L=I.col-1,A=L<0,k=this.tableApi.createCellCoords(v+I.row,A?p+L:L);if(this.runLocalHooks("beforeColumnWrap",H,_assertClassBrand$18(_BaseTransformation_brand,this,_zeroBasedToVisualCoords).call(this,k),A),T){if(this.shouldSwitchSelectionLayer()&&A&&_classPrivateFieldGet$R(_range,this).size()>1){_assertClassBrand$18(_BaseTransformation_brand,this,_choosePreviousSelectionLayer).call(this);const W=_assertClassBrand$18(_BaseTransformation_brand,this,_findNonHiddenZeroBasedCoordsInSelection).call(this,"backward");W!==null&&k.assign(W)}I.assign(k)}}if({width:p,height:v}=_assertClassBrand$18(_BaseTransformation_brand,this,_getTableSize).call(this),I.col>=p){const H=createObjectPropListener(u&&P>0),L=I.row+1,A=L>=v,k=this.tableApi.createCellCoords(A?L-v:L,I.col-p);if(this.runLocalHooks("beforeRowWrap",H,_assertClassBrand$18(_BaseTransformation_brand,this,_zeroBasedToVisualCoords).call(this,k),A),H.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(R){if(this.shouldSwitchSelectionLayer()&&A&&_classPrivateFieldGet$R(_range,this).size()>1){_assertClassBrand$18(_BaseTransformation_brand,this,_chooseNextSelectionLayer).call(this);const W=_assertClassBrand$18(_BaseTransformation_brand,this,_findNonHiddenZeroBasedCoordsInSelection).call(this,"forward");W!==null&&k.assign(W)}I.assign(k)}}else if(I.col<0){const H=createObjectPropListener(R),L=I.row-1,A=L<0,k=this.tableApi.createCellCoords(A?v+L:L,p+I.col);if(this.runLocalHooks("beforeRowWrap",H,_assertClassBrand$18(_BaseTransformation_brand,this,_zeroBasedToVisualCoords).call(this,k),A),R){if(this.shouldSwitchSelectionLayer()&&A&&_classPrivateFieldGet$R(_range,this).size()>1){_assertClassBrand$18(_BaseTransformation_brand,this,_choosePreviousSelectionLayer).call(this);const W=_assertClassBrand$18(_BaseTransformation_brand,this,_findNonHiddenZeroBasedCoordsInSelection).call(this,"backward");W!==null&&k.assign(W)}I.assign(k)}}const{rowDir:M,colDir:N}=_assertClassBrand$18(_BaseTransformation_brand,this,_clampCoords).call(this,I);g=M,m=N,h=_assertClassBrand$18(_BaseTransformation_brand,this,_zeroBasedToVisualCoords).call(this,I)}return this.runLocalHooks("afterTransformStart",h,g,m),{selectionLayer:_classPrivateFieldGet$R(_activeLayerIndex,this),visualCoords:h}}transformEnd(s,c){_classPrivateFieldSet$O(_offset$1,this,this.calculateOffset());const u=this.tableApi.createCellCoords(s,c),d=this.getCurrentSelection(),h=this.tableApi.visualToRenderableCoords(d.highlight),f=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,d.to.row,d.from.row),g=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,d.to.col,d.from.col),m=d.to.clone();let p=0,v=0;if(this.runLocalHooks("beforeTransformEnd",u),h.row!==null&&h.col!==null&&f!==null&&g!==null){const{row:w,col:E}=_assertClassBrand$18(_BaseTransformation_brand,this,_visualToZeroBasedCoords).call(this,d.highlight),C=this.tableApi.createCellCoords(f+u.row,g+u.col),b=d.getTopStartCorner(),P=d.getTopEndCorner(),R=d.getBottomEndCorner();if(u.col<0&&g>=E&&C.col<E){const N=C.col-E;C.col=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,b.col,P.col)+N}else if(u.col>0&&g<=E&&C.col>E){const N=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,P.col,b.col),H=Math.max(C.col-N,1);C.col=N+H}if(u.row<0&&f>=w&&C.row<w){const N=C.row-w;C.row=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,b.row,R.row)+N}else if(u.row>0&&f<=w&&C.row>w){const N=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,R.row,b.row),H=Math.max(C.row-N,1);C.row=N+H}const{rowDir:T,colDir:I}=_assertClassBrand$18(_BaseTransformation_brand,this,_clampCoords).call(this,C);p=T,v=I;const M=_assertClassBrand$18(_BaseTransformation_brand,this,_zeroBasedToVisualCoords).call(this,C);u.row===0&&u.col!==0?m.col=M.col:u.row!==0&&u.col===0?m.row=M.row:(m.row=M.row,m.col=M.col)}return this.runLocalHooks("afterTransformEnd",m,p,v),{selectionLayer:_classPrivateFieldGet$R(_activeLayerIndex,this),visualCoords:m}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function _chooseNextSelectionLayer(){const a=_classPrivateFieldGet$R(_activeLayerIndex,this)+1;this.setActiveLayerIndex(a>=_classPrivateFieldGet$R(_range,this).size()?0:a),_classPrivateFieldSet$O(_offset$1,this,this.calculateOffset())}function _choosePreviousSelectionLayer(){const a=_classPrivateFieldGet$R(_activeLayerIndex,this)-1;this.setActiveLayerIndex(a<0?_classPrivateFieldGet$R(_range,this).size()-1:a),_classPrivateFieldSet$O(_offset$1,this,this.calculateOffset())}function _clampCoords(a){const{width:s,height:c}=_assertClassBrand$18(_BaseTransformation_brand,this,_getTableSize).call(this);let u=0,d=0;return a.row<0?(u=-1,a.row=0):a.row>0&&a.row>=c&&(u=1,a.row=c-1),a.col<0?(d=-1,a.col=0):a.col>0&&a.col>=s&&(d=1,a.col=s-1),{rowDir:u,colDir:d}}function _getTableSize(){return{width:_classPrivateFieldGet$R(_offset$1,this).x+this.countRenderableColumns(),height:_classPrivateFieldGet$R(_offset$1,this).y+this.countRenderableRows()}}function _findNonHiddenZeroBasedCoordsInSelection(a){if(!["forward","backward"].includes(a))return null;const s=this.getCurrentSelection().getTopStartCorner(),c=this.getCurrentSelection().getBottomEndCorner(),[u,d,h,f]=a==="forward"?[s.row,c.row,s.col,c.col]:[c.row,s.row,c.col,s.col],g=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedRow).call(this,u,d),m=_assertClassBrand$18(_BaseTransformation_brand,this,_findFirstNonHiddenZeroBasedColumn).call(this,h,f);return g===null||m===null?null:this.tableApi.createCellCoords(g,m)}function _findFirstNonHiddenZeroBasedRow(a,s){const c=this.tableApi.findFirstNonHiddenRenderableRow(a,s);return c===null?null:_classPrivateFieldGet$R(_offset$1,this).y+c}function _findFirstNonHiddenZeroBasedColumn(a,s){const c=this.tableApi.findFirstNonHiddenRenderableColumn(a,s);return c===null?null:_classPrivateFieldGet$R(_offset$1,this).x+c}function _visualToZeroBasedCoords(a){const{row:s,col:c}=this.tableApi.visualToRenderableCoords(a);if(s===null||c===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(_classPrivateFieldGet$R(_offset$1,this).y+s,_classPrivateFieldGet$R(_offset$1,this).x+c)}function _zeroBasedToVisualCoords(a){const s=a.clone();return s.col=a.col-_classPrivateFieldGet$R(_offset$1,this).x,s.row=a.row-_classPrivateFieldGet$R(_offset$1,this).y,this.tableApi.renderableToVisualCoords(s)}mixin(BaseTransformation,localHooks);class ExtenderTransformation extends BaseTransformation{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class FocusTransformation extends BaseTransformation{calculateOffset(){const s=this.getCurrentSelection(),{row:c,col:u}=s.getOuterTopStartCorner(),d=this.tableApi.countRenderableColumnsInRange(0,u-1),h=this.tableApi.countRenderableRowsInRange(0,c-1),f=s.highlight.isHeader(),g=f?Math.abs(u):0,m=f?Math.abs(c):0;return{x:u<0?g:-d,y:c<0?m:-h}}countRenderableRows(){const s=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,s.getOuterBottomEndCorner().row)}countRenderableColumns(){const s=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,s.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const SELECTION_TYPE_UNRECOGNIZED=0,SELECTION_TYPE_EMPTY=1,SELECTION_TYPE_ARRAY=2,SELECTION_TYPE_OBJECT=3,SELECTION_TYPES=[SELECTION_TYPE_OBJECT,SELECTION_TYPE_ARRAY],ARRAY_TYPE_PATTERN=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],rootCall=Symbol("root"),childCall=Symbol("child");function detectSelectionType(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rootCall;if(s!==rootCall&&s!==childCall)throw new Error("The second argument is used internally only and cannot be overwritten.");const c=Array.isArray(a),u=s===rootCall;let d=SELECTION_TYPE_UNRECOGNIZED;if(c){const h=a[0];a.length===0?d=SELECTION_TYPE_EMPTY:u&&h instanceof CellRange?d=SELECTION_TYPE_OBJECT:u&&Array.isArray(h)?d=detectSelectionType(h,childCall):a.length>=2&&a.length<=4&&!a.some((g,m)=>!ARRAY_TYPE_PATTERN[m].includes(typeof g))&&(d=SELECTION_TYPE_ARRAY)}return d}function normalizeSelectionFactory(a){let{createCellCoords:s,createCellRange:c,keepDirection:u=!1,propToCol:d}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!SELECTION_TYPES.includes(a))throw new Error("Unsupported selection ranges schema type was provided.");return function(h){const f=a===SELECTION_TYPE_OBJECT;let g=f?h.from.row:h[0],m=f?h.from.col:h[1],p=f?h.to.row:h[2],v=f?h.to.col:h[3];if(typeof d=="function"&&(typeof m=="string"&&(m=d(m)),typeof v=="string"&&(v=d(v))),isUndefined(p)&&(p=g),isUndefined(v)&&(v=m),!u){const b=g,P=m,R=p,T=v;g=Math.min(b,R),m=Math.min(P,T),p=Math.max(b,R),v=Math.max(P,T)}const w=f?h.highlight.clone():s(g,m),E=s(g,m),C=s(p,v);return c(w,E,C)}}function transformSelectionToColumnDistance(a){const s=detectSelectionType(a.getSelected());if(s===SELECTION_TYPE_UNRECOGNIZED||s===SELECTION_TYPE_EMPTY)return[];const c=normalizeSelectionFactory(s,{createCellCoords:a._createCellCoords.bind(a),createCellRange:a._createCellRange.bind(a)}),u=new Set;arrayEach(a.getSelected(),f=>{const{from:g,to:m}=c(f),p=Math.max(g.col,0),v=m.col-p+1;arrayEach(Array.from(new Array(v),(w,E)=>p+E),w=>{u.has(w)||u.add(w)})});const d=Array.from(u).sort((f,g)=>f-g);return arrayReduce(d,(f,g,m,p)=>(m!==0&&g===p[m-1]+1?f[f.length-1][1]+=1:f.push([g,1]),f),[])}function transformSelectionToRowDistance(a){const s=detectSelectionType(a.getSelected());if(s===SELECTION_TYPE_UNRECOGNIZED||s===SELECTION_TYPE_EMPTY)return[];const c=normalizeSelectionFactory(s,{createCellCoords:a._createCellCoords.bind(a),createCellRange:a._createCellRange.bind(a)}),u=new Set;arrayEach(a.getSelected(),f=>{const{from:g,to:m}=c(f),p=Math.max(g.row,0),v=m.row-p+1;arrayEach(Array.from(new Array(v),(w,E)=>p+E),w=>{u.has(w)||u.add(w)})});const d=Array.from(u).sort((f,g)=>f-g);return arrayReduce(d,(f,g,m,p)=>(m!==0&&g===p[m-1]+1?f[f.length-1][1]+=1:f.push([g,1]),f),[])}function _classPrivateFieldInitSpec$Q(a,s,c){_checkPrivateRedeclaration$17(a,s),s.set(a,c)}function _checkPrivateRedeclaration$17(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1q(a,s,c){return(s=_toPropertyKey$1r(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1r(a){var s=_toPrimitive$1r(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1r(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$Q(a,s){return a.get(_assertClassBrand$17(a,s))}function _classPrivateFieldSet$N(a,s,c){return a.set(_assertClassBrand$17(a,s),c),c}function _assertClassBrand$17(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _extenderTransformation=new WeakMap,_focusTransformation=new WeakMap,_isFocusSelectionChanged=new WeakMap,_disableHeadersHighlight=new WeakMap,_selectionSource=new WeakMap,_expectedLayersCount=new WeakMap,_activeSelectionLayer=new WeakMap;class Selection{constructor(s,c){var u=this;_defineProperty$1q(this,"settings",void 0),_defineProperty$1q(this,"tableProps",void 0),_defineProperty$1q(this,"inProgress",!1),_defineProperty$1q(this,"selectedRange",new SelectionRange((d,h,f)=>this.tableProps.createCellRange(d,h,f))),_defineProperty$1q(this,"highlight",void 0),_classPrivateFieldInitSpec$Q(this,_extenderTransformation,void 0),_classPrivateFieldInitSpec$Q(this,_focusTransformation,void 0),_defineProperty$1q(this,"selectedByRowHeader",new Set),_defineProperty$1q(this,"selectedByColumnHeader",new Set),_classPrivateFieldInitSpec$Q(this,_isFocusSelectionChanged,!1),_classPrivateFieldInitSpec$Q(this,_disableHeadersHighlight,!1),_classPrivateFieldInitSpec$Q(this,_selectionSource,"unknown"),_classPrivateFieldInitSpec$Q(this,_expectedLayersCount,-1),_classPrivateFieldInitSpec$Q(this,_activeSelectionLayer,0),this.settings=s,this.tableProps=c,this.highlight=new Highlight({headerClassName:s.currentHeaderClassName,activeHeaderClassName:s.activeHeaderClassName,rowClassName:s.currentRowClassName,columnClassName:s.currentColClassName,cellAttributes:[A11Y_SELECTED()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(d,h)=>this.tableProps.isDisabledCellSelection(d,h),cellCornerVisible:function(){return u.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return u.isAreaCornerVisible(...arguments)},visualToRenderableCoords:d=>this.tableProps.visualToRenderableCoords(d),renderableToVisualCoords:d=>this.tableProps.renderableToVisualCoords(d),createCellCoords:(d,h)=>this.tableProps.createCellCoords(d,h),createCellRange:(d,h,f)=>this.tableProps.createCellRange(d,h,f)}),_classPrivateFieldSet$N(_extenderTransformation,this,new ExtenderTransformation(this.selectedRange,{...this.tableProps,navigableHeaders:()=>s.navigableHeaders,fixedRowsBottom:()=>s.fixedRowsBottom,minSpareRows:()=>s.minSpareRows,minSpareCols:()=>s.minSpareCols,autoWrapRow:()=>s.autoWrapRow,autoWrapCol:()=>s.autoWrapCol})),_classPrivateFieldSet$N(_focusTransformation,this,new FocusTransformation(this.selectedRange,{...this.tableProps,navigableHeaders:()=>s.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("beforeTransformStart",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("beforeModifyTransformStart",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("afterTransformStart",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("afterModifyTransformStart",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("beforeTransformEnd",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("beforeModifyTransformEnd",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("afterTransformEnd",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("afterModifyTransformEnd",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("insertRowRequire",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("insertRowRequire",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("insertColRequire",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("insertColRequire",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("beforeRowWrap",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("beforeRowWrap",...h)}),_classPrivateFieldGet$Q(_extenderTransformation,this).addLocalHook("beforeColumnWrap",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("beforeColumnWrap",...h)}),_classPrivateFieldGet$Q(_focusTransformation,this).addLocalHook("beforeTransformStart",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("beforeModifyTransformFocus",...h)}),_classPrivateFieldGet$Q(_focusTransformation,this).addLocalHook("afterTransformStart",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.runLocalHooks("afterModifyTransformFocus",...h)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(_classPrivateFieldGet$Q(_activeSelectionLayer,this))}getActiveSelectionLayerIndex(){return _classPrivateFieldGet$Q(_activeSelectionLayer,this)}setActiveSelectionLayerIndex(s){_classPrivateFieldSet$N(_activeSelectionLayer,this,s)}markSource(s){_classPrivateFieldSet$N(_selectionSource,this,s)}markEndSource(){_classPrivateFieldSet$N(_selectionSource,this,"unknown")}getSelectionSource(){return _classPrivateFieldGet$Q(_selectionSource,this)}setExpectedLayers(s){_classPrivateFieldSet$N(_expectedLayersCount,this,s)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,_classPrivateFieldSet$N(_expectedLayersCount,this,-1)}isInProgress(){return this.inProgress}setRangeStart(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;const h=this.settings.selectionMode==="multiple",f=isUndefined(c)?this.tableProps.getShortcutManager().isCtrlPressed():c,g=s.clone();_classPrivateFieldSet$N(_disableHeadersHighlight,this,!1),_classPrivateFieldSet$N(_isFocusSelectionChanged,this,!1),this.runLocalHooks(`beforeSetRangeStart${u?"Only":""}`,g),(!h||h&&!f&&isUndefined(c))&&(this.selectedRange.clear(),arrayEach(this.highlight.getAreas(),m=>void m.clear()),arrayEach(this.highlight.getLayeredAreas(),m=>void m.clear()),arrayEach(this.highlight.getRowHeaders(),m=>void m.clear()),arrayEach(this.highlight.getColumnHeaders(),m=>void m.clear()),arrayEach(this.highlight.getActiveRowHeaders(),m=>void m.clear()),arrayEach(this.highlight.getActiveColumnHeaders(),m=>void m.clear()),arrayEach(this.highlight.getActiveCornerHeaders(),m=>void m.clear()),arrayEach(this.highlight.getRowHighlights(),m=>void m.clear()),arrayEach(this.highlight.getColumnHighlights(),m=>void m.clear())),this.selectedRange.add(g).current().setHighlight(d.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),u||this.setRangeEnd(s)}setRangeStartOnly(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s;this.setRangeStart(s,c,!0,u)}setRangeEnd(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(c);const u=s.clone(),d=this.tableProps.countRows(),h=this.tableProps.countCols(),f=this.getActiveSelectedRange().clone().setTo(s).isSingleHeader();if((d>0||h>0)&&(d===0&&u.col<0&&!f||h===0&&u.row<0&&!f))return;this.runLocalHooks("beforeSetRangeEnd",u),this.begin();const g=this.getActiveSelectedRange();if(this.settings.navigableHeaders||g.highlight.normalize(),this.settings.selectionMode==="single")g.setFrom(g.highlight),g.setTo(g.highlight);else{const p=g.getHorizontalDirection(),v=g.getVerticalDirection(),w=this.isMultiple();g.setTo(u),w&&(p!==g.getHorizontalDirection()||g.getWidth()===1&&!g.includes(g.highlight))&&g.from.assign({col:g.highlight.col}),w&&(v!==g.getVerticalDirection()||g.getHeight()===1&&!g.includes(g.highlight))&&g.from.assign({row:g.highlight.row})}d>0&&h>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!g.isSingleHeader())&&g.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,c),this.applyAndCommit(this.getActiveSelectedRange(),c);const m=_classPrivateFieldGet$Q(_expectedLayersCount,this)===-1||this.selectedRange.size()===_classPrivateFieldGet$Q(_expectedLayersCount,this);this.runLocalHooks("afterSetRangeEnd",s,m)}applyAndCommit(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const u=this.tableProps.countRows(),d=this.tableProps.countCols();this.highlight.useLayerLevel(c);const h=this.highlight.createArea(),f=this.highlight.createLayeredArea(),g=this.highlight.createRowHeader(),m=this.highlight.createColumnHeader(),p=this.highlight.createActiveRowHeader(),v=this.highlight.createActiveColumnHeader(),w=this.highlight.createActiveCornerHeader(),E=this.highlight.createRowHighlight(),C=this.highlight.createColumnHighlight();if(h.clear(),f.clear(),g.clear(),m.clear(),p.clear(),v.clear(),w.clear(),E.clear(),C.clear(),this.highlight.isEnabledFor(AREA_TYPE,s.highlight)&&(this.isMultiple()||c>=1)&&(h.add(s.from).add(s.to).commit(),f.add(s.from).add(s.to).commit(),c===1)){const b=this.selectedRange.peekByIndex(c-1);this.highlight.useLayerLevel(c-1),this.highlight.createArea().add(b.from).commit().syncWith(b),this.highlight.createLayeredArea().add(b.from).commit().syncWith(b),this.highlight.useLayerLevel(c)}if(this.highlight.isEnabledFor(HEADER_TYPE,s.highlight)){if(!s.isSingleHeader()){const R=this.tableProps.createCellCoords(Math.max(s.from.row,0),-1),T=this.tableProps.createCellCoords(s.to.row,-1),I=this.tableProps.createCellCoords(-1,Math.max(s.from.col,0)),M=this.tableProps.createCellCoords(-1,s.to.col);this.settings.selectionMode==="single"?(g.add(R).commit(),m.add(I).commit(),E.add(R).commit(),C.add(I).commit()):(g.add(R).add(T).commit(),m.add(I).add(M).commit(),E.add(R).add(T).commit(),C.add(I).add(M).commit())}const b=!_classPrivateFieldGet$Q(_disableHeadersHighlight,this)&&this.isEntireRowSelected()&&(d>0&&d===s.getWidth()||d===0&&this.isSelectedByRowHeader()),P=!_classPrivateFieldGet$Q(_disableHeadersHighlight,this)&&this.isEntireColumnSelected()&&(u>0&&u===s.getHeight()||u===0&&this.isSelectedByColumnHeader());b&&p.add(this.tableProps.createCellCoords(Math.max(s.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(s.to.row,0),-1)).commit(),P&&v.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(s.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(s.to.col,0))).commit(),b&&P&&w.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(c),_classPrivateFieldGet$Q(_extenderTransformation,this).setActiveLayerIndex(c),_classPrivateFieldGet$Q(_focusTransformation,this).setActiveLayerIndex(c);const u=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",s);const d=this.highlight.getFocus();d.clear(),u.setHighlight(s),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(FOCUS_TYPE,u.highlight)&&d.add(u.highlight).commit().syncWith(u),this.inProgress||(_classPrivateFieldSet$N(_isFocusSelectionChanged,this,!0),this.runLocalHooks("afterSetFocus",u.highlight))}transformStart(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:d}=_classPrivateFieldGet$Q(_extenderTransformation,this).transformStart(s,c,u);this.setRangeStart(d)}transformEnd(s,c){const{visualCoords:u,selectionLayer:d}=_classPrivateFieldGet$Q(_extenderTransformation,this).transformEnd(s,c);this.setRangeEnd(u,d)}transformFocus(s,c){const{selectionLayer:u,visualCoords:d}=_classPrivateFieldGet$Q(_focusTransformation,this).transformStart(s,c);this.setRangeFocus(d.normalize(),u)}shiftRows(s,c){if(!this.isSelected())return;const u=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||u.getOuterTopStartCorner().row>=s){const{from:d,to:h,highlight:f}=u,g=this.tableProps.countRows(),m=this.isSelectedByRowHeader(),p=this.isSelectedByColumnHeader(),v=p?-1:0,w=p?0:c;this.getSelectedRange().pop();const E=this.tableProps.createCellCoords(clamp(d.row+w,v,g-1),d.col),C=this.tableProps.createCellCoords(clamp(h.row+c,v,g-1),h.col);this.markSource("shift"),f.row>=s?this.setRangeStartOnly(E,!0,this.tableProps.createCellCoords(clamp(f.row+c,0,g-1),f.col)):this.setRangeStartOnly(E,!0),m&&this.selectedByRowHeader.add(this.getLayerLevel()),p&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.markEndSource()}}shiftColumns(s,c){if(!this.isSelected())return;const u=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||u.getOuterTopStartCorner().col>=s){const{from:d,to:h,highlight:f}=u,g=this.tableProps.countCols(),m=this.isSelectedByRowHeader(),p=this.isSelectedByColumnHeader(),v=m?-1:0,w=m?0:c;this.getSelectedRange().pop();const E=this.tableProps.createCellCoords(d.row,clamp(d.col+w,v,g-1)),C=this.tableProps.createCellCoords(h.row,clamp(h.col+c,v,g-1));this.markSource("shift"),f.col>=s?this.setRangeStartOnly(E,!0,this.tableProps.createCellCoords(f.row,clamp(f.col+c,0,g-1))):this.setRangeStartOnly(E,!0),m&&this.selectedByRowHeader.add(this.getLayerLevel()),p&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const c=createObjectPropListener(!s.isSingle());return this.runLocalHooks("afterIsMultipleSelection",c),c.value}isFocusSelectionChanged(){return this.isSelected()&&_classPrivateFieldGet$Q(_isFocusSelectionChanged,this)}isSelectedByRowHeader(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(s)&&(s===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(s))}isEntireRowSelected(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const c=d=>{const{col:h}=d.getOuterTopStartCorner(),f=this.tableProps.countRowHeaders(),g=this.tableProps.countCols();return(f>0&&h<0||f===0)&&d.getWidth()===g};if(s===-1)return Array.from(this.selectedRange).some(d=>c(d));const u=this.selectedRange.peekByIndex(s);return u?c(u):!1}isSelectedByColumnHeader(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(s===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(s))}isEntireColumnSelected(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const c=d=>{const{row:h}=d.getOuterTopStartCorner(),f=this.tableProps.countColHeaders(),g=this.tableProps.countRows();return(f>0&&h<0||f===0)&&d.getHeight()===g};if(s===-1)return Array.from(this.selectedRange).some(d=>c(d));const u=this.selectedRange.peekByIndex(s);return u?c(u):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(s){return this.selectedRange.includes(s)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(s){const c=this.tableProps.visualToRenderableCoords(s);return c.row!==null&&c.col!==null}isAreaCornerVisible(s){return Number.isInteger(s)&&s!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var s;let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const h=this.tableProps.countRows(),f=this.tableProps.countCols(),g=this.tableProps.countRowHeaders(),m=this.tableProps.countColHeaders(),p=u?-m:0,v=c?-g:0;if(p===0&&v===0&&(h===0||f===0))return;let w=(s=this.getActiveSelectedRange())===null||s===void 0?void 0:s.highlight;const{focusPosition:E,disableHeadersHighlight:C}=d;E&&Number.isInteger(E?.row)&&Number.isInteger(E?.col)&&(w=this.tableProps.createCellCoords(clamp(E.row,p,h-1),clamp(E.col,v,f-1)));const b=this.tableProps.createCellCoords(p,v),P=this.tableProps.createCellCoords(h-1,f-1);this.clear(),this.runLocalHooks("beforeSelectAll",b,P,w),this.setRangeStartOnly(b,void 0,w),_classPrivateFieldSet$N(_disableHeadersHighlight,this,C),v<0&&this.selectedByRowHeader.add(this.getLayerLevel()),p<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(P),this.runLocalHooks("afterSelectAll",b,P,w),this.finish()}selectCells(s){var c=this;const u=detectSelectionType(s);if(u===SELECTION_TYPE_EMPTY)return!1;if(u===SELECTION_TYPE_UNRECOGNIZED)throw new Error(toSingleLine`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const d=normalizeSelectionFactory(u,{createCellCoords:function(){return c.tableProps.createCellCoords(...arguments)},createCellRange:function(){return c.tableProps.createCellRange(...arguments)},propToCol:m=>this.tableProps.propToCol(m),keepDirection:!0}),h=this.settings.navigableHeaders,f={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:h?this.tableProps.countRowHeaders():0,countColHeaders:h?this.tableProps.countColHeaders():0},g=!s.some(m=>{const p=d(m),v=p.isValid(f);return!(v&&!p.containsHeaders()||v&&p.containsHeaders()&&p.isSingleHeader())});return g&&(this.clear(),this.setExpectedLayers(s.length),arrayEach(s,m=>{const{from:p,to:v}=d(m);this.setRangeStartOnly(p.clone(),!1),this.setRangeEnd(v.clone())}),this.finish()),g}selectColumns(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const d=typeof s=="string"?this.tableProps.propToCol(s):s,h=typeof c=="string"?this.tableProps.propToCol(c):c,f=this.tableProps.countRows(),g=this.tableProps.countCols(),m=this.tableProps.countColHeaders(),p=m===0?0:-m,v=this.tableProps.createCellCoords(p,d),w=this.tableProps.createCellCoords(f-1,h),E=this.tableProps.createCellRange(v,v,w).isValid({countRows:f,countCols:g,countRowHeaders:0,countColHeaders:m});if(E){let C=0,b=0;Number.isInteger(u?.row)&&Number.isInteger(u?.col)?(C=clamp(u.row,p,f-1),b=clamp(u.col,Math.min(d,h),Math.max(d,h))):(C=clamp(u,p,f-1),b=d);const P=this.tableProps.createCellCoords(C,b),R=m===0?0:clamp(P.row,p,-1),T=f-1,I=this.tableProps.createCellCoords(R,d),M=this.tableProps.createCellCoords(T,h);this.runLocalHooks("beforeSelectColumns",I,M,P),this.setRangeStartOnly(I,void 0,P),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(M),this.runLocalHooks("afterSelectColumns",I,M,P),this.finish()}return E}selectRows(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const d=this.tableProps.countRows(),h=this.tableProps.countCols(),f=this.tableProps.countRowHeaders(),g=f===0?0:-f,m=this.tableProps.createCellCoords(s,g),p=this.tableProps.createCellCoords(c,h-1),v=this.tableProps.createCellRange(m,m,p).isValid({countRows:d,countCols:h,countRowHeaders:f,countColHeaders:0});if(v){let w=0,E=0;Number.isInteger(u?.row)&&Number.isInteger(u?.col)?(w=clamp(u.row,Math.min(s,c),Math.max(s,c)),E=clamp(u.col,g,h-1)):(w=s,E=clamp(u,g,h-1));const C=this.tableProps.createCellCoords(w,E),b=f===0?0:clamp(C.col,g,-1),P=h-1,R=this.tableProps.createCellCoords(s,b),T=this.tableProps.createCellCoords(c,P);this.runLocalHooks("beforeSelectRows",R,T,C),this.setRangeStartOnly(R,void 0,C),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(T),this.runLocalHooks("afterSelectRows",R,T,C),this.finish()}return v}importSelection(s){let{ranges:c,activeRange:u,activeSelectionLayer:d,selectedByRowHeader:h,selectedByColumnHeader:f,disableHeadersHighlight:g}=s;c.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!1,_classPrivateFieldSet$N(_disableHeadersHighlight,this,g),this.selectedByRowHeader=new Set(h),this.selectedByColumnHeader=new Set(f),this.setActiveSelectionLayerIndex(0),c.forEach((m,p)=>{this.selectedRange.push(m),this.applyAndCommit(m,p)}),this.setRangeFocus(u.highlight,d),_classPrivateFieldSet$N(_disableHeadersHighlight,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(s=>s.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:_classPrivateFieldGet$Q(_disableHeadersHighlight,this)}}refresh(){if(!this.isSelected())return;const s=this.tableProps.countRows(),c=this.tableProps.countCols();if(s===0||c===0){this.deselect();return}const u=this.selectedRange.ranges.map(f=>f.clone());this.markSource("refresh");const d=new Set(this.selectedByRowHeader),h=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(u.length),u.forEach(f=>{const{from:g,to:m,highlight:p}=f,v=s-1,w=c-1;p.assign({row:clamp(p.row,this.settings.navigableHeaders?-1/0:0,v),col:clamp(p.col,this.settings.navigableHeaders?-1/0:0,w)}),g.assign({row:clamp(g.row,-1/0,v),col:clamp(g.col,-1/0,w)}),m.assign({row:clamp(m.row,-1/0,v),col:clamp(m.col,-1/0,w)}),this.setRangeStartOnly(g,!0,p),this.setRangeEnd(m)}),this.selectedByRowHeader=d,this.selectedByColumnHeader=h,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(d=>{d.commit()}),!this.isSelected())return;const c=this.getLayerLevel(),u=this.getActiveSelectedRange();this.highlight.isEnabledFor(FOCUS_TYPE,u.highlight)&&this.highlight.getFocus().commit().syncWith(u);for(let d=0;d<this.selectedRange.size();d+=1){this.highlight.useLayerLevel(d);const h=this.highlight.createArea(),f=this.highlight.createLayeredArea(),g=this.highlight.createRowHeader(),m=this.highlight.createColumnHeader(),p=this.highlight.createActiveRowHeader(),v=this.highlight.createActiveColumnHeader(),w=this.highlight.createActiveCornerHeader(),E=this.highlight.createRowHighlight(),C=this.highlight.createColumnHighlight();h.commit(),f.commit(),g.commit(),m.commit(),p.commit(),v.commit(),w.commit(),E.commit(),C.commit()}this.highlight.useLayerLevel(c)}}mixin(Selection,localHooks);const regUniversalNewLine=/^(\r\n|\n\r|\r|\n)/,regNextCellNoQuotes=/^[^\t\r\n]+/,regNextEmptyCell=/^\t/;function parse(a){const s=[[""]];if(a.length===0)return s;let c=0,u=0,d;for(;a.length>0&&d!==a.length;)if(d=a.length,a.match(regNextEmptyCell))a=a.replace(regNextEmptyCell,""),c+=1,s[u][c]="";else if(a.match(regUniversalNewLine))a=a.replace(regUniversalNewLine,""),c=0,u+=1,s[u]=[""];else{let h="";if(a.startsWith('"')){let f=0,g=!0;for(;g;){const m=a.slice(0,1);m==='"'&&(f+=1),h+=m,a=a.slice(1),(a.length===0||a.match(/^[\t\r\n]/)&&f%2===0)&&(g=!1)}h=h.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,m=>new Array(Math.floor(m.length/2)).fill('"').join(""))}else{const f=a.match(regNextCellNoQuotes);h=f?f[0]:"",a=a.slice(h.length)}s[u][c]=h}return s}function stringify(a){let s,c,u,d,h="",f;for(s=0,c=a.length;s<c;s+=1){for(d=a[s].length,u=0;u<d;u+=1)u>0&&(h+="	"),f=a[s][u],typeof f=="string"?f.indexOf(`
`)>-1?h+=`"${f.replace(/"/g,'""')}"`:h+=f:f==null?h+="":h+=f;s!==c-1&&(h+=`
`)}return h}function getValueSetterValue(a,s){const{instance:c,visualRow:u,visualCol:d,valueSetter:h}=s;return isFunction(h)?h.call(c,a,u,d,s):a}function getValueGetterValue(a,s){const{instance:c,visualRow:u,visualCol:d,valueGetter:h}=s;return isFunction(h)?h.call(c,a,u,d,s):a}function _defineProperty$1p(a,s,c){return(s=_toPropertyKey$1q(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1q(a){var s=_toPrimitive$1q(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1q(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DataMap{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(s,c,u){_defineProperty$1p(this,"hot",void 0),_defineProperty$1p(this,"metaManager",void 0),_defineProperty$1p(this,"tableMeta",void 0),_defineProperty$1p(this,"dataSource",void 0),_defineProperty$1p(this,"duckSchema",void 0),_defineProperty$1p(this,"colToPropCache",void 0),_defineProperty$1p(this,"propToColCache",void 0),this.hot=s,this.metaManager=u,this.tableMeta=u.getTableMeta(),this.dataSource=c,this.refreshDuckSchema(),this.createMap()}createMap(){const s=this.getSchema();if(typeof s>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const c=this.tableMeta.columns;let u;if(this.colToPropCache=[],this.propToColCache=new Map,c){let d=0,h=0,f=!1;if(typeof c=="function"){const g=deepObjectSize(s);d=g>0?g:this.countFirstRowKeys(),f=!0}else{const g=this.tableMeta.maxCols;d=Math.min(g,c.length)}for(u=0;u<d;u++){const g=f?c(u):c[u];if(isObject(g)){if(typeof g.data<"u"){const m=f?h:u;this.colToPropCache[m]=g.data,this.propToColCache.set(g.data,m)}h+=1}}}else this.recursiveDuckColumns(s)}countFirstRowKeys(){return countFirstRowKeys(this.dataSource)}recursiveDuckColumns(s,c,u){let d=c,h=u,f;return typeof d>"u"&&(d=0,h=""),typeof s=="object"&&!Array.isArray(s)&&objectEach(s,(g,m)=>{g===null?(f=h+m,this.colToPropCache.push(f),this.propToColCache.set(f,d),d+=1):d=this.recursiveDuckColumns(g,d,`${m}.`)}),d}colToProp(s){if(Number.isInteger(s)===!1)return s;const c=this.hot.toPhysicalColumn(s);return c===null?s:this.colToPropCache&&isDefined(this.colToPropCache[c])?this.colToPropCache[c]:c}propToCol(s){const c=this.propToColCache.get(s);if(isDefined(c))return this.hot.toVisualColumn(c);const u=this.hot.toVisualColumn(s);return u===null?s:u}getSchema(){const s=this.tableMeta.dataSchema;return s?typeof s=="function"?s():s:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?duckSchema(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:u,mode:d="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const h=this.hot.countSourceRows();let f=h,g=0,m=s;if((typeof m!="number"||m>=h)&&(m=h),m<this.hot.countRows()&&(f=this.hot.toPhysicalRow(m)),this.hot.runHooks("beforeCreateRow",m,c,u)===!1||f===null)return{delta:0};const v=this.tableMeta.maxRows,w=this.getSchema().length,E=[];for(;g<c&&h+g<v;){let b=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?b=deepClone(this.getSchema()):(b=[],rangeEach(w-1,()=>b.push(null))):this.hot.dataType==="function"?b=this.tableMeta.dataSchema(m+g):(b={},deepExtend(b,this.getSchema())),E.push(b),g+=1}this.hot.rowIndexMapper.insertIndexes(m,g),d==="below"&&(f=Math.min(f+1,h)),this.spliceData(f,0,E);const C=this.hot.toVisualRow(f);return this.hot.countSourceRows()===E.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),g>0&&(s==null?this.metaManager.createRow(null,g):u!=="auto"&&this.metaManager.createRow(f,c)),this.hot.runHooks("afterCreateRow",C,g,u),{delta:g,startPhysicalIndex:f}}createCol(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:u,mode:d="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const h=this.dataSource,f=this.tableMeta.maxCols,g=this.hot.countSourceCols(),m=this.hot.countCols(),p=this.hot.countSourceRows(),v=typeof s=="number"&&s<=g?s:m;if(this.hot.runHooks("beforeCreateCol",v,c,u)===!1)return{delta:0};const w=v<m?this.hot.toPhysicalColumn(v):g,E=d==="end"?Math.min(w+1,g):w;let C=0;for(let b=E;C<c&&m+C<f;b++){if(typeof v!="number"||v>=m+C)if(p>0)for(let P=0;P<p;P+=1)typeof h[P]>"u"&&(h[P]=[]),h[P].push(null);else h.push([null]);else for(let P=0;P<p;P++)h[P].splice(b,0,null);C+=1}return C>0&&(s==null?this.metaManager.createColumn(null,C):u!=="auto"&&this.metaManager.createColumn(E,c)),this.hot.columnIndexMapper.insertIndexes(v,C,d),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(E),C,u),this.refreshDuckSchema(),{delta:C,startPhysicalIndex:E}}removeRow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,u=arguments.length>2?arguments[2]:void 0,d=Number.isInteger(s)?s:-c;const h=this.visualRowsToPhysical(d,c),f=this.hot.countSourceRows();if(d=(f+d)%f,this.hot.runHooks("beforeRemoveRow",d,h.length,h,u)===!1)return!1;const m=h.length;if(this.filterData(d,m,h),d<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(h);const v=isDefined(this.tableMeta.columns)||isDefined(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!v&&this.hot.columnIndexMapper.setIndexesSequence([])}return h.slice(0).sort((v,w)=>w-v).forEach(v=>{this.metaManager.removeRow(v,1)}),this.hot.runHooks("afterRemoveRow",d,m,h,u),!0}removeCol(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,u=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let d=typeof s!="number"?-c:s;d=(this.hot.countCols()+d)%this.hot.countCols();const h=this.visualColumnsToPhysical(d,c),f=h.slice(0).sort((w,E)=>E-w);if(this.hot.runHooks("beforeRemoveCol",d,c,h,u)===!1)return!1;let m=!0;const p=f.length,v=this.dataSource;for(let w=0;w<p;w++)m&&h[0]!==h[w]-w&&(m=!1);if(m)for(let w=0,E=this.hot.countSourceRows();w<E;w++)v[w].splice(h[0],c),w===0&&this.metaManager.removeColumn(h[0],c);else for(let w=0,E=this.hot.countSourceRows();w<E;w++)for(let C=0;C<p;C++)v[w].splice(f[C],1),w===0&&this.metaManager.removeColumn(f[C],1);return d<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(h),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",d,c,h,u),this.refreshDuckSchema(),!0}spliceCol(s,c,u){const d=this.hot.getDataAtCol(s),h=d.slice(c,c+u),f=d.slice(c+u);for(var g=arguments.length,m=new Array(g>3?g-3:0),p=3;p<g;p++)m[p-3]=arguments[p];extendArray(m,f);let v=0;for(;v<u;)m.push(null),v+=1;return to2dArray(m),this.hot.populateFromArray(c,s,m,null,null,"spliceCol"),h}spliceRow(s,c,u){const d=this.hot.getSourceDataAtRow(s),h=d.slice(c,c+u),f=d.slice(c+u);for(var g=arguments.length,m=new Array(g>3?g-3:0),p=3;p<g;p++)m[p-3]=arguments[p];extendArray(m,f);let v=0;for(;v<u;)m.push(null),v+=1;return this.hot.populateFromArray(s,c,[m],null,null,"spliceRow"),h}spliceData(s,c,u){if(this.hot.runHooks("beforeDataSplice",s,c,u)!==!1){const h=[...this.dataSource.slice(0,s),...u,...this.dataSource.slice(s)];this.dataSource.length=0,h.forEach(f=>this.dataSource.push(f))}}filterData(s,c,u){let d=this.hot.runHooks("filterData",s,c,u);Array.isArray(d)===!1&&(d=this.dataSource.filter((h,f)=>u.indexOf(f)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,d)}get(s,c){const u=this.hot.toPhysicalRow(s);let d=this.dataSource[u];const h=this.hot.runHooks("modifyRowData",u);d=isNaN(h)?h:d;const{dataDotNotation:f}=this.hot.getSettings();let g=null;if(d&&d.hasOwnProperty&&hasOwnProperty(d,c))g=d[c];else if(f&&typeof c=="string"&&c.indexOf(".")>-1){let v=d;if(!v)return null;const w=c.split(".");for(let E=0,C=w.length;E<C;E++)if(v=v[w[E]],typeof v>"u")return null;g=v}else typeof c=="function"&&(g=c(this.dataSource.slice(u,u+1)[0]));const m=this.propToCol(c),p=this.hot.toPhysicalColumn(m);if(isUnsignedNumber(u)&&isUnsignedNumber(p)&&(g=getValueGetterValue(g,this.metaManager.getCellMeta(u,p,{visualRow:s,visualColumn:m,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const v=createObjectPropListener(g);this.hot.runHooks("modifyData",s,m,v,"get"),v.isTouched()&&(g=v.value)}return g}getCopyable(s,c){return this.hot.getCellMeta(s,this.propToCol(c)).copyable?this.get(s,c):""}set(s,c,u){const d=this.hot.toPhysicalRow(s);let h=u,f=this.dataSource[d];const g=this.hot.runHooks("modifyRowData",d);if(f=isNaN(g)?g:f,this.hot.hasHook("modifyData")){const p=createObjectPropListener(h);this.hot.runHooks("modifyData",s,this.propToCol(c),p,"set"),p.isTouched()&&(h=p.value)}const{dataDotNotation:m}=this.hot.getSettings();if(f&&f.hasOwnProperty&&hasOwnProperty(f,c))f[c]=h;else if(m&&typeof c=="string"&&c.indexOf(".")>-1){let p=f,v=0,w;const E=c.split(".");for(v=0,w=E.length-1;v<w;v++){if(E[v]==="__proto__"||E[v]==="constructor"||E[v]==="prototype")return;typeof p[E[v]]>"u"&&(p[E[v]]={}),p=p[E[v]]}p[E[v]]=h}else if(typeof c=="function")c(this.dataSource.slice(d,d+1)[0],h);else{if(c==="__proto__"||c==="constructor"||c==="prototype")return;f[c]=h}}visualRowsToPhysical(s,c){const u=this.hot.countSourceRows(),d=[];let h=(u+s)%u,f=c,g;for(;h<u&&f;)g=this.hot.toPhysicalRow(h),d.push(g),f-=1,h+=1;return d}visualColumnsToPhysical(s,c){const u=this.hot.countCols(),d=[];let h=(u+s)%u,f=c;for(;h<u&&f;){const g=this.hot.toPhysicalColumn(h);d.push(g),f-=1,h+=1}return d}clear(){for(let s=0;s<this.hot.countSourceRows();s++)for(let c=0;c<this.hot.countCols();c++)this.set(s,this.colToProp(c),"")}getLength(){const s=this.tableMeta.maxRows;let c;s<0||s===0?c=0:c=s||1/0;const u=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(u,c)}getAll(){const s={row:0,col:0},c={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return s.row-c.row===0&&!this.hot.countSourceRows()?[]:this.getRange(s,c,DataMap.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(s,c,u){const d=[];let h,f,g;const m=this.tableMeta.maxRows,p=this.tableMeta.maxCols;if(m===0||p===0)return[];const v=u===DataMap.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,w=Math.min(Math.max(m-1,0),Math.max(s.row,c.row)),E=Math.min(Math.max(p-1,0),Math.max(s.col,c.col));for(h=Math.min(s.row,c.row);h<=w;h++){g=[];const C=h>=0?this.hot.toPhysicalRow(h):h;for(f=Math.min(s.col,c.col);f<=E&&C!==null;f++)g.push(v.call(this,h,this.colToProp(f)));C!==null&&d.push(g)}return d}getText(s,c){return stringify(this.getRange(s,c,DataMap.DESTINATION_RENDERER))}getCopyableText(s,c){return stringify(this.getRange(s,c,DataMap.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register,getItem,hasItem,getNames,getValues}=staticRegister("cellTypes");function _getItem(a){if(!hasItem(a))throw Error(`You declared cell type "${a}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return getItem(a)}function _register(a,s){typeof a!="string"&&(s=a,a=s.CELL_TYPE);const{editor:c,renderer:u,validator:d}=s;c&&_register$3(a,c),u&&_register$2(a,u),d&&_register$1(a,d),register(a,s)}function canBeOverwritten(a,s){var c;return a==="CELL_TYPE"?!1:((c=s._automaticallyAssignedMetaProps)===null||c===void 0?void 0:c.has(a))||!hasOwnProperty(s,a)}function extendByMetaType(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a;const u=typeof s.type=="string"?_getItem(s.type):s.type;if(a._automaticallyAssignedMetaProps&&objectEach(s,(h,f)=>void a._automaticallyAssignedMetaProps.delete(f)),!isObject(u))return;c===a&&!a._automaticallyAssignedMetaProps&&(a._automaticallyAssignedMetaProps=new Set);const d={};objectEach(u,(h,f)=>{if(canBeOverwritten(f,c)){var g;d[f]=h,(g=a._automaticallyAssignedMetaProps)===null||g===void 0||g.add(f)}}),extend$1(a,d)}function columnFactory(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function c(){}inherit(c,a);for(let u=0;u<s.length;u++)c.prototype[s[u]]=void 0;return c}function assert(a,s){if(!a())throw new Error(`Assertion failed: ${s}`)}function isNullish(a){return a==null}const metaSchemaFactory=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,emptyDataState:!1,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(a){let s,c,u;for(s=0,c=this.countRows();s<c;s++)if(u=this.getDataAtCell(s,a),isEmpty(u)===!1)return!1;return!0},isEmptyRow(a){let s,c,u,d;for(s=0,c=this.countCols();s<c;s++)if(u=this.getDataAtCell(a,s),isEmpty(u)===!1)return typeof u=="object"?(d=this.getCellMeta(a,s),isObjectEqual(this.getSchema()[d.prop],u)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRowHeights:void 0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function _defineProperty$1o(a,s,c){return(s=_toPropertyKey$1p(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1p(a){var s=_toPrimitive$1p(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1p(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function createTableMetaEmptyClass(){return class{}}class GlobalMeta{constructor(s){_defineProperty$1o(this,"metaCtor",createTableMetaEmptyClass()),_defineProperty$1o(this,"meta",void 0),this.meta=this.metaCtor.prototype,extend$1(this.meta,metaSchemaFactory()),this.meta.instance=s}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(s){var c;extend$1(this.meta,s),extendByMetaType(this.meta,{...s,type:(c=s.type)!==null&&c!==void 0?c:this.meta.type},s)}}function _defineProperty$1n(a,s,c){return(s=_toPropertyKey$1o(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1o(a){var s=_toPrimitive$1o(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1o(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class TableMeta{constructor(s){_defineProperty$1n(this,"meta",void 0);const c=s.getMetaConstructor();this.meta=new c}getMeta(){return this.meta}updateMeta(s){extend$1(this.meta,s),extendByMetaType(this.meta,s,s)}}function _defineProperty$1m(a,s,c){return(s=_toPropertyKey$1n(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1n(a){var s=_toPrimitive$1n(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1n(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class LazyFactoryMap{constructor(s){_defineProperty$1m(this,"valueFactory",void 0),_defineProperty$1m(this,"data",[]),_defineProperty$1m(this,"index",[]),_defineProperty$1m(this,"holes",new Set),this.valueFactory=s}obtain(s){assert(()=>isUnsignedNumber(s),"Expecting an unsigned number.");const c=this._getStorageIndexByKey(s);let u;if(c>=0)u=this.data[c],u===void 0&&(u=this.valueFactory(s),this.data[c]=u);else if(u=this.valueFactory(s),this.holes.size>0){const d=this.holes.values().next().value;this.holes.delete(d),this.data[d]=u,this.index[s]=d}else this.data.push(u),this.index[s]=this.data.length-1;return u}insert(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(s)||isNullish(s),"Expecting an unsigned number or null/undefined argument.");const u=[],d=this.data.length;for(let f=0;f<c;f++)u.push(d+f),this.data.push(void 0);const h=isNullish(s)?this.index.length:s;this.index=[...this.index.slice(0,h),...u,...this.index.slice(h)]}remove(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;assert(()=>isUnsignedNumber(s)||isNullish(s),"Expecting an unsigned number or null/undefined argument.");const u=this.index.splice(isNullish(s)?this.index.length-c:s,c);for(let d=0;d<u.length;d++){const h=u[d];typeof h=="number"&&this.holes.add(h)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((s,c)=>s!==void 0&&!this.holes.has(c))[Symbol.iterator]()}entries(){const s=[];for(let u=0;u<this.data.length;u++){const d=this._getKeyByStorageIndex(u);d!==-1&&this.data[u]!==void 0&&s.push([d,this.data[u]])}let c=0;return{next:()=>{if(c<s.length){const u=s[c];return c+=1,{value:u,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(s){return this.index.length>s?this.index[s]:-1}_getKeyByStorageIndex(s){return this.index.indexOf(s)}[Symbol.iterator](){return this.entries()}}function _defineProperty$1l(a,s,c){return(s=_toPropertyKey$1m(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1m(a){var s=_toPrimitive$1m(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1m(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const COLUMNS_PROPS_CONFLICTS=["data","width"];class ColumnMeta{constructor(s){_defineProperty$1l(this,"globalMeta",void 0),_defineProperty$1l(this,"metas",new LazyFactoryMap(()=>this._createMeta())),this.globalMeta=s,this.metas=new LazyFactoryMap(()=>this._createMeta())}updateMeta(s,c){const u=this.getMeta(s);extend$1(u,c),extendByMetaType(u,c)}createColumn(s,c){this.metas.insert(s,c)}removeColumn(s,c){this.metas.remove(s,c)}getMeta(s){return this.metas.obtain(s)}getMetaConstructor(s){return this.metas.obtain(s).constructor}clearCache(){this.metas.clear()}_createMeta(){return columnFactory(this.globalMeta.getMetaConstructor(),COLUMNS_PROPS_CONFLICTS).prototype}}function _defineProperty$1k(a,s,c){return(s=_toPropertyKey$1l(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1l(a){var s=_toPrimitive$1l(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1l(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CellMeta{constructor(s){_defineProperty$1k(this,"columnMeta",void 0),_defineProperty$1k(this,"metas",new LazyFactoryMap(()=>this._createRow())),this.columnMeta=s}updateMeta(s,c,u){const d=this.getMeta(s,c);extend$1(d,u),extendByMetaType(d,u)}createRow(s,c){this.metas.insert(s,c)}createColumn(s,c){for(let u=0;u<this.metas.size();u++)this.metas.obtain(u).insert(s,c)}removeRow(s,c){this.metas.remove(s,c)}removeColumn(s,c){for(let u=0;u<this.metas.size();u++)this.metas.obtain(u).remove(s,c)}getMeta(s,c,u){const d=this.metas.obtain(s).obtain(c);return u===void 0?d:d[u]}setMeta(s,c,u,d){var h;const f=this.metas.obtain(s).obtain(c);(h=f._automaticallyAssignedMetaProps)===null||h===void 0||h.delete(u),f[u]=d}removeMeta(s,c,u){const d=this.metas.obtain(s).obtain(c);delete d[u]}getMetas(){const s=[],c=Array.from(this.metas.values());for(let u=0;u<c.length;u++)isDefined(c[u])&&s.push(...c[u].values());return s}getMetasAtRow(s){assert(()=>isUnsignedNumber(s),"Expecting an unsigned number.");const c=new Map(this.metas);return c.has(s)?Array.from(c.get(s).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new LazyFactoryMap(s=>this._createMeta(s))}_createMeta(s){const c=this.columnMeta.getMetaConstructor(s);return new c}}class MetaManager{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=s,this.globalMeta=new GlobalMeta(s),this.tableMeta=new TableMeta(this.globalMeta),this.columnMeta=new ColumnMeta(this.globalMeta),this.cellMeta=new CellMeta(this.columnMeta),u.forEach(d=>new d(this)),this.globalMeta.updateMeta(c)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(s){this.globalMeta.updateMeta(s)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(s){this.tableMeta.updateMeta(s)}getColumnMeta(s){return this.columnMeta.getMeta(s)}updateColumnMeta(s,c){this.columnMeta.updateMeta(s,c)}getCellMeta(s,c,u){const d=this.cellMeta.getMeta(s,c);return d.visualRow=u.visualRow,d.visualCol=u.visualColumn,d.row=s,d.col=c,u.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",d),d}getCellMetaKeyValue(s,c,u){if(typeof u!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(s,c,u)}setCellMeta(s,c,u,d){this.cellMeta.setMeta(s,c,u,d)}updateCellMeta(s,c,u){this.cellMeta.updateMeta(s,c,u)}removeCellMeta(s,c,u){this.cellMeta.removeMeta(s,c,u)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(s){return this.cellMeta.getMetasAtRow(s)}createRow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(s,c)}removeRow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(s,c)}createColumn(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(s,c),this.columnMeta.createColumn(s,c)}removeColumn(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(s,c),this.columnMeta.removeColumn(s,c)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}mixin(MetaManager,localHooks);function replaceData(a,s,c,u){const{hotInstance:d,dataMap:h,dataSource:f,internalSource:g,source:m,metaManager:p,firstRun:v}=u,w=toUpperCaseFirst(g),E=d.getSettings();Array.isArray(E.dataSchema)?d.dataType="array":isFunction(E.dataSchema)?d.dataType="function":d.dataType="object",h&&h.destroy(),a=d.runHooks(`before${w}`,a,v,m);const C=new DataMap(d,a,p);if(s(C),typeof a=="object"&&a!==null)a.push&&a.splice||(a=[a]);else if(a===null){const b=C.getSchema();a=[];let P,R=0,T=0;for(R=0,T=E.startRows;R<T;R++)if((d.dataType==="object"||d.dataType==="function")&&E.dataSchema)P=deepClone(b),a.push(P);else if(d.dataType==="array")P=deepClone(b[0]),a.push(P);else{P=[];for(let I=0,M=E.startCols;I<M;I++)P.push(null);a.push(P)}}else throw new Error(`${g} only accepts array of objects or array of arrays (${typeof a} given)`);Array.isArray(a[0])&&(d.dataType="array"),E.data=a,C.dataSource=a,f.data=a,f.dataType=d.dataType,f.colToProp=C.colToProp.bind(C),f.propToCol=C.propToCol.bind(C),f.countCachedColumns=C.countCachedColumns.bind(C),c(C),d.runHooks(`after${w}`,a,v,m),v||(d.runHooks("afterChange",null,g),d.view.adjustElementsSize(),d.render()),d.getSettings().ariaTags&&setAttribute(d.rootElement,[A11Y_ROWCOUNT(-1),A11Y_COLCOUNT(d.countCols()+(d.view?d.countRowHeaders():0))])}function _defineProperty$1j(a,s,c){return(s=_toPropertyKey$1k(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1k(a){var s=_toPrimitive$1k(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1k(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DynamicCellMetaMod{constructor(s){var c=this;_defineProperty$1j(this,"metaManager",void 0),_defineProperty$1j(this,"metaSyncMemo",new Map),this.metaManager=s,s.addLocalHook("afterGetCellMeta",function(){return c.extendCellMeta(...arguments)}),Hooks.getSingleton().add("beforeRender",u=>{u&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(s){var c;const{row:u,col:d}=s;if((c=this.metaSyncMemo.get(u))!==null&&c!==void 0&&c.has(d))return;const{visualRow:h,visualCol:f}=s,g=this.metaManager.hot,m=g.colToProp(f);s.prop=m,g.runHooks("beforeGetCellMeta",h,f,s);const p=hasOwnProperty(s,"type")?s.type:null;let v=isFunction(s.cells)?s.cells(u,d,m):null;if(p)if(v){var w;v.type=(w=v.type)!==null&&w!==void 0?w:p}else v={type:p};v&&this.metaManager.updateCellMeta(u,d,v),g.runHooks("afterGetCellMeta",h,f,s),this.metaSyncMemo.has(u)||this.metaSyncMemo.set(u,new Set),this.metaSyncMemo.get(u).add(d)}}function _classPrivateFieldInitSpec$P(a,s,c){_checkPrivateRedeclaration$16(a,s),s.set(a,c)}function _checkPrivateRedeclaration$16(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1i(a,s,c){return(s=_toPropertyKey$1j(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1j(a){var s=_toPrimitive$1j(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1j(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$P(a,s){return a.get(_assertClassBrand$16(a,s))}function _assertClassBrand$16(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _initOnlyCallback=new WeakMap;class ExtendMetaPropertiesMod{constructor(s){_defineProperty$1i(this,"metaManager",void 0),_defineProperty$1i(this,"usageTracker",new Set),_defineProperty$1i(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(c){if(this.metaManager.hot.isRtl()&&c==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),_classPrivateFieldInitSpec$P(this,_initOnlyCallback,(c,u,d)=>{if(!d)throw new Error(`The \`${c}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=s,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((s,c)=>{const{initOnly:u,target:d,onChange:h}=s,f=typeof d=="string",g=f?d:c,m=`_${g}`;this.metaManager.globalMeta.meta[m]=this.metaManager.globalMeta.meta[g],h?(this.installPropWatcher(c,m,h),f&&this.installPropWatcher(d,m,h)):u&&(this.installPropWatcher(c,m,_classPrivateFieldGet$P(_initOnlyCallback,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(c))})}installPropWatcher(s,c,u){const d=this;Object.defineProperty(this.metaManager.globalMeta.meta,s,{get(){return this[c]},set(h){const f=!d.usageTracker.has(s);d.usageTracker.add(s),u.call(d,s,h,f),this[c]=h},enumerable:!0,configurable:!0})}}function _classPrivateMethodInitSpec$T(a,s){_checkPrivateRedeclaration$15(a,s),s.add(a)}function _classPrivateFieldInitSpec$O(a,s,c){_checkPrivateRedeclaration$15(a,s),s.set(a,c)}function _checkPrivateRedeclaration$15(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$O(a,s){return a.get(_assertClassBrand$15(a,s))}function _classPrivateFieldSet$M(a,s,c){return a.set(_assertClassBrand$15(a,s),c),c}function _assertClassBrand$15(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _rowIndexMapper$1=new WeakMap,_columnIndexMapper$1=new WeakMap,_CellRangeToRenderableMapper_brand=new WeakSet;class CellRangeToRenderableMapper{constructor(s){let{rowIndexMapper:c,columnIndexMapper:u}=s;_classPrivateMethodInitSpec$T(this,_CellRangeToRenderableMapper_brand),_classPrivateFieldInitSpec$O(this,_rowIndexMapper$1,void 0),_classPrivateFieldInitSpec$O(this,_columnIndexMapper$1,void 0),_classPrivateFieldSet$M(_rowIndexMapper$1,this,c),_classPrivateFieldSet$M(_columnIndexMapper$1,this,u)}toRenderable(s){const c=s.getVerticalDirection()==="N-S"?1:-1,u=s.getHorizontalDirection()==="W-E"?1:-1,d=_assertClassBrand$15(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenCoords).call(this,s.from,c,u);if(d===null)return null;const h=_assertClassBrand$15(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenCoords).call(this,s.to,-c,-u);if(h===null)return null;const f=s.clone();return f.from=d,f.to=h,f.includes(s.highlight)||(f.highlight=d),f}}function _getNearestNotHiddenCoords(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:s;const u=_assertClassBrand$15(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenIndex).call(this,_classPrivateFieldGet$O(_rowIndexMapper$1,this),a.row,s);if(u===null)return null;const d=_assertClassBrand$15(_CellRangeToRenderableMapper_brand,this,_getNearestNotHiddenIndex).call(this,_classPrivateFieldGet$O(_columnIndexMapper$1,this),a.col,c);return d===null?null:a.clone().assign({row:u,col:d})}function _getNearestNotHiddenIndex(a,s,c){return s<0?s:a.getNearestNotHiddenIndex(s,c)}function scrollWindowToCell(a){isHTMLElement(a)&&a.scrollIntoView({block:"nearest",inline:"nearest"})}function createScrollTargetCalculator(a){const{selection:s,view:c}=a,u=a.getSelectedRangeActive(),d=s.getSelectionSource(),h=c.getFirstFullyVisibleColumn(),f=c.getLastFullyVisibleColumn(),g=u.getTopStartCorner().col,m=u.getBottomEndCorner().col,p=g<=h,v=m>=f,w=c.getFirstFullyVisibleRow(),E=c.getLastFullyVisibleRow(),C=u.getTopStartCorner().row,b=u.getBottomEndCorner().row,P=C<=w,R=b>=E;return{getComputedColumnTarget(T){return d==="mouse"||d==="keyboard"?T.col:p&&v?u.highlight.col:p?g:v?m:T.col},getComputedRowTarget(T){return d==="mouse"||d==="keyboard"?T.row:P&&R?u.highlight.row:P?C:R?b:T.row}}}function columnHeaderScrollStrategy(a){return s=>{const c=createScrollTargetCalculator(a).getComputedColumnTarget(s);a.scrollViewportTo({col:c},()=>{const u=!!a.getSettings().colHeaders;scrollWindowToCell(a.getCell(u?-1:0,c,!0))})}}function cornerHeaderScrollStrategy(){return()=>{}}function focusScrollStrategy(a){return s=>{a.scrollViewportTo(s.toObject(),()=>{const c=a.getSelectedRangeActive();if(!c)return;const{row:u,col:d}=c.highlight;scrollWindowToCell(a.getCell(u,d,!0))})}}function multipleScrollStrategy(a){return s=>{const c=createScrollTargetCalculator(a),u={row:c.getComputedRowTarget(s),col:c.getComputedColumnTarget(s)};a.scrollViewportTo(u,()=>{const{row:d,col:h}=u;scrollWindowToCell(a.getCell(d,h,!0))})}}function noncontiguousScrollStrategy(a){return s=>{const c=createScrollTargetCalculator(a),u={row:c.getComputedRowTarget(s),col:c.getComputedColumnTarget(s)};a.scrollViewportTo(u,()=>{const{row:d,col:h}=u;scrollWindowToCell(a.getCell(d,h,!0))})}}function rowHeaderScrollStrategy(a){return s=>{const c=createScrollTargetCalculator(a).getComputedRowTarget(s);a.scrollViewportTo({row:c},()=>{const u=!!a.getSettings().rowHeaders;scrollWindowToCell(a.getCell(c,u?-1:0,!0))})}}function singleScrollStrategy(a){return s=>{const c=a.selection.getSelectionSource(),{row:u,col:d}=s,h=()=>{scrollWindowToCell(a.getCell(u,d,!0))};if(u<0&&d>=0)a.scrollViewportTo({col:d},h);else if(d<0&&u>=0)a.scrollViewportTo({row:u},h);else{if(c==="mouse"&&(d===a.view.getLastPartiallyVisibleColumn()||u===a.view.getLastPartiallyVisibleRow()))return;a.scrollViewportTo({row:u,col:d},h)}}}function createViewportScroller(a){const{selection:s}=a;let c=!1,u=!1;return{resume(){u=!1},suspend(){u=!0},skipNextScrollCycle(){c=!0},scrollTo(d){var h;if(c||u){c=!1;return}let f;s.isFocusSelectionChanged()?f=focusScrollStrategy(a):s.isSelectedByCorner()?f=cornerHeaderScrollStrategy():s.isSelectedByRowHeader()?f=rowHeaderScrollStrategy(a):s.isSelectedByColumnHeader()?f=columnHeaderScrollStrategy(a):s.getSelectedRange().size()===1&&s.isMultiple()?f=multipleScrollStrategy(a):s.getSelectedRange().size()===1&&!s.isMultiple()?f=singleScrollStrategy(a):s.getSelectedRange().size()>1&&(f=noncontiguousScrollStrategy(a)),(h=f)===null||h===void 0||h(d)}}}const SCOPE_TYPES=Object.freeze({INLINE:"inline",MODAL:"modal"}),FOCUS_SOURCES=Object.freeze({UNKNOWN:"unknown",CLICK:"click",TAB_FROM_ABOVE:"tab_from_above",TAB_FROM_BELOW:"tab_from_below"}),DEFAULT_SHORTCUTS_CONTEXT="grid";function installFocusDetector(a,s){const c=createInputElement(a,FOCUS_SOURCES.TAB_FROM_ABOVE),u=createInputElement(a,FOCUS_SOURCES.TAB_FROM_BELOW);return s.prepend(c),s.append(u),{activate(){c.tabIndex=0,u.tabIndex=0},deactivate(){c.tabIndex=-1,u.tabIndex=-1},destroy(){c.remove(),u.remove()}}}function createInputElement(a,s){const u=a.rootDocument.createElement("input");return u.type="text",u.name="htFocusCatcher",u.classList.add("htFocusCatcher"),u.dataset.htFocusSource=s,a.getSettings().ariaTags&&setAttribute(u,[A11Y_LABEL("Focus catcher")]),u}function createFocusScope(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const u={shortcutsContextName:DEFAULT_SHORTCUTS_CONTEXT,type:SCOPE_TYPES.INLINE,contains:C=>C===s||s.contains(C),runOnlyIf:()=>!0,...c},d=installFocusDetector(a,s);return{getType:()=>u.type,hasContainerDetached:()=>!a.rootWrapperElement.contains(s),getShortcutsContextName:()=>u.shortcutsContextName,runOnlyIf:()=>u.runOnlyIf(),contains:C=>u.contains(C),activate:function(){var C;let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:FOCUS_SOURCES.UNKNOWN;(C=u.onActivate)===null||C===void 0||C.call(u,b)},deactivate:()=>{var C;(C=u.onDeactivate)===null||C===void 0||C.call(u)},activateFocusCatchers:()=>{d?.activate()},deactivateFocusCatchers:()=>{d?.deactivate()},enable:()=>{s.removeAttribute("inert")},disable:()=>{s.setAttribute("inert","true")},destroy:()=>{d?.destroy()}}}function useEventListener(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=!1;function u(v){if(!c){var w;(w=s.onFocus)===null||w===void 0||w.call(s,v)}}function d(v){var w;(w=s.onClick)===null||w===void 0||w.call(s,v)}function h(v){if(v.key==="Tab"){var w;(w=s.onTabKeyDown)===null||w===void 0||w.call(s,v)}}function f(){c=!0}function g(){c=!1}return{mount:()=>{let v=a;for(;v;){const{documentElement:w}=v.document;w.addEventListener("focusin",u),w.addEventListener("click",d),w.addEventListener("keydown",h),w.addEventListener("mousedown",f),w.addEventListener("mouseup",g),v=getParentWindow(v)}},unmount:()=>{let v=a;for(;v;){const{documentElement:w}=v.document;w.removeEventListener("focusin",u),w.removeEventListener("click",d),w.removeEventListener("keydown",h),w.removeEventListener("mousedown",f),w.removeEventListener("mouseup",g),v=getParentWindow(v)}}}}function createFocusScopeManager(a){const s=createUniqueMap({errorIdExists:b=>`The "${b}" focus scope is already registered.`}),c=a.getShortcutManager();let u=null;function d(){return u?s.getId(u):null}function h(b,P){let R=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(s.hasItem(b))throw new Error(`Scope with id "${b}" already registered`);const T=createFocusScope(a,P,R);s.addItem(b,T),c.getOrCreateContext(T.getShortcutsContextName())}function f(b){if(!s.hasItem(b))throw new Error(`Scope with id "${b}" not found`);s.getItem(b).destroy(),s.removeItem(b)}function g(b){if(!s.hasItem(b))throw new Error(`Scope with id "${b}" not found`);p(s.getItem(b))}function m(b){if(!s.hasItem(b))throw new Error(`Scope with id "${b}" not found`);v(s.getItem(b))}function p(b){let P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FOCUS_SOURCES.UNKNOWN;u!==b&&(u!==null&&v(u),u=b,u.activate(P),c.setActiveContextName(b.getShortcutsContextName()))}function v(b){w(),u===b&&(u=null,b.deactivate())}function w(){const b=s.getValues(),P=b.filter(R=>R.runOnlyIf()&&R.getType()==="modal");b.forEach(R=>{P.length>0&&P.includes(R)||P.length===0||R.hasContainerDetached()?R.enable():R.disable(),R===u?R.contains(a.rootDocument.activeElement)?R.deactivateFocusCatchers():R.activateFocusCatchers():R.runOnlyIf()?R.activateFocusCatchers():R.deactivateFocusCatchers()})}function E(b,P){if(!b.isConnected||!isVisible(b))return;const R=s.getValues().filter(I=>I.runOnlyIf());let T=!1;R.forEach(I=>{!T&&I.contains(b)&&(T=!0,P!==FOCUS_SOURCES.UNKNOWN&&a.listen(),p(I,P))}),!T&&u&&(v(u),a.unlisten())}const C=useEventListener(a.rootWindow,{onFocus:b=>{var P;E(b.target,(P=b.target.dataset.htFocusSource)!==null&&P!==void 0?P:FOCUS_SOURCES.UNKNOWN)},onClick:b=>{E(b.target,FOCUS_SOURCES.CLICK)},onTabKeyDown:()=>{w()}});return C.mount(),{getActiveScopeId:d,registerScope:h,unregisterScope:f,activateScope:b=>g(b),deactivateScope:b=>m(b),destroy:()=>C.unmount()}}function _classPrivateMethodInitSpec$S(a,s){_checkPrivateRedeclaration$14(a,s),s.add(a)}function _classPrivateFieldInitSpec$N(a,s,c){_checkPrivateRedeclaration$14(a,s),s.set(a,c)}function _checkPrivateRedeclaration$14(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$N(a,s){return a.get(_assertClassBrand$14(a,s))}function _classPrivateFieldSet$L(a,s,c){return a.set(_assertClassBrand$14(a,s),c),c}function _assertClassBrand$14(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const FOCUS_MODES=Object.freeze({CELL:"cell",MIXED:"mixed"});var _hot$2=new WeakMap,_focusMode=new WeakMap,_refocusDelay=new WeakMap,_refocusElementGetter=new WeakMap,_debouncedSelect=new WeakMap,_hasSelectionChange=new WeakMap,_FocusGridManager_brand=new WeakSet;class FocusGridManager{constructor(s){_classPrivateMethodInitSpec$S(this,_FocusGridManager_brand),_classPrivateFieldInitSpec$N(this,_hot$2,void 0),_classPrivateFieldInitSpec$N(this,_focusMode,void 0),_classPrivateFieldInitSpec$N(this,_refocusDelay,1),_classPrivateFieldInitSpec$N(this,_refocusElementGetter,null),_classPrivateFieldInitSpec$N(this,_debouncedSelect,new Map),_classPrivateFieldInitSpec$N(this,_hasSelectionChange,!1),_classPrivateFieldSet$L(_hot$2,this,s)}init(){var s=this;const c=_classPrivateFieldGet$N(_hot$2,this).getSettings();_classPrivateFieldSet$L(_focusMode,this,c.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL),_classPrivateFieldGet$N(_hot$2,this).addHook("afterUpdateSettings",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$14(_FocusGridManager_brand,s,_onUpdateSettings).call(s,...d)}),_classPrivateFieldGet$N(_hot$2,this).addHook("afterSelection",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$14(_FocusGridManager_brand,s,_onAfterSelectionChange).call(s,...d)}),_classPrivateFieldGet$N(_hot$2,this).addHook("afterSelectionFocusSet",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$14(_FocusGridManager_brand,s,_onAfterSelectionChange).call(s,...d)}),_classPrivateFieldGet$N(_hot$2,this).addHook("afterSelectionEnd",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$14(_FocusGridManager_brand,s,_focusEditorElement).call(s,...d)}),_classPrivateFieldGet$N(_hot$2,this).addHook("afterRender",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$14(_FocusGridManager_brand,s,_onAfterRender$2).call(s,...d)})}getFocusMode(){return _classPrivateFieldGet$N(_focusMode,this)}setFocusMode(s){Object.values(FOCUS_MODES).includes(s)?_classPrivateFieldSet$L(_focusMode,this,s):warn$1(`"${s}" is not a valid focus mode.`)}getRefocusDelay(){return _classPrivateFieldGet$N(_refocusDelay,this)}setRefocusDelay(s){_classPrivateFieldSet$L(_refocusDelay,this,s)}setRefocusElementGetter(s){_classPrivateFieldSet$L(_refocusElementGetter,this,s)}getRefocusElement(){var s;return typeof _classPrivateFieldGet$N(_refocusElementGetter,this)=="function"?_classPrivateFieldGet$N(_refocusElementGetter,this).call(this):(s=_classPrivateFieldGet$N(_hot$2,this).getActiveEditor())===null||s===void 0?void 0:s.TEXTAREA}focusOnHighlightedCell(s){const c=u=>{var d,h;const f=(d=_classPrivateFieldGet$N(_hot$2,this).getSelectedRangeActive())===null||d===void 0?void 0:d.highlight;if(!f)return;let g=_classPrivateFieldGet$N(_hot$2,this).runHooks("modifyFocusedElement",f.row,f.col,u);isHTMLElement(g)||(g=u),g&&!((h=_classPrivateFieldGet$N(_hot$2,this).getActiveEditor())!==null&&h!==void 0&&h.isOpened())&&g.focus({preventScroll:!0})};s?c(s):_assertClassBrand$14(_FocusGridManager_brand,this,_getSelectedCell).call(this,u=>c(u))}refocusToEditorTextarea(){var s;let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_classPrivateFieldGet$N(_refocusDelay,this);if(_classPrivateFieldGet$N(_hot$2,this).getSettings().imeFastEdit&&!((s=_classPrivateFieldGet$N(_hot$2,this).getActiveEditor())!==null&&s!==void 0&&s.isOpened())){var u,d;(u=_classPrivateFieldGet$N(_hot$2,this).getActiveEditor())===null||u===void 0||(d=u.refreshValue)===null||d===void 0||d.call(u),_classPrivateFieldGet$N(_debouncedSelect,this).has(c)||_classPrivateFieldGet$N(_debouncedSelect,this).set(c,debounce(()=>{if(!_classPrivateFieldGet$N(_hot$2,this).isDestroyed){var h;(h=this.getRefocusElement())===null||h===void 0||h.select()}},c)),_classPrivateFieldGet$N(_debouncedSelect,this).get(c)()}}}function _getSelectedCell(a){var s;const c=(s=_classPrivateFieldGet$N(_hot$2,this).getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;if(!c||!_classPrivateFieldGet$N(_hot$2,this).selection.isCellVisible(c)){a(null);return}const u=_classPrivateFieldGet$N(_hot$2,this).getCell(c.row,c.col,!0);u===null?_classPrivateFieldGet$N(_hot$2,this).addHookOnce("afterScroll",()=>{a(_classPrivateFieldGet$N(_hot$2,this).getCell(c.row,c.col,!0))}):a(u)}function _focusCell(){_assertClassBrand$14(_FocusGridManager_brand,this,_getSelectedCell).call(this,a=>{const{activeElement:s}=_classPrivateFieldGet$N(_hot$2,this).rootDocument;s&&isOutsideInput(s)&&s.blur(),this.focusOnHighlightedCell(a)})}function _focusEditorElement(){_assertClassBrand$14(_FocusGridManager_brand,this,_getSelectedCell).call(this,a=>{this.getFocusMode()===FOCUS_MODES.MIXED&&a?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function _onAfterSelectionChange(){_classPrivateFieldSet$L(_hasSelectionChange,this,!0)}function _onAfterRender$2(){_classPrivateFieldGet$N(_hasSelectionChange,this)&&(_classPrivateFieldSet$L(_hasSelectionChange,this,!1),_assertClassBrand$14(_FocusGridManager_brand,this,_focusCell).call(this))}function _onUpdateSettings(a){typeof a.imeFastEdit=="boolean"&&this.setFocusMode(a.imeFastEdit?FOCUS_MODES.MIXED:FOCUS_MODES.CELL)}function normalizeCoordsIfNeeded(a){return s=>{if(!s)return null;const{rowIndexMapper:c,columnIndexMapper:u}=a;if(c.isHidden(s.row)||u.isHidden(s.col))return null;const d=getMostTopStartPosition(a),h=getMostBottomEndPosition(a);return d===null||h===null?null:(s.row=clamp(s.row,d.row,h.row),s.col=clamp(s.col,d.col,h.col),s)}}function getMostTopStartPosition(a){const{rowIndexMapper:s,columnIndexMapper:c}=a,{navigableHeaders:u}=a.getSettings();let d=u&&a.countColHeaders()>0?-a.countColHeaders():0,h=u&&a.countRowHeaders()>0?-a.countRowHeaders():0;return d===0&&(d=s.getVisualFromRenderableIndex(d)),h===0&&(h=c.getVisualFromRenderableIndex(h)),d===null||h===null?null:a._createCellCoords(d,h)}function getMostBottomEndPosition(a){var s,c;const{rowIndexMapper:u,columnIndexMapper:d}=a,{navigableHeaders:h}=a.getSettings();let f=u.getRenderableIndexesLength()-1,g=d.getRenderableIndexesLength()-1;if(f<0){if(!h||a.countColHeaders()===0)return null;f=-1}if(g<0){if(!h||a.countColHeaders()===0)return null;g=-1}return a._createCellCoords((s=u.getVisualFromRenderableIndex(f))!==null&&s!==void 0?s:f,(c=d.getVisualFromRenderableIndex(g))!==null&&c!==void 0?c:g)}const GRID_GROUP="gridDefault",GRID_SCOPE="grid",GRID_TAB_NAVIGATION_GROUP="grid.tabNavigation",EDITOR_EDIT_GROUP="editorManager.handlingEditor",EDITOR_SCOPE="editor",command$F={name:"editorCloseAndSave",callback(a){a._getEditorManager().closeEditorAndSaveChanges()}},MIXIN_NAME="hooksRefRegisterer",hooksRefRegisterer={_hooksStorage:Object.create(null),addHook(a,s){return this._hooksStorage[a]||(this._hooksStorage[a]=[]),this.hot.addHook(a,s),this._hooksStorage[a].push(s),this},removeHooksByKey(a){arrayEach(this._hooksStorage[a]||[],s=>{this.hot.removeHook(a,s)})},clearHooks(){objectEach(this._hooksStorage,(a,s)=>this.removeHooksByKey(s)),this._hooksStorage={}}};defineGetter(hooksRefRegisterer,"MIXIN_NAME",MIXIN_NAME,{writable:!1,enumerable:!1});function _defineProperty$1h(a,s,c){return(s=_toPropertyKey$1i(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1i(a){var s=_toPrimitive$1i(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1i(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const EDITOR_TYPE$a="base",EDITOR_STATE=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$a}constructor(s){_defineProperty$1h(this,"hot",void 0),_defineProperty$1h(this,"state",EDITOR_STATE.VIRGIN),_defineProperty$1h(this,"_opened",!1),_defineProperty$1h(this,"_fullEditMode",!1),_defineProperty$1h(this,"_closeCallback",null),_defineProperty$1h(this,"TD",null),_defineProperty$1h(this,"row",null),_defineProperty$1h(this,"col",null),_defineProperty$1h(this,"prop",null),_defineProperty$1h(this,"originalValue",null),_defineProperty$1h(this,"cellProperties",null),this.hot=s,this.init()}_fireCallbacks(s){this._closeCallback&&(this._closeCallback(s),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(s,c,u,d,h,f){this.TD=d,this.row=s,this.col=c,this.prop=u,this.originalValue=h,this.cellProperties=f,this.state=this.isOpened()?this.state:EDITOR_STATE.VIRGIN}extend(){return class extends this.constructor{}}saveValue(s,c){let u,d,h,f;if(c){const m=this.hot.getSelectedRangeActive(),p=m.getTopStartCorner(),v=m.getBottomEndCorner();u=p.row,d=p.col,h=v.row,f=v.col}else[u,d,h,f]=[this.row,this.col,null,null];const g=this.hot.runHooks("modifyGetCellCoords",u,d,!1,"meta");Array.isArray(g)&&([u,d]=g),this.hot.populateFromArray(u,d,s,h,f,"edit")}beginEditing(s,c){if(this.state!==EDITOR_STATE.VIRGIN)return;const u=this.hot,d=u.rowIndexMapper.getRenderableFromVisualIndex(this.row),h=u.columnIndexMapper.getRenderableFromVisualIndex(this.col),f=()=>{if(this.state=EDITOR_STATE.EDITING,this.isInFullEditMode()){const m=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,p=typeof s=="string"?s:stringify$1(m);this.setValue(p)}this.open(c),this._opened=!0,this.focus(),u.view.render(),u.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",f),u.view.scrollViewport(u._createCellCoords(d,h))||(this.hot.removeHook("afterScroll",f),f()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(s,c,u){let d;if(u){const h=this._closeCallback;this._closeCallback=f=>{h&&h(f),u(f),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===EDITOR_STATE.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===EDITOR_STATE.EDITING){if(s){this.cancelChanges(),this.hot.view.render();return}const h=this.getValue();this.cellProperties.trimWhitespace?d=[[typeof h=="string"?String.prototype.trim.call(h||""):h]]:d=[[h]],this.state=EDITOR_STATE.WAITING,this.saveValue(d,c),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",f=>{this.state=EDITOR_STATE.FINISHED,this.discardEditor(f)}):(this.state=EDITOR_STATE.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=EDITOR_STATE.FINISHED,this.discardEditor()}discardEditor(s){this.state===EDITOR_STATE.FINISHED&&(s===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=EDITOR_STATE.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=EDITOR_STATE.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===EDITOR_STATE.WAITING}getEditedCellRect(){var s;const c=this.getEditedCell();if(!c)return;const{wtOverlays:u,wtViewport:d}=this.hot.view._wt,h=this.hot.rootWindow,f=offset(c),g=outerWidth(c),m=offset(this.hot.rootElement),p=outerWidth(this.hot.rootElement),v=u.topOverlay.holder,w=u.inlineStartOverlay.holder,E=v!==h?v.scrollTop:0,C=w!==h?w.scrollLeft:0,b=h.innerWidth-m.left-p,{wtTable:P}=(s=u.getParentOverlay(c))!==null&&s!==void 0?s:this.hot.view._wt,R=P.name,T=["master","inline_start"].includes(R)?E:0,I=["master","top","bottom"].includes(R)?C:0,M=f.top===m.top?0:1;let N=f.top-m.top-M-T,H=0;this.hot.isRtl()?H=h.innerWidth-f.left-g-b-1+I:H=f.left-m.left-1-I,["top","top_inline_start_corner"].includes(R)&&(N+=u.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(R)&&(H+=Math.abs(u.inlineStartOverlay.getOverlayOffset()));const L=this.hot.hasColHeaders(),A=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),k=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),G=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(L&&A<=0||A===G)&&(N+=1),k<=0&&(H+=1);const oe=d.rowsRenderCalculator.startPosition,ae=d.columnsRenderCalculator.startPosition,X=Math.abs(u.inlineStartOverlay.getScrollPosition()),le=u.topOverlay.getScrollPosition(),ye=getScrollbarWidth(this.hot.rootDocument);let pe=c.offsetTop;if(["inline_start","master"].includes(R)&&(pe+=oe-le),["bottom","bottom_inline_start_corner"].includes(R)){const{wtViewport:ce,wtTable:ve}=u.bottomOverlay.clone;pe+=ce.getWorkspaceHeight()-ve.getHeight()-ye}let he=c.offsetLeft;this.hot.isRtl()?(he>=0?he=P.getWidth()-c.offsetLeft:he=Math.abs(he),he+=ae-X-g):["top","master","bottom"].includes(R)&&(he+=ae-X);const Me=h.getComputedStyle(this.TD),Qe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",Xe=parseInt(Me[Qe],10)>0?0:1,Ke=parseInt(Me.borderTopWidth,10)>0?0:1,it=outerWidth(c)+Xe,te=outerHeight(c)+Ke,Pe=hasVerticalScrollbar(v)?ye:0,U=hasHorizontalScrollbar(w)?ye:0,Q=this.hot.view.maximumVisibleElementWidth(he)-Pe+Xe,ee=Math.max(this.hot.view.maximumVisibleElementHeight(pe)-U+Ke,this.hot.stylesHandler.getDefaultRowHeight());return{top:N,start:H,height:te,maxHeight:ee,width:it,maxWidth:Q}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const s=this.hot.countRows();let c="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?c="top-inline-start-corner":c="top":this.hot.getSettings().fixedRowsBottom&&this.row>=s-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?c="bottom-inline-start-corner":c="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(c="inline-start"),c}}mixin(BaseEditor,hooksRefRegisterer);const command$E={name:"editorCloseAndSaveByArrowKeys",callback(a,s,c){const u=a._getEditorManager(),d=u.getActiveEditor();d.isInFullEditMode()&&d.state===EDITOR_STATE.EDITING||(u.closeEditorAndSaveChanges(),a.getSelected()&&(c.includes("arrowdown")?a.selection.transformStart(1,0):c.includes("arrowup")?a.selection.transformStart(-1,0):c.includes("arrowleft")?a.selection.transformStart(0,-1*a.getDirectionFactor()):c.includes("arrowright")&&a.selection.transformStart(0,a.getDirectionFactor())),s.preventDefault())}},command$D={name:"editorCloseAndSaveByEnter",callback(a,s){const c=a._getEditorManager();c.closeEditorAndSaveChanges(s.ctrlKey||s.metaKey),c.moveSelectionAfterEnter(s)}},command$C={name:"editorCloseWithoutSaving",callback(a){const s=a._getEditorManager();s.closeEditorAndRestoreOriginalValue(a.getShortcutManager().isCtrlPressed()),s.activeEditor.focus()}},command$B={name:"editorFastOpen",callback(a,s){const{highlight:c}=a.getSelectedRangeActive();c.isHeader()||a._getEditorManager().openEditor(null,s,!0)}},command$A={name:"editorOpen",callback(a,s,c){const{selection:u}=a,d=a._getEditorManager(),h=a.getSelectedRange(),f=a.getSelectedRangeActive(),{highlight:g}=f;if((h.some(m=>u.isMultiple(m))||h.length>1)&&!f.isHeader()&&a.countRenderedCols()>0&&a.countRenderedRows()>0){const m=a.getSettings(),p=typeof m.enterMoves=="function"?m.enterMoves(s):m.enterMoves;c.includes("shift")?u.transformFocus(-p.row,-p.col):u.transformFocus(p.row,p.col);return}g.isHeader()||(a.getSettings().enterBeginsEditing?d.cellProperties.readOnly?d.moveSelectionAfterEnter(s):d.openEditor(null,s,!0):d.moveSelectionAfterEnter(s),stopImmediatePropagation(s))}};function getAllCommands$2(){return[command$F,command$E,command$D,command$C,command$B,command$A]}const command$z={name:"extendCellsSelectionDown",callback(a){const{selection:s}=a,{highlight:c}=a.getSelectedRangeActive();!s.isSelectedByColumnHeader()&&!s.isSelectedByCorner()&&(c.isCell()||c.isHeader()&&s.isSelectedByRowHeader())&&(s.markSource("keyboard"),s.transformEnd(1,0),s.markEndSource())}},command$y={name:"extendCellsSelectionDownByViewportHeight",callback(a){const{selection:s,rowIndexMapper:c}=a,{to:u}=a.getSelectedRangeActive(),d=Math.min(u.row+a.countVisibleRows(),a.countRows()-1),h=c.getNearestNotHiddenIndex(d,-1);if(h!==null){const f=a._createCellCoords(h,u.col),g=u.row-a.getFirstFullyVisibleRow(),m=Math.min(f.row-g,a.countRows()-1);s.markSource("keyboard"),s.setRangeEnd(f,a.getActiveSelectionLayerIndex()),s.markEndSource(),a.scrollViewportTo({row:m,verticalSnap:"top",horizontalSnap:"start"})}}},command$x={name:"extendCellsSelectionLeft",callback(a){const{selection:s}=a,{highlight:c}=a.getSelectedRangeActive();!s.isSelectedByRowHeader()&&!s.isSelectedByCorner()&&(c.isCell()||c.isHeader()&&s.isSelectedByColumnHeader())&&(s.markSource("keyboard"),s.transformEnd(0,-1*a.getDirectionFactor()),s.markEndSource())}},command$w={name:"extendCellsSelectionRight",callback(a){const{selection:s}=a,{highlight:c}=a.getSelectedRangeActive();!s.isSelectedByRowHeader()&&!s.isSelectedByCorner()&&(c.isCell()||c.isHeader()&&s.isSelectedByColumnHeader())&&(s.markSource("keyboard"),s.transformEnd(0,a.getDirectionFactor()),s.markEndSource())}},command$v={name:"extendCellsSelectionToColumns",callback(a){const{selection:s}=a,{highlight:c,from:u,to:d}=a.getSelectedRangeActive();s.markSource("keyboard"),s.isSelectedByRowHeader()?s.selectAll(!0,!0):a.selectColumns(u.col,d.col,c),s.markEndSource()}},command$u={name:"extendCellsSelectionToMostBottom",callback(a){const{selection:s,rowIndexMapper:c}=a,{highlight:u,from:d,to:h}=a.getSelectedRangeActive(),f=u.isHeader()&&s.isSelectedByRowHeader();if(u.isCell()||f){const g=c.getNearestNotHiddenIndex(a.countRows()-1,-1),m=d.clone();m.row=u.row,s.markSource("keyboard"),s.setRangeStart(m,void 0,!1,u.clone()),f&&s.selectedByRowHeader.add(s.getLayerLevel()),s.setRangeEnd(a._createCellCoords(g,h.col)),s.markEndSource()}}},command$t={name:"extendCellsSelectionToMostInlineEnd",callback(a){const{selection:s,columnIndexMapper:c}=a,{highlight:u,from:d,to:h}=a.getSelectedRangeActive();if(!s.isSelectedByRowHeader()&&!s.isSelectedByCorner()&&u.isCell()){const f=c.getNearestNotHiddenIndex(a.countCols()-1,-1),g=d.clone();g.col=u.col,s.markSource("keyboard"),s.setRangeStart(g,void 0,!1,u.clone()),s.setRangeEnd(a._createCellCoords(h.row,f)),s.markEndSource()}}},command$s={name:"extendCellsSelectionToMostInlineStart",callback(a){const{selection:s,columnIndexMapper:c}=a,{highlight:u,from:d,to:h}=a.getSelectedRangeActive();if(!s.isSelectedByRowHeader()&&!s.isSelectedByCorner()&&u.isCell()){const f=parseInt(a.getSettings().fixedColumnsStart,10),g=c.getNearestNotHiddenIndex(f,1),m=d.clone();m.col=u.col,s.markSource("keyboard"),s.setRangeStart(m,void 0,!1,u.clone()),s.setRangeEnd(a._createCellCoords(h.row,g)),s.markEndSource()}}},command$r={name:"extendCellsSelectionToMostLeft",callback(a){const{selection:s,columnIndexMapper:c}=a,{highlight:u,from:d,to:h}=a.getSelectedRangeActive(),f=u.isHeader()&&s.isSelectedByColumnHeader();if(u.isCell()||f){const g=c.getNearestNotHiddenIndex(...a.isRtl()?[a.countCols()-1,-1]:[0,1]),m=d.clone();m.col=u.col,s.markSource("keyboard"),s.setRangeStart(m,void 0,!1,u.clone()),f&&s.selectedByColumnHeader.add(s.getLayerLevel()),s.setRangeEnd(a._createCellCoords(h.row,g)),s.markEndSource()}}},command$q={name:"extendCellsSelectionToMostRight",callback(a){const{selection:s,columnIndexMapper:c}=a,{highlight:u,from:d,to:h}=a.getSelectedRangeActive(),f=u.isHeader()&&s.isSelectedByColumnHeader();if(u.isCell()||f){const g=c.getNearestNotHiddenIndex(...a.isRtl()?[0,1]:[a.countCols()-1,-1]),m=d.clone();m.col=u.col,s.markSource("keyboard"),s.setRangeStart(m,void 0,!1,u.clone()),f&&s.selectedByColumnHeader.add(s.getLayerLevel()),s.setRangeEnd(a._createCellCoords(h.row,g)),s.markEndSource()}}},command$p={name:"extendCellsSelectionToMostTop",callback(a){const{selection:s,rowIndexMapper:c}=a,{highlight:u,from:d,to:h}=a.getSelectedRangeActive(),f=u.isHeader()&&s.isSelectedByRowHeader();if(u.isCell()||f){const g=c.getNearestNotHiddenIndex(0,1),m=d.clone();m.row=u.row,s.markSource("keyboard"),s.setRangeStart(m,void 0,!1,u.clone()),f&&s.selectedByRowHeader.add(s.getLayerLevel()),s.setRangeEnd(a._createCellCoords(g,h.col)),s.markEndSource()}}},command$o={name:"extendCellsSelectionToRows",callback(a){const{selection:s}=a,{highlight:c,from:u,to:d}=a.getSelectedRangeActive();s.markSource("keyboard"),s.isSelectedByColumnHeader()?s.selectAll(!0,!0):a.selectRows(u.row,d.row,c),s.markEndSource()}},command$n={name:"extendCellsSelectionUp",callback(a){const{selection:s}=a,{highlight:c}=a.getSelectedRangeActive();!s.isSelectedByColumnHeader()&&!s.isSelectedByCorner()&&(c.isCell()||c.isHeader()&&s.isSelectedByRowHeader())&&(s.markSource("keyboard"),s.transformEnd(-1,0),s.markEndSource())}},command$m={name:"extendCellsSelectionUpByViewportHeight",callback(a){const{selection:s,rowIndexMapper:c}=a,{to:u}=a.getSelectedRangeActive(),d=Math.max(u.row-a.countVisibleRows(),0),h=c.getNearestNotHiddenIndex(d,1);if(h!==null){const f=a._createCellCoords(h,u.col),g=u.row-a.getFirstFullyVisibleRow(),m=Math.max(f.row-g,0);s.markSource("keyboard"),s.setRangeEnd(f,a.getActiveSelectionLayerIndex()),s.markEndSource(),a.scrollViewportTo({row:m,verticalSnap:"top",horizontalSnap:"start"})}}};function getAllCommands$1(){return[command$z,command$y,command$x,command$w,command$v,command$u,command$t,command$s,command$r,command$q,command$p,command$o,command$n,command$m]}const command$l={name:"moveCellSelectionDown",callback(a){let{selection:s}=a;s.markSource("keyboard"),s.transformStart(1,0),s.markEndSource()}},command$k={name:"moveCellSelectionDownByViewportHeight",callback(a){const{selection:s}=a,{navigableHeaders:c}=a.getSettings(),u=c?a.countColHeaders():0,{row:d}=a.getSelectedRangeActive().highlight;let h=a.countVisibleRows()+u;h=h===0?1:h,d===a.countRows()-1?h=1:d+h>a.countRows()&&(h=a.countRows()-d-1),s.markSource("keyboard"),s.transformStart(h,0),s.markEndSource(),a.getSelectedRangeActive().highlight.row<0&&a.scrollViewportTo({row:0})}},command$j={name:"moveCellSelectionInlineEnd",callback(a,s){const{selection:c}=a,u=a.getSettings(),d=a.getSelectedRange(),h=a.getSelectedRangeActive(),f=typeof u.tabMoves=="function"?u.tabMoves(s):u.tabMoves;c.markSource("keyboard"),(d.some(g=>c.isMultiple(g))||d.length>1)&&!h.isHeader()&&a.countRenderedCols()>0&&a.countRenderedRows()>0?c.transformFocus(-f.row,-f.col):c.transformStart(-f.row,-f.col),c.markEndSource()}},command$i={name:"moveCellSelectionInlineStart",callback(a,s){const{selection:c}=a,u=a.getSettings(),d=a.getSelectedRange(),h=a.getSelectedRangeActive(),f=typeof u.tabMoves=="function"?u.tabMoves(s):u.tabMoves;c.markSource("keyboard"),(d.some(g=>c.isMultiple(g))||d.length>1)&&!h.isHeader()&&a.countRenderedCols()>0&&a.countRenderedRows()>0?c.transformFocus(f.row,f.col):c.transformStart(f.row,f.col),c.markEndSource()}},command$h={name:"moveCellSelectionLeft",callback(a){const{selection:s}=a;s.markSource("keyboard"),s.transformStart(0,-1*a.getDirectionFactor()),s.markEndSource()}},command$g={name:"moveCellSelectionRight",callback(a){const{selection:s}=a;s.markSource("keyboard"),s.transformStart(0,a.getDirectionFactor()),s.markEndSource()}},command$f={name:"moveCellSelectionToMostBottom",callback(a){const{selection:s}=a,{col:c}=a.getSelectedRangeActive().highlight;let u=a.rowIndexMapper.getNearestNotHiddenIndex(a.countRows()-1,-1);u===null&&(u=-1),s.setRangeStart(a._createCellCoords(u,c))}},command$e={name:"moveCellSelectionToMostBottomInlineEnd",callback(a){const{selection:s,rowIndexMapper:c,columnIndexMapper:u}=a,d=parseInt(a.getSettings().fixedRowsBottom,10),h=c.getNearestNotHiddenIndex(a.countRows()-d-1,-1),f=u.getNearestNotHiddenIndex(a.countCols()-1,-1);s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(h,f)),s.markEndSource()}},command$d={name:"moveCellSelectionToMostInlineEnd",callback(a){const{selection:s,columnIndexMapper:c}=a;s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(a.getSelectedRangeActive().highlight.row,c.getNearestNotHiddenIndex(a.countCols()-1,-1))),s.markEndSource()}},command$c={name:"moveCellSelectionToMostInlineStart",callback(a){const{selection:s,columnIndexMapper:c}=a,u=parseInt(a.getSettings().fixedColumnsStart,10),d=a.getSelectedRangeActive().highlight.row,h=c.getNearestNotHiddenIndex(u,1);s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(d,h)),s.markEndSource()}},command$b={name:"moveCellSelectionToMostLeft",callback(a){const{selection:s,columnIndexMapper:c}=a,u=a.getSelectedRangeActive().highlight.row;let d=c.getNearestNotHiddenIndex(...a.isRtl()?[a.countCols()-1,-1]:[0,1]);d===null&&(d=a.isRtl()?-1:-a.countRowHeaders()),s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(u,d)),s.markEndSource()}},command$a={name:"moveCellSelectionToMostRight",callback(a){const{selection:s,columnIndexMapper:c}=a,{row:u}=a.getSelectedRangeActive().highlight;let d=c.getNearestNotHiddenIndex(...a.isRtl()?[0,1]:[a.countCols()-1,-1]);d===null&&(d=a.isRtl()?-a.countRowHeaders():-1),s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(u,d)),s.markEndSource()}},command$9={name:"moveCellSelectionToMostTop",callback(a){const{selection:s}=a,{col:c}=a.getSelectedRangeActive().highlight;let u=a.rowIndexMapper.getNearestNotHiddenIndex(0,1);u===null&&(u=-a.countColHeaders()),s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(u,c)),s.markEndSource()}},command$8={name:"moveCellSelectionToMostTopInlineStart",callback(a){const{selection:s,rowIndexMapper:c,columnIndexMapper:u}=a,d=parseInt(a.getSettings().fixedRowsTop,10),h=parseInt(a.getSettings().fixedColumnsStart,10),f=c.getNearestNotHiddenIndex(d,1),g=u.getNearestNotHiddenIndex(h,1);s.markSource("keyboard"),s.setRangeStart(a._createCellCoords(f,g)),s.markEndSource()}},command$7={name:"moveCellSelectionUp",callback(a){let{selection:s}=a;s.markSource("keyboard"),s.transformStart(-1,0),s.markEndSource()}},command$6={name:"moveCellSelectionUpByViewportHight",callback(a){const{selection:s}=a,{navigableHeaders:c}=a.getSettings(),u=c?a.countColHeaders():0,{row:d}=a.getSelectedRangeActive().highlight;let h=a.countVisibleRows()+u;h=h===0?-1:-h,d===-u?h=-1:d+h<u&&(h=-(d+u)),s.markSource("keyboard"),s.transformStart(h,0),s.markEndSource(),a.getSelectedRangeActive().highlight.row<0&&a.scrollViewportTo({row:0})}};function getAllCommands(){return[command$l,command$k,command$j,command$i,command$h,command$g,command$f,command$e,command$d,command$c,command$b,command$a,command$9,command$8,command$7,command$6]}const command$5={name:"emptySelectedCells",callback(a){a.emptySelectedCells(),a._getEditorManager().prepareEditor()}},command$4={name:"scrollToFocusedCell",callback(a){const{highlight:s}=a.getSelectedRangeActive(),c=a.getFirstFullyVisibleRow()-1,u=a.getFirstFullyVisibleColumn()-1,d=a.getLastFullyVisibleRow()+1,h=a.getLastFullyVisibleColumn()+1,f=a._createCellCoords(c,u),g=a._createCellCoords(d,h);if(!a._createCellRange(f,f,g).includes(s)&&(s.row>=0||s.col>=0)){const p={};if(s.col>=0){const v=Math.floor(a.countVisibleCols()/2);p.col=Math.max(s.col-v,0)}if(s.row>=0){const v=Math.floor(a.countVisibleRows()/2);p.row=Math.max(s.row-v,0)}a.scrollViewportTo({...p,verticalSnap:"top",horizontalSnap:"start"})}}},command$3={name:"selectAllCells",callback(a){let{selection:s}=a;s.markSource("keyboard"),s.selectAll(!0,!0,{disableHeadersHighlight:!0}),s.markEndSource()}},command$2={name:"selectAllCellsAndHeaders",callback(a){let{selection:s}=a;s.markSource("keyboard"),s.selectAll(!0,!0,{disableHeadersHighlight:!1}),s.markEndSource()}},command$1={name:"populateSelectedCellsData",callback(a){const s=a.getSelectedRange(),{row:c,col:u}=s[s.length-1].highlight.normalize(),d=a.getDataAtCell(c,u),h=new Map;for(let f=0;f<s.length;f++)s[f].forAll((g,m)=>{if(g>=0&&m>=0&&(g!==c||m!==u)){const{readOnly:p}=a.getCellMeta(g,m);p||h.set(`${g}x${m}`,[g,m,d])}});a.setDataAtCell(Array.from(h.values()))}},command={name:"tabNavigation",callback(a){const s={wrapped:!1,flipped:!1};let c=!1,u=!1;return a.addHook("afterSelection",(d,h,f,g,m)=>{c&&(s.wrapped&&s.flipped||u)&&(u=!1,m.value=!0)}),a.addHook("beforeRowWrap",(d,h,f)=>{s.wrapped=!0,s.flipped=f}),{before(){const{tabNavigation:d}=a.getSettings();c=!0,d||(u=!0)},after(d){const{tabNavigation:h,autoWrapRow:f}=a.getSettings();if(c=!1,!h||!a.selection.isSelected()||f&&s.wrapped&&s.flipped||!f&&s.wrapped)return s.wrapped=!1,s.flipped=!1,a.deselectCell(),!1;d.preventDefault()}}}},allCommands=[...getAllCommands$2(),...getAllCommands$1(),...getAllCommands(),command$5,command$4,command$3,command$2,command$1,command];function createKeyboardShortcutCommandsPool(a){const s={};return allCommands.forEach(c=>{let{name:u,callback:d}=c;s[u]=function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return d(a,...f)}}),s}function shortcutsEditorContext(a){const s=a.getShortcutManager().addContext(EDITOR_SCOPE),c=createKeyboardShortcutCommandsPool(a),u={group:EDITOR_EDIT_GROUP};s.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(d,h)=>c.editorCloseAndSaveByEnter(d,h)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(d,h)=>c.editorCloseAndSaveByEnter(d,h)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:a.getShortcutManager().getContext(GRID_SCOPE),callback:(d,h)=>c.editorCloseAndSave(d,h)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(d,h)=>c.editorCloseAndSaveByArrowKeys(d,h)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>c.editorCloseWithoutSaving()}],u)}function shortcutsGridContext(a){const s=a.getShortcutManager().addContext(GRID_SCOPE),c=createKeyboardShortcutCommandsPool(a),u={runOnlyIf:()=>{const{navigableHeaders:h}=a.getSettings();return isDefined(a.getSelected())&&(h||!h&&a.countRenderedRows()>0&&a.countRenderedCols()>0)},group:GRID_GROUP};s.addShortcuts([{keys:[["F2"]],callback:h=>c.editorFastOpen(h)},{keys:[["Enter"],["Enter","Shift"]],callback:(h,f)=>c.editorOpen(h,f)},{keys:[["Backspace"],["Delete"]],callback:()=>c.emptySelectedCells()}],{group:EDITOR_EDIT_GROUP,runOnlyIf:()=>isDefined(a.getSelected())}),s.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>c.selectAllCells(),runOnlyIf:()=>{var h;return!((h=a.getSelectedRangeActive())!==null&&h!==void 0&&h.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var h;return(h=a.getSelectedRangeActive())===null||h===void 0?void 0:h.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>c.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>c.populateSelectedCellsData(),runOnlyIf:()=>{var h,f;return!((h=a.getSelectedRangeActive())!==null&&h!==void 0&&h.highlight.isHeader())&&((f=a.getSelectedRangeActive())===null||f===void 0?void 0:f.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>c.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>c.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>c.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>c.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>c.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>c.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>c.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>c.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(a.selection.isSelectedByCorner()||a.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>c.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>c.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>c.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>c.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>c.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>c.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(a.selection.isSelectedByCorner()||a.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>a.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>c.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>a.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>a.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>c.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>c.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>a.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>c.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>c.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>c.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>c.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:h=>c.moveCellSelectionInlineStart(h)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:h=>c.moveCellSelectionInlineEnd(h)},{keys:[["Control/Meta","Backspace"]],callback:()=>c.scrollToFocusedCell()}],u);const d=c.tabNavigation();s.addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:GRID_TAB_NAVIGATION_GROUP,position:"before",callback:h=>d.before(h)},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:GRID_TAB_NAVIGATION_GROUP,callback:h=>d.after(h),position:"after"}])}function registerAllShortcutContexts(a){[shortcutsGridContext,shortcutsEditorContext].forEach(s=>s(a))}function focusGridScope(a){var s;const c=normalizeCoordsIfNeeded(a),u={wrapped:!1,flipped:!1};let d,h=!0,f=!1;a.addHook("afterSelection",()=>{if(h){var p;d=(p=a.getSelectedRangeActive())===null||p===void 0?void 0:p.highlight}}),a.addHook("beforeRowWrap",(p,v,w)=>{u.wrapped=!0,u.flipped=w}),a.addHook("beforeEmptyDataStateShow",()=>{f=!0}),a.addHook("beforeEmptyDataStateHide",()=>{f=!1}),a.getShortcutManager().getContext(GRID_SCOPE).addShortcuts([{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:GRID_TAB_NAVIGATION_GROUP,position:"before",callback(){const{tabNavigation:p}=a.getSettings();a.getSelectedRangeActive()&&!p&&(h=!1)}},{keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:GRID_GROUP,group:GRID_TAB_NAVIGATION_GROUP,callback(p){const{tabNavigation:v,autoWrapRow:w}=a.getSettings();h=!0,(!v||!a.selection.isSelected()||w&&u.wrapped&&u.flipped||!w&&u.wrapped)&&(w&&u.wrapped&&u.flipped&&(d=p.shiftKey?getMostTopStartPosition(a):getMostBottomEndPosition(a)),u.wrapped=!1,u.flipped=!1)},position:"after"}]);const m=(s=a.rootGridElement)!==null&&s!==void 0?s:a.rootElement;a.getFocusScopeManager().registerScope("grid",m,{contains:p=>m===p||m.contains(p)?!0:p.closest(".htMenu")!==null?!1:a.rootPortalElement.contains(p),runOnlyIf:()=>{const{navigableHeaders:p}=a.getSettings();return(f||!p)&&a.countRenderedRows()===0&&a.countRenderedCols()===0&&a.countRowHeaders()>0&&a.countColHeaders()>0?!1:!p&&a.countRenderedRows()>0&&a.countRenderedCols()>0||p&&(a.countRowHeaders()>0||a.countColHeaders()>0)},onActivate:p=>{if(p==="tab_from_above"){var v;const E=(v=c(d))!==null&&v!==void 0?v:getMostTopStartPosition(a);E&&a.runHooks("modifyFocusOnTabNavigation","from_above",E)!==!1&&a.selectCell(E.row,E.col)}else if(p==="tab_from_below"){var w;const E=(w=c(d))!==null&&w!==void 0?w:getMostBottomEndPosition(a);E&&a.runHooks("modifyFocusOnTabNavigation","from_below",E)!==!1&&a.selectCell(E.row,E.col)}}})}function registerAllFocusScopes(a){[focusGridScope].forEach(s=>s(a))}const mappings=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),normalizeKeys=a=>a.map(s=>{const c=s.toLowerCase();return mappings.has(c)?mappings.get(c):c}).sort().join("+"),getKeysList=a=>a.split("+"),specialCharactersSet=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),normalizeEventKey=a=>{let{which:s,key:c}=a;if(specialCharactersSet.has(s))return specialCharactersSet.get(s);const u=String.fromCharCode(s).toLowerCase();return/^[a-z0-9]$/.test(u)?u:c.toLowerCase()},__kindOf=Symbol("shortcut-context");function isContextObject(a){return isObject(a)&&a.__kindOf===__kindOf}const createContext=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const c=createUniqueMap({errorIdExists:p=>`The "${p}" shortcut is already registered in the "${a}" context.`}),u=function(){let{keys:p,callback:v,group:w,runOnlyIf:E=()=>!0,captureCtrl:C=!1,preventDefault:b=!0,stopPropagation:P=!1,relativeToGroup:R,position:T,forwardToContext:I}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(isUndefined(w))throw new Error("You need to define the shortcut's group.");if(isFunction(v)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(p)===!1)throw new Error(toSingleLine`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const M={callback:v,group:w,runOnlyIf:E,captureCtrl:C,preventDefault:b,stopPropagation:P};isDefined(R)&&(M.relativeToGroup=R,M.position=T),isContextObject(I)&&(M.forwardToContext=I),p.forEach(N=>{const H=normalizeKeys(N);if(c.hasItem(H)){const A=c.getItem(H);let k=A.findIndex(W=>W.group===R);k!==-1?T==="before"?k-=1:k+=1:k=A.length,A.splice(k,0,M)}else c.addItem(H,[M])})},d=function(p){let v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};p.forEach(w=>{objectEach(v,(E,C)=>{Object.prototype.hasOwnProperty.call(w,C)===!1&&(w[C]=v[C])}),u(w)})},h=p=>{const v=normalizeKeys(p);c.removeItem(v)};return{__kindOf,scope:s,addShortcut:u,addShortcuts:d,getShortcuts:p=>{const v=normalizeKeys(p),w=c.getItem(v);return isDefined(w)?w.slice():[]},hasShortcut:p=>{const v=normalizeKeys(p);return c.hasItem(v)},removeShortcutsByKeys:h,removeShortcutsByGroup:p=>{c.getItems().forEach(w=>{let[E,C]=w;const b=C.filter(P=>P.group!==p);b.length===0?h(getKeysList(E)):(C.length=0,C.push(...b))})}}};function createKeysObserver(){const a=new Set;return{press(s){a.add(s)},release(s){a.delete(s)},releaseAll(){a.clear()},isPressed(s){return a.has(s)}}}const MODIFIER_KEYS=["meta","alt","shift","control"],modifierKeysObserver=createKeysObserver(),modKeyListeners=[];let instanceCounter=0;function useRecorder(a,s,c,u,d){const h=C=>MODIFIER_KEYS.includes(C),f=function(C){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const P=[];return C.altKey&&P.push("alt"),b&&(C.ctrlKey||C.metaKey)?P.push("control/meta"):(C.ctrlKey&&P.push("control"),C.metaKey&&P.push("meta")),C.shiftKey&&P.push("shift"),P},g=C=>{if(s(C)===!1||c(C)===!1||C.keyCode===229||typeof C.key!="string"||isImmediatePropagationStopped(C))return;const P=normalizeEventKey(C);let R=[];h(P)||(R=f(C));const T=[P].concat(R);!d(C,T)&&(isMacOS()&&R.includes("meta")||!isMacOS()&&R.includes("control"))&&d(C,[P].concat(f(C,!0))),u(C)},m=C=>{if(typeof C.key=="string"){const b=normalizeEventKey(C);h(b)&&modifierKeysObserver.press(b)}},p=C=>{if(typeof C.key=="string"){const b=normalizeEventKey(C);h(b)&&modifierKeysObserver.release(b)}},v=()=>{modifierKeysObserver.releaseAll()};return{mount:()=>{let C=a;for(instanceCounter+=1;C;)instanceCounter===1&&(C.document.documentElement.addEventListener("keydown",m),modKeyListeners.push({event:"keydown",listener:m}),C.document.documentElement.addEventListener("keyup",p),modKeyListeners.push({event:"keyup",listener:p})),C.document.documentElement.addEventListener("keydown",g),C.document.documentElement.addEventListener("blur",v),C=getParentWindow(C)},unmount:()=>{let C=a;for(instanceCounter-=1;C;){if(instanceCounter===0){for(let b=0;b<modKeyListeners.length;b++){const{event:P,listener:R}=modKeyListeners[b];C.document.documentElement.removeEventListener(P,R)}modKeyListeners.length=0}C.document.documentElement.removeEventListener("keydown",g),C.document.documentElement.removeEventListener("blur",v),C=getParentWindow(C)}},isPressed:C=>modifierKeysObserver.isPressed(C),releasePressedKeys:()=>modifierKeysObserver.releaseAll()}}const createShortcutManager=a=>{let{ownerWindow:s,handleEvent:c,beforeKeyDown:u,afterKeyDown:d}=a;const h=createUniqueMap({errorIdExists:R=>`The "${R}" context name is already registered.`});let f="grid";const g=function(R){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const I=createContext(R,T);return h.addItem(R,I),I},m=()=>f,p=R=>h.getItem(R),v=function(R){var T;let I=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";return(T=p(R))!==null&&T!==void 0?T:g(R,I)},w=R=>{if(!h.hasItem(R))throw new Error(toSingleLine`You've tried to activate the "${R}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);f=R};let E=!1;const C=function(R,T){let I=arguments.length>2&&arguments[2]!==void 0?arguments[2]:m();const M=isContextObject(I)?I:p(I);let N=!1;if(!M.hasShortcut(T))return N;const H=M.getShortcuts(T);for(let L=0;L<H.length;L++){const{callback:A,runOnlyIf:k,preventDefault:W,stopPropagation:G,captureCtrl:oe,forwardToContext:ae}=H[L];if(k(R)===!0){if(E=oe,N=A(R,T)===!1,E=!1,W&&R.preventDefault(),G&&(stopImmediatePropagation(R),R.stopPropagation()),N)break;ae&&C(R,T,ae)}}return N},P=useRecorder(s,R=>{const T=m(),I=isContextObject(T)?T:p(T);return c(R,I.scope)},u,d,C);return P.mount(),{addContext:g,getActiveContextName:m,getContext:p,getOrCreateContext:v,setActiveContextName:w,isCtrlPressed:()=>!E&&(P.isPressed("control")||P.isPressed("meta")),releasePressedKeys:()=>P.releasePressedKeys(),destroy:()=>P.unmount()}};function getThemeClassName(a){const{classNames:s}=findFirstParentWithClass(a,/ht-theme-[a-zA-Z0-9_-]+/);return s.pop()}function _classPrivateMethodInitSpec$R(a,s){_checkPrivateRedeclaration$13(a,s),s.add(a)}function _classPrivateFieldInitSpec$M(a,s,c){_checkPrivateRedeclaration$13(a,s),s.set(a,c)}function _checkPrivateRedeclaration$13(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$M(a,s){return a.get(_assertClassBrand$13(a,s))}function _classPrivateFieldSet$K(a,s,c){return a.set(_assertClassBrand$13(a,s),c),c}function _assertClassBrand$13(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const CLASSIC_THEME_DEFAULT_HEIGHT=23;var _hot$1=new WeakMap,_themeName$1=new WeakMap,_rootElement$3=new WeakMap,_rootComputedStyle=new WeakMap,_rootDocument$2=new WeakMap,_isClassicTheme=new WeakMap,_cssVars=new WeakMap,_computedStyles=new WeakMap,_onThemeChange=new WeakMap,_StylesHandler_brand=new WeakSet;class StylesHandler{constructor(s){let{hot:c,rootElement:u,rootDocument:d,onThemeChange:h=()=>{}}=s;_classPrivateMethodInitSpec$R(this,_StylesHandler_brand),_classPrivateFieldInitSpec$M(this,_hot$1,void 0),_classPrivateFieldInitSpec$M(this,_themeName$1,void 0),_classPrivateFieldInitSpec$M(this,_rootElement$3,void 0),_classPrivateFieldInitSpec$M(this,_rootComputedStyle,void 0),_classPrivateFieldInitSpec$M(this,_rootDocument$2,void 0),_classPrivateFieldInitSpec$M(this,_isClassicTheme,!0),_classPrivateFieldInitSpec$M(this,_cssVars,{}),_classPrivateFieldInitSpec$M(this,_computedStyles,{}),_classPrivateFieldInitSpec$M(this,_onThemeChange,void 0),_classPrivateFieldSet$K(_hot$1,this,c),_classPrivateFieldSet$K(_rootElement$3,this,u),_classPrivateFieldSet$K(_rootDocument$2,this,d),_classPrivateFieldSet$K(_onThemeChange,this,h)}isClassicTheme(){return _classPrivateFieldGet$M(_isClassicTheme,this)}getCSSVariableValue(s){var c;if(_classPrivateFieldGet$M(_isClassicTheme,this))return null;if(_classPrivateFieldGet$M(_cssVars,this)[`--ht-${s}`])return _classPrivateFieldGet$M(_cssVars,this)[`--ht-${s}`];const u=(c=_assertClassBrand$13(_StylesHandler_brand,this,_getParsedNumericCSSValue).call(this,`--ht-${s}`))!==null&&c!==void 0?c:_assertClassBrand$13(_StylesHandler_brand,this,_getCSSValue).call(this,`--ht-${s}`);if(u!==null)return _classPrivateFieldGet$M(_cssVars,this)[`--ht-${s}`]=u,u}getStyleForTD(s){var c;return(c=_classPrivateFieldGet$M(_computedStyles,this))===null||c===void 0?void 0:c.td[s]}getDefaultRowHeight(s){if(_classPrivateFieldGet$M(_isClassicTheme,this))return CLASSIC_THEME_DEFAULT_HEIGHT;const c=_assertClassBrand$13(_StylesHandler_brand,this,_calculateRowHeight).call(this);return c?s!==void 0&&s===_classPrivateFieldGet$M(_hot$1,this).view.getFirstRenderedVisibleRow()?c+1:c:CLASSIC_THEME_DEFAULT_HEIGHT}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(s){if(!s){_classPrivateFieldSet$K(_themeName$1,this,void 0),_classPrivateFieldSet$K(_isClassicTheme,this,!0),_classPrivateFieldGet$M(_onThemeChange,this).call(this,_classPrivateFieldGet$M(_themeName$1,this)),_assertClassBrand$13(_StylesHandler_brand,this,_cacheStylesheetValues).call(this);return}if(s&&s!==_classPrivateFieldGet$M(_themeName$1,this)){if(!/ht-theme-.*/.test(s)){warn$1(`Invalid theme name: ${s}. Please provide a valid theme name.`),_classPrivateFieldSet$K(_themeName$1,this,void 0),_classPrivateFieldSet$K(_isClassicTheme,this,!1),_classPrivateFieldGet$M(_onThemeChange,this).call(this,_classPrivateFieldGet$M(_themeName$1,this)),_assertClassBrand$13(_StylesHandler_brand,this,_cacheStylesheetValues).call(this);return}_classPrivateFieldGet$M(_themeName$1,this)&&_assertClassBrand$13(_StylesHandler_brand,this,_clearCachedValues).call(this),_classPrivateFieldSet$K(_themeName$1,this,s),_classPrivateFieldSet$K(_isClassicTheme,this,!1),_classPrivateFieldGet$M(_onThemeChange,this).call(this,_classPrivateFieldGet$M(_themeName$1,this)),_assertClassBrand$13(_StylesHandler_brand,this,_cacheStylesheetValues).call(this)}}getThemeName(){return _classPrivateFieldGet$M(_themeName$1,this)}}function _calculateRowHeight(){const a=this.getCSSVariableValue("line-height"),s=this.getCSSVariableValue("cell-vertical-padding"),c=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return a===null||s===null||isNaN(c)?null:a+2*s+c}function _cacheStylesheetValues(){this.isClassicTheme()||_classPrivateFieldSet$K(_rootComputedStyle,this,getComputedStyle(_classPrivateFieldGet$M(_rootElement$3,this)));const a=_assertClassBrand$13(_StylesHandler_brand,this,_getStylesForTD).call(this,["box-sizing","border-bottom-width"]);_classPrivateFieldGet$M(_computedStyles,this).td={..._classPrivateFieldGet$M(_computedStyles,this).td,"box-sizing":a["box-sizing"],"border-bottom-width":a["border-bottom-width"]}}function _getStylesForTD(a){const s=_classPrivateFieldGet$M(_rootDocument$2,this),c=_classPrivateFieldGet$M(_rootElement$3,this),u=s.createElement("table"),d=s.createElement("tbody"),h=s.createElement("tr"),f=s.createElement("tr"),g=s.createElement("td");f.appendChild(g),d.appendChild(h),d.appendChild(f),u.appendChild(d),c.appendChild(u);const m=getComputedStyle(g),p={};return a.forEach(v=>{p[v]=m.getPropertyValue(v)}),c.removeChild(u),p}function _getParsedNumericCSSValue(a){const s=Math.ceil(parseFloat(_assertClassBrand$13(_StylesHandler_brand,this,_getCSSValue).call(this,a)));return Number.isNaN(s)?null:s}function _getCSSValue(a){const s=_classPrivateFieldGet$M(_rootComputedStyle,this).getPropertyValue(a);return s===""?null:s}function _clearCachedValues(){_classPrivateFieldSet$K(_computedStyles,this,{}),_classPrivateFieldSet$K(_cssVars,this,{}),_classPrivateFieldSet$K(_isClassicTheme,this,!0)}let announcerElement=null,installCounter=0;function install(a){const s=a.ownerDocument;if(!announcerElement){announcerElement=s.createElement("div"),announcerElement.setAttribute("role","status"),announcerElement.setAttribute("aria-live","assertive"),announcerElement.setAttribute("aria-atomic","true");const c=announcerElement.style;c.position="absolute",c.width="1px",c.height="1px",c.margin="-1px",c.overflow="hidden",c.clipPath="rect(0 0 0 0)",c.whiteSpace="nowrap",a.appendChild(announcerElement)}installCounter+=1}function uninstall(){installCounter!==0&&(installCounter===1&&(announcerElement.remove(),announcerElement=null),installCounter-=1)}function announce(a){announcerElement&&(announcerElement.textContent="",setTimeout(()=>{announcerElement&&(announcerElement.textContent=a)},100))}let activeGuid=null;const deprecatedWarnInstances=new WeakSet,foreignHotInstances=new Map;function Core(a,s){var c,u,d=this;let h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,f=this;const g=new EventManager(f);let m,p,v,w,E,C,b=!0;const P={...s.initialState,...s};hasValidParameter(h)&&registerAsRootInstance(this),this.rootContainer=a,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=isRootInstance(this)?a.ownerDocument.createElement("div"):a,this.rootDocument=a.ownerDocument,this.rootWindow=this.rootDocument.defaultView,isRootInstance(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),addClass$1(this.rootElement,["ht-wrapper","handsontable"]),addClass$1(this.rootWrapperElement,"ht-root-wrapper"),addClass$1(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),addClass$1(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const R=(c=P?.layoutDirection)!==null&&c!==void 0?c:"inherit",T=["rtl","ltr"].includes(R)?R:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",T),(u=this.rootWrapperElement)===null||u===void 0||u.setAttribute("dir",T),this.isRtl=function(){return T==="rtl"},this.isLtr=function(){return!f.isRtl()},this.getDirectionFactor=function(){return f.isLtr()?1:-1},this.stylesHandler=new StylesHandler({hot:f,rootElement:f.rootElement,rootDocument:f.rootDocument,onThemeChange:U=>{isRootInstance(this)&&(removeClass$1(this.rootWrapperElement,/ht-theme-.*/g),removeClass$1(this.rootPortalElement,/ht-theme-.*/g),U&&(addClass$1(this.rootWrapperElement,U),addClass$1(this.rootPortalElement,U),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||warn$1(`The "${U}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),P.language=getValidLanguageCode(P.language);const I=Object.fromEntries(Object.entries(P).filter(U=>{let[Q]=U;return!(Hooks.getSingleton().isRegistered(Q)||Hooks.getSingleton().isDeprecated(Q))})),M=new MetaManager(f,I,[DynamicCellMetaMod,ExtendMetaPropertiesMod]),N=M.getTableMeta(),H=M.getGlobalMeta(),L=createUniqueMap();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${randomString()}`,foreignHotInstances.set(this.guid,this),this.columnIndexMapper=new IndexMapper,this.rowIndexMapper=new IndexMapper,this.columnIndexMapper.addLocalHook("indexesSequenceChange",U=>{f.runHooks("afterColumnSequenceChange",U)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",U=>{f.runHooks("afterRowSequenceChange",U)}),g.addEventListener(this.rootDocument.documentElement,"compositionstart",U=>{f.runHooks("beforeCompositionStart",U)}),p=new DataSource(f);const A=staticRegister(this.guid);A.register("cellRangeMapper",new CellRangeToRenderableMapper({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const k=U=>{const{row:Q,col:ee}=U;return f._createCellCoords(Q>=0?f.rowIndexMapper.getRenderableFromVisualIndex(Q):Q,ee>=0?f.columnIndexMapper.getRenderableFromVisualIndex(ee):ee)},W=U=>{const{row:Q,col:ee}=U;return f._createCellCoords(Q>=0?f.rowIndexMapper.getVisualFromRenderableIndex(Q):Q,ee>=0?f.columnIndexMapper.getVisualFromRenderableIndex(ee):ee)},G=(U,Q)=>{const ee=Q>U?1:-1,ce=Math.min(U,Q),ve=Math.max(U,Q),K=f.rowIndexMapper.getNearestNotHiddenIndex(U,ee);return K===null||ee===1&&K>ve||ee===-1&&K<ce?null:K>=0?f.rowIndexMapper.getRenderableFromVisualIndex(K):K},oe=(U,Q)=>{const ee=Q>U?1:-1,ce=Math.min(U,Q),ve=Math.max(U,Q),K=f.columnIndexMapper.getNearestNotHiddenIndex(U,ee);return K===null||ee===1&&K>ve||ee===-1&&K<ce?null:K>=0?f.columnIndexMapper.getRenderableFromVisualIndex(K):K};let ae=new Selection(N,{rowIndexMapper:f.rowIndexMapper,columnIndexMapper:f.columnIndexMapper,countCols:()=>f.countCols(),countRows:()=>f.countRows(),propToCol:U=>m.propToCol(U),isEditorOpened:()=>f.getActiveEditor()?f.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return d.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return d.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>f.getShortcutManager(),createCellCoords:(U,Q)=>f._createCellCoords(U,Q),createCellRange:(U,Q,ee)=>f._createCellRange(U,Q,ee),visualToRenderableCoords:k,renderableToVisualCoords:W,findFirstNonHiddenRenderableRow:G,findFirstNonHiddenRenderableColumn:oe,isDisabledCellSelection:(U,Q)=>U<0||Q<0?f.getSettings().disableVisualSelection:f.getCellMeta(U,Q).disableVisualSelection});this.selection=ae;const X=U=>{let{hiddenIndexesChanged:Q}=U;this.forceFullRender=!0,Q&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",U=>{X(U),this.runHooks("afterColumnSequenceCacheUpdate",U)}),this.rowIndexMapper.addLocalHook("cacheUpdated",U=>{X(U),this.runHooks("afterRowSequenceCacheUpdate",U)}),this.selection.addLocalHook("afterSetRangeEnd",(U,Q)=>{const ee=createObjectPropListener(!1),ce=this.selection.getSelectedRange(),{from:ve,to:K}=ce.current(),ne=ce.size()-1;this.runHooks("afterSelection",ve.row,ve.col,K.row,K.col,ee,ne),this.runHooks("afterSelectionByProp",ve.row,f.colToProp(ve.col),K.row,f.colToProp(K.col),ee,ne),Q&&(!ee.isTouched()||ee.isTouched()&&!ee.value)&&C.scrollTo(U);const de=ae.isSelectedByRowHeader(),Oe=ae.isSelectedByColumnHeader();de&&Oe?addClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]):de?(removeClass$1(this.rootElement,"ht__selection--columns"),addClass$1(this.rootElement,"ht__selection--rows")):Oe?(removeClass$1(this.rootElement,"ht__selection--rows"),addClass$1(this.rootElement,"ht__selection--columns")):removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(ae.getSelectionSource())||w.closeEditor(null),ae.getSelectionSource()!=="refresh"&&(f.view.render(),w.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",U=>{this.runHooks("beforeSelectionFocusSet",U.row,U.col)}),this.selection.addLocalHook("afterSetFocus",U=>{const Q=createObjectPropListener(!1);this.runHooks("afterSelectionFocusSet",U.row,U.col,Q),(!Q.isTouched()||Q.isTouched()&&!Q.value)&&C.scrollTo(U),w.closeEditor(),f.view.render(),w.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",U=>{const Q=U.length-1,{from:ee,to:ce}=U[Q];this.runHooks("afterSelectionEnd",ee.row,ee.col,ce.row,ce.col,Q),this.runHooks("afterSelectionEndByProp",ee.row,f.colToProp(ee.col),ce.row,f.colToProp(ce.col),Q),ae.getSelectionSource()==="refresh"&&(f.view.render(),w.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",U=>{const Q=this.runHooks("afterIsMultipleSelection",U.value);U.value&&(U.value=Q)}),this.selection.addLocalHook("afterDeselect",()=>{w.closeEditor(),f.view.render(),removeClass$1(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeSetRangeStart",...Q)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeSetRangeStartOnly",...Q)}).addLocalHook("beforeSetRangeEnd",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeSetRangeEnd",...Q)}).addLocalHook("beforeSelectColumns",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeSelectColumns",...Q)}).addLocalHook("afterSelectColumns",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("afterSelectColumns",...Q)}).addLocalHook("beforeSelectRows",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeSelectRows",...Q)}).addLocalHook("afterSelectRows",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("afterSelectRows",...Q)}).addLocalHook("beforeSelectAll",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeSelectAll",...Q)}).addLocalHook("afterSelectAll",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("afterSelectAll",...Q)}).addLocalHook("beforeModifyTransformStart",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("modifyTransformStart",...Q)}).addLocalHook("afterModifyTransformStart",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("afterModifyTransformStart",...Q)}).addLocalHook("beforeModifyTransformFocus",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("modifyTransformFocus",...Q)}).addLocalHook("afterModifyTransformFocus",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("afterModifyTransformFocus",...Q)}).addLocalHook("beforeModifyTransformEnd",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("modifyTransformEnd",...Q)}).addLocalHook("afterModifyTransformEnd",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("afterModifyTransformEnd",...Q)}).addLocalHook("beforeRowWrap",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeRowWrap",...Q)}).addLocalHook("beforeColumnWrap",function(){for(var U=arguments.length,Q=new Array(U),ee=0;ee<U;ee++)Q[ee]=arguments[ee];return d.runHooks("beforeColumnWrap",...Q)}).addLocalHook("insertRowRequire",U=>this.alter("insert_row_above",U,1,"auto")).addLocalHook("insertColRequire",U=>this.alter("insert_col_start",U,1,"auto")),v={alter(U,Q){let ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,ce=arguments.length>3?arguments[3]:void 0,ve=arguments.length>4?arguments[4]:void 0;const K=ne=>{if(ne.length===0)return[];const de=[...ne];return de.sort((Se,ge)=>{let[De]=Se,[$e]=ge;return De===$e?0:De>$e?1:-1}),arrayReduce(de,(Se,ge)=>{let[De,$e]=ge;const Fe=Se[Se.length-1],[Ve,Be]=Fe,Je=Ve+Be;if(De<=Je){const lt=Math.max($e-(Je-De),0);Fe[1]+=lt}else Se.push([De,$e]);return Se},[de[0]])};switch(U){case"insert_row_below":case"insert_row_above":const ne=f.countSourceRows();if(N.maxRows===ne)return;const de=U==="insert_row_below"?"below":"above";Q=Q??(de==="below"?ne:0);const{delta:Oe,startPhysicalIndex:Se}=m.createRow(Q,ee,{source:ce,mode:de});ae.shiftRows(f.toVisualRow(Se),Oe);break;case"insert_col_start":case"insert_col_end":const ge=U==="insert_col_end"?"end":"start";Q=Q??(ge==="end"?f.countSourceCols():0);const{delta:De,startPhysicalIndex:$e}=m.createCol(Q,ee,{source:ce,mode:ge});if(De){if(Array.isArray(N.colHeaders)){const Be=[f.toVisualColumn($e),0];Be.length+=De,Array.prototype.splice.apply(N.colHeaders,Be)}ae.shiftColumns(f.toVisualColumn($e),De)}break;case"remove_row":const Fe=Be=>{let Je=0;arrayEach(Be,lt=>{let[ot,ht]=lt;const Ct=isEmpty(ot)?f.countRows()-1:Math.max(ot-Je,0);if(Number.isInteger(ot)&&(ot=Math.max(ot-Je,0)),!m.removeRow(ot,ht,ce))return;if(ae.isSelected()){const{row:Rt}=f.getSelectedRangeActive().highlight;Rt>=ot&&Rt<=ot+ht-1&&w.closeEditor(!0)}const vt=f.countRows(),mt=N.fixedRowsTop;mt>=Ct+1&&(N.fixedRowsTop-=Math.min(ht,mt-Ct));const Et=N.fixedRowsBottom;if(Et&&Ct>=vt-Et&&(N.fixedRowsBottom-=Math.min(ht,Et)),vt===0)ae.deselect();else if(ce==="ContextMenu.removeRow"){const Rt=ae.getSelectedRange(),V=Rt.pop();Rt.clear().set(V.from).current().setTo(V.to),ae.refresh()}else ae.shiftRows(ot,-ht);Je+=ht})};Array.isArray(Q)?Fe(K(Q)):Fe([[Q,ee]]);break;case"remove_col":const Ve=Be=>{let Je=0;arrayEach(Be,lt=>{let[ot,ht]=lt;const Ct=isEmpty(ot)?f.countCols()-1:Math.max(ot-Je,0);let bt=f.toPhysicalColumn(Ct);if(Number.isInteger(ot)&&(ot=Math.max(ot-Je,0)),!m.removeCol(ot,ht,ce))return;if(ae.isSelected()){const{col:Rt}=f.getSelectedRangeActive().highlight;Rt>=ot&&Rt<=ot+ht-1&&w.closeEditor(!0)}if(f.countCols()===0)ae.deselect();else if(ce==="ContextMenu.removeColumn"){const Rt=ae.getSelectedRange(),V=Rt.pop();Rt.clear().set(V.from).current().setTo(V.to),ae.refresh()}else ae.shiftColumns(ot,-ht);const Et=N.fixedColumnsStart;Et>=Ct+1&&(N.fixedColumnsStart-=Math.min(ht,Et-Ct)),Array.isArray(N.colHeaders)&&(typeof bt>"u"&&(bt=-1),N.colHeaders.splice(bt,ht)),Je+=ht})};Array.isArray(Q)?Ve(K(Q)):Ve([[Q,ee]]);break;default:throw new Error(`There is no such action "${U}"`)}ve||v.adjustRowsAndCols(),f.view.adjustElementsSize(),f.view.render()},adjustRowsAndCols(){const U=N.minRows,Q=N.minSpareRows,ee=N.minCols,ce=N.minSpareCols;if(U){const ve=f.countRows();ve<U&&m.createRow(ve,U-ve,{source:"auto"})}if(Q){const ve=f.countEmptyRows(!0);if(ve<Q){const K=Q-ve,ne=Math.min(K,N.maxRows-f.countSourceRows());m.createRow(f.countRows(),ne,{source:"auto"})}}{let ve;(ee||ce)&&(ve=f.countEmptyCols(!0));let K=f.countCols();if(ee&&!N.columns&&K<ee){const ne=ee-K;ve+=ne,m.createCol(K,ne,{source:"auto"})}if(ce&&!N.columns&&f.dataType==="array"&&ve<ce){K=f.countCols();const ne=ce-ve,de=Math.min(ne,N.maxCols-K);m.createCol(K,de,{source:"auto"})}}},populateFromArray(U,Q,ee,ce,ve){let K,ne,de,Oe;const Se=[],ge={},De=[],$e=U.row,Fe=U.col;if(ne=Q.length,ne===0)return!1;let Ve=0,Be=0;switch(isObject(ee)&&(Ve=ee.col-Fe+1,Be=ee.row-$e+1),ve){case"shift_down":const lt=pivot(Q),ot=lt.length,ht=Math.max(ot,Ve),Ct=f.getData().slice($e),bt=pivot(Ct).slice(Fe,Fe+ht);for(de=0;de<ht;de+=1)if(de<ot){for(K=0,ne=lt[de].length;K<Be-ne;K+=1)lt[de].push(lt[de][K%ne]);de<bt.length?De.push(lt[de].concat(bt[de])):De.push(lt[de].concat(new Array(Ct.length).fill(null)))}else De.push(lt[de%ot].concat(bt[de]));f.populateFromArray($e,Fe,pivot(De));break;case"shift_right":const vt=Q.length,mt=Math.max(vt,Be),Et=f.getData().slice($e).map(we=>we.slice(Fe));for(K=0;K<mt;K+=1)if(K<vt){for(de=0,Oe=Q[K].length;de<Ve-Oe;de+=1)Q[K].push(Q[K][de%Oe]);if(K<Et.length)for(let we=0;we<Et[K].length;we+=1)Q[K].push(Et[K][we]);else Q[K].push(...new Array(Et[0].length).fill(null))}else Q.push(Q[K%ne].slice(0,mt).concat(Et[K]));f.populateFromArray($e,Fe,Q);break;case"overwrite":default:ge.row=U.row,ge.col=U.col;let Rt=0,V=0,q=!0,D;const O=function(Z){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const se=Q[Z%Q.length];return Y!==null?se[Y%se.length]:se},re=Q.length,Ee=ee?ee.row-U.row+1:0;for(ee?ne=Ee:ne=Math.max(re,Ee),K=0;K<ne&&!(ee&&ge.row>ee.row&&Ee>re||!N.allowInsertRow&&ge.row>f.countRows()-1||ge.row>=N.maxRows);K++){const we=K-Rt,Z=O(we).length,Y=ee?ee.col-U.col+1:0;if(ee?Oe=Y:Oe=Math.max(Z,Y),ge.col=U.col,D=f.getCellMeta(ge.row,ge.col),(ce==="CopyPaste.paste"||ce==="Autofill.fill")&&D.skipRowOnPaste){Rt+=1,ge.row+=1,ne+=1;continue}for(V=0,de=0;de<Oe;de++){var Je;if(ee&&ge.col>ee.col&&Y>Z||!N.allowInsertColumn&&ge.col>f.countCols()-1||ge.col>=N.maxCols)break;if(D=f.getCellMeta(ge.row,ge.col),(ce==="CopyPaste.paste"||ce==="Autofill.fill")&&D.skipColumnOnPaste){V+=1,ge.col+=1,Oe+=1;continue}if(D.readOnly&&ce!=="UndoRedo.undo"){ge.col+=1;continue}const se=de-V,_e=!!D.valueSetter;let Ae=O(we,se),ke=(Je=f.getSourceDataAtCell(ge.row,ge.col))!==null&&Je!==void 0?Je:null;if(Ae!==null&&typeof Ae=="object"){if(Array.isArray(Ae)&&ke===null&&(ke=[]),!_e&&(typeof ke!="object"||ke===null))q=!1;else if(ke!==null){const je=duckSchema(Array.isArray(ke)?ke:ke[0]||ke),Ue=duckSchema(Array.isArray(Ae)?Ae:Ae[0]||Ae);_e||isObjectEqual(je,Ue)||Array.isArray(je)&&Array.isArray(Ue)?Ae=deepClone(Ae):q=!1}}else!_e&&ke!==null&&typeof ke=="object"&&(q=!1);q&&Se.push([ge.row,ge.col,Ae]),q=!0,ge.col+=1}ge.row+=1}f.setDataAtCell(Se,null,null,ce||"populateFromArray");break}}};function le(U){const Q=normalizeLanguageCode(U);hasLanguageDictionary(Q)?(f.runHooks("beforeLanguageChange",Q),H.language=Q,f.runHooks("afterLanguageChange",Q)):warnUserAboutLanguageRegistration(U)}function ye(U,Q){const ee=U==="className"?f.rootElement:f.table;if(b)addClass$1(ee,Q);else{let ce=[],ve=[];H[U]&&(ce=Array.isArray(H[U])?H[U]:stringToArray(H[U])),Q&&(ve=Array.isArray(Q)?Q:stringToArray(Q));const K=getDifferenceOfArrays(ce,ve),ne=getDifferenceOfArrays(ve,ce);K.length&&removeClass$1(ee,K),ne.length&&addClass$1(ee,ne)}H[U]=Q}this.init=function(){p.setData(N.data),f.runHooks("beforeInit"),(isMobileBrowser()||isIpadOS())&&addClass$1(f.rootElement,"mobile"),this.updateSettings(P,!0),this.view=new TableView(this),w=EditorManager.getInstance(f,N,ae),C=createViewportScroller(f),E.init(),isRootInstance(this)&&(install(f.rootPortalElement),_injectProductInfo(P.licenseKey,this.rootWrapperElement)),f.runHooks("init"),this.render(),b&&f.rootElement.offsetParent===null&&observeVisibilityChangeOnce(f.rootElement,()=>{f.view._wt.wtOverlays.updateLastSpreaderSize(),f.view.adjustElementsSize(),f.render()}),typeof b=="object"&&(f.runHooks("afterChange",b[0],b[1]),b=!1),f.runHooks("afterInit")};function pe(){let U=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,U=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&U===!1&&(U=!0,this.onQueueEmpty(this.valid))}}}function he(U,Q,ee){if(!U.length){ee();return}const ce=f.getActiveEditor(),ve=new pe;let K=!0;ve.onQueueEmpty=()=>{ce&&K&&ce.cancelChanges(),ee()};for(let ne=U.length-1;ne>=0;ne--){const[de,Oe,,Se]=U[ne],ge=m.propToCol(Oe);let De;Number.isInteger(ge)?De=f.getCellMeta(de,ge):De={...Object.getPrototypeOf(N),...N},f.getCellValidator(De)&&(ve.addValidatorToQueue(),f.validateCell(Se,De,(function($e,Fe){return function(Ve){if(typeof Ve!="boolean")throw new Error("Validation error: result is not boolean");Ve===!1&&Fe.allowInvalid===!1&&(K=!1,U.splice($e,1),Fe.valid=!0),ve.removeValidatorFormQueue()}})(ne,De),Q))}ve.checkIfQueueIsEmpty()}function Me(U,Q){for(let ce=U.length-1;ce>=0;ce--){let ve=!1;if(U[ce]===null){U.splice(ce,1);continue}if(!((U[ce][2]===null||U[ce][2]===void 0)&&(U[ce][3]===null||U[ce][3]===void 0))){if(N.allowInsertRow)for(;U[ce][0]>f.countRows()-1;){const{delta:K}=m.createRow(void 0,void 0,{source:"auto"});if(K===0){ve=!0;break}}if(f.dataType==="array"&&(!N.columns||N.columns.length===0)&&N.allowInsertColumn)for(;m.propToCol(U[ce][1])>f.countCols()-1;){const{delta:K}=m.createCol(void 0,void 0,{source:"auto"});if(K===0){ve=!0;break}}ve||m.set(U[ce][0],U[ce][1],U[ce][3])}}if(U.length>0){v.adjustRowsAndCols(),f.runHooks("beforeChangeRender",U,Q),w.closeEditor(),f.view.adjustElementsSize(),f.render(),w.prepareEditor(),f.runHooks("afterChange",U,Q||"edit");const ce=f.getActiveEditor();ce&&isDefined(ce.refreshValue)&&ce.refreshValue()}else f.render()}this._createCellCoords=function(U,Q){return f.view._wt.createCellCoords(U,Q)},this._createCellRange=function(U,Q,ee){return f.view._wt.createCellRange(U,Q,ee)},this.validateCell=function(U,Q,ee,ce){let ve=f.getCellValidator(Q);function K(ne){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||Q.hidden===!0){ee(ne);return}const Oe=Q.visualCol,Se=Q.visualRow,ge=f.getCell(Se,Oe,!0);if(ge&&ge.nodeName!=="TH"){const De=f.rowIndexMapper.getRenderableFromVisualIndex(Se),$e=f.columnIndexMapper.getRenderableFromVisualIndex(Oe);f.view._wt.getSetting("cellRenderer",De,$e,ge)}ee(ne)}isRegExp(ve)&&(ve=(function(ne){return function(de,Oe){Oe(ne.test(de))}})(ve)),isFunction(ve)?(U=f.runHooks("beforeValidate",U,Q.visualRow,Q.prop,ce),f._registerImmediate(()=>{ve.call(Q,U,ne=>{f&&(ne=f.runHooks("afterValidate",ne,U,Q.visualRow,Q.prop,ce),Q.valid=ne,K(ne),f.runHooks("postAfterValidate",ne,U,Q.visualRow,Q.prop,ce))})})):f._registerImmediate(()=>{Q.valid=!0,K(Q.valid,!1)})};function Qe(U,Q,ee){return Array.isArray(U)?U:[[U,Q,ee]]}function Xe(U,Q){const ee=f.runHooks("beforeChange",U,Q||"edit"),ce=U.filter(K=>K!==null);if(ee===!1||ce.length===0){var ve;return(ve=f.getActiveEditor())===null||ve===void 0||ve.cancelChanges(),[]}for(let K=ce.length-1;K>=0;K--){const[ne,de,,Oe]=ce[K],Se=m.propToCol(de);let ge;Number.isInteger(Se)?ge=f.getCellMeta(ne,Se):ge={...Object.getPrototypeOf(N),...N},ce[K][3]=getValueSetterValue(Oe,ge)}return ce}this.setDataAtCell=function(U,Q,ee,ce){const ve=Qe(U,Q,ee),K=[];let ne=ce,de,Oe,Se;for(de=0,Oe=ve.length;de<Oe;de++){const[De,$e,Fe]=ve[de];if(typeof ve[de]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof $e!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");$e>=this.countCols()?Se=$e:Se=m.colToProp($e),K.push([De,Se,p.getAtCell(this.toPhysicalRow(De),$e),Fe])}!ne&&typeof U=="object"&&(ne=Q);const ge=Xe(K,ne);f.runHooks("afterSetDataAtCell",ge,ne),he(ge,ne,()=>{Me(ge,ne)})},this.setDataAtRowProp=function(U,Q,ee,ce){const ve=Qe(U,Q,ee),K=[];let ne=ce,de,Oe;for(de=0,Oe=ve.length;de<Oe;de++){const[ge,De,$e]=ve[de];K.push([ge,De,p.getAtCell(this.toPhysicalRow(ge),De),$e])}!ne&&typeof U=="object"&&(ne=Q);const Se=Xe(K,ce);f.runHooks("afterSetDataAtRowProp",Se,ne),he(Se,ne,()=>{Me(Se,ne)})},this.listen=function(){f&&!f.isListening()&&(foreignHotInstances.forEach(U=>{f!==U&&U.unlisten()}),activeGuid=f.guid,f.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(activeGuid=null,f.runHooks("afterUnlisten"))},this.isListening=function(){return activeGuid===f.guid},this.destroyEditor=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;w.closeEditor(U),f.view.render(),Q&&ae.isSelected()&&w.prepareEditor()},this.populateFromArray=function(U,Q,ee,ce,ve,K,ne){if(!(typeof ee=="object"&&typeof ee[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const de=typeof ce=="number"?f._createCellCoords(ce,ve):null;return v.populateFromArray(f._createCellCoords(U,Q),ee,de,K,ne)},this.spliceCol=function(U,Q,ee){for(var ce=arguments.length,ve=new Array(ce>3?ce-3:0),K=3;K<ce;K++)ve[K-3]=arguments[K];return m.spliceCol(U,Q,ee,...ve)},this.spliceRow=function(U,Q,ee){for(var ce=arguments.length,ve=new Array(ce>3?ce-3:0),K=3;K<ce;K++)ve[K-3]=arguments[K];return m.spliceRow(U,Q,ee,...ve)},this.getSelected=function(){if(ae.isSelected())return arrayMap(ae.getSelectedRange(),U=>{let{from:Q,to:ee}=U;return[Q.row,Q.col,ee.row,ee.col]})},this.getSelectedLast=function(){const U=this.getSelected();let Q;return U&&U.length>0&&(Q=U[U.length-1]),Q},this.getSelectedActive=function(){const U=this.getSelectedRangeActive();if(!U)return;const{from:Q,to:ee}=U;return[Q.row,Q.col,ee.row,ee.col]},this.getSelectedRange=function(){if(ae.isSelected())return Array.from(ae.getSelectedRange())},this.getSelectedRangeLast=function(){const U=this.getSelectedRange();let Q;return U&&U.length>0&&(Q=U[U.length-1]),Q},this.getSelectedRangeActive=function(){return ae.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return ae.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(U){if(!ae.isSelected()||this.countRows()===0||this.countCols()===0)return;const Q=[];arrayEach(ae.getSelectedRange(),ee=>{if(ee.isSingleHeader())return;const ce=ee.getTopStartCorner(),ve=ee.getBottomEndCorner();rangeEach(ce.row,ve.row,K=>{rangeEach(ce.col,ve.col,ne=>{this.getCellMeta(K,ne).readOnly||Q.push([K,ne,null])})})}),Q.length>0&&this.setDataAtCell(Q,U)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const U=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(U,0),!this.isRenderSuspended()&&U===this.renderSuspendedCounter&&f.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||f.view.render())},this.batchRender=function(U){this.suspendRender();const Q=U();return this.resumeRender(),Q},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const Q=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(Q,0),(!this.isExecutionSuspended()&&Q===this.executionSuspendedCounter||U)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const ee=U();return this.resumeExecution(Q),ee},this.batch=function(U){this.suspendRender(),this.suspendExecution();const Q=U();return this.resumeExecution(),this.resumeRender(),Q},this.refreshDimensions=function(){if(!f.view)return;const U=f.view,{width:Q,height:ee}=U.getLastSize(),{width:ce,height:ve}=f.rootElement.getBoundingClientRect(),K=ce!==Q||ve!==ee;f.runHooks("beforeRefreshDimensions",{width:Q,height:ee},{width:ce,height:ve},K)!==!1&&((K||U._wt.wtOverlays.scrollableElement===f.rootWindow)&&(U.setLastSize(ce,ve),U.adjustElementsSize(),f.render()),f.runHooks("afterRefreshDimensions",{width:Q,height:ee},{width:ce,height:ve},K))},this.updateData=function(U,Q){replaceData(U,ee=>{m=ee},ee=>{m=ee,f.columnIndexMapper.fitToLength(this.getInitialColumnCount()),f.rowIndexMapper.fitToLength(this.countSourceRows()),v.adjustRowsAndCols(),ae.refresh()},{hotInstance:f,dataMap:m,dataSource:p,internalSource:"updateData",source:Q,metaManager:M,firstRun:b})},this.loadData=function(U,Q){replaceData(U,ee=>{m=ee},()=>{M.clearCellsCache(),f.initIndexMappers(),v.adjustRowsAndCols(),ae.refresh(),b&&(b=[null,"loadData"])},{hotInstance:f,dataMap:m,dataSource:p,internalSource:"loadData",source:Q,metaManager:M,firstRun:b})},this.getInitialColumnCount=function(){const U=N.columns;let Q=0;if(Array.isArray(U))Q=U.length;else if(isFunction(U))if(f.dataType==="array"){const ee=this.countSourceCols();for(let ce=0;ce<ee;ce+=1)U(ce)&&(Q+=1)}else(f.dataType==="object"||f.dataType==="function")&&(Q=m.colToPropCache.length);else if(isDefined(N.dataSchema)){const ee=m.getSchema();Q=Array.isArray(ee)?ee.length:deepObjectSize(ee)}else Q=this.countSourceCols();return Q},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(U,Q,ee,ce){return isUndefined(U)?m.getAll():m.getRange(f._createCellCoords(U,Q),f._createCellCoords(ee,ce),m.DESTINATION_RENDERER)},this.getCopyableText=function(U,Q,ee,ce){return m.getCopyableText(f._createCellCoords(U,Q),f._createCellCoords(ee,ce))},this.getCopyableData=function(U,Q){return m.getCopyable(U,m.colToProp(Q))},this.getCopyableSourceData=function(U,Q){return p.getCopyable(U,m.colToProp(Q))},this.getSchema=function(){return m.getSchema()},this.updateSettings=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const ee=(b?f.loadData:f.updateData).bind(this);let ce=!1,ve,K;if(isDefined(U.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(isDefined(U.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(isDefined(U.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');isDefined(U.rowHeights)&&isDefined(U.minRowHeights)&&warn$1("Both `rowHeights` and `minRowHeights` are defined in your configuration. As one is the alias of the other, only one of them can be used at a time. `rowHeights` will be used as the row height configuration.");for(ve in U)if(!(ve==="data"||ve==="language"))if(ve==="className")ye("className",U.className);else if(ve==="tableClassName"&&f.table)ye("tableClassName",U.tableClassName),f.view._wt.wtOverlays.syncOverlayTableClassNames();else if(Hooks.getSingleton().isRegistered(ve)||Hooks.getSingleton().isDeprecated(ve)){const ge=U[ve];isFunction(ge)?(Hooks.getSingleton().addAsFixed(ve,ge,f),N[ve]=ge):Array.isArray(ge)&&(Hooks.getSingleton().add(ve,ge,f),N[ve]=ge)}else!Q&&hasOwnProperty(U,ve)&&(H[ve]=U[ve]);if(Q)f.useTheme(N.themeName||getThemeClassName(f.rootContainer));else{const ge=f.getCurrentThemeName();hasOwnProperty(U,"themeName")&&ge!==U.themeName&&f.useTheme(U.themeName)}deprecatedWarnInstances.has(f)&&f.stylesHandler.getThemeName()!==void 0&&deprecatedWarnInstances.delete(f),isRootInstance(f)&&!deprecatedWarnInstances.has(f)&&f.stylesHandler.isClassicTheme()&&(deprecatedWarn("The stylesheet you are using is deprecated and will be removed in version 17.0. Please update your theme configuration to ensure compatibility with future releases."),deprecatedWarnInstances.add(f)),U.data===void 0&&N.data===void 0?ee(null,"updateSettings"):U.data!==void 0?ee(U.data,"updateSettings"):U.columns!==void 0&&(m.createMap(),f.initIndexMappers()),!b&&U.language&&le(U.language);const ne=f.countCols(),de=N.columns;if(de&&isFunction(de)&&(ce=!0),(U.cell!==void 0||U.cells!==void 0||U.columns!==void 0)&&M.clearCache(),ne>0)for(ve=0,K=0;ve<ne;ve++){if(de){const ge=ce?de(ve):de[K];ge&&M.updateColumnMeta(K,ge)}K+=1}isDefined(U.cell)&&objectEach(U.cell,ge=>{f.setCellMetaObject(ge.row,ge.col,ge)}),f.runHooks("afterCellMetaReset");let Oe=f.rootElement.style.height;Oe!==""&&(Oe=parseInt(f.rootElement.style.height,10)),Q&&f.rootElement.getAttribute("style")&&f.rootElement.setAttribute("data-initialstyle",f.rootElement.getAttribute("style"));let Se=U.height;if(typeof U.height<"u")if(isFunction(Se)&&(Se=Se()),Se=f.runHooks("beforeHeightChange",Se),Se===null){const ge=f.rootElement.getAttribute("data-initialstyle");ge&&(ge.indexOf("height")>-1||ge.indexOf("overflow")>-1)?f.rootElement.setAttribute("style",ge):(f.rootElement.style.height="",f.rootElement.style.overflow="")}else Se!==void 0&&(f.rootElement.style.height=isNaN(Se)?`${Se}`:`${Se}px`,f.rootElement.style.overflow="hidden");if(typeof U.width<"u"){let ge=U.width;isFunction(ge)&&(ge=ge()),ge=f.runHooks("beforeWidthChange",ge),f.rootElement.style.width=isNaN(ge)?`${ge}`:`${ge}px`}Q||(f.view&&(f.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),f.view._wt.exportSettingsAsClassNames()),f.runHooks("afterUpdateSettings",U)),v.adjustRowsAndCols(),f.view&&!b&&(f.render(),f.view._wt.wtOverlays.adjustElementsSize()),!Q&&f.view&&(Oe===""||Se===""||Se===void 0)&&Oe!==Se&&f.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const U=f.getSelectedRangeActive();if(N.getValue){if(isFunction(N.getValue))return N.getValue.call(f);if(U)return f.getData()[U.highlight.row][N.getValue]}else if(U)return f.getDataAtCell(U.highlight.row,U.highlight.col);return null},this.getSettings=function(){return N},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(U,Q,ee,ce,ve){v.alter(U,Q,ee,ce,ve)},this.getCell=function(U,Q){let ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,ce=Q,ve=U;if(Q>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(Q)))return null;ce=this.columnIndexMapper.getRenderableFromVisualIndex(Q)}if(U>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(U)))return null;ve=this.rowIndexMapper.getRenderableFromVisualIndex(U)}return ve===null||ce===null||ve===void 0||ce===void 0?null:f.view.getCellAtCoords(f._createCellCoords(ve,ce),ee)},this.getCoords=function(U){const Q=this.view._wt.wtTable.getCoords(U);if(Q===null)return null;const{row:ee,col:ce}=Q;let ve=ee,K=ce;return ee>=0&&(ve=this.rowIndexMapper.getVisualFromRenderableIndex(ee)),ce>=0&&(K=this.columnIndexMapper.getVisualFromRenderableIndex(ce)),f._createCellCoords(ve,K)},this.colToProp=function(U){return m.colToProp(U)},this.propToCol=function(U){return m.propToCol(U)},this.toVisualRow=U=>this.rowIndexMapper.getVisualFromPhysicalIndex(U),this.toVisualColumn=U=>this.columnIndexMapper.getVisualFromPhysicalIndex(U),this.toPhysicalRow=U=>this.rowIndexMapper.getPhysicalFromVisualIndex(U),this.toPhysicalColumn=U=>this.columnIndexMapper.getPhysicalFromVisualIndex(U),this.getDataAtCell=function(U,Q){return m.get(U,m.colToProp(Q))},this.getDataAtRowProp=function(U,Q){return m.get(U,Q)},this.getDataAtCol=function(U){const Q=[],ee=m.getRange(f._createCellCoords(0,U),f._createCellCoords(N.data.length-1,U),m.DESTINATION_RENDERER);for(let ce=0;ce<ee.length;ce+=1)for(let ve=0;ve<ee[ce].length;ve+=1)Q.push(ee[ce][ve]);return Q},this.getDataAtProp=function(U){const Q=[],ee=m.getRange(f._createCellCoords(0,m.propToCol(U)),f._createCellCoords(N.data.length-1,m.propToCol(U)),m.DESTINATION_RENDERER);for(let ce=0;ce<ee.length;ce+=1)for(let ve=0;ve<ee[ce].length;ve+=1)Q.push(ee[ce][ve]);return Q},this.getSourceData=function(U,Q,ee,ce){let ve;return U===void 0?ve=p.getData():ve=p.getByRange(f._createCellCoords(U,Q),f._createCellCoords(ee,ce)),ve},this.getSourceDataArray=function(U,Q,ee,ce){let ve;return U===void 0?ve=p.getData(!0):ve=p.getByRange(f._createCellCoords(U,Q),f._createCellCoords(ee,ce),!0),ve},this.getSourceDataAtCol=function(U){return p.getAtColumn(U)},this.setSourceDataAtCell=function(U,Q,ee,ce){const ve=Qe(U,Q,ee),K=this.hasHook("afterSetSourceDataAtCell"),ne=[],de=(Se,ge)=>{const De=this.toVisualRow(Se),$e=this.toVisualColumn(ge);return Number.isInteger($e)?this.getCellMeta(De,$e):{...Object.getPrototypeOf(N),...N}};K&&arrayEach(ve,Se=>{let[ge,De,$e]=Se;const Fe=getValueSetterValue($e,de(ge,De));ne.push([ge,De,p.getAtCell(ge,De),Fe])}),arrayEach(ve,Se=>{let[ge,De,$e]=Se;const Fe=getValueSetterValue($e,de(ge,De));p.setAtCell(ge,De,Fe)}),K&&this.runHooks("afterSetSourceDataAtCell",ne,ce),this.render();const Oe=f.getActiveEditor();Oe&&isDefined(Oe.refreshValue)&&Oe.refreshValue()},this.getSourceDataAtRow=function(U){return p.getAtRow(U)},this.getSourceDataAtCell=function(U,Q){return p.getAtCell(U,Q)},this.getDataAtRow=function(U){return m.getRange(f._createCellCoords(U,0),f._createCellCoords(U,this.countCols()-1),m.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(U,Q,ee,ce){const ve=U===void 0?[0,0,this.countRows(),this.countCols()]:[U,Q,ee,ce],[K,ne]=ve;let[,,de,Oe]=ve,Se=null,ge=null;de===void 0&&(de=K),Oe===void 0&&(Oe=ne);let De="mixed";return rangeEach(Math.max(Math.min(K,de),0),Math.max(K,de),$e=>{let Fe=!0;return rangeEach(Math.max(Math.min(ne,Oe),0),Math.max(ne,Oe),Ve=>(ge=this.getCellMeta($e,Ve).type,Se?Fe=Se===ge:Se=ge,Fe)),De=Fe?ge:"mixed",Fe}),De},this.removeCellMeta=function(U,Q,ee){const[ce,ve]=[this.toPhysicalRow(U),this.toPhysicalColumn(Q)];let K=M.getCellMetaKeyValue(ce,ve,ee);f.runHooks("beforeRemoveCellMeta",U,Q,ee,K)!==!1&&(M.removeCellMeta(ce,ve,ee),f.runHooks("afterRemoveCellMeta",U,Q,ee,K)),K=null},this.spliceCellsMeta=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var ee=arguments.length,ce=new Array(ee>2?ee-2:0),ve=2;ve<ee;ve++)ce[ve-2]=arguments[ve];if(ce.length>0&&!Array.isArray(ce[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");Q>0&&M.removeRow(this.toPhysicalRow(U),Q),ce.length>0&&arrayEach(ce.reverse(),K=>{M.createRow(this.toPhysicalRow(U)),arrayEach(K,(ne,de)=>this.setCellMetaObject(U,de,ne))}),f.render()},this.setCellMetaObject=function(U,Q,ee){typeof ee=="object"&&objectEach(ee,(ce,ve)=>{this.setCellMeta(U,Q,ve,ce)})},this.setCellMeta=function(U,Q,ee,ce){if(f.runHooks("beforeSetCellMeta",U,Q,ee,ce)===!1)return;let K=U,ne=Q;U<this.countRows()&&(K=this.toPhysicalRow(U)),Q<this.countCols()&&(ne=this.toPhysicalColumn(Q)),M.setCellMeta(K,ne,ee,ce),f.runHooks("afterSetCellMeta",U,Q,ee,ce)},this.getCellsMeta=function(){return M.getCellsMeta()},this.getCellMeta=function(U,Q){let ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},ce=this.toPhysicalRow(U),ve=this.toPhysicalColumn(Q);return ce===null&&(ce=U),ve===null&&(ve=Q),M.getCellMeta(ce,ve,{visualRow:U,visualColumn:Q,...ee})},this.getColumnMeta=function(U){return M.getColumnMeta(this.toPhysicalColumn(U))},this.getCellMetaAtRow=function(U){return M.getCellsMetaAtRow(U)},this.isColumnModificationAllowed=function(){return!(f.dataType==="object"||N.columns)},this.getCellRenderer=function(U,Q){const ee=typeof U=="number"?f.getCellMeta(U,Q).renderer:U.renderer;return typeof ee=="string"?_getItem$2(ee):isUndefined(ee)?_getItem$2("text"):ee},this.getCellEditor=function(U,Q){const ee=typeof U=="number"?f.getCellMeta(U,Q).editor:U.editor;return typeof ee=="string"?_getItem$3(ee):isUndefined(ee)?_getItem$3("text"):ee},this.getCellValidator=function(U,Q){const ee=typeof U=="number"?f.getCellMeta(U,Q).validator:U.validator;return typeof ee=="string"?_getItem$1(ee):ee},this.validateCells=function(U){this._validateCells(U)},this.validateRows=function(U,Q){if(!Array.isArray(U))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(Q,U)},this.validateColumns=function(U,Q){if(!Array.isArray(U))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(Q,void 0,U)},this._validateCells=function(U,Q,ee){const ce=new pe;U&&(ce.onQueueEmpty=U);let ve=f.countRows()-1;for(;ve>=0;){if(Q!==void 0&&Q.indexOf(ve)===-1){ve-=1;continue}let K=f.countCols()-1;for(;K>=0;){if(ee!==void 0&&ee.indexOf(K)===-1){K-=1;continue}ce.addValidatorToQueue(),f.validateCell(f.getDataAtCell(ve,K),f.getCellMeta(ve,K),ne=>{if(typeof ne!="boolean")throw new Error("Validation error: result is not boolean");ne===!1&&(ce.valid=!1),ce.removeValidatorFormQueue()},"validateCells"),K-=1}ve-=1}ce.checkIfQueueIsEmpty()},this.getRowHeader=function(U){let Q=N.rowHeaders,ee=U;return ee!==void 0&&(ee=f.runHooks("modifyRowHeader",ee)),ee===void 0?(Q=[],rangeEach(f.countRows()-1,ce=>{Q.push(f.getRowHeader(ce))})):Array.isArray(Q)&&Q[ee]!==void 0?Q=Q[ee]:isFunction(Q)?Q=Q(ee):Q&&typeof Q!="string"&&typeof Q!="number"&&(Q=ee+1),Q},this.hasRowHeaders=function(){return!!N.rowHeaders},this.hasColHeaders=function(){if(N.colHeaders!==void 0&&N.colHeaders!==null)return!!N.colHeaders;for(let U=0,Q=f.countCols();U<Q;U++)if(f.getColHeader(U))return!0;return!1},this.getColHeader=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const ee=f.runHooks("modifyColHeader",U);if(ee===void 0){const de=[],Oe=f.countCols();for(let Se=0;Se<Oe;Se++)de.push(f.getColHeader(Se));return de}let ce=N.colHeaders;const ve=function(de){const Oe=[],Se=f.countCols();let ge=0;for(;ge<Se;ge++)isFunction(N.columns)&&N.columns(ge)&&Oe.push(ge);return Oe[de]},K=f.toPhysicalColumn(ee),ne=ve(K);return N.colHeaders===!1?ce=null:N.columns&&isFunction(N.columns)&&N.columns(ne)&&N.columns(ne).title?ce=N.columns(ne).title:N.columns&&N.columns[K]&&N.columns[K].title?ce=N.columns[K].title:Array.isArray(N.colHeaders)&&N.colHeaders[K]!==void 0?ce=N.colHeaders[K]:isFunction(N.colHeaders)?ce=N.colHeaders(K):N.colHeaders&&typeof N.colHeaders!="string"&&typeof N.colHeaders!="number"&&(ce=spreadsheetColumnLabel(ee)),ce=f.runHooks("modifyColumnHeaderValue",ce,U,Q),ce},this._getColWidthFromSettings=function(U){let Q;if(U>=0&&(Q=f.getCellMeta(0,U).width),(Q===void 0||Q===N.width)&&(Q=N.colWidths),Q!=null){switch(typeof Q){case"object":Q=Q[U];break;case"function":Q=Q(U);break}typeof Q=="string"&&(Q=Number.parseInt(Q,10))}return Q},this.getColWidth=function(U,Q){let ee=f._getColWidthFromSettings(U);return ee=f.runHooks("modifyColWidth",ee,U,Q),ee===void 0&&(ee=DEFAULT_WIDTH),ee},this._getRowHeightFromSettings=function(U){var Q;const ee=f.stylesHandler.getDefaultRowHeight(U);let ce=(Q=N.rowHeights)!==null&&Q!==void 0?Q:N.minRowHeights;if(ce!=null){switch(typeof ce){case"object":ce=ce[U];break;case"function":ce=ce(U);break}typeof ce=="string"&&(ce=Number.parseInt(ce,10))}return ce!=null&&ce<ee?ee:ce},this.getRowHeight=function(U,Q){let ee=f._getRowHeightFromSettings(U);return ee=f.runHooks("modifyRowHeight",ee,U,Q),ee},this.countSourceRows=function(){return p.countRows()},this.countSourceCols=function(){return p.countFirstRowKeys()},this.countRows=function(){return m.getLength()},this.countCols=function(){const U=N.maxCols,Q=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(U,Q)},this.countRenderedRows=function(){return f.view._wt.drawn?f.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return f.view._wt.drawn?f.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return f.view._wt.drawn?f.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return f.view._wt.drawn?f.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Q=0;return rangeEachReverse(f.countRows()-1,ee=>{if(f.isEmptyRow(ee))Q+=1;else if(U===!0)return!1}),Q},this.countEmptyCols=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Q=0;return rangeEachReverse(f.countCols()-1,ee=>{if(f.isEmptyCol(ee))Q+=1;else if(U===!0)return!1}),Q},this.isEmptyRow=function(U){return N.isEmptyRow.call(f,U)},this.isEmptyCol=function(U){return N.isEmptyCol.call(f,U)},this.selectCell=function(U,Q,ee,ce){let ve=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,K=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return isUndefined(U)||isUndefined(Q)?!1:this.selectCells([[U,Q,ee,ce]],ve,K)},this.selectCells=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,ee=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;Q===!1&&C.suspend();const ce=ae.selectCells(U);return ce&&ee&&f.listen(),C.resume(),ce},this.selectColumns=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,ee=arguments.length>2?arguments[2]:void 0;return ae.selectColumns(U,Q,ee)},this.selectRows=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,ee=arguments.length>2?arguments[2]:void 0;return ae.selectRows(U,Q,ee)},this.deselectCell=function(){ae.deselect()},this.selectAll=function(){let U=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U,ee=arguments.length>2?arguments[2]:void 0;C.skipNextScrollCycle(),ae.selectAll(U,Q,ee)};const Ke=(U,Q)=>U.getNearestNotHiddenIndex(Q,1,!0);this.scrollViewportTo=function(U,Q){if(typeof U=="number"){var ee;U={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(ee=arguments[4])!==null&&ee!==void 0?ee:!0}}const{row:ce,col:ve,considerHiddenIndexes:K}=U??{};let ne=ce,de=ve;if(isFunction(Q)&&this.addHookOnce("afterScroll",Q),K===void 0||K){const De=Number.isInteger(ce)&&ce>=0,$e=Number.isInteger(ve)&&ve>=0,Fe=De?Ke(this.rowIndexMapper,ce):void 0,Ve=$e?Ke(this.columnIndexMapper,ve):void 0;if(Fe===null||Ve===null)return!1;ne=De?f.rowIndexMapper.getRenderableFromVisualIndex(Fe):ce,de=$e?f.columnIndexMapper.getRenderableFromVisualIndex(Ve):ve}const Oe=Number.isInteger(ne),Se=Number.isInteger(de);let ge=!1;return Oe&&ne>=0&&Se&&de>=0?ge=f.view.scrollViewport(f._createCellCoords(ne,de),U.horizontalSnap,U.verticalSnap):Oe&&ne>=0&&(Se&&de<0||!Se)?ge=f.view.scrollViewportVertically(ne,U.verticalSnap):Se&&de>=0&&(Oe&&ne<0||!Oe)&&(ge=f.view.scrollViewportHorizontally(de,U.horizontalSnap)),isFunction(Q)&&(ge?this.view.render():(this.removeHook("afterScroll",Q),this._registerMicrotask(()=>Q()))),ge},this.scrollToFocusedCell=function(U){if(!this.selection.isSelected())return!1;isFunction(U)&&this.addHookOnce("afterScroll",U);const{highlight:Q}=this.getSelectedRangeActive(),ee=this.scrollViewportTo(Q.toObject());return ee?this.view.render():isFunction(U)&&(this.removeHook("afterScroll",U),this._registerMicrotask(()=>U())),ee},this.destroy=function(){f._clearTimeouts(),f._clearImmediates(),f.view&&f.view.destroy(),p&&p.destroy(),p=null,isRootInstance(this)&&(uninstall(),this.getFocusScopeManager().destroy()),this.getShortcutManager().destroy(),A.clear(),M.clearCache(),foreignHotInstances.delete(this.guid),g.destroy(),w&&w.destroy(),f.rootContainer&&empty(f.rootContainer),f.rootPortalElement&&f.rootPortalElement.remove(),f.batchExecution(()=>{f.rowIndexMapper.unregisterAll(),f.columnIndexMapper.unregisterAll(),L.getItems().forEach(U=>{let[,Q]=U;Q.destroy()}),L.clear(),f.runHooks("afterDestroy")},!0),Hooks.getSingleton().destroy(f),objectEach(f,(U,Q,ee)=>{isFunction(U)?ee[Q]=it(Q):Q!=="guid"&&(ee[Q]=null)}),f.isDestroyed=!0,m&&m.destroy(),m=null,v=null,ae=null,w=null,f=null};function it(U){return()=>{throw new Error(`The "${U}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return w.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return f.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return f.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return f.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return f.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return f.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return f.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return f.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return f.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return f.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return f.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return f.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return f.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(U){return L.getItem(toUpperCaseFirst(U))},this.getPluginName=function(U){return U===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:L.getId(U)},this.getInstance=function(){return f},this.addHook=function(U,Q,ee){Hooks.getSingleton().add(U,Q,f,ee)},this.hasHook=function(U){return Hooks.getSingleton().has(U,f)||Hooks.getSingleton().has(U)},this.addHookOnce=function(U,Q,ee){Hooks.getSingleton().once(U,Q,f,ee)},this.removeHook=function(U,Q){Hooks.getSingleton().remove(U,Q,f)},this.runHooks=function(U,Q,ee,ce,ve,K,ne){return Hooks.getSingleton().run(f,U,Q,ee,ce,ve,K,ne)},this.getTranslatedPhrase=function(U,Q){return getTranslatedPhrase(N.language,U,Q)},this.toHTML=()=>instanceToHTML(this),this.toTableElement=()=>{const U=this.rootDocument.createElement("div");return U.insertAdjacentHTML("afterbegin",instanceToHTML(this)),U.firstElementChild},this.timeouts=[],this.useTheme=U=>{const Q=!!b;this.stylesHandler.useTheme(U);const ee=this.stylesHandler.getThemeName();Q||(f.render(),f.scrollViewportTo(0,0),getThemeClassName(this.rootContainer)&&(removeClass$1(this.rootContainer,/ht-theme-.*/g),ee&&addClass$1(this.rootContainer,ee))),this.runHooks("afterSetTheme",ee,Q)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(U){let Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ee=U;typeof ee=="function"&&(ee=setTimeout(ee,Q)),this.timeouts.push(ee)},this._clearTimeouts=function(){arrayEach(this.timeouts,U=>{clearTimeout(U)})},this.immediates=[],this._registerImmediate=function(U){this.immediates.push(setImmediate(U))},this._clearImmediates=function(){arrayEach(this.immediates,U=>{clearImmediate(U)})},this._registerMicrotask=function(U){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||U()})},this._getEditorManager=function(){return w};const te=createShortcutManager({handleEvent(){return f.isListening()},beforeKeyDown:U=>this.runHooks("beforeKeyDown",U),afterKeyDown:U=>{this.isDestroyed||f.runHooks("afterDocumentKeyDown",U)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",U=>{U.ctrlKey===!1&&U.metaKey===!1&&te.releasePressedKeys()}),this.getShortcutManager=function(){return te},E=new FocusGridManager(f);const Pe=isRootInstance(this)?createFocusScopeManager(f):null;this.getFocusManager=function(){return E},this.getFocusScopeManager=function(){if(!isRootInstance(f))throw new Error("The FocusScopeManager is only available for the main Handsontable instance.");return Pe},getPluginsNames().forEach(U=>{const Q=getPlugin(U);L.addItem(U,new Q(this))}),registerAllShortcutContexts(f),isRootInstance(this)&&registerAllFocusScopes(f),te.setActiveContextName("grid"),Hooks.getSingleton().run(f,"construct")}function observe(a,s,c){a.addEventListener(s,c,!1)}function unObserve(a,s,c){a.removeEventListener(s,c,!1)}function getComputedStyle$1(a){return a.ownerDocument.defaultView.getComputedStyle(a)}function createInputElementResizer(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const c={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:w=>w.value,...s},u=a.body,d=a.createTextNode(""),h=a.createElement("span");let f;function g(){var w,E;d.textContent=c.textContent(f),h.style.position="absolute",h.style.fontSize=getComputedStyle$1(f).fontSize,h.style.fontFamily=getComputedStyle$1(f).fontFamily,h.style.whiteSpace="pre",u.appendChild(h);const C=parseInt(((w=getComputedStyle$1(f))===null||w===void 0?void 0:w.paddingInlineStart)||0,10),b=parseInt(((E=getComputedStyle$1(f))===null||E===void 0?void 0:E.paddingInlineEnd)||0,10),P=h.clientWidth+C+b+1;u.removeChild(h);const R=f.style;R.height=`${c.minHeight}px`,c.minWidth>P?R.width=`${c.minWidth}px`:P>c.maxWidth?R.width=`${c.maxWidth}px`:R.width=`${P}px`;const T=f.scrollHeight?f.scrollHeight-1:0;c.minHeight>T?R.height=`${c.minHeight}px`:c.maxHeight<T?(R.height=`${c.maxHeight}px`,R.overflowY="visible"):R.height=`${T}px`}function m(){a.defaultView.setTimeout(g,0)}function p(w){if(w&&w.minHeight)if(w.minHeight==="inherit")c.minHeight=f.clientHeight;else{const E=parseInt(w.minHeight,10);isNaN(E)||(c.minHeight=E)}if(w&&w.maxHeight)if(w.maxHeight==="inherit")c.maxHeight=f.clientHeight;else{const E=parseInt(w.maxHeight,10);isNaN(E)||(c.maxHeight=E)}if(w&&w.minWidth)if(w.minWidth==="inherit")c.minWidth=f.clientWidth;else{const E=parseInt(w.minWidth,10);isNaN(E)||(c.minWidth=E)}if(w&&w.maxWidth)if(w.maxWidth==="inherit")c.maxWidth=f.clientWidth;else{const E=parseInt(w.maxWidth,10);isNaN(E)||(c.maxWidth=E)}h.firstChild||(h.className="autoResize",h.style.display="inline-block",h.appendChild(d))}function v(w,E){let C=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;f=w,p(E),f.nodeName==="TEXTAREA"&&(f.style.resize="none",f.style.height=`${c.minHeight}px`,f.style.minWidth=`${c.minWidth}px`,f.style.maxWidth=`${c.maxWidth}px`,f.style.overflowY="hidden"),C&&(observe(f,"input",g),observe(f,"keydown",m)),g()}return{init:v,resize:g,unObserve(){unObserve(f,"input",g),unObserve(f,"keydown",m)}}}function updateCaretPosition(a,s){const c=getCaretPosition(s),u=s.value.split(`
`);let d=c,h=0;for(let f=0;f<u.length;f++){const g=u[f];f!==0&&(h+=u[f-1].length+1);const m=h+g.length;if(a==="home"?d=h:a==="end"&&(d=m),c<=m)break}setCaretPosition(s,d)}function _defineProperty$1g(a,s,c){return(s=_toPropertyKey$1h(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1h(a){var s=_toPrimitive$1h(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1h(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const EDITOR_VISIBLE_CLASS_NAME$1="ht_editor_visible",EDITOR_HIDDEN_CLASS_NAME="ht_editor_hidden",SHORTCUTS_GROUP$g="textEditor",EDITOR_TYPE$9="text";class TextEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$9}constructor(s){super(s),_defineProperty$1g(this,"eventManager",new EventManager(this)),_defineProperty$1g(this,"autoResize",createInputElementResizer(this.hot.rootDocument)),_defineProperty$1g(this,"TEXTAREA",void 0),_defineProperty$1g(this,"textareaStyle",void 0),_defineProperty$1g(this,"TEXTAREA_PARENT",void 0),_defineProperty$1g(this,"textareaParentStyle",void 0),_defineProperty$1g(this,"layerClass",void 0),this.eventManager=new EventManager(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(s){this.TEXTAREA.value=s}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),isInternalElement(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(s,c,u,d,h,f){const g=this.state;if(super.prepare(s,c,u,d,h,f),!f.readOnly){this.refreshDimensions(!0);const{allowInvalid:m}=f;m&&!this.isOpened()&&(this.TEXTAREA.value=""),g!==EDITOR_STATE.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(s,c){this.state===EDITOR_STATE.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(s,c))}focus(){this.TEXTAREA.select(),setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:s}=this.hot;this.TEXTAREA=s.createElement("TEXTAREA"),setAttribute(this.TEXTAREA,[["data-hot-input",""],A11Y_TABINDEX(-1)]),addClass$1(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=s.createElement("DIV"),addClass$1(this.TEXTAREA_PARENT,"handsontableInputHolder"),hasClass$1(this.TEXTAREA_PARENT,this.layerClass)&&removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){isEdge()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",removeClass$1(this.TEXTAREA_PARENT,this.layerClass),addClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const s=this.TEXTAREA_PARENT.childNodes;let c=!1;rangeEach(s.length-1,u=>{const d=s[u];if(hasClass$1(d,"handsontableEditor"))return c=!0,!1}),hasClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME)&&removeClass$1(this.TEXTAREA_PARENT,EDITOR_HIDDEN_CLASS_NAME),c?(this.layerClass=EDITOR_VISIBLE_CLASS_NAME$1,addClass$1(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),addClass$1(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const s=this.hot.toPhysicalRow(this.row),c=this.hot.getSourceDataAtCell(s,this.col);this.originalValue=c,this.setValue(c),this.refreshDimensions()}refreshDimensions(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==EDITOR_STATE.EDITING&&!s)return;if(this.TD=this.getEditedCell(),!this.TD){s||this.close();return}const{top:c,start:u,width:d,maxWidth:h,height:f,maxHeight:g}=this.getEditedCellRect();this.textareaParentStyle.top=`${c}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${u}px`,this.showEditableElement();const m=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=m.fontSize,this.TEXTAREA.style.fontFamily=m.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(d,h),minHeight:Math.min(f,g),maxWidth:h,maxHeight:g},!0)}bindEvents(){isIOS()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===EDITOR_STATE.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const c=this.hot.getShortcutManager().getContext("editor"),u={runOnlyIf:()=>isDefined(this.hot.getSelected()),group:SHORTCUTS_GROUP$g},d=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};c.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(d(),!1),runOnlyIf:h=>!this.hot.selection.isMultiple()&&!h.altKey},{keys:[["Meta","Enter"]],callback:()=>(d(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(d(),!1)},{keys:[["Home"]],callback:(h,f)=>{let[g]=f;updateCaretPosition(g,this.TEXTAREA)}},{keys:[["End"]],callback:(h,f)=>{let[g]=f;updateCaretPosition(g,this.TEXTAREA)}}],u)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$g)}}const RENDERER_TYPE$b="base",TEXT_ELLIPSIS_CLASS_NAME="htTextEllipsis";function baseRenderer(a,s,c,u,d,h,f){const g=f.ariaTags,m=[],p=[],v=[],w=[];f.className&&addClass$1(s,f.className),f.readOnly?(m.push(f.readOnlyCellClassName),g&&w.push(A11Y_READONLY())):g&&v.push(A11Y_READONLY()[0]),f.valid===!1&&f.invalidCellClassName?(m.push(f.invalidCellClassName),g&&w.push(A11Y_INVALID())):(p.push(f.invalidCellClassName),g&&v.push(A11Y_INVALID()[0])),f.wordWrap===!1&&f.noWordWrapClassName&&m.push(f.noWordWrapClassName),!h&&f.placeholder&&m.push(f.placeholderCellClassName),f.textEllipsis&&m.push(TEXT_ELLIPSIS_CLASS_NAME),removeClass$1(s,p),addClass$1(s,m),removeAttribute(s,v),setAttribute(s,w)}baseRenderer.RENDERER_TYPE=RENDERER_TYPE$b;const RENDERER_TYPE$a="text";function textRenderer(a,s,c,u,d,h,f){baseRenderer.apply(this,[a,s,c,u,d,h,f]);let g=h;!g&&f.placeholder&&(g=f.placeholder),g=stringify$1(g),f.trimWhitespace&&(g=g.trim()),fastInnerText(s,g)}textRenderer.RENDERER_TYPE=RENDERER_TYPE$a;const CELL_TYPE$9="text",TextCellType={CELL_TYPE:CELL_TYPE$9,editor:TextEditor,renderer:textRenderer};_register(TextCellType),Handsontable.editors={BaseEditor};function Handsontable(a,s){const c=new Core(a,s||{},rootInstanceSymbol);return c.init(),c}Handsontable.Core=function(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new Core(a,s,rootInstanceSymbol)},Handsontable.DefaultSettings=metaSchemaFactory(),Handsontable.hooks=Hooks.getSingleton(),Handsontable.CellCoords=CellCoords,Handsontable.CellRange=CellRange,Handsontable.packageName="handsontable",Handsontable.buildDate="20/11/2025 13:26:54",Handsontable.version="16.2.0",Handsontable.languages={dictionaryKeys,getLanguageDictionary,getLanguagesDictionaries,registerLanguageDictionary,getTranslatedPhrase};var bulkComponentContainer=null,AUTOSIZE_WARNING="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",OBSOLETE_HOTRENDERER_WARNING="Providing a component-based renderer using `hot-renderer`-annotated component is no longer supported. Pass your component using `renderer` prop of the `HotTable` or `HotColumn` component instead.",OBSOLETE_HOTEDITOR_WARNING="Providing a component-based editor using `hot-editor`-annotated component is no longer supported. Pass your component using `editor` prop of the `HotTable` or `HotColumn` component instead.",UNEXPECTED_HOTTABLE_CHILDREN_WARNING="Unexpected children nodes found in HotTable component. Only HotColumn components are allowed.",UNEXPECTED_HOTCOLUMN_CHILDREN_WARNING="Unexpected children nodes found in HotColumn component. HotColumn components do not support any children.",HOT_DESTROYED_WARNING="The Handsontable instance bound to this component was destroyed and cannot be used properly.",DEFAULT_CLASSNAME="hot-wrapper-editor-container";function warn(){if(typeof console<"u"){var a;(a=console).warn.apply(a,arguments)}}function displayObsoleteRenderersEditorsWarning(a){return hasChildElementOfType(a,"hot-renderer")?(warn(OBSOLETE_HOTRENDERER_WARNING),!0):hasChildElementOfType(a,"hot-editor")?(warn(OBSOLETE_HOTEDITOR_WARNING),!0):!1}function displayChildrenOfTypeWarning(a,s){var c=React.Children.toArray(a);return c.some(function(u){return u.type!==s})?(warn(UNEXPECTED_HOTTABLE_CHILDREN_WARNING),!0):!1}function displayAnyChildrenWarning(a){var s=React.Children.toArray(a);return s.length?(warn(UNEXPECTED_HOTCOLUMN_CHILDREN_WARNING),!0):!1}function hasChildElementOfType(a,s){var c=React.Children.toArray(a);return c.some(function(u){return u.props[s]!==void 0})}function createEditorPortal(a,s){if(!a||!s||typeof s=="boolean")return null;var c=React.createElement(s,null),u=getContainerAttributesProps({},!1);return u.className="".concat(DEFAULT_CLASSNAME," ").concat(u.className),ReactDOM.createPortal(React.createElement("div",Object.assign({},u),c),a.body)}function createPortal(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document,c=arguments.length>2?arguments[2]:void 0,u=arguments.length>3?arguments[3]:void 0;s||(s=document),bulkComponentContainer||(bulkComponentContainer=s.createDocumentFragment());var d=u??s.createElement("DIV");return bulkComponentContainer.appendChild(d),{portal:ReactDOM.createPortal(a,d,c),portalContainer:d}}function getContainerAttributesProps(a){var s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:a.id||(s?"hot-"+Math.random().toString(36).substring(5):void 0),className:a.className||"",style:a.style||{}}}function isCSR(){return typeof window<"u"}function useUpdateEffect(a,s){var c=React.useRef(!1);React.useEffect(function(){if(c.current)return a();c.current=!0},s)}function _arrayLikeToArray(a,s){(s==null||s>a.length)&&(s=a.length);for(var c=0,u=Array(s);c<s;c++)u[c]=a[c];return u}function _arrayWithHoles(a){if(Array.isArray(a))return a}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _assertThisInitialized(a){if(a===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _callSuper(a,s,c){return s=_getPrototypeOf(s),_possibleConstructorReturn(a,_isNativeReflectConstruct()?Reflect.construct(s,c||[],_getPrototypeOf(a).constructor):s.apply(a,c))}function _classCallCheck(a,s){if(!(a instanceof s))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,s){for(var c=0;c<s.length;c++){var u=s[c];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(a,_toPropertyKey$1g(u.key),u)}}function _createClass(a,s,c){return s&&_defineProperties(a.prototype,s),c&&_defineProperties(a,c),Object.defineProperty(a,"prototype",{writable:!1}),a}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(s){return s.__proto__||Object.getPrototypeOf(s)},_getPrototypeOf(a)}function _inherits(a,s){if(typeof s!="function"&&s!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(s&&s.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),s&&_setPrototypeOf(a,s)}function _isNativeReflectConstruct(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_isNativeReflectConstruct=function(){return!!a})()}function _iterableToArray(a){if(typeof Symbol<"u"&&a[Symbol.iterator]!=null||a["@@iterator"]!=null)return Array.from(a)}function _iterableToArrayLimit(a,s){var c=a==null?null:typeof Symbol<"u"&&a[Symbol.iterator]||a["@@iterator"];if(c!=null){var u,d,h,f,g=[],m=!0,p=!1;try{if(h=(c=c.call(a)).next,s!==0)for(;!(m=(u=h.call(c)).done)&&(g.push(u.value),g.length!==s);m=!0);}catch(v){p=!0,d=v}finally{try{if(!m&&c.return!=null&&(f=c.return(),Object(f)!==f))return}finally{if(p)throw d}}return g}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _nonIterableSpread(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _objectWithoutProperties(a,s){if(a==null)return{};var c,u,d=_objectWithoutPropertiesLoose(a,s);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(a);for(u=0;u<h.length;u++)c=h[u],s.indexOf(c)===-1&&{}.propertyIsEnumerable.call(a,c)&&(d[c]=a[c])}return d}function _objectWithoutPropertiesLoose(a,s){if(a==null)return{};var c={};for(var u in a)if({}.hasOwnProperty.call(a,u)){if(s.indexOf(u)!==-1)continue;c[u]=a[u]}return c}function _possibleConstructorReturn(a,s){if(s&&(typeof s=="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(a)}function _setPrototypeOf(a,s){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(c,u){return c.__proto__=u,c},_setPrototypeOf(a,s)}function _slicedToArray(a,s){return _arrayWithHoles(a)||_iterableToArrayLimit(a,s)||_unsupportedIterableToArray(a,s)||_nonIterableRest()}function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _toPrimitive$1g(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(a)}function _toPropertyKey$1g(a){var s=_toPrimitive$1g(a,"string");return typeof s=="symbol"?s:s+""}function _unsupportedIterableToArray(a,s){if(a){if(typeof a=="string")return _arrayLikeToArray(a,s);var c={}.toString.call(a).slice(8,-1);return c==="Object"&&a.constructor&&(c=a.constructor.name),c==="Map"||c==="Set"?Array.from(a):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,s):void 0}}var SettingsMapper=(function(){function a(){_classCallCheck(this,a)}return _createClass(a,null,[{key:"getSettings",value:(function(c){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=u.prevProps,h=d===void 0?{}:d,f=u.isInit,g=f===void 0?!1:f,m=u.initOnlySettingKeys,p=m===void 0?[]:m,v=function(b){return!g&&p.includes(b)?h[b]===c[b]:!1},w={};for(var E in c)E!=="children"&&!v(E)&&c.hasOwnProperty(E)&&(w[E]=c[E]);return w})}])})(),HotTableContext=React.createContext(void 0),HotTableContextProvider=function(s){var c=s.children,u=React.useRef([]),d=React.useCallback(function(R,T){u.current[T]=R},[]),h=React.useRef(new Map),f=React.useRef(new Map),g=React.useCallback(function(){return f.current.clear()},[]),m=React.useRef(new Map),p=React.useCallback(function(){return m.current.clear()},[]),v=React.useRef(new Map),w=React.useCallback(function(R){return function(I,M,N,H,L,A,k){var W="".concat(N,"-").concat(H),G=I.guid,oe="".concat(G,"-").concat(W),ae="".concat(W,"-").concat(G);if(f.current.has(W)&&(M.innerHTML=f.current.get(W).innerHTML),M&&!M.getAttribute("ghost-table")){for(var X=m.current.get(ae),le=v.current.get(oe);M.firstChild;)M.removeChild(M.firstChild);if(X&&le)M.appendChild(le);else{var ye=React.createElement(R,{instance:I,TD:M,row:N,col:H,prop:L,value:A,cellProperties:k}),pe=createPortal(ye,M.ownerDocument,ae,le),he=pe.portal,Me=pe.portalContainer;v.current.set(oe,Me),M.appendChild(Me),m.current.set(ae,he)}}return f.current.set("".concat(N,"-").concat(H),M),M}},[]),E=React.useRef(function(){}),C=React.useCallback(function(R){E.current=R},[]),b=React.useCallback(function(){E.current(_toConsumableArray(m.current.values()))},[]),P=React.useMemo(function(){return{componentRendererColumns:h.current,columnsSettings:u.current,emitColumnSettings:d,getRendererWrapper:w,clearPortalCache:p,clearRenderedCellCache:g,setRenderersPortalManagerRef:C,pushCellPortalsIntoPortalManager:b}},[d,w,g,C,b]);return React.createElement(HotTableContext.Provider,{value:P},c)};function useHotTableContext(){return React.useContext(HotTableContext)}var HotColumnContext=React.createContext(void 0),HotColumnContextProvider=function(s){var c=s.columnIndex,u=s.getOwnerDocument,d=s.children,h=React.useMemo(function(){return{columnIndex:c,getOwnerDocument:u}},[c,u]);return React.createElement(HotColumnContext.Provider,{value:h},d)},useHotColumnContext=function(){return React.useContext(HotColumnContext)},AbstractMethods=["close","focus","open"],ExcludedMethods=["getValue","setValue"],MethodsMap={open:"onOpen",close:"onClose",prepare:"onPrepare",focus:"onFocus"};function makeEditorClass(a,s){return(function(c){function u(d){var h;return _classCallCheck(this,u),h=_callSuper(this,u,[d]),s.current=h,Object.getOwnPropertyNames(Handsontable.editors.BaseEditor.prototype).forEach(function(f){if(!(f==="constructor"||ExcludedMethods.includes(f))){var g=Handsontable.editors.BaseEditor.prototype[f];u.prototype[f]=(function(){for(var m,p,v=arguments.length,w=new Array(v),E=0;E<v;E++)w[E]=arguments[E];if(AbstractMethods.includes(f)||(p=g.call.apply(g,[this].concat(w))),MethodsMap[f]&&(m=a.current)!==null&&m!==void 0&&m[MethodsMap[f]]){var C;p=(C=a.current[MethodsMap[f]]).call.apply(C,[this].concat(w))}return p}).bind(h)}}),h}return _inherits(u,c),_createClass(u,[{key:"focus",value:function(){}},{key:"getValue",value:function(){return this.value}},{key:"setValue",value:function(h){this.value=h}},{key:"open",value:function(){}},{key:"close",value:function(){}}])})(Handsontable.editors.BaseEditor)}var EditorContext=React.createContext(void 0),EditorContextProvider=function(s){var c=s.hooksRef,u=s.hotCustomEditorInstanceRef,d=s.children;return React.createElement(EditorContext.Provider,{value:{hooksRef:c,hotCustomEditorInstanceRef:u}},d)},isHotColumn=function(s){return s.type===HotColumn},internalProps=["_columnIndex","_getOwnerDocument","children"],HotColumn=function(s){var c=useHotTableContext(),u=c.componentRendererColumns,d=c.emitColumnSettings,h=c.getRendererWrapper,f=useHotColumnContext(),g=f.columnIndex,m=f.getOwnerDocument,p=React.useRef(null),v=React.useRef(null);React.useEffect(function(){var E=function(){return Object.keys(s).filter(function(R){return!internalProps.includes(R)}).reduce(function(R,T){return R[T]=s[T],R},{})},C=function(){var R=SettingsMapper.getSettings(E());return s.renderer?(R.renderer=h(s.renderer),u.set(g,!0)):s.hotRenderer&&(R.renderer=s.hotRenderer),s.editor?R.editor=makeEditorClass(p,v):s.hotEditor&&(R.editor=s.hotEditor),R},b=C();d(b,g),displayObsoleteRenderersEditorsWarning(s.children)||displayAnyChildrenWarning(s.children)});var w=createEditorPortal(m(),s.editor);return React.createElement(EditorContextProvider,{hooksRef:p,hotCustomEditorInstanceRef:v},w)},version="16.2.0",RenderersPortalManager=React.forwardRef(function(a,s){var c=React.useState([]),u=_slicedToArray(c,2),d=u[0],h=u[1];return React.useImperativeHandle(s,function(){return h}),React.createElement(React.Fragment,null,d)});function getDefaultExportFromCjs$1(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var propTypes={exports:{}},ReactPropTypesSecret_1,hasRequiredReactPropTypesSecret;function requireReactPropTypesSecret(){if(hasRequiredReactPropTypesSecret)return ReactPropTypesSecret_1;hasRequiredReactPropTypesSecret=1;var a="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return ReactPropTypesSecret_1=a,ReactPropTypesSecret_1}var factoryWithThrowingShims,hasRequiredFactoryWithThrowingShims;function requireFactoryWithThrowingShims(){if(hasRequiredFactoryWithThrowingShims)return factoryWithThrowingShims;hasRequiredFactoryWithThrowingShims=1;var a=requireReactPropTypesSecret();function s(){}function c(){}return c.resetWarningCache=s,factoryWithThrowingShims=function(){function d(g,m,p,v,w,E){if(E!==a){var C=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw C.name="Invariant Violation",C}}d.isRequired=d;function h(){return d}var f={array:d,bigint:d,bool:d,func:d,number:d,object:d,string:d,symbol:d,any:d,arrayOf:h,element:d,elementType:d,instanceOf:h,node:d,objectOf:h,oneOf:h,oneOfType:h,shape:h,exact:h,checkPropTypes:c,resetWarningCache:s};return f.PropTypes=f,f},factoryWithThrowingShims}propTypes.exports=requireFactoryWithThrowingShims()();var propTypesExports=propTypes.exports,PropTypes=getDefaultExportFromCjs$1(propTypesExports),HotTableInner=React.forwardRef(function(a,s){var c=React.useRef(null),u=React.useRef(null),d=React.useRef(null),h=React.useRef(null),f=React.useRef(),g=useHotTableContext(),m=React.useCallback(function(){return!c.current||!c.current.isDestroyed?c.current:(console.warn(HOT_DESTROYED_WARNING),null)},[c]),p=React.useCallback(function(){return!c.current||c.current.isDestroyed},[c]),v=React.useCallback(function(){g.clearRenderedCellCache(),g.componentRendererColumns.clear()},[g]),w=React.useCallback(function(){return isCSR()?u.current?u.current.ownerDocument:document:null},[u]),E=function(){var I,M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},H=p()?[]:((I=m())===null||I===void 0||(I=I.getSettings())===null||I===void 0?void 0:I._initOnlySettings)||[],L=SettingsMapper.getSettings(a,{prevProps:N,isInit:M,initOnlySettingKeys:H});return g.columnsSettings.length&&(L.columns=g.columnsSettings),a.renderer?(L.renderer=g.getRendererWrapper(a.renderer),g.componentRendererColumns.set("global",!0)):L.renderer=a.hotRenderer||_getItem$2("text"),a.editor?L.editor=makeEditorClass(d,h):L.editor=a.hotEditor||_getItem$3("text"),L},C=function(I){var M,N;I&&((M=I.getPlugin("autoRowSize"))!==null&&M!==void 0&&M.enabled||(N=I.getPlugin("autoColumnSize"))!==null&&N!==void 0&&N.enabled)&&g.componentRendererColumns.size>0&&warn(AUTOSIZE_WARNING)};React.useEffect(function(){var T=E(!0);return f.current=a,c.current=new Handsontable.Core(u.current,T),c.current.addHook("beforeViewRender",function(){g.clearPortalCache(),g.clearRenderedCellCache()}),c.current.addHook("afterViewRender",function(){g.pushCellPortalsIntoPortalManager()}),c.current.init(),C(c.current),displayObsoleteRenderersEditorsWarning(a.children)||displayChildrenOfTypeWarning(a.children,HotColumn),function(){var I;v(),(I=m())===null||I===void 0||I.destroy()}},[]),useUpdateEffect(function(){v();var T=m(),I=E(!1,f.current);f.current=a,T?.updateSettings(I,!1),C(T),displayObsoleteRenderersEditorsWarning(a.children)}),React.useImperativeHandle(s,function(){return{get hotElementRef(){return u.current},get hotInstance(){return m()}}});var b=React.Children.toArray(a.children).filter(isHotColumn).map(function(T,I){return React.createElement(HotColumnContextProvider,{columnIndex:I,getOwnerDocument:w,key:I},T)}),P=getContainerAttributesProps(a),R=createEditorPortal(w(),a.editor);return React.createElement(React.Fragment,null,React.createElement("div",Object.assign({ref:u},P),b),React.createElement(RenderersPortalManager,{ref:g.setRenderersPortalManagerRef}),React.createElement(EditorContextProvider,{hooksRef:d,hotCustomEditorInstanceRef:h},R))});HotTableInner.propTypes={style:PropTypes.object,id:PropTypes.string,className:PropTypes.string};var _excluded=["children"],HotTable=React.forwardRef(function(a,s){var c,u=a.children,d=_objectWithoutProperties(a,_excluded),h=(c=d.id)!==null&&c!==void 0?c:React.useId();return React.createElement(HotTableContextProvider,null,React.createElement(HotTableInner,Object.assign({id:h},d,{ref:s}),u))});HotTable.version=version;const TemplateTable=React.forwardRef(({children:a,extendActions:s,tableProps:c,syncData:u,isValid:d,setSelectedRows:h,setSelectedRange:f},g)=>{const m=React.useRef(),p={getData:R,saveData:T,setData(A){const k=E();A&&k&&(k.loadData(A),k.render())},getCellData(A,k){return E()?.getDataAtRowProp(A,k)},setCellData(A,k,W){const G=E();if(!G)return;const oe=W!==void 0?W:C(G);return oe!=-1&&G.setDataAtRowProp(oe,A,k),oe},appendCellData(A){const k=E();if(!k)return;const W=C(k),G=k.countRows(),oe=W+A.length-G;oe>0&&k.alter("insert_row_below",W,oe),k.setDataAtRowProp(A.map(({prop:ae,value:X},le)=>[W+le,ae,X]))},findFirstEmptyRow:C,getSelectedRows:I},w=s({getHot:E},p);React.useImperativeHandle(g,()=>({...p,...w}));function E(){return m.current?.hotInstance}function C(A){const k=R();if(!k)return-1;const W=k.findIndex(G=>!d(G));return W!==-1?W:(A.alter("insert_row_below"),k.length)}function b(A,k){const W=[],G=A.countRows();for(let oe=0;oe<G;oe++){const ae=A.toPhysicalRow(oe),X=A.getSourceDataAtRow(ae);k(X)&&W.push(oe)}return W}function P(A,k){const W=b(A,k);A.alter("remove_row",W.map(G=>[G,1]))}function R(){const A=m.current?.hotInstance;if(A)return P(A,k=>!d(k)),Array.from({length:A.countRows()},(k,W)=>{const G=A.toPhysicalRow(W);return A.getSourceDataAtRow(G)}).filter(k=>d(k)).map((k,W)=>({...k,index:W}))}function T(){const A=R();A&&u(A)}function I(){const A=E(),k=A?.getSelectedRange();if(!A||!k)return[];const W=new Set;return k.forEach(G=>{if(G.from.col===-1)for(let oe=G.from.row;oe<=G.to.row;oe++)W.add(oe)}),[...W].sort()}function M(){h?.(I()),f?.(E()?.getSelectedRange())}function N(A){A&&setTimeout(()=>{A.refreshDimensions(),A.render()},500)}function H(A,k){const W=E();W&&m.current&&A?.some(([G,oe,ae,X])=>(ae||X)&&ae!=X)&&k!=="loadData"&&(T(),N(W))}function L(A,k,W,G,oe){const ae=m.current?.hotInstance;ae&&oe&&(T(),N(ae))}return jsxRuntime.jsx(HotTable,{ref:A=>{A&&!m.current&&(m.current=A,setTimeout(()=>{A.hotInstance?.refreshDimensions(),A.hotInstance?.render()},1e3))},licenseKey:"non-commercial-and-evaluation",stretchH:"all",width:"100%",minRows:100,maxRows:1e3,autoRowSize:!1,autoColumnSize:!1,allowRemoveRow:!0,manualRowMove:!0,afterRowMove:L,rowHeights:30,rowHeaders:!0,afterChange:H,afterSelectionEnd:M,beforeCopy:(A,k)=>{for(let W=0;W<A.length;W++)for(let G=0;G<A[W].length;G++){const oe=A[W][G];oe&&typeof oe=="object"&&(A[W][G]=JSON.stringify(oe))}},beforePaste:(A,k)=>{const W=m.current?.hotInstance;if(W)for(let G=0;G<A.length;G++)for(let oe=0;oe<A[G].length;oe++){const ae=A[G][oe];if(ae.startsWith("[")||ae.startsWith("{"))try{const X=JSON.parse(ae);W.getCellMeta(G,oe).customType==="object"?A[G][oe]=X:A[G][oe]=""}catch{}}},...c,children:a})});function isValid(a){return!!a.images?.[0]?.base64||!!a.prompt}function DataSheet({settings:a,setTableActions:s,setSelectedRows:c}){const{platform:u,count:d,config:h}=React.useContext(AppContext),f=React.useRef(null),g=React.useMemo(()=>a.times*d,[a.times]),m=React.useRef();React.useEffect(()=>{mc.send("getPromptData",u).then(I=>{f.current?.setData([...I])})},[]),React.useEffect(()=>{s({...f.current})},[f.current]),useEmitter([{name:"addTextToCell",callback:p}]);function p(I){f.current?.addTextToCell(I)}async function v(I){const M=[];for(let N=0;N<I.length;N++){const H=I[N],L=await fileToBase64(H);M.push({filename:H.name,base64:L})}f.current?.appendCellData(M.map(N=>({prop:"images",value:[N]})))}async function w(){const I=await fileInput({accept:supportedFiles.image,multiple:!0});I.length&&v(I)}async function E(I){I.preventDefault();const M=I.dataTransfer.files,N=Array.from(M).filter(H=>H.type.startsWith("image/"));N.length&&v(N)}async function C(I,M){if(!f.current)return;let N=f.current.getCellData(M,"images");if(N?.[0]?.base64||(N=[]),I.length){const H=[];for(const L of I){const A=await fileToBase64(L);H.push({filename:L.name,base64:A})}f.current.setCellData("images",[...N,...H],M)}}async function b(I){const M=I.currentTarget.dataset.row;if(M){const N=await fileInput({accept:supportedFiles.image,multiple:!0});C(N,Number(M))}}function P(I){I.preventDefault(),I.stopPropagation();const M=I.currentTarget.dataset.row,N=I.dataTransfer.files;if(N.length&&M){const H=Array.from(N).filter(L=>L.type.startsWith("image/"));H.length&&C(H,Number(M))}}function R(I){if(!f.current)return;const M=I.currentTarget;let N=M.dataset.row,H=M.dataset.index;if(!N||!H)return;N=Number(N),H=Number(H);const L=f.current.getCellData(N,"images");if(L){const A=L.filter((k,W)=>W!==Number(H));f.current.setCellData("images",A,N)}}function T(I){mc.send("setPromptData",u,I)}return jsxRuntime.jsx("div",{className:"w-full h-full",onDrop:E,onDragOver:I=>I.preventDefault(),children:jsxRuntime.jsxs(TemplateTable,{ref:f,setSelectedRows:c,setSelectedRange:I=>{m.current=I},tableProps:{className:"batch-table",afterGetColHeader(I,M){if(I===0&&(window.uploadImage||h?.supportImage)&&!M.querySelector("button")){M.innerHTML="";const N=document.createElement("button");N.classList.add("upload-image-btn"),N.innerText="上传图片",N.addEventListener("click",w),M.appendChild(N)}}},extendActions:(I,M)=>({addImagesToSheet(N){if(I.getHot()){for(const L of N)M.setCellData("images",[L]);M.saveData()}},resetSuccessCount(N){for(const H of N)M.setCellData("successCount",0,H);M.saveData()},addSuccessCount(N){for(const H of N){const L=M.getCellData(H,"successCount")??0;M.setCellData("successCount",L+1,H)}M.saveData()},addTextToCell(N){const H=I.getHot();if(!H)return;const L=new Set;if(m.current?.forEach(A=>{for(let k=A.from.row;k<=A.to.row;k++)L.add(k)}),L.size){const A=[];for(const k of L){const W=H.getDataAtRowProp(k,"prompt")??"";A.push([k,"prompt",(N+" "+W).trim()])}H.setDataAtRowProp(A)}console.log(m)}}),syncData:T,isValid,children:[jsxRuntime.jsx(HotColumn,{data:"images",width:150,title:"图片",customType:"object",renderer:ImagesRender,editor:!1,onAddImages:b,onDropImages:P,onDeleteImage:R}),jsxRuntime.jsx(HotColumn,{data:"prompt",width:150,title:"生成文本",renderer:I=>jsxRuntime.jsx("div",{className:"max-h-[30px] leading-none",children:I.value})}),jsxRuntime.jsx(HotColumn,{data:"folder",width:65,title:"下载文件夹"}),jsxRuntime.jsx(HotColumn,{data:"successCount",width:50,title:"状态",readOnly:!0,renderer:I=>{const M=I.instance.getSourceDataAtRow(I.row);return M&&(M.images?.[0]?.base64||M.prompt)?jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[I.value||0,"/",g]}):null}})]})})}function BatchModal(){const{platform:a,limit:s,config:c}=React.useContext(AppContext),[u,d]=React.useState(!1),[h]=useForm(),[f,g]=React.useState(SettingsSchema.default[a].generate),m=React.useRef([]),p=!!window.uploadImage&&(!!window.generateVideo||a===Platform.GROK),[v,w]=React.useState(!1),E=React.useRef(!1),C=React.useRef(0),b=React.useRef([]),[P,R]=React.useState({x:0,y:0,width:0,height:0,adjustable:!1}),T=React.useRef({});React.useEffect(()=>{mc.send("getSettings",a).then(ae=>{R(ae.window)})},[]),useEmitter([{name:"openGenerateWindow",callback:I},{name:"onSubmitSuccess",callback:M},{name:"onReceiveData",callback:N}]);async function I(){const ae=(await mc.send("getSettings",a)).generate;g(ae),d(!0)}function M({id:ae,row:X,...le}){X!=null&&(console.log("收到id：",ae),C.current++,mc.send("addTaskRecord",a,{[ae]:{row:X,...le}}))}async function N(ae){if(console.log("收到处理结果：",ae),!ae)return;const X=await mc.send("getSettings",a),le=X.generate,ye=await mc.send("getTaskRecord",a),pe=Object.entries(ae);for(const[he,Me]of pe){if(!Array.isArray(Me)||!Me.length||!ye[he])continue;const{row:Qe,prompt:Xe,folder:Ke,filename:it}=ye[he];if(Qe!=null){C.current>0&&C.current--,a!==Platform.GROK&&(delete ye[he],await mc.send("setTaskRecord",a,ye));for(let{url:te,thumbnail:Pe}of Me){if(b.current.includes(te))continue;if(b.current.push(te),le.shouldDownload){let Q=typeof it=="string"?it:Array.isArray(it)?it[0]:"";const ee=H(le.folderType,Xe,Ke,Q);let ce="";const ve=te===Pe?"image":"video";/^https?:\/\//.test(te)&&(ce=getExtensionFromUrl(te)),ce||(ve==="image"?ce="jpg":ce="mp4");const K=ee+"."+ce;c?.downloader?c?.downloader(te,K,ve):mc.send("download",te,K,ve).then(ne=>{ne&&antd.message.error(ne)})}if(c?.downloader&&Pe){const Q=await urlToBase64(Pe);Q&&(Pe=Q)}const U=X.submit;(U.history||U.register)&&mc.send("submit",a,{prompt:Xe,imageUrl:Pe,pageTitle:document.title,pageUrl:document.URL}).then(({error:Q})=>{Q?antd.message.error("登记发生错误："+Q):antd.message.success("登记成功")}),await sleep(1)}T.current?.addSuccessCount?.([Qe]),T.current?.saveData?.()}}}function H(ae,X,le,ye){const pe=sanitizeFilename(X).substring(0,20)||ye?.replace(/\.[^.]+?$/,"")||"未命名文件";let he="";switch(ae){case FolderType.BYNAME:he=pe;break;case FolderType.BYDATE:const Me=new Date;he=`${Me.getFullYear()}-${Me.getMonth()+1}-${Me.getDate()}`;break;case FolderType.NOFOLDER:default:he="";break}return`${a}/${he}/${le||""}/${pe}`}React.useEffect(()=>{const ae=mc.on("openModal",I);return()=>{ae()}},[]);function L(ae){w(ae),E.current=ae}async function A(ae){if(!window.setPrompt||!ae&&!window.generate||ae&&!window.generateVideo&&!window.uploadImage)return antd.message.error("页面错误，请检查是否有插件冲突");const X=T.current?.getData?.();if(!X?.length)return antd.message.error("请输入生成词");const le=m.current?.length?m?.current.reduce((ye,pe)=>(isValid(X[pe])&&ye.push(X[pe]),ye),[]):X;if(!le.length)return antd.message.error("请重新选择行");L(!0),T.current.resetSuccessCount&&T.current.resetSuccessCount(le.map(ye=>ye.index).filter(ye=>ye!=null));for(const ye of le){if(!E.current)return;try{c?.operation?await c.operation(ae,ye,le,f,C,E):await k(ae,ye,le)}catch(pe){console.error(pe),antd.message.error("发生错误："+pe.message+"，请刷新页面后重试");break}}G("finish")}async function k(ae,X,le){const{prompt:ye,folder:pe,images:he,index:Me}=X;if(!ae&&!ye&&!c?.allowNoImagePrompt)return;const Qe=ae?"video":"image";c?.initialize?.(),await executeIfExists(window.clearUploadedImages,1,Qe);for(let Xe=0;Xe<f.times;Xe++){if(!E.current)return;if(s)for(;C.current>=s;)await sleep(2);if(window.currentProcess={row:Me,prompt:ye,folder:pe},await executeIfExists(window.startNewChat,2),await executeIfExists(window.setCreateType,1,Qe),(ae||c?.supportImage)&&he?.[0]?.base64&&(!c?.uploadOnce||Xe===0)){let Ke=1;if(c?.uploadAllImagesOnce){window.currentProcess.filename=he.map(Pe=>Pe.filename);const it=he.map(Pe=>base64ToFile(Pe.base64,Pe.filename)),te=await window.uploadImage(it,Qe);if(te){console.error("上传图片发生错误：",te),antd.message.error("上传图片发生错误："+te);return}await sleep(3)}else{c?.[ae?"multiImagesForVideo":"multiImagesForImage"]&&(Ke=he.length);for(let it=0;it<Ke;it++){const te=he[it];window.currentProcess.filename=te.filename;const Pe=base64ToFile(te.base64,te.filename),U=await window.uploadImage([Pe],Qe);if(U){console.error("上传图片发生错误：",U),antd.message.error("上传图片发生错误："+U);return}console.log("上传完成"),await sleep(3)}}}if(ae&&window.uploadEndFrame&&he?.[1]){const Ke=he[1];if(Ke){const it=base64ToFile(Ke.base64,Ke.filename),te=await window.uploadEndFrame([it]);if(te){console.error("上传尾帧发生错误：",te),antd.message.error("上传尾帧发生错误："+te);continue}console.log("上传尾帧完成"),await sleep(3)}}ae&&window.setVideoPrompt&&he?.[0]?.base64?(await sleep(3),window.setVideoPrompt(ye)):window.setPrompt(ye),await sleep(1),ae&&window.generateVideo&&(he?.[0]?.base64||!window.generate)?window.generateVideo():window.generate(),Me===le[le.length-1].index&&Xe===f.times-1?await sleep(10):await sleep(f.interval)}}function W(ae,X){if(Object.values(X).some(le=>le==null))return antd.message.error("设置不能为空！");g(X),mc.send("updateSettings",a,{generate:X})}function G(ae){c?.keepProcess||(window.currentProcess={row:null,prompt:"",folder:""}),L(!1),ae==="finish"?antd.message.success("操作完成，请等待下载完成"):antd.message.info("停止运行，请等待下载完成")}function oe(ae){R(ae),mc.send("updateSettings",a,{window:ae})}return jsxRuntime.jsx(AdjustableWindow,{className:"batch-modal",open:u,onCancel:()=>d(!1),title:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:["批量生成 ",jsxRuntime.jsx("span",{style:{color:"red"},children:c?.hint})]}),footer:jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(antd.Form,{form:h,layout:"horizontal",onValuesChange:W,initialValues:f,disabled:v,children:jsxRuntime.jsxs("div",{className:"footer-div",children:[jsxRuntime.jsx(antd.Form.Item,{name:"times",label:"生成次数",children:jsxRuntime.jsx(antd.InputNumber,{type:"number",min:1,max:99,addonAfter:"次",controls:!1})}),jsxRuntime.jsx(antd.Form.Item,{name:"interval",label:"生成间隔",children:jsxRuntime.jsx(antd.InputNumber,{type:"number",min:5,max:999,addonAfter:"秒",controls:!1})}),jsxRuntime.jsx(antd.Form.Item,{name:"shouldDownload",label:"是否下载图片",valuePropName:"checked",children:jsxRuntime.jsx(antd.Checkbox,{})}),jsxRuntime.jsx(antd.Form.Item,{name:"folderType",label:"文件夹命名",children:jsxRuntime.jsx(antd.Select,{options:Object.entries(FolderType).map(([ae,X])=>({key:ae,value:X}))})})]})}),jsxRuntime.jsxs("div",{className:"footer-div",children:[!!window.setPrompt&&!!window.generate&&jsxRuntime.jsx(antd.Button,{type:"primary",onClick:()=>A(!1),loading:v,children:"生成图片"}),window.generateVideo&&window.uploadImage&&window.setPrompt||a===Platform.GROK?jsxRuntime.jsx(antd.Button,{type:"primary",onClick:()=>A(!0),loading:v,disabled:!p,children:"生成视频"}):null,jsxRuntime.jsx(antd.Button,{onClick:()=>G("stop"),children:"停止生成"})]})]}),windowProps:P,onAdjust:oe,children:jsxRuntime.jsx(antd.Spin,{spinning:v,style:{width:"100%",height:"100%"},children:jsxRuntime.jsx("div",{className:"flex flex-col",children:jsxRuntime.jsx("div",{className:"flex-1",children:jsxRuntime.jsx(DataSheet,{setSelectedRows:ae=>{m.current=ae},settings:f,setTableActions:ae=>{T.current=ae}})})})})})}async function executeIfExists(a,s,...c){a&&(a(...c),await sleep(s))}function ImageCard({info:a,onChange:s}){return jsxRuntime.jsxs("div",{onClick:()=>s(a.id),style:{position:"relative",width:165,height:300,float:"left",display:"flex",alignItems:"center",cursor:"pointer"},children:[jsxRuntime.jsx("img",{src:a.image,style:{objectFit:"contain",borderRadius:10}}),jsxRuntime.jsx("input",{type:"checkbox",checked:a.checked,style:{position:"absolute",right:8,top:8,width:24,height:24}})]})}function DeleteWindow(){const[a,s]=React.useState(!1),[c,u]=React.useState([]);function d(){u(window.videoStorage.map(p=>({...p,checked:!1}))),s(!0)}useEmitter([{name:"openDeleteWindow",callback:d}]);function h(p){u(v=>{const w=v.find(E=>E.id===p);return w&&(w.checked=!w.checked),[...v]})}function f(){u(p=>p.map(v=>({...v,checked:!0})))}function g(){u(p=>p.map(v=>({...v,checked:!v.checked})))}async function m(){const p=c.filter(v=>v.checked).map(v=>v.id);if(!p.length)return antd.message.error("没有选中项目");antd.Modal.confirm({title:"警告",content:`确定要删除${p.length}个项目吗？`,async onOk(){const v=await window.deleteHistory(p);if(v.error)return antd.message.error("删除失败："+v.error);if(!Array.isArray(v.ids)||!v.ids.length)return antd.message.error("未删除任何内容");window.videoStorage=window.videoStorage.filter(w=>!v.ids.includes(w.id)),u(window.videoStorage.map(w=>({...w,checked:!1}))),antd.message.success(`成功删除${v.ids.length}个内容，请刷新界面显示最新内容`)},okText:"删除",cancelText:"取消"})}return jsxRuntime.jsx(antd.Modal,{open:a,width:1450,onCancel:()=>s(!1),title:"删除窗口",footer:[jsxRuntime.jsx(antd.Button,{onClick:f,children:"全选"},"selectAll"),jsxRuntime.jsx(antd.Button,{onClick:g,children:"反选"},"inverseSelect"),jsxRuntime.jsx(antd.Button,{color:"danger",variant:"solid",onClick:m,disabled:!c.filter(p=>p.checked).length,children:"删除"},"delete")],children:jsxRuntime.jsx("div",{className:"flex-r",style:{flexWrap:"wrap",gap:5,overflowY:"auto",height:900},children:c.map(p=>jsxRuntime.jsx(ImageCard,{info:p,onChange:h},p.id))})})}function commonjsRequire$1(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist$3={exports:{}},jsuites$1={exports:{}},jsuites=jsuites$1.exports,hasRequiredJsuites;function requireJsuites(){return hasRequiredJsuites||(hasRequiredJsuites=1,(function(a,s){(function(c,u){a.exports=u()})(jsuites,(function(){var c;return(function(){var u={195:(function(g){(function(m,p){g.exports=p()})(this,(function(){return(function(Pe){function p(ee,ce){this.highOrder=ee,this.lowOrder=ce}var v=[new p(1779033703,4089235720),new p(3144134277,2227873595),new p(1013904242,4271175723),new p(2773480762,1595750129),new p(1359893119,2917565137),new p(2600822924,725511199),new p(528734635,4215389547),new p(1541459225,327033209)],w=[new p(1116352408,3609767458),new p(1899447441,602891725),new p(3049323471,3964484399),new p(3921009573,2173295548),new p(961987163,4081628472),new p(1508970993,3053834265),new p(2453635748,2937671579),new p(2870763221,3664609560),new p(3624381080,2734883394),new p(310598401,1164996542),new p(607225278,1323610764),new p(1426881987,3590304994),new p(1925078388,4068182383),new p(2162078206,991336113),new p(2614888103,633803317),new p(3248222580,3479774868),new p(3835390401,2666613458),new p(4022224774,944711139),new p(264347078,2341262773),new p(604807628,2007800933),new p(770255983,1495990901),new p(1249150122,1856431235),new p(1555081692,3175218132),new p(1996064986,2198950837),new p(2554220882,3999719339),new p(2821834349,766784016),new p(2952996808,2566594879),new p(3210313671,3203337956),new p(3336571891,1034457026),new p(3584528711,2466948901),new p(113926993,3758326383),new p(338241895,168717936),new p(666307205,1188179964),new p(773529912,1546045734),new p(1294757372,1522805485),new p(1396182291,2643833823),new p(1695183700,2343527390),new p(1986661051,1014477480),new p(2177026350,1206759142),new p(2456956037,344077627),new p(2730485921,1290863460),new p(2820302411,3158454273),new p(3259730800,3505952657),new p(3345764771,106217008),new p(3516065817,3606008344),new p(3600352804,1432725776),new p(4094571909,1467031594),new p(275423344,851169720),new p(430227734,3100823752),new p(506948616,1363258195),new p(659060556,3750685593),new p(883997877,3785050280),new p(958139571,3318307427),new p(1322822218,3812723403),new p(1537002063,2003034995),new p(1747873779,3602036899),new p(1955562222,1575990012),new p(2024104815,1125592928),new p(2227730452,2716904306),new p(2361852424,442776044),new p(2428436474,593698344),new p(2756734187,3733110249),new p(3204031479,2999351573),new p(3329325298,3815920427),new p(3391569614,3928383900),new p(3515267271,566280711),new p(3940187606,3454069534),new p(4118630271,4000239992),new p(116418474,1914138554),new p(174292421,2731055270),new p(289380356,3203993006),new p(460393269,320620315),new p(685471733,587496836),new p(852142971,1086792851),new p(1017036298,365543100),new p(1126000580,2618297676),new p(1288033470,3409855158),new p(1501505948,4234509866),new p(1607167915,987167468),new p(1816402316,1246189591)],E=new Array(64),C,b,P,R,T,I,M,N,H,L,A,k,W=8;function G(ee){return unescape(encodeURIComponent(ee))}function oe(ee){for(var ce=[],ve=(1<<W)-1,K=ee.length*W,ne=0;ne<K;ne+=W)ce[ne>>5]|=(ee.charCodeAt(ne/W)&ve)<<32-W-ne%32;return ce}function ae(ee){for(var ce="0123456789abcdef",ve="",K=ee.length*4,ne,de=0;de<K;de+=1)ne=ee[de>>2]>>(3-de%4)*8,ve+=ce.charAt(ne>>4&15)+ce.charAt(ne&15);return ve}function X(ee,ce){var ve,K,ne,de;return ve=(ee.lowOrder&65535)+(ce.lowOrder&65535),K=(ee.lowOrder>>>16)+(ce.lowOrder>>>16)+(ve>>>16),ne=(K&65535)<<16|ve&65535,ve=(ee.highOrder&65535)+(ce.highOrder&65535)+(K>>>16),K=(ee.highOrder>>>16)+(ce.highOrder>>>16)+(ve>>>16),de=(K&65535)<<16|ve&65535,new p(de,ne)}function le(ee,ce,ve,K){var ne,de,Oe,Se;return ne=(ee.lowOrder&65535)+(ce.lowOrder&65535)+(ve.lowOrder&65535)+(K.lowOrder&65535),de=(ee.lowOrder>>>16)+(ce.lowOrder>>>16)+(ve.lowOrder>>>16)+(K.lowOrder>>>16)+(ne>>>16),Oe=(de&65535)<<16|ne&65535,ne=(ee.highOrder&65535)+(ce.highOrder&65535)+(ve.highOrder&65535)+(K.highOrder&65535)+(de>>>16),de=(ee.highOrder>>>16)+(ce.highOrder>>>16)+(ve.highOrder>>>16)+(K.highOrder>>>16)+(ne>>>16),Se=(de&65535)<<16|ne&65535,new p(Se,Oe)}function ye(ee,ce,ve,K,ne){var de,Oe,Se,ge;return de=(ee.lowOrder&65535)+(ce.lowOrder&65535)+(ve.lowOrder&65535)+(K.lowOrder&65535)+(ne.lowOrder&65535),Oe=(ee.lowOrder>>>16)+(ce.lowOrder>>>16)+(ve.lowOrder>>>16)+(K.lowOrder>>>16)+(ne.lowOrder>>>16)+(de>>>16),Se=(Oe&65535)<<16|de&65535,de=(ee.highOrder&65535)+(ce.highOrder&65535)+(ve.highOrder&65535)+(K.highOrder&65535)+(ne.highOrder&65535)+(Oe>>>16),Oe=(ee.highOrder>>>16)+(ce.highOrder>>>16)+(ve.highOrder>>>16)+(K.highOrder>>>16)+(ne.highOrder>>>16)+(de>>>16),ge=(Oe&65535)<<16|de&65535,new p(ge,Se)}function pe(ee,ce,ve){return new p(ee.highOrder&ce.highOrder^ee.highOrder&ve.highOrder^ce.highOrder&ve.highOrder,ee.lowOrder&ce.lowOrder^ee.lowOrder&ve.lowOrder^ce.lowOrder&ve.lowOrder)}function he(ee,ce,ve){return new p(ee.highOrder&ce.highOrder^~ee.highOrder&ve.highOrder,ee.lowOrder&ce.lowOrder^~ee.lowOrder&ve.lowOrder)}function Me(ee,ce){return ce<=32?new p(ee.highOrder>>>ce|ee.lowOrder<<32-ce,ee.lowOrder>>>ce|ee.highOrder<<32-ce):new p(ee.lowOrder>>>ce|ee.highOrder<<32-ce,ee.highOrder>>>ce|ee.lowOrder<<32-ce)}function Qe(ee){var ce=Me(ee,28),ve=Me(ee,34),K=Me(ee,39);return new p(ce.highOrder^ve.highOrder^K.highOrder,ce.lowOrder^ve.lowOrder^K.lowOrder)}function Xe(ee){var ce=Me(ee,14),ve=Me(ee,18),K=Me(ee,41);return new p(ce.highOrder^ve.highOrder^K.highOrder,ce.lowOrder^ve.lowOrder^K.lowOrder)}function Ke(ee){var ce=Me(ee,1),ve=Me(ee,8),K=te(ee,7);return new p(ce.highOrder^ve.highOrder^K.highOrder,ce.lowOrder^ve.lowOrder^K.lowOrder)}function it(ee){var ce=Me(ee,19),ve=Me(ee,61),K=te(ee,6);return new p(ce.highOrder^ve.highOrder^K.highOrder,ce.lowOrder^ve.lowOrder^K.lowOrder)}function te(ee,ce){return ce<=32?new p(ee.highOrder>>>ce,ee.lowOrder>>>ce|ee.highOrder<<32-ce):new p(0,ee.highOrder<<32-ce)}var Pe=G(Pe),U=Pe.length*W;Pe=oe(Pe),Pe[U>>5]|=128<<24-U%32,Pe[(U+128>>10<<5)+31]=U;for(var H=0;H<Pe.length;H+=32){C=v[0],b=v[1],P=v[2],R=v[3],T=v[4],I=v[5],M=v[6],N=v[7];for(var L=0;L<80;L++)L<16?E[L]=new p(Pe[L*2+H],Pe[L*2+H+1]):E[L]=le(it(E[L-2]),E[L-7],Ke(E[L-15]),E[L-16]),A=ye(N,Xe(T),he(T,I,M),w[L],E[L]),k=X(Qe(C),pe(C,b,P)),N=M,M=I,I=T,T=X(R,A),R=P,P=b,b=C,C=X(A,k);v[0]=X(C,v[0]),v[1]=X(b,v[1]),v[2]=X(P,v[2]),v[3]=X(R,v[3]),v[4]=X(T,v[4]),v[5]=X(I,v[5]),v[6]=X(M,v[6]),v[7]=X(N,v[7])}for(var Q=[],H=0;H<v.length;H++)Q.push(v[H].highOrder),Q.push(v[H].lowOrder);return ae(Q)})}))})},d={};function h(g){var m=d[g];if(m!==void 0)return m.exports;var p=d[g]={exports:{}};return u[g].call(p.exports,p,p.exports,h),p.exports}(function(){h.n=function(g){var m=g&&g.__esModule?function(){return g.default}:function(){return g};return h.d(m,{a:m}),m}})(),(function(){h.d=function(g,m){for(var p in m)h.o(m,p)&&!h.o(g,p)&&Object.defineProperty(g,p,{enumerable:!0,get:m[p]})}})(),(function(){h.o=function(g,m){return Object.prototype.hasOwnProperty.call(g,m)}})();var f={};(function(){h.d(f,{default:function(){return Rt}});var g=function(V){document.dictionary||(document.dictionary={});var q=null,D=Object.keys(V);for(q=0;q<D.length;q++)document.dictionary[D[q]]=V[D[q]]},m=function(V){return typeof document<"u"&&document.dictionary&&document.dictionary[V]||V},p={setDictionary:g,translate:m},w=function(V,q){if(q===!0)window.jSuitesStateControl=window.jSuitesStateControl.filter(function(O){return O!==null}),setTimeout(function(){window.jSuitesStateControl.push(V)},0);else{var D=window.jSuitesStateControl.indexOf(V);D>=0&&window.jSuitesStateControl.splice(D,1)}},E={};E.two=function(V){return V=""+V,V.length==1&&(V="0"+V),V},E.focus=function(V){if(V.textContent.length){const q=document.createRange(),D=window.getSelection();let O=V;for(;O.lastChild;)O=O.lastChild;O.nodeType===Node.TEXT_NODE?q.setStart(O,O.length):q.setStart(O,O.childNodes.length),q.collapse(!0),D.removeAllRanges(),D.addRange(q),V.scrollLeft=V.scrollWidth}},E.isNumeric=(function(V){return typeof V=="string"&&(V=V.trim()),!isNaN(V)&&V!==null&&V!==""}),E.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(V){var q=Math.random()*16|0,D=V=="x"?q:q&3|8;return D.toString(16)})},E.getNode=function(){var V=document.getSelection().anchorNode;return V?V.nodeType==3?V.parentNode:V:null},E.hash=function(V){var q=0,D,O;if(V.length===0)return q;for(D=0;D<V.length;D++)O=V.charCodeAt(D),O>32&&(q=(q<<5)-q+O,q|=0);return q},E.randomColor=function(V){var q=-.25,D=("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");D.length<6&&(D=D[0]+D[0]+D[1]+D[1]+D[2]+D[2]);var O=[],re,Ee;for(Ee=0;Ee<3;Ee++)re=parseInt(D.substr(Ee*2,2),16),re=Math.round(Math.min(Math.max(0,re+re*q),255)).toString(16),O.push(("00"+re).substr(re.length));return V==!0?"#"+E.two(O[0].toString(16))+E.two(O[1].toString(16))+E.two(O[2].toString(16)):O},E.getWindowWidth=function(){var V=window,q=document,D=q.documentElement,O=q.getElementsByTagName("body")[0],re=V.innerWidth||D.clientWidth||O.clientWidth;return re},E.getWindowHeight=function(){var V=window,q=document,D=q.documentElement,O=q.getElementsByTagName("body")[0],re=V.innerHeight||D.clientHeight||O.clientHeight;return re},E.getPosition=function(V){if(V.changedTouches&&V.changedTouches[0])var q=V.changedTouches[0].pageX,D=V.changedTouches[0].pageY;else var q=window.Event?V.pageX:V.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),D=window.Event?V.pageY:V.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[q,D]},E.click=function(V){if(V.click)V.click();else{var q=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});V.dispatchEvent(q)}},E.findElement=function(V,q){var D=!1;function O(re){re&&!D&&(typeof q=="function"?D=q(re):typeof q=="string"&&re.classList&&re.classList.contains(q)&&(D=re)),re.parentNode&&!D&&O(re.parentNode)}return O(V),D};var C=E;const b=function(V){return typeof V=="object"||typeof V=="function"};function P(V,q,D){if(typeof V!="string"||V.length===0)return;const O=V.split(".");if(O.length===0)return;let re=this;if(typeof q>"u"&&typeof D>"u"){for(let we=0;we<O.length;we++){const Z=O[we];if(re!=null&&b(re)&&Object.prototype.hasOwnProperty.call(re,Z))re=re[Z];else return}return re}for(let we=0;we<O.length-1;we++){const Z=O[we];if(re==null||!b(re))return console.warn(`Cannot set value: path '${V}' blocked by invalid object at '${Z}'`),!1;Object.prototype.hasOwnProperty.call(re,Z)&&(re[Z]==null||!b(re[Z]))?re[Z]={}:Object.prototype.hasOwnProperty.call(re,Z)||(re[Z]={}),re=re[Z]}const Ee=O[O.length-1];return re==null||!b(re)?!1:D===!0?Object.prototype.hasOwnProperty.call(re,Ee)?(delete re[Ee],!0):!1:(re[Ee]=q,!0)}function R(V,q){var D={};D.options={};var O={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},re=null;for(var Ee in O)q&&q.hasOwnProperty(Ee)?D.options[Ee]=q[Ee]:D.options[Ee]=O[Ee];V.classList.add("jsorting"),V.addEventListener("dragstart",function(Y){let se=Y.target;if(se.nodeType===3)if(se.parentNode.getAttribute("draggable")==="true")se=se.parentNode;else{Y.preventDefault(),Y.stopPropagation();return}if(se.getAttribute("draggable")==="true"){let _e=Array.prototype.indexOf.call(se.parentNode.children,se);re={element:se,o:_e,d:_e},se.style.opacity="0.25",typeof D.options.ondragstart=="function"&&D.options.ondragstart(V,se,Y),Y.dataTransfer.setDragImage(se,0,0)}}),V.addEventListener("dragover",function(Y){if(Y.preventDefault(),re&&we(Y.target)&&Y.target.getAttribute("draggable")=="true"&&re.element!=Y.target){if(D.options.direction)var se=Y.target.clientWidth/2>Y.offsetX;else var se=Y.target.clientHeight/2>Y.offsetY;se?Y.target.parentNode.insertBefore(re.element,Y.target):Y.target.parentNode.insertBefore(re.element,Y.target.nextSibling),re.d=Array.prototype.indexOf.call(Y.target.parentNode.children,re.element)}}),V.addEventListener("dragleave",function(Y){Y.preventDefault()}),V.addEventListener("dragend",function(Y){Y.preventDefault(),re&&(typeof D.options.ondragend=="function"&&D.options.ondragend(V,re.element,Y),re.o<re.d?Y.target.parentNode.insertBefore(re.element,Y.target.parentNode.children[re.o]):Y.target.parentNode.insertBefore(re.element,Y.target.parentNode.children[re.o].nextSibling),re.element.style.opacity="",re=null)}),V.addEventListener("drop",function(Y){Y.preventDefault(),re&&(re.o!==re.d&&typeof D.options.ondrop=="function"&&D.options.ondrop(V,re.o,re.d,re.element,Y.target,Y),re.element.style.opacity="",re=null)});for(var we=function(Y){var se=!1;function _e(Ae){Ae.className&&Ae.classList.contains("jsorting")&&(se=!0),se||_e(Ae.parentNode)}return _e(Y),se},Z=0;Z<V.children.length;Z++)V.children[Z].hasAttribute("draggable")||V.children[Z].setAttribute("draggable","true");return V.val=function(){for(var Y=null,se=[],_e=0;_e<V.children.length;_e++)(Y=V.children[_e].getAttribute("data-id"))&&se.push(Y);return se},V}function T(V,q){var D={};(!q.loadUp||typeof q.loadUp!="function")&&(q.loadUp=function(){return!1}),(!q.loadDown||typeof q.loadDown!="function")&&(q.loadDown=function(){return!1}),q.timer||(q.timer=100);var O=null,re=function(Ee){if(O==null){var we=!1,Z=V.scrollTop;V.scrollTop+V.clientHeight*2>=V.scrollHeight?q.loadDown()&&(Z==V.scrollTop&&(V.scrollTop=V.scrollTop-V.clientHeight),we=!0):V.scrollTop<=V.clientHeight&&q.loadUp()&&(Z==V.scrollTop&&(V.scrollTop=V.scrollTop+V.clientHeight),we=!0),O=setTimeout(function(){O=null},q.timer),we&&typeof q.onupdate=="function"&&q.onupdate()}};return V.onscroll=function(Ee){re()},V.onwheel=function(Ee){re()},D}function I(){var V=(function(q,D){if(Array.isArray(q)){var O={instance:[],complete:D};if(q.length>0)for(var re=0;re<q.length;re++)q[re].multiple=O,O.instance.push(V(q[re]));return O}if(q.data||(q.data={}),q.type&&(q.method=q.type),q.method||(q.method="GET"),q.dataType||(q.dataType="json"),q.data){var Ee=function(Ae,ke){var je=[];if(Ae){var Ue=Object.keys(Ae);if(Ue.length)for(var et=0;et<Ue.length;et++){if(ke)var st=ke+"["+Ue[et]+"]";else var st=Ue[et];if(Ae[st]instanceof FileList)je[st]=Ae[Ue[et]];else if(Ae[Ue[et]]===null||Ae[Ue[et]]===void 0)je[st]="";else if(typeof Ae[Ue[et]]=="object")for(var at=Ee(Ae[Ue[et]],st),ft=Object.keys(at),gt=0;gt<ft.length;gt++)je[ft[gt]]=at[ft[gt]];else je[st]=Ae[Ue[et]]}}return je},we=Ee(q.data),Z=Object.keys(we);if(q.method=="GET"){if(Z.length){for(var Y=[],re=0;re<Z.length;re++)Y.push(Z[re]+"="+encodeURIComponent(we[Z[re]]));q.url.indexOf("?")<0&&(q.url+="?"),q.url+=Y.join("&")}}else for(var Y=new FormData,re=0;re<Z.length;re++)if(we[Z[re]]instanceof FileList){if(we[Z[re]].length)for(var se=0;se<we[Z[re]].length;se++)Y.append(Z[re],we[Z[re]][se],we[Z[re]][se].name)}else Y.append(Z[re],we[Z[re]])}var _e=new XMLHttpRequest;return _e.open(q.method,q.url,!0),q.requestedWith?_e.setRequestHeader("X-Requested-With",q.requestedWith):q.requestedWith!==!1&&_e.setRequestHeader("X-Requested-With","XMLHttpRequest"),q.contentType&&_e.setRequestHeader("Content-Type",q.contentType),q.method==="POST"?_e.setRequestHeader("Accept","application/json"):q.dataType==="blob"?_e.responseType="blob":q.contentType||(q.dataType==="json"?_e.setRequestHeader("Content-Type","text/json"):q.dataType==="html"&&_e.setRequestHeader("Content-Type","text/html")),q.cache!==!0&&(_e.setRequestHeader("pragma","no-cache"),_e.setRequestHeader("cache-control","no-cache")),q.withCredentials===!0&&(_e.withCredentials=!0),typeof q.beforeSend=="function"&&q.beforeSend(_e),typeof V.beforeSend=="function"&&V.beforeSend(_e),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(_e),_e.onerror=function(){q.error&&typeof q.error=="function"&&q.error({message:"Network error: Unable to reach the server.",status:0})},_e.ontimeout=function(){q.error&&typeof q.error=="function"&&q.error({message:"Request timed out after "+_e.timeout+"ms.",status:0})},_e.onload=function(){if(_e.status>=200&&_e.status<300)if(q.dataType==="json")try{var Ae=JSON.parse(_e.responseText);q.success&&typeof q.success=="function"&&q.success(Ae)}catch(je){q.error&&typeof q.error=="function"&&q.error(je,Ae)}else{if(q.dataType==="blob")var Ae=_e.response;else var Ae=_e.responseText;q.success&&typeof q.success=="function"&&q.success(Ae)}else q.error&&typeof q.error=="function"&&q.error(_e.responseText,_e.status);if(V.queue&&V.queue.length>0&&V.send(V.queue.shift()),V.requests&&V.requests.length){var ke=V.requests.indexOf(_e);if(V.requests.splice(ke,1),V.requests.length||q.complete&&typeof q.complete=="function"&&q.complete(Ae),q.group&&V.oncomplete&&typeof V.oncomplete[q.group]=="function"&&(V.pending(q.group)||(V.oncomplete[q.group](),V.oncomplete[q.group]=null)),q.multiple&&q.multiple.instance){var ke=q.multiple.instance.indexOf(_e);q.multiple.instance.splice(ke,1),q.multiple.instance.length||q.multiple.complete&&typeof q.multiple.complete=="function"&&q.multiple.complete(Ae)}}},_e.options=q,_e.data=Y,q.queue===!0&&V.requests.length>0?V.queue.push(_e):V.send(_e),_e});return V.send=function(q){q.data?Array.isArray(q.data)?q.send(q.data.join("&")):q.send(q.data):q.send(),V.requests.push(q)},V.exists=function(q,D){var O=new XMLHttpRequest;O.open("HEAD",q,!1),O.send(),O.status&&D(O.status)},V.pending=function(q){var D=0,O=V.requests;if(O&&O.length)for(var re=0;re<O.length;re++)(!q||q==O[re].options.group)&&D++;return D},V.oncomplete={},V.requests=[],V.queue=[],V}var M=I();function N(){const V={loading:{}};return V.loading.show=function(q){V.loading.element||(V.loading.element=document.createElement("div"),V.loading.element.className="jloading"),document.body.appendChild(V.loading.element),q>0&&setTimeout(function(){V.loading.hide()},q*1e3)},V.loading.hide=function(){V.loading.element&&V.loading.element.parentNode&&document.body.removeChild(V.loading.element)},V.slideLeft=function(q,D,O){D==!0?(q.classList.add("jslide-left-in"),setTimeout(function(){q.classList.remove("jslide-left-in"),typeof O=="function"&&O()},400)):(q.classList.add("jslide-left-out"),setTimeout(function(){q.classList.remove("jslide-left-out"),typeof O=="function"&&O()},400))},V.slideRight=function(q,D,O){D===!0?(q.classList.add("jslide-right-in"),setTimeout(function(){q.classList.remove("jslide-right-in"),typeof O=="function"&&O()},400)):(q.classList.add("jslide-right-out"),setTimeout(function(){q.classList.remove("jslide-right-out"),typeof O=="function"&&O()},400))},V.slideTop=function(q,D,O){D===!0?(q.classList.add("jslide-top-in"),setTimeout(function(){q.classList.remove("jslide-top-in"),typeof O=="function"&&O()},400)):(q.classList.add("jslide-top-out"),setTimeout(function(){q.classList.remove("jslide-top-out"),typeof O=="function"&&O()},400))},V.slideBottom=function(q,D,O){D===!0?(q.classList.add("jslide-bottom-in"),setTimeout(function(){q.classList.remove("jslide-bottom-in"),typeof O=="function"&&O()},400)):(q.classList.add("jslide-bottom-out"),setTimeout(function(){q.classList.remove("jslide-bottom-out"),typeof O=="function"&&O()},100))},V.fadeIn=function(q,D){q.style.display="",q.classList.add("jfade-in"),setTimeout(function(){q.classList.remove("jfade-in"),typeof D=="function"&&D()},2e3)},V.fadeOut=function(q,D){q.classList.add("jfade-out"),setTimeout(function(){q.style.display="none",q.classList.remove("jfade-out"),typeof D=="function"&&D()},1e3)},V}var H=N();function L(){var V={};V.now=function(we,Z){var Y=null,se=null,_e=null,Ae=null,ke=null,je=null;return Array.isArray(we)?(Y=we[0],se=we[1],_e=we[2],Ae=we[3],ke=we[4],je=we[5]):(we||(we=new Date),Y=we.getFullYear(),se=we.getMonth()+1,_e=we.getDate(),Ae=we.getHours(),ke=we.getMinutes(),je=we.getSeconds()),Z==!0?C.two(Y)+"-"+C.two(se)+"-"+C.two(_e):C.two(Y)+"-"+C.two(se)+"-"+C.two(_e)+" "+C.two(Ae)+":"+C.two(ke)+":"+C.two(je)},V.toArray=function(we){var Y=we.split(we.indexOf("T")!==-1?"T":" "),Z=Y[1],Y=Y[0].split("-"),se=parseInt(Y[0]),_e=parseInt(Y[1]),Ae=parseInt(Y[2]),ke=0,je=0;return Z&&(Z=Z.split(":"),ke=parseInt(Z[0]),je=parseInt(Z[1])),[se,_e,Ae,ke,je,0]};var q=Date.UTC(1900,0,0),D=Date.UTC(1900,1,29),O=864e5;V.dateToNum=function(we){typeof we=="string"&&(we=new Date(we+"  GMT+0"));var Z=we.getTime();return Z>=D&&(Z+=O),Z-=q,Z/O},V.numToDate=function(we){var Z=q+we*O;Z>=D&&(Z-=O);const Y=new Date(Z);var se=[Y.getUTCFullYear(),Y.getUTCMonth()+1,Y.getUTCDate(),Y.getUTCHours(),Y.getUTCMinutes(),Y.getUTCSeconds()];return V.now(se)};let re=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Ee=["January","February","March","April","May","June","July","August","September","October","November","December"];return Object.defineProperty(V,"weekdays",{get:function(){return re.map(function(we){return p.translate(we)})}}),Object.defineProperty(V,"weekdaysShort",{get:function(){return re.map(function(we){return p.translate(we).substring(0,3)})}}),Object.defineProperty(V,"months",{get:function(){return Ee.map(function(we){return p.translate(we)})}}),Object.defineProperty(V,"monthsShort",{get:function(){return Ee.map(function(we){return p.translate(we).substring(0,3)})}}),V}var A=L();function k(){var V={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],scientific:["0{1}(.{1}0+)?E{1}\\+0+"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","MONTH","MON","HH24","HH12","HH","\\[H\\]","H","AM/PM","MI","SS","MS","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},q=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var j=0;this.date[4]&&(j=parseFloat(this.date[4]/60));var J=parseInt(this.date[3])+j;J/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?J=C.two(this.date[3])+":"+C.two(this.date[4])+":"+C.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),J=C.two(this.date[0])+"-"+C.two(this.date[1])+"-"+C.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(J+=" "+C.two(this.date[3])+":"+C.two(this.date[4])+":"+C.two(this.date[5])));return J},D=function(){var j="";if(!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])){if(this.mask.toLowerCase().indexOf("[h]")!==-1)j=parseInt(this.date[3]);else{let Ce=parseInt(this.date[3]);Ce<13&&this.values.indexOf("PM")!==-1?j=(Ce+12)%24:j=Ce%24}this.date[4]&&(j+=parseFloat(this.date[4]/60)),this.date[5]&&(j+=parseFloat(this.date[5]/3600)),j/=24}else if(this.date[0]||this.date[1]||this.date[2]||this.date[3]||this.date[4]||this.date[5]){this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1);var J=A.now(this.date);j=A.dateToNum(J)}return isNaN(j)&&(j=""),j},O=function(j){return j===null||j===""||j===void 0},re=function(j){var J=(""+j)[0];return J=="="},Ee=function(j){return j==="currency"||j==="percentage"||j==="scientific"||j==="numeric"},we=function(j){if(j&&Number(j)==j)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var J=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=J[1]}else{j||(j=this.mask);var Ce=new RegExp("0{1}(.{1})0+","ig"),J=Ce.exec(j);if(J&&J[1]&&J[1].length==1)return this.options.decimal=J[1],J[1];var Ce=new RegExp("#{1}(.{1})#+","ig"),J=Ce.exec(j);J&&J[1]&&J[1].length==1?J[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},Z=function(j,J){if(j=="")return"";J||(J=we.call(this)),j=(""+j).split(J);var Ce=j[0].match(/[-]+/g);if(Ce&&Ce.length?Ce=!0:Ce=!1,j[0]=j[0].match(/[0-9]+/g),j[0]?(Ce&&j[0].unshift("-"),j[0]=j[0].join("")):Ce&&(j[0]="-"),j[0]||j[1])j[1]!==void 0&&(j[1]=j[1].match(/[0-9]+/g),j[1]?j[1]=j[1].join(""):j[1]="");else return"";return j},Y=function(j,J){if(j==="")return"";var Ce=we.call(this),Le=this.options;if(j=Z.call(this,j),j==="")return"";var me=null;if(j[0]&&(Le.style==="percent"?me=parseFloat(j[0])/100:me=parseFloat(j[0]+".1")),(j[0]==="-"||j[0]==="-00")&&!j[1]&&J&&J.inputType=="deleteContentBackward")return"";var He=new Intl.NumberFormat(this.locale,Le).format(me);if(He=He.split(Ce),Le.style==="percent"&&He[0].indexOf("%")!==-1&&(He[0]=He[0].replace("%",""),He[2]="%"),typeof He[1]<"u"){var Ze=He[1].replace(/[0-9]*/g,"");Ze&&(He[2]=Ze)}return j[1]!==void 0?He[1]=Ce+j[1]:He[1]="",He.join("")},se=function(j,J){var Ce=ke.call(j);if(Ce){var Le=Y.call(this,Ce,J),me=Le.length-Ce.length,He=Ae.call(j)+me;ke.call(j,Le,He,!0)}},_e=function(j){var J=Z.call(this,j);return J?(J[0]==="-"&&(J[0]="-0"),parseFloat(J.join("."))):null},Ae=function(j,J){if(j===void 0)if(this.tagName=="DIV"){var Ce=0,Le=window.getSelection();if(Le&&Le.rangeCount!==0){var me=Le.getRangeAt(0),He=me.cloneRange();He.selectNodeContents(this),He.setEnd(me.endContainer,me.endOffset),Ce=He.toString().length}return Ce}else return this.selectionStart;else{var Ze=ke.call(this);if(J){for(var He=null,Re=0;Re<Ze.length;Re++)(Ze[Re].match(/[\-0-9]/g)||Ze[Re]==="."||Ze[Re]===",")&&(He=Re);He===null&&(He=Ze.indexOf(" ")),j>=He&&(j=He+1)}if(j>Ze.length&&(j=Ze.length),j)if(this.tagName=="DIV"){var Le=window.getSelection(),me=document.createRange();this.childNodes[0]&&(me.setStart(this.childNodes[0],j),Le.removeAllRanges(),Le.addRange(me))}else this.selectionStart=j,this.selectionEnd=j}},ke=function(j,J,Ce){if(this.tagName=="DIV")if(j===void 0){var j=this.innerText;return this.value&&this.value.length>j.length&&(j=this.value),j}else this.innerText!==j&&(this.innerText=j,J&&Ae.call(this,J,Ce));else{if(j===void 0)return this.value;this.value!==j&&(this.value=j,J&&Ae.call(this,J,Ce))}},je=A.weekdays,Ue=A.weekdaysShort,et=A.months,st=A.monthsShort,at={YEAR:function(j,J){var Ce=""+new Date().getFullYear();if(typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(j)>=0&&parseInt(j)<=10&&this.values[this.index].length<J&&(this.values[this.index]+=j),this.values[this.index].length==J){if(J==2)var Ce=Ce.substr(0,2)+this.values[this.index];else if(J==3)var Ce=Ce.substr(0,1)+this.values[this.index];else if(J==4)var Ce=this.values[this.index];this.date[0]=Ce,this.index++}},YYYY:function(j){at.YEAR.call(this,j,4)},YYY:function(j){at.YEAR.call(this,j,3)},YY:function(j){at.YEAR.call(this,j,2)},FIND:function(j,J){if(O(this.values[this.index])&&(this.values[this.index]=""),this.event&&this.event.inputType&&this.event.inputType.indexOf("delete")>-1){this.values[this.index]+=j;return}for(var Ce=0,Le=0,me=(this.values[this.index]+j).toLowerCase(),He=0;He<J.length;He++)J[He].toLowerCase().indexOf(me)==0&&(Ce=He,Le++);if(Le>1)this.values[this.index]+=j;else if(Le==1){var Ze=J[Ce].length-this.values[this.index].length-1;return this.position+=Ze,this.values[this.index]=J[Ce],this.index++,Ce}},MMM:function(j){var J=at.FIND.call(this,j,st);J!==void 0&&(this.date[1]=J+1)},MON:function(j){at.MMM.call(this,j)},MMMM:function(j){var J=at.FIND.call(this,j,et);J!==void 0&&(this.date[1]=J+1)},MONTH:function(j){at.MMMM.call(this,j)},MMMMM:function(j){O(this.values[this.index])&&(this.values[this.index]="");for(var J=(this.values[this.index]+j).toLowerCase(),Ce=0;Ce<et.length;Ce++)if(et[Ce][0].toLowerCase().indexOf(J)==0){this.values[this.index]=et[Ce][0],this.date[1]=Ce+1,this.index++;break}},MM:function(j){O(this.values[this.index])?parseInt(j)>1&&parseInt(j)<10?(this.date[1]=this.values[this.index]="0"+j,this.index++):parseInt(j)<2&&(this.values[this.index]=j):this.values[this.index]==1&&parseInt(j)<3?(this.date[1]=this.values[this.index]+=j,this.index++):this.values[this.index]==0&&parseInt(j)>0&&parseInt(j)<10&&(this.date[1]=this.values[this.index]+=j,this.index++)},M:function(j){var J=!1;if(parseInt(j)>=0&&parseInt(j)<10)if(O(this.values[this.index]))this.values[this.index]=j,j>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(j)<3)this.date[1]=this.values[this.index]+=j,this.index++;else if(this.values[this.index]==0&&parseInt(j)>0)this.date[1]=this.values[this.index]+=j,this.index++;else var J=!0;else var J=!0;if(J==!0){var Ce=parseInt(this.values[this.index]);Ce>0&&Ce<12&&(this.date[1]=this.values[this.index],this.index++,this.position--)}},D:function(j){var J=!1;if(parseInt(j)>=0&&parseInt(j)<10)if(O(this.values[this.index]))this.values[this.index]=j,parseInt(j)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(j)<2)this.date[2]=this.values[this.index]+=j,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=j,this.index++;else if(this.values[this.index]==0&&parseInt(j)>0)this.date[2]=this.values[this.index]+=j,this.index++;else var J=!0;else var J=!0;if(J==!0){var Ce=parseInt(this.values[this.index]);Ce>0&&Ce<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(j){O(this.values[this.index])?parseInt(j)>3&&parseInt(j)<10?(this.date[2]=this.values[this.index]="0"+j,this.index++):parseInt(j)<10&&(this.values[this.index]=j):this.values[this.index]==3&&parseInt(j)<2?(this.date[2]=this.values[this.index]+=j,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(j)<10?(this.date[2]=this.values[this.index]+=j,this.index++):this.values[this.index]==0&&parseInt(j)>0&&parseInt(j)<10&&(this.date[2]=this.values[this.index]+=j,this.index++)},DDD:function(j){at.FIND.call(this,j,Ue)},DY:function(j){at.DDD.call(this,j)},DDDD:function(j){at.FIND.call(this,j,je)},DAY:function(j){at.DDDD.call(this,j)},HH12:function(j,J){var Ce=!1;if(parseInt(j)>=0&&parseInt(j)<10)if(O(this.values[this.index]))parseInt(j)>1&&parseInt(j)<10?(J&&(j=0+j),this.date[3]=this.values[this.index]=j,this.index++):parseInt(j)<10&&(this.values[this.index]=j);else if(this.values[this.index]==1&&parseInt(j)<3)this.date[3]=this.values[this.index]+=j,this.index++;else if(this.values[this.index]<1&&parseInt(j)<10)this.date[3]=this.values[this.index]+=j,this.index++;else var Ce=!0;else var Ce=!0;if(Ce==!0){var Le=parseInt(this.values[this.index]);Le>=0&&Le<=12&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH24:function(j,J){var Ce=!1;if(parseInt(j)>=0&&parseInt(j)<10)if(this.values[this.index]==null||this.values[this.index]=="")parseInt(j)>2&&parseInt(j)<10?(J&&(j=0+j),this.date[3]=this.values[this.index]=j,this.index++):parseInt(j)<10&&(this.values[this.index]=j);else if(this.values[this.index]==2&&parseInt(j)<4)!J&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=j,this.index++;else if(this.values[this.index]<2&&parseInt(j)<10)!J&&this.values[this.index]==="0"&&(this.values[this.index]=""),this.date[3]=this.values[this.index]+=j,this.index++;else var Ce=!0;else var Ce=!0;if(Ce==!0){var Le=parseInt(this.values[this.index]);Le>=0&&Le<24&&(this.date[3]=this.values[this.index],this.index++,this.position--)}},HH:function(j){at.HH24.call(this,j,1)},H:function(j){at.HH24.call(this,j,0)},"\\[H\\]":function(j){this.values[this.index]==null&&(this.values[this.index]=""),j.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=j:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(j,J){this.values[this.index]==null||this.values[this.index]==""?parseInt(j)>5&&parseInt(j)<10?(this.date[J]=this.values[this.index]="0"+j,this.index++):parseInt(j)<10&&(this.values[this.index]=j):parseInt(j)<10&&(this.date[J]=this.values[this.index]+=j,this.index++)},MI:function(j){at.N60.call(this,j,4)},SS:function(j){at.N60.call(this,j,5)},"AM/PM":function(j){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),this.values[this.index]===""?j.match(/a/i)&&this.date[3]<13?this.values[this.index]+="A":j.match(/p/i)&&(this.values[this.index]+="P"):(this.values[this.index]==="A"||this.values[this.index]==="P")&&(this.values[this.index]+="M",this.index++)},WD:function(j){typeof this.values[this.index]>"u"&&(this.values[this.index]=""),parseInt(j)>=0&&parseInt(j)<7&&(this.values[this.index]=j),this.values[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(j){var J=we.call(this),Ce=!1;O(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(Ce=!0);var Le=Z.call(this,this.values[this.index],J);Le&&(this.values[this.index]=Le.join(J)),parseInt(j)>=0&&parseInt(j)<10?(this.values[this.index]=="0"&&j>0?this.values[this.index]="":this.values[this.index]=="-0"&&j>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||j==J)&&(this.values[this.index]+=j)):J&&j==J?this.values[this.index].indexOf(J)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=j):j=="-"&&(Ce=!0),Ce===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?E{1}\\+0+":function(j){at["0{1}(.{1}0+)?"].call(this,j)},"0{1}(.{1}0+)?%":function(j){at["0{1}(.{1}0+)?"].call(this,j),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(j){at["0{1}(.{1}0+)?"].call(this,j);var J=we.call(this),Ce=this.tokens[this.index].substr(1,1),Le=this.values[this.index][0]==="-",me=Z.call(this,this.values[this.index],J);if(me!==""){var He=me[0].match(/[0-9]/g);if(He){He=He.join("");for(var Ze=[],Re=0,xe=He.length-1;xe>=0;xe--)Ze.push(He[xe]),Re++,Re%3||Ze.push(Ce);Ze=Ze.reverse(),me[0]=Ze.join(""),me[0].substr(0,1)==Ce&&(me[0]=me[0].substr(1))}else me[0]="";this.values[this.index]=me.join(J),Le&&(this.values[this.index]="-"+this.values[this.index])}},0:function(j){j.match(/[0-9]/g)&&(this.values[this.index]=j,this.index++)},"[0-9a-zA-Z$]+":function(j){O(this.values[this.index])&&(this.values[this.index]="");var J=this.tokens[this.index],Ce=this.values[this.index],Le=Ce.length;J[Le]==j?(this.values[this.index]+=j,this.values[this.index]==J&&this.index++):(this.values[this.index]=J,this.index++,j.match(/[\-0-9]/g)&&this.position--)},A:function(j){j.match(/[a-zA-Z]/gi)&&(this.values[this.index]=j,this.index++)},".":function(j){at["[0-9a-zA-Z$]+"].call(this,j)},"@":function(j){O(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=j}},ft=function(j){if(this.type=="general")var J=[].concat(V.general);else var J=[].concat(V.currency,V.datetime,V.percentage,V.scientific,V.numeric,V.text,V.general);var Ce=new RegExp(J.join("|"),"gi");return j.match(Ce)},gt=function(j){if(this.type)if(this.type=="text")var J=["text"];else if(this.type=="general")var J=["general"];else if(this.type=="datetime")var J=["numeric","datetime","general"];else var J=["currency","percentage","scientific","numeric","general"];else var J=Object.keys(V);for(var Ce=0;Ce<J.length;Ce++)for(var Le=J[Ce],me=0;me<V[Le].length;me++){var He=new RegExp(V[Le][me],"gi"),Ze=j.match(He);if(Ze)return{type:Le,method:V[Le][me]}}},Ie=function(j){for(var J=[],Ce=0;Ce<j.length;Ce++){var Le=gt.call(this,j[Ce]);Le?J.push(Le.method):J.push(null)}for(var Ce=0;Ce<J.length;Ce++)J[Ce]=="MM"&&(J[Ce-1]&&J[Ce-1].indexOf("H")>=0||J[Ce-2]&&J[Ce-2].indexOf("H")>=0||J[Ce+1]&&J[Ce+1].indexOf("S")>=0||J[Ce+2]&&J[Ce+2].indexOf("S")>=0)&&(J[Ce]="MI");return J},We=function(j){var J=gt.call(this,j);if(J)var Ce=J.type;if(Ce){for(var Le=0,me=ft.call(this,j),He=0;He<me.length;He++)J=gt.call(this,me[He]),J&&Ee(J.type)&&Le++;Le>1&&(Ce="general")}return Ce},tt=function(){typeof at[this.methods[this.index]]=="function"?(at[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},ue=function(j){return(""+ +j).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(J,Ce,Le,me,He){return He<0?Ce+"0."+Array(1-He-Le.length).join(0)+Le+me:Ce+Le+me+Array(He-me.length+1).join(0)})},be=function(j,J,Ce){var Le=null,me={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof j=="object"){if(me.input=j.target,me.value=ke.call(j.target),me.caret=Ae.call(j.target),(Le=j.target.getAttribute("data-mask"))&&(me.mask=Le),(Le=j.target.getAttribute("data-type"))&&(me.type=Le),j.target.mask?(j.target.mask.options&&(me.options=j.target.mask.options),j.target.mask.locale&&(me.locale=j.target.mask.locale)):(Le=j.target.getAttribute("data-locale"))&&(me.locale=Le,me.mask&&(me.options.style=me.mask)),j.target.attributes&&j.target.attributes.length)for(var He=0;He<j.target.attributes.length;He++){var Ze=j.target.attributes[He].name,Re=j.target.attributes[He].value;Ze.substr(0,4)=="data"&&(me.options[Ze.substr(5)]=Re)}}else{if(typeof J=="string")me.mask=J;else for(var Ze=Object.keys(J),He=0;He<Ze.length;He++)me[Ze[He]]=J[Ze[He]];typeof j=="number"&&(we.call(me,me.mask),j=(""+j).replace(".",me.options.decimal)),me.value=j,me.input&&(ke.call(me.input,j),C.focus(me.input),me.caret=Ae.call(me.input))}if(!re(me.value)&&(me.mask||me.locale)){if(me.mask){if(me.mask=me.mask.replace(new RegExp(/\[h]/),"|h|"),me.mask=me.mask.replace(new RegExp(/\[.*?\]/),""),me.mask=me.mask.replace(new RegExp(/\|h\|/),"[h]"),me.mask.indexOf(";")!==-1){var Le=me.mask.split(";");me.mask=Le[0]}if(me.mask.indexOf("##")!==-1){var xe=me.mask.split(";");xe[0]&&(typeof j=="object"&&(xe[0]=xe[0].replace(new RegExp(/_\)/g),""),xe[0]=xe[0].replace(new RegExp(/_\(/g),"")),xe[0]=xe[0].replace("*","	"),xe[0]=xe[0].replace(new RegExp(/_-/g),""),xe[0]=xe[0].replace(new RegExp(/_/g),""),xe[0]=xe[0].replace(new RegExp(/"/g),""),xe[0]=xe[0].replace("##0.###","##0.000"),xe[0]=xe[0].replace("##0.##","##0.00"),xe[0]=xe[0].replace("##0.#","##0.0"),xe[0]=xe[0].replace("##0,###","##0,000"),xe[0]=xe[0].replace("##0,##","##0,00"),xe[0]=xe[0].replace("##0,#","##0,0")),me.mask=xe[0]}if(me.mask.indexOf("\\")!==-1){var xe=me.mask.split(";");xe[0]=xe[0].replace(new RegExp(/\\/g),""),me.mask=xe[0]}me.type||(me.type=We.call(me,me.mask)),me.tokens=ft.call(me,me.mask)}if(typeof j!="object"||!j.inputType||!j.inputType.indexOf("insert")||!j.inputType.indexOf("delete"))if(me.locale)if(me.input)se.call(me,me.input,j);else var Ye=Y.call(me,me.value);else{for(me.methods=Ie.call(me,me.tokens),me.event=j;me.position<me.value.length&&typeof me.tokens[me.index]<"u";)tt.call(me);var Ye=me.values.join("");if(Ee(me.type)&&Ye!==""){for(;typeof me.tokens[me.index]<"u";){var Le=gt.call(me,me.tokens[me.index]);Le&&Le.type=="general"&&(me.values[me.index]=me.tokens[me.index]),me.index++}var Ge=!0}else var Ge=!1;if(Ye=me.values.join(""),me.input){if(Le=Ye.length-me.value.length,Le>0)var Te=me.caret+Le;else var Te=me.caret;ke.call(me.input,Ye,Te,Ge)}}if(me.input){var ze=null;if(Ee(me.type)){let nt=ke.call(me.input);me.number=_e.call(me,nt),me.type=="percentage"&&(""+nt).indexOf("%")!==-1?ze=be.adjustPrecision(me.number/100):ze=me.number}else me.type=="datetime"&&(ze=q.call(me),me.date[0]&&me.date[1]&&me.date[2]&&me.input.setAttribute("data-completed",!0));ze&&me.input.setAttribute("data-value",ze)}if(Ye!==void 0)return Ce?me:Ye}};return be.adjustPrecision=function(j){if(typeof j=="number"&&!Number.isInteger(j)){const J=j.toString().split(".");if(J[1]&&J[1].length>10){let Ce=0;const Le=J[1][J[1].length-2];if(Le==0||Le==9){for(let me=J[1].length-2;me>0;me--)if(Ce>=0&&J[1][me]==Le){if(Ce++,Ce>6)break}else{Ce=0;break}if(Ce)return parseFloat(parseFloat(j).toFixed(J[1].length-1))}}}return j},be.getType=We,be.prepare=function(j,J){return J||(J={}),ft.call(J,j)},be.apply=function(j){var J=ke.call(j.target);j.key.length==1&&(J+=j.key),ke.call(j.target,be(J,j.target.getAttribute("data-mask")))},be.run=function(j,J,Ce){return be(j,{mask:J,decimal:Ce})},be.extract=function(j,J,Ce){if(O(j)||typeof J!="object")return j;if(J=Object.assign({},J),J.options||(J.options={}),!J.mask&&J.format&&(J.mask=J.format),J.mask){if(J.mask.indexOf(";")!==-1){var Le=J.mask.split(";");J.mask=Le[0]}J.mask=J.mask.replace(new RegExp(/\[h]/),"|h|"),J.mask=J.mask.replace(new RegExp(/\[.*?\]/),""),J.mask=J.mask.replace(new RegExp(/\|h\|/),"[h]")}we.call(J,J.mask);var me=null,He=null;if(J.type=="percent"||J.options.style=="percent"?me="percentage":J.mask&&(me=We.call(J,J.mask)),me==="text"){var Ze={};He=j}else if(me==="general"){var Ze=be(j,J,!0);He=j}else if(me==="datetime"){j instanceof Date&&(j=be.getDateString(j,J.mask));var Ze=be(j,J,!0);C.isNumeric(j)?He=j:He=D.call(Ze)}else if(me==="scientific"){He=j,typeof j=="string"&&(He=Number(He));var Ze=J}else{He=_e.call(J,j),me==="percentage"&&(""+j).indexOf("%")!==-1&&(He/=100);var Ze=J}return Ze.value=He,!Ze.type&&me&&(Ze.type=me),Ce?Ze:He},be.render=function(j,J,Ce,Le){if(O(j)||typeof J!="object")return j;if(J=Object.assign({},J),J.options||(J.options={}),!J.mask&&J.format&&(J.mask=J.format),J.mask){if(J.mask.indexOf(";")!==-1){var me=J.mask.split(";");Ce||(me[0]=me[0].replace(new RegExp(/_\)/g),""),me[0]=me[0].replace(new RegExp(/_\(/g),"")),J.mask=me[0]}J.mask=J.mask.replace(new RegExp(/\[h]/),"|h|"),J.mask=J.mask.replace(new RegExp(/\[.*?\]/),""),J.mask=J.mask.replace(new RegExp(/\|h\|/),"[h]")}var He=null;J.type=="percent"||J.options.style=="percent"?He="percentage":J.mask?He=We.call(J,J.mask):j instanceof Date&&(He="datetime");var Ze=!1;if(He=="datetime"||J.type=="calendar"){var me=be.getDateString(j,J.mask);me&&(j=me),J.mask&&Ce&&(Ze=!0)}else if(He==="text")typeof j=="number"&&(j=j.toString());else if(typeof j=="string"&&c.isNumeric(j)&&(j=Number(j)),He==="percentage"&&(j=be.adjustPrecision(j*100)),typeof j=="number"){var me=null;if(J.mask&&Ce){var Re=we.call(J,J.mask);if(He==="scientific")if(J.mask.indexOf(Re)!==-1){let ut=J.mask.split("E");ut=ut[0].split(Re),ut=""+ut[1].match(/[0-9]+/g),ut=ut.length,me=j.toExponential(ut)}else me=j.toExponential(0);else{if(J.mask.indexOf(Re)!==-1){Re=J.mask.split(Re),Re=""+Re[1].match(/[0-9]+/g),Re=Re.length,me=j.toFixed(Re);let ut=j.toString().split("."),_t=ut[1];_t&&_t.length>Re&&_t[_t.length-1]==="5"&&(me=parseFloat(ut[0]+"."+_t+"1").toFixed(Re))}else me=j.toFixed(0);(""+me).indexOf("e")!==-1&&(me=ue(me))}}else if(J.locale&&Ce){var Re=(""+j).split(".");if(J.options){typeof Re[1]>"u"&&(Re[1]="");var Ye=Re[1].length;if(J.options.minimumFractionDigits>Ye)for(var xe=0;xe<J.options.minimumFractionDigits-Ye;xe++)Re[1]+="0"}Re[1].length?me=Re.join("."):me=Re[0];var Ye=Re[1].length;J.options&&J.options.maximumFractionDigits<Ye&&(me=parseFloat(me).toFixed(J.options.maximumFractionDigits))}else me=ue(j);me!==null&&(j=me,we.call(J,J.mask),J.options.decimal&&(j=j.replace(".",J.options.decimal)))}else J.mask&&Ce&&(Ze=!0);if(Ze){var Ge=J.mask.length-j.length;if(Ge>0)for(var xe=0;xe<Ge;xe++)j+=" "}if(He==="scientific")if(!Ce)j=ue(j);else return j;if(He==="numeric"&&Le===!1&&typeof j=="string")return j;if(j=be(j,J),Ce&&He==="numeric"){var Te=J.mask.match(new RegExp(/^[0]+$/gm));if(Te&&Te.length===1){var ze=Te[0].length;if(ze>3)for(j=""+j;j.length<ze;)j="0"+j}}return j},be.set=function(j,J){if(J){j.setAttribute("data-mask",J);var Ce=new Event("input",{bubbles:!0,cancelable:!0});j.dispatchEvent(Ce)}},be.extractDateFromString=function(j,J){var Ce=be(j,{mask:J},!0);if(j>0&&Number(j)==j&&(Ce.values.join("")!==Ce.value||Ce.type=="numeric")){var Le=new Date(Math.round((j-25569)*86400*1e3));return Le.getFullYear()+"-"+C.two(Le.getMonth())+"-"+C.two(Le.getDate())+" 00:00:00"}var me=!1;return Ce.values&&Ce.values.length===Ce.tokens.length&&Ce.values[Ce.values.length-1].length>=Ce.tokens[Ce.tokens.length-1].length&&(me=!0),Ce.date[0]&&Ce.date[1]&&(Ce.date[2]||me)?(Ce.date[2]||(Ce.date[2]=1),Ce.date[0]+"-"+C.two(Ce.date[1])+"-"+C.two(Ce.date[2])+" "+C.two(Ce.date[3])+":"+C.two(Ce.date[4])+":"+C.two(Ce.date[5])):""},be.getDateString=function(j,J){if(!J)var J={};if(J&&typeof J=="object"){if(J.format)var Ce=J.format;else if(J.mask)var Ce=J.mask}else var Ce=J;if(Ce||(Ce="YYYY-MM-DD"),Ce.indexOf("[h]")>=0){var Le=0;if(j&&C.isNumeric(j)&&(Le=parseFloat(24*Number(j)),Ce.indexOf("mm")>=0)){var me=(""+Le).split(".");if(me[1]){var He=60*parseFloat("0."+me[1]);He=parseFloat(He.toFixed(2))}else var He=0;Le=parseInt(me[0])+":"+C.two(He)}return Le}j instanceof Date?j=A.now(j):j&&C.isNumeric(j)&&(j=A.numToDate(j));for(var Ze=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],Re=new RegExp(Ze.join("|"),"gi"),xe=Ce.match(Re),Ye=0;Ye<xe.length;Ye++)xe[Ye].toUpperCase()=="MM"&&(xe[Ye-1]&&xe[Ye-1].toUpperCase().indexOf("H")>=0||xe[Ye-2]&&xe[Ye-2].toUpperCase().indexOf("H")>=0||xe[Ye+1]&&xe[Ye+1].toUpperCase().indexOf("S")>=0||xe[Ye+2]&&xe[Ye+2].toUpperCase().indexOf("S")>=0)&&(xe[Ye]="mi");var Ge={tokens:xe};if(j){var He=""+j,Te=He.indexOf("T")!==-1?"T":" ";He=He.split(Te);var me=0,ze=0,nt=0;He[1]&&(me=He[1].split(":"),ze=me[1]?me[1]:0,nt=me[2]?me[2]:0,me=me[0]?me[0]:0),He=He[0].split("-");let At=new Date(He[0],He[1],0).getDate();if(He[0]&&He[1]&&He[2]&&He[0]>0&&He[1]>0&&He[1]<13&&He[2]>0&&He[2]<=At){Ge.data=[He[0],He[1],He[2],me,ze,nt],Ge.value=[];for(var ut=new Date(Ge.data[0],Ge.data[1]-1,Ge.data[2],Ge.data[3],Ge.data[4],Ge.data[5]),_t=function(xt){var Ft=this.tokens[xt],St=Ft.toUpperCase(),wt=null;St==="YYYY"?wt=this.data[0]:St==="YYY"?wt=this.data[0].substring(1,4):St==="YY"?wt=this.data[0].substring(2,4):St==="Y"?wt=this.data[0].substring(3,4):Ft==="MON"?wt=A.months[ut.getMonth()].substr(0,3).toUpperCase():Ft==="mon"?wt=A.months[ut.getMonth()].substr(0,3).toLowerCase():Ft==="MONTH"?wt=A.months[ut.getMonth()].toUpperCase():Ft==="month"?wt=A.months[ut.getMonth()].toLowerCase():St==="MMMMM"?wt=A.months[ut.getMonth()].substr(0,1):St==="MMMM"||Ft==="Month"?wt=A.months[ut.getMonth()]:St==="MMM"||Ft=="Mon"?wt=A.months[ut.getMonth()].substr(0,3):St==="MM"?wt=C.two(this.data[1]):St==="M"?wt=ut.getMonth()+1:Ft==="DAY"?wt=A.weekdays[ut.getDay()].toUpperCase():Ft==="day"?wt=A.weekdays[ut.getDay()].toLowerCase():St==="DDDD"||Ft=="Day"?wt=A.weekdays[ut.getDay()]:St==="DDD"?wt=A.weekdays[ut.getDay()].substr(0,3):St==="DD"?wt=C.two(this.data[2]):St==="D"?wt=parseInt(this.data[2]):St==="Q"?wt=Math.floor((ut.getMonth()+3)/3):St==="HH24"||St==="HH"?(wt=this.data[3],wt>12&&this.tokens.indexOf("am/pm")!==-1&&(wt-=12),wt=C.two(wt)):St==="HH12"?this.data[3]>12?wt=C.two(this.data[3]-12):wt=C.two(this.data[3]):St==="H"?(wt=this.data[3],wt>12&&this.tokens.indexOf("am/pm")!==-1&&(wt-=12,wt=C.two(wt))):St==="MI"?wt=C.two(this.data[4]):St==="SS"?wt=C.two(this.data[5]):St==="MS"?wt=ut.getMilliseconds():St==="AM/PM"?this.data[3]>=12?wt="PM":wt="AM":St==="WD"&&(wt=A.weekdays[ut.getDay()]),wt===null?this.value[xt]=this.tokens[xt]:this.value[xt]=wt},Ye=0;Ye<Ge.tokens.length;Ye++)_t.call(Ge,Ye);j=Ge.value.join("")}else j=""}return j},be}var W=k();function G(){var V=(function(q,D){if(q.calendar)return q.calendar.setOptions(D,!0);var O={type:"calendar"};O.options={},O.date=null,O.setOptions=function(ue,be){var j={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:A.monthsShort,monthsFull:A.months,weekdays:A.weekdays,textDone:p.translate("Done"),textReset:p.translate("Reset"),textUpdate:p.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null,controls:!0,autoSelect:!0};for(var J in j)ue&&ue.hasOwnProperty(J)?O.options[J]=ue[J]:(typeof O.options[J]>"u"||be===!0)&&(O.options[J]=j[J]);if(O.options.resetButton==!1?Y.style.display="none":Y.style.display="",O.options.readonly?q.setAttribute("readonly","readonly"):q.removeAttribute("readonly"),O.options.placeholder?q.setAttribute("placeholder",O.options.placeholder):q.removeAttribute("placeholder"),C.isNumeric(O.options.value)&&O.options.value>0&&(O.options.value=V.numToDate(O.options.value),O.options.dataType="numeric"),Y.innerHTML=O.options.textReset,se.innerHTML=O.options.textDone,gt.innerHTML=O.options.textUpdate,O.options.format&&q.setAttribute("data-mask",O.options.format.toLowerCase()),!O.options.value&&O.options.today)var Ce=V.now();else var Ce=O.options.value;return Ce&&(O.options.value=null,O.setValue(Ce)),O},O.open=function(ue){if(!Z.classList.contains("jcalendar-focus")&&!Z.classList.contains("jcalendar-inline")){if(V.current=O,w(O,!0),O.getDays(),O.options.type=="year-month-picker"&&O.getMonths(),O.options.time&&(Ie.value=O.date[3],We.value=O.date[4]),Z.classList.add("jcalendar-focus"),C.getWindowWidth()<800||O.options.fullscreen)Z.classList.add("jcalendar-fullsize"),H.slideBottom(Ae,1);else{Z.classList.remove("jcalendar-fullsize");var be=q.getBoundingClientRect(),j=Ae.getBoundingClientRect();if(O.options.position)_e.style.position="fixed",window.innerHeight<be.bottom+j.height?_e.style.top=be.top-(j.height+2)+"px":_e.style.top=be.top+be.height+2+"px",_e.style.left=be.left+"px";else{if(window.innerHeight<be.bottom+j.height){var J=-1*(be.height+j.height+2);J+be.top<0&&(J=-1*(be.top+be.height)),_e.style.top=J+"px"}else _e.style.top="2px";if(window.innerWidth<be.left+j.width){var J=window.innerWidth-(be.left+j.width+20);_e.style.left=J+"px"}else _e.style.left="0px"}}typeof O.options.onopen=="function"&&O.options.onopen(q)}},O.close=function(ue,be){if(O.options.autoSelect!==!0&&typeof be>"u"&&(be=!1),Z.classList.contains("jcalendar-focus")){if(be!==!1){var j=Z.querySelector(".jcalendar-selected");if(typeof be=="string")var J=be;else if(!j||j.classList.contains("jcalendar-disabled"))var J=O.options.value;else var J=O.getValue();O.setValue(J)}else{let Ce=O.options.value||"";O.options.value=null,O.setValue(Ce)}!ue&&typeof O.options.onclose=="function"&&O.options.onclose(q),Z.classList.remove("jcalendar-focus"),w(O,!1),V.current=null}return O.options.value},O.prev=function(){O.options.mode=="years"?(O.date[0]=O.date[0]-12,O.getYears()):O.options.mode=="months"?(O.date[0]=parseInt(O.date[0])-1,O.getMonths()):(O.date[1]<2?(O.date[0]=O.date[0]-1,O.date[1]=12):O.date[1]=O.date[1]-1,O.getDays())},O.next=function(){O.options.mode=="years"?(O.date[0]=parseInt(O.date[0])+12,O.getYears()):O.options.mode=="months"?(O.date[0]=parseInt(O.date[0])+1,O.getMonths()):(O.date[1]>11?(O.date[0]=parseInt(O.date[0])+1,O.date[1]=1):O.date[1]=parseInt(O.date[1])+1,O.getDays())},O.setToday=function(){var ue=new Date().toISOString().substr(0,10);return O.setValue(ue),ue},O.setValue=function(ue){ue||(ue=""+ue);var be=ue,j=O.options.value;if(j!=be){if(be){O.setLabel(be,O.options);var Ce=be.split(" ");Ce[1]||(Ce[1]="00:00:00");var J=Ce[1].split(":"),Ce=Ce[0].split("-"),Le=parseInt(Ce[0]),me=parseInt(Ce[1]),He=parseInt(Ce[2]),Ze=parseInt(J[0]),Re=parseInt(J[1]);O.date=[Le,me,He,Ze,Re,0];var ue=O.setLabel(be,O.options),xe=V.now(new Date(Le,me-1,He),!0);if(O.options.validRange){if(!O.options.validRange[0]||xe>=O.options.validRange[0])var Ye=!0;else var Ye=!1;if(!O.options.validRange[1]||xe<=O.options.validRange[1])var Ge=!0;else var Ge=!1;Ye&&Ge?(q.classList.remove("jcalendar_warning"),q.title=""):(q.classList.add("jcalendar_warning"),q.title=p.translate("Date outside the valid range"))}else q.classList.remove("jcalendar_warning"),q.title=""}else{O.date=null;var ue="";q.classList.remove("jcalendar_warning"),q.title=""}O.options.value=be,typeof O.options.onchange=="function"&&O.options.onchange(q,be,j),q.value!=ue&&(q.value=ue,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value}))}O.date&&(O.getDays(),O.options.type=="year-month-picker"&&O.getMonths())},O.getValue=function(){return O.date?O.options.time?C.two(O.date[0])+"-"+C.two(O.date[1])+"-"+C.two(O.date[2])+" "+C.two(O.date[3])+":"+C.two(O.date[4])+":"+C.two(0):C.two(O.date[0])+"-"+C.two(O.date[1])+"-"+C.two(O.date[2])+" "+C.two(0)+":"+C.two(0)+":"+C.two(0):""},O.update=function(ue,be){if(!ue.classList.contains("jcalendar-disabled")){var j=Z.querySelector(".jcalendar-selected");j&&j.classList.remove("jcalendar-selected"),ue.classList.add("jcalendar-selected"),ue.classList.contains("jcalendar-set-month")?(O.date[1]=be,O.date[2]=1):O.date[2]=ue.innerText,O.options.time?(O.date[3]=Ie.value,O.date[4]=We.value):O.close(null,!0)}we()},O.reset=function(){O.setValue(""),O.date=null,O.close(!1,!1)},O.getDays=function(){O.options.mode="days";var Ze=new Date,ue=O.date&&C.isNumeric(O.date[0])?O.date[0]:parseInt(Ze.getFullYear()),be=O.date&&C.isNumeric(O.date[1])?O.date[1]:parseInt(Ze.getMonth())+1,j=O.date&&C.isNumeric(O.date[2])?O.date[2]:parseInt(Ze.getDate()),J=O.date&&C.isNumeric(O.date[3])?O.date[3]:parseInt(Ze.getHours()),Ce=O.date&&C.isNumeric(O.date[4])?O.date[4]:parseInt(Ze.getMinutes());O.date=[ue,be,j,J,Ce,0],ke.innerHTML=ue,je.innerHTML=O.options.months[be-1];var Le=Ze.getMonth()==be-1&&Ze.getFullYear()==ue,me=Ze.getDate(),Ze=new Date(ue,be,0,0,0),He=Ze.getDate(),Ze=new Date(ue,be-1,0,0,0),Re=Ze.getDay()+1,Te=O.options.startingDay||0;Re=Re-Te,et.innerHTML="";var xe=document.createElement("tr");xe.setAttribute("align","center"),et.appendChild(xe);for(var Ye=0;Ye<7;Ye++){var Ge=document.createElement("td");Ge.classList.add("jcalendar-weekday"),Ge.innerHTML=O.options.weekdays[Te].substr(0,1),xe.appendChild(Ge),Te++,Te>6&&(Te=0)}for(var Te=0,ze=0,nt=0;nt<6;nt++){var xe=document.createElement("tr");xe.setAttribute("align","center"),xe.style.height="34px";for(var Ye=0;Ye<7;Ye++){var Ge=document.createElement("td");if(Ge.classList.add("jcalendar-set-day"),Te>=Re&&Te<Re+He){ze++,Ge.innerHTML=ze,ze==j&&Ge.classList.add("jcalendar-selected"),Le&&me==ze&&(Ge.style.fontWeight="bold");var ut=V.now(new Date(ue,be-1,ze),!0);if(O.options.validRange){if(!O.options.validRange[0]||ut>=O.options.validRange[0])var _t=!0;else var _t=!1;if(!O.options.validRange[1]||ut<=O.options.validRange[1])var $t=!0;else var $t=!1;_t&&$t||Ge.classList.add("jcalendar-disabled")}}xe.appendChild(Ge),Te++}et.appendChild(xe)}O.options.time?at.style.display="":at.style.display="none",we()},O.getMonths=function(){O.options.mode="months";var ue=O.options.months;O.options.value;var be=new Date,j=parseInt(be.getFullYear()),J=parseInt(be.getMonth())+1,Ce=O.date&&C.isNumeric(O.date[0])?O.date[0]:j,Le=O.date&&C.isNumeric(O.date[1])?O.date[1]:J;ke.innerHTML=O.date[0],je.innerHTML=ue[Le-1];var me=document.createElement("table");me.setAttribute("width","100%");for(var He=null,Ze=0;Ze<12;Ze++){if(!(Ze%4)){var He=document.createElement("tr");He.setAttribute("align","center"),me.appendChild(He)}var Re=document.createElement("td");if(Re.classList.add("jcalendar-set-month"),Re.setAttribute("data-value",Ze+1),Re.innerText=ue[Ze],O.options.validRange){var xe=Ce+"-"+C.two(Ze+1);if(!O.options.validRange[0]||xe>=O.options.validRange[0].substr(0,7))var Ye=!0;else var Ye=!1;if(!O.options.validRange[1]||xe<=O.options.validRange[1].substr(0,7))var Ge=!0;else var Ge=!1;Ye&&Ge||Re.classList.add("jcalendar-disabled")}Ze+1==Le&&Re.classList.add("jcalendar-selected"),j==Ce&&Ze+1==J&&(Re.style.fontWeight="bold"),He.appendChild(Re)}et.innerHTML='<tr><td colspan="7"></td></tr>',et.children[0].children[0].appendChild(me),we()},O.getYears=function(){O.options.mode="years";for(var ue=new Date,be=ue.getFullYear(),j=O.date&&C.isNumeric(O.date[0])?O.date[0]:parseInt(ue.getFullYear()),J=[],Ce=0;Ce<25;Ce++)J[Ce]=parseInt(O.date[0])+(Ce-12);var Le=document.createElement("table");Le.setAttribute("width","100%");for(var Ce=0;Ce<25;Ce++){if(!(Ce%5)){var me=document.createElement("tr");me.setAttribute("align","center"),Le.appendChild(me)}var He=document.createElement("td");He.classList.add("jcalendar-set-year"),He.innerText=J[Ce],j==J[Ce]&&He.classList.add("jcalendar-selected"),be==J[Ce]&&(He.style.fontWeight="bold"),me.appendChild(He)}et.innerHTML='<tr><td colspan="7"></td></tr>',et.firstChild.firstChild.appendChild(Le),we()},O.setLabel=function(ue,be){return V.getDateString(ue,be)},O.fromFormatted=function(ue,be){return V.extractDateFromString(ue,be)};var re=function(ue){var be=C.findElement(ue.target,"jcalendar-container");if(be){var j=ue.target.className;if(j=="jcalendar-prev")O.prev();else if(j=="jcalendar-next")O.next();else if(j=="jcalendar-month")O.getMonths();else if(j=="jcalendar-year")O.getYears();else if(j=="jcalendar-set-year")O.date[0]=ue.target.innerText,O.options.type=="year-month-picker"?O.getMonths():O.getDays();else if(ue.target.classList.contains("jcalendar-set-month")){var J=parseInt(ue.target.getAttribute("data-value"));O.options.type=="year-month-picker"?O.update(ue.target,J):(O.date[1]=J,O.getDays())}else j=="jcalendar-confirm"||j=="jcalendar-update"||j=="jcalendar-close"?O.close(null,!0):j=="jcalendar-backdrop"?O.close(!1,!1):j=="jcalendar-reset"?O.reset():ue.target.classList.contains("jcalendar-set-day")&&ue.target.innerText&&O.update(ue.target)}else O.close(!1,!1)},Ee=function(ue){if(ue.target.value&&ue.target.value.length>3){var be=V.extractDateFromString(ue.target.value,O.options.format);be&&O.setValue(be)}},we=function(){var ue=Z.querySelector(".jcalendar-selected");ue&&ue.classList.contains("jcalendar-disabled")?(gt.setAttribute("disabled","disabled"),Ie.setAttribute("disabled","disabled"),We.setAttribute("disabled","disabled")):(gt.removeAttribute("disabled"),Ie.removeAttribute("disabled"),We.removeAttribute("disabled")),typeof O.options.onupdate=="function"&&O.options.onupdate(q,O.getValue())},Z=null,Y=null,se=null,_e=null,Ae=null,ke=null,je=null,Ue=null,et=null,st=null,at=null,ft=null,gt=null,Ie=null,We=null,tt=function(){q.tagName=="INPUT"&&q.value&&(D.value=q.value),Y=document.createElement("div"),Y.className="jcalendar-reset",se=document.createElement("div"),se.className="jcalendar-confirm",st=document.createElement("div"),st.className="jcalendar-controls",st.style.borderBottom="1px solid #ddd",st.appendChild(Y),st.appendChild(se),_e=document.createElement("div"),_e.className="jcalendar-container",Ae=document.createElement("div"),Ae.className="jcalendar-content",_e.appendChild(Ae),q.tagName=="DIV"?(Z=q,Z.classList.add("jcalendar-inline")):(Ae.appendChild(st),Z=document.createElement("div"),Z.className="jcalendar"),Z.classList.add("jcalendar-container"),Z.appendChild(_e);var ue=document.createElement("div");ue.className="jcalendar-table",Ae.appendChild(ue);var be=document.createElement("td");be.setAttribute("colspan","2"),be.className="jcalendar-prev",ke=document.createElement("span"),ke.className="jcalendar-year",je=document.createElement("span"),je.className="jcalendar-month";var j=document.createElement("td");j.className="jcalendar-header",j.setAttribute("colspan","3"),j.appendChild(je),j.appendChild(ke);var J=document.createElement("td");J.setAttribute("colspan","2"),J.className="jcalendar-next";var Ce=document.createElement("thead"),Le=document.createElement("tr");Le.appendChild(be),Le.appendChild(j),Le.appendChild(J),Ce.appendChild(Le),Ue=document.createElement("table"),et=document.createElement("tbody"),Ue.setAttribute("cellpadding","0"),Ue.setAttribute("cellspacing","0"),Ue.appendChild(Ce),Ue.appendChild(et),ue.appendChild(Ue),Ie=document.createElement("select"),Ie.className="jcalendar-select",Ie.onchange=function(){O.date[3]=this.value,typeof O.options.onupdate=="function"&&O.options.onupdate(q,O.getValue())};for(var me=0;me<24;me++){var He=document.createElement("option");He.value=me,He.innerHTML=C.two(me),Ie.appendChild(He)}We=document.createElement("select"),We.className="jcalendar-select",We.onchange=function(){O.date[4]=this.value,typeof O.options.onupdate=="function"&&O.options.onupdate(q,O.getValue())};for(var me=0;me<60;me++){var He=document.createElement("option");He.value=me,He.innerHTML=C.two(me),We.appendChild(He)}var Ze=document.createElement("div");Ze.className="jcalendar-controls",at=document.createElement("div"),at.className="jcalendar-time",at.style.maxWidth="140px",at.appendChild(Ie),at.appendChild(We),gt=document.createElement("button"),gt.setAttribute("type","button"),gt.className="jcalendar-update",ft=document.createElement("div"),ft.style.flexGrow="10",ft.appendChild(gt),Ze.appendChild(at),q.tagName=="INPUT"&&Ze.appendChild(ft),Ae.appendChild(Ze);var Re=document.createElement("div");Re.className="jcalendar-backdrop",Z.appendChild(Re),q.addEventListener("keyup",Ee),Z.addEventListener("swipeleft",function(xe){H.slideLeft(Ue,0,function(){O.next(),H.slideRight(Ue,1)}),xe.preventDefault(),xe.stopPropagation()}),Z.addEventListener("swiperight",function(xe){H.slideRight(Ue,0,function(){O.prev(),H.slideLeft(Ue,1)}),xe.preventDefault(),xe.stopPropagation()}),"ontouchend"in document.documentElement?(Z.addEventListener("touchend",re),q.addEventListener("touchend",O.open)):(Z.addEventListener("mouseup",re),q.addEventListener("mouseup",O.open)),V.hasEvents||(V.hasEvents=!0,document.addEventListener("keydown",V.keydown)),O.setOptions(D),q.tagName=="INPUT"?(q.parentNode.insertBefore(Z,q.nextSibling),q.setAttribute("autocomplete","off"),q.classList.add("jcalendar-input"),q.value=O.setLabel(O.getValue(),O.options)):(O.getDays(),O.options.time&&(Ie.value=O.date[3],We.value=O.date[4])),O.options.opened==!0&&O.open(),O.options.controls==!1&&_e.classList.add("jcalendar-hide-controls"),q.change=O.setValue,q.val=function(xe){if(xe===void 0)return O.getValue();O.setValue(xe)},q.calendar=Z.calendar=O};return tt(),O});return V.keydown=function(q){var D=null;(D=V.current)&&(q.which==13?D.close(!1,!0):q.which==27&&D.close(!1,!1))},V.prettify=function(q,D){if(!D)var D={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};q.indexOf("GMT")===-1&&q.indexOf("Z")===-1&&(q+=" GMT");var O=new Date,re=new Date(q),Ee=parseInt((O-re)/1e3/60);if(String.prototype.format=function(Z){return this.replace("{0}",Z)},Ee==0)var we=D.justNow;else if(Ee<90)var we=D.xMinutesAgo.format(Ee);else if(Ee<1440)var we=D.xHoursAgo.format(Math.round(Ee/60));else if(Ee<20160)var we=D.xDaysAgo.format(Math.round(Ee/1440));else if(Ee<43200)var we=D.xWeeksAgo.format(Math.round(Ee/10080));else if(Ee<1036800)var we=D.xMonthsAgo.format(Math.round(Ee/43200));else var we=D.xYearsAgo.format(Math.round(Ee/525600));return we},V.prettifyAll=function(){for(var q=document.querySelectorAll(".prettydate"),D=0;D<q.length;D++)q[D].getAttribute("data-date")?q[D].innerHTML=V.prettify(q[D].getAttribute("data-date")):q[D].innerHTML&&(q[D].setAttribute("title",q[D].innerHTML),q[D].setAttribute("data-date",q[D].innerHTML),q[D].innerHTML=V.prettify(q[D].innerHTML))},V.now=A.now,V.toArray=A.toArray,V.dateToNum=A.dateToNum,V.numToDate=A.numToDate,V.weekdays=A.weekdays,V.months=A.months,V.weekdaysShort=A.weekdaysShort,V.monthsShort=A.monthsShort,V.extractDateFromString=W.extractDateFromString,V.getDateString=W.getDateString,V}var oe=G();function ae(){var V={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},q=function(D){return V[D]?V[D]:V.material};return q.get=function(D){return V[D]?V[D]:V},q.set=function(D,O){V[D]=O},q}var X=ae();function le(V,q){var D={};D.options={};var O={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var re in O)q&&q.hasOwnProperty(re)?D.options[re]=q[re]:D.options[re]=O[re];V.classList.add("jtabs");var Ee=null,we=null,Z=null;const Y=function(je){D.options.animation&&setTimeout(function(){let Ue=D.headers.children[je].getBoundingClientRect();D.options.palette==="modern"?(Z.style.width=Ue.width-4+"px",Z.style.left=D.headers.children[je].offsetLeft+2+"px"):(Z.style.width=Ue.width+"px",Z.style.left=D.headers.children[je].offsetLeft+"px"),D.options.position==="bottom"?Z.style.top="0px":Z.style.bottom="0px"},50)};var se=function(je){typeof D.headers.scrollTo=="function"?D.headers.scrollTo({left:je,behavior:"smooth"}):D.headers.scrollLeft=je,je<=1?Ee.classList.add("disabled"):Ee.classList.remove("disabled"),je>=D.headers.scrollWidth-D.headers.offsetWidth?we.classList.add("disabled"):we.classList.remove("disabled"),D.headers.scrollWidth<=D.headers.offsetWidth?(Ee.style.display="none",we.style.display="none"):(Ee.style.display="",we.style.display="")};if(D.setBorder=Y,D.open=function(je){if(Array.from(D.content.children),!!D.content.children[je]){for(var Ue=null,et=0;et<D.headers.children.length;et++)D.headers.children[et].classList.contains("jtabs-selected")&&(Ue=et),D.headers.children[et].classList.remove("jtabs-selected"),D.headers.children[et].removeAttribute("aria-selected"),D.content.children[et]&&D.content.children[et].classList.remove("jtabs-selected");if(D.headers.children[je].classList.add("jtabs-selected"),D.headers.children[je].setAttribute("aria-selected","true"),D.content.children[je]&&D.content.children[je].classList.add("jtabs-selected"),Ue!=je&&typeof D.options.onchange=="function"&&D.content.children[je]&&D.options.onchange(V,D,je,D.headers.children[je],D.content.children[je]),D.options.hideHeaders==!0&&D.headers.children.length<3&&D.options.allowCreate==!1)D.headers.parentNode.style.display="none";else{D.headers.parentNode.style.display="";var st=D.headers.children[je].offsetLeft,at=st+D.headers.children[je].offsetWidth,ft=D.headers.scrollLeft,gt=ft+D.headers.offsetWidth;ft<=st&&gt>=at||se(st-1),Y(je)}}},D.selectIndex=function(je){var Ue=Array.prototype.indexOf.call(D.headers.children,je);return Ue>=0&&D.open(Ue),Ue},D.rename=function(je,Ue){Ue||(Ue=prompt("New title",D.headers.children[je].innerText)),D.headers.children[je].innerText=Ue,Y(D.getActive())},D.create=function(je,Ue){if(typeof D.options.onbeforecreate=="function"){var et=D.options.onbeforecreate(V,je);if(et===!1)return!1;je=et}var st=D.appendElement(je);return typeof D.options.oncreate=="function"&&D.options.oncreate(V,st),Y(D.getActive()),st},D.remove=function(je){return D.deleteElement(je)},D.nextNumber=function(){for(var je=0,Ue=0;Ue<D.headers.children.length;Ue++){var et=D.headers.children[Ue].innerText.match(/[0-9].*/);et>je&&(je=parseInt(et))}return je?je++:je=1,je},D.deleteElement=function(je){let Ue=D.getActive();if(D.headers.children[je])D.headers.removeChild(D.headers.children[je]),D.content.removeChild(D.content.children[je]);else return!1;if(Ue===je)D.open(0);else{let et=D.getActive()||0;Y(et)}typeof D.options.ondelete=="function"&&D.options.ondelete(V,je)},D.appendElement=function(je,Ue,et,st){if(!je)var je=prompt("Title?","");if(je){let gt=C.guid(),Ie=C.guid();var at=document.createElement("div");at.setAttribute("id",Ie),at.setAttribute("role","tabpanel"),at.setAttribute("aria-labelledby",gt);var ft=document.createElement("div");if(ft.setAttribute("id",gt),ft.setAttribute("role","tab"),ft.setAttribute("aria-controls",Ie),ft.textContent=je,ft.content=at,typeof st>"u")D.content.appendChild(at),D.headers.insertBefore(ft,D.headers.lastChild);else{let We=D.content.children[st];We?D.content.insertBefore(at,We):D.content.appendChild(at),We=D.headers.children[st]||D.headers.lastChild,D.headers.insertBefore(ft,We)}return D.options.allowChangePosition&&ft.setAttribute("draggable","true"),et!==!1&&D.selectIndex(ft),typeof Ue=="function"&&Ue(at,ft),at}},D.getActive=function(){for(var je=0;je<D.headers.children.length;je++)if(D.headers.children[je].classList.contains("jtabs-selected"))return je;return!1},D.updateContent=function(je,Ue){if(typeof Ue!="string")var et=Ue;else{var et=document.createElement("div");et.innerHTML=Ue}D.content.children[je].classList.contains("jtabs-selected")&&Ue.classList.add("jtabs-selected"),D.content.replaceChild(Ue,D.content.children[je]),Y()},D.updatePosition=function(je,Ue,et,st){if(je>Ue?D.content.insertBefore(D.content.children[je],D.content.children[Ue]):D.content.insertBefore(D.content.children[je],D.content.children[Ue].nextSibling),st!==!1)D.open(Ue);else{const at=D.getActive();Ue<at&&D.setBorder(at)}!et&&typeof D.options.onchangeposition=="function"&&D.options.onchangeposition(D.headers,je,Ue)},D.move=function(je,Ue,et,st){je>Ue?D.headers.insertBefore(D.headers.children[je],D.headers.children[Ue]):D.headers.insertBefore(D.headers.children[je],D.headers.children[Ue].nextSibling),D.updatePosition(je,Ue,et,st)},D.setBorder=Y,D.init=function(){V.textContent="",D.headers=document.createElement("div"),D.content=document.createElement("div"),D.headers.classList.add("jtabs-headers"),D.headers.setAttribute("role","tablist"),D.content.classList.add("jtabs-content"),D.content.setAttribute("role","region"),D.content.setAttribute("aria-label","Tab Panels"),D.options.palette?V.classList.add("jtabs-modern"):V.classList.remove("jtabs-modern"),D.options.padding&&(D.content.style.padding=parseInt(D.options.padding)+"px");var je=document.createElement("div");je.className="jtabs-headers-container",je.appendChild(D.headers),D.options.maxWidth&&(je.style.maxWidth=parseInt(D.options.maxWidth)+"px");var Ue=document.createElement("div");if(Ue.className="jtabs-controls",Ue.setAttribute("draggable","false"),je.appendChild(Ue),D.options.position=="bottom"?(V.appendChild(D.content),V.appendChild(je)):(V.appendChild(je),V.appendChild(D.content)),D.options.allowCreate==!0){var et=document.createElement("div");et.className="jtabs-add",et.onclick=function(){D.create()},Ue.appendChild(et)}Ee=document.createElement("div"),Ee.className="jtabs-prev",Ee.onclick=function(){se(D.headers.scrollLeft-D.headers.offsetWidth)},Ue.appendChild(Ee),we=document.createElement("div"),we.className="jtabs-next",we.onclick=function(){se(D.headers.scrollLeft+D.headers.offsetWidth)},Ue.appendChild(we);for(var st=0;st<D.options.data.length;st++){if(D.options.data[st].titleElement)var at=D.options.data[st].titleElement;else var at=document.createElement("div");if(D.options.data[st].icon){var ft=document.createElement("div"),gt=document.createElement("i");gt.classList.add("material-icons"),gt.textContent=D.options.data[st].icon,ft.appendChild(gt),at.appendChild(ft)}if(D.options.data[st].title){var Ie=document.createTextNode(D.options.data[st].title);at.appendChild(Ie)}if(D.options.data[st].width&&(at.style.width=D.options.data[st].width),D.options.data[st].contentElement)var We=D.options.data[st].contentElement;else{var We=document.createElement("div");We.innerHTML=D.options.data[st].content}D.headers.appendChild(at),D.content.appendChild(We)}Z=document.createElement("div"),Z.className="jtabs-border",D.headers.appendChild(Z),D.options.animation&&V.classList.add("jtabs-animation"),D.headers.addEventListener("click",function(tt){if(tt.target.parentNode.classList.contains("jtabs-headers"))var ue=tt.target;else if(tt.target.tagName=="I")var ue=tt.target.parentNode.parentNode;else var ue=tt.target.parentNode;var be=D.selectIndex(ue);typeof D.options.onclick=="function"&&D.options.onclick(V,D,be,D.headers.children[be],D.content.children[be])}),D.headers.addEventListener("contextmenu",function(tt){D.selectIndex(tt.target)}),D.headers.children.length&&D.open(0),se(0),D.options.allowChangePosition==!0&&R(D.headers,{direction:1,ondrop:function(tt,ue,be){D.updatePosition(ue,be)}}),typeof D.options.onload=="function"&&D.options.onload(V,D)},V.children[0]&&V.children[0].children.length)for(var _e=0;_e<V.children[0].children.length;_e++){var Ae=D.options.data&&D.options.data[_e]?D.options.data[_e]:{};V.children[1]&&V.children[1].children[_e]?(Ae.titleElement=V.children[0].children[_e],Ae.contentElement=V.children[1].children[_e]):Ae.contentElement=V.children[0].children[_e],D.options.data[_e]=Ae}var ke=!1;if(D.options.data)for(var _e=0;_e<D.options.data.length;_e++)D.options.data[_e].url&&(M({url:D.options.data[_e].url,type:"GET",dataType:"text/html",index:_e,success:function(Ue){D.options.data[this.index].content=Ue},complete:function(){D.init()}}),ke=!0);return ke||D.init(),V.tabs=D,D}function ye(V,q){if(V.color)return V.color.setOptions(q,!0);var D={type:"color"};D.options={};var O=null,re=null,Ee=null,we=null,Z=null,Y=null,se=null;D.setOptions=function(j,J){var Ce={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};j||(j={}),j&&!j.palette&&(j.palette=X());for(var Le in Ce)j&&j.hasOwnProperty(Le)?D.options[Le]=j[Le]:(typeof D.options[Le]>"u"||J===!0)&&(D.options[Le]=Ce[Le]);return we&&(we.innerHTML=D.options.resetLabel),Z&&(Z.innerHTML=D.options.doneLabel),D.options.palette&&se&&se.updateContent(0,Ue()),typeof D.options.value=="string"&&(V.value=D.options.value,V.tagName==="INPUT"&&(V.style.color=V.value,V.style.backgroundColor=V.value)),D.options.placeholder?V.setAttribute("placeholder",D.options.placeholder):V.getAttribute("placeholder")&&V.removeAttribute("placeholder"),D},D.select=function(j){var J=O.querySelector(".jcolor-selected");J&&J.classList.remove("jcolor-selected"),D.values[j]&&D.values[j].classList.add("jcolor-selected"),D.options.value=j},D.open=function(){if(!O.classList.contains("jcolor-focus")){w(D,!0),O.classList.add("jcolor-focus"),D.options.value&&D.select(D.options.value),Ee.style.marginTop="",Ee.style.marginLeft="";var j=Ee.getBoundingClientRect(),J=C.getWindowWidth(),Ce=C.getWindowHeight();if(J<800||D.options.fullscreen==!0?(Ee.classList.add("jcolor-fullscreen"),H.slideBottom(Ee,1),re.style.display="block"):(Ee.classList.contains("jcolor-fullscreen")&&(Ee.classList.remove("jcolor-fullscreen"),re.style.display=""),D.options.position?Ee.style.position="fixed":Ee.style.position="",j.left+j.width>J&&(Ee.style.marginLeft=-1*(j.left+j.width-(J-20))+"px"),j.top+j.height>Ce&&(Ee.style.marginTop=-1*(j.top+j.height-(Ce-20))+"px")),typeof D.options.onopen=="function"&&D.options.onopen(V,D),se.setBorder(se.getActive()),D.options.value){var Le=je(D.options.value);We.forEach(function(me,He){me.value=Le[He],me.dispatchEvent(new Event("input"))})}}},D.close=function(j){return O.classList.contains("jcolor-focus")&&(O.classList.remove("jcolor-focus"),re.style.display="",!j&&typeof D.options.onclose=="function"&&D.options.onclose(V,D),w(D,!1)),D.options.value},D.setValue=function(j){j||(j=""),j!=D.options.value&&(D.options.value=j,Ie=j,D.select(j),typeof D.options.onchange=="function"&&D.options.onchange(V,j,D),V.value!=D.options.value&&(V.value=D.options.value,V.tagName==="INPUT"&&(V.style.color=V.value,V.style.backgroundColor=V.value),typeof V.oninput=="function"&&V.oninput({type:"input",target:V,value:V.value})),D.options.closeOnChange==!0&&D.close())},D.getValue=function(){return D.options.value};var _e=function(j){var J=j.toString(16);return J.length===1?"0"+J:J},Ae=function(j,J,Ce){return"#"+_e(j)+_e(J)+_e(Ce)},ke=function(j){return parseInt("0x"+j)},je=function(j){return[ke(j.substr(1,2)),ke(j.substr(3,2)),ke(j.substr(5,2))]},Ue=function(){var j=document.createElement("div");j.className="jcolor-grid",D.values=[];var J=document.createElement("table");J.setAttribute("cellpadding","7"),J.setAttribute("cellspacing","0");for(var Ce=0;Ce<D.options.palette.length;Ce++){for(var Le=document.createElement("tr"),me=0;me<D.options.palette[Ce].length;me++){var He=document.createElement("td"),Ze=D.options.palette[Ce][me];Ze.length<7&&Ze.substr(0,1)!=="#"&&(Ze="#"+Ze),He.style.backgroundColor=Ze,He.setAttribute("data-value",Ze),He.innerHTML="",Le.appendChild(He),D.options.value==Ze&&He.classList.add("jcolor-selected"),D.values[Ze]=He}J.appendChild(Le)}return j.appendChild(J),j},et=document.createElement("canvas");et.width=200,et.height=160;var st=et.getContext("2d"),at=function(){var j=Y.firstChild.getBoundingClientRect();et.width=j.width-14,ft()},ft=function(){var j=st.createLinearGradient(0,0,et.width,0);j.addColorStop(0,"rgb(255,0,0)"),j.addColorStop(.15,"rgb(255,0,255)"),j.addColorStop(.33,"rgb(0,0,255)"),j.addColorStop(.49,"rgb(0,255,255)"),j.addColorStop(.67,"rgb(0,255,0)"),j.addColorStop(.84,"rgb(255,255,0)"),j.addColorStop(1,"rgb(255,0,0)"),st.fillStyle=j,st.fillRect(0,0,et.width,et.height),j=st.createLinearGradient(0,0,0,et.height),j.addColorStop(0,"rgba(255,255,255,1)"),j.addColorStop(.5,"rgba(255,255,255,0)"),j.addColorStop(.5,"rgba(0,0,0,0)"),j.addColorStop(1,"rgba(0,0,0,1)"),st.fillStyle=j,st.fillRect(0,0,et.width,et.height)},gt=function(){var j=document.createElement("div");j.className="jcolor-hsl";var J=document.createElement("div");J.className="jcolor-point";var Ce=document.createElement("div");Ce.appendChild(et),Ce.appendChild(J),j.appendChild(Ce);var Le=function(me,He,Ze){if(me===1){var Re=j.getBoundingClientRect(),xe=He-Re.left,Ye=Ze-Re.top;xe<0&&(xe=0),Ye<0&&(Ye=0),xe>Re.width&&(xe=Re.width),Ye>Re.height&&(Ye=Re.height),J.style.left=xe+"px",J.style.top=Ye+"px";var Ge=st.getImageData(xe,Ye,1,1).data;Ie=Ae(Ge[0],Ge[1],Ge[2])}};return j.addEventListener("mousedown",function(me){Le(me.buttons,me.clientX,me.clientY)}),j.addEventListener("mousemove",function(me){Le(me.buttons,me.clientX,me.clientY)}),j.addEventListener("touchmove",function(me){Le(1,me.changedTouches[0].clientX,me.changedTouches[0].clientY)}),j},Ie="",We=[],tt=function(){if(Ie!=="")for(var j=0;j<We.length;j++){var J=je(Ie);J[j]=0;var Ce="linear-gradient(90deg, rgb(";Ce+=J.join(", "),Ce+="), rgb(",J[j]=255,Ce+=J.join(", "),Ce+="))",We[j].style.backgroundImage=Ce}},ue=function(){var j=document.createElement("div");j.className="jcolor-sliders";var J=document.createElement("div"),Ce=function(Ze){var Re=document.createElement("div");Re.className="jcolor-sliders-input-container";var xe=document.createElement("label");xe.innerText=Ze;var Ye=document.createElement("div");Ye.className="jcolor-sliders-input-subcontainer";var Ge=document.createElement("input");Ge.type="range",Ge.min=0,Ge.max=255,Ge.value=0,Ge.setAttribute("aria-label","Color value"),Ge.setAttribute("aria-valuemin","0"),Ge.setAttribute("aria-valuemax","255"),Ge.setAttribute("aria-valuenow","0"),Re.appendChild(xe),Ye.appendChild(Ge);var Te=document.createElement("div");return Te.innerText=Ge.value,Ge.addEventListener("input",function(){Te.innerText=Ge.value}),Ye.appendChild(Te),Re.appendChild(Ye),J.appendChild(Re),Ge};We=[Ce("Red"),Ce("Green"),Ce("Blue")],j.appendChild(J);var Le=document.createElement("div");Le.className="jcolor-sliders-final-color";var me=document.createElement("div");me.style.visibility="hidden",me.innerText="a",Le.appendChild(me);var He=function(){var Ze=Ae(parseInt(We[0].value),parseInt(We[1].value),parseInt(We[2].value));me.innerText=Ze,me.style.color=Ze,me.style.removeProperty("visibility"),Ie=Ze};return We.forEach(function(Ze){Ze.addEventListener("input",function(){He(),tt()})}),j.appendChild(Le),j},be=function(){D.setOptions(q),V.tagName=="INPUT"&&(V.classList.add("jcolor-input"),V.readOnly=!0),O=document.createElement("div"),O.className="jcolor",re=document.createElement("div"),re.className="jcolor-backdrop",O.appendChild(re),Ee=document.createElement("div"),Ee.className="jcolor-content";var j=document.createElement("div");j.className="jcolor-controls",Ee.appendChild(j),we=document.createElement("div"),we.className="jcolor-reset",we.innerHTML=D.options.resetLabel,j.appendChild(we),Z=document.createElement("div"),Z.className="jcolor-close",Z.innerHTML=D.options.doneLabel,j.appendChild(Z),Y=document.createElement("div"),Ee.appendChild(Y),se=le(Y,{animation:!0,data:[{title:"Grid",contentElement:Ue()},{title:"Spectrum",contentElement:gt()},{title:"Sliders",contentElement:ue()}],onchange:function(J,Ce,Le){if(Le===1)at();else{var me=Ie!==""?Ie:D.getValue();if(Le===2&&me){var He=je(me);We.forEach(function(Ze,Re){Ze.value=He[Re],Ze.dispatchEvent(new Event("input"))})}}},palette:"modern"}),O.appendChild(Ee),V.tagName=="INPUT"?V.parentNode.insertBefore(O,V.nextSibling):V.appendChild(O),O.addEventListener("click",function(J){if(J.target.tagName=="TD"){var Ce=J.target.getAttribute("data-value");Ce&&D.setValue(Ce)}else J.target.classList.contains("jcolor-reset")?(D.setValue(""),D.close()):J.target.classList.contains("jcolor-close")?(se.getActive()>0&&D.setValue(Ie),D.close()):J.target.classList.contains("jcolor-backdrop")?D.close():D.open()}),V.addEventListener("mouseup",function(J){D.open()}),window.addEventListener("resize",function(){O.classList.contains("jcolor-focus")&&se.getActive()==1&&at()}),D.options.opened==!0&&D.open(),V.change=D.setValue,V.val=function(J){if(J===void 0)return D.getValue();D.setValue(J)},V.color=D,O.color=D};return D.toHex=function(j){var J=function(Ce){return("0"+parseInt(Ce).toString(16)).slice(-2)};if(j)return/^#[0-9A-F]{6}$/i.test(j)?j:(j=j.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),j&&j.length?"#"+J(j[1])+J(j[2])+J(j[3]):"")},be(),D}function pe(){var V=function(q,D){var O={type:"contextmenu"};O.options={};var re={items:null,onclick:null};for(var Ee in re)D&&D.hasOwnProperty(Ee)?O.options[Ee]=D[Ee]:O.options[Ee]=re[Ee];q.classList.add("jcontextmenu"),O.open=function(Y,se){if(se&&(O.options.items=se,O.create(se)),V.current&&V.current.close(),w(O,!0),q.classList.add("jcontextmenu-focus"),V.current=O,O.options.items&&O.options.items.length>0||q.children.length){if(Y.target)if(Y.changedTouches&&Y.changedTouches[0])_e=Y.changedTouches[0].clientX,Ae=Y.changedTouches[0].clientY;else var _e=Y.clientX,Ae=Y.clientY;else var _e=Y.x,Ae=Y.y;var ke=q.getBoundingClientRect();if(window.innerHeight<Ae+ke.height){var je=Ae-ke.height;je<0&&(je=0),q.style.top=je+"px"}else q.style.top=Ae+"px";window.innerWidth<_e+ke.width?_e-ke.width>0?q.style.left=_e-ke.width+"px":q.style.left="10px":q.style.left=_e+"px"}},O.isOpened=function(){return!!q.classList.contains("jcontextmenu-focus")},O.close=function(){q.classList.contains("jcontextmenu-focus")&&q.classList.remove("jcontextmenu-focus"),w(O,!1)},O.create=function(Y){q.innerHTML="";var se=we();q.appendChild(se);for(var _e=0;_e<Y.length;_e++){var Ae=Z(Y[_e]);q.appendChild(Ae)}};function we(){var Y=document.createElement("div");Y.classList.add("header"),Y.addEventListener("click",function(Ae){Ae.preventDefault(),Ae.stopPropagation()});var se=document.createElement("a");se.classList.add("title"),se.innerHTML=p.translate("Menu"),Y.appendChild(se);var _e=document.createElement("a");return _e.classList.add("close"),_e.innerHTML=p.translate("close"),_e.addEventListener("click",function(Ae){O.close()}),Y.appendChild(_e),Y}function Z(Y){if(Y.type&&(Y.type=="line"||Y.type=="divisor"))var se=document.createElement("hr");else{var se=document.createElement("div"),_e=document.createElement("a");if(_e.innerHTML=Y.title,Y.tooltip&&se.setAttribute("title",Y.tooltip),Y.icon&&se.setAttribute("data-icon",Y.icon),Y.id&&(se.id=Y.id),Y.disabled?se.className="jcontextmenu-disabled":Y.onclick&&(se.method=Y.onclick,se.addEventListener("mousedown",function(ft){ft.preventDefault()}),se.addEventListener("mouseup",function(ft){this.method(this,ft)})),se.appendChild(_e),Y.submenu){var Ae=document.createElement("span");Ae.innerHTML="&#9658;",se.appendChild(Ae),se.classList.add("jcontexthassubmenu");var ke=document.createElement("div");ke.classList.add("jcontextmenu"),ke.setAttribute("tabindex","900");for(var je=Y.submenu,Ue=0;Ue<je.length;Ue++){var et=Z(je[Ue]);ke.appendChild(et)}se.appendChild(ke),se.addEventListener("mouseenter",function(){ke.style.left="",ke.style.right="",ke.style.minWidth=se.offsetWidth+"px",ke.style.display="block",ke.style.opacity="0",ke.style.pointerEvents="none";var ft=se.getBoundingClientRect(),gt=ke.getBoundingClientRect(),Ie=window.innerWidth||document.documentElement.clientWidth,We=ft.right+gt.width,tt=ft.left-gt.width;We>Ie&&tt>=0?(ke.style.left="auto",ke.style.right="99%"):We>Ie&&tt<0?(ke.style.left="32px",ke.style.right="auto",ke.style.top="100%"):(ke.style.left="99%",ke.style.right="auto"),ke.style.opacity="",ke.style.pointerEvents="",ke.style.display=""}),se.addEventListener("mouseleave",function(){ke.style.left="",ke.style.right="",ke.style.minWidth=""})}else if(Y.shortcut){var st=document.createElement("span");st.innerHTML=Y.shortcut,se.appendChild(st)}}return se}return typeof O.options.onclick=="function"&&q.addEventListener("click",function(Y){O.options.onclick(O,Y)}),O.options.items&&O.create(O.options.items),window.addEventListener("mousewheel",function(){O.close()}),q.contextmenu=O,O};return V}var he=pe();function Me(){var V=(function(q,D){if(q.dropdown)return q.dropdown.setOptions(D,!0);var O={type:"dropdown"};O.options={};var re=function(ue,be){ue&&ue.length&&(O.options.sortResults!==!1&&(typeof O.options.sortResults=="function"?ue.sort(O.options.sortResults):ue.sort(Ee)),O.setData(ue)),typeof O.options.onload=="function"&&O.options.onload(q,O,ue,be),be&&Z(be),be==null&&(O.options.value=""),q.value=O.options.value,O.options.opened==!0&&O.open()},Ee=function(ue,be){var j,J;return typeof ue=="string"?j=ue:ue.text?j=ue.text:ue.name&&(j=ue.name),typeof be=="string"?J=be:be.text?J=be.text:be.name&&(J=be.name),typeof j=="string"||typeof J=="string"?(typeof j!="string"&&(j=""+j),typeof J!="string"&&(J=""+J),j.localeCompare(J)):j-J},we=function(){O.value={};for(var ue=0;ue<O.items.length;ue++)O.items[ue].selected==!0&&(O.items[ue].element&&O.items[ue].element.classList.remove("jdropdown-selected"),O.items[ue].selected=null);O.options.value="",q.value=""},Z=function(ue){if(we(),ue!==null)if(!ue)typeof O.value[""]<"u"&&(O.value[""]="");else{Array.isArray(ue)||(ue=(""+ue).split(";"));for(var be=0;be<ue.length;be++)O.value[ue[be]]=""}for(var be=0;be<O.items.length;be++)typeof O.value[Y(be)]<"u"&&(O.items[be].element&&O.items[be].element.classList.add("jdropdown-selected"),O.items[be].selected=!0,O.value[Y(be)]=se(be));O.options.value=Object.keys(O.value).join(";"),O.header.value=O.getText()},Y=function(ue,be){if(O.options.format)var j="id";else var j="value";return O.items[ue]?O.items[ue].data[j]:""},se=function(ue,be){if(O.options.format)var j="name";else var j="text";return O.items[ue]?O.items[ue].data[j]:""},_e=function(){return Object.keys(O.value)},Ae=function(){for(var ue=[],be=Object.keys(O.value),j=0;j<be.length;j++)ue.push(O.value[be[j]]);return ue};O.setOptions=function(ue,be){ue||(ue={});var j={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,onsearch:null,onbeforesearch:null,sortResults:!1,autofocus:!1,prompt:null,allowEmpty:!0};for(var J in j)ue&&ue.hasOwnProperty(J)?O.options[J]=ue[J]:(typeof O.options[J]>"u"||be===!0)&&(O.options[J]=j[J]);return(O.options.remoteSearch==!0||O.options.type==="searchbar")&&(O.options.autocomplete=!0),O.options.newOptions==!0?O.header.classList.add("jdropdown-add"):O.header.classList.remove("jdropdown-add"),O.options.autocomplete==!0?O.header.removeAttribute("readonly"):O.header.setAttribute("readonly","readonly"),O.options.placeholder?O.header.setAttribute("placeholder",O.options.placeholder):O.header.removeAttribute("placeholder"),q.classList.remove("jdropdown-searchbar"),q.classList.remove("jdropdown-picker"),q.classList.remove("jdropdown-list"),O.options.type=="searchbar"?q.classList.add("jdropdown-searchbar"):O.options.type=="list"?q.classList.add("jdropdown-list"):O.options.type=="picker"?q.classList.add("jdropdown-picker"):C.getWindowWidth()<800?O.options.autocomplete?(q.classList.add("jdropdown-searchbar"),O.options.type="searchbar"):(q.classList.add("jdropdown-picker"),O.options.type="picker"):(O.options.width?(q.style.width=O.options.width,q.style.minWidth=O.options.width):(q.style.removeProperty("width"),q.style.removeProperty("min-width")),q.classList.add("jdropdown-default"),O.options.type="default"),O.options.type=="searchbar"?ke.appendChild(et):je.insertBefore(et,je.firstChild),O.options.url&&!ue.data?M({url:O.options.url,method:"GET",dataType:"json",success:function(Ce){Ce&&re(Ce,O.options.value)}}):re(O.options.data,O.options.value),O};var ke=null,je=null,Ue=null,et=null,st=null,at=null,ft=null,gt=function(){if(D||(D={}),q.tagName=="SELECT"){var ue=V.extractFromDom(q,D);q=ue.el,D=ue.options}!D.placeholder&&q.getAttribute("placeholder")&&(D.placeholder=q.getAttribute("placeholder")),O.value={},O.items=[],O.groups=[],O.search="",O.results=null,q.classList.add("jdropdown"),ke=document.createElement("div"),ke.className="jdropdown-container-header",O.header=document.createElement("input"),O.header.className="jdropdown-header jss_object",O.header.type="text",O.header.setAttribute("autocomplete","off"),O.header.onfocus=function(){typeof O.options.onfocus=="function"&&O.options.onfocus(q)},O.header.onblur=function(){typeof O.options.onblur=="function"&&O.options.onblur(q)},O.header.onkeyup=function(be){O.options.autocomplete==!0&&!ft?(O.search!=O.header.value.trim()&&(ft=setTimeout(function(){O.find(O.header.value.trim()),ft=null},400)),q.classList.contains("jdropdown-focus")||O.open()):O.options.autocomplete||O.next(be.key)},V.hasEvents||(V.hasEvents=!0,document.addEventListener("keydown",V.keydown)),je=document.createElement("div"),je.className="jdropdown-container",Ue=document.createElement("div"),Ue.className="jdropdown-content",et=document.createElement("div"),et.className="jdropdown-close",et.textContent="Done",st=document.createElement("div"),st.className="jdropdown-reset",st.textContent="x",st.onclick=function(){O.reset(),O.close()},at=document.createElement("div"),at.className="jdropdown-backdrop",ke.appendChild(O.header),je.appendChild(Ue),q.appendChild(ke),q.appendChild(je),q.appendChild(at),O.setOptions(D),"ontouchsend"in document.documentElement?q.addEventListener("touchsend",V.mouseup):q.addEventListener("mouseup",V.mouseup),O.options.lazyLoading==!0&&T(Ue,{loadUp:O.loadUp,loadDown:O.loadDown}),Ue.onwheel=function(be){be.stopPropagation()},q.change=O.setValue,q.val=function(be){if(be===void 0)return O.getValue(!!O.options.multiple);O.setValue(be)},q.dropdown=O};O.getUrl=function(){return O.options.url},O.setUrl=function(ue,be){O.options.url=ue,M({url:O.options.url,method:"GET",dataType:"json",success:function(j){O.setData(j),typeof be=="function"&&be(O)}})},O.setId=function(ue,be){if(O.options.format)var j="id";else var j="value";typeof ue=="object"?ue[j]=be:O.items[ue].data[j]=be};const Ie=function(ue,be){if(!ue){let Ce=O.options.autocomplete==!0?O.header.value:"";if(ue=prompt(p.translate("Add A New Option"),Ce),!ue)return!1}if(be||(be=C.guid()),O.options.format)var j={id:be,name:ue};else var j={value:be,text:ue};if(typeof O.options.onbeforeinsert=="function"){let Ce=O.options.onbeforeinsert(O,j);if(Ce===!1)return!1;Ce&&(j=Ce)}O.options.data.push(j);var J=O.createItem(j);return Ue.appendChild(J.element),typeof O.options.oninsert=="function"&&O.options.oninsert(O,j,J),Ue.style.display=="none"&&(Ue.style.display=""),O.results&&O.results.push(J),j};O.add=function(ue,be){return typeof O.options.prompt=="function"?O.options.prompt.call(O,Ie):Ie(ue,be)},O.createItem=function(ue,be,j){O.options.format?(!ue.id&&ue.value!==void 0&&(ue.id=ue.value),!ue.name&&ue.text!==void 0&&(ue.name=ue.text)):(!ue.value&&ue.id!==void 0&&(ue.value=ue.id),!ue.text&&ue.name!==void 0&&(ue.text=ue.name));var J={};if(J.element=document.createElement("div"),J.element.className="jdropdown-item",J.element.indexValue=O.items.length,J.data=ue,be&&(J.group=be),ue.id&&J.element.setAttribute("id",ue.id),ue.disabled==!0&&J.element.setAttribute("data-disabled",!0),ue.tooltip&&J.element.setAttribute("title",ue.tooltip),ue.image){var Ce=document.createElement("img");Ce.className="jdropdown-image",Ce.src=ue.image,ue.title||Ce.classList.add("jdropdown-image-small"),J.element.appendChild(Ce)}else if(ue.icon){var Le=document.createElement("span");Le.className="jdropdown-icon material-icons",Le.innerText=ue.icon,ue.title||Le.classList.add("jdropdown-icon-small"),ue.color&&(Le.style.color=ue.color),J.element.appendChild(Le)}else if(ue.color){var me=document.createElement("div");me.className="jdropdown-color",me.style.backgroundColor=ue.color,J.element.appendChild(me)}if(O.options.format)var He=ue.name;else var He=ue.text;var Ze=document.createElement("div");if(Ze.className="jdropdown-description",Ze.textContent=He||"&nbsp;",ue.title){var Re=document.createElement("div");Re.className="jdropdown-title",Re.innerText=ue.title,Ze.appendChild(Re)}if(O.options.format)var xe=ue.id;else var xe=ue.value;return O.value[xe]&&(J.element.classList.add("jdropdown-selected"),J.selected=!0),O.items.push(J),J.element.appendChild(Ze),J},O.appendData=function(ue){if(ue.length){for(var be=[],j=[],J=0;J<ue.length;J++)ue[J].group?(j[ue[J].group]||(j[ue[J].group]=[]),j[ue[J].group].push(J)):be.push(J);var Ce=0,Le=Object.keys(j);if(Le.length>0)for(var J=0;J<Le.length;J++){var me=document.createElement("div");me.className="jdropdown-group";var He=document.createElement("div");He.className="jdropdown-group-name",He.textContent=Le[J];var Ze=document.createElement("i");Ze.className="jdropdown-group-arrow jdropdown-group-arrow-down",He.appendChild(Ze);var Re=document.createElement("div");Re.className="jdropdown-group-items";for(var xe=0;xe<j[Le[J]].length;xe++){var Ye=O.createItem(ue[j[Le[J]][xe]],me,Le[J]);(O.options.lazyLoading==!1||Ce<200)&&(Re.appendChild(Ye.element),Ce++)}me.appendChild(He),me.appendChild(Re),O.groups.push(me),Re.children.length>0&&Ue.appendChild(me)}if(be.length)for(var J=0;J<be.length;J++){var Ye=O.createItem(ue[be[J]]);(O.options.lazyLoading==!1||Ce<200)&&(Ue.appendChild(Ye.element),Ce++)}}},O.setData=function(ue){if(we(),Ue.textContent="",O.header.value="",O.items=[],ue&&ue.length){for(var be=0;be<ue.length;be++)typeof ue[be]!="object"&&(O.options.format?ue[be]={id:ue[be],name:ue[be]}:ue[be]={value:ue[be],text:ue[be]});O.appendData(ue),O.options.data=ue}else O.options.data=[];O.close()},O.getData=function(){return O.options.data},O.getPosition=function(ue){for(var be=0;be<O.items.length;be++)if(Y(be)==ue)return be;return!1},O.getText=function(ue){var be=Ae();return ue?be:be.join("; ")},O.getValue=function(ue){var be=_e();return ue?be:be.join(";")};var We=function(ue){q.value!=O.options.value&&(q.value=O.options.value,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value})),typeof O.options.onchange=="function"&&O.options.onchange(q,O,ue,O.options.value)};O.setValue=function(ue){var be=O.getValue();Array.isArray(ue)&&(ue=ue.join(";")),be!==ue&&(Z(ue),We(be))},O.resetSelected=function(){O.setValue(null)},O.selectIndex=function(j,be){var j=parseInt(j);if(O.items&&O.items[j]&&(be===!0||O.items[j].data.disabled!==!0))if(O.setCursor(j,!1),!O.options.multiple)O.items[j].selected?O.options.allowEmpty!==!1&&O.setValue(null):O.setValue(Y(j)),O.close();else{var J=O.options.value;O.items[j].selected?(O.items[j].element.classList.remove("jdropdown-selected"),O.items[j].selected=!1,delete O.value[Y(j)]):(O.items[j].element.classList.add("jdropdown-selected"),O.items[j].selected=!0,O.value[Y(j)]=se(j)),O.options.value=Object.keys(O.value).join(";"),O.options.autocomplete==!1&&(O.header.value=Ae().join("; ")),We(J)}},O.selectItem=function(ue){O.selectIndex(ue.indexValue)};var tt=function(ue,be){for(var j=0;j<be.length;j++)if(O.options.format){if(be[j].id==ue)return!0}else if(be[j].value==ue)return!0;return!1};return O.find=function(ue){if(O.search==ue.trim())return!1;if(O.search=ue,O.setCursor(),O.groups.length)for(var be=0;be<O.groups.length;be++)O.groups[be].lastChild.textContent="";if(Ue.textContent="",O.options.remoteSearch==!0){O.results=null;var j=O.options.url;let Re={url:j,method:"GET",data:{q:ue},dataType:"json",success:function(xe){O.items=[];var Ye=Object.keys(O.value);if(Ye.length)for(var Ge=0;Ge<Ye.length;Ge++)tt(Ye[Ge],xe)||(O.options.format?xe.unshift({id:Ye[Ge],name:O.value[Ye[Ge]]}):xe.unshift({value:Ye[Ge],text:O.value[Ye[Ge]]}));O.appendData(xe),xe.length?Ue.style.display="":Ue.style.display="none",typeof O.options.onsearch=="function"&&O.options.onsearch(O,xe)}};if(typeof O.options.onbeforesearch=="function"){let xe=O.options.onbeforesearch(O,Re);if(xe===!1)return;typeof xe=="object"&&(Re=xe)}M(Re)}else{ue=new RegExp(ue,"gi");for(var J=[],be=0;be<O.items.length;be++){var Ce=se(be),Le=O.items[be].data.title||"",me=O.items[be].data.group||"",He=O.items[be].data.synonym||"";He&&(He=He.join(" ")),(ue==null||O.items[be].selected==!0||Ce.toString().match(ue)||Le.match(ue)||me.match(ue)||He.match(ue))&&J.push(O.items[be])}if(!J.length)Ue.style.display="none",O.results=null;else{Ue.style.display="",O.results=J;var Ze=J.length||0;O.options.lazyLoading==!0&&Ze>200&&(Ze=200);for(var be=0;be<Ze;be++)O.results[be].group?(O.results[be].group.parentNode||Ue.appendChild(O.results[be].group),O.results[be].group.lastChild.appendChild(O.results[be].element)):Ue.appendChild(O.results[be].element)}}O.options.autofocus==!0&&O.first()},O.open=function(){if(!q.classList.contains("jdropdown-focus")){V.current=O,w(O,!0),q.classList.add("jdropdown-focus"),C.getWindowWidth()<800&&(O.options.type==null||O.options.type=="picker")&&H.slideBottom(je,1),O.options.autocomplete==!0&&(O.header.value=O.search,O.header.focus());var ue=_e();if(ue[0]){var be=O.getPosition(ue[0]);be!==!1&&O.setCursor(be)}if(!O.options.type||O.options.type=="default"){var j=q.getBoundingClientRect(),J=je.getBoundingClientRect();O.options.position?(je.style.position="fixed",window.innerHeight<j.bottom+J.height?(je.style.top="",je.style.bottom=window.innerHeight-j.top+1+"px"):(je.style.top=j.bottom+"px",je.style.bottom=""),je.style.left=j.left+"px"):window.innerHeight<j.bottom+J.height?(je.style.top="",je.style.bottom=j.height+1+"px"):(je.style.top="",je.style.bottom=""),je.style.minWidth=j.width+"px",O.options.maxWidth&&(je.style.maxWidth=O.options.maxWidth),!O.items.length&&O.options.autocomplete==!0?Ue.style.display="none":Ue.style.display=""}}typeof O.options.onopen=="function"&&O.options.onopen(q)},O.close=function(ue){return q.classList.contains("jdropdown-focus")&&(O.header.value=O.getText(),O.setCursor(),!ue&&typeof O.options.onclose=="function"&&O.options.onclose(q),O.header.blur&&O.header.blur(),q.classList.remove("jdropdown-focus"),w(O,!1),V.current=null),O.getValue()},O.setCursor=function(ue,be){if(O.currentIndex!=null&&O.items&&O.items[O.currentIndex]&&O.items[O.currentIndex].element.classList.remove("jdropdown-cursor"),ue==null)O.currentIndex=null;else if(ue=parseInt(ue),O.items[ue].element.parentNode&&(O.items[ue].element.classList.add("jdropdown-cursor"),O.currentIndex=ue,be!==!1&&O.items[O.currentIndex].element)){Ue.scrollTop;var j=O.items[O.currentIndex].element;Ue.scrollTop=j.offsetTop-j.scrollTop+j.clientTop-95}},O.resetCursor=O.setCursor,O.updateCursor=O.setCursor,O.reset=function(){O.setCursor(),O.setValue(null)},O.first=function(){O.options.lazyLoading===!0&&O.loadFirst();var ue=Ue.querySelectorAll(".jdropdown-item");if(ue.length){var be=ue[0].indexValue;O.setCursor(be)}},O.last=function(){O.options.lazyLoading===!0&&O.loadLast();var ue=Ue.querySelectorAll(".jdropdown-item");if(ue.length){var be=ue[ue.length-1].indexValue;O.setCursor(be)}},O.next=function(ue){var be=null;if(ue){if(ue.length==1){var j=O.currentIndex||-1;ue=ue.toLowerCase();var J=null,Ce=null,Le=Ue.querySelectorAll(".jdropdown-item");if(Le.length){for(var me=0;me<Le.length;me++)if(Le[me].indexValue>j&&(J=O.items[Le[me].indexValue])&&(Ce=J.element.innerText[0])&&(Ce=Ce.toLowerCase(),ue==Ce)){be=Le[me].indexValue;break}O.setCursor(be)}}}else if(O.currentIndex==null||O.currentIndex==null)O.first();else{var He=O.items[O.currentIndex].element,Ze=He.nextElementSibling;Ze?(Ze.classList.contains("jdropdown-group")&&(Ze=Ze.lastChild.firstChild),be=Ze.indexValue):He.parentNode.classList.contains("jdropdown-group-items")&&((Ze=He.parentNode.parentNode.nextElementSibling)&&(Ze.classList.contains("jdropdown-group")?Ze=Ze.lastChild.firstChild:Ze.classList.contains("jdropdown-item")?be=Ze.indexValue:Ze=null),Ze&&(be=Ze.indexValue)),be!==null&&O.setCursor(be)}},O.prev=function(){var ue=null;if(O.currentIndex===null)O.first();else{var be=O.items[O.currentIndex].element,j=be.previousElementSibling;j?(j.classList.contains("jdropdown-group")&&(j=j.lastChild.lastChild),ue=j.indexValue):be.parentNode.classList.contains("jdropdown-group-items")&&((j=be.parentNode.parentNode.previousElementSibling)&&(j.classList.contains("jdropdown-group")?j=j.lastChild.lastChild:j.classList.contains("jdropdown-item")?ue=j.indexValue:j=null),j&&(ue=j.indexValue))}ue!==null&&O.setCursor(ue)},O.loadFirst=function(){if(O.results)var ue=O.results;else var ue=O.items;var be=ue.length||0;O.options.lazyLoading==!0&&be>200&&(be=200),Ue.textContent="";for(var j=0;j<be;j++)ue[j].group?(ue[j].group.parentNode||Ue.appendChild(ue[j].group),ue[j].group.lastChild.appendChild(ue[j].element)):Ue.appendChild(ue[j].element);Ue.scrollTop=0},O.loadLast=function(){if(O.results)var ue=O.results;else var ue=O.items;var be=ue.length;if(be>200){be=be-200,Ue.textContent="";for(var j=be;j<ue.length;j++)ue[j].group?(ue[j].group.parentNode||Ue.appendChild(ue[j].group),ue[j].group.lastChild.appendChild(ue[j].element)):Ue.appendChild(ue[j].element);Ue.scrollTop=Ue.scrollHeight}},O.loadUp=function(){var ue=!1;if(O.results)var be=O.results;else var be=O.items;var j=Ue.querySelectorAll(".jdropdown-item"),J=j[0].indexValue;J=O.items[J];var Ce=be.indexOf(J)-1;if(Ce>0){for(var Le=0;Ce>0&&be[Ce]&&Le<200;)be[Ce].group?(be[Ce].group.parentNode||Ue.insertBefore(be[Ce].group,Ue.firstChild),be[Ce].group.lastChild.insertBefore(be[Ce].element,be[Ce].group.lastChild.firstChild)):Ue.insertBefore(be[Ce].element,Ue.firstChild),Ce--,Le++;ue=!0}return ue},O.loadDown=function(){var ue=!1;if(O.results)var be=O.results;else var be=O.items;var j=Ue.querySelectorAll(".jdropdown-item"),J=j[j.length-1].indexValue;J=O.items[J];var Ce=be.indexOf(J)+1;if(Ce<be.length){for(var Le=0;Ce<be.length&&be[Ce]&&Le<200;)be[Ce].group?(be[Ce].group.parentNode||Ue.appendChild(be[Ce].group),be[Ce].group.lastChild.appendChild(be[Ce].element)):Ue.appendChild(be[Ce].element),Ce++,Le++;ue=!0}return ue},gt(),O});return V.keydown=function(q){var D=null;if(D=V.current){if(q.which==13||q.which==9)D.header.value&&D.currentIndex==null&&D.options.newOptions?D.add():(D.currentIndex==null&&D.options.autocomplete==!0&&D.header.value!=""&&D.find(D.header.value),D.selectIndex(D.currentIndex));else if(q.which==38)D.currentIndex==null?D.first():D.currentIndex>0&&D.prev(),q.preventDefault();else if(q.which==40)D.currentIndex==null?D.first():D.currentIndex+1<D.items.length&&D.next(),q.preventDefault();else if(q.which==36)D.first(),q.target.classList.contains("jdropdown-header")||q.preventDefault();else if(q.which==35)D.last(),q.target.classList.contains("jdropdown-header")||q.preventDefault();else if(q.which==27)D.close();else if(q.which==33){if(D.currentIndex==null)D.first();else if(D.currentIndex>0)for(var O=0;O<7;O++)D.prev();q.preventDefault()}else if(q.which==34){if(D.currentIndex==null)D.first();else if(D.currentIndex+1<D.items.length)for(var O=0;O<7;O++)D.next();q.preventDefault()}}},V.mouseup=function(q){var D=C.findElement(q.target,"jdropdown");if(D){var O=D.dropdown;if(q.target.classList.contains("jdropdown-header"))if(D.classList.contains("jdropdown-focus")&&D.classList.contains("jdropdown-default")){var re=D.getBoundingClientRect();if(q.changedTouches&&q.changedTouches[0]){var Ee=q.changedTouches[0].clientX;q.changedTouches[0].clientY}else{var Ee=q.clientX;q.clientY}re.width-(Ee-re.left)<30?q.target.classList.contains("jdropdown-add")?O.add():O.close():O.options.autocomplete==!1&&O.close()}else O.open();else if(q.target.classList.contains("jdropdown-group-name")){var we=q.target.nextSibling.children;if(q.target.nextSibling.style.display!="none")for(var Z=0;Z<we.length;Z++)we[Z].style.display!="none"&&O.selectItem(we[Z])}else q.target.classList.contains("jdropdown-group-arrow")?q.target.classList.contains("jdropdown-group-arrow-down")?(q.target.classList.remove("jdropdown-group-arrow-down"),q.target.classList.add("jdropdown-group-arrow-up"),q.target.parentNode.nextSibling.style.display="none"):(q.target.classList.remove("jdropdown-group-arrow-up"),q.target.classList.add("jdropdown-group-arrow-down"),q.target.parentNode.nextSibling.style.display=""):q.target.classList.contains("jdropdown-item")?O.selectItem(q.target):q.target.classList.contains("jdropdown-image")||q.target.classList.contains("jdropdown-description")?O.selectItem(q.target.parentNode):q.target.classList.contains("jdropdown-title")?O.selectItem(q.target.parentNode.parentNode):(q.target.classList.contains("jdropdown-close")||q.target.classList.contains("jdropdown-backdrop"))&&O.close()}},V.extractFromDom=function(q,D){var O=q;if(D||(D={}),q.getAttribute("multiple")&&(!D||D.multiple==null)&&(D.multiple=!0),q.getAttribute("placeholder")&&(!D||D.placeholder==null)&&(D.placeholder=q.getAttribute("placeholder")),q.getAttribute("data-autocomplete")&&(!D||D.autocomplete==null)&&(D.autocomplete=!0),(!D||D.width==null)&&(D.width=q.offsetWidth),q.value&&(!D||D.value==null)&&(D.value=q.value),!D||D.data==null){D.data=[];for(var re=0;re<q.children.length;re++)if(q.children[re].tagName=="OPTGROUP")for(var Ee=0;Ee<q.children[re].children.length;Ee++)D.data.push({value:q.children[re].children[Ee].value,text:q.children[re].children[Ee].textContent,group:q.children[re].getAttribute("label")});else D.data.push({value:q.children[re].value,text:q.children[re].textContent})}(!D||D.onchange==null)&&(D.onchange=function(Z,Y,se,_e){D.multiple==!0?obj.items[Y].classList.contains("jdropdown-selected")?O.options[Y].setAttribute("selected","selected"):O.options[Y].removeAttribute("selected"):O.value=_e});var we=document.createElement("div");return q.parentNode.insertBefore(we,q),q.style.display="none",q=we,{el:q,options:D}},V}var Qe=Me();function Xe(V,q){if(V.picker)return V.picker.setOptions(q,!0);var D={type:"picker"};D.options={};var O=null,re=null,Ee=function(Y){return Y instanceof Element||Y instanceof HTMLDocument},we=function(){re.innerHTML="";for(var Y=Object.keys(D.options.data),se=0;se<Y.length;se++){var _e=document.createElement("div");_e.classList.add("jpicker-item"),_e.setAttribute("role","option"),_e.k=Y[se],_e.v=D.options.data[Y[se]];var Ae=D.getLabel(Y[se],_e);Ee(Ae)?_e.appendChild(Ae):_e.innerHTML=Ae,re.appendChild(_e)}};D.setOptions=function(Y,se){var _e={value:0,data:null,render:null,onchange:null,onmouseover:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,bottom:!1,content:!1,columns:null,grid:null,height:null};Y&&Y.options&&(Y.data=Y.options);for(var Ae in _e)Y&&Y.hasOwnProperty(Ae)?D.options[Ae]=Y[Ae]:(typeof D.options[Ae]>"u"||se===!0)&&(D.options[Ae]=_e[Ae]);return D.options.header===!1?O.style.display="none":O.style.display="",D.options.width?O.style.width=parseInt(D.options.width)+"px":O.style.width="",D.options.height?(re.style.maxHeight=D.options.height+"px",re.style.overflow="scroll"):re.style.overflow="",D.options.columns>0&&(D.options.grid?(re.classList.add("jpicker-grid"),re.style.gridTemplateColumns="repeat("+D.options.grid+", 1fr)"):(re.classList.add("jpicker-columns"),re.style.width=D.options.width?D.options.width:36*D.options.columns+"px")),isNaN(parseInt(D.options.value))&&(D.options.value=0),we(),D.setValue(D.options.value),D},D.getValue=function(){return D.options.value},D.setValue=function(Y,se){if(D.setLabel(Y),D.options.value=String(Y),V.value!=D.options.value&&(V.value=D.options.value,typeof V.oninput=="function"&&V.oninput({type:"input",target:V,value:V.value})),re.children[Y]&&re.children[Y].getAttribute("type")!=="generic"&&D.close(),se&&typeof D.options.onchange=="function"){var _e=D.options.data[Y];D.options.onchange(V,D,_e,_e,Y,se)}},D.getLabel=function(Y,se){var _e=D.options.data[Y]||null;return typeof D.options.render=="function"&&(_e=D.options.render(_e,se)),_e},D.setLabel=function(Y){var se;D.options.content?(se=document.createElement("i"),se.textContent=D.options.content,se.classList.add("material-icons")):se=D.getLabel(Y,null),Ee(se)?(O.textContent="",O.appendChild(se)):O.innerHTML=se},D.open=function(){if(!V.classList.contains("jpicker-focus")){w(D,!0),V.classList.add("jpicker-focus"),V.focus();var Y=0,se=0;re.style.marginLeft="";var _e=O.getBoundingClientRect(),Ae=re.getBoundingClientRect();window.innerHeight<_e.bottom+Ae.height||D.options.bottom?Y=-1*(Ae.height+4):Y=_e.height+4,D.options.right===!0&&(se=-1*Ae.width+_e.width),Ae.left+se<0&&(se=se+Ae.left+10),Ae.left+Ae.width>window.innerWidth&&(se=-1*(10+Ae.left+Ae.width-window.innerWidth)),re.style.marginTop=parseInt(Y)+"px",re.style.marginLeft=parseInt(se)+"px",typeof D.options.onopen=="function"&&D.options.onopen(V,D)}},D.close=function(){V.classList.contains("jpicker-focus")&&(V.classList.remove("jpicker-focus"),w(D,!1),typeof D.options.onclose=="function"&&D.options.onclose(V,D))};var Z=function(){let Y=C.guid();V.classList.add("jpicker"),V.setAttribute("role","combobox"),V.setAttribute("aria-haspopup","listbox"),V.setAttribute("aria-expanded","false"),V.setAttribute("aria-controls",Y),V.setAttribute("tabindex","0"),V.onmousedown=function(se){V.classList.contains("jpicker-focus")||D.open()},O=document.createElement("div"),O.classList.add("jpicker-header"),re=document.createElement("div"),re.setAttribute("id",Y),re.setAttribute("role","listbox"),re.classList.add("jpicker-content"),re.onclick=function(se){var _e=C.findElement(se.target,"jpicker-item");_e&&_e.parentNode===re&&D.setValue(_e.k,se)},V.appendChild(O),V.appendChild(re),V.value=q.value||0,D.setOptions(q),typeof D.options.onload=="function"&&D.options.onload(V,D),V.change=D.setValue,V.val=function(se){if(se===void 0)return D.getValue();D.setValue(se)},V.picker=D};return Z(),D}function Ke(V,q){var D={type:"toolbar"};D.options={};var O={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var re in O)q&&q.hasOwnProperty(re)?D.options[re]=q[re]:D.options[re]=O[re];!V&&q.app&&q.app.el&&(V=document.createElement("div"),q.app.el.appendChild(V));var Ee=document.createElement("div");Ee.classList.add("jtoolbar-item"),Ee.classList.add("jtoolbar-arrow");var we=document.createElement("div");we.classList.add("jtoolbar-floating"),Ee.appendChild(we),D.selectItem=function(Y){for(var se=Z.children,_e=0;_e<se.length;_e++)Y!=se[_e]&&se[_e].classList.remove("jtoolbar-selected");Y.classList.add("jtoolbar-selected")},D.hide=function(){H.slideBottom(V,0,function(){V.style.display="none"})},D.show=function(){V.style.display="",H.slideBottom(V,1)},D.get=function(){return V},D.setBadge=function(Y,se){Z.children[Y].children[1].firstChild.innerHTML=se},D.destroy=function(){toolbar.remove(),V.innerHTML=""},D.update=function(Y,se){for(var _e=0;_e<Z.children.length;_e++){var Ae=Z.children[_e];typeof Ae.updateState=="function"&&Ae.updateState(V,D,Ae,Y,se)}for(var _e=0;_e<we.children.length;_e++){var Ae=we.children[_e];typeof Ae.updateState=="function"&&Ae.updateState(V,D,Ae,Y,se)}},D.create=function(Y){Z.innerHTML="";for(var se=0;se<Y.length;se++){var _e=document.createElement("div");if(_e.classList.add("jtoolbar-item"),Y[se].width&&(_e.style.width=parseInt(Y[se].width)+"px"),Y[se].k&&(_e.k=Y[se].k),Y[se].tooltip&&(_e.setAttribute("title",Y[se].tooltip),_e.setAttribute("aria-label",Y[se].tooltip)),Y[se].id&&_e.setAttribute("id",Y[se].id),Y[se].updateState&&(_e.updateState=Y[se].updateState),Y[se].active&&_e.classList.add("jtoolbar-active"),Y[se].disabled&&_e.classList.add("jtoolbar-disabled"),Y[se].type=="select"||Y[se].type=="dropdown")Xe(_e,Y[se]);else if(Y[se].type=="divisor")_e.classList.add("jtoolbar-divisor");else if(Y[se].type=="label")_e.classList.add("jtoolbar-label"),_e.innerHTML=Y[se].content;else{var Ae=document.createElement("i");if(typeof Y[se].class>"u")Ae.classList.add("material-icons");else for(var ke=Y[se].class.split(" "),je=0;je<ke.length;je++)Ae.classList.add(ke[je]);if(Ae.innerHTML=Y[se].content?Y[se].content:"",_e.setAttribute("role","button"),_e.appendChild(Ae),D.options.badge==!0){var Ue=document.createElement("div");Ue.classList.add("jbadge");var et=document.createElement("div");et.innerHTML=Y[se].badge?Y[se].badge:"",Ue.appendChild(et),_e.appendChild(Ue)}if(Y[se].title)if(D.options.title==!0){var st=document.createElement("span");st.innerHTML=Y[se].title,_e.appendChild(st)}else _e.setAttribute("title",Y[se].title);D.options.app&&Y[se].route&&(_e.route=Y[se].route,_e.onclick=function(){D.options.app.pages(this.route)},D.options.app.pages(Y[se].route,{toolbarItem:_e,closed:!0})),typeof Y[se].render=="function"&&Y[se].render(_e,Y[se])}Y[se].onclick&&(_e.onclick=Y[se].onclick.bind(Y[se],V,D,_e)),Z.appendChild(_e)}setTimeout(function(){D.refresh()},0)},D.open=function(){Ee.classList.add("jtoolbar-arrow-selected"),V.getBoundingClientRect();var Y=we.getBoundingClientRect();Y.bottom>window.innerHeight||D.options.bottom?we.style.bottom="0":we.style.removeProperty("bottom"),we.style.right="0",Ee.children[0].focus(),w(D,!0)},D.close=function(){Ee.classList.remove("jtoolbar-arrow-selected"),w(D,!1)},D.refresh=function(){if(D.options.responsive==!0){var Y=V.parentNode.getBoundingClientRect();D.options.maxWidth||(D.options.maxWidth=Y.width);var se=parseInt(D.options.maxWidth);for(Ee.parentNode&&Ee.parentNode.removeChild(Ee);we.firstChild;)Z.appendChild(we.firstChild);if(se<Z.offsetWidth)for(se-=50;Z.lastChild&&se<Z.offsetWidth;)we.insertBefore(Z.lastChild,we.firstChild);we.children.length>0&&Z.appendChild(Ee)}},D.setReadonly=function(Y){Y=Y?"add":"remove",V.classList[Y]("jtoolbar-disabled")},V.onclick=function(Y){var se=C.findElement(Y.target,"jtoolbar-item");se&&D.selectItem(se),Y.target.classList.contains("jtoolbar-arrow")&&D.open()},window.addEventListener("resize",function(){D.refresh()}),V.classList.add("jtoolbar"),V.innerHTML="",D.options.container==!0&&V.classList.add("jtoolbar-container");var Z=document.createElement("div");return V.appendChild(Z),D.options.app&&V.classList.add("jtoolbar-mobile"),D.create(D.options.items),V.toolbar=D,D}const it=["html","body","address","span","div","h1","h2","h3","h4","h5","h6","p","b","i","blockquote","strong","em","ul","ol","li","a","code","pre","hr","br","img","figure","picture","figcaption","iframe","table","thead","tbody","tfoot","tr","th","td","caption","u","del","ins","sub","sup","small","mark","input","textarea","select","option","button","label","fieldset","legend","audio","video","abbr","cite","kbd","section","article","nav","aside","header","footer","main","details","summary","svg","line","source"],te=["width","height","align","border","src","tabindex"],Pe=["color","font-weight","font-size","background","background-color","margin"],U=function(V,q){if(V.tagName&&it.indexOf(V.tagName.toLowerCase())===-1&&V.innerText&&(V.innerHTML=V.innerText),V.attributes&&V.attributes.length){let D=null,O=V.getAttribute("style");if(O){D=[];let Ee=O.split(";");for(let we=0;we<Ee.length;we++){let Z=Ee[we].trim().split(":");if(Pe.indexOf(Z[0].trim())>=0){let Y=Z.shift();Z=Z.join(":"),D.push(Y+":"+Z)}}}V.tagName.toUpperCase()==="IMG"&&(V.src?(V.setAttribute("tabindex","900"),q.push(V.src)):V.parentNode.removeChild(V));let re=[];for(let Ee=0;Ee<V.attributes.length;Ee++)re.push(V.attributes[Ee].name);re.length&&re.forEach(function(Ee){if(te.indexOf(Ee)===-1)V.removeAttribute(Ee);else{let we=V.getAttribute(Ee);we.indexOf("<")!==-1&&V.setAttribute(Ee,we.replace("<","&#60;"))}}),V.style="",D&&D.length&&V.setAttribute("style",D.join(";"))}if(V.children.length)for(let D=V.children.length;D>0;D--)U(V.children[D-1],q)};var ee=function(V,q){V&&(V=V.replace(new RegExp("<!--(.*?)-->","gsi"),""));let O=new DOMParser().parseFromString(V,"text/html");U(O,q);let re=document.createElement("div");return re.innerHTML=O.firstChild.innerHTML,re};function ce(){var V=(function(q,D){var O={type:"editor"};O.options={};var re={url:null,value:"",snippet:null,toolbar:!0,toolbarOnTop:!1,remoteParser:null,placeholder:null,filterPaste:!0,dropZone:!0,dropAsSnippet:!1,acceptImages:!0,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,extensions:null,type:null};for(var Ee in re)D&&D.hasOwnProperty(Ee)?O.options[Ee]=D[Ee]:O.options[Ee]=re[Ee];var we=null,Z=null,Y=[];O.el=q,typeof O.options.onclick=="function"&&(q.onclick=function(Re){O.options.onclick(q,O,Re)}),q.classList.add("jeditor-container");var se=document.createElement("div");se.className="jsnippet",se.setAttribute("contenteditable",!1);var _e=document.createElement("div");if(_e.className="jeditor-toolbar",O.editor=document.createElement("div"),O.editor.setAttribute("contenteditable",!0),O.editor.setAttribute("spellcheck",!1),O.editor.classList.add("jeditor"),O.options.placeholder&&O.editor.setAttribute("data-placeholder",O.options.placeholder),(O.options.maxHeight||O.options.height)&&(O.editor.style.overflowY="auto",O.options.maxHeight&&(O.editor.style.maxHeight=O.options.maxHeight),O.options.height&&(O.editor.style.height=O.options.height)),O.options.url)M({url:O.options.url,dataType:"html",success:function(Re){O.editor.innerHTML=Re,V.setCursor(O.editor,O.options.focus=="initial")}});else if(O.options.value)O.editor.innerHTML=O.options.value;else for(var Ae=0;Ae<q.children.length;Ae++)O.editor.appendChild(q.children[Ae]);q.innerHTML="";var ke=function(Re){typeof O.options.onchange=="function"&&O.options.onchange(q,O,Re),O.options.value=O.getData(),q.value!=O.options.value&&(q.value=O.options.value,typeof q.oninput=="function"&&q.oninput({type:"input",target:q,value:q.value}))},je=function(Re){let xe=[];if(document.createElement("div"),ee(Re,xe),xe.length)for(var Ye=0;Ye<xe.length;Ye++)O.addImage(xe[Ye])},Ue=function(){var Re=null;if(Re=se.children[0]){Re.classList.contains("jslider-grid")||Re.classList.add("jslider-grid");var xe=Re.children.length;Re.setAttribute("data-number",xe>4?4:xe),xe>4?Re.setAttribute("data-total",xe-4):Re.removeAttribute("data-total")}},et=function(Re){se.innerHTML||O.appendSnippet({}),se.children[0].appendChild(Re),Ue()};O.appendSnippet=function(Re){se.innerHTML="";for(var xe=["image","title","description","host","url"],Ye=0;Ye<xe.length;Ye++){var Ge=document.createElement("div");if(Ge.className="jsnippet-"+xe[Ye],Ge.setAttribute("data-k",xe[Ye]),se.appendChild(Ge),Re[xe[Ye]])if(xe[Ye]=="image"){Array.isArray(Re.image)||(Re.image=[Re.image]);for(var Te=0;Te<Re.image.length;Te++){var ze=document.createElement("img");ze.src=Re.image[Te],Ge.appendChild(ze)}}else Ge.innerHTML=Re[xe[Ye]]}O.editor.appendChild(document.createElement("br")),O.editor.appendChild(se)},O.setData=function(Re){typeof Re=="object"?O.editor.innerHTML=Re.content:O.editor.innerHTML=Re,O.options.focus&&V.setCursor(O.editor,!0),Y=[]},O.getFiles=function(){for(var Re=O.editor.querySelectorAll(".jfile"),xe=[],Ye=0;Ye<Re.length;Ye++)Y[Re[Ye].src]&&xe.push(Y[Re[Ye].src]);return xe},O.getText=function(){return O.editor.innerText},O.getData=function(Re){if(Re){var xe={content:""};if(se.innerHTML){xe.snippet={};for(var Ye=0;Ye<se.children.length;Ye++){var Ge=se.children[Ye].getAttribute("data-k");if(Ge)if(Ge=="image"){xe.snippet.image||(xe.snippet.image=[]);for(var Te=0;Te<se.children[Ye].children.length;Te++)xe.snippet.image.push(se.children[Ye].children[Te].getAttribute("src"))}else xe.snippet[Ge]=se.children[Ye].innerHTML}}var ze=Object.keys(Y);if(ze.length){xe.files=[];for(var Ye=0;Ye<ze.length;Ye++)xe.files.push(Y[ze[Ye]])}var nt=document.createElement("div");nt.innerHTML=O.editor.innerHTML;var ut=nt.querySelector(".jsnippet");ut&&ut.remove();var _t=nt.innerHTML;_t=_t.replace(/<br>/g,`
`),_t=_t.replace(/<\/div>/g,`</div>
`),_t=_t.replace(/<(?:.|\n)*?>/gm,""),xe.content=_t.trim(),me("getData",xe)}else var xe=O.editor.innerHTML;return xe},O.reset=function(){O.editor.innerHTML="",se.innerHTML="",Y=[]},O.addPdf=function(Re){if(Re.result.substr(0,4)!="data")console.error("Invalid source");else{var xe=document.createElement("canvas");xe.width=60,xe.height=60;var Ye=new Image,Ge=xe.getContext("2d");Ge.drawImage(Ye,0,0,xe.width,xe.height),xe.toBlob(function(Te){var ze=document.createElement("img");ze.src=window.URL.createObjectURL(Te),ze.title=Re.name,ze.className="jfile pdf",Y[ze.src]={file:ze.src,extension:"pdf",content:Re.result},document.execCommand("insertHtml",!1,ze.outerHTML)})}},O.addImage=function(Re,xe){if(O.options.acceptImages)if(Re||(Re=""),Re.substr(0,4)!="data"&&!O.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(Re.substr(0,4)=="data"){var Ye=Re.split(";");Ye=Ye[0].split("/"),Ye=Ye[1]}else{var Ye=Re.substr(Re.lastIndexOf(".")+1);Re=O.options.remoteParser+Re}var Ge=new Image;Ge.onload=function(){var ze=document.createElement("canvas");ze.width=Ge.width,ze.height=Ge.height;var nt=ze.getContext("2d");nt.drawImage(Ge,0,0,ze.width,ze.height),ze.toBlob(function(ut){var _t=document.createElement("img");_t.src=window.URL.createObjectURL(ut),_t.classList.add("jfile"),_t.setAttribute("tabindex","900"),_t.setAttribute("width",Ge.width),_t.setAttribute("height",Ge.height),Y[_t.src]={file:_t.src,extension:Ye,content:ze.toDataURL()},O.options.dropAsSnippet||xe?(et(_t),Y[_t.src].snippet=!0):document.execCommand("insertHtml",!1,_t.outerHTML),ke()})},Ge.src=Re}},O.addFile=function(Re){for(var xe=[],Ye=0;Ye<Re.length;Ye++)if(Re[Ye].size>O.options.maxFileSize)alert("The file is too big");else{var Ge=Re[Ye].type.split("/");Ge[0]=="image"?Ge=1:Ge[1]=="pdf"?Ge=2:Ge=0,Ge?(xe[Ye]=new FileReader,xe[Ye].index=Ye,xe[Ye].type=Ge,xe[Ye].name=Re[Ye].name,xe[Ye].date=Re[Ye].lastModified,xe[Ye].size=Re[Ye].size,xe[Ye].addEventListener("load",function(Te){Te.target.type==2?O.options.acceptFiles==!0&&O.addPdf(Te.target):O.addImage(Te.target.result)},!1),xe[Ye].readAsDataURL(Re[Ye])):alert("The extension is not allowed")}},O.destroy=function(){O.editor.removeEventListener("mouseup",J),O.editor.removeEventListener("mousedown",Ce),O.editor.removeEventListener("mousemove",Le),O.editor.removeEventListener("keyup",be),O.editor.removeEventListener("keydown",j),O.editor.removeEventListener("dragstart",ft),O.editor.removeEventListener("dragenter",gt),O.editor.removeEventListener("dragover",Ie),O.editor.removeEventListener("drop",We),O.editor.removeEventListener("paste",at),O.editor.removeEventListener("blur",tt),O.editor.removeEventListener("focus",ue),q.editor=null,q.classList.remove("jeditor-container"),_e.remove(),se.remove(),O.editor.remove()},O.upload=function(){C.click(O.file)};var st=function(Re){var xe=window.getSelection(),Ye=document.createRange();Ye.selectNode(Re),xe.addRange(Ye)},at=function(Re){if(O.options.filterPaste==!0){if(Re.clipboardData||Re.originalEvent.clipboardData)var xe=(Re.originalEvent||Re).clipboardData.getData("text/html"),Ye=(Re.originalEvent||Re).clipboardData.getData("text/plain"),Ge=(Re.originalEvent||Re).clipboardData.files;else if(window.clipboardData)var xe=window.clipboardData.getData("Html"),Ye=window.clipboardData.getData("Text"),Ge=window.clipboardData.files;if(Ge.length)O.addFile(Ge);else if(!xe)xe=Ye.split(`\r
`),Re.target.innerText?(xe=xe.map(function(nt){return"<div>"+nt+"</div>"}),document.execCommand("insertText",!1,xe.join(""))):xe.map(function(nt){var ut=document.createElement("div");ut.innerText=nt,O.editor.appendChild(ut)});else{let nt=[];var Te=ee(xe,nt);if(nt.length)for(var ze=0;ze<nt.length;ze++)O.addImage(nt[ze]);document.execCommand("insertHtml",!1,Te.innerHTML)}Re.preventDefault()}},ft=function(Re){Z&&Z.e&&Re.preventDefault()},gt=function(Re){Z||O.options.dropZone==!1||(q.classList.add("jeditor-dragging"),Re.preventDefault())},Ie=function(Re){Z||O.options.dropZone==!1||(we&&clearTimeout(we),we=setTimeout(function(){q.classList.remove("jeditor-dragging")},100),Re.preventDefault())},We=function(Re){if(!(Z||O.options.dropZone===!1)){let xe=null;document.caretRangeFromPoint?xe=document.caretRangeFromPoint(Re.clientX,Re.clientY):Re.rangeParent&&(xe=document.createRange(),xe.setStart(Re.rangeParent,Re.rangeOffset));let Ye=window.getSelection();Ye.removeAllRanges(),Ye.addRange(xe),Ye.anchorNode.parentNode.focus();let Ge=(Re.originalEvent||Re).dataTransfer.getData("text/html"),Te=(Re.originalEvent||Re).dataTransfer.getData("text/plain"),ze=(Re.originalEvent||Re).dataTransfer.files;ze.length?O.addFile(ze):Te&&je(Ge),q.classList.remove("jeditor-dragging"),Re.preventDefault()}},tt=function(Re){me("onevent",Re),ke(Re),typeof O.options.onblur=="function"&&O.options.onblur(q,O,Re)},ue=function(Re){typeof O.options.onfocus=="function"&&O.options.onfocus(q,O,Re)},be=function(Re){O.editor.innerHTML||(O.editor.innerHTML="<div><br></div>"),typeof O.options.onkeyup=="function"&&O.options.onkeyup(q,O,Re)},j=function(Re){if(me("onevent",Re),Re.key=="Delete"&&Re.target.tagName=="IMG"){var xe=Re.target.parentNode;st(Re.target),xe.classList.contains("jsnippet-image")&&Ue()}typeof O.options.onkeydown=="function"&&O.options.onkeydown(q,O,Re)},J=function(Re){if(Z&&Z.e&&(Z.e.classList.remove("resizing"),Z.e.changed==!0)){var xe=Z.e.cloneNode();xe.width=parseInt(Z.e.style.width)||Z.e.getAttribute("width"),xe.height=parseInt(Z.e.style.height)||Z.e.getAttribute("height"),Z.e.style.width="",Z.e.style.height="",st(Z.e),document.execCommand("insertHtml",!1,xe.outerHTML)}Z=!1},Ce=function(Re){var xe=function(ze){var nt=ze.getBoundingClientRect();nt.width-(Re.clientX-nt.left)<40&&Re.clientY-nt.top<40&&(ze.innerHTML="",ze.remove())};if(Re.target.tagName=="IMG")if(Re.target.style.cursor){var Ye=Re.target.getBoundingClientRect();Z={e:Re.target,x:Re.clientX,y:Re.clientY,w:Ye.width,h:Ye.height,d:Re.target.style.cursor},Re.target.getAttribute("width")||Re.target.setAttribute("width",Ye.width),Re.target.getAttribute("height")||Re.target.setAttribute("height",Ye.height);var Ge=window.getSelection();if(Ge.rangeCount)for(var Te=0;Te<Ge.rangeCount;Te++)Ge.removeRange(Ge.getRangeAt(Te));Re.target.classList.add("resizing")}else Z=!0;else Re.target.classList.contains("jsnippet")?xe(Re.target):Re.target.parentNode.classList.contains("jsnippet")&&xe(Re.target.parentNode),Z=!0},Le=function(Re){if(Re.target.tagName=="IMG"&&!Re.target.parentNode.classList.contains("jsnippet-image")&&O.options.allowImageResize==!0&&Re.target.getAttribute("tabindex")){var xe=Re.target.getBoundingClientRect();Re.clientY-xe.top<5?xe.width-(Re.clientX-xe.left)<5?Re.target.style.cursor="ne-resize":Re.clientX-xe.left<5?Re.target.style.cursor="nw-resize":Re.target.style.cursor="n-resize":xe.height-(Re.clientY-xe.top)<5?xe.width-(Re.clientX-xe.left)<5?Re.target.style.cursor="se-resize":Re.clientX-xe.left<5?Re.target.style.cursor="sw-resize":Re.target.style.cursor="s-resize":xe.width-(Re.clientX-xe.left)<5?Re.target.style.cursor="e-resize":Re.clientX-xe.left<5?Re.target.style.cursor="w-resize":Re.target.style.cursor=""}if(Re.which==1&&Z&&Z.d){if(Z.d=="e-resize"||Z.d=="ne-resize"||Z.d=="se-resize")if(Z.e.style.width=Z.w+(Re.clientX-Z.x),Re.shiftKey){var Ye=(Re.clientX-Z.x)*(Z.h/Z.w);Z.e.style.height=Z.h+Ye}else var Ye=null;Ye||(Z.d=="s-resize"||Z.d=="se-resize"||Z.d=="sw-resize")&&(Re.shiftKey||(Z.e.style.height=Z.h+(Re.clientY-Z.y))),Z.e.changed=!0}},me=function(Re,xe){if(O.options.extensions){var Ye=Object.keys(O.options.extensions);if(Ye.length)for(var Ge=0;Ge<Ye.length;Ge++)O.options.extensions[Ye[Ge]]&&typeof O.options.extensions[Ye[Ge]][Re]=="function"&&O.options.extensions[Ye[Ge]][Re].call(O,xe)}},He=function(){if(O.options.extensions){var Re=Object.keys(O.options.extensions);if(Re.length)for(var xe=0;xe<Re.length;xe++)O.options.extensions[Re[xe]]&&typeof O.options.extensions[Re[xe]]=="function"&&(O.options.extensions[Re[xe]]=O.options.extensions[Re[xe]](q,O))}};if(document.addEventListener("mouseup",J),document.addEventListener("mousemove",Le),O.editor.addEventListener("mousedown",Ce),O.editor.addEventListener("keyup",be),O.editor.addEventListener("keydown",j),O.editor.addEventListener("dragstart",ft),O.editor.addEventListener("dragenter",gt),O.editor.addEventListener("dragover",Ie),O.editor.addEventListener("drop",We),O.editor.addEventListener("paste",at),O.editor.addEventListener("focus",ue),O.editor.addEventListener("blur",tt),q.appendChild(O.editor),O.options.snippet&&O.appendSnippet(O.options.snippet),O.options.toolbar){if(Array.isArray(O.options.toolbar))var Ze={container:!0,responsive:!0,items:O.options.toolbar};else if(O.options.toolbar===!0)var Ze={container:!0,responsive:!0,items:[]};else var Ze=O.options.toolbar;Ze.items&&Ze.items.length||(Ze.items=V.getDefaultToolbar(O)),O.options.toolbarOnTop?(q.classList.add("toolbar-on-top"),q.insertBefore(_e,q.firstChild)):(O.editor.style.padding="15px",q.appendChild(_e)),Ke(_e,Ze),_e.addEventListener("click",function(){O.editor.focus()})}return O.file=document.createElement("input"),O.file.style.display="none",O.file.type="file",O.file.setAttribute("accept","image/*"),O.file.onchange=function(){O.addFile(this.files)},q.appendChild(O.file),O.options.focus&&V.setCursor(O.editor,O.options.focus=="initial"),q.change=O.setData,q.val=function(Re){if(Re===void 0){var xe=q.getAttribute("data-html")!=="true";return O.getData(xe)}else O.setData(Re)},He(),q.editor=O,typeof O.options.onload=="function"&&O.options.onload(q,O,O.editor),O});return V.setCursor=function(q,D){q.focus(),document.execCommand("selectAll");var O=window.getSelection(),re=O.getRangeAt(0);if(D==!0)var Ee=re.startContainer,we=0;else var Ee=re.endContainer,we=Ee.length;re.setStart(Ee,we),re.setEnd(Ee,we),O.removeAllRanges(),O.addRange(re)},V.getDefaultToolbar=function(q){var D=function(re,Ee,we){we.color||(ye(we,{onchange:function(Z,Y){we.k==="color"?document.execCommand("foreColor",!1,Y):document.execCommand("backColor",!1,Y)}}),we.color.open())},O=[];return O.push({content:"undo",onclick:function(){document.execCommand("undo")}}),O.push({content:"redo",onclick:function(){document.execCommand("redo")}}),O.push({type:"divisor"}),q.options.toolbarOnTop&&(O.push({type:"select",width:"140px",options:["Default","Verdana","Arial","Courier New"],render:function(re){return'<span style="font-family:'+re+'">'+re+"</span>"},onchange:function(re,Ee,we,Z,Y){document.execCommand("fontName",!1,Z)}}),O.push({type:"select",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(re){return'<span style="font-size:'+re+'">'+re+"</span>"},onchange:function(re,Ee,we,Z,Y){document.execCommand("fontSize",!1,parseInt(Y)+1)}}),O.push({type:"select",options:["format_align_left","format_align_center","format_align_right","format_align_justify"],render:function(re){return'<i class="material-icons">'+re+"</i>"},onchange:function(re,Ee,we,Z,Y){var se=["JustifyLeft","justifyCenter","justifyRight","justifyFull"];document.execCommand(se[Y])}}),O.push({type:"divisor"}),O.push({content:"format_color_text",k:"color",onclick:D}),O.push({content:"format_color_fill",k:"background-color",onclick:D})),O.push({content:"format_bold",onclick:function(re,Ee,we){document.execCommand("bold"),document.queryCommandState("bold")?we.classList.add("selected"):we.classList.remove("selected")}}),O.push({content:"format_italic",onclick:function(re,Ee,we){document.execCommand("italic"),document.queryCommandState("italic")?we.classList.add("selected"):we.classList.remove("selected")}}),O.push({content:"format_underline",onclick:function(re,Ee,we){document.execCommand("underline"),document.queryCommandState("underline")?we.classList.add("selected"):we.classList.remove("selected")}}),O.push({type:"divisor"}),O.push({content:"format_list_bulleted",onclick:function(re,Ee,we){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?we.classList.add("selected"):we.classList.remove("selected")}}),O.push({content:"format_list_numbered",onclick:function(re,Ee,we){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?we.classList.add("selected"):we.classList.remove("selected")}}),O.push({content:"format_indent_increase",onclick:function(re,Ee,we){document.execCommand("indent",!0,null),document.queryCommandState("indent")?we.classList.add("selected"):we.classList.remove("selected")}}),O.push({content:"format_indent_decrease",onclick:function(re,Ee,we){document.execCommand("outdent"),document.queryCommandState("outdent")?we.classList.add("selected"):we.classList.remove("selected")}}),q.options.toolbarOnTop&&(O.push({type:"divisor"}),O.push({content:"photo",onclick:function(){q.upload()}}),O.push({type:"select",content:"table_view",columns:8,grid:8,right:!0,options:["0x0","1x0","2x0","3x0","4x0","5x0","6x0","7x0","0x1","1x1","2x1","3x1","4x1","5x1","6x1","7x1","0x2","1x2","2x2","3x2","4x2","5x2","6x2","7x2","0x3","1x3","2x3","3x3","4x3","5x3","6x3","7x3","0x4","1x4","2x4","3x4","4x4","5x4","6x4","7x4","0x5","1x5","2x5","3x5","4x5","5x5","6x5","7x5","0x6","1x6","2x6","3x6","4x6","5x6","6x6","7x6","0x7","1x7","2x7","3x7","4x7","5x7","6x7","7x7"],render:function(re,Ee){Ee&&(Ee.onmouseover=this.onmouseover,re=re.split("x"),Ee.setAttribute("data-x",re[0]),Ee.setAttribute("data-y",re[1]));var we=document.createElement("div");return Ee.style.margin="1px",Ee.style.border="1px solid #ddd",we},onmouseover:function(re){for(var Ee=parseInt(re.target.getAttribute("data-x")),we=parseInt(re.target.getAttribute("data-y")),Z=0;Z<re.target.parentNode.children.length;Z++){var Y=re.target.parentNode.children[Z],se=parseInt(Y.getAttribute("data-x")),_e=parseInt(Y.getAttribute("data-y"));se<=Ee&&_e<=we?(Y.style.backgroundColor="#cae1fc",Y.style.borderColor="#2977ff"):(Y.style.backgroundColor="",Y.style.borderColor="#ddd")}},onchange:function(re,Ee,we){we=we.split("x");for(var Z=document.createElement("table"),Y=document.createElement("tbody"),se=0;se<=we[1];se++){for(var _e=document.createElement("tr"),Ae=0;Ae<=we[0];Ae++){var ke=document.createElement("td");ke.innerHTML="",_e.appendChild(ke)}Y.appendChild(_e)}Z.appendChild(Y),Z.setAttribute("width","100%"),Z.setAttribute("cellpadding","6"),Z.setAttribute("cellspacing","0"),document.execCommand("insertHTML",!1,Z.outerHTML)}})),O},V}var ve=ce();function K(){var V=(function(q,D){var O={};O.options={};var re={type:"big",title:"Untitled",width:510,height:472};for(var Ee in re)D&&D.hasOwnProperty(Ee)?O.options[Ee]=D[Ee]:O.options[Ee]=re[Ee];var we=function(){for(var se=document.createElement("div");q.children[0];)se.appendChild(q.children[0]);for(O.content=document.createElement("div"),O.content.className="jfloating_content",O.content.innerHTML=q.innerHTML;se.children[0];)O.content.appendChild(se.children[0]);O.container=document.createElement("div"),O.container.className="jfloating",O.container.appendChild(O.content),O.options.title?O.container.setAttribute("title",O.options.title):O.container.classList.add("no-title"),O.options.width&&(O.container.style.width=parseInt(O.options.width)+"px"),O.options.height&&(O.container.style.height=parseInt(O.options.height)+"px"),q.innerHTML="",q.appendChild(O.container)},Z=function(){O.container&&O.container.addEventListener("click",function(se){var _e=se.target.getBoundingClientRect();if(se.target.classList.contains("jfloating")){if(se.changedTouches&&se.changedTouches[0])var Ae=se.changedTouches[0].clientX,ke=se.changedTouches[0].clientY;else var Ae=se.clientX,ke=se.clientY;_e.width-(Ae-_e.left)<50&&ke-_e.top<50?setTimeout(function(){O.close()},100):O.setState()}})},Y=function(){O.container.classList.add("jfloating-"+O.options.type)};return O.state={isMinized:!1},O.setState=function(){O.state.isMinized?O.container.classList.remove("jfloating-minimized"):O.container.classList.add("jfloating-minimized"),O.state.isMinized=!O.state.isMinized},O.close=function(){Components.elements.splice(V.elements.indexOf(O.container),1),O.updatePosition(),q.remove()},O.updatePosition=function(){for(var se=0;se<V.elements.length;se++){var _e=V.elements[se],Ae=V.elements[se-1];_e.style.right=se*(Ae?Ae.offsetWidth:_e.offsetWidth)*1.01+"px"}},O.init=function(){we(),Z(),Y(),V.elements.push(O.container),O.updatePosition(),q.floating=O},O.init(),O});return V.elements=[],V}var ne=K();function de(){const V=function(Z){return!isNaN(Z)&&Z!==null&&(typeof Z!="string"||Z.trim()!=="")},q={between:function(Z,Y){return Z>=Y[0]&&Z<=Y[1]},"not between":function(Z,Y){return Z<Y[0]||Z>Y[1]},"<":function(Z,Y){return Z<Y[0]},"<=":function(Z,Y){return Z<=Y[0]},">":function(Z,Y){return Z>Y[0]},">=":function(Z,Y){return Z>=Y[0]},"=":function(Z,Y){return Z==Y[0]},"!=":function(Z,Y){return Z!=Y[0]}},D={"valid date":function(){return!0},"=":function(Z,Y){return Z===Y[0]},"!=":function(Z,Y){return Z!==Y[0]},"<":function(Z,Y){return Z<Y[0]},"<=":function(Z,Y){return Z<=Y[0]},">":function(Z,Y){return Z>Y[0]},">=":function(Z,Y){return Z>=Y[0]},between:function(Z,Y){return Z>=Y[0]&&Z<=Y[1]},"not between":function(Z,Y){return Z<Y[0]||Z>Y[1]}},O={contains:function(Z,Y){return Z.includes(Y[0])},"not contains":function(Z,Y){return!Z.includes(Y[0])},"begins with":function(Z,Y){return Z.startsWith(Y[0])},"ends with":function(Z,Y){return Z.endsWith(Y[0])},"=":function(Z,Y){return Z===Y[0]},"!=":function(Z,Y){return Z!==Y[0]},"valid email":function(Z){var Y=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return Y.test(Z)},"valid url":function(Z){var Y=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return Y.test(Z)}},re=function(Z,Y){return typeof re[Y.type]=="function"?Y.allowBlank&&(typeof Z>"u"||Z===""||Z===null)?!0:re[Y.type].call(this,Z,Y):null};re.url=function(Z){var Y=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!Y.test(Z)},re.email=function(Z){var Y=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(Z&&Y.test(Z))},re.required=function(Z){return!!(Z&&Z.trim())},re.empty=function(Z){return typeof Z>"u"||Z===null||typeof Z=="string"&&!Z.toString().trim()},re["not exist"]=re.empty,re.notEmpty=function(Z){return!re.empty(Z)},re.exist=re.notEmpty,re.number=function(Z,Y){if(!V(Z))return!1;if(!Y||!Y.criteria)return!0;if(!q[Y.criteria])return!1;let se=Y.value.map(function(_e){return parseFloat(_e)});return q[Y.criteria](Z,se)},re.login=function(Z){let Y=new RegExp(/^[a-zA-Z0-9._-]+$/);return!!(Z&&Y.test(Z))},re.list=function(Z,Y){let se=typeof Z;if(se!=="string"&&se!=="number")return!1;let _e;return typeof Y.value[0]=="string"?Y.source?_e=Y.source:_e=Y.value[0].split(","):_e=Y.value[0],Array.isArray(_e)?_e.findIndex(function(ke){return ke==Z})>-1:!1};const Ee=function(){let Z=new Date;return Z.setHours(0,0,0,0),Z},we={"one year ago":function(){let Z=Ee();return Z.setFullYear(Z.getFullYear()-1),Z},"one month ago":function(){let Z=Ee();return Z.setMonth(Z.getMonth()-1),Z},"one week ago":function(){let Z=Ee();return Z.setDate(Z.getDate()-7),Z},yesterday:function(){let Z=Ee();return Z.setDate(Z.getDate()-1),Z},today:Ee,tomorrow:function(){let Z=Ee();return Z.setDate(Z.getDate()+1),Z}};return re.date=function(Z,Y){if(V(Z)&&Z>0&&Z<1e6&&(Z=A.numToDate(Z)),new Date(Z)=="Invalid Date")return!1;if(!Y||!Y.criteria)return!0;if(!D[Y.criteria])return!1;let se=Y.value.map(function(_e){return typeof _e=="string"&&we[_e]?we[_e]().getTime():new Date(_e).getTime()});return D[Y.criteria](new Date(Z).getTime(),se)},re.text=function(Z,Y){if(typeof Z>"u"||Z===null)Z="";else if(typeof Z!="string")return!1;return!Y||!Y.criteria?!0:O[Y.criteria]?O[Y.criteria](Z,Y.value):!1},re.textLength=function(Z,Y){let se;return typeof Z=="string"?se=Z.length:typeof Z<"u"&&Z!==null&&typeof Z.toString=="function"?se=Z.toString().length:se=0,re.number(se,Y)},re.time=function(Z,Y){if(!V(Z))return!1;if(!Y||!Y.criteria)return!0;if(!q[Y.criteria])return!1;let se=Y.value.map(function(_e){return parseInt(parseFloat(_e)*10**17)/10**17});return q[Y.criteria](parseInt(parseFloat(Z)*10**17)/10**17,se)},re}var Oe=de();function Se(){var V=(function(q,D){var O={};O.options={};var re={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(Y,se){alert(se)}};for(var Ee in re)D&&D.hasOwnProperty(Ee)?O.options[Ee]=D[Ee]:O.options[Ee]=re[Ee];O.options.validations||(O.options.validations={}),O.options.submitButton||(O.options.submitButton=q.querySelector("input[type=submit]")),O.options.submitButton&&O.options.url&&(O.options.submitButton.onclick=function(){O.save()}),O.options.validations.email||(O.options.validations.email=Oe.email),O.options.validations.length||(O.options.validations.length=Oe.length),O.options.validations.required||(O.options.validations.required=Oe.required),O.setUrl=function(Y){O.options.url=Y},O.load=function(){M({url:O.options.url,method:"GET",dataType:"json",queue:!0,success:function(Y){if(typeof O.options.onbeforeload=="function"){var se=O.options.onbeforeload(q,Y);se&&(Y=se)}V.setElements(q,Y),typeof O.options.onload=="function"&&O.options.onload(q,Y)}})},O.save=function(){var Y=O.validate();if(Y)O.options.onerror(q,Y);else{var se=V.getElements(q,!0);if(typeof O.options.onbeforesave=="function"){var se=O.options.onbeforesave(q,se);if(se===!1)return}M({url:O.options.url,method:"POST",dataType:"json",data:se,success:function(_e){typeof O.options.onsave=="function"&&O.options.onsave(q,se,_e)}})}},O.remove=function(){if(typeof O.options.onbeforeremove=="function"){var Y=O.options.onbeforeremove(q,O);if(Y===!1)return!1}M({url:O.options.url,method:"DELETE",dataType:"json",success:function(se){typeof O.options.onremove=="function"&&O.options.onremove(q,O,se),O.reset()}})};var we=function(Y){Y.classList.add("error"),O.options.submitButton&&O.options.submitButton.setAttribute("disabled",!0);var se=Y.getAttribute("data-error")||"There is an error in the form";return Y.setAttribute("title",se),se},Z=function(Y){var se=!1;Y.classList.remove("error"),Y.removeAttribute("title");for(var _e=q.querySelectorAll("input, select, textarea, div[name]"),Ae=0;Ae<_e.length;Ae++)_e[Ae].getAttribute("data-validation")&&_e[Ae].classList.contains("error")&&(se=!0);O.options.submitButton&&(se?O.options.submitButton.setAttribute("disabled",!0):O.options.submitButton.removeAttribute("disabled"))};return O.validateElement=function(Y){var se=!1,_e=V.getValue(Y),Ae=Y.getAttribute("data-validation");return typeof O.options.validations[Ae]=="function"&&!O.options.validations[Ae](_e,Y)?se=we(Y):Y.classList.contains("error")&&Z(Y),se},O.reset=function(){for(var Y=q.querySelectorAll("input, select, textarea, div[name]"),se=0;se<Y.length;se++)Y[se].getAttribute("name")&&(Y[se].type=="checkbox"||Y[se].type=="radio"?Y[se].checked=!1:typeof Y[se].val=="function"?Y[se].val(""):Y[se].value="")},O.validate=function(){for(var Y=[],se=q.querySelectorAll("input, select, textarea, div[name]"),_e=0;_e<se.length;_e++)if(se[_e].getAttribute("data-validation")){var Ae=O.validateElement(se[_e]);Ae&&Y.push(Ae)}return Y.length>0?Y.join("<br>"):!1},O.getError=function(){return!!O.validation()},O.setHash=function(){return O.getHash(V.getElements(q))},O.getHash=function(Y){var se=0,_e,Ae;if(Y.length===0)return se;for(_e=0;_e<Y.length;_e++)Ae=Y.charCodeAt(_e),se=(se<<5)-se+Ae,se|=0;return se},O.isChanged=function(){var Y=O.setHash();return O.options.currentHash!=Y},O.resetTracker=function(){O.options.currentHash=O.setHash(),O.options.ignore=!1},O.setIgnore=function(Y){O.options.ignore=!!Y},setTimeout(function(){O.options.currentHash=O.setHash()},1e3),q.addEventListener("keyup",function(Y){Y.target.getAttribute("data-validation")&&O.validateElement(Y.target)}),V.hasEvents||(window.addEventListener("beforeunload",function(Y){if(O.isChanged()&&O.options.ignore==!1){var se=O.options.message?O.options.message:"o/";return se?(typeof Y>"u"&&(Y=window.event),Y&&(Y.returnValue=se),se):void 0}}),V.hasEvents=!0),q.form=O,O});return V.getValue=function(q){var D=null;if(q.type=="checkbox")q.checked==!0&&(D=q.value||!0);else if(q.type=="radio")q.checked==!0&&(D=q.value);else if(q.type=="file")D=q.files;else if(q.tagName=="select"&&q.multiple==!0){D=[];for(var O=q.querySelectorAll("options[selected]"),re=0;re<O.length;re++)D.push(O[re].value)}else typeof q.val=="function"?D=q.val():D=q.value||"";return D},V.getElements=function(q,D){for(var O={},re=null,Ee=q.querySelectorAll("input, select, textarea, div[name]"),we=0;we<Ee.length;we++)(re=Ee[we].getAttribute("name"))&&(O[re]=V.getValue(Ee[we])||"");return D==!0?O:JSON.stringify(O)},V.setElements=function(q,D){for(var O=null,re=null,Ee=q.querySelectorAll("input, select, textarea, div[name]"),we=0;we<Ee.length;we++){var Z=Ee[we].getAttribute("type");if(O=Ee[we].getAttribute("name")){if(O=O.replace(new RegExp(/\[(.*?)\]/ig),".$1"),re=null,O.match(/\./)){var Y=P.call(D,O)||"";typeof Y<"u"&&(re=Y)}else typeof D[O]<"u"&&(re=D[O]);re!==null&&(Z=="checkbox"||Z=="radio"?Ee[we].checked=!!re:Z=="file"||(typeof Ee[we].val=="function"?Ee[we].val(re):Ee[we].value=re))}}},V}var ge=Se();function De(){var V=function(){var D=null,O=function(Z){if(Z.which==27)for(var Y=document.querySelectorAll(".jmodal"),se=0;se<Y.length;se++)Y[se].parentNode.modal.close()},re=function(Z){let Y=Z.composedPath();var se=C.findElement(Y[0],"jmodal");if(se){var _e=se.getBoundingClientRect();if(Z.changedTouches&&Z.changedTouches[0])var Ae=Z.changedTouches[0].clientX,ke=Z.changedTouches[0].clientY;else var Ae=Z.clientX,ke=Z.clientY;_e.width-(Ae-_e.left)<50&&ke-_e.top<50&&se.parentNode.modal.close()}D&&(D.element.style.cursor="auto",D=null)},Ee=function(Z){let Y=Z.composedPath();var se=C.findElement(Y[0],"jmodal");if(se){var _e=se.getBoundingClientRect();if(Z.changedTouches&&Z.changedTouches[0])var Ae=Z.changedTouches[0].clientX,ke=Z.changedTouches[0].clientY;else var Ae=Z.clientX,ke=Z.clientY;_e.width-(Ae-_e.left)<50&&ke-_e.top<50||ke-_e.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),D={left:_e.left,top:_e.top,x:Z.clientX,y:Z.clientY,width:_e.width,height:_e.height,element:se})}},we=function(Z){if(D){if(Z=Z||window.event,Z.buttons)var Y=Z.buttons;else if(Z.button)var Y=Z.button;else var Y=Z.which;Y?(D.element.style.top=D.top+(Z.clientY-D.y)+D.height/2+"px",D.element.style.left=D.left+(Z.clientX-D.x)+D.width/2+"px",D.element.style.cursor="move"):D.element.style.cursor="auto"}};document.addEventListener("keydown",O),document.addEventListener("mouseup",re),document.addEventListener("mousedown",Ee),document.addEventListener("mousemove",we)},q=(function(D,O){var re={};re.options={};var Ee={url:null,onopen:null,onclose:null,onload:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0,icon:null};for(var we in Ee)O&&O.hasOwnProperty(we)?re.options[we]=O[we]:re.options[we]=Ee[we];!re.options.title&&D.getAttribute("title")&&(re.options.title=D.getAttribute("title"));for(var Z=document.createElement("div");D.children[0];)Z.appendChild(D.children[0]);for(re.title=document.createElement("div"),re.title.className="jmodal_title",re.options.icon&&re.title.setAttribute("data-icon",re.options.icon),re.content=document.createElement("div"),re.content.className="jmodal_content",re.content.innerHTML=D.innerHTML;Z.children[0];)re.content.appendChild(Z.children[0]);if(re.container=document.createElement("div"),re.container.className="jmodal",re.container.appendChild(re.title),re.container.appendChild(re.content),re.options.padding&&(re.content.style.padding=re.options.padding),re.options.width&&(re.container.style.width=re.options.width),re.options.height&&(re.container.style.height=re.options.height),re.options.title){var Y=document.createElement("h4");Y.innerText=re.options.title,re.title.appendChild(Y)}if(D.innerHTML="",D.style.display="none",D.appendChild(re.container),re.options.backdrop){var se=document.createElement("div");se.className="jmodal_backdrop",se.onclick=function(){re.close()},D.appendChild(se)}return re.open=function(){D.style.display="block";var _e=re.container.getBoundingClientRect();C.getWindowWidth()<_e.width?(re.container.style.top="",re.container.style.left="",re.container.classList.add("jmodal_fullscreen"),H.slideBottom(re.container,1)):re.options.backdrop&&(se.style.display="block"),typeof re.options.onopen=="function"&&re.options.onopen(D,re)},re.resetPosition=function(){re.container.style.top="",re.container.style.left=""},re.isOpen=function(){return D.style.display!="none"},re.close=function(){re.isOpen()&&(D.style.display="none",re.options.backdrop&&(se.style.display=""),re.container.classList.remove("jmodal_fullscreen"),typeof re.options.onclose=="function"&&re.options.onclose(D,re))},re.options.url?M({url:re.options.url,method:"GET",dataType:"text/html",success:function(_e){re.content.innerHTML=_e,re.options.closed||re.open(),typeof re.options.onload=="function"&&re.options.onload(re)}}):(re.options.closed||re.open(),typeof re.options.onload=="function"&&re.options.onload(re)),D.modal=re,V(),V=function(){},re});return q}var $e=De();function Fe(){var V=function(q){var D={};D.options={};var O={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var re in O)q&&q.hasOwnProperty(re)?D.options[re]=q[re]:D.options[re]=O[re];var Ee=document.createElement("div");Ee.className="jnotification",D.options.error&&Ee.classList.add("jnotification-error");var we=document.createElement("div");we.className="jnotification-container",Ee.appendChild(we);var Z=document.createElement("div");Z.className="jnotification-header",we.appendChild(Z);var Y=document.createElement("div");if(Y.className="jnotification-image",Z.appendChild(Y),D.options.icon){var se=document.createElement("img");se.src=D.options.icon,Y.appendChild(se)}var _e=document.createElement("div");if(_e.className="jnotification-name",_e.innerHTML=D.options.name,Z.appendChild(_e),D.options.closeable==!0){var Ae=document.createElement("div");Ae.className="jnotification-close",Ae.onclick=function(){D.hide()},Z.appendChild(Ae)}var ke=document.createElement("div");ke.className="jnotification-date",Z.appendChild(ke);var je=document.createElement("div");if(je.className="jnotification-content",we.appendChild(je),D.options.title){var Ue=document.createElement("div");Ue.className="jnotification-title",Ue.innerHTML=D.options.title,je.appendChild(Ue)}var et=document.createElement("div");if(et.className="jnotification-message",et.innerHTML=D.options.message,je.appendChild(et),D.show=function(){document.body.appendChild(Ee),C.getWindowWidth()>800?H.fadeIn(Ee):H.slideTop(Ee,1)},D.hide=function(){C.getWindowWidth()>800?H.fadeOut(Ee,function(){Ee.parentNode&&(Ee.parentNode.removeChild(Ee),st&&clearTimeout(st))}):H.slideTop(Ee,0,function(){Ee.parentNode&&(Ee.parentNode.removeChild(Ee),st&&clearTimeout(st))})},D.show(),D.options.autoHide==!0)var st=setTimeout(function(){D.hide()},D.options.timeout);return C.getWindowWidth()<800&&Ee.addEventListener("swipeup",function(at){D.hide(),at.preventDefault(),at.stopPropagation()}),D};return V.isVisible=function(){var q=document.querySelector(".jnotification");return!!(q&&q.parentNode)},V}var Ve=Fe();function Be(V,q){var D={};D.options={};var O={value:0,onchange:null,width:null};for(var re in O)q&&q.hasOwnProperty(re)?D.options[re]=q[re]:D.options[re]=O[re];V.classList.add("jprogressbar"),V.setAttribute("tabindex",1),V.setAttribute("data-value",D.options.value);var Ee=document.createElement("div");Ee.style.width=D.options.value+"%",Ee.style.color="#fff",V.appendChild(Ee),D.options.width&&(V.style.width=D.options.width),D.setValue=function(Z){Z=parseInt(Z),D.options.value=Z,Ee.style.width=Z+"%",V.setAttribute("data-value",Z+"%"),Z<6?V.style.color="#000":V.style.color="#fff",D.options.value=Z,typeof D.options.onchange=="function"&&D.options.onchange(V,Z),V.value!=D.options.value&&(V.value=D.options.value,typeof V.oninput=="function"&&V.oninput({type:"input",target:V,value:V.value}))},D.getValue=function(){return D.options.value};var we=function(Z){if(Z.which){var Y=V.getBoundingClientRect();if(Z.changedTouches&&Z.changedTouches[0]){var se=Z.changedTouches[0].clientX;Z.changedTouches[0].clientY}else{var se=Z.clientX;Z.clientY}D.setValue(Math.round((se-Y.left)/Y.width*100))}};return"touchstart"in document.documentElement?(V.addEventListener("touchstart",we),V.addEventListener("touchend",we)):(V.addEventListener("mousedown",we),V.addEventListener("mousemove",we)),V.change=D.setValue,V.val=function(Z){if(Z===void 0)return D.getValue();D.setValue(Z)},V.progressbar=D,D}function Je(V,q){if(V.rating)return V.rating.setOptions(q,!0);var D={};D.options={},D.setOptions=function(re,Ee){var we={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var Z in we)re&&re.hasOwnProperty(Z)?D.options[Z]=re[Z]:(typeof D.options[Z]>"u"||Ee===!0)&&(D.options[Z]=we[Z]);V.innerHTML="";for(var Y=0;Y<D.options.number;Y++){var se=document.createElement("div");se.setAttribute("data-index",Y+1),se.setAttribute("title",D.options.tooltip[Y]),V.appendChild(se)}if(D.options.value)for(var Y=0;Y<D.options.number;Y++)Y<D.options.value&&V.children[Y].classList.add("jrating-selected");return D},D.setValue=function(re){for(var Ee=0;Ee<D.options.number;Ee++)Ee<re?V.children[Ee].classList.add("jrating-selected"):(V.children[Ee].classList.remove("jrating-over"),V.children[Ee].classList.remove("jrating-selected"));D.options.value=re,typeof D.options.onchange=="function"&&D.options.onchange(V,re),V.value!=D.options.value&&(V.value=D.options.value,typeof V.oninput=="function"&&V.oninput({type:"input",target:V,value:V.value}))},D.getValue=function(){return D.options.value};var O=function(){D.setOptions(q),V.classList.add("jrating"),V.addEventListener("click",function(re){var Ee=re.target.getAttribute("data-index");Ee!=null&&(Ee==D.options.value?D.setValue(0):D.setValue(Ee))}),V.addEventListener("mouseover",function(re){for(var Ee=re.target.getAttribute("data-index"),we=0;we<D.options.number;we++)we<Ee?V.children[we].classList.add("jrating-over"):V.children[we].classList.remove("jrating-over")}),V.addEventListener("mouseout",function(re){for(var Ee=0;Ee<D.options.number;Ee++)V.children[Ee].classList.remove("jrating-over")}),V.change=D.setValue,V.val=function(re){if(re===void 0)return D.getValue();D.setValue(re)},V.rating=D};return O(),D}function lt(V,q){if(V.search)return V.search;var D=null,O=function(se){if(se.target.classList.contains("jsearch_item"))var _e=se.target;else var _e=se.target.parentNode;Z.selectIndex(_e),se.preventDefault()},re=function(se){if(typeof Z.options.onsearch=="function"){var _e=Z.options.onsearch(Z,se);_e&&(se=_e)}if(Y.innerHTML="",!se.length)V.style.display="";else{V.style.display="block";for(var Ae=se.length<11?se.length:10,ke=0;ke<Ae;ke++){if(typeof se[ke]=="string")var je=se[ke],Ue=se[ke];else{var je=se[ke].text;!je&&se[ke].name&&(je=se[ke].name);var Ue=se[ke].value;!Ue&&se[ke].id&&(Ue=se[ke].id)}var et=document.createElement("div");et.setAttribute("data-value",Ue),et.setAttribute("data-text",je),et.className="jsearch_item",se[ke].id&&et.setAttribute("id",se[ke].id),Z.options.forceSelect&&ke==0&&et.classList.add("selected");var st=document.createElement("img");se[ke].image?st.src=se[ke].image:st.style.display="none",et.appendChild(st);var at=document.createElement("div");at.innerHTML=je,et.appendChild(at),Y.appendChild(et)}}},Ee=function(se){if(se!=Z.terms)if(Z.terms=se,Z.options.forceSelect?D=0:D=null,Array.isArray(Z.options.data)){var _e=function(ke){if(typeof ke=="string"){if((""+ke).toLowerCase().search(se.toLowerCase())>=0)return!0}else for(var je in ke){var Ue=ke[je];if((""+Ue).toLowerCase().search(se.toLowerCase())>=0)return!0}return!1},Ae=Z.options.data.filter(function(ke){return _e(ke)});re(Ae)}else M({url:Z.options.data+se,method:"GET",dataType:"json",success:function(ke){re(ke)}})},we=null,Z=function(se){we&&clearTimeout(we),we=setTimeout(function(){Ee(se)},500)};q.forceSelect===null&&(q.forceSelect=!0),Z.options={data:q.data||null,input:q.input||null,searchByNode:q.searchByNode||null,onselect:q.onselect||null,forceSelect:q.forceSelect,onsearch:q.onsearch||null,onbeforesearch:q.onbeforesearch||null},Z.selectIndex=function(se){var _e=se.getAttribute("id"),Ae=se.getAttribute("data-text"),ke=se.getAttribute("data-value"),je=se.children[0].src||"";typeof Z.options.onselect=="function"&&Z.options.onselect(Z,Ae,ke,_e,je),Z.close()},Z.open=function(){V.style.display="block"},Z.close=function(){we&&clearTimeout(we),Z.terms="",Y.innerHTML="",V.style.display=""},Z.isOpened=function(){return!!V.style.display},Z.keydown=function(se){Z.isOpened()&&(se.key=="Enter"?D!==null&&Y.children[D]?(Z.selectIndex(Y.children[D]),se.preventDefault()):Z.close():se.key==="ArrowUp"?(D!==null&&Y.children[0]&&(Y.children[D].classList.remove("selected"),!Z.options.forceSelect&&D===0?D=null:(D=Math.max(0,D-1),Y.children[D].classList.add("selected"))),se.preventDefault()):se.key==="ArrowDown"&&(D==null?D=-1:Y.children[D].classList.remove("selected"),D<9&&Y.children[D+1]&&D++,Y.children[D].classList.add("selected"),se.preventDefault()))},Z.keyup=function(se){if(!Z.options.searchByNode&&Z.options.input)if(Z.options.input.tagName==="DIV")var _e=Z.options.input.innerText;else var _e=Z.options.input.value;else{var Ae=C.getNode();if(Ae)var _e=Ae.innerText}if(typeof Z.options.onbeforesearch=="function"){var ke=Z.options.onbeforesearch(Z,_e);if(ke)_e=ke;else if(ke===!1)return}Z(_e)},Z.blur=function(se){Z.close()},Z.options.input&&(Z.options.input.addEventListener("keyup",Z.keyup),Z.options.input.addEventListener("keydown",Z.keydown),Z.options.input.addEventListener("blur",Z.blur));var Y=document.createElement("div");return Y.classList.add("jsearch_container"),Y.onmousedown=O,V.appendChild(Y),V.classList.add("jsearch"),V.search=Z,Z}function ot(V,q){var D={};if(D.options={},D.currentImage=null,q&&(D.options=q),V.setAttribute("tabindex","900"),D.options.items=[],!V.classList.contains("jslider")){if(V.classList.add("jslider"),V.classList.add("unselectable"),D.options.height&&(V.style.minHeight=parseInt(D.options.height)+"px"),D.options.width&&(V.style.width=parseInt(D.options.width)+"px"),D.options.grid){V.classList.add("jslider-grid");var O=V.children.length;O>4&&V.setAttribute("data-total",O-4),V.setAttribute("data-number",O>4?4:O)}var re=document.createElement("div");if(re.classList.add("jslider-counter"),V.children.length>0)for(var Ee=0;Ee<V.children.length;Ee++){D.options.items.push(V.children[Ee]);var we=document.createElement("div");we.onclick=function(){var Ae=Array.prototype.slice.call(re.children).indexOf(this);D.show(D.currentImage=D.options.items[Ae])},re.appendChild(we)}var Z=document.createElement("div");Z.className="jslider-caption";var Y=document.createElement("div"),se=document.createElement("div");se.className="jslider-close",se.innerHTML="",se.onclick=function(){D.close()},Y.appendChild(Z),Y.appendChild(se)}D.updateCounter=function(Ae){for(var ke=0;ke<re.children.length;ke++)if(re.children[ke].classList.contains("jslider-counter-focus")){re.children[ke].classList.remove("jslider-counter-focus");break}re.children[Ae].classList.add("jslider-counter-focus")},D.show=function(Ae){if(!Ae)var Ae=V.children[0];V.classList.add("jslider-focus"),V.classList.remove("jslider-grid"),V.appendChild(Y),V.appendChild(re);var ke=D.options.items.indexOf(Ae);D.updateCounter(ke);for(var je=0;je<V.children.length;je++)V.children[je].style.display="";Ae.style.display="block",Ae.previousElementSibling?V.classList.add("jslider-left"):V.classList.remove("jslider-left"),Ae.nextElementSibling&&Ae.nextElementSibling.tagName=="IMG"?V.classList.add("jslider-right"):V.classList.remove("jslider-right"),D.currentImage=Ae,D.currentImage.offsetHeight>D.currentImage.offsetWidth&&D.currentImage.classList.add("jslider-vertical"),Y.children[0].innerText=D.currentImage.getAttribute("title")},D.open=function(){D.show(),typeof D.options.onopen=="function"&&D.options.onopen(V)},D.close=function(){V.classList.remove("jslider-focus"),V.classList.remove("jslider-left"),V.classList.remove("jslider-right"),D.options.grid&&V.classList.add("jslider-grid");for(var Ae=0;Ae<V.children.length;Ae++)V.children[Ae].style.display="";re.remove(),Y.remove(),D.currentImage=null,typeof D.options.onclose=="function"&&D.options.onclose(V)},D.reset=function(){V.innerHTML=""},D.next=function(){var Ae=D.currentImage.nextElementSibling;Ae&&Ae.tagName==="IMG"&&D.show(D.currentImage.nextElementSibling)},D.prev=function(){D.currentImage.previousElementSibling&&D.show(D.currentImage.previousElementSibling)};var _e=function(Ae){if(Ae.target.tagName=="IMG")D.show(Ae.target);else if(!Ae.target.classList.contains("jslider-close")&&!(Ae.target.parentNode.classList.contains("jslider-counter")||Ae.target.classList.contains("jslider-counter"))){var ke=Ae.offsetX||Ae.changedTouches[0].clientX;Ae.target.clientWidth-ke<40?D.next():ke<40&&D.prev()}};return"ontouchend"in document.documentElement?V.addEventListener("touchend",_e):V.addEventListener("mouseup",_e),V.addEventListener("swipeleft",function(Ae){D.next(),Ae.preventDefault(),Ae.stopPropagation()}),V.addEventListener("swiperight",function(Ae){D.prev(),Ae.preventDefault(),Ae.stopPropagation()}),V.addEventListener("keydown",function(Ae){Ae.which==27&&D.close()}),V.slider=D,D}function ht(V,q){if(V.tags)return V.tags.setOptions(q,!0);var D={type:"tags"};D.options={};var O=function(){return!!(D.options.limit&&V.children.length>=D.options.limit)},re=null,Ee=null;D.setOptions=function(Ie,We){var tt={value:"",limit:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onremoveitem:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null};for(var ue in tt)Ie&&Ie.hasOwnProperty(ue)?D.options[ue]=Ie[ue]:(typeof D.options[ue]>"u"||We===!0)&&(D.options[ue]=tt[ue]);return D.options.placeholder?V.setAttribute("data-placeholder",D.options.placeholder):V.removeAttribute("data-placeholder"),V.placeholder=D.options.placeholder,D.setValue(D.options.value),se(),D.options.search?Ee||(Ee=document.createElement("div"),V.parentNode.insertBefore(Ee,V.nextSibling),re=lt(Ee,{data:D.options.search,onselect:function(be,j,J){D.selectIndex(j,J)}})):Ee&&(re=null,Ee.remove(),Ee=null),D},D.add=function(Ie,We){if(typeof D.options.onbeforechange=="function"){var tt=D.options.onbeforechange(V,D,D.options.value,Ie);if(tt===!1)return!1;tt!=null&&(Ie=tt)}if(re&&re.close(),O())typeof D.options.onlimit=="function"?D.options.onlimit(D,D.options.limit):alert(p.translate("You reach the limit number of entries")+" "+D.options.limit);else{var ue=C.getNode();if(ue&&ue.parentNode&&ue.parentNode.classList.contains("jtags")&&ue.nextSibling&&!(ue.nextSibling.innerText&&ue.nextSibling.innerText.trim()))be=ue.nextSibling;else{if(V.lastChild&&(V.lastChild.innerText.trim()||V.removeChild(V.lastChild)),!Ie||typeof Ie=="string")var be=Z(Ie,Ie,ue);else for(var j=0;j<=Ie.length;j++)if(!O()){if(!Ie[j]||typeof Ie[j]=="string")var J=Ie[j]||"",Ce=null;else var J=Ie[j].text,Ce=Ie[j].value;var be=Z(J,Ce)}Y()}We&&we(be)}},D.setLimit=function(Ie){for(D.options.limit=Ie,V.children.length-Ie;V.children.length>Ie;)V.removeChild(V.lastChild)},D.remove=function(Ie){Ie.parentNode.removeChild(Ie),V.children.length?Y():D.add("",!0),typeof D.options.onremoveitem=="function"&&D.options.onremoveitem(V,D,Ie)},D.getData=function(){for(var Ie=[],We=0;We<V.children.length;We++){var tt=V.children[We].innerText.replace(`
`,""),ue=V.children[We].getAttribute("data-value");ue||(ue=tt),(tt||ue)&&Ie.push({text:tt,value:ue})}return Ie},D.getValue=function(Ie){var We=null;if(Ie!=null)We=V.children[Ie].getAttribute("data-value"),We||(We=V.children[Ie].innerText.replace(`
`,""));else{for(var tt=[],ue=0;ue<V.children.length;ue++)We=V.children[ue].innerText.replace(`
`,""),We&&tt.push(D.getValue(ue));We=tt.join(",")}return We},D.setValue=function(Ie){if(!Ie)D.reset();else if(V.value!=Ie)if(Array.isArray(Ie))D.add(Ie);else{var We=(""+Ie).trim(),tt=Ae(We);V.innerHTML="",D.add(tt)}},D.reset=function(){V.classList.add("jtags-empty"),V.innerHTML="<div></div>",Y()},D.isValid=function(){for(var Ie=0,We=0;We<V.children.length;We++)V.children[We].classList.contains("jtags_error")&&Ie++;return Ie==0},D.selectIndex=function(Ie,We){var tt=C.getNode();tt&&(tt.innerText=Ie,We&&tt.setAttribute("data-value",We),tt.classList.remove("jtags_error"),O()||D.add("",!0))},D.search=function(Ie){Ie.innerText},D.destroy=function(){V.removeEventListener("mouseup",st),V.removeEventListener("keydown",je),V.removeEventListener("keyup",Ue),V.removeEventListener("paste",et),V.removeEventListener("focus",at),V.removeEventListener("blur",ft),V.parentNode.removeChild(V)};var we=function(Ie){if(V.children.length){var We=document.createRange(),tt=window.getSelection();if(!Ie)var Ie=V.childNodes[V.childNodes.length-1];We.setStart(Ie,Ie.length),We.collapse(!0),tt.removeAllRanges(),tt.addRange(We),V.scrollLeft=V.scrollWidth}},Z=function(Ie,We,tt){var ue=document.createElement("div");return ue.textContent=Ie||"",We&&ue.setAttribute("data-value",We),tt&&tt.parentNode.classList.contains("jtags")?V.insertBefore(ue,tt.nextSibling):V.appendChild(ue),ue},Y=function(){var Ie=D.getValue();Ie!=D.options.value&&(D.options.value=Ie,typeof D.options.onchange=="function"&&D.options.onchange(V,D,D.options.value),V.value!=D.options.value&&(V.value=D.options.value,typeof V.oninput=="function"&&V.oninput({type:"input",target:V,value:V.value}))),se()},se=function(){for(var Ie=0;Ie<V.children.length;Ie++)V.children[Ie].tagName==="DIV"&&(D.getValue(Ie)?(V.children[Ie].classList.add("jtags_label"),typeof D.options.validation=="function"&&D.getValue(Ie)?D.options.validation(V.children[Ie],V.children[Ie].innerText,V.children[Ie].getAttribute("data-value"))?V.children[Ie].classList.remove("jtags_error"):V.children[Ie].classList.add("jtags_error"):V.children[Ie].classList.remove("jtags_error")):V.children[Ie].classList.remove("jtags_label"));_e()},_e=function(){V.innerText.trim()?V.classList.remove("jtags-empty"):(!V.children.length||V.children[0].tagName==="BR")&&(V.innerHTML="",we(Z()))},Ae=function(Ie){var We=[],tt="";if(Ie=Ie.trim(),Ie){for(var ue=0;ue<Ie.length;ue++)Ie[ue]==","||Ie[ue]==";"||Ie[ue]==`
`?tt&&(We.push(tt.trim()),tt=""):tt+=Ie[ue];tt&&We.push(tt)}return We},ke=0,je=function(Ie){if(ke=window.getSelection().anchorOffset,_e(),Ie.key==="Tab"||Ie.key===";"||Ie.key===","){var We=window.getSelection().anchorOffset;We>1&&(O()?typeof D.options.onlimit=="function"&&D.options.onlimit(D,D.options.limit):D.add("",!0)),Ie.preventDefault()}else if(Ie.key=="Enter"){if(!re||!re.isOpened()){var We=window.getSelection().anchorOffset;We>1&&(O()||D.add("",!0)),Ie.preventDefault()}}else Ie.key=="Backspace"&&V.children.length==1&&window.getSelection().anchorOffset<1&&Ie.preventDefault();re&&re.keydown(Ie),_e()},Ue=function(Ie){if(Ie.which==39){var We=window.getSelection().anchorOffset;We>1&&We==ke&&D.add("",!0)}else Ie.which==13||Ie.which==38||Ie.which==40?Ie.preventDefault():re&&re.keyup(Ie);se()},et=function(Ie){if(Ie.clipboardData||Ie.originalEvent.clipboardData)var We=(Ie.originalEvent||Ie).clipboardData.getData("text/plain");else if(window.clipboardData)var We=window.clipboardData.getData("Text");var tt=Ae(We);if(typeof D.options.onbeforepaste=="function"){var ue=D.options.onbeforepaste(V,D,tt);if(ue===!1)return Ie.preventDefault(),!1;ue&&(tt=ue)}tt.length>1?(D.add(tt,!0),Ie.preventDefault()):tt[0]&&(document.execCommand("insertText",!1,tt[0]),Ie.preventDefault())},st=function(Ie){if(Ie.target.parentNode&&Ie.target.parentNode.classList.contains("jtags")&&(Ie.target.classList.contains("jtags_label")||Ie.target.classList.contains("jtags_error"))){var We=Ie.target.getBoundingClientRect();We.width-(Ie.clientX-We.left)<16&&D.remove(Ie.target)}Ie.target==V&&we()},at=function(){V.classList.contains("jtags-focus")||((!V.children.length||D.getValue(V.children.length-1))&&(O()||Z("")),typeof D.options.onfocus=="function"&&D.options.onfocus(V,D,D.getValue()),V.classList.add("jtags-focus"))},ft=function(){if(V.classList.contains("jtags-focus")){re&&re.close();for(var Ie=0;Ie<V.children.length-1;Ie++)D.getValue(Ie)||V.removeChild(V.children[Ie]);Y(),V.classList.remove("jtags-focus"),typeof D.options.onblur=="function"&&D.options.onblur(V,D,D.getValue())}},gt=function(){"touchend"in document.documentElement?V.addEventListener("touchend",st):V.addEventListener("mouseup",st),V.addEventListener("keydown",je),V.addEventListener("keyup",Ue),V.addEventListener("paste",et),V.addEventListener("focus",at),V.addEventListener("blur",ft),V.setAttribute("contenteditable",!0),V.classList.add("jtags"),D.setOptions(q),typeof D.options.onload=="function"&&D.options.onload(V,D),V.change=D.setValue,V.val=function(Ie){if(Ie===void 0)return D.getValue();D.setValue(Ie)},V.tags=D};return gt(),D}function Ct(V,q){var D={};D.options={};var O={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null};for(var re in O)q&&q.hasOwnProperty(re)?D.options[re]=q[re]:D.options[re]=O[re];D.options.multiple==!0&&V.setAttribute("data-multiple",!0),V.content=[],V.classList.add("jupload"),D.options.input==!0&&V.classList.add("input"),D.add=function(Y){if(D.options.multiple==!1&&(V.content=[],V.innerText=""),D.options.type=="image"){var se=document.createElement("img");se.setAttribute("src",Y.file),se.setAttribute("tabindex",-1),V.getAttribute("name")||(se.className="jfile",se.content=Y),V.appendChild(se)}else{if(Y.name)var _e=Y.name;else var _e=Y.file;var Ae=document.createElement("div");Ae.innerText=_e||D.options.type,Ae.classList.add("jupload-item"),Ae.setAttribute("tabindex",-1),V.appendChild(Ae)}Y.content&&(Y.file=C.guid()),V.content.push(Y),typeof D.options.onchange=="function"&&D.options.onchange(V,Y)},D.addFromFile=function(Y){var se=Y.type.split("/");if(se[0]==D.options.type){var _e=new FileReader;_e.addEventListener("load",function(Ae){var ke={file:Ae.srcElement.result,extension:Y.name.substr(Y.name.lastIndexOf(".")+1),name:Y.name,size:Y.size,lastmodified:Y.lastModified,content:Ae.srcElement.result};D.add(ke)}),_e.readAsDataURL(Y)}else alert(p.translate("This extension is not allowed"))},D.addFromUrl=function(Y){if(Y.substr(0,4)!="data"&&!D.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(Y.substr(0,4)=="data"){var se=Y.split(";");se=se[0].split("/");var _e=se[0].replace("data:","");if(_e==D.options.type){var Ae={file:Y,name:"",extension:se[1],content:Y};D.add(Ae)}else alert(D.options.text.extensionNotAllowed)}else{var se=Y.substr(Y.lastIndexOf(".")+1);Y=D.options.remoteParser+Y,M({url:Y,type:"GET",dataType:"blob",success:function(je){}})}};var Ee=D.options.type+"/"+D.options.extension,we=document.createElement("input");we.type="file",we.setAttribute("accept",Ee),we.onchange=function(){for(var Y=0;Y<this.files.length;Y++)D.addFromFile(this.files[Y])},D.options.multiple==!0&&we.setAttribute("multiple",!0);var Z=null;return V.addEventListener("click",function(Y){Z=null,!V.children.length||Y.target===V?C.click(we):Y.target.parentNode==V&&(Z=Y.target)}),V.addEventListener("dblclick",function(Y){C.click(we)}),V.addEventListener("dragenter",function(Y){V.style.border="1px dashed #000"}),V.addEventListener("dragleave",function(Y){V.style.border="1px solid #eee"}),V.addEventListener("dragstop",function(Y){V.style.border="1px solid #eee"}),V.addEventListener("dragover",function(Y){Y.preventDefault()}),V.addEventListener("keydown",function(Y){if(Z&&Y.which==46){var se=Array.prototype.indexOf.call(V.children,Z);se>=0&&(V.content.splice(se,1),Z.remove(),Z=null)}}),V.addEventListener("drop",function(Y){Y.preventDefault(),Y.stopPropagation();var se=(Y.originalEvent||Y).dataTransfer.getData("text/html"),_e=(Y.originalEvent||Y).dataTransfer.files;if(_e.length)for(var Ae=0;Ae<Y.dataTransfer.files.length;Ae++)D.addFromFile(Y.dataTransfer.files[Ae]);else if(se){D.options.multiple==!1&&(V.innerText="");let ke=[];if(ee(se,ke),ke.length)for(var Ae=0;Ae<ke.length;Ae++)D.addFromUrl(ke[Ae])}return V.style.border="1px solid #eee",!1}),V.val=function(Y){if(Y===void 0)return V.content&&V.content.length?V.content:null;if(V.innerText="",V.content=[],Y)if(Array.isArray(Y))for(var se=0;se<Y.length;se++)typeof Y[se]=="string"?D.add({file:Y[se]}):D.add(Y[se]);else typeof Y=="string"&&D.add({file:Y})},V.upload=V.image=D,D}var bt=h(195),vt=h.n(bt),mt={...p,...C,version:"5.13.3",setExtensions:function(V){if(typeof V=="object")for(var q=Object.keys(V),D=0;D<q.length;D++)mt[q[D]]=V[q[D]]},tracking:w,path:P,sorting:R,lazyLoading:T,ajax:M,animation:H,calendar:oe,color:ye,contextmenu:he,dropdown:Qe,editor:ve,floating:ne,form:ge,mask:W,modal:$e,notification:Ve,palette:X,picker:Xe,progressbar:Be,rating:Je,search:lt,slider:ot,tabs:le,tags:ht,toolbar:Ke,upload:Ct,validations:Oe};mt.image=Ct,mt.image.create=function(V){var q=document.createElement("img");return q.setAttribute("src",V.file),q.className="jfile",q.setAttribute("tabindex",-1),q.content=V,q},mt.tracker=ge,mt.loading=H.loading,mt.sha512=vt(),typeof document<"u"&&function(){if(typeof window.jSuitesStateControl>"u")window.jSuitesStateControl=[];else return;const V=function(Ie,We){return Ie[We.type]&&Ie[We.type]==We||Ie.component&&Ie.component==We?!0:Ie.parentNode?V(Ie.parentNode,We):!1},q=function(Ie){let We=window.jSuitesStateControl;if(We&&We.length>0)for(let tt=0;tt<We.length;tt++)We[tt]&&!V(Ie,We[tt])&&We[tt].close()};let D=15,O=!1,re={x:null,y:null},Ee=document.createElement("div");Ee.classList.add("jtooltip");const we=function(Ie){return Ie&&(Ie.shadowRoot||Ie.tagName&&Ie.tagName.includes("-"))},Z=function(Ie){let We,tt,ue=Ie.path||Ie.composedPath&&Ie.composedPath();return ue?(tt=ue[0],tt&&we(tt)&&!tt.shadowRoot&&Ie.toElement&&(tt=Ie.toElement)):(Ie.target&&we(Ie.target)?We=Ie.target.shadowRoot:We=document,tt=We.elementFromPoint(x,y)),tt},Y=function(Ie){if(Ie.changedTouches&&Ie.changedTouches[0])var We=Ie.changedTouches[0].clientX,tt=Ie.changedTouches[0].clientY;else var We=Ie.clientX,tt=Ie.clientY;let ue=Z(Ie),be=ue&&ue.tagName==="DIV"&&ue.getAttribute("contentEditable"),j=mt.findElement(ue,"jpanel");if(j&&!j.classList.contains("readonly")&&!be){let J=j.getBoundingClientRect(),Ce=0;j.style.rotate&&(Ce=parseFloat(j.style.rotate));let Le="move";ue.getAttribute("data-action")?Le=ue.getAttribute("data-action"):j.style.cursor?Le="resize":j.style.cursor="move",O={action:Le,a:Ce,e:j,x:We,y:tt,l:J.left,t:J.top,b:J.bottom,r:J.right,w:J.width,h:J.height,d:j.style.cursor,actioned:!1},j.style.width||(j.style.width=J.width+"px"),j.style.height||(j.style.height=J.height+"px")}else O=!1;q(ue),Ue(Ie)},se=function(Ie,We,tt,ue,be,j){const J=tt-Ie,Ce=ue-We,Le=be-Ie,me=j-We;let He=Math.atan2(Ce,J),Re=Math.atan2(me,Le)-He;return Re=Re*(180/Math.PI),Re<0&&(Re+=360),Re},_e=function(Ie){O&&O.e&&(typeof O.e.refresh=="function"&&re.actioned&&O.e.refresh(),O.e.style.cursor=""),re={x:null,y:null},O=!1},Ae=function(Ie){if(O){let j=Ie.clientX||Ie.pageX,J=Ie.clientY||Ie.pageY;if(re.x==null&&re.y==null&&(re.x=j,re.y=J),O.action==="move"){var We=j-re.x,tt=J-re.y,ue=O.e.offsetTop+tt,be=O.e.offsetLeft+We;O.e.style.top=ue+"px",O.e.style.left=be+"px",typeof O.e.refresh=="function"&&(re.actioned=!0,O.e.refresh("position",ue,be))}else if(O.action==="rotate"){let Ce=O.l+O.w/2,Le=O.t+O.h/2,me=se(Ce,Le,O.x,O.y,j,J);me=me+O.a%360,me=Math.round(me/2)*2,O.e.style.rotate=`${me}deg`,typeof O.e.refresh=="function"&&(re.actioned=!0,O.e.refresh("rotate",me))}else if(O.action==="resize"){let Ce=null,Le=null,me=null,He=null;O.d=="e-resize"||O.d=="ne-resize"||O.d=="se-resize"?(me=O.e.offsetWidth+(j-re.x),Ie.shiftKey&&(He=O.e.offsetHeight+(j-re.x)*(O.e.offsetHeight/O.e.offsetWidth))):(O.d==="w-resize"||O.d=="nw-resize"||O.d=="sw-resize")&&(Le=O.e.offsetLeft+(j-re.x),me=O.e.offsetLeft+O.e.offsetWidth-Le,Ie.shiftKey&&(He=O.e.offsetHeight-(j-re.x)*(O.e.offsetHeight/O.e.offsetWidth))),O.d=="s-resize"||O.d=="se-resize"||O.d=="sw-resize"?He||(He=O.e.offsetHeight+(J-re.y)):(O.d==="n-resize"||O.d=="ne-resize"||O.d=="nw-resize")&&(Ce=O.e.offsetTop+(J-re.y),He=O.e.offsetTop+O.e.offsetHeight-Ce),Ce&&(O.e.style.top=Ce+"px"),Le&&(O.e.style.left=Le+"px"),me&&(O.e.style.width=me+"px"),He&&(O.e.style.height=He+"px"),typeof O.e.refresh=="function"&&(re.actioned=!0,O.e.refresh("dimensions",me,He))}re.x=j,re.y=J}else{let j=Z(Ie),J=mt.findElement(j,"jpanel");if(J){if(J.classList.contains("jpanel-controls")){let Le=j.getAttribute("data-position");Le?J.style.cursor=Le:J.style.cursor=""}else if(J.getAttribute("tabindex")){let Le=J.getBoundingClientRect();Ie.clientY-Le.top<D?Le.width-(Ie.clientX-Le.left)<D?J.style.cursor="ne-resize":Ie.clientX-Le.left<D?J.style.cursor="nw-resize":J.style.cursor="n-resize":Le.height-(Ie.clientY-Le.top)<D?Le.width-(Ie.clientX-Le.left)<D?J.style.cursor="se-resize":Ie.clientX-Le.left<D?J.style.cursor="sw-resize":J.style.cursor="s-resize":Le.width-(Ie.clientX-Le.left)<D?J.style.cursor="e-resize":Ie.clientX-Le.left<D?J.style.cursor="w-resize":J.style.cursor=""}}}};let ke=["n","ne","e","se","s","sw","w","nw","rotate"];ke.forEach(function(Ie,We){ke[We]=document.createElement("div"),ke[We].classList.add("jpanel-action"),Ie==="rotate"?ke[We].setAttribute("data-action","rotate"):(ke[We].setAttribute("data-action","resize"),ke[We].setAttribute("data-position",Ie+"-resize"))});let je;const Ue=function(Ie){let We=Z(Ie),tt=mt.findElement(We,"jpanel");tt&&!tt.classList.contains("readonly")&&tt.classList.contains("jpanel-controls")?(tt.append(...ke),tt.classList.contains("jpanel-rotate")||ke[ke.length-1].remove(),je=tt):et()},et=function(Ie){je&&(ke.forEach(function(We){We.remove()}),je=null)},st=function(Ie){var tt=Z(Ie).getAttribute("data-tooltip");if(tt){if(Ee.innerText=tt,Ie.changedTouches&&Ie.changedTouches[0])var ue=Ie.changedTouches[0].clientX,be=Ie.changedTouches[0].clientY;else var ue=Ie.clientX,be=Ie.clientY;Ee.style.top=be+"px",Ee.style.left=ue+"px",document.body.appendChild(Ee)}else Ee.innerText&&(Ee.innerText="",document.body.removeChild(Ee))},at=function(Ie){var We=document.activeElement;if(We&&typeof We.contextmenu=="function")We.contextmenu(Ie),Ie.preventDefault(),Ie.stopImmediatePropagation();else if(We=mt.findElement(Ie.target,function(ue){return ue.tagName&&ue.getAttribute("aria-contextmenu-id")}),We){var tt=document.querySelector("#"+We);tt?(tt.contextmenu.open(Ie),Ie.preventDefault(),Ie.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+We)}},ft=function(Ie){let We=document.activeElement;We&&Ie.key==="Delete"&&typeof We.delete=="function"&&(We.delete(),Ie.preventDefault(),Ie.stopImmediatePropagation());let tt=window.jSuitesStateControl;tt&&tt.length>0&&(We=tt[tt.length-1],We&&Ie.key==="Escape"&&typeof We.isOpened=="function"&&typeof We.close=="function"&&We.isOpened()&&(We.close(),Ie.preventDefault(),Ie.stopImmediatePropagation()))},gt=function(Ie){(Ie.target.getAttribute("data-mask")||Ie.target.mask)&&mt.mask(Ie)};document.addEventListener("focusin",Ue),document.addEventListener("mouseup",_e),document.addEventListener("mousedown",Y),document.addEventListener("mousemove",Ae),document.addEventListener("mouseover",st),document.addEventListener("keydown",ft),document.addEventListener("contextmenu",at),document.addEventListener("input",gt)}();var Rt=mt})(),c=f.default})(),c}))})(jsuites$1)),jsuites$1.exports}var dist$2={exports:{}},dist$1=dist$2.exports,hasRequiredDist$1;function requireDist$1(){return hasRequiredDist$1||(hasRequiredDist$1=1,(function(a,s){(function(c,u){a.exports=u()})(dist$1,(function(){var c;return(function(){var u={765:function(g,m){var p;p=function(v){v.version="1.0.2";var w=Math;function E(pe,he){for(var Me=0,Qe=0;Me<pe.length;++Me)Qe=he*Qe+pe[Me];return Qe}function C(pe,he,Me,Qe,Xe){if(he===0)return Me;if(he===1)return Qe;for(var Ke=2/pe,it=Qe,te=1;te<he;++te)it=Qe*te*Ke+Xe*Me,Me=Qe,Qe=it;return it}function b(pe,he,Me,Qe,Xe){return function(Ke,it){if(Qe){if(Ke===0)return Qe==1?-1/0:1/0;if(Ke<0)return NaN}return it===0?pe(Ke):it===1?he(Ke):it<0?NaN:C(Ke,it|=0,pe(Ke),he(Ke),Xe)}}var P,R,T,I,M,N,H,L,A,k,W,G,oe,ae=(function(){var pe=.636619772,he=[57568490574,-13362590354,6516196407e-1,-1121442418e-2,77392.33017,-184.9052456].reverse(),Me=[57568490411,1029532985,9494680718e-3,59272.64853,267.8532712,1].reverse(),Qe=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),Xe=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934935152e-16].reverse();function Ke(ee){var ce=0,ve=0,K=0,ne=ee*ee;if(ee<8)ce=(ve=E(he,ne))/(K=E(Me,ne));else{var de=ee-.785398164;ve=E(Qe,ne=64/ne),K=E(Xe,ne),ce=w.sqrt(pe/ee)*(w.cos(de)*ve-w.sin(de)*K*8/ee)}return ce}var it=[72362614232,-7895059235,2423968531e-1,-2972611439e-3,15704.4826,-30.16036606].reverse(),te=[144725228442,2300535178,1858330474e-2,99447.43394,376.9991397,1].reverse(),Pe=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),U=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse();function Q(ee){var ce=0,ve=0,K=0,ne=ee*ee,de=w.abs(ee)-2.356194491;return Math.abs(ee)<8?ce=(ve=ee*E(it,ne))/(K=E(te,ne)):(ve=E(Pe,ne=64/ne),K=E(U,ne),ce=w.sqrt(pe/w.abs(ee))*(w.cos(de)*ve-w.sin(de)*K*8/w.abs(ee)),ee<0&&(ce=-ce)),ce}return function ee(ce,ve){if(ve=Math.round(ve),!isFinite(ce))return isNaN(ce)?ce:0;if(ve<0)return(ve%2?-1:1)*ee(ce,-ve);if(ce<0)return(ve%2?-1:1)*ee(-ce,ve);if(ve===0)return Ke(ce);if(ve===1)return Q(ce);if(ce===0)return 0;var K=0;if(ce>ve)K=C(ce,ve,Ke(ce),Q(ce),-1);else{for(var ne=!1,de=0,Oe=0,Se=1,ge=0,De=2/ce,$e=2*w.floor((ve+w.floor(w.sqrt(40*ve)))/2);$e>0;$e--)ge=$e*De*Se-de,de=Se,Se=ge,w.abs(Se)>1e10&&(Se*=1e-10,de*=1e-10,K*=1e-10,Oe*=1e-10),ne&&(Oe+=Se),ne=!ne,$e==ve&&(K=de);K/=Oe=2*Oe-Se}return K}})(),X=(P=.636619772,R=[-2957821389,7062834065,-5123598036e-1,1087988129e-2,-86327.92757,228.4622733].reverse(),T=[40076544269,7452499648e-1,7189466438e-3,47447.2647,226.1030244,1].reverse(),I=[1,-.001098628627,2734510407e-14,-2073370639e-15,2093887211e-16].reverse(),M=[-.01562499995,.0001430488765,-6911147651e-15,7621095161e-16,-934945152e-16].reverse(),N=[-4900604943e3,127527439e4,-51534381390,7349264551e-1,-4237922726e-3,8511.937935].reverse(),H=[249958057e5,424441966400,3733650367,2245904002e-2,102042.605,354.9632885,1].reverse(),L=[1,.00183105,-3516396496e-14,2457520174e-15,-240337019e-15].reverse(),A=[.04687499995,-.0002002690873,8449199096e-15,-88228987e-14,105787412e-15].reverse(),b((function(pe){var he=0,Me=0,Qe=0,Xe=pe*pe,Ke=pe-.785398164;return pe<8?he=(Me=E(R,Xe))/(Qe=E(T,Xe))+P*ae(pe,0)*w.log(pe):(Me=E(I,Xe=64/Xe),Qe=E(M,Xe),he=w.sqrt(P/pe)*(w.sin(Ke)*Me+w.cos(Ke)*Qe*8/pe)),he}),(function(pe){var he=0,Me=0,Qe=0,Xe=pe*pe,Ke=pe-2.356194491;return pe<8?he=(Me=pe*E(N,Xe))/(Qe=E(H,Xe))+P*(ae(pe,1)*w.log(pe)-1/pe):(Me=E(L,Xe=64/Xe),Qe=E(A,Xe),he=w.sqrt(P/pe)*(w.sin(Ke)*Me+w.cos(Ke)*Qe*8/pe)),he}),0,1,-1)),le=(k=[1,3.5156229,3.0899424,1.2067492,.2659732,.0360768,.0045813].reverse(),W=[.39894228,.01328592,.00225319,-.00157565,.00916281,-.02057706,.02635537,-.01647633,.00392377].reverse(),G=[.5,.87890594,.51498869,.15084934,.02658733,.00301532,32411e-8].reverse(),oe=[.39894228,-.03988024,-.00362018,.00163801,-.01031555,.02282967,-.02895312,.01787654,-.00420059].reverse(),function pe(he,Me){if((Me=Math.round(Me))===0)return(function(U){return U<=3.75?E(k,U*U/14.0625):w.exp(w.abs(U))/w.sqrt(w.abs(U))*E(W,3.75/w.abs(U))})(he);if(Me===1)return(function(U){return U<3.75?U*E(G,U*U/14.0625):(U<0?-1:1)*w.exp(w.abs(U))/w.sqrt(w.abs(U))*E(oe,3.75/w.abs(U))})(he);if(Me<0)return NaN;if(w.abs(he)===0)return 0;if(he==1/0)return 1/0;var Qe,Xe=0,Ke=2/w.abs(he),it=0,te=1,Pe=0;for(Qe=2*w.round((Me+w.round(w.sqrt(40*Me)))/2);Qe>0;Qe--)Pe=Qe*Ke*te+it,it=te,te=Pe,w.abs(te)>1e10&&(te*=1e-10,it*=1e-10,Xe*=1e-10),Qe==Me&&(Xe=it);return Xe*=pe(he,0)/te,he<0&&Me%2?-Xe:Xe}),ye=(function(){var pe=[-.57721566,.4227842,.23069756,.0348859,.00262698,1075e-7,74e-7].reverse(),he=[1.25331414,-.07832358,.02189568,-.01062446,.00587872,-.0025154,53208e-8].reverse(),Me=[1,.15443144,-.67278579,-.18156897,-.01919402,-.00110404,-4686e-8].reverse(),Qe=[1.25331414,.23498619,-.0365562,.01504268,-.00780353,.00325614,-68245e-8].reverse();return b((function(Xe){return Xe<=2?-w.log(Xe/2)*le(Xe,0)+E(pe,Xe*Xe/4):w.exp(-Xe)/w.sqrt(Xe)*E(he,2/Xe)}),(function(Xe){return Xe<=2?w.log(Xe/2)*le(Xe,1)+1/Xe*E(Me,Xe*Xe/4):w.exp(-Xe)/w.sqrt(Xe)*E(Qe,2/Xe)}),0,2,1)})();v.besselj=ae,v.bessely=X,v.besseli=le,v.besselk=ye},p(typeof DO_NOT_EXPORT_BESSEL>"u"?m:{})},162:function(g){var m;g.exports=(m=(function(p,v){var w=Array.prototype.concat,E=Array.prototype.slice,C=Object.prototype.toString;function b(A,k){var W=A>k?A:k;return p.pow(10,17-~~(p.log(W>0?W:-W)*p.LOG10E))}var P=Array.isArray||function(A){return C.call(A)==="[object Array]"};function R(A){return C.call(A)==="[object Function]"}function T(A){return typeof A=="number"&&A-A==0}function I(){return new I._init(arguments)}function M(){return 0}function N(){return 1}function H(A,k){return A===k?1:0}I.fn=I.prototype,I._init=function(A){if(P(A[0]))if(P(A[0][0])){R(A[1])&&(A[0]=I.map(A[0],A[1]));for(var k=0;k<A[0].length;k++)this[k]=A[0][k];this.length=A[0].length}else this[0]=R(A[1])?I.map(A[0],A[1]):A[0],this.length=1;else if(T(A[0]))this[0]=I.seq.apply(null,A),this.length=1;else{if(A[0]instanceof I)return I(A[0].toArray());this[0]=[],this.length=1}return this},I._init.prototype=I.prototype,I._init.constructor=I,I.utils={calcRdx:b,isArray:P,isFunction:R,isNumber:T,toVector:function(A){return w.apply([],A)}},I._random_fn=p.random,I.setRandom=function(A){if(typeof A!="function")throw new TypeError("fn is not a function");I._random_fn=A},I.extend=function(A){var k,W;if(arguments.length===1){for(W in A)I[W]=A[W];return this}for(k=1;k<arguments.length;k++)for(W in arguments[k])A[W]=arguments[k][W];return A},I.rows=function(A){return A.length||1},I.cols=function(A){return A[0].length||1},I.dimensions=function(A){return{rows:I.rows(A),cols:I.cols(A)}},I.row=function(A,k){return P(k)?k.map((function(W){return I.row(A,W)})):A[k]},I.rowa=function(A,k){return I.row(A,k)},I.col=function(A,k){if(P(k)){var W=I.arange(A.length).map((function(){return new Array(k.length)}));return k.forEach((function(ae,X){I.arange(A.length).forEach((function(le){W[le][X]=A[le][ae]}))})),W}for(var G=new Array(A.length),oe=0;oe<A.length;oe++)G[oe]=[A[oe][k]];return G},I.cola=function(A,k){return I.col(A,k).map((function(W){return W[0]}))},I.diag=function(A){for(var k=I.rows(A),W=new Array(k),G=0;G<k;G++)W[G]=[A[G][G]];return W},I.antidiag=function(A){for(var k=I.rows(A)-1,W=new Array(k),G=0;k>=0;k--,G++)W[G]=[A[G][k]];return W},I.transpose=function(A){var k,W,G,oe,ae,X=[];for(P(A[0])||(A=[A]),W=A.length,G=A[0].length,ae=0;ae<G;ae++){for(k=new Array(W),oe=0;oe<W;oe++)k[oe]=A[oe][ae];X.push(k)}return X.length===1?X[0]:X},I.map=function(A,k,W){var G,oe,ae,X,le;for(P(A[0])||(A=[A]),oe=A.length,ae=A[0].length,X=W?A:new Array(oe),G=0;G<oe;G++)for(X[G]||(X[G]=new Array(ae)),le=0;le<ae;le++)X[G][le]=k(A[G][le],G,le);return X.length===1?X[0]:X},I.cumreduce=function(A,k,W){var G,oe,ae,X,le;for(P(A[0])||(A=[A]),oe=A.length,ae=A[0].length,X=W?A:new Array(oe),G=0;G<oe;G++)for(X[G]||(X[G]=new Array(ae)),ae>0&&(X[G][0]=A[G][0]),le=1;le<ae;le++)X[G][le]=k(X[G][le-1],A[G][le]);return X.length===1?X[0]:X},I.alter=function(A,k){return I.map(A,k,!0)},I.create=function(A,k,W){var G,oe,ae=new Array(A);for(R(k)&&(W=k,k=A),G=0;G<A;G++)for(ae[G]=new Array(k),oe=0;oe<k;oe++)ae[G][oe]=W(G,oe);return ae},I.zeros=function(A,k){return T(k)||(k=A),I.create(A,k,M)},I.ones=function(A,k){return T(k)||(k=A),I.create(A,k,N)},I.rand=function(A,k){return T(k)||(k=A),I.create(A,k,I._random_fn)},I.identity=function(A,k){return T(k)||(k=A),I.create(A,k,H)},I.symmetric=function(A){var k,W,G=A.length;if(A.length!==A[0].length)return!1;for(k=0;k<G;k++)for(W=0;W<G;W++)if(A[W][k]!==A[k][W])return!1;return!0},I.clear=function(A){return I.alter(A,M)},I.seq=function(A,k,W,G){R(G)||(G=!1);var oe,ae=[],X=b(A,k),le=(k*X-A*X)/((W-1)*X),ye=A;for(oe=0;ye<=k&&oe<W;ye=(A*X+le*X*++oe)/X)ae.push(G?G(ye,oe):ye);return ae},I.arange=function(A,k,W){var G,oe=[];if(W=W||1,k===v&&(k=A,A=0),A===k||W===0)return[];if(A<k&&W<0)return[];if(A>k&&W>0)return[];if(W>0)for(G=A;G<k;G+=W)oe.push(G);else for(G=A;G>k;G+=W)oe.push(G);return oe},I.slice=(function(){function A(k,W,G,oe){var ae,X=[],le=k.length;if(W===v&&G===v&&oe===v)return I.copy(k);if(oe=oe||1,(W=(W=W||0)>=0?W:le+W)===(G=(G=G||k.length)>=0?G:le+G)||oe===0)return[];if(W<G&&oe<0)return[];if(W>G&&oe>0)return[];if(oe>0)for(ae=W;ae<G;ae+=oe)X.push(k[ae]);else for(ae=W;ae>G;ae+=oe)X.push(k[ae]);return X}return function(k,W){var G,oe;return T((W=W||{}).row)?T(W.col)?k[W.row][W.col]:A(I.rowa(k,W.row),(G=W.col||{}).start,G.end,G.step):T(W.col)?A(I.cola(k,W.col),(oe=W.row||{}).start,oe.end,oe.step):(oe=W.row||{},G=W.col||{},A(k,oe.start,oe.end,oe.step).map((function(ae){return A(ae,G.start,G.end,G.step)})))}})(),I.sliceAssign=function(A,k,W){var G,oe;if(T(k.row)){if(T(k.col))return A[k.row][k.col]=W;k.col=k.col||{},k.col.start=k.col.start||0,k.col.end=k.col.end||A[0].length,k.col.step=k.col.step||1,G=I.arange(k.col.start,p.min(A.length,k.col.end),k.col.step);var ae=k.row;return G.forEach((function(le,ye){A[ae][le]=W[ye]})),A}if(T(k.col)){k.row=k.row||{},k.row.start=k.row.start||0,k.row.end=k.row.end||A.length,k.row.step=k.row.step||1,oe=I.arange(k.row.start,p.min(A[0].length,k.row.end),k.row.step);var X=k.col;return oe.forEach((function(le,ye){A[le][X]=W[ye]})),A}return W[0].length===v&&(W=[W]),k.row.start=k.row.start||0,k.row.end=k.row.end||A.length,k.row.step=k.row.step||1,k.col.start=k.col.start||0,k.col.end=k.col.end||A[0].length,k.col.step=k.col.step||1,oe=I.arange(k.row.start,p.min(A.length,k.row.end),k.row.step),G=I.arange(k.col.start,p.min(A[0].length,k.col.end),k.col.step),oe.forEach((function(le,ye){G.forEach((function(pe,he){A[le][pe]=W[ye][he]}))})),A},I.diagonal=function(A){var k=I.zeros(A.length,A.length);return A.forEach((function(W,G){k[G][G]=W})),k},I.copy=function(A){return A.map((function(k){return T(k)?k:k.map((function(W){return W}))}))};var L=I.prototype;return L.length=0,L.push=Array.prototype.push,L.sort=Array.prototype.sort,L.splice=Array.prototype.splice,L.slice=Array.prototype.slice,L.toArray=function(){return this.length>1?E.call(this):E.call(this)[0]},L.map=function(A,k){return I(I.map(this,A,k))},L.cumreduce=function(A,k){return I(I.cumreduce(this,A,k))},L.alter=function(A){return I.alter(this,A),this},(function(A){for(var k=0;k<A.length;k++)(function(W){L[W]=function(G){var oe,ae=this;return G?(setTimeout((function(){G.call(ae,L[W].call(ae))})),this):(oe=I[W](this),P(oe)?I(oe):oe)}})(A[k])})("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),(function(A){for(var k=0;k<A.length;k++)(function(W){L[W]=function(G,oe){var ae=this;return oe?(setTimeout((function(){oe.call(ae,L[W].call(ae,G))})),this):I(I[W](this,G))}})(A[k])})("row col".split(" ")),(function(A){for(var k=0;k<A.length;k++)(function(W){L[W]=function(){return I(I[W].apply(null,arguments))}})(A[k])})("create zeros ones rand identity".split(" ")),I})(Math),(function(p,v){var w=p.utils.isFunction;function E(P,R){return P-R}function C(P,R,T){return v.max(R,v.min(P,T))}p.sum=function(P){for(var R=0,T=P.length;--T>=0;)R+=P[T];return R},p.sumsqrd=function(P){for(var R=0,T=P.length;--T>=0;)R+=P[T]*P[T];return R},p.sumsqerr=function(P){for(var R,T=p.mean(P),I=0,M=P.length;--M>=0;)I+=(R=P[M]-T)*R;return I},p.sumrow=function(P){for(var R=0,T=P.length;--T>=0;)R+=P[T];return R},p.product=function(P){for(var R=1,T=P.length;--T>=0;)R*=P[T];return R},p.min=function(P){for(var R=P[0],T=0;++T<P.length;)P[T]<R&&(R=P[T]);return R},p.max=function(P){for(var R=P[0],T=0;++T<P.length;)P[T]>R&&(R=P[T]);return R},p.unique=function(P){for(var R={},T=[],I=0;I<P.length;I++)R[P[I]]||(R[P[I]]=!0,T.push(P[I]));return T},p.mean=function(P){return p.sum(P)/P.length},p.meansqerr=function(P){return p.sumsqerr(P)/P.length},p.geomean=function(P){var R=P.map(v.log),T=p.mean(R);return v.exp(T)},p.median=function(P){var R=P.length,T=P.slice().sort(E);return 1&R?T[R/2|0]:(T[R/2-1]+T[R/2])/2},p.cumsum=function(P){return p.cumreduce(P,(function(R,T){return R+T}))},p.cumprod=function(P){return p.cumreduce(P,(function(R,T){return R*T}))},p.diff=function(P){var R,T=[],I=P.length;for(R=1;R<I;R++)T.push(P[R]-P[R-1]);return T},p.rank=function(P){var R,T=[],I={};for(R=0;R<P.length;R++)I[L=P[R]]?I[L]++:(I[L]=1,T.push(L));var M=T.sort(E),N={},H=1;for(R=0;R<M.length;R++){var L,A=I[L=M[R]],k=(H+(H+A-1))/2;N[L]=k,H+=A}return P.map((function(W){return N[W]}))},p.mode=function(P){var R,T=P.length,I=P.slice().sort(E),M=1,N=0,H=0,L=[];for(R=0;R<T;R++)I[R]===I[R+1]?M++:(M>N?(L=[I[R]],N=M,H=0):M===N&&(L.push(I[R]),H++),M=1);return H===0?L[0]:L},p.range=function(P){return p.max(P)-p.min(P)},p.variance=function(P,R){return p.sumsqerr(P)/(P.length-(R?1:0))},p.pooledvariance=function(P){return P.reduce((function(R,T){return R+p.sumsqerr(T)}),0)/(P.reduce((function(R,T){return R+T.length}),0)-P.length)},p.deviation=function(P){for(var R=p.mean(P),T=P.length,I=new Array(T),M=0;M<T;M++)I[M]=P[M]-R;return I},p.stdev=function(P,R){return v.sqrt(p.variance(P,R))},p.pooledstdev=function(P){return v.sqrt(p.pooledvariance(P))},p.meandev=function(P){for(var R=p.mean(P),T=[],I=P.length-1;I>=0;I--)T.push(v.abs(P[I]-R));return p.mean(T)},p.meddev=function(P){for(var R=p.median(P),T=[],I=P.length-1;I>=0;I--)T.push(v.abs(P[I]-R));return p.median(T)},p.coeffvar=function(P){return p.stdev(P)/p.mean(P)},p.quartiles=function(P){var R=P.length,T=P.slice().sort(E);return[T[v.round(R/4)-1],T[v.round(R/2)-1],T[v.round(3*R/4)-1]]},p.quantiles=function(P,R,T,I){var M,N,H,L,A,k=P.slice().sort(E),W=[R.length],G=P.length;for(T===void 0&&(T=.375),I===void 0&&(I=.375),M=0;M<R.length;M++)H=G*(N=R[M])+(T+N*(1-T-I)),L=v.floor(C(H,1,G-1)),A=C(H-L,0,1),W[M]=(1-A)*k[L-1]+A*k[L];return W},p.percentile=function(P,R,T){var I=P.slice().sort(E),M=R*(I.length+(T?1:-1))+(T?0:1),N=parseInt(M),H=M-N;return N+1<I.length?I[N-1]+H*(I[N]-I[N-1]):I[N-1]},p.percentileOfScore=function(P,R,T){var I,M,N=0,H=P.length,L=!1;for(T==="strict"&&(L=!0),M=0;M<H;M++)I=P[M],(L&&I<R||!L&&I<=R)&&N++;return N/H},p.histogram=function(P,R){R=R||4;var T,I=p.min(P),M=(p.max(P)-I)/R,N=P.length,H=[];for(T=0;T<R;T++)H[T]=0;for(T=0;T<N;T++)H[v.min(v.floor((P[T]-I)/M),R-1)]+=1;return H},p.covariance=function(P,R){var T,I=p.mean(P),M=p.mean(R),N=P.length,H=new Array(N);for(T=0;T<N;T++)H[T]=(P[T]-I)*(R[T]-M);return p.sum(H)/(N-1)},p.corrcoeff=function(P,R){return p.covariance(P,R)/p.stdev(P,1)/p.stdev(R,1)},p.spearmancoeff=function(P,R){return P=p.rank(P),R=p.rank(R),p.corrcoeff(P,R)},p.stanMoment=function(P,R){for(var T=p.mean(P),I=p.stdev(P),M=P.length,N=0,H=0;H<M;H++)N+=v.pow((P[H]-T)/I,R);return N/P.length},p.skewness=function(P){return p.stanMoment(P,3)},p.kurtosis=function(P){return p.stanMoment(P,4)-3};var b=p.prototype;(function(P){for(var R=0;R<P.length;R++)(function(T){b[T]=function(I,M){var N=[],H=0,L=this;if(w(I)&&(M=I,I=!1),M)return setTimeout((function(){M.call(L,b[T].call(L,I))})),this;if(this.length>1){for(L=I===!0?this:this.transpose();H<L.length;H++)N[H]=p[T](L[H]);return N}return p[T](this[0],I)}})(P[R])})("cumsum cumprod".split(" ")),(function(P){for(var R=0;R<P.length;R++)(function(T){b[T]=function(I,M){var N=[],H=0,L=this;if(w(I)&&(M=I,I=!1),M)return setTimeout((function(){M.call(L,b[T].call(L,I))})),this;if(this.length>1){for(T!=="sumrow"&&(L=I===!0?this:this.transpose());H<L.length;H++)N[H]=p[T](L[H]);return I===!0?p[T](p.utils.toVector(N)):N}return p[T](this[0],I)}})(P[R])})("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),(function(P){for(var R=0;R<P.length;R++)(function(T){b[T]=function(){var I,M=[],N=0,H=this,L=Array.prototype.slice.call(arguments);if(w(L[L.length-1])){I=L[L.length-1];var A=L.slice(0,L.length-1);return setTimeout((function(){I.call(H,b[T].apply(H,A))})),this}I=void 0;var k=function(W){return p[T].apply(H,[W].concat(L))};if(this.length>1){for(H=H.transpose();N<H.length;N++)M[N]=k(H[N]);return M}return k(this[0])}})(P[R])})("quantiles percentileOfScore".split(" "))})(m,Math),(function(p,v){p.gammaln=function(w){var E,C,b,P=0,R=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],T=1.000000000190015;for(b=(C=E=w)+5.5,b-=(E+.5)*v.log(b);P<6;P++)T+=R[P]/++C;return v.log(2.5066282746310007*T/E)-b},p.loggam=function(w){var E,C,b,P,R,T,I,M=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(E=w,I=0,w==1||w==2)return 0;for(w<=7&&(E=w+(I=v.floor(7-w))),C=1/(E*E),b=2*v.PI,R=M[9],T=8;T>=0;T--)R*=C,R+=M[T];if(P=R/E+.5*v.log(b)+(E-.5)*v.log(E)-E,w<=7)for(T=1;T<=I;T++)P-=v.log(E-1),E-=1;return P},p.gammafn=function(w){var E,C,b,P,R=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],T=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],I=!1,M=0,N=0,H=0,L=w;if(w>171.6243769536076)return 1/0;if(L<=0){if(!(P=L%1+36e-17))return 1/0;I=(1&L?-1:1)*v.PI/v.sin(v.PI*P),L=1-L}for(b=L,C=L<1?L++:(L-=M=(0|L)-1)-1,E=0;E<8;++E)H=(H+R[E])*C,N=N*C+T[E];if(P=H/N+1,b<L)P/=b;else if(b>L)for(E=0;E<M;++E)P*=L,L++;return I&&(P=I/P),P},p.gammap=function(w,E){return p.lowRegGamma(w,E)*p.gammafn(w)},p.lowRegGamma=function(w,E){var C,b=p.gammaln(w),P=w,R=1/w,T=R,I=E+1-w,M=1/1e-30,N=1/I,H=N,L=1,A=-~(8.5*v.log(w>=1?w:1/w)+.4*w+17);if(E<0||w<=0)return NaN;if(E<w+1){for(;L<=A;L++)R+=T*=E/++P;return R*v.exp(-E+w*v.log(E)-b)}for(;L<=A;L++)H*=(N=1/(N=(C=-L*(L-w))*N+(I+=2)))*(M=I+C/M);return 1-H*v.exp(-E+w*v.log(E)-b)},p.factorialln=function(w){return w<0?NaN:p.gammaln(w+1)},p.factorial=function(w){return w<0?NaN:p.gammafn(w+1)},p.combination=function(w,E){return w>170||E>170?v.exp(p.combinationln(w,E)):p.factorial(w)/p.factorial(E)/p.factorial(w-E)},p.combinationln=function(w,E){return p.factorialln(w)-p.factorialln(E)-p.factorialln(w-E)},p.permutation=function(w,E){return p.factorial(w)/p.factorial(w-E)},p.betafn=function(w,E){if(!(w<=0||E<=0))return w+E>170?v.exp(p.betaln(w,E)):p.gammafn(w)*p.gammafn(E)/p.gammafn(w+E)},p.betaln=function(w,E){return p.gammaln(w)+p.gammaln(E)-p.gammaln(w+E)},p.betacf=function(w,E,C){var b,P,R,T,I=1e-30,M=1,N=E+C,H=E+1,L=E-1,A=1,k=1-N*w/H;for(v.abs(k)<I&&(k=I),T=k=1/k;M<=100&&(k=1+(P=M*(C-M)*w/((L+(b=2*M))*(E+b)))*k,v.abs(k)<I&&(k=I),A=1+P/A,v.abs(A)<I&&(A=I),T*=(k=1/k)*A,k=1+(P=-(E+M)*(N+M)*w/((E+b)*(H+b)))*k,v.abs(k)<I&&(k=I),A=1+P/A,v.abs(A)<I&&(A=I),T*=R=(k=1/k)*A,!(v.abs(R-1)<3e-7));M++);return T},p.gammapinv=function(w,E){var C,b,P,R,T,I,M=0,N=E-1,H=p.gammaln(E);if(w>=1)return v.max(100,E+100*v.sqrt(E));if(w<=0)return 0;for(E>1?(T=v.log(N),I=v.exp(N*(T-1)-H),R=w<.5?w:1-w,C=(2.30753+.27061*(b=v.sqrt(-2*v.log(R))))/(1+b*(.99229+.04481*b))-b,w<.5&&(C=-C),C=v.max(.001,E*v.pow(1-1/(9*E)-C/(3*v.sqrt(E)),3))):C=w<(b=1-E*(.253+.12*E))?v.pow(w/b,1/E):1-v.log(1-(w-b)/(1-b));M<12;M++){if(C<=0)return 0;if((C-=b=(P=(p.lowRegGamma(E,C)-w)/(b=E>1?I*v.exp(-(C-N)+N*(v.log(C)-T)):v.exp(-C+N*v.log(C)-H)))/(1-.5*v.min(1,P*((E-1)/C-1))))<=0&&(C=.5*(C+b)),v.abs(b)<1e-8*C)break}return C},p.erf=function(w){var E,C,b,P,R=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],T=R.length-1,I=!1,M=0,N=0;for(w<0&&(w=-w,I=!0),C=4*(E=2/(2+w))-2;T>0;T--)b=M,M=C*M-N+R[T],N=b;return P=E*v.exp(-w*w+.5*(R[0]+C*M)-N),I?P-1:1-P},p.erfc=function(w){return 1-p.erf(w)},p.erfcinv=function(w){var E,C,b,P,R=0;if(w>=2)return-100;if(w<=0)return 100;for(P=w<1?w:2-w,E=-.70711*((2.30753+.27061*(b=v.sqrt(-2*v.log(P/2))))/(1+b*(.99229+.04481*b))-b);R<2;R++)E+=(C=p.erfc(E)-P)/(1.1283791670955126*v.exp(-E*E)-E*C);return w<1?E:-E},p.ibetainv=function(w,E,C){var b,P,R,T,I,M,N,H,L,A,k=E-1,W=C-1,G=0;if(w<=0)return 0;if(w>=1)return 1;for(E>=1&&C>=1?(R=w<.5?w:1-w,M=(2.30753+.27061*(T=v.sqrt(-2*v.log(R))))/(1+T*(.99229+.04481*T))-T,w<.5&&(M=-M),N=(M*M-3)/6,H=2/(1/(2*E-1)+1/(2*C-1)),L=M*v.sqrt(N+H)/H-(1/(2*C-1)-1/(2*E-1))*(N+.8333333333333334-2/(3*H)),M=E/(E+C*v.exp(2*L))):(b=v.log(E/(E+C)),P=v.log(C/(E+C)),M=w<(T=v.exp(E*b)/E)/(L=T+(I=v.exp(C*P)/C))?v.pow(E*L*w,1/E):1-v.pow(C*L*(1-w),1/C)),A=-p.gammaln(E)-p.gammaln(C)+p.gammaln(E+C);G<10;G++){if(M===0||M===1)return M;if((M-=T=(I=(p.ibeta(M,E,C)-w)/(T=v.exp(k*v.log(M)+W*v.log(1-M)+A)))/(1-.5*v.min(1,I*(k/M-W/(1-M)))))<=0&&(M=.5*(M+T)),M>=1&&(M=.5*(M+T+1)),v.abs(T)<1e-8*M&&G>0)break}return M},p.ibeta=function(w,E,C){var b=w===0||w===1?0:v.exp(p.gammaln(E+C)-p.gammaln(E)-p.gammaln(C)+E*v.log(w)+C*v.log(1-w));return!(w<0||w>1)&&(w<(E+1)/(E+C+2)?b*p.betacf(w,E,C)/E:1-b*p.betacf(1-w,C,E)/C)},p.randn=function(w,E){var C,b,P,R,T;if(E||(E=w),w)return p.create(w,E,(function(){return p.randn()}));do C=p._random_fn(),b=1.7156*(p._random_fn()-.5),T=(P=C-.449871)*P+(R=v.abs(b)+.386595)*(.196*R-.25472*P);while(T>.27597&&(T>.27846||b*b>-4*v.log(C)*C*C));return b/C},p.randg=function(w,E,C){var b,P,R,T,I,M,N=w;if(C||(C=E),w||(w=1),E)return(M=p.zeros(E,C)).alter((function(){return p.randg(w)})),M;w<1&&(w+=1),b=w-.3333333333333333,P=1/v.sqrt(9*b);do{do T=1+P*(I=p.randn());while(T<=0);T*=T*T,R=p._random_fn()}while(R>1-.331*v.pow(I,4)&&v.log(R)>.5*I*I+b*(1-T+v.log(T)));if(w==N)return b*T;do R=p._random_fn();while(R===0);return v.pow(R,1/N)*b*T},(function(w){for(var E=0;E<w.length;E++)(function(C){p.fn[C]=function(){return p(p.map(this,(function(b){return p[C](b)})))}})(w[E])})("gammaln gammafn factorial factorialln".split(" ")),(function(w){for(var E=0;E<w.length;E++)(function(C){p.fn[C]=function(){return p(p[C].apply(null,arguments))}})(w[E])})("randn".split(" "))})(m,Math),(function(p,v){function w(C,b,P,R){for(var T,I=0,M=1,N=1,H=1,L=0,A=0;v.abs((N-A)/N)>R;)A=N,M=H+(T=-(b+L)*(b+P+L)*C/(b+2*L)/(b+2*L+1))*M,N=(I=N+T*I)+(T=(L+=1)*(P-L)*C/(b+2*L-1)/(b+2*L))*N,I/=H=M+T*H,M/=H,N/=H,H=1;return N/b}function E(C,b,P){var R=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],T=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],I=.5*C;if(I>=8)return 1;var M,N=2*p.normal.cdf(I,0,1,1,0)-1;N=N>=v.exp(-50/P)?v.pow(N,P):0;for(var H=I,L=(8-I)/(M=C>3?2:3),A=H+L,k=0,W=P-1,G=1;G<=M;G++){for(var oe=0,ae=.5*(A+H),X=.5*(A-H),le=1;le<=12;le++){var ye,pe=ae+X*(6<le?R[(ye=12-le+1)-1]:-R[(ye=le)-1]),he=pe*pe;if(he>60)break;var Me=2*p.normal.cdf(pe,0,1,1,0)*.5-2*p.normal.cdf(pe,C,1,1,0)*.5;Me>=v.exp(-30/W)&&(oe+=Me=T[ye-1]*v.exp(-.5*he)*v.pow(Me,W))}k+=oe*=2*X*P/v.sqrt(2*v.PI),H=A,A+=L}return(N+=k)<=v.exp(-30/b)?0:(N=v.pow(N,b))>=1?1:N}(function(C){for(var b=0;b<C.length;b++)(function(P){p[P]=function R(T,I,M){return this instanceof R?(this._a=T,this._b=I,this._c=M,this):new R(T,I,M)},p.fn[P]=function(R,T,I){var M=p[P](R,T,I);return M.data=this,M},p[P].prototype.sample=function(R){var T=this._a,I=this._b,M=this._c;return R?p.alter(R,(function(){return p[P].sample(T,I,M)})):p[P].sample(T,I,M)},(function(R){for(var T=0;T<R.length;T++)(function(I){p[P].prototype[I]=function(M){var N=this._a,H=this._b,L=this._c;return M||M===0||(M=this.data),typeof M!="number"?p.fn.map.call(M,(function(A){return p[P][I](A,N,H,L)})):p[P][I](M,N,H,L)}})(R[T])})("pdf cdf inv".split(" ")),(function(R){for(var T=0;T<R.length;T++)(function(I){p[P].prototype[I]=function(){return p[P][I](this._a,this._b,this._c)}})(R[T])})("mean median mode variance".split(" "))})(C[b])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),p.extend(p.beta,{pdf:function(C,b,P){return C>1||C<0?0:b==1&&P==1?1:b<512&&P<512?v.pow(C,b-1)*v.pow(1-C,P-1)/p.betafn(b,P):v.exp((b-1)*v.log(C)+(P-1)*v.log(1-C)-p.betaln(b,P))},cdf:function(C,b,P){return C>1||C<0?1*(C>1):p.ibeta(C,b,P)},inv:function(C,b,P){return p.ibetainv(C,b,P)},mean:function(C,b){return C/(C+b)},median:function(C,b){return p.ibetainv(.5,C,b)},mode:function(C,b){return(C-1)/(C+b-2)},sample:function(C,b){var P=p.randg(C);return P/(P+p.randg(b))},variance:function(C,b){return C*b/(v.pow(C+b,2)*(C+b+1))}}),p.extend(p.centralF,{pdf:function(C,b,P){var R;return C<0?0:b<=2?C===0&&b<2?1/0:C===0&&b===2?1:1/p.betafn(b/2,P/2)*v.pow(b/P,b/2)*v.pow(C,b/2-1)*v.pow(1+b/P*C,-(b+P)/2):(R=b*C/(P+C*b),b*(P/(P+C*b))/2*p.binomial.pdf((b-2)/2,(b+P-2)/2,R))},cdf:function(C,b,P){return C<0?0:p.ibeta(b*C/(b*C+P),b/2,P/2)},inv:function(C,b,P){return P/(b*(1/p.ibetainv(C,b/2,P/2)-1))},mean:function(C,b){return b>2?b/(b-2):void 0},mode:function(C,b){return C>2?b*(C-2)/(C*(b+2)):void 0},sample:function(C,b){return 2*p.randg(C/2)/C/(2*p.randg(b/2)/b)},variance:function(C,b){if(!(b<=4))return 2*b*b*(C+b-2)/(C*(b-2)*(b-2)*(b-4))}}),p.extend(p.cauchy,{pdf:function(C,b,P){return P<0?0:P/(v.pow(C-b,2)+v.pow(P,2))/v.PI},cdf:function(C,b,P){return v.atan((C-b)/P)/v.PI+.5},inv:function(C,b,P){return b+P*v.tan(v.PI*(C-.5))},median:function(C){return C},mode:function(C){return C},sample:function(C,b){return p.randn()*v.sqrt(1/(2*p.randg(.5)))*b+C}}),p.extend(p.chisquare,{pdf:function(C,b){return C<0?0:C===0&&b===2?.5:v.exp((b/2-1)*v.log(C)-C/2-b/2*v.log(2)-p.gammaln(b/2))},cdf:function(C,b){return C<0?0:p.lowRegGamma(b/2,C/2)},inv:function(C,b){return 2*p.gammapinv(C,.5*b)},mean:function(C){return C},median:function(C){return C*v.pow(1-2/(9*C),3)},mode:function(C){return C-2>0?C-2:0},sample:function(C){return 2*p.randg(C/2)},variance:function(C){return 2*C}}),p.extend(p.exponential,{pdf:function(C,b){return C<0?0:b*v.exp(-b*C)},cdf:function(C,b){return C<0?0:1-v.exp(-b*C)},inv:function(C,b){return-v.log(1-C)/b},mean:function(C){return 1/C},median:function(C){return 1/C*v.log(2)},mode:function(){return 0},sample:function(C){return-1/C*v.log(p._random_fn())},variance:function(C){return v.pow(C,-2)}}),p.extend(p.gamma,{pdf:function(C,b,P){return C<0?0:C===0&&b===1?1/P:v.exp((b-1)*v.log(C)-C/P-p.gammaln(b)-b*v.log(P))},cdf:function(C,b,P){return C<0?0:p.lowRegGamma(b,C/P)},inv:function(C,b,P){return p.gammapinv(C,b)*P},mean:function(C,b){return C*b},mode:function(C,b){if(C>1)return(C-1)*b},sample:function(C,b){return p.randg(C)*b},variance:function(C,b){return C*b*b}}),p.extend(p.invgamma,{pdf:function(C,b,P){return C<=0?0:v.exp(-(b+1)*v.log(C)-P/C-p.gammaln(b)+b*v.log(P))},cdf:function(C,b,P){return C<=0?0:1-p.lowRegGamma(b,P/C)},inv:function(C,b,P){return P/p.gammapinv(1-C,b)},mean:function(C,b){return C>1?b/(C-1):void 0},mode:function(C,b){return b/(C+1)},sample:function(C,b){return b/p.randg(C)},variance:function(C,b){if(!(C<=2))return b*b/((C-1)*(C-1)*(C-2))}}),p.extend(p.kumaraswamy,{pdf:function(C,b,P){return C===0&&b===1?P:C===1&&P===1?b:v.exp(v.log(b)+v.log(P)+(b-1)*v.log(C)+(P-1)*v.log(1-v.pow(C,b)))},cdf:function(C,b,P){return C<0?0:C>1?1:1-v.pow(1-v.pow(C,b),P)},inv:function(C,b,P){return v.pow(1-v.pow(1-C,1/P),1/b)},mean:function(C,b){return b*p.gammafn(1+1/C)*p.gammafn(b)/p.gammafn(1+1/C+b)},median:function(C,b){return v.pow(1-v.pow(2,-1/b),1/C)},mode:function(C,b){if(C>=1&&b>=1&&C!==1&&b!==1)return v.pow((C-1)/(C*b-1),1/C)},variance:function(){throw new Error("variance not yet implemented")}}),p.extend(p.lognormal,{pdf:function(C,b,P){return C<=0?0:v.exp(-v.log(C)-.5*v.log(2*v.PI)-v.log(P)-v.pow(v.log(C)-b,2)/(2*P*P))},cdf:function(C,b,P){return C<0?0:.5+.5*p.erf((v.log(C)-b)/v.sqrt(2*P*P))},inv:function(C,b,P){return v.exp(-1.4142135623730951*P*p.erfcinv(2*C)+b)},mean:function(C,b){return v.exp(C+b*b/2)},median:function(C){return v.exp(C)},mode:function(C,b){return v.exp(C-b*b)},sample:function(C,b){return v.exp(p.randn()*b+C)},variance:function(C,b){return(v.exp(b*b)-1)*v.exp(2*C+b*b)}}),p.extend(p.noncentralt,{pdf:function(C,b,P){return v.abs(P)<1e-14?p.studentt.pdf(C,b):v.abs(C)<1e-14?v.exp(p.gammaln((b+1)/2)-P*P/2-.5*v.log(v.PI*b)-p.gammaln(b/2)):b/C*(p.noncentralt.cdf(C*v.sqrt(1+2/b),b+2,P)-p.noncentralt.cdf(C,b,P))},cdf:function(C,b,P){var R=1e-14;if(v.abs(P)<R)return p.studentt.cdf(C,b);var T=!1;C<0&&(T=!0,P=-P);for(var I=p.normal.cdf(-P,0,1),M=R+1,N=M,H=C*C/(C*C+b),L=0,A=v.exp(-P*P/2),k=v.exp(-P*P/2-.5*v.log(2)-p.gammaln(1.5))*P;L<200||N>R||M>R;)N=M,L>0&&(A*=P*P/(2*L),k*=P*P/(2*(L+.5))),I+=.5*(M=A*p.beta.cdf(H,L+.5,b/2)+k*p.beta.cdf(H,L+1,b/2)),L++;return T?1-I:I}}),p.extend(p.normal,{pdf:function(C,b,P){return v.exp(-.5*v.log(2*v.PI)-v.log(P)-v.pow(C-b,2)/(2*P*P))},cdf:function(C,b,P){return .5*(1+p.erf((C-b)/v.sqrt(2*P*P)))},inv:function(C,b,P){return-1.4142135623730951*P*p.erfcinv(2*C)+b},mean:function(C){return C},median:function(C){return C},mode:function(C){return C},sample:function(C,b){return p.randn()*b+C},variance:function(C,b){return b*b}}),p.extend(p.pareto,{pdf:function(C,b,P){return C<b?0:P*v.pow(b,P)/v.pow(C,P+1)},cdf:function(C,b,P){return C<b?0:1-v.pow(b/C,P)},inv:function(C,b,P){return b/v.pow(1-C,1/P)},mean:function(C,b){if(!(b<=1))return b*v.pow(C,b)/(b-1)},median:function(C,b){return C*(b*v.SQRT2)},mode:function(C){return C},variance:function(C,b){if(!(b<=2))return C*C*b/(v.pow(b-1,2)*(b-2))}}),p.extend(p.studentt,{pdf:function(C,b){return b=b>1e100?1e100:b,1/(v.sqrt(b)*p.betafn(.5,b/2))*v.pow(1+C*C/b,-(b+1)/2)},cdf:function(C,b){var P=b/2;return p.ibeta((C+v.sqrt(C*C+b))/(2*v.sqrt(C*C+b)),P,P)},inv:function(C,b){var P=p.ibetainv(2*v.min(C,1-C),.5*b,.5);return P=v.sqrt(b*(1-P)/P),C>.5?P:-P},mean:function(C){return C>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(C){return p.randn()*v.sqrt(C/(2*p.randg(C/2)))},variance:function(C){return C>2?C/(C-2):C>1?1/0:void 0}}),p.extend(p.weibull,{pdf:function(C,b,P){return C<0||b<0||P<0?0:P/b*v.pow(C/b,P-1)*v.exp(-v.pow(C/b,P))},cdf:function(C,b,P){return C<0?0:1-v.exp(-v.pow(C/b,P))},inv:function(C,b,P){return b*v.pow(-v.log(1-C),1/P)},mean:function(C,b){return C*p.gammafn(1+1/b)},median:function(C,b){return C*v.pow(v.log(2),1/b)},mode:function(C,b){return b<=1?0:C*v.pow((b-1)/b,1/b)},sample:function(C,b){return C*v.pow(-v.log(p._random_fn()),1/b)},variance:function(C,b){return C*C*p.gammafn(1+2/b)-v.pow(p.weibull.mean(C,b),2)}}),p.extend(p.uniform,{pdf:function(C,b,P){return C<b||C>P?0:1/(P-b)},cdf:function(C,b,P){return C<b?0:C<P?(C-b)/(P-b):1},inv:function(C,b,P){return b+C*(P-b)},mean:function(C,b){return .5*(C+b)},median:function(C,b){return p.mean(C,b)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(C,b){return C/2+b/2+(b/2-C/2)*(2*p._random_fn()-1)},variance:function(C,b){return v.pow(b-C,2)/12}}),p.extend(p.binomial,{pdf:function(C,b,P){return P===0||P===1?b*P===C?1:0:p.combination(b,C)*v.pow(P,C)*v.pow(1-P,b-C)},cdf:function(C,b,P){var R,T=1e-10;if(C<0)return 0;if(C>=b)return 1;if(P<0||P>1||b<=0)return NaN;var I=P,M=(C=v.floor(C))+1,N=b-C,H=M+N,L=v.exp(p.gammaln(H)-p.gammaln(N)-p.gammaln(M)+M*v.log(I)+N*v.log(1-I));return R=I<(M+1)/(H+2)?L*w(I,M,N,T):1-L*w(1-I,N,M,T),v.round(1/T*(1-R))/(1/T)}}),p.extend(p.negbin,{pdf:function(C,b,P){return C===C>>>0&&(C<0?0:p.combination(C+b-1,b-1)*v.pow(1-P,C)*v.pow(P,b))},cdf:function(C,b,P){var R=0,T=0;if(C<0)return 0;for(;T<=C;T++)R+=p.negbin.pdf(T,b,P);return R}}),p.extend(p.hypgeom,{pdf:function(C,b,P,R){if(C!=C|0)return!1;if(C<0||C<P-(b-R)||C>R||C>P)return 0;if(2*P>b)return 2*R>b?p.hypgeom.pdf(b-P-R+C,b,b-P,b-R):p.hypgeom.pdf(R-C,b,b-P,R);if(2*R>b)return p.hypgeom.pdf(P-C,b,P,b-R);if(P<R)return p.hypgeom.pdf(C,b,R,P);for(var T=1,I=0,M=0;M<C;M++){for(;T>1&&I<R;)T*=1-P/(b-I),I++;T*=(R-M)*(P-M)/((M+1)*(b-P-R+M+1))}for(;I<R;I++)T*=1-P/(b-I);return v.min(1,v.max(0,T))},cdf:function(C,b,P,R){if(C<0||C<P-(b-R))return 0;if(C>=R||C>=P)return 1;if(2*P>b)return 2*R>b?p.hypgeom.cdf(b-P-R+C,b,b-P,b-R):1-p.hypgeom.cdf(R-C-1,b,b-P,R);if(2*R>b)return 1-p.hypgeom.cdf(P-C-1,b,P,b-R);if(P<R)return p.hypgeom.cdf(C,b,R,P);for(var T=1,I=1,M=0,N=0;N<C;N++){for(;T>1&&M<R;){var H=1-P/(b-M);I*=H,T*=H,M++}T+=I*=(R-N)*(P-N)/((N+1)*(b-P-R+N+1))}for(;M<R;M++)T*=1-P/(b-M);return v.min(1,v.max(0,T))}}),p.extend(p.poisson,{pdf:function(C,b){return b<0||C%1!=0||C<0?0:v.pow(b,C)*v.exp(-b)/p.factorial(C)},cdf:function(C,b){var P=[],R=0;if(C<0)return 0;for(;R<=C;R++)P.push(p.poisson.pdf(R,b));return p.sum(P)},mean:function(C){return C},variance:function(C){return C},sampleSmall:function(C){var b=1,P=0,R=v.exp(-C);do P++,b*=p._random_fn();while(b>R);return P-1},sampleLarge:function(C){var b,P,R,T,I,M,N,H,L,A,k=C;for(T=v.sqrt(k),I=v.log(k),M=.02483*(N=.931+2.53*T)-.059,H=1.1239+1.1328/(N-3.4),L=.9277-3.6224/(N-2);;)if(P=v.random()-.5,R=v.random(),A=.5-v.abs(P),b=v.floor((2*M/A+N)*P+k+.43),A>=.07&&R<=L||!(b<0||A<.013&&R>A)&&v.log(R)+v.log(H)-v.log(M/(A*A)+N)<=b*I-k-p.loggam(b+1))return b},sample:function(C){return C<10?this.sampleSmall(C):this.sampleLarge(C)}}),p.extend(p.triangular,{pdf:function(C,b,P,R){return P<=b||R<b||R>P?NaN:C<b||C>P?0:C<R?2*(C-b)/((P-b)*(R-b)):C===R?2/(P-b):2*(P-C)/((P-b)*(P-R))},cdf:function(C,b,P,R){return P<=b||R<b||R>P?NaN:C<=b?0:C>=P?1:C<=R?v.pow(C-b,2)/((P-b)*(R-b)):1-v.pow(P-C,2)/((P-b)*(P-R))},inv:function(C,b,P,R){return P<=b||R<b||R>P?NaN:C<=(R-b)/(P-b)?b+(P-b)*v.sqrt(C*((R-b)/(P-b))):b+(P-b)*(1-v.sqrt((1-C)*(1-(R-b)/(P-b))))},mean:function(C,b,P){return(C+b+P)/3},median:function(C,b,P){return P<=(C+b)/2?b-v.sqrt((b-C)*(b-P))/v.sqrt(2):P>(C+b)/2?C+v.sqrt((b-C)*(P-C))/v.sqrt(2):void 0},mode:function(C,b,P){return P},sample:function(C,b,P){var R=p._random_fn();return R<(P-C)/(b-C)?C+v.sqrt(R*(b-C)*(P-C)):b-v.sqrt((1-R)*(b-C)*(b-P))},variance:function(C,b,P){return(C*C+b*b+P*P-C*b-C*P-b*P)/18}}),p.extend(p.arcsine,{pdf:function(C,b,P){return P<=b?NaN:C<=b||C>=P?0:2/v.PI*v.pow(v.pow(P-b,2)-v.pow(2*C-b-P,2),-.5)},cdf:function(C,b,P){return C<b?0:C<P?2/v.PI*v.asin(v.sqrt((C-b)/(P-b))):1},inv:function(C,b,P){return b+(.5-.5*v.cos(v.PI*C))*(P-b)},mean:function(C,b){return b<=C?NaN:(C+b)/2},median:function(C,b){return b<=C?NaN:(C+b)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(C,b){return(C+b)/2+(b-C)/2*v.sin(2*v.PI*p.uniform.sample(0,1))},variance:function(C,b){return b<=C?NaN:v.pow(b-C,2)/8}}),p.extend(p.laplace,{pdf:function(C,b,P){return P<=0?0:v.exp(-v.abs(C-b)/P)/(2*P)},cdf:function(C,b,P){return P<=0?0:C<b?.5*v.exp((C-b)/P):1-.5*v.exp(-(C-b)/P)},mean:function(C){return C},median:function(C){return C},mode:function(C){return C},variance:function(C,b){return 2*b*b},sample:function(C,b){var P,R=p._random_fn()-.5;return C-b*((P=R)/v.abs(P))*v.log(1-2*v.abs(R))}}),p.extend(p.tukey,{cdf:function(C,b,P){var R=b,T=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],I=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(C<=0)return 0;if(P<2||R<2)return NaN;if(!Number.isFinite(C))return 1;if(P>25e3)return E(C,1,R);var M,N=.5*P,H=N*v.log(P)-P*v.log(2)-p.gammaln(N),L=N-1,A=.25*P;M=P<=100?1:P<=800?.5:P<=5e3?.25:.125,H+=v.log(M);for(var k=0,W=1;W<=50;W++){for(var G=0,oe=(2*W-1)*M,ae=1;ae<=16;ae++){var X,le;8<ae?(X=ae-8-1,le=H+L*v.log(oe+T[X]*M)-(T[X]*M+oe)*A):(X=ae-1,le=H+L*v.log(oe-T[X]*M)+(T[X]*M-oe)*A),le>=-30&&(G+=E(8<ae?C*v.sqrt(.5*(T[X]*M+oe)):C*v.sqrt(.5*(-T[X]*M+oe)),1,R)*I[X]*v.exp(le))}if(W*M>=1&&G<=1e-14)break;k+=G}if(G>1e-14)throw new Error("tukey.cdf failed to converge");return k>1&&(k=1),k},inv:function(C,b,P){if(P<2||b<2)return NaN;if(C<0||C>1)return NaN;if(C===0)return 0;if(C===1)return 1/0;var R,T=(function(L,A,k){var W=.5-.5*L,G=v.sqrt(v.log(1/(W*W))),oe=G+((((-453642210148e-16*G-.204231210125)*G-.342242088547)*G-1)*G+.322232421088)/((((.0038560700634*G+.10353775285)*G+.531103462366)*G+.588581570495)*G+.099348462606);k<120&&(oe+=(oe*oe*oe+oe)/k/4);var ae=.8832-.2368*oe;return k<120&&(ae+=-1.214/k+1.208*oe/k),oe*(ae*v.log(A-1)+1.4142)})(C,b,P),I=p.tukey.cdf(T,b,P)-C;R=I>0?v.max(0,T-1):T+1;for(var M,N=p.tukey.cdf(R,b,P)-C,H=1;H<50;H++)if(M=R-N*(R-T)/(N-I),I=N,T=R,M<0&&(M=0,N=-C),N=p.tukey.cdf(M,b,P)-C,R=M,v.abs(R-T)<1e-4)return M;throw new Error("tukey.inv failed to converge")}})})(m,Math),(function(p,v){var w,E,C=Array.prototype.push,b=p.utils.isArray;function P(R){return b(R)||R instanceof p}p.extend({add:function(R,T){return P(T)?(P(T[0])||(T=[T]),p.map(R,(function(I,M,N){return I+T[M][N]}))):p.map(R,(function(I){return I+T}))},subtract:function(R,T){return P(T)?(P(T[0])||(T=[T]),p.map(R,(function(I,M,N){return I-T[M][N]||0}))):p.map(R,(function(I){return I-T}))},divide:function(R,T){return P(T)?(P(T[0])||(T=[T]),p.multiply(R,p.inv(T))):p.map(R,(function(I){return I/T}))},multiply:function(R,T){var I,M,N,H,L,A,k,W;if(R.length===void 0&&T.length===void 0)return R*T;if(L=R.length,A=R[0].length,k=p.zeros(L,N=P(T)?T[0].length:A),W=0,P(T)){for(;W<N;W++)for(I=0;I<L;I++){for(H=0,M=0;M<A;M++)H+=R[I][M]*T[M][W];k[I][W]=H}return L===1&&W===1?k[0][0]:k}return p.map(R,(function(G){return G*T}))},outer:function(R,T){return p.multiply(R.map((function(I){return[I]})),[T])},dot:function(R,T){P(R[0])||(R=[R]),P(T[0])||(T=[T]);for(var I,M,N=R[0].length===1&&R.length!==1?p.transpose(R):R,H=T[0].length===1&&T.length!==1?p.transpose(T):T,L=[],A=0,k=N.length,W=N[0].length;A<k;A++){for(L[A]=[],I=0,M=0;M<W;M++)I+=N[A][M]*H[A][M];L[A]=I}return L.length===1?L[0]:L},pow:function(R,T){return p.map(R,(function(I){return v.pow(I,T)}))},exp:function(R){return p.map(R,(function(T){return v.exp(T)}))},log:function(R){return p.map(R,(function(T){return v.log(T)}))},abs:function(R){return p.map(R,(function(T){return v.abs(T)}))},norm:function(R,T){var I=0,M=0;for(isNaN(T)&&(T=2),P(R[0])&&(R=R[0]);M<R.length;M++)I+=v.pow(v.abs(R[M]),T);return v.pow(I,1/T)},angle:function(R,T){return v.acos(p.dot(R,T)/(p.norm(R)*p.norm(T)))},aug:function(R,T){var I,M=[];for(I=0;I<R.length;I++)M.push(R[I].slice());for(I=0;I<M.length;I++)C.apply(M[I],T[I]);return M},inv:function(R){for(var T,I=R.length,M=R[0].length,N=p.identity(I,M),H=p.gauss_jordan(R,N),L=[],A=0;A<I;A++)for(L[A]=[],T=M;T<H[0].length;T++)L[A][T-M]=H[A][T];return L},det:function R(T){if(T.length===2)return T[0][0]*T[1][1]-T[0][1]*T[1][0];for(var I=0,M=0;M<T.length;M++){for(var N=[],H=1;H<T.length;H++){N[H-1]=[];for(var L=0;L<T.length;L++)L<M?N[H-1][L]=T[H][L]:L>M&&(N[H-1][L-1]=T[H][L])}var A=M%2?-1:1;I+=R(N)*T[0][M]*A}return I},gauss_elimination:function(R,T){var I,M,N,H,L=0,A=0,k=R.length,W=R[0].length,G=1,oe=0,ae=[];for(I=(R=p.aug(R,T))[0].length,L=0;L<k;L++){for(M=R[L][L],A=L,H=L+1;H<W;H++)M<v.abs(R[H][L])&&(M=R[H][L],A=H);if(A!=L)for(H=0;H<I;H++)N=R[L][H],R[L][H]=R[A][H],R[A][H]=N;for(A=L+1;A<k;A++)for(G=R[A][L]/R[L][L],H=L;H<I;H++)R[A][H]=R[A][H]-G*R[L][H]}for(L=k-1;L>=0;L--){for(oe=0,A=L+1;A<=k-1;A++)oe+=ae[A]*R[L][A];ae[L]=(R[L][I-1]-oe)/R[L][L]}return ae},gauss_jordan:function(R,T){var I,M,N,H=p.aug(R,T),L=H.length,A=H[0].length,k=0;for(M=0;M<L;M++){var W=M;for(N=M+1;N<L;N++)v.abs(H[N][M])>v.abs(H[W][M])&&(W=N);var G=H[M];for(H[M]=H[W],H[W]=G,N=M+1;N<L;N++)for(k=H[N][M]/H[M][M],I=M;I<A;I++)H[N][I]-=H[M][I]*k}for(M=L-1;M>=0;M--){for(k=H[M][M],N=0;N<M;N++)for(I=A-1;I>M-1;I--)H[N][I]-=H[M][I]*H[N][M]/k;for(H[M][M]/=k,I=L;I<A;I++)H[M][I]/=k}return H},triaUpSolve:function(R,T){var I,M=R[0].length,N=p.zeros(1,M)[0],H=!1;return T[0].length!=null&&(T=T.map((function(L){return L[0]})),H=!0),p.arange(M-1,-1,-1).forEach((function(L){I=p.arange(L+1,M).map((function(A){return N[A]*R[L][A]})),N[L]=(T[L]-p.sum(I))/R[L][L]})),H?N.map((function(L){return[L]})):N},triaLowSolve:function(R,T){var I,M=R[0].length,N=p.zeros(1,M)[0],H=!1;return T[0].length!=null&&(T=T.map((function(L){return L[0]})),H=!0),p.arange(M).forEach((function(L){I=p.arange(L).map((function(A){return R[L][A]*N[A]})),N[L]=(T[L]-p.sum(I))/R[L][L]})),H?N.map((function(L){return[L]})):N},lu:function(R){var T,I=R.length,M=p.identity(I),N=p.zeros(R.length,R[0].length);return p.arange(I).forEach((function(H){N[0][H]=R[0][H]})),p.arange(1,I).forEach((function(H){p.arange(H).forEach((function(L){T=p.arange(L).map((function(A){return M[H][A]*N[A][L]})),M[H][L]=(R[H][L]-p.sum(T))/N[L][L]})),p.arange(H,I).forEach((function(L){T=p.arange(H).map((function(A){return M[H][A]*N[A][L]})),N[H][L]=R[T.length][L]-p.sum(T)}))})),[M,N]},cholesky:function(R){var T,I=R.length,M=p.zeros(R.length,R[0].length);return p.arange(I).forEach((function(N){T=p.arange(N).map((function(H){return v.pow(M[N][H],2)})),M[N][N]=v.sqrt(R[N][N]-p.sum(T)),p.arange(N+1,I).forEach((function(H){T=p.arange(N).map((function(L){return M[N][L]*M[H][L]})),M[H][N]=(R[N][H]-p.sum(T))/M[N][N]}))})),M},gauss_jacobi:function(R,T,I,M){for(var N,H,L,A,k=0,W=0,G=R.length,oe=[],ae=[],X=[];k<G;k++)for(oe[k]=[],ae[k]=[],X[k]=[],W=0;W<G;W++)k>W?(oe[k][W]=R[k][W],ae[k][W]=X[k][W]=0):k<W?(ae[k][W]=R[k][W],oe[k][W]=X[k][W]=0):(X[k][W]=R[k][W],oe[k][W]=ae[k][W]=0);for(L=p.multiply(p.multiply(p.inv(X),p.add(oe,ae)),-1),H=p.multiply(p.inv(X),T),N=I,A=p.add(p.multiply(L,I),H),k=2;v.abs(p.norm(p.subtract(A,N)))>M;)N=A,A=p.add(p.multiply(L,N),H),k++;return A},gauss_seidel:function(R,T,I,M){for(var N,H,L,A,k,W=0,G=R.length,oe=[],ae=[],X=[];W<G;W++)for(oe[W]=[],ae[W]=[],X[W]=[],N=0;N<G;N++)W>N?(oe[W][N]=R[W][N],ae[W][N]=X[W][N]=0):W<N?(ae[W][N]=R[W][N],oe[W][N]=X[W][N]=0):(X[W][N]=R[W][N],oe[W][N]=ae[W][N]=0);for(A=p.multiply(p.multiply(p.inv(p.add(X,oe)),ae),-1),L=p.multiply(p.inv(p.add(X,oe)),T),H=I,k=p.add(p.multiply(A,I),L),W=2;v.abs(p.norm(p.subtract(k,H)))>M;)H=k,k=p.add(p.multiply(A,H),L),W+=1;return k},SOR:function(R,T,I,M,N){for(var H,L,A,k,W,G=0,oe=R.length,ae=[],X=[],le=[];G<oe;G++)for(ae[G]=[],X[G]=[],le[G]=[],H=0;H<oe;H++)G>H?(ae[G][H]=R[G][H],X[G][H]=le[G][H]=0):G<H?(X[G][H]=R[G][H],ae[G][H]=le[G][H]=0):(le[G][H]=R[G][H],ae[G][H]=X[G][H]=0);for(k=p.multiply(p.inv(p.add(le,p.multiply(ae,N))),p.subtract(p.multiply(le,1-N),p.multiply(X,N))),A=p.multiply(p.multiply(p.inv(p.add(le,p.multiply(ae,N))),T),N),L=I,W=p.add(p.multiply(k,I),A),G=2;v.abs(p.norm(p.subtract(W,L)))>M;)L=W,W=p.add(p.multiply(k,L),A),G++;return W},householder:function(R){for(var T,I,M,N,H=R.length,L=R[0].length,A=0,k=[],W=[];A<H-1;A++){for(T=0,N=A+1;N<L;N++)T+=R[N][A]*R[N][A];for(T=(R[A+1][A]>0?-1:1)*v.sqrt(T),I=v.sqrt((T*T-R[A+1][A]*T)/2),(k=p.zeros(H,1))[A+1][0]=(R[A+1][A]-T)/(2*I),M=A+2;M<H;M++)k[M][0]=R[M][A]/(2*I);W=p.subtract(p.identity(H,L),p.multiply(p.multiply(k,p.transpose(k)),2)),R=p.multiply(W,p.multiply(R,W))}return R},QR:(w=p.sum,E=p.arange,function(R){var T,I,M,N=R.length,H=R[0].length,L=p.zeros(H,H);for(R=p.copy(R),I=0;I<H;I++){for(L[I][I]=v.sqrt(w(E(N).map((function(A){return R[A][I]*R[A][I]})))),T=0;T<N;T++)R[T][I]=R[T][I]/L[I][I];for(M=I+1;M<H;M++)for(L[I][M]=w(E(N).map((function(A){return R[A][I]*R[A][M]}))),T=0;T<N;T++)R[T][M]=R[T][M]-R[T][I]*L[I][M]}return[R,L]}),lstsq:function(R,T){var I=!1;T[0].length===void 0&&(T=T.map((function(oe){return[oe]})),I=!0);var M=p.QR(R),N=M[0],H=M[1],L=R[0].length,A=p.slice(N,{col:{end:L}}),k=(function(oe){var ae=(oe=p.copy(oe)).length,X=p.identity(ae);return p.arange(ae-1,-1,-1).forEach((function(le){p.sliceAssign(X,{row:le},p.divide(p.slice(X,{row:le}),oe[le][le])),p.sliceAssign(oe,{row:le},p.divide(p.slice(oe,{row:le}),oe[le][le])),p.arange(le).forEach((function(ye){var pe=p.multiply(oe[ye][le],-1),he=p.slice(oe,{row:ye}),Me=p.multiply(p.slice(oe,{row:le}),pe);p.sliceAssign(oe,{row:ye},p.add(he,Me));var Qe=p.slice(X,{row:ye}),Xe=p.multiply(p.slice(X,{row:le}),pe);p.sliceAssign(X,{row:ye},p.add(Qe,Xe))}))})),X})(p.slice(H,{row:{end:L}})),W=p.transpose(A);W[0].length===void 0&&(W=[W]);var G=p.multiply(p.multiply(k,W),T);return G.length===void 0&&(G=[[G]]),I?G.map((function(oe){return oe[0]})):G},jacobi:function(R){for(var T,I,M,N,H,L,A,k=1,W=R.length,G=p.identity(W,W),oe=[];k===1;){for(H=R[0][1],M=0,N=1,T=0;T<W;T++)for(I=0;I<W;I++)T!=I&&H<v.abs(R[T][I])&&(H=v.abs(R[T][I]),M=T,N=I);for(L=R[M][M]===R[N][N]?R[M][N]>0?v.PI/4:-v.PI/4:v.atan(2*R[M][N]/(R[M][M]-R[N][N]))/2,(A=p.identity(W,W))[M][M]=v.cos(L),A[M][N]=-v.sin(L),A[N][M]=v.sin(L),A[N][N]=v.cos(L),G=p.multiply(G,A),R=p.multiply(p.multiply(p.inv(A),R),A),k=0,T=1;T<W;T++)for(I=1;I<W;I++)T!=I&&v.abs(R[T][I])>.001&&(k=1)}for(T=0;T<W;T++)oe.push(R[T][T]);return[G,oe]},rungekutta:function(R,T,I,M,N,H){var L,A,k;if(H===2)for(;M<=I;)N+=((L=T*R(M,N))+(A=T*R(M+T,N+L)))/2,M+=T;if(H===4)for(;M<=I;)N+=((L=T*R(M,N))+2*(A=T*R(M+T/2,N+L/2))+2*(k=T*R(M+T/2,N+A/2))+T*R(M+T,N+k))/6,M+=T;return N},romberg:function(R,T,I,M){for(var N,H,L,A,k,W=0,G=(I-T)/2,oe=[],ae=[],X=[];W<M/2;){for(k=R(T),L=T,A=0;L<=I;L+=G,A++)oe[A]=L;for(N=oe.length,L=1;L<N-1;L++)k+=(L%2!=0?4:2)*R(oe[L]);k=G/3*(k+R(I)),X[W]=k,G/=2,W++}for(H=X.length,N=1;H!==1;){for(L=0;L<H-1;L++)ae[L]=(v.pow(4,N)*X[L+1]-X[L])/(v.pow(4,N)-1);H=ae.length,X=ae,ae=[],N++}return X},richardson:function(R,T,I,M){function N(le,ye){for(var pe,he=0,Me=le.length;he<Me;he++)le[he]===ye&&(pe=he);return pe}for(var H,L,A,k,W,G=v.abs(I-R[N(R,I)+1]),oe=0,ae=[],X=[];M>=G;)H=N(R,I+M),L=N(R,I),ae[oe]=(T[H]-2*T[L]+T[2*L-H])/(M*M),M/=2,oe++;for(k=ae.length,A=1;k!=1;){for(W=0;W<k-1;W++)X[W]=(v.pow(4,A)*ae[W+1]-ae[W])/(v.pow(4,A)-1);k=X.length,ae=X,X=[],A++}return ae},simpson:function(R,T,I,M){for(var N,H=(I-T)/M,L=R(T),A=[],k=T,W=0,G=1;k<=I;k+=H,W++)A[W]=k;for(N=A.length;G<N-1;G++)L+=(G%2!=0?4:2)*R(A[G]);return H/3*(L+R(I))},hermite:function(R,T,I,M){for(var N,H=R.length,L=0,A=0,k=[],W=[],G=[],oe=[];A<H;A++){for(k[A]=1,N=0;N<H;N++)A!=N&&(k[A]*=(M-R[N])/(R[A]-R[N]));for(W[A]=0,N=0;N<H;N++)A!=N&&(W[A]+=1/(R[A]-R[N]));G[A]=(1-2*(M-R[A])*W[A])*(k[A]*k[A]),oe[A]=(M-R[A])*(k[A]*k[A]),L+=G[A]*T[A]+oe[A]*I[A]}return L},lagrange:function(R,T,I){for(var M,N,H=0,L=0,A=R.length;L<A;L++){for(N=T[L],M=0;M<A;M++)L!=M&&(N*=(I-R[M])/(R[L]-R[M]));H+=N}return H},cubic_spline:function(R,T,I){for(var M,N,H=R.length,L=0,A=[],k=[],W=[],G=[],oe=[],ae=[];L<H-1;L++)G[L]=R[L+1]-R[L];for(W[0]=0,L=1;L<H-1;L++)W[L]=3/G[L]*(T[L+1]-T[L])-3/G[L-1]*(T[L]-T[L-1]);for(L=1;L<H-1;L++)A[L]=[],k[L]=[],A[L][L-1]=G[L-1],A[L][L]=2*(G[L-1]+G[L]),A[L][L+1]=G[L],k[L][0]=W[L];for(N=p.multiply(p.inv(A),k),M=0;M<H-1;M++)oe[M]=(T[M+1]-T[M])/G[M]-G[M]*(N[M+1][0]+2*N[M][0])/3,ae[M]=(N[M+1][0]-N[M][0])/(3*G[M]);for(M=0;M<H&&!(R[M]>I);M++);return T[M-=1]+(I-R[M])*oe[M]+p.sq(I-R[M])*N[M]+(I-R[M])*p.sq(I-R[M])*ae[M]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(R){var T,I,M,N,H,L=R.length,A=R[0].length,k=0,W=[],G=[],oe=[],ae=[],X=[],le=[],ye=[];for(k=0;k<L;k++)W[k]=p.sum(R[k])/A;for(k=0;k<A;k++)for(X[k]=[],T=0;T<L;T++)X[k][T]=R[T][k]-W[T];for(X=p.transpose(X),k=0;k<L;k++)for(le[k]=[],T=0;T<L;T++)le[k][T]=p.dot([X[k]],[X[T]])/(A-1);for(H=(M=p.jacobi(le))[0],G=M[1],ye=p.transpose(H),k=0;k<G.length;k++)for(T=k;T<G.length;T++)G[k]<G[T]&&(I=G[k],G[k]=G[T],G[T]=I,oe=ye[k],ye[k]=ye[T],ye[T]=oe);for(N=p.transpose(X),k=0;k<L;k++)for(ae[k]=[],T=0;T<N.length;T++)ae[k][T]=p.dot([ye[k]],[N[T]]);return[R,G,ye,ae]}}),(function(R){for(var T=0;T<R.length;T++)(function(I){p.fn[I]=function(M,N){var H=this;return N?(setTimeout((function(){N.call(H,p.fn[I].call(H,M))}),15),this):typeof p[I](this,M)=="number"?p[I](this,M):p(p[I](this,M))}})(R[T])})("add divide multiply subtract dot pow exp log abs norm angle".split(" "))})(m,Math),(function(p,v){var w=[].slice,E=p.utils.isNumber,C=p.utils.isArray;function b(P,R,T,I){if(P>1||T>1||P<=0||T<=0)throw new Error("Proportions should be greater than 0 and less than 1");var M=(P*R+T*I)/(R+I);return(P-T)/v.sqrt(M*(1-M)*(1/R+1/I))}p.extend({zscore:function(){var P=w.call(arguments);return E(P[1])?(P[0]-P[1])/P[2]:(P[0]-p.mean(P[1]))/p.stdev(P[1],P[2])},ztest:function(){var P,R=w.call(arguments);return C(R[1])?(P=p.zscore(R[0],R[1],R[3]),R[2]===1?p.normal.cdf(-v.abs(P),0,1):2*p.normal.cdf(-v.abs(P),0,1)):R.length>2?(P=p.zscore(R[0],R[1],R[2]),R[3]===1?p.normal.cdf(-v.abs(P),0,1):2*p.normal.cdf(-v.abs(P),0,1)):(P=R[0],R[1]===1?p.normal.cdf(-v.abs(P),0,1):2*p.normal.cdf(-v.abs(P),0,1))}}),p.extend(p.fn,{zscore:function(P,R){return(P-this.mean())/this.stdev(R)},ztest:function(P,R,T){var I=v.abs(this.zscore(P,T));return R===1?p.normal.cdf(-I,0,1):2*p.normal.cdf(-I,0,1)}}),p.extend({tscore:function(){var P=w.call(arguments);return P.length===4?(P[0]-P[1])/(P[2]/v.sqrt(P[3])):(P[0]-p.mean(P[1]))/(p.stdev(P[1],!0)/v.sqrt(P[1].length))},ttest:function(){var P,R=w.call(arguments);return R.length===5?(P=v.abs(p.tscore(R[0],R[1],R[2],R[3])),R[4]===1?p.studentt.cdf(-P,R[3]-1):2*p.studentt.cdf(-P,R[3]-1)):E(R[1])?(P=v.abs(R[0]),R[2]==1?p.studentt.cdf(-P,R[1]-1):2*p.studentt.cdf(-P,R[1]-1)):(P=v.abs(p.tscore(R[0],R[1])),R[2]==1?p.studentt.cdf(-P,R[1].length-1):2*p.studentt.cdf(-P,R[1].length-1))}}),p.extend(p.fn,{tscore:function(P){return(P-this.mean())/(this.stdev(!0)/v.sqrt(this.cols()))},ttest:function(P,R){return R===1?1-p.studentt.cdf(v.abs(this.tscore(P)),this.cols()-1):2*p.studentt.cdf(-v.abs(this.tscore(P)),this.cols()-1)}}),p.extend({anovafscore:function(){var P,R,T,I,M,N,H,L,A=w.call(arguments);if(A.length===1){for(M=new Array(A[0].length),H=0;H<A[0].length;H++)M[H]=A[0][H];A=M}for(R=new Array,H=0;H<A.length;H++)R=R.concat(A[H]);for(T=p.mean(R),P=0,H=0;H<A.length;H++)P+=A[H].length*v.pow(p.mean(A[H])-T,2);for(P/=A.length-1,N=0,H=0;H<A.length;H++)for(I=p.mean(A[H]),L=0;L<A[H].length;L++)N+=v.pow(A[H][L]-I,2);return P/(N/(R.length-A.length))},anovaftest:function(){var P,R,T,I,M=w.call(arguments);if(E(M[0]))return 1-p.centralF.cdf(M[0],M[1],M[2]);var N=p.anovafscore(M);for(P=M.length-1,T=0,I=0;I<M.length;I++)T+=M[I].length;return R=T-P-1,1-p.centralF.cdf(N,P,R)},ftest:function(P,R,T){return 1-p.centralF.cdf(P,R,T)}}),p.extend(p.fn,{anovafscore:function(){return p.anovafscore(this.toArray())},anovaftes:function(){var P,R=0;for(P=0;P<this.length;P++)R+=this[P].length;return p.ftest(this.anovafscore(),this.length-1,R-this.length)}}),p.extend({qscore:function(){var P,R,T,I,M,N=w.call(arguments);return E(N[0])?(P=N[0],R=N[1],T=N[2],I=N[3],M=N[4]):(P=p.mean(N[0]),R=p.mean(N[1]),T=N[0].length,I=N[1].length,M=N[2]),v.abs(P-R)/(M*v.sqrt((1/T+1/I)/2))},qtest:function(){var P,R=w.call(arguments);R.length===3?(P=R[0],R=R.slice(1)):R.length===7?(P=p.qscore(R[0],R[1],R[2],R[3],R[4]),R=R.slice(5)):(P=p.qscore(R[0],R[1],R[2]),R=R.slice(3));var T=R[0],I=R[1];return 1-p.tukey.cdf(P,I,T-I)},tukeyhsd:function(P){for(var R=p.pooledstdev(P),T=P.map((function(A){return p.mean(A)})),I=P.reduce((function(A,k){return A+k.length}),0),M=[],N=0;N<P.length;++N)for(var H=N+1;H<P.length;++H){var L=p.qtest(T[N],T[H],P[N].length,P[H].length,R,I,P.length);M.push([[N,H],L])}return M}}),p.extend({normalci:function(){var P,R=w.call(arguments),T=new Array(2);return P=R.length===4?v.abs(p.normal.inv(R[1]/2,0,1)*R[2]/v.sqrt(R[3])):v.abs(p.normal.inv(R[1]/2,0,1)*p.stdev(R[2])/v.sqrt(R[2].length)),T[0]=R[0]-P,T[1]=R[0]+P,T},tci:function(){var P,R=w.call(arguments),T=new Array(2);return P=R.length===4?v.abs(p.studentt.inv(R[1]/2,R[3]-1)*R[2]/v.sqrt(R[3])):v.abs(p.studentt.inv(R[1]/2,R[2].length-1)*p.stdev(R[2],!0)/v.sqrt(R[2].length)),T[0]=R[0]-P,T[1]=R[0]+P,T},significant:function(P,R){return P<R}}),p.extend(p.fn,{normalci:function(P,R){return p.normalci(P,R,this.toArray())},tci:function(P,R){return p.tci(P,R,this.toArray())}}),p.extend(p.fn,{oneSidedDifferenceOfProportions:function(P,R,T,I){var M=b(P,R,T,I);return p.ztest(M,1)},twoSidedDifferenceOfProportions:function(P,R,T,I){var M=b(P,R,T,I);return p.ztest(M,2)}})})(m,Math),m.models=(function(){function p(w,E){var C=w.length,b=E[0].length-1,P=C-b-1,R=m.lstsq(E,w),T=m.multiply(E,R.map((function(A){return[A]}))).map((function(A){return A[0]})),I=m.subtract(w,T),M=m.mean(w),N=m.sum(T.map((function(A){return Math.pow(A-M,2)}))),H=m.sum(w.map((function(A,k){return Math.pow(A-T[k],2)}))),L=N+H;return{exog:E,endog:w,nobs:C,df_model:b,df_resid:P,coef:R,predict:T,resid:I,ybar:M,SST:L,SSE:N,SSR:H,R2:N/L}}function v(w){var E,C,b=(E=w.exog,C=E[0].length,m.arange(C).map((function(H){var L=m.arange(C).filter((function(A){return A!==H}));return p(m.col(E,H).map((function(A){return A[0]})),m.col(E,L))}))),P=Math.sqrt(w.SSR/w.df_resid),R=b.map((function(H){var L=H.SST,A=H.R2;return P/Math.sqrt(L*(1-A))})),T=w.coef.map((function(H,L){return(H-0)/R[L]})),I=T.map((function(H){var L=m.studentt.cdf(H,w.df_resid);return 2*(L>.5?1-L:L)})),M=m.studentt.inv(.975,w.df_resid),N=w.coef.map((function(H,L){var A=M*R[L];return[H-A,H+A]}));return{se:R,t:T,p:I,sigmaHat:P,interval95:N}}return{ols:function(w,E){var C=p(w,E),b=v(C),P=(function(T){var I,M,N,H=T.R2/T.df_model/((1-T.R2)/T.df_resid);return{F_statistic:H,pvalue:1-(I=H,M=T.df_model,N=T.df_resid,m.beta.cdf(I/(N/M+I),M/2,N/2))}})(C),R=1-(1-C.R2)*((C.nobs-1)/C.df_resid);return C.t=b,C.f=P,C.adjust_R2=R,C}}})(),m.extend({buildxmatrix:function(){for(var p=new Array(arguments.length),v=0;v<arguments.length;v++)p[v]=[1].concat(arguments[v]);return m(p)},builddxmatrix:function(){for(var p=new Array(arguments[0].length),v=0;v<arguments[0].length;v++)p[v]=[1].concat(arguments[0][v]);return m(p)},buildjxmatrix:function(p){for(var v=new Array(p.length),w=0;w<p.length;w++)v[w]=p[w];return m.builddxmatrix(v)},buildymatrix:function(p){return m(p).transpose()},buildjymatrix:function(p){return p.transpose()},matrixmult:function(p,v){var w,E,C,b,P;if(p.cols()==v.rows()){if(v.rows()>1){for(b=[],w=0;w<p.rows();w++)for(b[w]=[],E=0;E<v.cols();E++){for(P=0,C=0;C<p.cols();C++)P+=p.toArray()[w][C]*v.toArray()[C][E];b[w][E]=P}return m(b)}for(b=[],w=0;w<p.rows();w++)for(b[w]=[],E=0;E<v.cols();E++){for(P=0,C=0;C<p.cols();C++)P+=p.toArray()[w][C]*v.toArray()[E];b[w][E]=P}return m(b)}},regress:function(p,v){var w=m.xtranspxinv(p),E=p.transpose(),C=m.matrixmult(m(w),E);return m.matrixmult(C,v)},regresst:function(p,v,w){var E=m.regress(p,v),C={anova:{}},b=m.jMatYBar(p,E);C.yBar=b;var P=v.mean();C.anova.residuals=m.residuals(v,b),C.anova.ssr=m.ssr(b,P),C.anova.msr=C.anova.ssr/(p[0].length-1),C.anova.sse=m.sse(v,b),C.anova.mse=C.anova.sse/(v.length-(p[0].length-1)-1),C.anova.sst=m.sst(v,P),C.anova.mst=C.anova.sst/(v.length-1),C.anova.r2=1-C.anova.sse/C.anova.sst,C.anova.r2<0&&(C.anova.r2=0),C.anova.fratio=C.anova.msr/C.anova.mse,C.anova.pvalue=m.anovaftest(C.anova.fratio,p[0].length-1,v.length-(p[0].length-1)-1),C.anova.rmse=Math.sqrt(C.anova.mse),C.anova.r2adj=1-C.anova.mse/C.anova.mst,C.anova.r2adj<0&&(C.anova.r2adj=0),C.stats=new Array(p[0].length);for(var R,T,I,M=m.xtranspxinv(p),N=0;N<E.length;N++)R=Math.sqrt(C.anova.mse*Math.abs(M[N][N])),T=Math.abs(E[N]/R),I=m.ttest(T,v.length-p[0].length-1,w),C.stats[N]=[E[N],R,T,I];return C.regress=E,C},xtranspx:function(p){return m.matrixmult(p.transpose(),p)},xtranspxinv:function(p){var v=m.matrixmult(p.transpose(),p);return m.inv(v)},jMatYBar:function(p,v){var w=m.matrixmult(p,v);return new m(w)},residuals:function(p,v){return m.matrixsubtract(p,v)},ssr:function(p,v){for(var w=0,E=0;E<p.length;E++)w+=Math.pow(p[E]-v,2);return w},sse:function(p,v){for(var w=0,E=0;E<p.length;E++)w+=Math.pow(p[E]-v[E],2);return w},sst:function(p,v){for(var w=0,E=0;E<p.length;E++)w+=Math.pow(p[E]-v,2);return w},matrixsubtract:function(p,v){for(var w=new Array(p.length),E=0;E<p.length;E++){w[E]=new Array(p[E].length);for(var C=0;C<p[E].length;C++)w[E][C]=p[E][C]-v[E][C]}return m(w)}}),m.jStat=m,m)},960:function(g,m,p){const v=p(592);g.exports=(function(w){function E(N,H){const L=H.split(".");let A=N;for(const k of L){if(A==null)return;A=A[k]}return A}for(let N=0;N<Object.keys(v).length;N++){let H,L=Object.keys(v)[N],A=[];if(typeof v[L]=="object"){A=Object.keys(v[L]),H=Object.values(v[L]);for(let k=0;k<H.length;k++)if(typeof H[k]=="object"){let W=A[k];v[L][W]&&(A=[...A,...Object.keys(v[L][W]).map((G=>W+"."+G))],A.splice(A.indexOf(W),1))}}if(A.length<1)w[L]=v[L];else for(let k=0;k<A.length;k++)typeof E(v[L],A[k])=="function"&&(w[L]=E(v[L],A[k]))}let C=function(N){return typeof N=="number"&&(N=parseInt(N)),N},b=null,P=null,R=null;w.TABLE=function(){return R},w.COLUMN=w.COL=function(){return R.tracking&&R.tracking.push(M.getColumnNameFromCoords(C(b),C(P))),C(b)+1},w.ROW=function(){return R.tracking&&R.tracking.push(M.getColumnNameFromCoords(C(b),C(P))),C(P)+1},w.CELL=function(){return M.getColumnNameFromCoords(b,P)},w.VALUE=function(N,H,L){return R.getValueFromCoords(C(N)-1,C(H)-1,L)},w.THISROWCELL=function(N){return R.getValueFromCoords(C(N)-1,C(P))};const T=function(N,H){for(let L=0;L<N.length;L++){let A=M.getTokensFromRange(N[L]);H=H.replace(N[L],"["+A.join(",")+"]")}return H},I=function(N){return typeof N=="string"&&(N=N.trim()),!isNaN(N)&&N!==null&&N!==""},M=function(N,H,L,A,k){R=k,b=L,P=A;let W="",G={};if(H)if(H.size){let X,le=null;H.forEach((function(ye,pe){X=pe.replace(/!/g,"."),X.indexOf(".")!==-1&&(X=X.split("."),G[X[0]]=!0)})),X=Object.keys(G);for(let ye=0;ye<X.length;ye++)W+="var "+X[ye]+" = {};";H.forEach((function(ye,pe){X=pe.replace(/!/g,"."),ye===null||I(ye)||(le=ye.match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g),le&&le.length&&(ye=updateRanges(le,ye))),X.indexOf(".")>0?W+=X+" = "+H.get(pe)+`;
`:W+="var "+X+" = "+ye+`;
`}))}else{let X=Object.keys(H);if(X.length){let le,ye={};for(let pe=0;pe<X.length;pe++)if(le=X[pe].replace(/\!/g,"."),le.indexOf(".")>0){let he=he.split(".");ye[he[0]]={}}le=Object.keys(ye);for(let pe=0;pe<le.length;pe++)W+="var "+le[pe]+" = {};";for(let pe=0;pe<X.length;pe++){if(le=X[pe].replace(/!/g,"."),H[X[pe]]!==null&&!I(H[X[pe]])){let he=H[X[pe]].match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);he&&he.length&&(H[X[pe]]=T(he,H[X[pe]]))}le.indexOf(".")>0?W+=le+" = "+H[X[pe]]+`;
`:W+="var "+le+" = "+H[X[pe]]+`;
`}}}let oe=(N=(function(X,le){let ye="",pe=0,he=["=","!",">","<"];for(let Me=0;Me<X.length;Me++)X[Me]==='"'&&(pe=pe===0?1:0),pe===1?ye+=X[Me]:(ye+=X[Me].toUpperCase(),Me>0&&X[Me]==="="&&he.indexOf(X[Me-1])===-1&&he.indexOf(X[Me+1])===-1&&(ye+="="));return ye=ye.replace(/\^/g,"**"),ye=ye.replace(/<>/g,"!="),ye=ye.replace(/&/g,"+"),ye=ye.replace(/\$/g,""),ye})(N=(N=N.replace(/\$/g,"")).replace(/!/g,"."))).match(/(('.*?'!)|(\w*!))?(\$?[A-Z]+\$?[0-9]*):(\$?[A-Z]+\$?[0-9]*)?/g);oe&&oe.length&&(N=T(oe,N));let ae=new Function(W+"; return "+N)();return ae===null&&(ae=0),ae};return M.getColumnNameFromCoords=function(N,H){return L=parseInt(N),A="",L>701?(A+=String.fromCharCode(64+parseInt(L/676)),A+=String.fromCharCode(64+parseInt(L%676/26))):L>25&&(A+=String.fromCharCode(64+parseInt(L/26))),A+String.fromCharCode(65+L%26)+(parseInt(H)+1);var L,A},M.getCoordsFromColumnName=function(N){var H=/^[a-zA-Z]+/.exec(N);if(H){for(var L=0,A=0;A<H[0].length;A++)L+=parseInt(H[0].charCodeAt(A)-64)*Math.pow(26,H[0].length-1-A);--L<0&&(L=0);var k=parseInt(/[0-9]+$/.exec(N))||null;return k>0&&k--,[L,k]}},M.getRangeFromTokens=function(N){N=N.filter((function(k){return k!="#REF!"}));for(var H="",L="",A=0;A<N.length;A++)N[A].indexOf(".")>=0?H=".":N[A].indexOf("!")>=0&&(H="!"),H&&(L=N[A].split(H),N[A]=L[1],L=L[0]+H);return N.sort((function(k,W){var G=Helpers.getCoordsFromColumnName(k),oe=Helpers.getCoordsFromColumnName(W);return G[1]>oe[1]?1:G[1]<oe[1]?-1:G[0]>oe[0]?1:G[0]<oe[0]?-1:0})),N.length?L+(N[0]+":")+N[N.length-1]:"#REF!"},M.getTokensFromRange=function(N){if(N.indexOf(".")>0){var H=N.split(".");N=H[1],H=H[0]+"."}else N.indexOf("!")>0?(H=N.split("!"),N=H[1],H=H[0]+"!"):H="";N=N.split(":");var L=M.getCoordsFromColumnName(N[0]),A=M.getCoordsFromColumnName(N[1]);if(L[0]<=A[0])var k=L[0],W=A[0];else k=A[0],W=L[0];if(L[1]===null&&A[1]==null)for(var G=null,oe=null,ae=Object.keys(vars),X=0;X<ae.length;X++){var le=M.getCoordsFromColumnName(ae[X]);le[0]===L[0]&&(G===null||le[1]<G)&&(G=le[1]),le[0]===A[0]&&(oe===null||le[1]>oe)&&(oe=le[1])}else L[1]<=A[1]?(G=L[1],oe=A[1]):(G=A[1],oe=L[1]);for(var ye=[],pe=G;pe<=oe;pe++){var he=[];for(X=k;X<=W;X++)he.push(H+M.getColumnNameFromCoords(X,pe));ye.push(he)}return ye},M.setFormula=function(N){let H=Object.keys(N);for(let L=0;L<H.length;L++)typeof N[H[L]]=="function"&&(w[H[L]]=N[H[L]])},M.basic=!0,M})(typeof window>"u"?p.g:window)},592:function(g,m,p){var v=p(162),w=p(765);const E=new Error("#NULL!"),C=new Error("#DIV/0!"),b=new Error("#VALUE!"),P=new Error("#REF!"),R=new Error("#NAME?"),T=new Error("#NUM!"),I=new Error("#N/A"),M=new Error("#ERROR!"),N=new Error("#GETTING_DATA");var H=Object.freeze({__proto__:null,data:N,div0:C,error:M,na:I,name:R,nil:E,num:T,ref:P,value:b});function L(_){const S=[];return A(_,(F=>{S.push(F)})),S}function A(_,S){let F=-1;const B=_.length;for(;++F<B&&S(_[F],F,_)!==!1;);return _}function k(_){let S,F=_.length;for(;F--;)if(S=_[F],typeof S!="number")if(S!==!0)if(S!==!1){if(typeof S=="string"){const B=te(S);_[F]=B instanceof Error?0:B}}else _[F]=0;else _[F]=1;return _}function W(_,S){if(!_)return b;_.every((z=>Array.isArray(z)))&&_.length!==0||(_=[[..._]]),_.map(((z,ie)=>{z.map(((fe,Ne)=>{fe||(_[ie][Ne]=0)}))}));const F=_.reduce(((z,ie,fe)=>ie.length>_[z].length?fe:z),0),B=_[F].length;return _.map((z=>[...z,...Array(B-z.length).fill(0)]))}function G(){let _;if(arguments.length===1){const F=arguments[0];_=(S=F)!=null&&typeof S.length=="number"&&typeof S!="string"?L.apply(null,arguments):[F]}else _=Array.from(arguments);for(var S;!ae(_);)_=oe(_);return _}function oe(_){return _&&_.reduce?_.reduce(((S,F)=>{const B=Array.isArray(S),z=Array.isArray(F);return B&&z?S.concat(F):B?(S.push(F),S):z?[S].concat(F):[S,F]})):[_]}function ae(_){if(!_)return!1;for(let S=0;S<_.length;++S)if(Array.isArray(_[S]))return!1;return!0}function X(_,S){return S=S||1,_&&typeof _.slice=="function"?_.slice(S):_}function le(_){return _?_[0].map(((S,F)=>_.map((B=>B[F])))):b}function ye(_,S){let F=null;return A(_,((B,z)=>{if(B[0]===S)return F=z,!1})),F??b}function pe(){for(let _=0;_<arguments.length;_++)if(arguments[_]instanceof Error)return arguments[_]}function he(){let _=arguments.length;for(;_--;)if(arguments[_]instanceof Error)return!0;return!1}function Me(_){return Math.round(_*1e14)/1e14}function Qe(){return G.apply(null,arguments).filter((_=>typeof _=="number"))}function Xe(_){if(typeof _=="boolean"||_ instanceof Error)return _;if(typeof _=="number")return _!==0;if(typeof _=="string"){const S=_.toUpperCase();if(S==="TRUE")return!0;if(S==="FALSE")return!1}return _ instanceof Date&&!isNaN(_)||b}function Ke(_){if(!isNaN(_)){if(_ instanceof Date)return new Date(_);const S=parseFloat(_);return S<0||S>=2958466?T:(function(F){F<60&&(F+=1);const B=Math.floor(F-25569),z=new Date(86400*B*1e3),ie=F-Math.floor(F)+1e-7;let fe=Math.floor(86400*ie);const Ne=fe%60;fe-=Ne;const qe=Math.floor(fe/3600),rt=Math.floor(fe/60)%60;let ct=z.getUTCDate(),pt=z.getUTCMonth();return F>=60&&F<61&&(ct=29,pt=1),new Date(z.getUTCFullYear(),pt,ct,qe,rt,Ne)})(S)}return typeof _!="string"||(_=/(\d{4})-(\d\d?)-(\d\d?)$/.test(_)?new Date(_+"T00:00:00.000"):new Date(_),isNaN(_))?b:_}function it(_){let S,F=_.length;for(;F--;){if(S=Ke(_[F]),S===b)return S;_[F]=S}return _}function te(_){return _ instanceof Error?_:_==null?0:(typeof _=="boolean"&&(_=+_),isNaN(_)||_===""?b:parseFloat(_))}function Pe(_){let S,F;if(!_||(S=_.length)===0)return b;for(;S--;){if(_[S]instanceof Error)return _[S];if(F=te(_[S]),F instanceof Error)return F;_[S]=F}return _}function U(_){return _ instanceof Error?_:_==null?"":_.toString()}function Q(){let _=arguments.length;for(;_--;)if(typeof arguments[_]=="string")return!0;return!1}function ee(_){return _!=null}const ce="=",ve=[">",">=","<","<=","=","<>"],K="operator",ne="literal",de=[K,ne],Oe=K,Se=ne;function ge(_,S){if(de.indexOf(S)===-1)throw new Error("Unsupported token type: "+S);return{value:_,type:S}}function De(_){return(function(S){let F="";const B=[];for(let z=0;z<S.length;z++){const ie=S[z];z===0&&ve.indexOf(ie)>=0?B.push(ge(ie,Oe)):F+=ie}return F.length>0&&B.push(ge((function(z){return typeof z!="string"||/^\d+(\.\d+)?$/.test(z)&&(z=z.indexOf(".")===-1?parseInt(z,10):parseFloat(z)),z})(F),Se)),B.length>0&&B[0].type!==Oe&&B.unshift(ge(ce,Oe)),B})((function(S){const F=S.length,B=[];let z=0,ie="",fe="";for(;z<F;){const Ne=S.charAt(z);switch(Ne){case">":case"<":case"=":fe+=Ne,ie.length>0&&(B.push(ie),ie="");break;default:fe.length>0&&(B.push(fe),fe=""),ie+=Ne}z++}return ie.length>0&&B.push(ie),fe.length>0&&B.push(fe),B})(_))}const $e=function(_){const S=[];let F;for(let B=0;B<_.length;B++){const z=_[B];switch(z.type){case Oe:F=z.value;break;case Se:S.push(z.value)}}return(function(B,z){let ie=!1;switch(z){case">":ie=B[0]>B[1];break;case">=":ie=B[0]>=B[1];break;case"<":ie=B[0]<B[1];break;case"<=":ie=B[0]<=B[1];break;case"=":ie=B[0]==B[1];break;case"<>":ie=B[0]!=B[1]}return ie})(S,F)},Fe={};function Ve(_){return[b,P,C,T,R,E].indexOf(_)>=0||typeof _=="number"&&(isNaN(_)||!isFinite(_))}function Be(_){return Ve(_)||_===I}function Je(_){return _===!0||_===!1}function lt(_){return typeof _=="number"&&!isNaN(_)&&isFinite(_)}function ot(_){return typeof _=="string"}function ht(){const _=[];for(let S=0;S<arguments.length;++S){let F=!1;const B=arguments[S];for(let z=0;z<_.length&&(F=_[z]===B,!F);++z);F||_.push(B)}return _}function Ct(_,S,F,B){if(!S||!F)return I;B=!(B===0||B===!1);let z=I;const ie=typeof _=="number";let fe=!1;for(let Ne=0;Ne<S.length;Ne++){const qe=S[Ne];if(qe[0]===_){z=F<qe.length+1?qe[F-1]:P;break}!fe&&(ie&&B&&qe[0]<=_||B&&typeof qe[0]=="string"&&qe[0].localeCompare(_)<0)&&(z=F<qe.length+1?qe[F-1]:P),ie&&qe[0]>_&&(fe=!0)}return z}function bt(){const _=G(arguments).filter(ee);if(_.length===0)return C;const S=pe.apply(void 0,_);if(S)return S;const F=Qe(_),B=F.length;let z,ie=0,fe=0;for(let Ne=0;Ne<B;Ne++)ie+=F[Ne],fe+=1;return z=ie/fe,isNaN(z)&&(z=T),z}function vt(){const _=G(arguments).filter(ee);if(_.length===0)return C;const S=pe.apply(void 0,_);if(S)return S;const F=_,B=F.length;let z,ie=0,fe=0;for(let Ne=0;Ne<B;Ne++){const qe=F[Ne];typeof qe=="number"&&(ie+=qe),qe===!0&&ie++,qe!==null&&fe++}return z=ie/fe,isNaN(z)&&(z=T),z}Fe.TYPE=_=>{switch(_){case E:return 1;case C:return 2;case b:return 3;case P:return 4;case R:return 5;case T:return 6;case I:return 7;case N:return 8}return I};const mt={DIST:function(_,S,F,B,z,ie){return arguments.length<4?b:(z=z===void 0?0:z,ie=ie===void 0?1:ie,he(_=te(_),S=te(S),F=te(F),z=te(z),ie=te(ie))?b:(_=(_-z)/(ie-z),B?v.beta.cdf(_,S,F):v.beta.pdf(_,S,F)))},INV:(_,S,F,B,z)=>(B=B===void 0?0:B,z=z===void 0?1:z,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z))?b:v.beta.inv(_,S,F)*(z-B)+B)},Et={DIST:(_,S,F,B)=>he(_=te(_),S=te(S),F=te(F),B=te(B))?b:B?v.binomial.cdf(_,S,F):v.binomial.pdf(_,S,F)};Et.DIST.RANGE=(_,S,F,B)=>{if(B=B===void 0?F:B,he(_=te(_),S=te(S),F=te(F),B=te(B)))return b;let z=0;for(let ie=F;ie<=B;ie++)z+=Te(_,ie)*Math.pow(S,ie)*Math.pow(1-S,_-ie);return z},Et.INV=(_,S,F)=>{if(he(_=te(_),S=te(S),F=te(F)))return b;let B=0;for(;B<=_;){if(v.binomial.cdf(B,_,S)>=F)return B;B++}};const Rt={DIST:(_,S,F)=>he(_=te(_),S=te(S))?b:F?v.chisquare.cdf(_,S):v.chisquare.pdf(_,S)};Rt.DIST.RT=(_,S)=>!_|!S?I:_<1||S>Math.pow(10,10)?T:typeof _!="number"||typeof S!="number"?b:1-v.chisquare.cdf(_,S),Rt.INV=(_,S)=>he(_=te(_),S=te(S))?b:v.chisquare.inv(_,S),Rt.INV.RT=(_,S)=>!_|!S?I:_<0||_>1||S<1||S>Math.pow(10,10)?T:typeof _!="number"||typeof S!="number"?b:v.chisquare.inv(1-_,S),Rt.TEST=function(_,S){if(arguments.length!==2)return I;if(!(_ instanceof Array&&S instanceof Array)||_.length!==S.length||_[0]&&S[0]&&_[0].length!==S[0].length)return b;const F=_.length;let B,z,ie;for(z=0;z<F;z++)_[z]instanceof Array||(B=_[z],_[z]=[],_[z].push(B)),S[z]instanceof Array||(B=S[z],S[z]=[],S[z].push(B));const fe=_[0].length,Ne=fe===1?F-1:(F-1)*(fe-1);let qe=0;const rt=Math.PI;for(z=0;z<F;z++)for(ie=0;ie<fe;ie++)qe+=Math.pow(_[z][ie]-S[z][ie],2)/S[z][ie];return Math.round(1e6*(function(ct,pt){let dt=Math.exp(-.5*ct);pt%2==1&&(dt*=Math.sqrt(2*ct/rt));let yt=pt;for(;yt>=2;)dt=dt*ct/yt,yt-=2;let Pt=dt,Tt=pt;for(;Pt>1e-10*dt;)Tt+=2,Pt=Pt*ct/Tt,dt+=Pt;return 1-dt})(qe,Ne))/1e6};const V={};function q(){return Qe(G(arguments)).length}function D(){const _=G(arguments);return _.length-O(_)}function O(){const _=G(arguments);let S,F=0;for(let B=0;B<_.length;B++)S=_[B],S!=null&&S!==""||F++;return F}V.NORM=(_,S,F)=>he(_=te(_),S=te(S),F=te(F))?b:v.normalci(1,_,S,F)[1]-1,V.T=(_,S,F)=>he(_=te(_),S=te(S),F=te(F))?b:v.tci(1,_,S,F)[1]-1;const re={P:(_,S)=>{if(he(_=Pe(G(_)),S=Pe(G(S))))return b;const F=v.mean(_),B=v.mean(S);let z=0;const ie=_.length;for(let fe=0;fe<ie;fe++)z+=(_[fe]-F)*(S[fe]-B);return z/ie},S:(_,S)=>he(_=Pe(G(_)),S=Pe(G(S)))?b:v.covariance(_,S)},Ee={DIST:(_,S,F)=>he(_=te(_),S=te(S))?b:F?v.exponential.cdf(_,S):v.exponential.pdf(_,S)},we={};function Z(_,S,F){if(he(_=te(_),S=Pe(G(S)),F=Pe(G(F))))return b;const B=v.mean(F),z=v.mean(S),ie=F.length;let fe=0,Ne=0;for(let rt=0;rt<ie;rt++)fe+=(F[rt]-B)*(S[rt]-z),Ne+=Math.pow(F[rt]-B,2);const qe=fe/Ne;return z-qe*B+qe*_}function Y(_){return(_=te(_))instanceof Error?_:_===0||parseInt(_,10)===_&&_<0?T:v.gammafn(_)}function se(_){return(_=te(_))instanceof Error?_:v.gammaln(_)}we.DIST=(_,S,F,B)=>he(_=te(_),S=te(S),F=te(F))?b:B?v.centralF.cdf(_,S,F):v.centralF.pdf(_,S,F),we.DIST.RT=function(_,S,F){return arguments.length!==3?I:_<0||S<1||F<1?T:typeof _!="number"||typeof S!="number"||typeof F!="number"?b:1-v.centralF.cdf(_,S,F)},we.INV=(_,S,F)=>he(_=te(_),S=te(S),F=te(F))?b:_<=0||_>1?T:v.centralF.inv(_,S,F),we.INV.RT=function(_,S,F){return arguments.length!==3?I:_<0||_>1||S<1||S>Math.pow(10,10)||F<1||F>Math.pow(10,10)?T:typeof _!="number"||typeof S!="number"||typeof F!="number"?b:v.centralF.inv(1-_,S,F)},we.TEST=(_,S)=>{if(!_||!S||!(_ instanceof Array&&S instanceof Array))return I;if(_.length<2||S.length<2)return C;const F=(ie,fe)=>{let Ne=0;for(let qe=0;qe<ie.length;qe++)Ne+=Math.pow(ie[qe]-fe,2);return Ne},B=xt(_)/_.length,z=xt(S)/S.length;return F(_,B)/(_.length-1)/(F(S,z)/(S.length-1))},Y.DIST=function(_,S,F,B){return arguments.length!==4?I:_<0||S<=0||F<=0||typeof _!="number"||typeof S!="number"||typeof F!="number"?b:B?v.gamma.cdf(_,S,F,!0):v.gamma.pdf(_,S,F,!1)},Y.INV=function(_,S,F){return arguments.length!==3?I:_<0||_>1||S<=0||F<=0?T:typeof _!="number"||typeof S!="number"||typeof F!="number"?b:v.gamma.inv(_,S,F)},se.PRECISE=function(_){return arguments.length!==1?I:_<=0?T:typeof _!="number"?b:v.gammaln(_)};const _e={};function Ae(_,S){return he(_=Pe(G(_)),S=te(S))?_:S<0||_.length<S?b:_.sort(((F,B)=>B-F))[S-1]}function ke(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;const F=v.mean(_),B=v.mean(S),z=S.length;let ie=0,fe=0;for(let qe=0;qe<z;qe++)ie+=(S[qe]-B)*(_[qe]-F),fe+=Math.pow(S[qe]-B,2);const Ne=ie/fe;return[Ne,F-Ne*B]}_e.DIST=(_,S,F,B,z)=>{if(he(_=te(_),S=te(S),F=te(F),B=te(B)))return b;function ie(fe,Ne,qe,rt){return Te(qe,fe)*Te(rt-qe,Ne-fe)/Te(rt,Ne)}return z?(function(fe,Ne,qe,rt){let ct=0;for(let pt=0;pt<=fe;pt++)ct+=ie(pt,Ne,qe,rt);return ct})(_,S,F,B):ie(_,S,F,B)};const je={};function Ue(){const _=G(arguments),S=pe.apply(void 0,_);if(S)return S;const F=Qe(_);return F.length===0?0:Math.max.apply(Math,F)}function et(){const _=G(arguments),S=pe.apply(void 0,_);if(S)return S;const F=k(_);let B=v.median(F);return isNaN(B)&&(B=T),B}function st(){const _=G(arguments),S=pe.apply(void 0,_);if(S)return S;const F=Qe(_);return F.length===0?0:Math.min.apply(Math,F)}je.DIST=(_,S,F,B)=>he(_=te(_),S=te(S),F=te(F))?b:B?v.lognormal.cdf(_,S,F):v.lognormal.pdf(_,S,F),je.INV=(_,S,F)=>he(_=te(_),S=te(S),F=te(F))?b:v.lognormal.inv(_,S,F);const at={MULT:function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=_.length,F={};let B,z=[],ie=0;for(let fe=0;fe<S;fe++)B=_[fe],F[B]=F[B]?F[B]+1:1,F[B]>ie&&(ie=F[B],z=[]),F[B]===ie&&(z[z.length]=B);return z},SNGL:function(){const _=Pe(G(arguments));return _ instanceof Error?_:at.MULT(_).sort(((S,F)=>S-F))[0]}},ft={DIST:(_,S,F,B)=>he(_=te(_),S=te(S),F=te(F))?b:B?v.negbin.cdf(_,S,F):v.negbin.pdf(_,S,F)},gt={};function Ie(_,S){if(he(S=Pe(G(S)),_=Pe(G(_))))return b;const F=v.mean(_),B=v.mean(S),z=_.length;let ie=0,fe=0,Ne=0;for(let qe=0;qe<z;qe++)ie+=(_[qe]-F)*(S[qe]-B),fe+=Math.pow(_[qe]-F,2),Ne+=Math.pow(S[qe]-B,2);return ie/Math.sqrt(fe*Ne)}gt.DIST=(_,S,F,B)=>he(_=te(_),S=te(S),F=te(F))?b:F<=0?T:B?v.normal.cdf(_,S,F):v.normal.pdf(_,S,F),gt.INV=(_,S,F)=>he(_=te(_),S=te(S),F=te(F))?b:v.normal.inv(_,S,F),gt.S={},gt.S.DIST=(_,S)=>(_=te(_))instanceof Error?b:S?v.normal.cdf(_,0,1):v.normal.pdf(_,0,1),gt.S.INV=_=>(_=te(_))instanceof Error?b:v.normal.inv(_,0,1);const We={EXC:(_,S)=>{if(he(_=Pe(G(_)),S=te(S)))return b;const F=(_=_.sort(((ie,fe)=>ie-fe))).length;if(S<1/(F+1)||S>1-1/(F+1))return T;const B=S*(F+1)-1,z=Math.floor(B);return Me(B===z?_[B]:_[z]+(B-z)*(_[z+1]-_[z]))},INC:(_,S)=>{if(he(_=Pe(G(_)),S=te(S)))return b;const F=S*((_=_.sort(((z,ie)=>z-ie))).length-1),B=Math.floor(F);return Me(F===B?_[F]:_[B]+(F-B)*(_[B+1]-_[B]))}},tt={EXC:(_,S,F)=>{if(F=F===void 0?3:F,he(_=Pe(G(_)),S=te(S),F=te(F)))return b;_=_.sort(((ct,pt)=>ct-pt));const B=ht.apply(null,_),z=_.length,ie=B.length,fe=Math.pow(10,F);let Ne=0,qe=!1,rt=0;for(;!qe&&rt<ie;)S===B[rt]?(Ne=(_.indexOf(B[rt])+1)/(z+1),qe=!0):S>=B[rt]&&(S<B[rt+1]||rt===ie-1)&&(Ne=(_.indexOf(B[rt])+1+(S-B[rt])/(B[rt+1]-B[rt]))/(z+1),qe=!0),rt++;return Math.floor(Ne*fe)/fe},INC:(_,S,F)=>{if(F=F===void 0?3:F,he(_=Pe(G(_)),S=te(S),F=te(F)))return b;_=_.sort(((ct,pt)=>ct-pt));const B=ht.apply(null,_),z=_.length,ie=B.length,fe=Math.pow(10,F);let Ne=0,qe=!1,rt=0;for(;!qe&&rt<ie;)S===B[rt]?(Ne=_.indexOf(B[rt])/(z-1),qe=!0):S>=B[rt]&&(S<B[rt+1]||rt===ie-1)&&(Ne=(_.indexOf(B[rt])+(S-B[rt])/(B[rt+1]-B[rt]))/(z-1),qe=!0),rt++;return Math.floor(Ne*fe)/fe}},ue={DIST:(_,S,F)=>he(_=te(_),S=te(S))?b:F?v.poisson.cdf(_,S):v.poisson.pdf(_,S)},be={EXC:(_,S)=>{if(he(_=Pe(G(_)),S=te(S)))return b;switch(S){case 1:return We.EXC(_,.25);case 2:return We.EXC(_,.5);case 3:return We.EXC(_,.75);default:return T}},INC:(_,S)=>{if(he(_=Pe(G(_)),S=te(S)))return b;switch(S){case 1:return We.INC(_,.25);case 2:return We.INC(_,.5);case 3:return We.INC(_,.75);default:return T}}},j={};function J(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=v.mean(_),F=_.length;let B=0;for(let z=0;z<F;z++)B+=Math.pow(_[z]-S,3);return F*B/((F-1)*(F-2)*Math.pow(v.stdev(_,!0),3))}function Ce(_,S){return he(_=Pe(G(_)),S=te(S))?_:_.sort(((F,B)=>F-B))[S-1]}j.AVG=(_,S,F)=>{if(he(_=te(_),S=Pe(G(S))))return b;const B=(F=F||!1)?(fe,Ne)=>fe-Ne:(fe,Ne)=>Ne-fe,z=(S=(S=G(S)).sort(B)).length;let ie=0;for(let fe=0;fe<z;fe++)S[fe]===_&&ie++;return ie>1?(2*S.indexOf(_)+ie+1)/2:S.indexOf(_)+1},j.EQ=(_,S,F)=>{if(he(_=te(_),S=Pe(G(S))))return b;const B=(F=F||!1)?(z,ie)=>z-ie:(z,ie)=>ie-z;return(S=S.sort(B)).indexOf(_)+1},J.P=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=v.mean(_),F=_.length;let B=0,z=0;for(let ie=0;ie<F;ie++)z+=Math.pow(_[ie]-S,3),B+=Math.pow(_[ie]-S,2);return z/=F,B/=F,z/Math.pow(B,1.5)};const Le={P:function(){const _=He.P.apply(this,arguments);let S=Math.sqrt(_);return isNaN(S)&&(S=T),S},S:function(){const _=He.S.apply(this,arguments);return Math.sqrt(_)}},me={DIST:(_,S,F)=>F!==1&&F!==2?T:F===1?me.DIST.RT(_,S):me.DIST["2T"](_,S)};me.DIST["2T"]=function(_,S){return arguments.length!==2?I:_<0||S<1?T:typeof _!="number"||typeof S!="number"?b:2*(1-v.studentt.cdf(_,S))},me.DIST.RT=function(_,S){return arguments.length!==2?I:_<0||S<1?T:typeof _!="number"||typeof S!="number"?b:1-v.studentt.cdf(_,S)},me.INV=(_,S)=>he(_=te(_),S=te(S))?b:v.studentt.inv(_,S),me.INV["2T"]=(_,S)=>(_=te(_),S=te(S),_<=0||_>1||S<1?T:he(_,S)?b:Math.abs(v.studentt.inv(_/2,S))),me.TEST=(_,S)=>{if(he(_=Pe(G(_)),S=Pe(G(S))))return b;const F=v.mean(_),B=v.mean(S);let z,ie=0,fe=0;for(z=0;z<_.length;z++)ie+=Math.pow(_[z]-F,2);for(z=0;z<S.length;z++)fe+=Math.pow(S[z]-B,2);ie/=_.length-1,fe/=S.length-1;const Ne=Math.abs(F-B)/Math.sqrt(ie/_.length+fe/S.length);return me.DIST["2T"](Ne,_.length+S.length-2)};const He={};function Ze(){const _=G(arguments),S=_.length;let F=0,B=0;const z=vt(_);for(let ie=0;ie<S;ie++){const fe=_[ie];F+=Math.pow(typeof fe=="number"?fe-z:fe===!0?1-z:0-z,2),fe!==null&&B++}return F/(B-1)}function Re(){const _=G(arguments),S=_.length;let F=0,B=0;const z=vt(_);let ie;for(let fe=0;fe<S;fe++){const Ne=_[fe];F+=Math.pow(typeof Ne=="number"?Ne-z:Ne===!0?1-z:0-z,2),Ne!==null&&B++}return ie=F/B,isNaN(ie)&&(ie=T),ie}He.P=function(){const _=Qe(G(arguments)),S=_.length;let F=0;const B=bt(_);let z;for(let ie=0;ie<S;ie++)F+=Math.pow(_[ie]-B,2);return z=F/S,isNaN(z)&&(z=T),z},He.S=function(){const _=Qe(G(arguments)),S=_.length;let F=0;const B=bt(_);for(let z=0;z<S;z++)F+=Math.pow(_[z]-B,2);return F/(S-1)};const xe={DIST:(_,S,F,B)=>he(_=te(_),S=te(S),F=te(F))?b:B?1-Math.exp(-Math.pow(_/F,S)):Math.pow(_,S-1)*Math.exp(-Math.pow(_/F,S))*S/Math.pow(F,S)},Ye={};function Ge(_,S,F){const B=pe(_=te(_),S=te(S),F=te(F));if(B)return B;if(S===0)return 0;S=Math.abs(S);const z=-Math.floor(Math.log(S)/Math.log(10));return _>=0?At(Math.ceil(_/S)*S,z):F===0?-At(Math.floor(Math.abs(_)/S)*S,z):-At(Math.ceil(Math.abs(_)/S)*S,z)}function Te(_,S){return pe(_=te(_),S=te(S))||(_<S?T:nt(_)/(nt(S)*nt(_-S)))}Ye.TEST=(_,S,F)=>{if(he(_=Pe(G(_)),S=te(S)))return b;F=F||Le.S(_);const B=_.length;return 1-gt.S.DIST((bt(_)-S)/(F/Math.sqrt(B)),!0)},Ge.MATH=Ge,Ge.PRECISE=Ge;const ze=[];function nt(_){if((_=te(_))instanceof Error)return _;const S=Math.floor(_);return S===0||S===1?1:(ze[S]>0||(ze[S]=nt(S-1)*S),ze[S])}function ut(_,S){const F=pe(_=te(_),S=te(S));if(F)return F;if(S===0)return 0;if(!(_>=0&&S>0||_<=0&&S<0))return T;S=Math.abs(S);const B=-Math.floor(Math.log(S)/Math.log(10));return _>=0?At(Math.floor(_/S)*S,B):-At(Math.ceil(Math.abs(_)/S),B)}ut.MATH=(_,S,F)=>{if(S instanceof Error)return S;S=S===void 0?0:S;const B=pe(_=te(_),S=te(S),F=te(F));if(B)return B;if(S===0)return 0;S=S?Math.abs(S):1;const z=-Math.floor(Math.log(S)/Math.log(10));return _>=0?At(Math.floor(_/S)*S,z):F===0||F===void 0?-At(Math.ceil(Math.abs(_)/S)*S,z):-At(Math.floor(Math.abs(_)/S)*S,z)},ut.PRECISE=ut.MATH;const _t={CEILING:Ge};function $t(_,S){const F=pe(_=te(_),S=te(S));if(F)return F;if(_===0&&S===0)return T;const B=Math.pow(_,S);return isNaN(B)?T:B}function Nt(){const _=G(arguments).filter((B=>B!=null));if(_.length===0)return 0;const S=Pe(_);if(S instanceof Error)return S;let F=1;for(let B=0;B<S.length;B++)F*=S[B];return F}function At(_,S){return pe(_=te(_),S=te(S))||+(Math.round(+(_+"e"+S))+"e"+-1*S)}function xt(){let _=0;return A(L(arguments),(S=>{if(_ instanceof Error)return!1;if(S instanceof Error)_=S;else if(typeof S=="number")_+=S;else if(typeof S=="string"){const F=parseFloat(S);!isNaN(F)&&(_+=F)}else if(Array.isArray(S)){const F=xt.apply(null,S);F instanceof Error?_=F:_+=F}})),_}var Ft=Object.freeze({__proto__:null,ADD:function(_,S){return arguments.length!==2?I:pe(_=te(_),S=te(S))||_+S},DIVIDE:function(_,S){return arguments.length!==2?I:pe(_=te(_),S=te(S))||(S===0?C:_/S)},EQ:function(_,S){return arguments.length!==2?I:_ instanceof Error?_:S instanceof Error?S:(_===null&&(_=void 0),S===null&&(S=void 0),_===S)},GT:function(_,S){return arguments.length!==2?I:_ instanceof Error?_:S instanceof Error?S:(Q(_,S)?(_=U(_),S=U(S)):(_=te(_),S=te(S)),pe(_,S)||_>S)},GTE:function(_,S){return arguments.length!==2?I:(Q(_,S)?(_=U(_),S=U(S)):(_=te(_),S=te(S)),pe(_,S)||_>=S)},LT:function(_,S){return arguments.length!==2?I:(Q(_,S)?(_=U(_),S=U(S)):(_=te(_),S=te(S)),pe(_,S)||_<S)},LTE:function(_,S){return arguments.length!==2?I:(Q(_,S)?(_=U(_),S=U(S)):(_=te(_),S=te(S)),pe(_,S)||_<=S)},MINUS:function(_,S){return arguments.length!==2?I:pe(_=te(_),S=te(S))||_-S},MULTIPLY:function(_,S){return arguments.length!==2?I:pe(_=te(_),S=te(S))||_*S},NE:function(_,S){return arguments.length!==2?I:_ instanceof Error?_:S instanceof Error?S:(_===null&&(_=void 0),S===null&&(S=void 0),_!==S)},POW:function(_,S){return arguments.length!==2?I:$t(_,S)}});const St=new Date(Date.UTC(1900,0,1)),wt=[void 0,0,1,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,1,2,3,4,5,6,0],Yt=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]],zt=[[],[6,0],[0,1],[1,2],[2,3],[3,4],[4,5],[5,6],void 0,void 0,void 0,[0,0],[1,1],[2,2],[3,3],[4,4],[5,5],[6,6]];function Ut(_,S,F){F=F.toUpperCase(),_=Ke(_),S=Ke(S);const B=_.getFullYear(),z=_.getMonth(),ie=_.getDate(),fe=S.getFullYear(),Ne=S.getMonth(),qe=S.getDate();let rt;switch(F){case"Y":rt=Math.floor(rr(_,S));break;case"D":rt=Gt(S,_);break;case"M":rt=Ne-z+12*(fe-B),qe<ie&&rt--;break;case"MD":ie<=qe?rt=qe-ie:(Ne===0?(_.setFullYear(fe-1),_.setMonth(12)):(_.setFullYear(fe),_.setMonth(Ne-1)),rt=Gt(S,_));break;case"YM":rt=Ne-z+12*(fe-B),qe<ie&&rt--,rt%=12;break;case"YD":Ne>z||Ne===z&&qe<ie?_.setFullYear(fe):_.setFullYear(fe-1),rt=Gt(S,_)}return rt}function Kt(_){const S=new Date(_);return S.setHours(0,0,0,0),S}function Gt(_,S){return _=Ke(_),S=Ke(S),_ instanceof Error?_:S instanceof Error?S:fr(Kt(_))-fr(Kt(S))}function Bt(_,S,F){if(F=Xe(F||"false"),_=Ke(_),S=Ke(S),_ instanceof Error)return _;if(S instanceof Error)return S;if(F instanceof Error)return F;const B=_.getMonth();let z,ie,fe=S.getMonth();if(F)z=_.getDate()===31?30:_.getDate(),ie=S.getDate()===31?30:S.getDate();else{const Ne=new Date(_.getFullYear(),B+1,0).getDate(),qe=new Date(S.getFullYear(),fe+1,0).getDate();z=_.getDate()===Ne?30:_.getDate(),S.getDate()===qe?z<30?(fe++,ie=1):ie=30:ie=S.getDate()}return 360*(S.getFullYear()-_.getFullYear())+30*(fe-B)+(ie-z)}function hr(_){if((_=Ke(_))instanceof Error)return _;(_=Kt(_)).setDate(_.getDate()+4-(_.getDay()||7));const S=new Date(_.getFullYear(),0,1);return Math.ceil(((_-S)/864e5+1)/7)}function Xt(_,S,F){return Xt.INTL(_,S,1,F)}function Zt(_,S,F){return Zt.INTL(_,S,1,F)}function tr(_){return new Date(_,1,29).getMonth()===1}function Qt(_,S){return Math.ceil((S-_)/1e3/60/60/24)}function rr(_,S,F){if((_=Ke(_))instanceof Error)return _;if((S=Ke(S))instanceof Error)return S;F=F||0;let B=_.getDate();const z=_.getMonth()+1,ie=_.getFullYear();let fe=S.getDate();const Ne=S.getMonth()+1,qe=S.getFullYear();switch(F){case 0:return B===31&&fe===31?(B=30,fe=30):B===31?B=30:B===30&&fe===31&&(fe=30),(fe+30*Ne+360*qe-(B+30*z+360*ie))/360;case 1:{const rt=(yt,Pt)=>{const Tt=yt.getFullYear(),Lt=new Date(Tt,2,1);if(tr(Tt)&&yt<Lt&&Pt>=Lt)return!0;const Mt=Pt.getFullYear(),jt=new Date(Mt,2,1);return tr(Mt)&&Pt>=jt&&yt<jt};let ct=365;if(ie===qe||ie+1===qe&&(z>Ne||z===Ne&&B>=fe))return(ie===qe&&tr(ie)||rt(_,S)||Ne===1&&fe===29)&&(ct=366),Qt(_,S)/ct;const pt=qe-ie+1,dt=(new Date(qe+1,0,1)-new Date(ie,0,1))/1e3/60/60/24/pt;return Qt(_,S)/dt}case 2:return Qt(_,S)/360;case 3:return Qt(_,S)/365;case 4:return(fe+30*Ne+360*qe-(B+30*z+360*ie))/360}}function fr(_){const S=_>-22038912e5?2:1;return Math.ceil((_-St)/864e5)+S}function gr(_){return(_=te(_))===0?b:_ instanceof Error?_:String.fromCharCode(_)}function pr(_){if(he(_))return _;let S=(_=_||"").charCodeAt(0);return isNaN(S)&&(S=b),S}function mr(){const _=G(arguments),S=pe.apply(void 0,_);if(S)return S;let F=0;for(;(F=_.indexOf(!0))>-1;)_[F]="TRUE";let B=0;for(;(B=_.indexOf(!1))>-1;)_[B]="FALSE";return _.join("")}Xt.INTL=(_,S,F,B)=>{if((_=Ke(_))instanceof Error)return _;if((S=Ke(S))instanceof Error)return S;let z=!1;const ie=[],fe=[1,2,3,4,5,6,0],Ne=new RegExp("^[0|1]{7}$");if(F===void 0)F=zt[1];else if(typeof F=="string"&&Ne.test(F)){z=!0,F=F.split("");for(let pt=0;pt<F.length;pt++)F[pt]==="1"&&ie.push(fe[pt])}else F=zt[F];if(!(F instanceof Array))return b;B===void 0?B=[]:B instanceof Array||(B=[B]);for(let pt=0;pt<B.length;pt++){const dt=Ke(B[pt]);if(dt instanceof Error)return dt;B[pt]=dt}const qe=Math.round((S-_)/864e5)+1;let rt=qe;const ct=_;for(let pt=0;pt<qe;pt++){const dt=new Date().getTimezoneOffset()>0?ct.getUTCDay():ct.getDay();let yt=z?ie.includes(dt):dt===F[0]||dt===F[1];for(let Pt=0;Pt<B.length;Pt++){const Tt=B[Pt];if(Tt.getDate()===ct.getDate()&&Tt.getMonth()===ct.getMonth()&&Tt.getFullYear()===ct.getFullYear()){yt=!0;break}}yt&&rt--,ct.setDate(ct.getDate()+1)}return rt},Zt.INTL=(_,S,F,B)=>{if((_=Ke(_))instanceof Error)return _;if((S=te(S))instanceof Error)return S;if(S<0)return T;if(!((F=F===void 0?zt[1]:zt[F])instanceof Array))return b;B===void 0?B=[]:B instanceof Array||(B=[B]);for(let ie=0;ie<B.length;ie++){const fe=Ke(B[ie]);if(fe instanceof Error)return fe;B[ie]=fe}let z=0;for(;z<S;){_.setDate(_.getDate()+1);const ie=_.getDay();if(ie!==F[0]&&ie!==F[1]){for(let fe=0;fe<B.length;fe++){const Ne=B[fe];if(Ne.getDate()===_.getDate()&&Ne.getMonth()===_.getMonth()&&Ne.getFullYear()===_.getFullYear()){z--;break}}z++}}return _};const br=mr;function vr(_,S=2,F=!1){if(_=te(_),isNaN(_)||(S=te(S),isNaN(S)))return b;if(S<0){const B=Math.pow(10,-S);_=Math.round(_/B)*B}else _=_.toFixed(S);if(F)_=_.toString().replace(/,/g,"");else{const B=_.toString().split(".");B[0]=B[0].replace(/\B(?=(\d{3})+$)/g,","),_=B.join(".")}return _}function Ht(_,S){return pe(_,S)||(_=U(_),(S=te(S))instanceof Error?S:new Array(S+1).join(_))}const Sr=gr,Er=pr;function nr(_){return/^[01]{1,10}$/.test(_)}function Dt(_,S,F){if(he(_=te(_),S=te(S)))return _;if((F=F===void 0?"i":F)!=="i"&&F!=="j")return b;if(_===0&&S===0)return 0;if(_===0)return S===1?F:S.toString()+F;if(S===0)return _.toString();{const B=S>0?"+":"";return _.toString()+B+(S===1?F:S.toString()+F)}}function ir(_,S){return S=S===void 0?0:S,he(_=te(_),S=te(S))?b:v.erf(_)}function sr(_){return isNaN(_)?b:v.erfc(_)}function or(_){const S=Ot(_),F=It(_);return he(S,F)?b:Math.sqrt(Math.pow(S,2)+Math.pow(F,2))}function It(_){if(_===void 0||_===!0||_===!1)return b;if(_===0||_==="0")return 0;if(["i","j"].indexOf(_)>=0)return 1;let S=(_=(_+="").replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),F=_.indexOf("-");S===0&&(S=_.indexOf("+",1)),F===0&&(F=_.indexOf("-",1));const B=_.substring(_.length-1,_.length),z=B==="i"||B==="j";return S>=0||F>=0?z?S>=0?isNaN(_.substring(0,S))||isNaN(_.substring(S+1,_.length-1))?T:Number(_.substring(S+1,_.length-1)):isNaN(_.substring(0,F))||isNaN(_.substring(F+1,_.length-1))?T:-Number(_.substring(F+1,_.length-1)):T:z?isNaN(_.substring(0,_.length-1))?T:_.substring(0,_.length-1):isNaN(_)?T:0}function ar(_){const S=Ot(_),F=It(_);return he(S,F)?b:S===0&&F===0?C:S===0&&F>0?Math.PI/2:S===0&&F<0?-Math.PI/2:F===0&&S>0?0:F===0&&S<0?-Math.PI:S>0?Math.atan(F/S):S<0&&F>=0?Math.atan(F/S)+Math.PI:Math.atan(F/S)-Math.PI}function Jt(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.cos(S)*(Math.exp(F)+Math.exp(-F))/2,-Math.sin(S)*(Math.exp(F)-Math.exp(-F))/2,B)}function _r(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.cos(F)*(Math.exp(S)+Math.exp(-S))/2,Math.sin(F)*(Math.exp(S)-Math.exp(-S))/2,B)}function Vt(_,S){const F=Ot(_),B=It(_),z=Ot(S),ie=It(S);if(he(F,B,z,ie))return b;const fe=_.substring(_.length-1),Ne=S.substring(S.length-1);let qe="i";if((fe==="j"||Ne==="j")&&(qe="j"),z===0&&ie===0)return T;const rt=z*z+ie*ie;return Dt((F*z+B*ie)/rt,(B*z-F*ie)/rt,qe)}function Ot(_){if(_===void 0||_===!0||_===!1)return b;if(_===0||_==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(_)>=0)return 0;let S=(_+="").indexOf("+"),F=_.indexOf("-");S===0&&(S=_.indexOf("+",1)),F===0&&(F=_.indexOf("-",1));const B=_.substring(_.length-1,_.length),z=B==="i"||B==="j";return S>=0||F>=0?z?S>=0?isNaN(_.substring(0,S))||isNaN(_.substring(S+1,_.length-1))?T:Number(_.substring(0,S)):isNaN(_.substring(0,F))||isNaN(_.substring(F+1,_.length-1))?T:Number(_.substring(0,F)):T:z?isNaN(_.substring(0,_.length-1))?T:0:isNaN(_)?T:_}function er(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.sin(S)*(Math.exp(F)+Math.exp(-F))/2,Math.cos(S)*(Math.exp(F)-Math.exp(-F))/2,B)}function yr(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.cos(F)*(Math.exp(S)-Math.exp(-S))/2,Math.sin(F)*(Math.exp(S)+Math.exp(-S))/2,B)}ir.PRECISE=()=>{throw new Error("ERF.PRECISE is not implemented")},sr.PRECISE=()=>{throw new Error("ERFC.PRECISE is not implemented")};const Rr=mt.DIST,Pr=mt.INV,Tr=Et.DIST,Ir=Ge.MATH,Or=Ge.PRECISE,$r=Rt.DIST,Ar=Rt.DIST.RT,Mr=Rt.INV,xr=Rt.INV.RT,Nr=Rt.TEST,Fr=re.P,Dr=re.P,Lr=re.S,Hr=Et.INV,kr=sr.PRECISE,Br=ir.PRECISE,jr=Ee.DIST,Gr=we.DIST,Vr=we.DIST.RT,Wr=we.INV,Ur=we.INV.RT,qr=ut.MATH,Yr=ut.PRECISE,zr=we.TEST,Kr=Y.DIST,Xr=Y.INV,Zr=se.PRECISE,Qr=_e.DIST,Jr=je.INV,en=je.DIST,tn=je.INV,rn=at.MULT,nn=at.SNGL,sn=ft.DIST,on=Xt.INTL,an=gt.DIST,ln=gt.INV,cn=gt.S.DIST,un=gt.S.INV,dn=We.EXC,hn=We.INC,fn=tt.EXC,gn=tt.INC,pn=ue.DIST,mn=be.EXC,vn=be.INC,_n=j.AVG,yn=j.EQ,Cn=J.P,wn=Le.P,bn=Le.S,Sn=me.DIST,En=me.DIST.RT,Rn=me.INV,Pn=me.TEST,Tn=He.P,In=He.S,On=xe.DIST,$n=Zt.INTL,An=Ye.TEST;function lr(_){const S=[];return A(_,(F=>{F&&S.push(F)})),S}function kt(_,S){const F={};for(let ie=1;ie<_[0].length;++ie)F[ie]=!0;let B=S[0].length;for(let ie=1;ie<S.length;++ie)S[ie].length>B&&(B=S[ie].length);for(let ie=1;ie<_.length;++ie)for(let fe=1;fe<_[ie].length;++fe){let Ne=!1,qe=!1;for(let rt=0;rt<S.length;++rt){const ct=S[rt];if(ct.length<B)continue;const pt=ct[0];if(_[ie][0]===pt){qe=!0;for(let dt=1;dt<ct.length;++dt)if(!Ne)if(ct[dt]===void 0||ct[dt]==="*")Ne=!0;else{const yt=De(ct[dt]+""),Pt=[ge(_[ie][fe],Se)].concat(yt);Ne=$e(Pt)}}}qe&&(F[fe]=F[fe]&&Ne)}const z=[];for(let ie=0;ie<_[0].length;++ie)F[ie]&&z.push(ie-1);return z}function cr(_){return _&&_.getTime&&!isNaN(_.getTime())}function ur(_){return _ instanceof Date?_:new Date(_)}function Wt(_,S,F,B,z){if(B=B||0,z=z||0,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z)))return b;let ie;if(_===0)ie=B+F*S;else{const fe=Math.pow(1+_,S);ie=z===1?B*fe+F*(1+_)*(fe-1)/_:B*fe+F*(fe-1)/_}return-ie}function Cr(_,S,F,B,z,ie){if(z=z||0,ie=ie||0,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z),ie=te(ie)))return b;const fe=qt(_,F,B,z,ie);return(S===1?ie===1?0:-B:ie===1?Wt(_,S-2,fe,B,1)-fe:Wt(_,S-1,fe,B,0))*_}function dr(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=_[0];let F=0;for(let B=1;B<_.length;B++)F+=_[B]/Math.pow(1+S,B);return F}function qt(_,S,F,B,z){if(B=B||0,z=z||0,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z)))return b;let ie;if(_===0)ie=(F+B)/S;else{const fe=Math.pow(1+_,S);ie=z===1?(B*_/(fe-1)+F*_/(1-1/fe))/(1+_):B*_/(fe-1)+F*_/(1-1/fe)}return-ie}const Mn={errors:H,symbols:Ft};m.ABS=function(_){return(_=te(_))instanceof Error?_:Math.abs(_)},m.ACCRINT=function(_,S,F,B,z,ie,fe){return _=ur(_),S=ur(S),F=ur(F),cr(_)&&cr(S)&&cr(F)?B<=0||z<=0||[1,2,4].indexOf(ie)===-1||[0,1,2,3,4].indexOf(fe)===-1||F<=_?T:(z=z||0)*B*rr(_,F,fe=fe||0):b},m.ACCRINTM=function(){throw new Error("ACCRINTM is not implemented")},m.ACOS=function(_){if((_=te(_))instanceof Error)return _;let S=Math.acos(_);return isNaN(S)&&(S=T),S},m.ACOSH=function(_){if((_=te(_))instanceof Error)return _;let S=Math.log(_+Math.sqrt(_*_-1));return isNaN(S)&&(S=T),S},m.ACOT=function(_){return(_=te(_))instanceof Error?_:Math.atan(1/_)},m.ACOTH=function(_){if((_=te(_))instanceof Error)return _;let S=.5*Math.log((_+1)/(_-1));return isNaN(S)&&(S=T),S},m.AGGREGATE=function(_,S,F,B){if(he(_=te(_),te(_)))return b;switch(_){case 1:return bt(F);case 2:return q(F);case 3:return D(F);case 4:return Ue(F);case 5:return st(F);case 6:return Nt(F);case 7:return Le.S(F);case 8:return Le.P(F);case 9:return xt(F);case 10:return He.S(F);case 11:return He.P(F);case 12:return et(F);case 13:return at.SNGL(F);case 14:return Ae(F,B);case 15:return Ce(F,B);case 16:return We.INC(F,B);case 17:return be.INC(F,B);case 18:return We.EXC(F,B);case 19:return be.EXC(F,B)}},m.AMORDEGRC=function(){throw new Error("AMORDEGRC is not implemented")},m.AMORLINC=function(){throw new Error("AMORLINC is not implemented")},m.AND=function(){const _=G(arguments);let S=b;for(let F=0;F<_.length;F++){if(_[F]instanceof Error)return _[F];_[F]!==void 0&&_[F]!==null&&typeof _[F]!="string"&&(S===b&&(S=!0),_[F]||(S=!1))}return S},m.ARABIC=function(_){if(_==null)return 0;if(_ instanceof Error)return _;if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(_))return b;let S=0;return _.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,(F=>{S+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[F]})),S},m.ASC=function(){throw new Error("ASC is not implemented")},m.ASIN=function(_){if((_=te(_))instanceof Error)return _;let S=Math.asin(_);return isNaN(S)&&(S=T),S},m.ASINH=function(_){return(_=te(_))instanceof Error?_:Math.log(_+Math.sqrt(_*_+1))},m.ATAN=function(_){return(_=te(_))instanceof Error?_:Math.atan(_)},m.ATAN2=function(_,S){return pe(_=te(_),S=te(S))||Math.atan2(_,S)},m.ATANH=function(_){if((_=te(_))instanceof Error)return _;let S=Math.log((1+_)/(1-_))/2;return isNaN(S)&&(S=T),S},m.AVEDEV=function(){const _=G(arguments).filter(ee);if(_.length===0)return T;const S=Pe(_);return S instanceof Error?S:v.sum(v(S).subtract(v.mean(S)).abs()[0])/S.length},m.AVERAGE=bt,m.AVERAGEA=vt,m.AVERAGEIF=function(_,S,F){if(arguments.length<=1)return I;if(F=Pe(G(F=F||_).filter(ee)),_=G(_),F instanceof Error)return F;let B=0,z=0;const ie=S===void 0||S==="*",fe=ie?null:De(S+"");for(let Ne=0;Ne<_.length;Ne++){const qe=_[Ne];if(ie)z+=F[Ne],B++;else{const rt=[ge(qe,Se)].concat(fe);$e(rt)&&(z+=F[Ne],B++)}}return z/B},m.AVERAGEIFS=function(){const _=L(arguments),S=(_.length-1)/2,F=G(_[0]);let B=0,z=0;for(let fe=0;fe<F.length;fe++){let Ne=!1;for(let qe=0;qe<S;qe++){const rt=_[2*qe+1][fe],ct=_[2*qe+2];let pt=!1;if(ct===void 0||ct==="*")pt=!0;else{const dt=De(ct+""),yt=[ge(rt,Se)].concat(dt);pt=$e(yt)}if(!pt){Ne=!1;break}Ne=!0}Ne&&(z+=F[fe],B++)}const ie=z/B;return isNaN(ie)?0:ie},m.BAHTTEXT=function(){throw new Error("BAHTTEXT is not implemented")},m.BASE=function(_,S,F){const B=pe(_=te(_),S=te(S),F=te(F));if(B)return B;if(S===0)return T;const z=_.toString(S);return new Array(Math.max(F+1-z.length,0)).join("0")+z},m.BESSELI=function(_,S){return he(_=te(_),S=te(S))?b:w.besseli(_,S)},m.BESSELJ=function(_,S){return he(_=te(_),S=te(S))?b:w.besselj(_,S)},m.BESSELK=function(_,S){return he(_=te(_),S=te(S))?b:w.besselk(_,S)},m.BESSELY=function(_,S){return he(_=te(_),S=te(S))?b:w.bessely(_,S)},m.BETA=mt,m.BETADIST=Rr,m.BETAINV=Pr,m.BIN2DEC=function(_){if(!nr(_))return T;const S=parseInt(_,2),F=_.toString();return F.length===10&&F.substring(0,1)==="1"?parseInt(F.substring(1),2)-512:S},m.BIN2HEX=function(_,S){if(!nr(_))return T;const F=_.toString();if(F.length===10&&F.substring(0,1)==="1")return(0xfffffffe00+parseInt(F.substring(1),2)).toString(16);const B=parseInt(_,2).toString(16);return S===void 0?B:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=B.length?Ht("0",S-B.length)+B:T},m.BIN2OCT=function(_,S){if(!nr(_))return T;const F=_.toString();if(F.length===10&&F.substring(0,1)==="1")return(1073741312+parseInt(F.substring(1),2)).toString(8);const B=parseInt(_,2).toString(8);return S===void 0?B:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=B.length?Ht("0",S-B.length)+B:T},m.BINOM=Et,m.BINOMDIST=Tr,m.BITAND=function(_,S){return he(_=te(_),S=te(S))?b:_<0||S<0||Math.floor(_)!==_||Math.floor(S)!==S||_>0xffffffffffff||S>0xffffffffffff?T:_&S},m.BITLSHIFT=function(_,S){return he(_=te(_),S=te(S))?b:_<0||Math.floor(_)!==_||_>0xffffffffffff||Math.abs(S)>53?T:S>=0?_<<S:_>>-S},m.BITOR=function(_,S){return he(_=te(_),S=te(S))?b:_<0||S<0||Math.floor(_)!==_||Math.floor(S)!==S||_>0xffffffffffff||S>0xffffffffffff?T:_|S},m.BITRSHIFT=function(_,S){return he(_=te(_),S=te(S))?b:_<0||Math.floor(_)!==_||_>0xffffffffffff||Math.abs(S)>53?T:S>=0?_>>S:_<<-S},m.BITXOR=function(_,S){return he(_=te(_),S=te(S))?b:_<0||S<0||Math.floor(_)!==_||Math.floor(S)!==S||_>0xffffffffffff||S>0xffffffffffff?T:_^S},m.CEILING=Ge,m.CEILINGMATH=Ir,m.CEILINGPRECISE=Or,m.CELL=function(){throw new Error("CELL is not implemented")},m.CHAR=gr,m.CHIDIST=$r,m.CHIDISTRT=Ar,m.CHIINV=Mr,m.CHIINVRT=xr,m.CHISQ=Rt,m.CHITEST=Nr,m.CHOOSE=function(){if(arguments.length<2)return I;const _=arguments[0];return _<1||_>254||arguments.length<_+1?b:arguments[_]},m.CLEAN=function(_){return he(_)?_:(_=_||"").replace(/[\0-\x1F]/g,"")},m.CODE=pr,m.COLUMN=function(_,S){return arguments.length!==2?I:S<0?T:_ instanceof Array&&typeof S=="number"?_.length!==0?v.col(_,S):void 0:b},m.COLUMNS=function(_){return arguments.length!==1?I:_ instanceof Array?_.length===0?0:v.cols(_):b},m.COMBIN=Te,m.COMBINA=function(_,S){return pe(_=te(_),S=te(S))||(_<S?T:_===0&&S===0?1:Te(_+S-1,_-1))},m.COMPLEX=Dt,m.CONCAT=br,m.CONCATENATE=mr,m.CONFIDENCE=V,m.CONVERT=function(_,S,F){if((_=te(_))instanceof Error)return _;const B=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["ångström","Å",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic ångström","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","°",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["œrsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","Ω",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdestärke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square ångström","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],z={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},ie={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]};let fe,Ne=null,qe=null,rt=S,ct=F,pt=1,dt=1;for(let yt=0;yt<B.length;yt++)fe=B[yt][2]===null?[]:B[yt][2],(B[yt][1]===rt||fe.indexOf(rt)>=0)&&(Ne=B[yt]),(B[yt][1]===ct||fe.indexOf(ct)>=0)&&(qe=B[yt]);if(Ne===null){const yt=z[S.substring(0,2)];let Pt=ie[S.substring(0,1)];S.substring(0,2)==="da"&&(Pt=["dekao",10,"da"]),yt?(pt=yt[2],rt=S.substring(2)):Pt&&(pt=Pt[1],rt=S.substring(Pt[2].length));for(let Tt=0;Tt<B.length;Tt++)fe=B[Tt][2]===null?[]:B[Tt][2],(B[Tt][1]===rt||fe.indexOf(rt)>=0)&&(Ne=B[Tt])}if(qe===null){const yt=z[F.substring(0,2)];let Pt=ie[F.substring(0,1)];F.substring(0,2)==="da"&&(Pt=["dekao",10,"da"]),yt?(dt=yt[2],ct=F.substring(2)):Pt&&(dt=Pt[1],ct=F.substring(Pt[2].length));for(let Tt=0;Tt<B.length;Tt++)fe=B[Tt][2]===null?[]:B[Tt][2],(B[Tt][1]===ct||fe.indexOf(ct)>=0)&&(qe=B[Tt])}return Ne===null||qe===null||Ne[3]!==qe[3]?I:_*Ne[6]*pt/(qe[6]*dt)},m.CORREL=function(_,S){return he(_=Pe(G(_)),S=Pe(G(S)))?b:v.corrcoeff(_,S)},m.COS=function(_){return(_=te(_))instanceof Error?_:Math.cos(_)},m.COSH=function(_){return(_=te(_))instanceof Error?_:(Math.exp(_)+Math.exp(-_))/2},m.COT=function(_){return(_=te(_))instanceof Error?_:_===0?C:1/Math.tan(_)},m.COTH=function(_){if((_=te(_))instanceof Error)return _;if(_===0)return C;const S=Math.exp(2*_);return(S+1)/(S-1)},m.COUNT=q,m.COUNTA=D,m.COUNTBLANK=O,m.COUNTIF=function(_,S){if(_=G(_),S===void 0||S==="*")return _.length;let F=0;const B=De(S+"");for(let z=0;z<_.length;z++){const ie=[ge(_[z],Se)].concat(B);$e(ie)&&F++}return F},m.COUNTIFS=function(){const _=L(arguments),S=new Array(G(_[0]).length);for(let B=0;B<S.length;B++)S[B]=!0;for(let B=0;B<_.length;B+=2){const z=G(_[B]),ie=_[B+1];if(ie!==void 0&&ie!=="*"){const fe=De(ie+"");for(let Ne=0;Ne<z.length;Ne++){const qe=[ge(z[Ne],Se)].concat(fe);S[Ne]=S[Ne]&&$e(qe)}}}let F=0;for(let B=0;B<S.length;B++)S[B]&&F++;return F},m.COUPDAYBS=function(){throw new Error("COUPDAYBS is not implemented")},m.COUPDAYS=function(){throw new Error("COUPDAYS is not implemented")},m.COUPDAYSNC=function(){throw new Error("COUPDAYSNC is not implemented")},m.COUPNCD=function(){throw new Error("COUPNCD is not implemented")},m.COUPNUM=function(){throw new Error("COUPNUM is not implemented")},m.COUPPCD=function(){throw new Error("COUPPCD is not implemented")},m.COVAR=Fr,m.COVARIANCE=re,m.COVARIANCEP=Dr,m.COVARIANCES=Lr,m.CRITBINOM=Hr,m.CSC=function(_){return(_=te(_))instanceof Error?_:_===0?C:1/Math.sin(_)},m.CSCH=function(_){return(_=te(_))instanceof Error?_:_===0?C:2/(Math.exp(_)-Math.exp(-_))},m.CUMIPMT=function(_,S,F,B,z,ie){if(he(_=te(_),S=te(S),F=te(F)))return b;if(_<=0||S<=0||F<=0||B<1||z<1||B>z||ie!==0&&ie!==1)return T;const fe=qt(_,S,F,0,ie);let Ne=0;B===1&&(ie===0&&(Ne=-F),B++);for(let qe=B;qe<=z;qe++)Ne+=ie===1?Wt(_,qe-2,fe,F,1)-fe:Wt(_,qe-1,fe,F,0);return Ne*=_,Ne},m.CUMPRINC=function(_,S,F,B,z,ie){if(he(_=te(_),S=te(S),F=te(F)))return b;if(_<=0||S<=0||F<=0||B<1||z<1||B>z||ie!==0&&ie!==1)return T;const fe=qt(_,S,F,0,ie);let Ne=0;B===1&&(Ne=ie===0?fe+F*_:fe,B++);for(let qe=B;qe<=z;qe++)Ne+=ie>0?fe-(Wt(_,qe-2,fe,F,1)-fe)*_:fe-Wt(_,qe-1,fe,F,0)*_;return Ne},m.DATE=function(_,S,F){let B;return he(_=te(_),S=te(S),F=te(F))?B=b:(B=new Date(_,S-1,F),B.getFullYear()<0&&(B=T)),B},m.DATEDIF=Ut,m.DATEVALUE=function(_){if(typeof _!="string")return b;const S=Date.parse(_);return isNaN(S)?b:new Date(_)},m.DAVERAGE=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);let ie=0;return A(B,(fe=>{ie+=z[fe]})),B.length===0?C:ie/B.length},m.DAY=function(_){const S=Ke(_);return S instanceof Error?S:S.getDate()},m.DAYS=Gt,m.DAYS360=Bt,m.DB=function(_,S,F,B,z){if(z=z===void 0?12:z,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z)))return b;if(_<0||S<0||F<0||B<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(z)===-1||B>F)return T;if(S>=_)return 0;const ie=(1-Math.pow(S/_,1/F)).toFixed(3),fe=_*ie*z/12;let Ne=fe,qe=0;const rt=B===F?F-1:B;for(let ct=2;ct<=rt;ct++)qe=(_-Ne)*ie,Ne+=qe;return B===1?fe:B===F?(_-Ne)*ie:qe},m.DBCS=function(){throw new Error("DBCS is not implemented")},m.DCOUNT=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);const ie=[];return A(B,(fe=>{ie.push(z[fe])})),q(ie)},m.DCOUNTA=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);const ie=[];return A(B,(fe=>{ie.push(z[fe])})),D(ie)},m.DDB=function(_,S,F,B,z){if(z=z===void 0?2:z,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z)))return b;if(_<0||S<0||F<0||B<0||z<=0||B>F)return T;if(S>=_)return 0;let ie=0,fe=0;for(let Ne=1;Ne<=B;Ne++)fe=Math.min(z/F*(_-ie),_-S-ie),ie+=fe;return fe},m.DEC2BIN=function(_,S){if((_=te(_))instanceof Error)return _;if(!/^-?[0-9]{1,3}$/.test(_)||_<-512||_>511)return T;if(_<0)return"1"+Ht("0",9-(512+_).toString(2).length)+(512+_).toString(2);const F=parseInt(_,10).toString(2);return S===void 0?F:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=F.length?Ht("0",S-F.length)+F:T},m.DEC2HEX=function(_,S){if((_=te(_))instanceof Error)return _;if(!/^-?[0-9]{1,12}$/.test(_)||_<-549755813888||_>549755813887)return T;if(_<0)return(1099511627776+_).toString(16);const F=parseInt(_,10).toString(16);return S===void 0?F:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=F.length?Ht("0",S-F.length)+F:T},m.DEC2OCT=function(_,S){if((_=te(_))instanceof Error)return _;if(!/^-?[0-9]{1,9}$/.test(_)||_<-536870912||_>536870911)return T;if(_<0)return(1073741824+_).toString(8);const F=parseInt(_,10).toString(8);return S===void 0?F:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=F.length?Ht("0",S-F.length)+F:T},m.DECIMAL=function(_,S){return arguments.length<1?b:pe(_=te(_),S=te(S))||(S===0?T:parseInt(_,S))},m.DEGREES=function(_){return(_=te(_))instanceof Error?_:180*_/Math.PI},m.DELTA=function(_,S){return S=S===void 0?0:S,he(_=te(_),S=te(S))?b:_===S?1:0},m.DEVSQ=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=v.mean(_);let F=0;for(let B=0;B<_.length;B++)F+=Math.pow(_[B]-S,2);return F},m.DGET=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];return z=X(typeof S=="string"?_[ye(_,S)]:_[S]),B.length===0?b:B.length>1?T:z[B[0]]},m.DISC=function(_,S,F,B,z){if(he(_=Ke(_),S=Ke(S),F=te(F),B=te(B),z=(z=te(z))||0))return b;if(F<=0||B<=0)return T;if(_>=S)return b;let ie,fe;switch(z){case 0:ie=360,fe=Bt(_,S,!1);break;case 1:case 3:ie=365,fe=Ut(_,S,"D");break;case 2:ie=360,fe=Ut(_,S,"D");break;case 4:ie=360,fe=Bt(_,S,!0);break;default:return T}return(B-F)/B*ie/fe},m.DMAX=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);let ie=z[B[0]];return A(B,(fe=>{ie<z[fe]&&(ie=z[fe])})),ie},m.DMIN=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);let ie=z[B[0]];return A(B,(fe=>{ie>z[fe]&&(ie=z[fe])})),ie},m.DOLLAR=function(_,S=2){if(_=te(_),isNaN(_))return b;const F={style:"currency",currency:"USD",minimumFractionDigits:S>=0?S:0,maximumFractionDigits:S>=0?S:0},B=(_=At(_,S)).toLocaleString("en-US",F);return _<0?"$("+B.slice(2)+")":B},m.DOLLARDE=function(_,S){if(he(_=te(_),S=te(S)))return b;if(S<0)return T;if(S>=0&&S<1)return C;S=parseInt(S,10);let F=parseInt(_,10);F+=_%1*Math.pow(10,Math.ceil(Math.log(S)/Math.LN10))/S;const B=Math.pow(10,Math.ceil(Math.log(S)/Math.LN2)+1);return F=Math.round(F*B)/B,F},m.DOLLARFR=function(_,S){if(he(_=te(_),S=te(S)))return b;if(S<0)return T;if(S>=0&&S<1)return C;S=parseInt(S,10);let F=parseInt(_,10);return F+=_%1*Math.pow(10,-Math.ceil(Math.log(S)/Math.LN10))*S,F},m.DPRODUCT=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const Ne=ye(_,S);z=X(_[Ne])}else z=X(_[S]);let ie=[];A(B,(Ne=>{ie.push(z[Ne])})),ie=lr(ie);let fe=1;return A(ie,(Ne=>{fe*=Ne})),fe},m.DSTDEV=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);let ie=[];return A(B,(fe=>{ie.push(z[fe])})),ie=lr(ie),Le.S(ie)},m.DSTDEVP=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);let ie=[];return A(B,(fe=>{ie.push(z[fe])})),ie=lr(ie),Le.P(ie)},m.DSUM=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);const ie=[];return A(B,(fe=>{ie.push(z[fe])})),xt(ie)},m.DURATION=function(){throw new Error("DURATION is not implemented")},m.DVAR=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);const ie=[];return A(B,(fe=>{ie.push(z[fe])})),He.S(ie)},m.DVARP=function(_,S,F){if(isNaN(S)&&typeof S!="string")return b;const B=kt(_,F);let z=[];if(typeof S=="string"){const fe=ye(_,S);z=X(_[fe])}else z=X(_[S]);const ie=[];return A(B,(fe=>{ie.push(z[fe])})),He.P(ie)},m.EDATE=function(_,S){return(_=Ke(_))instanceof Error?_:isNaN(S)?b:(S=parseInt(S,10),_.setMonth(_.getMonth()+S),_)},m.EFFECT=function(_,S){return he(_=te(_),S=te(S))?b:_<=0||S<1?T:(S=parseInt(S,10),Math.pow(1+_/S,S)-1)},m.EOMONTH=function(_,S){return(_=Ke(_))instanceof Error?_:isNaN(S)?b:(S=parseInt(S,10),new Date(_.getFullYear(),_.getMonth()+S+1,0))},m.ERF=ir,m.ERFC=sr,m.ERFCPRECISE=kr,m.ERFPRECISE=Br,m.ERROR=Fe,m.EVEN=function(_){return(_=te(_))instanceof Error?_:Ge(_,-2,-1)},m.EXACT=function(_,S){return arguments.length!==2?I:pe(_,S)||(_=U(_))===U(S)},m.EXP=function(_){return arguments.length<1?I:arguments.length>1?M:(_=te(_))instanceof Error?_:_=Math.exp(_)},m.EXPON=Ee,m.EXPONDIST=jr,m.F=we,m.FACT=nt,m.FACTDOUBLE=function _(S){if((S=te(S))instanceof Error)return S;const F=Math.floor(S);return F<=0?1:F*_(F-2)},m.FALSE=function(){return!1},m.FDIST=Gr,m.FDISTRT=Vr,m.FIND=function(_,S,F){if(arguments.length<2)return I;_=U(_),F=F===void 0?0:F;const B=(S=U(S)).indexOf(_,F-1);return B===-1?b:B+1},m.FINV=Wr,m.FINVRT=Ur,m.FISHER=function(_){return(_=te(_))instanceof Error?_:Math.log((1+_)/(1-_))/2},m.FISHERINV=function(_){if((_=te(_))instanceof Error)return _;const S=Math.exp(2*_);return(S-1)/(S+1)},m.FIXED=vr,m.FLOOR=ut,m.FLOORMATH=qr,m.FLOORPRECISE=Yr,m.FORECAST=Z,m.FREQUENCY=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;const F=_.length,B=S.length,z=[];for(let ie=0;ie<=B;ie++){z[ie]=0;for(let fe=0;fe<F;fe++)ie===0?_[fe]<=S[0]&&(z[0]+=1):ie<B?_[fe]>S[ie-1]&&_[fe]<=S[ie]&&(z[ie]+=1):ie===B&&_[fe]>S[B-1]&&(z[B]+=1)}return z},m.FTEST=zr,m.FV=Wt,m.FVSCHEDULE=function(_,S){if(he(_=te(_),S=Pe(G(S))))return b;const F=S.length;let B=_;for(let z=0;z<F;z++)B*=1+S[z];return B},m.GAMMA=Y,m.GAMMADIST=Kr,m.GAMMAINV=Xr,m.GAMMALN=se,m.GAMMALNPRECISE=Zr,m.GAUSS=function(_){return(_=te(_))instanceof Error?_:v.normal.cdf(_,0,1)-.5},m.GCD=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=_.length,F=_[0];let B=F<0?-F:F;for(let z=1;z<S;z++){const ie=_[z];let fe=ie<0?-ie:ie;for(;B&&fe;)B>fe?B%=fe:fe%=B;B+=fe}return B},m.GEOMEAN=function(){const _=Pe(G(arguments));return _ instanceof Error?_:v.geomean(_)},m.GESTEP=function(_,S){return he(S=S||0,_=te(_))?_:_>=S?1:0},m.GROWTH=function(_,S,F,B){if((_=Pe(_))instanceof Error)return _;let z;if(S===void 0)for(S=[],z=1;z<=_.length;z++)S.push(z);if(F===void 0)for(F=[],z=1;z<=_.length;z++)F.push(z);if(he(S=Pe(S),F=Pe(F)))return b;B===void 0&&(B=!0);const ie=_.length;let fe,Ne,qe=0,rt=0,ct=0,pt=0;for(z=0;z<ie;z++){const yt=S[z],Pt=Math.log(_[z]);qe+=yt,rt+=Pt,ct+=yt*Pt,pt+=yt*yt}qe/=ie,rt/=ie,ct/=ie,pt/=ie,B?(fe=(ct-qe*rt)/(pt-qe*qe),Ne=rt-fe*qe):(fe=ct/pt,Ne=0);const dt=[];for(z=0;z<F.length;z++)dt.push(Math.exp(Ne+fe*F[z]));return dt},m.HARMEAN=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=_.length;let F=0;for(let B=0;B<S;B++)F+=1/_[B];return S/F},m.HEX2BIN=function(_,S){if(!/^[0-9A-Fa-f]{1,10}$/.test(_))return T;const F=!(_.length!==10||_.substring(0,1).toLowerCase()!=="f"),B=F?parseInt(_,16)-1099511627776:parseInt(_,16);if(B<-512||B>511)return T;if(F)return"1"+Ht("0",9-(512+B).toString(2).length)+(512+B).toString(2);const z=B.toString(2);return S===void 0?z:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=z.length?Ht("0",S-z.length)+z:T},m.HEX2DEC=function(_){if(!/^[0-9A-Fa-f]{1,10}$/.test(_))return T;const S=parseInt(_,16);return S>=549755813888?S-1099511627776:S},m.HEX2OCT=function(_,S){if(!/^[0-9A-Fa-f]{1,10}$/.test(_))return T;const F=parseInt(_,16);if(F>536870911&&F<0xffe0000000)return T;if(F>=0xffe0000000)return(F-0xffc0000000).toString(8);const B=F.toString(8);return S===void 0?B:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=B.length?Ht("0",S-B.length)+B:T},m.HLOOKUP=function(_,S,F,B){return Ct(_,le(S),F,B)},m.HOUR=function(_){return(_=Ke(_))instanceof Error?_:_.getHours()},m.HYPGEOM=_e,m.HYPGEOMDIST=Qr,m.IF=function(_,S,F){return _ instanceof Error?_:((S=!(arguments.length>=2)||S)==null&&(S=0),(F=arguments.length===3&&F)==null&&(F=0),_?S:F)},m.IFERROR=function(_,S){return Be(_)?S:_},m.IFNA=function(_,S){return _===I?S:_},m.IFS=function(){for(let _=0;_<arguments.length/2;_++)if(arguments[2*_])return arguments[2*_+1];return I},m.IMABS=or,m.IMAGINARY=It,m.IMARGUMENT=ar,m.IMCONJUGATE=function(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",F!==0?Dt(S,-F,B):_},m.IMCOS=Jt,m.IMCOSH=_r,m.IMCOT=function(_){return he(Ot(_),It(_))?b:Vt(Jt(_),er(_))},m.IMCSC=function(_){return _===!0||_===!1?b:he(Ot(_),It(_))?T:Vt("1",er(_))},m.IMCSCH=function(_){return _===!0||_===!1?b:he(Ot(_),It(_))?T:Vt("1",yr(_))},m.IMDIV=Vt,m.IMEXP=function(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);B=B==="i"||B==="j"?B:"i";const z=Math.exp(S);return Dt(z*Math.cos(F),z*Math.sin(F),B)},m.IMLN=function(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.log(Math.sqrt(S*S+F*F)),Math.atan(F/S),B)},m.IMLOG10=function(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.log(Math.sqrt(S*S+F*F))/Math.log(10),Math.atan(F/S)/Math.log(10),B)},m.IMLOG2=function(_){const S=Ot(_),F=It(_);if(he(S,F))return b;let B=_.substring(_.length-1);return B=B==="i"||B==="j"?B:"i",Dt(Math.log(Math.sqrt(S*S+F*F))/Math.log(2),Math.atan(F/S)/Math.log(2),B)},m.IMPOWER=function(_,S){if(he(S=te(S),Ot(_),It(_)))return b;let F=_.substring(_.length-1);F=F==="i"||F==="j"?F:"i";const B=Math.pow(or(_),S),z=ar(_);return Dt(B*Math.cos(S*z),B*Math.sin(S*z),F)},m.IMPRODUCT=function(){let _=arguments[0];if(!arguments.length)return b;for(let S=1;S<arguments.length;S++){const F=Ot(_),B=It(_),z=Ot(arguments[S]),ie=It(arguments[S]);if(he(F,B,z,ie))return b;_=Dt(F*z-B*ie,F*ie+B*z)}return _},m.IMREAL=Ot,m.IMSEC=function(_){return _===!0||_===!1||he(Ot(_),It(_))?b:Vt("1",Jt(_))},m.IMSECH=function(_){return he(Ot(_),It(_))?b:Vt("1",_r(_))},m.IMSIN=er,m.IMSINH=yr,m.IMSQRT=function(_){if(he(Ot(_),It(_)))return b;let S=_.substring(_.length-1);S=S==="i"||S==="j"?S:"i";const F=Math.sqrt(or(_)),B=ar(_);return Dt(F*Math.cos(B/2),F*Math.sin(B/2),S)},m.IMSUB=function(_,S){const F=Ot(_),B=It(_),z=Ot(S),ie=It(S);if(he(F,B,z,ie))return b;const fe=_.substring(_.length-1),Ne=S.substring(S.length-1);let qe="i";return(fe==="j"||Ne==="j")&&(qe="j"),Dt(F-z,B-ie,qe)},m.IMSUM=function(){if(!arguments.length)return b;const _=G(arguments);let S=_[0];for(let F=1;F<_.length;F++){const B=Ot(S),z=It(S),ie=Ot(_[F]),fe=It(_[F]);if(he(B,z,ie,fe))return b;S=Dt(B+ie,z+fe)}return S},m.IMTAN=function(_){return _===!0||_===!1||he(Ot(_),It(_))?b:Vt(er(_),Jt(_))},m.INDEX=function(_,S,F){const B=pe(_,S,F);if(B)return B;if(!Array.isArray(_))return b;const z=_.length>0&&!Array.isArray(_[0]);return z&&!F?(F=S,S=1):(F=F||1,S=S||1),F<0||S<0?b:z&&S===1&&F<=_.length?_[F-1]:S<=_.length&&F<=_[S-1].length?_[S-1][F-1]:P},m.INFO=function(){throw new Error("INFO is not implemented")},m.INT=function(_){return(_=te(_))instanceof Error?_:Math.floor(_)},m.INTERCEPT=function(_,S){return he(_=Pe(_),S=Pe(S))?b:_.length!==S.length?I:Z(0,_,S)},m.INTRATE=function(){throw new Error("INTRATE is not implemented")},m.IPMT=Cr,m.IRR=function(_,S){if(S=S||0,he(_=Pe(G(_)),S=te(S)))return b;const F=(dt,yt,Pt)=>{const Tt=Pt+1;let Lt=dt[0];for(let Mt=1;Mt<dt.length;Mt++)Lt+=dt[Mt]/Math.pow(Tt,(yt[Mt]-yt[0])/365);return Lt},B=(dt,yt,Pt)=>{const Tt=Pt+1;let Lt=0;for(let Mt=1;Mt<dt.length;Mt++){const jt=(yt[Mt]-yt[0])/365;Lt-=jt*dt[Mt]/Math.pow(Tt,jt+1)}return Lt},z=[];let ie=!1,fe=!1;for(let dt=0;dt<_.length;dt++)z[dt]=dt===0?0:z[dt-1]+365,_[dt]>0&&(ie=!0),_[dt]<0&&(fe=!0);if(!ie||!fe)return T;let Ne,qe,rt,ct=S=S===void 0?.1:S,pt=!0;do rt=F(_,z,ct),Ne=ct-rt/B(_,z,ct),qe=Math.abs(Ne-ct),ct=Ne,pt=qe>1e-10&&Math.abs(rt)>1e-10;while(pt);return ct},m.ISBLANK=function(_){return _===null},m.ISERR=Ve,m.ISERROR=Be,m.ISEVEN=function(_){return!(1&Math.floor(Math.abs(_)))},m.ISFORMULA=function(){throw new Error("ISFORMULA is not implemented")},m.ISLOGICAL=Je,m.ISNA=function(_){return _===I},m.ISNONTEXT=function(_){return typeof _!="string"},m.ISNUMBER=lt,m.ISO=_t,m.ISODD=function(_){return!!(1&Math.floor(Math.abs(_)))},m.ISOWEEKNUM=hr,m.ISPMT=function(_,S,F,B){return he(_=te(_),S=te(S),F=te(F),B=te(B))?b:B*_*(S/F-1)},m.ISREF=function(){throw new Error("ISREF is not implemented")},m.ISTEXT=ot,m.KURT=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;const S=v.mean(_),F=_.length;let B=0;for(let z=0;z<F;z++)B+=Math.pow(_[z]-S,4);return B/=Math.pow(v.stdev(_,!0),4),F*(F+1)/((F-1)*(F-2)*(F-3))*B-3*(F-1)*(F-1)/((F-2)*(F-3))},m.LARGE=Ae,m.LCM=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;for(var S,F,B,z,ie=1;(B=_.pop())!==void 0;){if(B===0)return 0;for(;B>1;){if(B%2){for(S=3,F=Math.floor(Math.sqrt(B));S<=F&&B%S;S+=2);z=S<=F?S:B}else z=2;for(B/=z,ie*=z,S=_.length;S;_[--S]%z==0&&(_[S]/=z)==1&&_.splice(S,1));}}return ie},m.LEFT=function(_,S){return pe(_,S)||(_=U(_),(S=te(S=S===void 0?1:S))instanceof Error||typeof _!="string"?b:_.substring(0,S))},m.LEN=function(_){return arguments.length===0?M:_ instanceof Error?_:Array.isArray(_)?b:U(_).length},m.LINEST=ke,m.LN=function(_){return(_=te(_))instanceof Error?_:_===0?T:Math.log(_)},m.LOG=function(_,S){return pe(_=te(_),S=te(S))||(_===0||S===0?T:Math.log(_)/Math.log(S))},m.LOG10=function(_){return(_=te(_))instanceof Error?_:_===0?T:Math.log(_)/Math.log(10)},m.LOGEST=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S)))||_.length!==S.length)return b;for(let B=0;B<_.length;B++)_[B]=Math.log(_[B]);const F=ke(_,S);return F[0]=Math.round(1e6*Math.exp(F[0]))/1e6,F[1]=Math.round(1e6*Math.exp(F[1]))/1e6,F},m.LOGINV=Jr,m.LOGNORM=je,m.LOGNORMDIST=en,m.LOGNORMINV=tn,m.LOOKUP=function(_,S,F){S=G(S),F=F?G(F):S;const B=typeof _=="number";let z=I;for(let ie=0;ie<S.length;ie++){if(S[ie]===_)return F[ie];if(B&&S[ie]<=_||typeof S[ie]=="string"&&S[ie].localeCompare(_)<0)z=F[ie];else if(B&&S[ie]>_)return z}return z},m.LOWER=function(_){return arguments.length!==1?b:he(_=U(_))?_:_.toLowerCase()},m.MATCH=function(_,S,F){if(!_||!S||(arguments.length===2&&(F=1),!((S=G(S))instanceof Array))||F!==-1&&F!==0&&F!==1)return I;let B,z;for(let ie=0;ie<S.length;ie++)if(F===1){if(S[ie]===_)return ie+1;S[ie]<_&&(z?S[ie]>z&&(B=ie+1,z=S[ie]):(B=ie+1,z=S[ie]))}else if(F===0){if(typeof _=="string"&&typeof S[ie]=="string"){const fe=_.toLowerCase().replace(/\?/g,".").replace(/\*/g,".*").replace(/~/g,"\\");if(new RegExp("^"+fe+"$").test(S[ie].toLowerCase()))return ie+1}else if(S[ie]===_)return ie+1}else if(F===-1){if(S[ie]===_)return ie+1;S[ie]>_&&(z?S[ie]<z&&(B=ie+1,z=S[ie]):(B=ie+1,z=S[ie]))}return B||I},m.MAX=Ue,m.MAXA=function(){const _=G(arguments),S=pe.apply(void 0,_);if(S)return S;let F=k(_);return F=F.map((B=>B??0)),F.length===0?0:Math.max.apply(Math,F)},m.MDURATION=function(){throw new Error("MDURATION is not implemented")},m.MEDIAN=et,m.MID=function(_,S,F){if(S==null)return b;if(he(S=te(S),F=te(F))||typeof _!="string")return F;const B=S-1,z=B+F;return _.substring(B,z)},m.MIN=st,m.MINA=function(){const _=G(arguments),S=pe.apply(void 0,_);if(S)return S;let F=k(_);return F=F.map((B=>B??0)),F.length===0?0:Math.min.apply(Math,F)},m.MINUTE=function(_){return(_=Ke(_))instanceof Error?_:_.getMinutes()},m.MIRR=function(_,S,F){if(he(_=Pe(G(_)),S=te(S),F=te(F)))return b;const B=_.length,z=[],ie=[];for(let qe=0;qe<B;qe++)_[qe]<0?z.push(_[qe]):ie.push(_[qe]);const fe=-dr(F,ie)*Math.pow(1+F,B-1),Ne=dr(S,z)*(1+S);return Math.pow(fe/Ne,1/(B-1))-1},m.MMULT=function(_,S){return!Array.isArray(_)||!Array.isArray(S)||_.some((F=>!F.length))||S.some((F=>!F.length))||oe(_).some((F=>typeof F!="number"))||oe(S).some((F=>typeof F!="number"))||_[0].length!==S.length?b:Array(_.length).fill(0).map((()=>Array(S[0].length).fill(0))).map(((F,B)=>F.map(((z,ie)=>_[B].reduce(((fe,Ne,qe)=>fe+Ne*S[qe][ie]),0)))))},m.MOD=function(_,S){const F=pe(_=te(_),S=te(S));if(F)return F;if(S===0)return C;let B=Math.abs(_%S);return B=_<0?S-B:B,S>0?B:-B},m.MODE=at,m.MODEMULT=rn,m.MODESNGL=nn,m.MONTH=function(_){return(_=Ke(_))instanceof Error?_:_.getMonth()+1},m.MROUND=function(_,S){return pe(_=te(_),S=te(S))||(_*S==0?0:_*S<0?T:Math.round(_/S)*S)},m.MULTINOMIAL=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;let S=0,F=1;for(let B=0;B<_.length;B++)S+=_[B],F*=nt(_[B]);return nt(S)/F},m.MUNIT=function(_){return arguments.length>1?I:!(_=parseInt(_))||_<=0?b:Array(_).fill(0).map((()=>Array(_).fill(0))).map(((S,F)=>(S[F]=1,S)))},m.N=function(_){return lt(_)?_:_ instanceof Date?_.getTime():_===!0?1:_===!1?0:Be(_)?_:0},m.NA=function(){return I},m.NEGBINOM=ft,m.NEGBINOMDIST=sn,m.NETWORKDAYS=Xt,m.NETWORKDAYSINTL=on,m.NOMINAL=function(_,S){return he(_=te(_),S=te(S))?b:_<=0||S<1?T:(S=parseInt(S,10),(Math.pow(_+1,1/S)-1)*S)},m.NORM=gt,m.NORMDIST=an,m.NORMINV=ln,m.NORMSDIST=cn,m.NORMSINV=un,m.NOT=function(_){return typeof _=="string"?b:_ instanceof Error?_:!_},m.NOW=function(){return new Date},m.NPER=function(_,S,F,B,z){if(z=z===void 0?0:z,B=B===void 0?0:B,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z)))return b;if(_===0)return-(F+B)/S;{const ie=S*(1+_*z)-B*_,fe=F*_+S*(1+_*z);return Math.log(ie/fe)/Math.log(1+_)}},m.NPV=dr,m.NUMBERVALUE=function(_,S,F){return typeof(_=ee(_)?_:"")=="number"?_:typeof _!="string"?I:(S=S===void 0?".":S,F=F===void 0?",":F,Number(_.replace(S,".").replace(F,"")))},m.OCT2BIN=function(_,S){if(!/^[0-7]{1,10}$/.test(_))return T;const F=!(_.length!==10||_.substring(0,1)!=="7"),B=F?parseInt(_,8)-1073741824:parseInt(_,8);if(B<-512||B>511)return T;if(F)return"1"+Ht("0",9-(512+B).toString(2).length)+(512+B).toString(2);const z=B.toString(2);return S===void 0?z:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=z.length?Ht("0",S-z.length)+z:T},m.OCT2DEC=function(_){if(!/^[0-7]{1,10}$/.test(_))return T;const S=parseInt(_,8);return S>=536870912?S-1073741824:S},m.OCT2HEX=function(_,S){if(!/^[0-7]{1,10}$/.test(_))return T;const F=parseInt(_,8);if(F>=536870912)return"ff"+(F+3221225472).toString(16);const B=F.toString(16);return S===void 0?B:isNaN(S)?b:S<0?T:(S=Math.floor(S))>=B.length?Ht("0",S-B.length)+B:T},m.ODD=function(_){if((_=te(_))instanceof Error)return _;let S=Math.ceil(Math.abs(_));return S=1&S?S:S+1,_>=0?S:-S},m.ODDFPRICE=function(){throw new Error("ODDFPRICE is not implemented")},m.ODDFYIELD=function(){throw new Error("ODDFYIELD is not implemented")},m.ODDLPRICE=function(){throw new Error("ODDLPRICE is not implemented")},m.ODDLYIELD=function(){throw new Error("ODDLYIELD is not implemented")},m.OR=function(){const _=G(arguments);let S=b;for(let F=0;F<_.length;F++){if(_[F]instanceof Error)return _[F];_[F]!==void 0&&_[F]!==null&&typeof _[F]!="string"&&(S===b&&(S=!1),_[F]&&(S=!0))}return S},m.PDURATION=function(_,S,F){return he(_=te(_),S=te(S),F=te(F))?b:_<=0?T:(Math.log(F)-Math.log(S))/Math.log(1+_)},m.PEARSON=Ie,m.PERCENTILE=We,m.PERCENTILEEXC=dn,m.PERCENTILEINC=hn,m.PERCENTRANK=tt,m.PERCENTRANKEXC=fn,m.PERCENTRANKINC=gn,m.PERMUT=function(_,S){return he(_=te(_),S=te(S))?b:nt(_)/nt(_-S)},m.PERMUTATIONA=function(_,S){return he(_=te(_),S=te(S))?b:Math.pow(_,S)},m.PHI=function(_){return(_=te(_))instanceof Error?b:Math.exp(-.5*_*_)/2.5066282746310002},m.PI=function(){return Math.PI},m.PMT=qt,m.POISSON=ue,m.POISSONDIST=pn,m.POWER=$t,m.PPMT=function(_,S,F,B,z,ie){return z=z||0,ie=ie||0,he(_=te(_),F=te(F),B=te(B),z=te(z),ie=te(ie))?b:qt(_,F,B,z,ie)-Cr(_,S,F,B,z,ie)},m.PRICE=function(){throw new Error("PRICE is not implemented")},m.PRICEDISC=function(_,S,F,B,z){if(he(_=Ke(_),S=Ke(S),F=te(F),B=te(B),z=(z=te(z))||0))return b;if(F<=0||B<=0)return T;if(_>=S)return b;let ie,fe;switch(z){case 0:ie=360,fe=Bt(_,S,!1);break;case 1:case 3:ie=365,fe=Ut(_,S,"D");break;case 2:ie=360,fe=Ut(_,S,"D");break;case 4:ie=360,fe=Bt(_,S,!0);break;default:return T}return B-F*B*fe/ie},m.PRICEMAT=function(){throw new Error("PRICEMAT is not implemented")},m.PROB=function(_,S,F,B){if(F===void 0)return 0;if(B=B===void 0?F:B,he(_=Pe(G(_)),S=Pe(G(S)),F=te(F),B=te(B)))return b;if(F===B)return _.indexOf(F)>=0?S[_.indexOf(F)]:0;const z=_.sort(((Ne,qe)=>Ne-qe)),ie=z.length;let fe=0;for(let Ne=0;Ne<ie;Ne++)z[Ne]>=F&&z[Ne]<=B&&(fe+=S[_.indexOf(z[Ne])]);return fe},m.PRODUCT=Nt,m.PRONETIC=function(){throw new Error("PRONETIC is not implemented")},m.PROPER=function(_){return he(_)?_:isNaN(_)&&typeof _=="number"?b:(_=U(_)).replace(/\w\S*/g,(S=>S.charAt(0).toUpperCase()+S.substr(1).toLowerCase()))},m.PV=function(_,S,F,B,z){return B=B||0,z=z||0,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z))?b:_===0?-F*S-B:((1-Math.pow(1+_,S))/_*F*(1+_*z)-B)/Math.pow(1+_,S)},m.QUARTILE=be,m.QUARTILEEXC=mn,m.QUARTILEINC=vn,m.QUOTIENT=function(_,S){return pe(_=te(_),S=te(S))||parseInt(_/S,10)},m.RADIANS=function(_){return(_=te(_))instanceof Error?_:_*Math.PI/180},m.RAND=function(){return Math.random()},m.RANDBETWEEN=function(_,S){return pe(_=te(_),S=te(S))||_+Math.ceil((S-_+1)*Math.random())-1},m.RANK=j,m.RANKAVG=_n,m.RANKEQ=yn,m.RATE=function(_,S,F,B,z,ie){if(ie=ie===void 0?.01:ie,B=B===void 0?0:B,z=z===void 0?0:z,he(_=te(_),S=te(S),F=te(F),B=te(B),z=te(z),ie=te(ie)))return b;const fe=1e-10;let Ne=ie;z=z?1:0;for(let qe=0;qe<20;qe++){if(Ne<=-1)return T;let rt,ct,pt;if(Math.abs(Ne)<fe?rt=F*(1+_*Ne)+S*(1+Ne*z)*_+B:(ct=Math.pow(1+Ne,_),rt=F*ct+S*(1/Ne+z)*(ct-1)+B),Math.abs(rt)<fe)return Ne;if(Math.abs(Ne)<fe)pt=F*_+S*z*_;else{ct=Math.pow(1+Ne,_);const dt=_*Math.pow(1+Ne,_-1);pt=F*dt+S*(1/Ne+z)*dt+S*(-1/(Ne*Ne))*(ct-1)}Ne-=rt/pt}return Ne},m.RECEIVED=function(){throw new Error("RECEIVED is not implemented")},m.REPLACE=function(_,S,F,B){return he(S=te(S),F=te(F))||typeof _!="string"||typeof B!="string"?b:_.substr(0,S-1)+B+_.substr(S-1+F)},m.REPT=Ht,m.RIGHT=function(_,S){return pe(_,S)||(_=U(_),(S=te(S=S===void 0?1:S))instanceof Error?S:_.substring(_.length-S))},m.ROMAN=function(_){if((_=te(_))instanceof Error)return _;const S=String(_).split(""),F=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM","","X","XX","XXX","XL","L","LX","LXX","LXXX","XC","","I","II","III","IV","V","VI","VII","VIII","IX"];let B="",z=3;for(;z--;)B=(F[+S.pop()+10*z]||"")+B;return new Array(+S.join("")+1).join("M")+B},m.ROUND=At,m.ROUNDDOWN=function(_,S){return pe(_=te(_),S=te(S))||(_>0?1:-1)*Math.floor(Math.abs(_)*Math.pow(10,S))/Math.pow(10,S)},m.ROUNDUP=function(_,S){return pe(_=te(_),S=te(S))||(_>0?1:-1)*Math.ceil(Math.abs(_)*Math.pow(10,S))/Math.pow(10,S)},m.ROW=function(_,S){return arguments.length!==2?I:S<0?T:_ instanceof Array&&typeof S=="number"?_.length!==0?v.row(_,S):void 0:b},m.ROWS=function(_){return arguments.length!==1?I:_ instanceof Array?_.length===0?0:v.rows(_):b},m.RRI=function(_,S,F){return he(_=te(_),S=te(S),F=te(F))?b:_===0||S===0?T:Math.pow(F/S,1/_)-1},m.RSQ=function(_,S){return he(_=Pe(G(_)),S=Pe(G(S)))?b:Math.pow(Ie(_,S),2)},m.SEARCH=function(_,S,F){let B;return typeof _!="string"||typeof S!="string"?b:(F=F===void 0?0:F,B=S.toLowerCase().indexOf(_.toLowerCase(),F-1)+1,B===0?b:B)},m.SEC=function(_){return(_=te(_))instanceof Error?_:1/Math.cos(_)},m.SECH=function(_){return(_=te(_))instanceof Error?_:2/(Math.exp(_)+Math.exp(-_))},m.SECOND=function(_){return(_=Ke(_))instanceof Error?_:_.getSeconds()},m.SERIESSUM=function(_,S,F,B){if(he(_=te(_),S=te(S),F=te(F),B=Pe(B)))return b;let z=B[0]*Math.pow(_,S);for(let ie=1;ie<B.length;ie++)z+=B[ie]*Math.pow(_,S+ie*F);return z},m.SHEET=function(){throw new Error("SHEET is not implemented")},m.SHEETS=function(){throw new Error("SHEETS is not implemented")},m.SIGN=function(_){return(_=te(_))instanceof Error?_:_<0?-1:_===0?0:1},m.SIN=function(_){return(_=te(_))instanceof Error?_:Math.sin(_)},m.SINH=function(_){return(_=te(_))instanceof Error?_:(Math.exp(_)-Math.exp(-_))/2},m.SKEW=J,m.SKEWP=Cn,m.SLN=function(_,S,F){return he(_=te(_),S=te(S),F=te(F))?b:F===0?T:(_-S)/F},m.SLOPE=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;const F=v.mean(S),B=v.mean(_),z=S.length;let ie=0,fe=0;for(let Ne=0;Ne<z;Ne++)ie+=(S[Ne]-F)*(_[Ne]-B),fe+=Math.pow(S[Ne]-F,2);return ie/fe},m.SMALL=Ce,m.SORT=function(_,S=1,F=1,B=!1){if(!_||!Array.isArray(_))return I;if(_.length===0)return 0;if(!(S=te(S))||S<1||(F=te(F))!==1&&F!==-1)return b;if(typeof(B=Xe(B))!="boolean")return R;const z=Ne=>Ne.sort(((qe,rt)=>(qe=U(qe[S-1]),rt=U(rt[S-1]),F===1?qe<rt?-1*F:F:qe>rt?F:-1*F))),ie=W(_),fe=B?le(ie):ie;return S>=1&&S<=fe[0].length?B?le(z(fe)):z(fe):b},m.SQRT=function(_){return(_=te(_))instanceof Error?_:_<0?T:Math.sqrt(_)},m.SQRTPI=function(_){return(_=te(_))instanceof Error?_:Math.sqrt(_*Math.PI)},m.STANDARDIZE=function(_,S,F){return he(_=te(_),S=te(S),F=te(F))?b:(_-S)/F},m.STDEV=Le,m.STDEVA=function(){const _=Ze.apply(this,arguments);return Math.sqrt(_)},m.STDEVP=wn,m.STDEVPA=function(){const _=Re.apply(this,arguments);let S=Math.sqrt(_);return isNaN(S)&&(S=T),S},m.STDEVS=bn,m.STEYX=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;const F=v.mean(S),B=v.mean(_),z=S.length;let ie=0,fe=0,Ne=0;for(let qe=0;qe<z;qe++)ie+=Math.pow(_[qe]-B,2),fe+=(S[qe]-F)*(_[qe]-B),Ne+=Math.pow(S[qe]-F,2);return Math.sqrt((ie-fe*fe/Ne)/(z-2))},m.SUBSTITUTE=function(_,S,F,B){if(arguments.length<3)return I;if(_&&S){if(B===void 0)return _.split(S).join(F);{if(B=Math.floor(Number(B)),Number.isNaN(B)||B<=0)return b;let z=0,ie=0;for(;z>-1&&_.indexOf(S,z)>-1;)if(z=_.indexOf(S,z+1),ie++,z>-1&&ie===B)return _.substring(0,z)+F+_.substring(z+S.length);return _}}return _},m.SUBTOTAL=function(_,S){if((_=te(_))instanceof Error)return _;switch(_){case 1:case 101:return bt(S);case 2:case 102:return q(S);case 3:case 103:return D(S);case 4:case 104:return Ue(S);case 5:case 105:return st(S);case 6:case 106:return Nt(S);case 7:case 107:return Le.S(S);case 8:case 108:return Le.P(S);case 9:case 109:return xt(S);case 10:case 110:return He.S(S);case 11:case 111:return He.P(S)}},m.SUM=xt,m.SUMIF=function(_,S,F){if(_=G(_),F=F?G(F):_,_ instanceof Error)return _;if(S==null||S instanceof Error)return 0;let B=0;const z=S==="*",ie=z?null:De(S+"");for(let fe=0;fe<_.length;fe++){const Ne=_[fe],qe=F[fe];if(z)B+=Ne;else{const rt=[ge(Ne,Se)].concat(ie);B+=$e(rt)?qe:0}}return B},m.SUMIFS=function(){const _=L(arguments),S=Pe(G(_.shift()));if(S instanceof Error)return S;const F=_,B=F.length/2;for(let ie=0;ie<B;ie++)F[2*ie]=G(F[2*ie]);let z=0;for(let ie=0;ie<S.length;ie++){let fe=!1;for(let Ne=0;Ne<B;Ne++){const qe=F[2*Ne][ie],rt=F[2*Ne+1];let ct=!1;if(rt===void 0||rt==="*")ct=!0;else{const pt=De(rt+""),dt=[ge(qe,Se)].concat(pt);ct=$e(dt)}if(!ct){fe=!1;break}fe=!0}fe&&(z+=S[ie])}return z},m.SUMPRODUCT=function(){if(!arguments||arguments.length===0)return b;const _=arguments.length+1;let S,F,B,z,ie=0;for(let fe=0;fe<arguments[0].length;fe++)if(arguments[0][fe]instanceof Array)for(let Ne=0;Ne<arguments[0][fe].length;Ne++){for(S=1,F=1;F<_;F++){const qe=arguments[F-1][fe][Ne];if(qe instanceof Error)return qe;if(z=te(qe),z instanceof Error)return z;S*=z}ie+=S}else{for(S=1,F=1;F<_;F++){const Ne=arguments[F-1][fe];if(Ne instanceof Error)return Ne;if(B=te(Ne),B instanceof Error)return B;S*=B}ie+=S}return ie},m.SUMSQ=function(){const _=Pe(G(arguments));if(_ instanceof Error)return _;let S=0;const F=_.length;for(let B=0;B<F;B++)S+=lt(_[B])?_[B]*_[B]:0;return S},m.SUMX2MY2=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;let F=0;for(let B=0;B<_.length;B++)F+=_[B]*_[B]-S[B]*S[B];return F},m.SUMX2PY2=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;let F=0;_=Pe(G(_)),S=Pe(G(S));for(let B=0;B<_.length;B++)F+=_[B]*_[B]+S[B]*S[B];return F},m.SUMXMY2=function(_,S){if(he(_=Pe(G(_)),S=Pe(G(S))))return b;let F=0;_=G(_),S=G(S);for(let B=0;B<_.length;B++)F+=Math.pow(_[B]-S[B],2);return F},m.SWITCH=function(){let _;if(arguments.length>0){const S=arguments[0],F=arguments.length-1,B=Math.floor(F/2);let z=!1;const ie=F%2!=0,fe=F%2==0?null:arguments[arguments.length-1];if(B){for(let Ne=0;Ne<B;Ne++)if(S===arguments[2*Ne+1]){_=arguments[2*Ne+2],z=!0;break}}z||(_=ie?fe:I)}else _=b;return _},m.SYD=function(_,S,F,B){return he(_=te(_),S=te(S),F=te(F),B=te(B))?b:F===0||B<1||B>F?T:(_-S)*(F-(B=parseInt(B,10))+1)*2/(F*(F+1))},m.T=function(_){return _ instanceof Error||typeof _=="string"?_:""},m.TAN=function(_){return(_=te(_))instanceof Error?_:Math.tan(_)},m.TANH=function(_){if((_=te(_))instanceof Error)return _;const S=Math.exp(2*_);return(S-1)/(S+1)},m.TBILLEQ=function(_,S,F){return he(_=Ke(_),S=Ke(S),F=te(F))?b:F<=0||_>S||S-_>31536e6?T:365*F/(360-F*Bt(_,S,!1))},m.TBILLPRICE=function(_,S,F){return he(_=Ke(_),S=Ke(S),F=te(F))?b:F<=0||_>S||S-_>31536e6?T:100*(1-F*Bt(_,S,!1)/360)},m.TBILLYIELD=function(_,S,F){return he(_=Ke(_),S=Ke(S),F=te(F))?b:F<=0||_>S||S-_>31536e6?T:360*(100-F)/(F*Bt(_,S,!1))},m.TDIST=Sn,m.TDISTRT=En,m.TEXT=function(_,S){if(_===void 0||_ instanceof Error||S instanceof Error)return I;if(S==null)return"";if(typeof S=="number")return String(S);if(typeof S!="string")return b;const F=S.startsWith("$")?"$":"",B=S.endsWith("%");return B&&(_*=100),_=(_=vr(_,(S=S.replace(/%/g,"").replace(/\$/g,"")).split(".")[1].match(/0/g).length,!S.includes(","))).startsWith("-")?"-"+F+(_=_.replace("-","")):F+_,B&&(_+="%"),_},m.TEXTJOIN=function(_,S,...F){if(typeof S!="boolean"&&(S=Xe(S)),arguments.length<3)return I;_=_??"";let B=G(F),z=S?B.filter((ie=>ie)):B;if(Array.isArray(_)){_=G(_);let ie=z.map((Ne=>[Ne])),fe=0;for(let Ne=0;Ne<ie.length-1;Ne++)ie[Ne].push(_[fe]),fe++,fe===_.length&&(fe=0);return z=G(ie),z.join("")}return z.join(_)},m.TIME=function(_,S,F){return he(_=te(_),S=te(S),F=te(F))?b:_<0||S<0||F<0?T:(3600*_+60*S+F)/86400},m.TIMEVALUE=function(_){return(_=Ke(_))instanceof Error?_:(3600*_.getHours()+60*_.getMinutes()+_.getSeconds())/86400},m.TINV=Rn,m.TODAY=function(){return Kt(new Date)},m.TRANSPOSE=function(_){return _?le(W(_)):I},m.TREND=function(_,S,F){if(he(_=Pe(G(_)),S=Pe(G(S)),F=Pe(G(F))))return b;const B=ke(_,S),z=B[0],ie=B[1],fe=[];return F.forEach((Ne=>{fe.push(z*Ne+ie)})),fe},m.TRIM=function(_){return(_=U(_))instanceof Error?_:_.replace(/\s+/g," ").trim()},m.TRIMMEAN=function(_,S){if(he(_=Pe(G(_)),S=te(S)))return b;const F=ut(_.length*S,2)/2;return v.mean((z=(z=F)||1,(B=X(_.sort(((ie,fe)=>ie-fe)),F))&&typeof B.slice=="function"?B.slice(0,B.length-z):B));var B,z},m.TRUE=function(){return!0},m.TRUNC=function(_,S){return pe(_=te(_),S=te(S))||(_>0?1:-1)*Math.floor(Math.abs(_)*Math.pow(10,S))/Math.pow(10,S)},m.TTEST=Pn,m.TYPE=function(_){return lt(_)?1:ot(_)?2:Je(_)?4:Be(_)?16:Array.isArray(_)?64:void 0},m.UNICHAR=Sr,m.UNICODE=Er,m.UNIQUE=ht,m.UPPER=function(_){return(_=U(_))instanceof Error?_:_.toUpperCase()},m.VALUE=function(_){const S=pe(_);if(S)return S;if(typeof _=="number")return _;if(ee(_)||(_=""),typeof _!="string")return b;const F=/(%)$/.test(_)||/^(%)/.test(_);if((_=(_=(_=_.replace(/^[^0-9-]{0,3}/,"")).replace(/[^0-9]{0,3}$/,"")).replace(/[ ,]/g,""))==="")return 0;let B=Number(_);return isNaN(B)?b:(B=B||0,F&&(B*=.01),B)},m.VAR=He,m.VARA=Ze,m.VARP=Tn,m.VARPA=Re,m.VARS=In,m.VDB=function(){throw new Error("VDB is not implemented")},m.VLOOKUP=Ct,m.WEEKDAY=function(_,S){if((_=Ke(_))instanceof Error)return _;S===void 0&&(S=1);const F=_.getDay();return Yt[S][F]},m.WEEKNUM=function(_,S){if((_=Ke(_))instanceof Error)return _;if(S===void 0&&(S=1),S===21)return hr(_);const F=wt[S];let B=new Date(_.getFullYear(),0,1);const z=B.getDay()<F?1:0;return B-=24*Math.abs(B.getDay()-F)*60*60*1e3,Math.floor((_-B)/864e5/7+1)+z},m.WEIBULL=xe,m.WEIBULLDIST=On,m.WORKDAY=Zt,m.WORKDAYINTL=$n,m.XIRR=function(_,S,F){if(he(_=Pe(G(_)),S=it(G(S)),F=te(F)))return b;const B=(dt,yt,Pt)=>{const Tt=Pt+1;let Lt=dt[0];for(let Mt=1;Mt<dt.length;Mt++)Lt+=dt[Mt]/Math.pow(Tt,Gt(yt[Mt],yt[0])/365);return Lt},z=(dt,yt,Pt)=>{const Tt=Pt+1;let Lt=0;for(let Mt=1;Mt<dt.length;Mt++){const jt=Gt(yt[Mt],yt[0])/365;Lt-=jt*dt[Mt]/Math.pow(Tt,jt+1)}return Lt};let ie=!1,fe=!1;for(let dt=0;dt<_.length;dt++)_[dt]>0&&(ie=!0),_[dt]<0&&(fe=!0);if(!ie||!fe)return T;let Ne,qe,rt,ct=F=F||.1,pt=!0;do rt=B(_,S,ct),Ne=ct-rt/z(_,S,ct),qe=Math.abs(Ne-ct),ct=Ne,pt=qe>1e-10&&Math.abs(rt)>1e-10;while(pt);return ct},m.XNPV=function(_,S,F){if(he(_=te(_),S=Pe(G(S)),F=it(G(F))))return b;let B=0;for(let z=0;z<S.length;z++)B+=S[z]/Math.pow(1+_,Gt(F[z],F[0])/365);return B},m.XOR=function(){const _=G(arguments);let S=b;for(let F=0;F<_.length;F++){if(_[F]instanceof Error)return _[F];_[F]!==void 0&&_[F]!==null&&typeof _[F]!="string"&&(S===b&&(S=0),_[F]&&S++)}return S===b?S:!!(1&Math.floor(Math.abs(S)))},m.YEAR=function(_){return(_=Ke(_))instanceof Error?_:_.getFullYear()},m.YEARFRAC=rr,m.YIELD=function(){throw new Error("YIELD is not implemented")},m.YIELDDISC=function(){throw new Error("YIELDDISC is not implemented")},m.YIELDMAT=function(){throw new Error("YIELDMAT is not implemented")},m.Z=Ye,m.ZTEST=An,m.utils=Mn}},d={};function h(g){var m=d[g];if(m!==void 0)return m.exports;var p=d[g]={exports:{}};return u[g].call(p.exports,p,p.exports,h),p.exports}h.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})();var f=h(960);c=f})(),c}))})(dist$2)),dist$2.exports}var dist=dist$3.exports,hasRequiredDist;function requireDist(){return hasRequiredDist||(hasRequiredDist=1,(function(module,exports){if(!jSuites&&typeof commonjsRequire$1=="function")var jSuites=requireJsuites();if(!formula&&typeof commonjsRequire$1=="function")var formula=requireDist$1();(function(a,s){module.exports=s()})(dist,(function(){var jspreadsheet;return(function(){var __webpack_modules__={805:function(a,s){const c=function(h){const f=this,g=[];for(let m=0;m<h.length;m++){const p=h[m].x,v=h[m].y,w=f.options.columns[p].name?f.options.columns[p].name:p;g[v]||(g[v]={row:v,data:{}}),g[v].data[w]=h[m].value}return g.filter((function(m){return m!=null}))},u=function(h,f){const g=this,m=d.call(g.parent,"onbeforesave",g.parent,g,f);if(m)f=m;else if(m===!1)return!1;jSuites.ajax({url:h,method:"POST",dataType:"json",data:{data:JSON.stringify(f)},success:function(p){d.call(g,"onsave",g.parent,g,f)}})},d=function(h){const f=this;let g=null,m=f.parent?f.parent:f;if(!m.ignoreEvents&&(typeof m.config.onevent=="function"&&(g=m.config.onevent.apply(this,arguments)),typeof m.config[h]=="function"&&(g=m.config[h].apply(this,Array.prototype.slice.call(arguments,1))),typeof m.plugins=="object")){const p=Object.keys(m.plugins);for(let v=0;v<p.length;v++){const w=p[v],E=m.plugins[w];typeof E.onevent=="function"&&(g=E.onevent.apply(this,arguments))}}if(h=="onafterchanges"){const p=arguments;if(typeof m.plugins=="object"&&Object.entries(m.plugins).forEach((function([,v]){typeof v.persistence=="function"&&v.persistence(f,"setValue",{data:p[2]})})),f.options.persistence){const v=f.options.persistence==1?f.options.url:f.options.persistence,w=c.call(f,arguments[2]);u.call(f,v,w)}}return g};s.A=d},829:function(a,s,c){c.d(s,{F8:function(){return f},N$:function(){return h},dr:function(){return g}});var u=c(530),d=c(657);const h=function(m){const p=this;if(p.options.filters){m=parseInt(m),p.resetSelection();let v=[];if(p.options.columns[m].type=="checkbox")v.push({id:"true",name:"True"}),v.push({id:"false",name:"False"});else{const C=[];let b=!1;for(let R=0;R<p.options.data.length;R++){const T=p.options.data[R][m],I=p.records[R][m].element.innerHTML;T&&I?C[T]=I:b=!0}const P=Object.keys(C);v=[];for(let R=0;R<P.length;R++)v.push({id:P[R],name:C[P[R]]});b&&v.push({value:"",id:"",name:"(Blanks)"})}const w=document.createElement("div");p.filter.children[m+1].innerHTML="",p.filter.children[m+1].appendChild(w),p.filter.children[m+1].style.paddingLeft="0px",p.filter.children[m+1].style.paddingRight="0px",p.filter.children[m+1].style.overflow="initial";const E={data:v,multiple:!0,autocomplete:!0,opened:!0,value:p.filters[m]!==void 0?p.filters[m]:null,width:"100%",position:p.options.tableOverflow==1||p.parent.config.fullscreen==1,onclose:function(C){g.call(p),p.filters[m]=C.dropdown.getValue(!0),p.filter.children[m+1].innerHTML=C.dropdown.getText(),p.filter.children[m+1].style.paddingLeft="",p.filter.children[m+1].style.paddingRight="",p.filter.children[m+1].style.overflow="",f.call(p,m),d.G9.call(p)}};jSuites.dropdown(w,E)}else console.log("Jspreadsheet: filters not enabled.")},f=function(m){const p=this;if(!m)for(let E=0;E<p.filter.children.length;E++)p.filters[E]&&(m=E);const v=function(E,C,b){for(let P=0;P<E.length;P++){const R=""+p.options.data[b][C],T=""+p.records[b][C].element.innerHTML;if(E[P]==R||E[P]==T)return!0}return!1},w=p.filters[m];p.results=[];for(let E=0;E<p.options.data.length;E++)v(w,m,E)&&p.results.push(E);p.results.length||(p.results=null),u.hG.call(p)},g=function(){const m=this;if(m.options.filters)for(let p=0;p<m.filter.children.length;p++)m.filter.children[p].innerHTML="&nbsp;",m.filters[p]=null;m.results=null,u.hG.call(m)}},160:function(a,s,c){c.d(s,{e:function(){return d}});var u=c(530);const d=function(h){const f=this;if(h&&(f.options.footers=h),f.options.footers){f.tfoot||(f.tfoot=document.createElement("tfoot"),f.table.appendChild(f.tfoot));for(let g=0;g<f.options.footers.length;g++){let m;if(f.tfoot.children[g])m=f.tfoot.children[g];else{m=document.createElement("tr");const p=document.createElement("td");m.appendChild(p),f.tfoot.appendChild(m)}for(let p=0;p<f.headers.length;p++){let v;if(f.options.footers[g][p]||(f.options.footers[g][p]=""),f.tfoot.children[g].children[p+1])v=f.tfoot.children[g].children[p+1];else{v=document.createElement("td"),m.appendChild(v);const w=f.options.columns[p].align||f.options.defaultColAlign||"center";v.style.textAlign=w}v.textContent=u.$x.call(f,+f.records.length+p,g,f.options.footers[g][p]),v.style.display=f.cols[p].colElement.style.display}}}}},296:function(a,s,c){c.d(s,{w:function(){return u}});const u=function(){const d=this;let h=0;if(d.options.freezeColumns>0)for(let f=0;f<d.options.freezeColumns;f++){let g;g=d.options.columns&&d.options.columns[f]&&d.options.columns[f].width!==void 0?parseInt(d.options.columns[f].width):d.options.defaultColWidth!==void 0?parseInt(d.options.defaultColWidth):100,h+=g}return h}},978:function(a,s,c){c.r(s),c.d(s,{createFromTable:function(){return w},getCaretIndex:function(){return d},getCellNameFromCoords:function(){return g},getColumnName:function(){return f},getCoordsFromCellName:function(){return m},getCoordsFromRange:function(){return p},invert:function(){return h},parseCSV:function(){return v}});var u=c(689);const d=function(E){let C;C=this.config.root?this.config.root:window;let b=0;const P=C.getSelection();if(P&&P.rangeCount!==0){const R=P.getRangeAt(0),T=R.cloneRange();T.selectNodeContents(E),T.setEnd(R.endContainer,R.endOffset),b=T.toString().length}return b},h=function(E){const C=[],b=Object.keys(E);for(let P=0;P<b.length;P++)C[E[b[P]]]=b[P];return C},f=function(E){let C,b=E+1,P="";for(;b>0;)C=(b-1)%26,P=String.fromCharCode(65+C).toString()+P,b=parseInt((b-C)/26);return P},g=function(E,C){return f(parseInt(E))+(parseInt(C)+1)},m=function(E){const C=/^[a-zA-Z]+/.exec(E);if(C){let b=0;for(let R=0;R<C[0].length;R++)b+=parseInt(C[0].charCodeAt(R)-64)*Math.pow(26,C[0].length-1-R);b--,b<0&&(b=0);let P=parseInt(/[0-9]+$/.exec(E))||null;return P>0&&P--,[b,P]}},p=function(E){const[C,b]=E.split(":");return[...m(C),...m(b)]},v=function(E,C){C=C||",",E=E.replace(/\r?\n$|\r$|\n$/g,"");const b=[];let P=!1,R=0,T=0,I=0;for(let M=0;M<E.length;M++){const N=E[M],H=E[M+1];b[T]=b[T]||[],b[T][I]=b[T][I]||"",N=='"'&&P&&H=='"'?(b[T][I]+=N,++M):N!='"'?N!=C||P?N!="\r"||H!=`
`||P?N==`
`&&!P||N=="\r"&&!P?(++T,R=Math.max(R,I),I=0):b[T][I]+=N:(++T,R=Math.max(R,I),I=0,++M):++I:P=!P}return b.forEach(((M,N)=>{for(let H=M.length;H<=R;H++)M.push("")})),b},w=function(E,C){if(E.tagName=="TABLE"){C||(C={}),C.columns=[],C.data=[];const b=E.querySelectorAll("colgroup > col");if(b.length)for(let k=0;k<b.length;k++){let W=b[k].style.width;W||(W=b[k].getAttribute("width")),W&&(C.columns[k]||(C.columns[k]={}),C.columns[k].width=W)}const P=function(k,W){let G=k.getBoundingClientRect();const oe=G.width>50?G.width:50;C.columns[W]||(C.columns[W]={}),k.getAttribute("data-celltype")?C.columns[W].type=k.getAttribute("data-celltype"):C.columns[W].type="text",C.columns[W].width=oe+"px",C.columns[W].title=k.innerHTML,k.style.textAlign&&(C.columns[W].align=k.style.textAlign),(G=k.getAttribute("name"))&&(C.columns[W].name=G),(G=k.getAttribute("id"))&&(C.columns[W].id=G),(G=k.getAttribute("data-mask"))&&(C.columns[W].mask=G)},R=[];let T=E.querySelectorAll(":scope > thead > tr");if(T.length){for(let k=0;k<T.length-1;k++){const W=[];for(let G=0;G<T[k].children.length;G++){const oe={title:T[k].children[G].textContent,colspan:T[k].children[G].getAttribute("colspan")||1};W.push(oe)}R.push(W)}T=T[T.length-1].children;for(let k=0;k<T.length;k++)P(T[k],k)}let I=0;const M={},N={},H={},L={};let A=E.querySelectorAll(":scope > tr, :scope > tbody > tr");for(let k=0;k<A.length;k++)if(C.data[I]=[],C.parseTableFirstRowAsHeader!=1||T.length||k!=0){for(let W=0;W<A[k].children.length;W++){let G=A[k].children[W].getAttribute("data-formula");G?G.substr(0,1)!="="&&(G="="+G):G=A[k].children[W].innerHTML,C.data[I].push(G);const oe=(0,u.t3)([W,k]),ae=A[k].children[W].getAttribute("class");ae&&(L[oe]=ae);const X=parseInt(A[k].children[W].getAttribute("colspan"))||0,le=parseInt(A[k].children[W].getAttribute("rowspan"))||0;(X||le)&&(M[oe]=[X||1,le||1]),A[k].children[W].style&&A[k].children[W].style.display=="none"&&(A[k].children[W].style.display="");const ye=A[k].children[W].getAttribute("style");ye&&(H[oe]=ye),A[k].children[W].classList.contains("styleBold")&&(H[oe]?H[oe]+="; font-weight:bold;":H[oe]="font-weight:bold;")}A[k].style&&A[k].style.height&&(N[k]={height:A[k].style.height}),I++}else for(let W=0;W<A[k].children.length;W++)P(A[k].children[W],W);if(Object.keys(R).length>0&&(C.nestedHeaders=R),Object.keys(H).length>0&&(C.style=H),Object.keys(M).length>0&&(C.mergeCells=M),Object.keys(N).length>0&&(C.rows=N),Object.keys(L).length>0&&(C.classes=L),A=E.querySelectorAll("tfoot tr"),A.length){const k=[];for(let W=0;W<A.length;W++){let G=[];for(let oe=0;oe<A[W].children.length;oe++)G.push(A[W].children[oe].textContent);k.push(G)}Object.keys(k).length>0&&(C.footers=k)}if(C.parseTableAutoCellType==1){const k=[];for(let W=0;W<C.columns.length;W++){let G=!0,oe=!0;k[W]=[];for(let X=0;X<C.data.length;X++){const le=C.data[X][W];k[W][le]||(k[W][le]=0),k[W][le]++,le.length>25&&(G=!1),le.length==10&&le.substr(4,1)=="-"&&le.substr(7,1)=="-"||(oe=!1)}const ae=Object.keys(k[W]).length;oe?C.columns[W].type="calendar":G==1&&ae>1&&ae<=parseInt(.1*C.data.length)&&(C.columns[W].type="dropdown",C.columns[W].source=Object.keys(k[W]))}}return C}console.log("Element is not a table")}},911:function(a,s,c){c.d(s,{Dh:function(){return p},ZS:function(){return C},tN:function(){return E}});var u=c(805),d=c(689),h=c(530),f=c(910),g=c(94),m=c(657);const p=function(b){const P=this;if(P.ignoreHistory!=1){const R=++P.historyIndex;P.history=P.history=P.history.slice(0,R+1),P.history[R]=b}},v=function(b,P){const R=this,T=P.insertBefore?+P.rowNumber:P.rowNumber+1;if(R.options.search==1&&R.results&&R.results.length!=R.rows.length&&R.resetSearch(),b==1){const I=P.numOfRows;for(let M=T;M<I+T;M++)R.rows[M].element.parentNode.removeChild(R.rows[M].element);R.records.splice(T,I),R.options.data.splice(T,I),R.rows.splice(T,I),m.at.call(R,1,T,I+T-1)}else{const I=P.rowRecords.map((H=>[...H]));R.records=(0,d.Hh)(R.records,T,I);const M=P.rowData.map((H=>[...H]));R.options.data=(0,d.Hh)(R.options.data,T,M),R.rows=(0,d.Hh)(R.rows,T,P.rowNode);let N=0;for(let H=T;H<P.numOfRows+T;H++)R.tbody.insertBefore(P.rowNode[N].element,R.tbody.children[H]),N++}for(let I=T;I<R.rows.length;I++)R.rows[I].y=I;for(let I=T;I<R.records.length;I++)for(let M=0;M<R.records[I].length;M++)R.records[I][M].y=I;R.options.pagination>0&&R.page(R.pageNumber),h.o8.call(R)},w=function(b,P){const R=this,T=P.insertBefore?P.columnNumber:P.columnNumber+1;if(b==1){const I=P.numOfColumns;R.options.columns.splice(T,I);for(let M=T;M<I+T;M++)R.headers[M].parentNode.removeChild(R.headers[M]),R.cols[M].colElement.parentNode.removeChild(R.cols[M].colElement);R.headers.splice(T,I),R.cols.splice(T,I);for(let M=0;M<P.data.length;M++){for(let N=T;N<I+T;N++)R.records[M][N].element.parentNode.removeChild(R.records[M][N].element);R.records[M].splice(T,I),R.options.data[M].splice(T,I)}if(R.options.footers)for(let M=0;M<R.options.footers.length;M++)R.options.footers[M].splice(T,I)}else{R.options.columns=(0,d.Hh)(R.options.columns,T,P.columns),R.headers=(0,d.Hh)(R.headers,T,P.headers),R.cols=(0,d.Hh)(R.cols,T,P.cols);let I=0;for(let M=T;M<P.numOfColumns+T;M++)R.headerContainer.insertBefore(P.headers[I],R.headerContainer.children[M+1]),R.colgroupContainer.insertBefore(P.cols[I].colElement,R.colgroupContainer.children[M+1]),I++;for(let M=0;M<P.data.length;M++){R.options.data[M]=(0,d.Hh)(R.options.data[M],T,P.data[M]),R.records[M]=(0,d.Hh)(R.records[M],T,P.records[M]);let N=0;for(let H=T;H<P.numOfColumns+T;H++)R.rows[M].element.insertBefore(P.records[M][N].element,R.rows[M].element.children[H+1]),N++}if(R.options.footers)for(let M=0;M<R.options.footers.length;M++)R.options.footers[M]=(0,d.Hh)(R.options.footers[M],T,P.footers[M])}for(let I=T;I<R.cols.length;I++)R.cols[I].x=I;for(let I=0;I<R.records.length;I++)for(let M=T;M<R.records[I].length;M++)R.records[I][M].x=M;if(R.options.nestedHeaders&&R.options.nestedHeaders.length>0&&R.options.nestedHeaders[0]&&R.options.nestedHeaders[0][0])for(let I=0;I<R.options.nestedHeaders.length;I++){let M;M=b==1?parseInt(R.options.nestedHeaders[I][R.options.nestedHeaders[I].length-1].colspan)-P.numOfColumns:parseInt(R.options.nestedHeaders[I][R.options.nestedHeaders[I].length-1].colspan)+P.numOfColumns,R.options.nestedHeaders[I][R.options.nestedHeaders[I].length-1].colspan=M,R.thead.children[I].children[R.thead.children[I].children.length-1].setAttribute("colspan",M)}h.o8.call(R)},E=function(){const b=this,P=!!b.parent.ignoreEvents,R=!!b.ignoreHistory;b.parent.ignoreEvents=!0,b.ignoreHistory=!0;const T=[];let I;if(b.historyIndex>=0){if(I=b.history[b.historyIndex--],I.action=="insertRow")v.call(b,1,I);else if(I.action=="deleteRow")v.call(b,0,I);else if(I.action=="insertColumn")w.call(b,1,I);else if(I.action=="deleteColumn")w.call(b,0,I);else if(I.action=="moveRow")b.moveRow(I.newValue,I.oldValue);else if(I.action=="moveColumn")b.moveColumn(I.newValue,I.oldValue);else if(I.action=="setMerge")b.removeMerge(I.column,I.data);else if(I.action=="setStyle")b.setStyle(I.oldValue,null,null,1);else if(I.action=="setWidth")b.setWidth(I.column,I.oldValue);else if(I.action=="setHeight")b.setHeight(I.row,I.oldValue);else if(I.action=="setHeader")b.setHeader(I.column,I.oldValue);else if(I.action=="setComments")b.setComments(I.oldValue);else if(I.action=="orderBy"){let M=[];for(let N=0;N<I.rows.length;N++)M[I.rows[N]]=N;g.Th.call(b,I.column,I.order?0:1),g.iY.call(b,M)}else if(I.action=="setValue"){for(let M=0;M<I.records.length;M++)T.push({x:I.records[M].x,y:I.records[M].y,value:I.records[M].oldValue}),I.oldStyle&&b.resetStyle(I.oldStyle);b.setValue(T),I.selection&&b.updateSelectionFromCoords(I.selection[0],I.selection[1],I.selection[2],I.selection[3])}}b.parent.ignoreEvents=P,b.ignoreHistory=R,u.A.call(b,"onundo",b,I)},C=function(){const b=this,P=!!b.parent.ignoreEvents,R=!!b.ignoreHistory;let T;if(b.parent.ignoreEvents=!0,b.ignoreHistory=!0,b.historyIndex<b.history.length-1){if(T=b.history[++b.historyIndex],T.action=="insertRow")v.call(b,0,T);else if(T.action=="deleteRow")v.call(b,1,T);else if(T.action=="insertColumn")w.call(b,0,T);else if(T.action=="deleteColumn")w.call(b,1,T);else if(T.action=="moveRow")b.moveRow(T.oldValue,T.newValue);else if(T.action=="moveColumn")b.moveColumn(T.oldValue,T.newValue);else if(T.action=="setMerge")f.FU.call(b,T.column,T.colspan,T.rowspan,1);else if(T.action=="setStyle")b.setStyle(T.newValue,null,null,1);else if(T.action=="setWidth")b.setWidth(T.column,T.newValue);else if(T.action=="setHeight")b.setHeight(T.row,T.newValue);else if(T.action=="setHeader")b.setHeader(T.column,T.newValue);else if(T.action=="setComments")b.setComments(T.newValue);else if(T.action=="orderBy")g.Th.call(b,T.column,T.order),g.iY.call(b,T.rows);else if(T.action=="setValue"){b.setValue(T.records);for(let I=0;I<T.records.length;I++)T.oldStyle&&b.resetStyle(T.newStyle);T.selection&&b.updateSelectionFromCoords(T.selection[0],T.selection[1],T.selection[2],T.selection[3])}}b.parent.ignoreEvents=P,b.ignoreHistory=R,u.A.call(b,"onredo",b,T)}},530:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$O:function(){return getWorksheetActive},$x:function(){return parseValue},C6:function(){return showIndex},Em:function(){return executeFormula},P9:function(){return createCell},Rs:function(){return updateScroll},TI:function(){return hideIndex},Xr:function(){return getCellFromCoords},Y5:function(){return fullscreen},am:function(){return updateTable},dw:function(){return isFormula},eN:function(){return getWorksheetInstance},hG:function(){return updateResult},ju:function(){return createNestedHeader},k9:function(){return updateCell},o8:function(){return updateTableReferences},p9:function(){return getLabel},rS:function(){return getMask},tT:function(){return getCell},xF:function(){return updateFormulaChain},yB:function(){return updateFormula}});var _dispatch_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(805),_selection_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(657),_helpers_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(978),_meta_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(654),_freeze_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(296),_pagination_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(167),_footer_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(160),_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(689);const updateTable=function(){const a=this;if(a.options.minSpareRows>0){let s=0;for(let c=a.rows.length-1;c>=0;c--){let u=!1;for(let d=0;d<a.headers.length;d++)a.options.data[c][d]&&(u=!0);if(u)break;s++}a.options.minSpareRows-s>0&&a.insertRow(a.options.minSpareRows-s)}if(a.options.minSpareCols>0){let s=0;for(let c=a.headers.length-1;c>=0;c--){let u=!1;for(let d=0;d<a.rows.length;d++)a.options.data[d][c]&&(u=!0);if(u)break;s++}a.options.minSpareCols-s>0&&a.insertColumn(a.options.minSpareCols-s)}a.options.footers&&_footer_js__WEBPACK_IMPORTED_MODULE_0__.e.call(a),setTimeout((function(){_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(a)}),0)},parseNumber=function(a,s){const c=s&&this.options.columns[s].decimal?this.options.columns[s].decimal:".";let u=""+a;return u=u.split(c),u[0]=u[0].match(/[+-]?[0-9]/g),u[0]&&(u[0]=u[0].join("")),u[1]&&(u[1]=u[1].match(/[0-9]*/g).join("")),u[0]&&Number.isInteger(Number(u[0]))?u[1]?+(u[0]+"."+u[1]):+(u[0]+".00"):null},executeFormula=function(expression,x,y){const obj=this,formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){const parentId=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;const tokensUpdate=function(a){for(let s=0;s<a.length;s++){const c=[],u=a[s].split(":"),d=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(u[0],!0),h=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(u[1],!0);let f,g,m,p;d[0]<=h[0]?(f=d[0],g=h[0]):(f=h[0],g=d[0]),d[1]<=h[1]?(m=d[1],p=h[1]):(m=h[1],p=d[1]);for(let v=m;v<=p;v++)for(let w=f;w<=g;w++)c.push((0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([w,v]));expression=expression.replace(a[s],c.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");let tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);if(tokens&&tokens.length&&tokensUpdate(tokens),tokens=expression.match(/([A-Z]+[0-9]+)/g),tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";{const formulaExpressions={};if(tokens){for(let i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){const a=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(tokens[i],1);let s;if(s=obj.options.data[a[1]]!==void 0&&obj.options.data[a[1]][a[0]]!==void 0?obj.options.data[a[1]][a[0]]:"",(""+s).substr(0,1)=="="&&(formulaResults[tokens[i]]!==void 0?s=formulaResults[tokens[i]]:(s=execute(s,a[0],a[1]),formulaResults[tokens[i]]=s)),(""+s).trim()=="")formulaExpressions[tokens[i]]=null;else if(s==Number(s)&&obj.parent.config.autoCasting!=0)formulaExpressions[tokens[i]]=Number(s);else{const c=parseNumber.call(obj,s,a[0]);obj.parent.config.autoCasting!=0&&c?formulaExpressions[tokens[i]]=c:formulaExpressions[tokens[i]]='"'+s+'"'}}}const ret=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(obj,"onbeforeformula",obj,expression,x,y);if(ret===!1)return expression;let res;ret&&(expression=ret);try{res=formula(expression.substr(1),formulaExpressions,x,y,obj),typeof res=="function"&&(res="#ERROR")}catch(a){res="#ERROR",obj.parent.config.debugFormulas===!0&&console.log(expression.substr(1),formulaExpressions,a)}return res}};return execute(expression,x,y)},parseValue=function(a,s,c,u){const d=this;(""+c).substr(0,1)=="="&&d.parent.config.parseFormulas!=0&&(c=executeFormula.call(d,c,a,s));const h=d.options.columns&&d.options.columns[a];if(h&&!isFormula(c)){let f=null;if(f=getMask(h)){c&&c==Number(c)&&(c=Number(c));let g=jSuites.mask.render(c,f,!0);if(u&&f.mask){const m=f.mask.split(";");m[1]&&(m[1].match(new RegExp("\\[Red\\]","gi"))&&(c<0?u.classList.add("red"):u.classList.remove("red")),m[1].match(new RegExp("\\(","gi"))&&c<0&&(g="("+g+")"))}g&&(c=g)}}return c},getDropDownValue=function(a,s){const c=this,u=[];if(c.options.columns&&c.options.columns[a]&&c.options.columns[a].source){const d=[],h=c.options.columns[a].source;for(let g=0;g<h.length;g++)typeof h[g]=="object"?d[h[g].id]=h[g].name:d[h[g]]=h[g];const f=Array.isArray(s)?s:(""+s).split(";");for(let g=0;g<f.length;g++)typeof f[g]=="object"?u.push(d[f[g].id]):d[f[g]]&&u.push(d[f[g]])}else console.error("Invalid column");return u.length>0?u.join("; "):""},validDate=function(a){return(a=""+a).substr(4,1)=="-"&&a.substr(7,1)=="-"||(a=a.split("-"))[0].length==4&&a[0]==Number(a[0])&&a[1].length==2&&a[1]==Number(a[1])},stripScript=function(a){const s=new Option;s.innerHTML=a;let c=null;for(a=s.getElementsByTagName("script");c=a[0];)c.parentNode.removeChild(c);return s.innerHTML},createCell=function(a,s,c){const u=this;let d=document.createElement("td");if(d.setAttribute("data-x",a),d.setAttribute("data-y",s),u.headers[a].style.display==="none"&&(d.style.display="none"),(""+c).substr(0,1)=="="&&u.options.secureFormulas==1){const f=secureFormula(c);f!=c&&(c=f)}if(u.options.columns&&u.options.columns[a]&&typeof u.options.columns[a].type=="object")u.parent.config.parseHTML===!0?d.innerHTML=c:d.textContent=c,typeof u.options.columns[a].type.createCell=="function"&&u.options.columns[a].type.createCell(d,c,parseInt(a),parseInt(s),u,u.options.columns[a]);else if(u.options.columns&&u.options.columns[a]&&u.options.columns[a].type=="hidden")d.style.display="none",d.textContent=c;else if(u.options.columns&&u.options.columns[a]&&(u.options.columns[a].type=="checkbox"||u.options.columns[a].type=="radio")){const f=document.createElement("input");f.type=u.options.columns[a].type,f.name="c"+a,f.checked=c==1||c==1||c=="true",f.onclick=function(){u.setValue(d,this.checked)},u.options.columns[a].readOnly!=1&&u.options.editable!=0||f.setAttribute("disabled","disabled"),d.appendChild(f),u.options.data[s][a]=f.checked}else if(u.options.columns&&u.options.columns[a]&&u.options.columns[a].type=="calendar"){let f=null;if(!validDate(c)){const g=jSuites.calendar.extractDateFromString(c,u.options.columns[a].options&&u.options.columns[a].options.format||"YYYY-MM-DD");g&&(f=g)}d.textContent=jSuites.calendar.getDateString(f||c,u.options.columns[a].options&&u.options.columns[a].options.format)}else if(u.options.columns&&u.options.columns[a]&&u.options.columns[a].type=="dropdown")d.classList.add("jss_dropdown"),d.textContent=getDropDownValue.call(u,a,c);else if(u.options.columns&&u.options.columns[a]&&u.options.columns[a].type=="color")if(u.options.columns[a].render=="square"){const f=document.createElement("div");f.className="color",f.style.backgroundColor=c,d.appendChild(f)}else d.style.color=c,d.textContent=c;else if(u.options.columns&&u.options.columns[a]&&u.options.columns[a].type=="image"){if(c&&c.substr(0,10)=="data:image"){const f=document.createElement("img");f.src=c,d.appendChild(f)}}else u.options.columns&&u.options.columns[a]&&u.options.columns[a].type=="html"||u.parent.config.parseHTML===!0?d.innerHTML=stripScript(parseValue.call(this,a,s,c,d)):d.textContent=parseValue.call(this,a,s,c,d);u.options.columns&&u.options.columns[a]&&u.options.columns[a].readOnly==1&&(d.className="readonly");const h=u.options.columns&&u.options.columns[a]&&u.options.columns[a].align||u.options.defaultColAlign||"center";return d.style.textAlign=h,u.options.columns&&u.options.columns[a]&&u.options.columns[a].wordWrap==0||!(u.options.wordWrap==1||u.options.columns&&u.options.columns[a]&&u.options.columns[a].wordWrap==1||d.innerHTML.length>200)||(d.style.whiteSpace="pre-wrap"),a>0&&this.options.textOverflow==1&&(c||d.innerHTML?u.records[s][a-1].element.style.overflow="hidden":a==u.options.columns.length-1&&(d.style.overflow="hidden")),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(u,"oncreatecell",u,d,a,s,c),d},updateCell=function(a,s,c,u){const d=this;let h;if(d.records[s][a].element.classList.contains("readonly")!=1||u){if((""+c).substr(0,1)=="="&&d.options.secureFormulas==1){const m=secureFormula(c);m!=c&&(c=m)}const f=_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(d,"onbeforechange",d,d.records[s][a].element,a,s,c);if(f!=null&&(c=f),d.options.columns&&d.options.columns[a]&&typeof d.options.columns[a].type=="object"&&typeof d.options.columns[a].type.updateCell=="function"){const m=d.options.columns[a].type.updateCell(d.records[s][a].element,c,parseInt(a),parseInt(s),d,d.options.columns[a]);m!==void 0&&(c=m)}h={x:a,y:s,col:a,row:s,value:c,oldValue:d.options.data[s][a]};let g=d.options.columns&&d.options.columns[a]&&typeof d.options.columns[a].type=="object"?d.options.columns[a].type:null;if(g)d.options.data[s][a]=c,typeof g.setValue=="function"&&g.setValue(d.records[s][a].element,c);else if(d.options.columns&&d.options.columns[a]&&(d.options.columns[a].type=="checkbox"||d.options.columns[a].type=="radio")){if(d.options.columns[a].type=="radio")for(let m=0;m<d.options.data.length;m++)d.options.data[m][a]=!1;d.records[s][a].element.children[0].checked=c==1||c==1||c=="true"||c=="TRUE",d.options.data[s][a]=d.records[s][a].element.children[0].checked}else if(d.options.columns&&d.options.columns[a]&&d.options.columns[a].type=="dropdown")d.options.data[s][a]=c,d.records[s][a].element.textContent=getDropDownValue.call(d,a,c);else if(d.options.columns&&d.options.columns[a]&&d.options.columns[a].type=="calendar"){let m=null;if(!validDate(c)){const p=jSuites.calendar.extractDateFromString(c,d.options.columns[a].options&&d.options.columns[a].options.format||"YYYY-MM-DD");p&&(m=p)}d.options.data[s][a]=c,d.records[s][a].element.textContent=jSuites.calendar.getDateString(m||c,d.options.columns[a].options&&d.options.columns[a].options.format)}else if(d.options.columns&&d.options.columns[a]&&d.options.columns[a].type=="color")if(d.options.data[s][a]=c,d.options.columns[a].render=="square"){const m=document.createElement("div");m.className="color",m.style.backgroundColor=c,d.records[s][a].element.textContent="",d.records[s][a].element.appendChild(m)}else d.records[s][a].element.style.color=c,d.records[s][a].element.textContent=c;else if(d.options.columns&&d.options.columns[a]&&d.options.columns[a].type=="image"){if(c=""+c,d.options.data[s][a]=c,d.records[s][a].element.innerHTML="",c&&c.substr(0,10)=="data:image"){const m=document.createElement("img");m.src=c,d.records[s][a].element.appendChild(m)}}else d.options.data[s][a]=c,d.options.columns&&d.options.columns[a]&&d.options.columns[a].type=="html"?d.records[s][a].element.innerHTML=stripScript(parseValue.call(d,a,s,c)):d.parent.config.parseHTML===!0?d.records[s][a].element.innerHTML=stripScript(parseValue.call(d,a,s,c,d.records[s][a].element)):d.records[s][a].element.textContent=parseValue.call(d,a,s,c,d.records[s][a].element),d.options.columns&&d.options.columns[a]&&d.options.columns[a].wordWrap==0||!(d.options.wordWrap==1||d.options.columns&&d.options.columns[a]&&d.options.columns[a].wordWrap==1||d.records[s][a].element.innerHTML.length>200)?d.records[s][a].element.style.whiteSpace="":d.records[s][a].element.style.whiteSpace="pre-wrap";a>0&&(d.records[s][a-1].element.style.overflow=c?"hidden":""),d.options.columns&&d.options.columns[a]&&typeof d.options.columns[a].render=="function"&&d.options.columns[a].render(d.records[s]&&d.records[s][a]?d.records[s][a].element:null,c,parseInt(a),parseInt(s),d,d.options.columns[a]),_dispatch_js__WEBPACK_IMPORTED_MODULE_3__.A.call(d,"onchange",d,d.records[s]&&d.records[s][a]?d.records[s][a].element:null,a,s,c,h.oldValue)}else h={x:a,y:s,col:a,row:s};return h},isFormula=function(a){const s=(""+a)[0];return s=="="||s=="#"},getMask=function(a){if(a.format||a.mask||a.locale){const s={};return a.mask?s.mask=a.mask:a.format?s.mask=a.format:(s.locale=a.locale,s.options=a.options),a.decimal&&(s.options||(s.options={}),s.options={decimal:a.decimal}),s}return null},secureFormula=function(a){let s="",c=0;for(let u=0;u<a.length;u++)a[u]=='"'&&(c=c==0?1:0),s+=c==1?a[u]:a[u].toUpperCase();return s};let chainLoopProtection=[];const updateFormulaChain=function(a,s,c){const u=this,d=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([a,s]);if(u.formula[d]&&u.formula[d].length>0)if(chainLoopProtection[d])u.records[s][a].element.innerHTML="#ERROR",u.formula[d]="";else{chainLoopProtection[d]=!0;for(let h=0;h<u.formula[d].length;h++){const f=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(u.formula[d][h],!0),g=""+u.options.data[f[1]][f[0]];g.substr(0,1)=="="?c.push(updateCell.call(u,f[0],f[1],g,!0)):Object.keys(u.formula)[h]=null,updateFormulaChain.call(u,f[0],f[1],c)}}chainLoopProtection=[]},updateFormula=function(a,s){const c=/[A-Z]/,u=/[0-9]/;let d="",h=null,f=null,g="";for(let m=0;m<a.length;m++)c.exec(a[m])?(h=1,f=0,g+=a[m]):u.exec(a[m])?(f=h?1:0,g+=a[m]):(h&&f&&(g=s[g]?s[g]:g),d+=g,d+=a[m],h=0,f=0,g="");return g&&(h&&f&&(g=s[g]?s[g]:g),d+=g),d},updateFormulas=function(a){const s=this;for(let d=0;d<s.options.data.length;d++)for(let h=0;h<s.options.data[0].length;h++){const f=""+s.options.data[d][h];if(f.substr(0,1)=="="){const g=updateFormula(f,a);g!=f&&(s.options.data[d][h]=g)}}const c=[],u=Object.keys(s.formula);for(let d=0;d<u.length;d++){let h=u[d];const f=s.formula[h];a[h]&&(h=a[h]),c[h]=[];for(let g=0;g<f.length;g++){let m=f[g];a[m]&&(m=a[m]),c[h].push(m)}}s.formula=c},updateTableReferences=function(){const a=this;if(a.skipUpdateTableReferences)return;for(let h=0;h<a.headers.length;h++)a.headers[h].getAttribute("data-x")!=h&&(a.headers[h].setAttribute("data-x",h),a.headers[h].getAttribute("title")||(a.headers[h].innerHTML=(0,_helpers_js__WEBPACK_IMPORTED_MODULE_4__.getColumnName)(h)));for(let h=0;h<a.rows.length;h++)a.rows[h]&&a.rows[h].element.getAttribute("data-y")!=h&&(a.rows[h].element.setAttribute("data-y",h),a.rows[h].element.children[0].setAttribute("data-y",h),a.rows[h].element.children[0].innerHTML=h+1);const s=[],c=[],u=function(h,f,g,m){if(h!=g&&a.records[m][g].element.setAttribute("data-x",g),f!=m&&a.records[m][g].element.setAttribute("data-y",m),h!=g||f!=m){const p=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([h,f]),v=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([g,m]);s[p]=v}};for(let h=0;h<a.records.length;h++)for(let f=0;f<a.records[0].length;f++)if(a.records[h][f]){const g=a.records[h][f].element.getAttribute("data-x"),m=a.records[h][f].element.getAttribute("data-y");if(a.records[h][f].element.getAttribute("data-merged")){const p=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([g,m]),v=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.t3)([f,h]);if(c[p]==null)if(p==v)c[p]=!1;else{const w=parseInt(f-g),E=parseInt(h-m);c[p]=[v,w,E]}}else u(g,m,f,h)}const d=Object.keys(c);if(d.length){for(let h=0;h<d.length;h++)if(c[d[h]]){const f=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(d[h],!0);let g=f[0],m=f[1];u(g,m,g+c[d[h]][1],m+c[d[h]][2]);const p=d[h],v=c[d[h]][0];for(let w=0;w<a.options.mergeCells[p][2].length;w++)g=parseInt(a.options.mergeCells[p][2][w].getAttribute("data-x")),m=parseInt(a.options.mergeCells[p][2][w].getAttribute("data-y")),a.options.mergeCells[p][2][w].setAttribute("data-x",g+c[d[h]][1]),a.options.mergeCells[p][2][w].setAttribute("data-y",m+c[d[h]][2]);a.options.mergeCells[v]=a.options.mergeCells[p],delete a.options.mergeCells[p]}}updateFormulas.call(a,s),_meta_js__WEBPACK_IMPORTED_MODULE_5__.hs.call(a,s),_selection_js__WEBPACK_IMPORTED_MODULE_1__.G9.call(a),updateTable.call(a)},updateScroll=function(a){const s=this,c=s.content.getBoundingClientRect(),u=c.left,d=c.top,h=c.width,f=c.height,g=s.records[s.selectedCell[3]][s.selectedCell[2]].element.getBoundingClientRect(),m=g.left,p=g.top,v=g.width,w=g.height;let E,C;a==0||a==1?(E=m-u+s.content.scrollLeft,C=p-d+s.content.scrollTop-2):(E=m-u+s.content.scrollLeft+v,C=p-d+s.content.scrollTop+w),C>s.content.scrollTop+30&&C<s.content.scrollTop+f||(C<s.content.scrollTop+30?s.content.scrollTop=C-w:s.content.scrollTop=C-(f-2));const b=_freeze_js__WEBPACK_IMPORTED_MODULE_6__.w.call(s);E>s.content.scrollLeft+b&&E<s.content.scrollLeft+h||(E<s.content.scrollLeft+30?(s.content.scrollLeft=E,s.content.scrollLeft<50&&(s.content.scrollLeft=0)):E<s.content.scrollLeft+b?s.content.scrollLeft=E-b-1:s.content.scrollLeft=E-(h-20))},updateResult=function(){const a=this;let s=0,c=0;for(s=a.options.lazyLoading==1?100:a.options.pagination>0?a.options.pagination:a.results?a.results.length:a.rows.length;a.tbody.firstChild;)a.tbody.removeChild(a.tbody.firstChild);for(let u=0;u<a.rows.length;u++)!a.results||a.results.indexOf(u)>-1?(c<s&&(a.tbody.appendChild(a.rows[u].element),c++),a.rows[u].element.style.display=""):a.rows[u].element.style.display="none";return a.options.pagination>0&&_pagination_js__WEBPACK_IMPORTED_MODULE_7__.IV.call(a),_selection_js__WEBPACK_IMPORTED_MODULE_1__.Aq.call(a),s},getCell=function(a,s){if(typeof a=="string"){const c=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(a,!0);a=c[0],s=c[1]}return this.records[s][a].element},getCellFromCoords=function(a,s){return this.records[s][a].element},getLabel=function(a,s){if(typeof a=="string"){const c=(0,_internalHelpers_js__WEBPACK_IMPORTED_MODULE_2__.vu)(a,!0);a=c[0],s=c[1]}return this.records[s][a].element.innerHTML},fullscreen=function(a){const s=this;a==null&&(a=!s.config.fullscreen),s.config.fullscreen!=a&&(s.config.fullscreen=a,a==1?s.element.classList.add("fullscreen"):s.element.classList.remove("fullscreen"))},showIndex=function(){this.table.classList.remove("jss_hidden_index")},hideIndex=function(){this.table.classList.add("jss_hidden_index")},createNestedHeader=function(a){const s=this,c=document.createElement("tr");c.classList.add("jss_nested");const u=document.createElement("td");u.classList.add("jss_selectall"),c.appendChild(u),a.element=c;let d=0;for(let h=0;h<a.length;h++){a[h].colspan||(a[h].colspan=1),a[h].title||(a[h].title=""),a[h].id||(a[h].id="");let f=a[h].colspan;const g=[];for(let p=0;p<f;p++)s.options.columns[d]&&s.options.columns[d].type=="hidden"&&f++,g.push(d),d++;const m=document.createElement("td");m.setAttribute("data-column",g.join(",")),m.setAttribute("colspan",a[h].colspan),m.setAttribute("align",a[h].align||"center"),m.setAttribute("id",a[h].id),m.textContent=a[h].title,c.appendChild(m)}return c},getWorksheetActive=function(){const a=this.parent?this.parent:this;return a.element.tabs?a.element.tabs.getActive():0},getWorksheetInstance=function(a){const s=a!==void 0?a:getWorksheetActive.call(this);return this.worksheets[s]}},689:function(a,s,c){c.d(s,{Hh:function(){return d},t3:function(){return f},vu:function(){return h}});var u=c(978);const d=function(g,m,p){if(m<=g.length)return g.slice(0,m).concat(p).concat(g.slice(m));const v=g.slice(0,g.length);for(;m>v.length;)v.push(void 0);return v.concat(p)},h=function(g,m){const p=/^[a-zA-Z]+/.exec(g);if(p){let v=0;for(let E=0;E<p[0].length;E++)v+=parseInt(p[0].charCodeAt(E)-64)*Math.pow(26,p[0].length-1-E);v--,v<0&&(v=0);let w=parseInt(/[0-9]+$/.exec(g));w>0&&w--,g=m==1?[v,w]:v+"-"+w}return g},f=function(g){return Array.isArray(g)||(g=g.split("-")),(0,u.getColumnName)(parseInt(g[0]))+(parseInt(g[1])+1)}},497:function(a,s,c){c.d(s,{AG:function(){return d},G_:function(){return h},p6:function(){return f},wu:function(){return u}});const u=function(g){const m=this;let p;p=m.options.search!=1&&m.options.filters!=1||!m.results?m.rows:m.results;const v=100;g!=null&&g!=-1||(g=Math.ceil(p.length/v)-1);let w=g*v,E=g*v+v;E>p.length&&(E=p.length),w=E-100,w<0&&(w=0);for(let C=w;C<E;C++)m.options.search!=1&&m.options.filters!=1||!m.results?m.tbody.appendChild(m.rows[C].element):m.tbody.appendChild(m.rows[p[C]].element),m.tbody.children.length>v&&m.tbody.removeChild(m.tbody.firstChild)},d=function(){const g=this;if(g.selectedCell){const m=parseInt(g.tbody.firstChild.getAttribute("data-y"))/100,p=parseInt(g.selectedCell[3]/100),v=parseInt(g.rows.length/100);if(m!=p&&p<=v&&!Array.prototype.indexOf.call(g.tbody.children,g.rows[g.selectedCell[3]].element))return g.loadPage(p),!0}return!1},h=function(){const g=this;let m;m=g.options.search!=1&&g.options.filters!=1||!g.results?g.rows:g.results;let p=0;if(m.length>100){let v=parseInt(g.tbody.firstChild.getAttribute("data-y"));if(g.options.search!=1&&g.options.filters!=1||!g.results||(v=m.indexOf(v)),v>0)for(let w=0;w<30;w++)v-=1,v>-1&&(g.options.search!=1&&g.options.filters!=1||!g.results?g.tbody.insertBefore(g.rows[v].element,g.tbody.firstChild):g.tbody.insertBefore(g.rows[m[v]].element,g.tbody.firstChild),g.tbody.children.length>100&&(g.tbody.removeChild(g.tbody.lastChild),p=1))}return p},f=function(){const g=this;let m;m=g.options.search!=1&&g.options.filters!=1||!g.results?g.rows:g.results;let p=0;if(m.length>100){let v=parseInt(g.tbody.lastChild.getAttribute("data-y"));if(g.options.search!=1&&g.options.filters!=1||!g.results||(v=m.indexOf(v)),v<g.rows.length-1)for(let w=0;w<=30;w++)v<m.length&&(g.options.search!=1&&g.options.filters!=1||!g.results?g.tbody.appendChild(g.rows[v].element):g.tbody.appendChild(g.rows[m[v]].element),g.tbody.children.length>100&&(g.tbody.removeChild(g.tbody.firstChild),p=1)),v+=1}return p}},910:function(a,s,c){c.d(s,{D0:function(){return p},FU:function(){return w},Lt:function(){return m},VP:function(){return C},Zp:function(){return E},fd:function(){return v}});var u=c(689),d=c(530),h=c(911),f=c(805),g=c(657);const m=function(b,P){const R=this,T=[];if(R.options.mergeCells){const I=Object.keys(R.options.mergeCells);for(let M=0;M<I.length;M++){const N=(0,u.vu)(I[M],!0),H=R.options.mergeCells[I[M]][0],L=N[0],A=N[0]+(H>1?H-1:0);P==null?L<=b&&A>=b&&T.push(I[M]):P?L<b&&A>=b&&T.push(I[M]):L<=b&&A>b&&T.push(I[M])}}return T},p=function(b,P){const R=this,T=[];if(R.options.mergeCells){const I=Object.keys(R.options.mergeCells);for(let M=0;M<I.length;M++){const N=(0,u.vu)(I[M],!0),H=R.options.mergeCells[I[M]][1],L=N[1],A=N[1]+(H>1?H-1:0);P==null?L<=b&&A>=b&&T.push(I[M]):P?L<b&&A>=b&&T.push(I[M]):L<=b&&A>b&&T.push(I[M])}}return T},v=function(b){const P=this;let R={};if(b)R=P.options.mergeCells&&P.options.mergeCells[b]?[P.options.mergeCells[b][0],P.options.mergeCells[b][1]]:null;else if(P.options.mergeCells){P.options.mergeCells;const T=Object.keys(P.options.mergeCells);for(let I=0;I<T.length;I++)R[T[I]]=[P.options.mergeCells[T[I]][0],P.options.mergeCells[T[I]][1]]}return R},w=function(b,P,R,T){const I=this;let M=!1;if(b){if(typeof b!="string")return null}else{if(!I.highlighted.length)return alert(jSuites.translate("No cells selected")),null;{const H=parseInt(I.highlighted[0].getAttribute("data-x")),L=parseInt(I.highlighted[0].getAttribute("data-y")),A=parseInt(I.highlighted[I.highlighted.length-1].getAttribute("data-x")),k=parseInt(I.highlighted[I.highlighted.length-1].getAttribute("data-y"));b=(0,u.t3)([H,L]),P=A-H+1,R=k-L+1}}const N=(0,u.vu)(b,!0);if(I.options.mergeCells&&I.options.mergeCells[b])I.records[N[1]][N[0]].element.getAttribute("data-merged")&&(M="Cell already merged");else if((!P||P<2)&&(!R||R<2))M="Invalid merged properties";else for(let H=N[1];H<N[1]+R;H++)for(let L=N[0];L<N[0]+P;L++)(0,u.t3)([L,H]),I.records[H][L].element.getAttribute("data-merged")&&(M="There is a conflict with another merged cell");if(M)alert(jSuites.translate(M));else{P>1?I.records[N[1]][N[0]].element.setAttribute("colspan",P):P=1,R>1?I.records[N[1]][N[0]].element.setAttribute("rowspan",R):R=1,I.options.mergeCells||(I.options.mergeCells={}),I.options.mergeCells[b]=[P,R,[]],I.records[N[1]][N[0]].element.setAttribute("data-merged","true"),I.records[N[1]][N[0]].element.style.overflow="hidden";const H=[];for(let L=N[1];L<N[1]+R;L++)for(let A=N[0];A<N[0]+P;A++)N[0]==A&&N[1]==L||(H.push(I.options.data[L][A]),d.k9.call(I,A,L,"",!0),I.options.mergeCells[b][2].push(I.records[L][A].element),I.records[L][A].element.style.display="none",I.records[L][A].element=I.records[N[1]][N[0]].element);g.c6.call(I,I.records[N[1]][N[0]].element),T||(h.Dh.call(I,{action:"setMerge",column:b,colspan:P,rowspan:R,data:H}),f.A.call(I,"onmerge",I,{[b]:[P,R]}))}},E=function(b,P,R){const T=this;if(T.options.mergeCells&&T.options.mergeCells[b]){const I=(0,u.vu)(b,!0);T.records[I[1]][I[0]].element.removeAttribute("colspan"),T.records[I[1]][I[0]].element.removeAttribute("rowspan"),T.records[I[1]][I[0]].element.removeAttribute("data-merged");const M=T.options.mergeCells[b];let N,H,L=0;for(N=0;N<M[1];N++)for(H=0;H<M[0];H++)(N>0||H>0)&&(T.records[I[1]+N][I[0]+H].element=M[2][L],T.records[I[1]+N][I[0]+H].element.style.display="",P&&P[L]&&d.k9.call(T,I[0]+H,I[1]+N,P[L]),L++);g.c6.call(T,T.records[I[1]][I[0]].element,T.records[I[1]+N-1][I[0]+H-1].element),R||delete T.options.mergeCells[b]}},C=function(b){const P=this;if(P.options.mergeCells){P.options.mergeCells;const R=Object.keys(P.options.mergeCells);for(let T=0;T<R.length;T++)E.call(P,R[T],null,b)}}},654:function(a,s,c){c.d(s,{IQ:function(){return d},hs:function(){return h},iZ:function(){return f}});var u=c(805);const d=function(g,m){const p=this;return g?m?p.options.meta&&p.options.meta[g]&&p.options.meta[g][m]?p.options.meta[g][m]:null:p.options.meta&&p.options.meta[g]?p.options.meta[g]:null:p.options.meta},h=function(g){const m=this;if(m.options.meta){const p={},v=Object.keys(m.options.meta);for(let w=0;w<v.length;w++)g[v[w]]?p[g[v[w]]]=m.options.meta[v[w]]:p[v[w]]=m.options.meta[v[w]];m.options.meta=p}},f=function(g,m,p){const v=this;if(v.options.meta||(v.options.meta={}),m&&p)v.options.meta[g]||(v.options.meta[g]={}),v.options.meta[g][m]=p,u.A.call(v,"onchangemeta",v,{[g]:{[m]:p}});else{const w=Object.keys(g);for(let E=0;E<w.length;E++){v.options.meta[w[E]]||(v.options.meta[w[E]]={});const C=Object.keys(g[w[E]]);for(let b=0;b<C.length;b++)v.options.meta[w[E]][C[b]]=g[w[E]][C[b]]}u.A.call(v,"onchangemeta",v,g)}}},94:function(a,s,c){c.d(s,{My:function(){return v},Th:function(){return m},iY:function(){return p}});var u=c(911),d=c(805),h=c(530),f=c(497),g=c(829);const m=function(w,E){const C=this;for(let b=0;b<C.headers.length;b++)C.headers[b].classList.remove("arrow-up"),C.headers[b].classList.remove("arrow-down");E?C.headers[w].classList.add("arrow-up"):C.headers[w].classList.add("arrow-down")},p=function(w){const E=this;let C=[];for(let b=0;b<w.length;b++)C[b]=E.options.data[w[b]];E.options.data=C,C=[];for(let b=0;b<w.length;b++){C[b]=E.records[w[b]];for(let P=0;P<C[b].length;P++)C[b][P].y=b}E.records=C,C=[];for(let b=0;b<w.length;b++)C[b]=E.rows[w[b]],C[b].y=b;if(E.rows=C,h.o8.call(E),E.results&&E.results.length)E.searchInput.value?E.search(E.searchInput.value):g.F8.call(E);else if(E.results=null,E.pageNumber=0,E.options.pagination>0)E.page(0);else if(E.options.lazyLoading==1)f.wu.call(E,0);else for(let b=0;b<E.rows.length;b++)E.tbody.appendChild(E.rows[b].element)},v=function(w,E){const C=this;if(w>=0){if(C.options.mergeCells&&Object.keys(C.options.mergeCells).length>0){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;C.destroyMerge()}E=E==null?C.headers[w].classList.contains("arrow-down")?1:0:E?1:0;let b=[];if(C.options.columns&&C.options.columns[w]&&(C.options.columns[w].type=="number"||C.options.columns[w].type=="numeric"||C.options.columns[w].type=="percentage"||C.options.columns[w].type=="autonumber"||C.options.columns[w].type=="color"))for(let R=0;R<C.options.data.length;R++)b[R]=[R,Number(C.options.data[R][w])];else if(C.options.columns&&C.options.columns[w]&&(C.options.columns[w].type=="calendar"||C.options.columns[w].type=="checkbox"||C.options.columns[w].type=="radio"))for(let R=0;R<C.options.data.length;R++)b[R]=[R,C.options.data[R][w]];else for(let R=0;R<C.options.data.length;R++)b[R]=[R,C.records[R][w].element.textContent.toLowerCase()];typeof C.parent.config.sorting!="function"&&(C.parent.config.sorting=function(R){return function(T,I){const M=T[1],N=I[1];return R?M===""&&N!==""?1:M!==""&&N===""||M>N?-1:M<N?1:0:M===""&&N!==""?1:M!==""&&N===""?-1:M>N?1:M<N?-1:0}}),b=b.sort(C.parent.config.sorting(E));const P=[];for(let R=0;R<b.length;R++)P[R]=b[R][0];return u.Dh.call(C,{action:"orderBy",rows:P,column:w,order:E}),m.call(C,w,E),p.call(C,P),d.A.call(C,"onsort",C,w,E,P.map((R=>R))),!0}}},167:function(a,s,c){c.d(s,{$f:function(){return m},IV:function(){return f},MY:function(){return g},ho:function(){return h}});var u=c(805),d=c(657);const h=function(p){const v=this;return v.options.search!=1&&v.options.filters!=1||!v.results||(p=v.results.indexOf(p)),Math.ceil((parseInt(p)+1)/parseInt(v.options.pagination))-1},f=function(){const p=this;if(p.pagination.children[0].innerHTML="",p.pagination.children[1].innerHTML="",p.options.pagination){let v;if(v=p.options.search!=1&&p.options.filters!=1||!p.results?p.rows.length:p.results.length,v){const w=Math.ceil(v/p.options.pagination);let E,C;if(p.pageNumber<6?(E=1,C=w<10?w:10):w-p.pageNumber<5?(E=w-9,C=w,E<1&&(E=1)):(E=p.pageNumber-4,C=p.pageNumber+5),E>1){const P=document.createElement("div");P.className="jss_page",P.innerHTML="<",P.title=1,p.pagination.children[1].appendChild(P)}for(let P=E;P<=C;P++){const R=document.createElement("div");R.className="jss_page",R.innerHTML=P,p.pagination.children[1].appendChild(R),p.pageNumber==P-1&&R.classList.add("jss_page_selected")}if(C<w){const P=document.createElement("div");P.className="jss_page",P.innerHTML=">",P.title=w,p.pagination.children[1].appendChild(P)}const b=function(P){const R=Array.prototype.slice.call(arguments,1);return P.replace(/{(\d+)}/g,(function(T,I){return R[I]!==void 0?R[I]:T}))};p.pagination.children[0].innerHTML=b(jSuites.translate("Showing page {0} of {1} entries"),p.pageNumber+1,w)}else p.pagination.children[0].innerHTML=jSuites.translate("No records found")}},g=function(p){const v=this,w=v.pageNumber;let E;E=v.options.search!=1&&v.options.filters!=1||!v.results?v.rows:v.results;const C=parseInt(v.options.pagination);p!=null&&p!=-1||(p=Math.ceil(E.length/C)-1),v.pageNumber=p;let b=p*C,P=p*C+C;for(P>E.length&&(P=E.length),b<0&&(b=0);v.tbody.firstChild;)v.tbody.removeChild(v.tbody.firstChild);for(let R=b;R<P;R++)v.options.search!=1&&v.options.filters!=1||!v.results?v.tbody.appendChild(v.rows[R].element):v.tbody.appendChild(v.rows[E[R]].element);v.options.pagination>0&&f.call(v),d.Aq.call(v),u.A.call(v,"onchangepage",v,p,w,v.options.pagination)},m=function(){const p=this;let v;return v=p.options.search!=1&&p.options.filters!=1||!p.results?p.rows.length:p.results.length,Math.ceil(v/p.options.pagination)}},657:function(a,s,c){c.d(s,{AH:function(){return b},Aq:function(){return v},G9:function(){return R},Jg:function(){return P},Lo:function(){return k},R5:function(){return L},Ub:function(){return A},at:function(){return H},c6:function(){return E},eO:function(){return G},ef:function(){return W},gE:function(){return w},gG:function(){return T},kA:function(){return C},kF:function(){return M},kV:function(){return ae},sp:function(){return oe},tW:function(){return N}});var u=c(805),d=c(296),h=c(978),f=c(911),g=c(530),m=c(689),p=c(392);const v=function(){const X=this;if(X.highlighted&&X.highlighted.length){const le=X.highlighted[X.highlighted.length-1].element,ye=le.getAttribute("data-x"),pe=X.content.getBoundingClientRect(),he=pe.left,Me=pe.top,Qe=le.getBoundingClientRect(),Xe=Qe.left,Ke=Qe.top,it=Qe.width,te=Qe.height,Pe=Xe-he+X.content.scrollLeft+it-4,U=Ke-Me+X.content.scrollTop+te-4;if(X.corner.style.top=U+"px",X.corner.style.left=Pe+"px",X.options.freezeColumns){const Q=d.w.call(X);ye>X.options.freezeColumns-1&&Xe-he+it<Q?X.corner.style.display="none":X.options.selectionCopy!=0&&(X.corner.style.display="")}else X.options.selectionCopy!=0&&(X.corner.style.display="")}else X.corner.style.top="-2000px",X.corner.style.left="-2000px";(0,p.nK)(X)},w=function(X){const le=this;let ye;if(le.highlighted&&le.highlighted.length){ye=1;for(let pe=0;pe<le.highlighted.length;pe++){le.highlighted[pe].element.classList.remove("highlight"),le.highlighted[pe].element.classList.remove("highlight-left"),le.highlighted[pe].element.classList.remove("highlight-right"),le.highlighted[pe].element.classList.remove("highlight-top"),le.highlighted[pe].element.classList.remove("highlight-bottom"),le.highlighted[pe].element.classList.remove("highlight-selected");const he=parseInt(le.highlighted[pe].element.getAttribute("data-x")),Me=parseInt(le.highlighted[pe].element.getAttribute("data-y"));let Qe,Xe;if(le.highlighted[pe].element.getAttribute("data-merged")){const Ke=parseInt(le.highlighted[pe].element.getAttribute("colspan")),it=parseInt(le.highlighted[pe].element.getAttribute("rowspan"));Qe=Ke>0?he+(Ke-1):he,Xe=it>0?Me+(it-1):Me}else Qe=he,Xe=Me;for(let Ke=he;Ke<=Qe;Ke++)le.headers[Ke]&&le.headers[Ke].classList.remove("selected");for(let Ke=Me;Ke<=Xe;Ke++)le.rows[Ke]&&le.rows[Ke].element.classList.remove("selected")}}else ye=0;return le.highlighted=[],le.selectedCell=null,le.corner.style.top="-2000px",le.corner.style.left="-2000px",X==1&&ye==1&&u.A.call(le,"onblur",le),ye},E=function(X,le,ye){const pe=X.getAttribute("data-x"),he=X.getAttribute("data-y");let Me,Qe;le?(Me=le.getAttribute("data-x"),Qe=le.getAttribute("data-y")):(Me=pe,Qe=he),b.call(this,pe,he,Me,Qe,ye)},C=function(){const X=document.querySelectorAll(".jss_worksheet .copying");for(let le=0;le<X.length;le++)X[le].classList.remove("copying"),X[le].classList.remove("copying-left"),X[le].classList.remove("copying-right"),X[le].classList.remove("copying-top"),X[le].classList.remove("copying-bottom")},b=function(X,le,ye,pe,he){const Me=this;if(le==null){if(le=0,pe=Me.rows.length-1,X==null)return}else X==null&&(X=0,ye=Me.options.data[0].length-1);ye==null&&(ye=X),pe==null&&(pe=le),X>=Me.headers.length&&(X=Me.headers.length-1),le>=Me.rows.length&&(le=Me.rows.length-1),ye>=Me.headers.length&&(ye=Me.headers.length-1),pe>=Me.rows.length&&(pe=Me.rows.length-1);let Qe,Xe,Ke,it,te=null,Pe=null,U=null,Q=null;parseInt(X)<parseInt(ye)?(Qe=parseInt(X),Xe=parseInt(ye)):(Qe=parseInt(ye),Xe=parseInt(X)),parseInt(le)<parseInt(pe)?(Ke=parseInt(le),it=parseInt(pe)):(Ke=parseInt(pe),it=parseInt(le));for(let ce=Qe;ce<=Xe;ce++)for(let ve=Ke;ve<=it;ve++)if(Me.records[ve][ce]&&Me.records[ve][ce].element.getAttribute("data-merged")){const K=parseInt(Me.records[ve][ce].element.getAttribute("data-x")),ne=parseInt(Me.records[ve][ce].element.getAttribute("data-y")),de=parseInt(Me.records[ve][ce].element.getAttribute("colspan")),Oe=parseInt(Me.records[ve][ce].element.getAttribute("rowspan"));de>1&&(K<Qe&&(Qe=K),K+de>Xe&&(Xe=K+de-1)),Oe&&(ne<Ke&&(Ke=ne),ne+Oe>it&&(it=ne+Oe-1))}for(let ce=Ke;ce<=it;ce++)Me.rows[ce].element.style.display!="none"&&(U==null&&(U=ce),Q=ce);for(let ce=Qe;ce<=Xe;ce++)for(let ve=Ke;ve<=it;ve++)Me.options.columns&&Me.options.columns[ce]&&Me.options.columns[ce].type=="hidden"||(te==null&&(te=ce),Pe=ce);if(te||(te=0),Pe||(Pe=0),u.A.call(Me,"onbeforeselection",Me,te,U,Pe,Q,he)===!1)return!1;const ee=Me.resetSelection();Me.selectedCell=[X,le,ye,pe],Me.records[le][X]&&Me.records[le][X].element.classList.add("highlight-selected");for(let ce=Qe;ce<=Xe;ce++)for(let ve=Ke;ve<=it;ve++)Me.rows[ve].element.style.display!="none"&&Me.records[ve][ce].element.style.display!="none"&&(Me.records[ve][ce].element.classList.add("highlight"),Me.highlighted.push(Me.records[ve][ce]));for(let ce=te;ce<=Pe;ce++)Me.options.columns&&Me.options.columns[ce]&&Me.options.columns[ce].type=="hidden"||!Me.cols[ce].colElement.style||Me.cols[ce].colElement.style.display=="none"||(Me.records[U]&&Me.records[U][ce]&&Me.records[U][ce].element.classList.add("highlight-top"),Me.records[Q]&&Me.records[Q][ce]&&Me.records[Q][ce].element.classList.add("highlight-bottom"),Me.headers[ce].classList.add("selected"));for(let ce=U;ce<=Q;ce++)Me.rows[ce]&&Me.rows[ce].element.style.display!="none"&&(Me.records[ce][te].element.classList.add("highlight-left"),Me.records[ce][Pe].element.classList.add("highlight-right"),Me.rows[ce].element.classList.add("selected"));Me.selectedContainer=[te,U,Pe,Q],ee==0&&(u.A.call(Me,"onfocus",Me),C()),u.A.call(Me,"onselection",Me,te,U,Pe,Q,he),v.call(Me)},P=function(X){const le=this;if(!le.selectedCell)return[];const ye=[];for(let pe=Math.min(le.selectedCell[0],le.selectedCell[2]);pe<=Math.max(le.selectedCell[0],le.selectedCell[2]);pe++)X&&le.headers[pe].style.display=="none"||ye.push(pe);return ye},R=function(){const X=this;X.selectedCell&&X.updateSelectionFromCoords(X.selectedCell[0],X.selectedCell[1],X.selectedCell[2],X.selectedCell[3])},T=function(){const X=this;for(let le=0;le<X.selection.length;le++)X.selection[le].classList.remove("selection"),X.selection[le].classList.remove("selection-left"),X.selection[le].classList.remove("selection-right"),X.selection[le].classList.remove("selection-top"),X.selection[le].classList.remove("selection-bottom");X.selection=[]},I=function(X){return(X=""+X).length==1&&(X="0"+X),X},M=function(X,le){const ye=this,pe=ye.getData(!0,!1),he=ye.selectedContainer,Me=parseInt(X.getAttribute("data-x")),Qe=parseInt(X.getAttribute("data-y")),Xe=parseInt(le.getAttribute("data-x")),Ke=parseInt(le.getAttribute("data-y")),it=[];let te,Pe,U=!1;he[0]==Me?(te=Qe<he[1]?Qe-he[1]:1,Pe=0):(Pe=Me<he[0]?Me-he[0]:1,te=0);let Q=0,ee=0;for(let ve=Qe;ve<=Ke;ve++)if(!ye.rows[ve]||ye.rows[ve].element.style.display!="none"){pe[ee]==null&&(ee=0),Q=0,he[0]!=Me&&(Pe=Me<he[0]?Me-he[0]:1);for(let K=Me;K<=Xe;K++){if(ye.records[ve][K]&&!ye.records[ve][K].element.classList.contains("readonly")&&ye.records[ve][K].element.style.display!="none"&&U==0){if(!ye.selection.length&&ye.options.data[ve][K]!=""){U=!0;continue}(pe[ee]==null||pe[ee][Q]==null)&&(Q=0);let ne=pe[ee][Q];if(ne&&!pe[1]&&ye.parent.config.autoIncrement!=0)if(!ye.options.columns||!ye.options.columns[K]||ye.options.columns[K].type&&ye.options.columns[K].type!="text"&&ye.options.columns[K].type!="number"){if(ye.options.columns&&ye.options.columns[K]&&ye.options.columns[K].type=="calendar"){const de=new Date(ne);de.setDate(de.getDate()+te),ne=de.getFullYear()+"-"+I(parseInt(de.getMonth()+1))+"-"+I(de.getDate())+" 00:00:00"}}else if((""+ne).substr(0,1)=="="){const de=ne.match(/([A-Z]+[0-9]+)/g);if(de){const Oe=[];for(let Se=0;Se<de.length;Se++){const ge=(0,m.vu)(de[Se],1);ge[0]+=Pe,ge[1]+=te,ge[1]<0&&(ge[1]=0);const De=(0,m.t3)([ge[0],ge[1]]);De!=de[Se]&&(Oe[de[Se]]=De)}Oe&&(ne=(0,g.yB)(ne,Oe))}}else ne==Number(ne)&&(ne=Number(ne)+te);it.push(g.k9.call(ye,K,ve,ne)),g.xF.call(ye,K,ve,it)}Q++,he[0]!=Me&&Pe++}ee++,te++}f.Dh.call(ye,{action:"setValue",records:it,selection:ye.selectedCell}),g.am.call(ye);const ce=it.map((function(ve){return{x:ve.x,y:ve.y,value:ve.value,oldValue:ve.oldValue}}));u.A.call(ye,"onafterchanges",ye,ce)},N=function(X){let le,ye,pe=0;if(!X||X.length===0)return pe;for(le=0;le<X.length;le++)ye=X.charCodeAt(le),pe=(pe<<5)-pe+ye,pe|=0;return pe},H=function(X,le,ye){const pe=this;if(X==1){if(pe.selectedCell&&(le>=pe.selectedCell[1]&&le<=pe.selectedCell[3]||ye>=pe.selectedCell[1]&&ye<=pe.selectedCell[3]))return void pe.resetSelection()}else if(pe.selectedCell&&(le>=pe.selectedCell[0]&&le<=pe.selectedCell[2]||ye>=pe.selectedCell[0]&&ye<=pe.selectedCell[2]))return void pe.resetSelection()},L=function(X){const le=this;if(!le.selectedCell)return[];const ye=[];for(let pe=Math.min(le.selectedCell[1],le.selectedCell[3]);pe<=Math.max(le.selectedCell[1],le.selectedCell[3]);pe++)X&&le.rows[pe].element.style.display=="none"||ye.push(pe);return ye},A=function(){const X=this;X.selectedCell||(X.selectedCell=[]),X.selectedCell[0]=0,X.selectedCell[1]=0,X.selectedCell[2]=X.headers.length-1,X.selectedCell[3]=X.records.length-1,X.updateSelectionFromCoords(X.selectedCell[0],X.selectedCell[1],X.selectedCell[2],X.selectedCell[3])},k=function(){const X=this;return X.selectedCell?[Math.min(X.selectedCell[0],X.selectedCell[2]),Math.min(X.selectedCell[1],X.selectedCell[3]),Math.max(X.selectedCell[0],X.selectedCell[2]),Math.max(X.selectedCell[1],X.selectedCell[3])]:null},W=function(X){const le=this,ye=k.call(le);if(!ye)return[];const pe=[];for(let he=ye[1];he<=ye[3];he++)for(let Me=ye[0];Me<=ye[2];Me++)X?pe.push((0,h.getCellNameFromCoords)(Me,he)):pe.push(le.records[he][Me]);return pe},G=function(){const X=this,le=k.call(X);if(!le)return"";const ye=(0,h.getCellNameFromCoords)(le[0],le[1]),pe=(0,h.getCellNameFromCoords)(le[2],le[3]);return ye===pe?X.options.worksheetName+"!"+ye:X.options.worksheetName+"!"+ye+":"+pe},oe=function(X,le){const ye=k.call(this);return X>=ye[0]&&X<=ye[2]&&le>=ye[1]&&le<=ye[3]},ae=function(){const X=k.call(this);return X?[X]:[]}},392:function(a,s,c){c.d(s,{Ar:function(){return w},ll:function(){return v},nK:function(){return p}});var u=c(978),d=c(530);const h=function(E,C){C.options.editable!=0?E.classList.remove("jtoolbar-disabled"):E.classList.add("jtoolbar-disabled")},f=function(){const E=[],C=this,b=function(){return d.eN.call(C)};E.push({content:"undo",onclick:function(){b().undo()}}),E.push({content:"redo",onclick:function(){b().redo()}}),E.push({content:"save",onclick:function(){const R=b();R&&R.download()}}),E.push({type:"divisor"}),E.push({type:"select",width:"120px",options:["Default","Verdana","Arial","Courier New"],render:function(R){return'<span style="font-family:'+R+'">'+R+"</span>"},onchange:function(R,T,I,M,N){const H=b();let L=H.getSelected(!0);if(L){let A=N?M:"";H.setStyle(Object.fromEntries(L.map((function(k){return[k,"font-family: "+A]}))))}},updateState:function(R,T,I){h(I,b())}}),E.push({type:"select",width:"48px",content:"format_size",options:["x-small","small","medium","large","x-large"],render:function(R){return'<span style="font-size:'+R+'">'+R+"</span>"},onchange:function(R,T,I,M){const N=b();let H=N.getSelected(!0);H&&N.setStyle(Object.fromEntries(H.map((function(L){return[L,"font-size: "+M]}))))},updateState:function(R,T,I){h(I,b())}}),E.push({type:"select",options:["left","center","right","justify"],render:function(R){return'<i class="material-icons">format_align_'+R+"</i>"},onchange:function(R,T,I,M){const N=b();let H=N.getSelected(!0);H&&N.setStyle(Object.fromEntries(H.map((function(L){return[L,"text-align: "+M]}))))},updateState:function(R,T,I){h(I,b())}}),E.push({content:"format_bold",onclick:function(R,T,I){const M=b();let N=M.getSelected(!0);N&&M.setStyle(Object.fromEntries(N.map((function(H){return[H,"font-weight:bold"]}))))},updateState:function(R,T,I){h(I,b())}}),E.push({type:"color",content:"format_color_text",k:"color",updateState:function(R,T,I){h(I,b())}}),E.push({type:"color",content:"format_color_fill",k:"background-color",updateState:function(R,T,I,M){h(I,b())}});let P=["top","middle","bottom"];return E.push({type:"select",options:["vertical_align_top","vertical_align_center","vertical_align_bottom"],render:function(R){return'<i class="material-icons">'+R+"</i>"},value:1,onchange:function(R,T,I,M,N){const H=b();let L=H.getSelected(!0);L&&H.setStyle(Object.fromEntries(L.map((function(A){return[A,"vertical-align: "+P[N]]}))))},updateState:function(R,T,I){h(I,b())}}),E.push({content:"web",tooltip:jSuites.translate("Merge the selected cells"),onclick:function(){const R=b();if(R.selectedCell&&confirm(jSuites.translate("The merged cells will retain the value of the top-left cell only. Are you sure?"))){const T=[Math.min(R.selectedCell[0],R.selectedCell[2]),Math.min(R.selectedCell[1],R.selectedCell[3]),Math.max(R.selectedCell[0],R.selectedCell[2]),Math.max(R.selectedCell[1],R.selectedCell[3])];let I=(0,u.getCellNameFromCoords)(T[0],T[1]);if(R.records[T[1]][T[0]].element.getAttribute("data-merged"))R.removeMerge(I);else{let M=T[2]-T[0]+1,N=T[3]-T[1]+1;M===1&&N===1||R.setMerge(I,M,N)}}},updateState:function(R,T,I){h(I,b())}}),E.push({type:"select",options:["border_all","border_outer","border_inner","border_horizontal","border_vertical","border_left","border_top","border_right","border_bottom","border_clear"],columns:5,render:function(R){return'<i class="material-icons">'+R+"</i>"},right:!0,onchange:function(R,T,I,M){const N=b();if(N.selectedCell){const H=[Math.min(N.selectedCell[0],N.selectedCell[2]),Math.min(N.selectedCell[1],N.selectedCell[3]),Math.max(N.selectedCell[0],N.selectedCell[2]),Math.max(N.selectedCell[1],N.selectedCell[3])];let L=M;if(H){let A=T.thickness||1,k=T.color||"black";const W=T.style||"solid";W==="double"&&(A+=2);let G={},oe=H[0],ae=H[1],X=H[2],le=H[3];const ye=function(pe,he,Me){let Qe=["","","",""];Qe[0]=(L==="border_top"||L==="border_outer")&&Me===ae||(L==="border_inner"||L==="border_horizontal")&&Me>ae||L==="border_all"?"border-top: "+A+"px "+W+" "+k:"border-top: ",Qe[1]=L!=="border_all"&&L!=="border_right"&&L!=="border_outer"||he!==X?"border-right: ":"border-right: "+A+"px "+W+" "+k,Qe[2]=L!=="border_all"&&L!=="border_bottom"&&L!=="border_outer"||Me!==le?"border-bottom: ":"border-bottom: "+A+"px "+W+" "+k,Qe[3]=(L==="border_left"||L==="border_outer")&&he===oe||(L==="border_inner"||L==="border_vertical")&&he>oe||L==="border_all"?"border-left: "+A+"px "+W+" "+k:"border-left: ",G[pe]=Qe.join(";")};for(let pe=H[1];pe<=H[3];pe++)for(let he=H[0];he<=H[2];he++)ye((0,u.getCellNameFromCoords)(he,pe),he,pe),N.records[pe][he].element.getAttribute("data-merged")&&ye((0,u.getCellNameFromCoords)(H[0],H[1]),he,pe);Object.keys(G)&&N.setStyle(G)}}},onload:function(R,T){let I=document.createElement("div"),M=document.createElement("div");I.appendChild(M);let N=jSuites.color(M,{closeOnChange:!1,onchange:function(A,k){A.parentNode.children[1].style.color=k,T.color=k}}),H=document.createElement("i");H.classList.add("material-icons"),H.innerHTML="color_lens",H.onclick=function(){N.open()},I.appendChild(H),R.children[1].appendChild(I),M=document.createElement("div"),jSuites.picker(M,{type:"select",data:[1,2,3,4,5],render:function(A){return'<div style="height: '+A+'px; width: 30px; background-color: black;"></div>'},onchange:function(A,k,W,G){T.thickness=G},width:"50px"}),R.children[1].appendChild(M);const L=document.createElement("div");jSuites.picker(L,{type:"select",data:["solid","dotted","dashed","double"],render:function(A){return A==="double"?'<div style="width: 30px; border-top: 3px '+A+' black;"></div>':'<div style="width: 30px; border-top: 2px '+A+' black;"></div>'},onchange:function(A,k,W,G){T.style=G},width:"50px"}),R.children[1].appendChild(L),M=document.createElement("div"),M.style.flex="1",R.children[1].appendChild(M)},updateState:function(R,T,I){h(I,b())}}),E.push({type:"divisor"}),E.push({content:"fullscreen",tooltip:"Toggle Fullscreen",onclick:function(R,T,I){I.children[0].textContent==="fullscreen"?(C.fullscreen(!0),I.children[0].textContent="fullscreen_exit"):(C.fullscreen(!1),I.children[0].textContent="fullscreen")},updateState:function(R,T,I,M){M.parent.config.fullscreen===!0?I.children[0].textContent="fullscreen_exit":I.children[0].textContent="fullscreen"}}),E},g=function(E){const C=this,b=E.items;for(let P=0;P<b.length;P++)b[P].tooltip&&(b[P].title=b[P].tooltip,delete b[P].tooltip),b[P].type=="select"?b[P].options?(b[P].data=b[P].options,delete b[P].options):(b[P].data=b[P].v,delete b[P].v,b[P].k&&!b[P].onchange&&(b[P].onchange=function(R,T,I){const M=d.eN.call(C),N=M.getSelected(!0);M.setStyle(Object.fromEntries(N.map((function(H){return[H,b[P].k+": "+I]}))))})):b[P].type=="color"&&(b[P].type="i",b[P].onclick=function(R,T,I){I.color||(jSuites.color(I,{onchange:function(M,N){const H=d.eN.call(C),L=H.getSelected(!0);H.setStyle(Object.fromEntries(L.map((function(A){return[A,b[P].k+": "+N]}))))},onopen:function(M){M.color.select("")}}),I.color.open())})},m=function(E){const C=this,b=document.createElement("div");return b.classList.add("jss_toolbar"),g.call(C,E),typeof C.plugins=="object"&&Object.entries(C.plugins).forEach((function([,P]){if(typeof P.toolbar=="function"){const R=P.toolbar(E);R&&(E=R)}})),jSuites.toolbar(b,E),b},p=function(E){E.parent.toolbar&&E.parent.toolbar.toolbar.update(E)},v=function(){const E=this;if(E.config.toolbar&&!E.toolbar){let C;Array.isArray(E.config.toolbar)?C={items:E.config.toolbar}:typeof E.config.toolbar=="object"?C=E.config.toolbar:(C={items:f.call(E)},typeof E.config.toolbar=="function"&&(C=E.config.toolbar(C))),E.toolbar=E.element.insertBefore(m.call(E,C),E.element.children[1])}},w=function(){const E=this;E.toolbar&&(E.toolbar.parentNode.removeChild(E.toolbar),delete E.toolbar)}}},__webpack_module_cache__={};function __webpack_require__(a){var s=__webpack_module_cache__[a];if(s!==void 0)return s.exports;var c=__webpack_module_cache__[a]={exports:{}};return __webpack_modules__[a](c,c.exports,__webpack_require__),c.exports}__webpack_require__.d=function(a,s){for(var c in s)__webpack_require__.o(s,c)&&!__webpack_require__.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:s[c]})},__webpack_require__.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},__webpack_require__.r=function(a){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})};var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:function(){return src}});const lib={jspreadsheet:{}};var libraryBase=lib,dispatch=__webpack_require__(805),internal=__webpack_require__(530),utils_history=__webpack_require__(911);const openEditor=function(a,s,c){const u=this,d=a.getAttribute("data-y"),h=a.getAttribute("data-x");dispatch.A.call(u,"oneditionstart",u,a,parseInt(h),parseInt(d)),h>0&&(u.records[d][h-1].element.style.overflow="hidden");const f=function(g){const m=a.getBoundingClientRect(),p=document.createElement(g);return p.style.width=m.width+"px",p.style.height=m.height-2+"px",p.style.minHeight=m.height-2+"px",a.classList.add("editor"),a.innerHTML="",a.appendChild(p),p};if(a.classList.contains("readonly")!=1){if(u.edition=[u.records[d][h].element,u.records[d][h].element.innerHTML,h,d],u.options.columns&&u.options.columns[h]&&typeof u.options.columns[h].type=="object")u.options.columns[h].type.openEditor(a,u.options.data[d][h],parseInt(h),parseInt(d),u,u.options.columns[h],c),dispatch.A.call(u,"oncreateeditor",u,a,parseInt(h),parseInt(d),null,u.options.columns[h]);else if(!(u.options.columns&&u.options.columns[h]&&u.options.columns[h].type=="hidden"))if(u.options.columns&&u.options.columns[h]&&(u.options.columns[h].type=="checkbox"||u.options.columns[h].type=="radio")){const g=!a.children[0].checked;u.setValue(a,g),u.edition=null}else if(u.options.columns&&u.options.columns[h]&&u.options.columns[h].type=="dropdown"){let g,m=u.options.data[d][h];u.options.columns[h].multiple&&!Array.isArray(m)&&(m=m.split(";")),g=typeof u.options.columns[h].filter=="function"?u.options.columns[h].filter(u.element,a,h,d,u.options.columns[h].source):u.options.columns[h].source;const p=[];if(g)for(let E=0;E<g.length;E++)p.push(g[E]);const v=f("div");dispatch.A.call(u,"oncreateeditor",u,a,parseInt(h),parseInt(d),null,u.options.columns[h]);const w={data:p,multiple:!!u.options.columns[h].multiple,autocomplete:!!u.options.columns[h].autocomplete,opened:!0,value:m,width:"100%",height:v.style.minHeight,position:u.options.tableOverflow==1||u.parent.config.fullscreen==1,onclose:function(){closeEditor.call(u,a,!0)}};u.options.columns[h].options&&u.options.columns[h].options.type&&(w.type=u.options.columns[h].options.type),jSuites.dropdown(v,w)}else if(u.options.columns&&u.options.columns[h]&&(u.options.columns[h].type=="calendar"||u.options.columns[h].type=="color")){const g=u.options.data[d][h],m=f("input");dispatch.A.call(u,"oncreateeditor",u,a,parseInt(h),parseInt(d),null,u.options.columns[h]),m.value=g;const p=u.options.columns[h].options?{...u.options.columns[h].options}:{};if(u.options.tableOverflow!=1&&u.parent.config.fullscreen!=1||(p.position=!0),p.value=u.options.data[d][h],p.opened=!0,p.onclose=function(v,w){closeEditor.call(u,a,!0)},u.options.columns[h].type=="color"){jSuites.color(m,p);const v=a.getBoundingClientRect();p.position&&(m.nextSibling.children[1].style.top=v.top+v.height+"px",m.nextSibling.children[1].style.left=v.left+"px")}else p.format||(p.format="YYYY-MM-DD"),jSuites.calendar(m,p);m.focus()}else if(u.options.columns&&u.options.columns[h]&&u.options.columns[h].type=="html"){const g=u.options.data[d][h],m=f("div");dispatch.A.call(u,"oncreateeditor",u,a,parseInt(h),parseInt(d),null,u.options.columns[h]),m.style.position="relative";const p=document.createElement("div");p.classList.add("jss_richtext"),m.appendChild(p),jSuites.editor(p,{focus:!0,value:g});const v=a.getBoundingClientRect(),w=p.getBoundingClientRect();window.innerHeight<v.bottom+w.height?p.style.top=v.bottom-(w.height+2)+"px":p.style.top=v.top+"px",window.innerWidth<v.left+w.width?p.style.left=v.right-(w.width+2)+"px":p.style.left=v.left+"px"}else if(u.options.columns&&u.options.columns[h]&&u.options.columns[h].type=="image"){const g=a.children[0],m=f("div");dispatch.A.call(u,"oncreateeditor",u,a,parseInt(h),parseInt(d),null,u.options.columns[h]),m.style.position="relative";const p=document.createElement("div");p.classList.add("jclose"),g&&g.src&&p.appendChild(g),m.appendChild(p),jSuites.image(p,u.options.columns[h]);const v=a.getBoundingClientRect(),w=p.getBoundingClientRect();window.innerHeight<v.bottom+w.height?p.style.top=v.top-(w.height+2)+"px":p.style.top=v.top+"px",p.style.left=v.left+"px"}else{const g=s==1?"":u.options.data[d][h];let m;m=u.options.columns&&u.options.columns[h]&&u.options.columns[h].wordWrap==0||!(u.options.wordWrap==1||u.options.columns&&u.options.columns[h]&&u.options.columns[h].wordWrap==1)?f("input"):f("textarea"),dispatch.A.call(u,"oncreateeditor",u,a,parseInt(h),parseInt(d),null,u.options.columns[h]),m.focus(),m.value=g;const p=u.options.columns&&u.options.columns[h];if(!(0,internal.dw)(g)&&p){const v=(0,internal.rS)(p);if(v){if(!p.disabledMaskOnEdition)if(p.mask){const w=p.mask.split(";");m.setAttribute("data-mask",w[0])}else p.locale&&m.setAttribute("data-locale",p.locale);v.input=m,m.mask=v,jSuites.mask.render(g,v,!1)}}m.onblur=function(){closeEditor.call(u,a,!0)},m.scrollLeft=m.scrollWidth}}},closeEditor=function(a,s){const c=this,u=parseInt(a.getAttribute("data-x")),d=parseInt(a.getAttribute("data-y"));let h;if(s==1){if(c.options.columns&&c.options.columns[u]&&typeof c.options.columns[u].type=="object")h=c.options.columns[u].type.closeEditor(a,s,parseInt(u),parseInt(d),c,c.options.columns[u]);else if(!(c.options.columns&&c.options.columns[u]&&(c.options.columns[u].type=="checkbox"||c.options.columns[u].type=="radio"||c.options.columns[u].type=="hidden")))if(c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="dropdown")h=a.children[0].dropdown.close(!0);else if(c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="calendar")h=a.children[0].calendar.close(!0);else if(c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="color")h=a.children[0].color.close(!0);else if(c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="html")h=a.children[0].children[0].editor.getData();else if(c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="image"){const f=a.children[0].children[0].children[0];h=f&&f.tagName=="IMG"?f.src:""}else if(c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="numeric")h=a.children[0].value,(""+h).substr(0,1)!="="&&h==""&&(h=c.options.columns[u].allowEmpty?"":0),a.children[0].onblur=null;else{h=a.children[0].value,a.children[0].onblur=null;const f=c.options.columns&&c.options.columns[u];if(f){const g=(0,internal.rS)(f);if(g&&h!==""&&!(0,internal.dw)(h)&&typeof h!="number"){const m=jSuites.mask.extract(h,g,!0);m&&m.value!==""&&(h=m.value)}}}c.options.data[d][u]==h?a.innerHTML=c.edition[1]:c.setValue(a,h)}else c.options.columns&&c.options.columns[u]&&typeof c.options.columns[u].type=="object"?c.options.columns[u].type.closeEditor(a,s,parseInt(u),parseInt(d),c,c.options.columns[u]):c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="dropdown"?a.children[0].dropdown.close(!0):c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="calendar"?a.children[0].calendar.close(!0):c.options.columns&&c.options.columns[u]&&c.options.columns[u].type=="color"?a.children[0].color.close(!0):a.children[0].onblur=null,a.innerHTML=c.edition&&c.edition[1]?c.edition[1]:"";dispatch.A.call(c,"oneditionend",c,a,u,d,h,s),a.classList.remove("editor"),c.edition=null},setCheckRadioValue=function(){const a=this,s=[],c=Object.keys(a.highlighted);for(let u=0;u<c.length;u++){const d=a.highlighted[u].element.getAttribute("data-x"),h=a.highlighted[u].element.getAttribute("data-y");a.options.columns[d].type!="checkbox"&&a.options.columns[d].type!="radio"||s.push(internal.k9.call(a,d,h,!a.options.data[h][d]))}if(s.length){utils_history.Dh.call(a,{action:"setValue",records:s,selection:a.selectedCell});const u=s.map((function(d){return{x:d.x,y:d.y,value:d.value,oldValue:d.oldValue}}));dispatch.A.call(a,"onafterchanges",a,u)}};var lazyLoading=__webpack_require__(497);const upGet=function(a,s){const c=this;a=parseInt(a);for(let u=(s=parseInt(s))-1;u>=0;u--)if(c.records[u][a].element.style.display!="none"&&c.rows[u].element.style.display!="none"){if(c.records[u][a].element.getAttribute("data-merged")&&c.records[u][a].element==c.records[s][a].element)continue;s=u;break}return s},upVisible=function(a,s){const c=this;let u,d;if(a==0?(u=parseInt(c.selectedCell[0]),d=parseInt(c.selectedCell[1])):(u=parseInt(c.selectedCell[2]),d=parseInt(c.selectedCell[3])),s==0){for(let h=0;h<d;h++)if(c.records[h][u].element.style.display!="none"&&c.rows[h].element.style.display!="none"){d=h;break}}else d=upGet.call(c,u,d);a==0?(c.selectedCell[0]=u,c.selectedCell[1]=d):(c.selectedCell[2]=u,c.selectedCell[3]=d)},up=function(a,s){const c=this;if(a?c.selectedCell[3]>0&&upVisible.call(c,1,s?0:1):(c.selectedCell[1]>0&&upVisible.call(c,0,s?0:1),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),c.options.lazyLoading==1)if(c.selectedCell[1]==0||c.selectedCell[3]==0)lazyLoading.wu.call(c,0),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]);else if(lazyLoading.AG.call(c))c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]);else{const u=parseInt(c.tbody.firstChild.getAttribute("data-y"));c.selectedCell[1]-u<30&&(lazyLoading.G_.call(c),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]))}else if(c.options.pagination>0){const u=c.whichPage(c.selectedCell[3]);u!=c.pageNumber&&c.page(u)}internal.Rs.call(c,1)},rightGet=function(a,s){const c=this;a=parseInt(a),s=parseInt(s);for(let u=a+1;u<c.headers.length;u++)if(c.records[s][u].element.style.display!="none"){if(c.records[s][u].element.getAttribute("data-merged")&&c.records[s][u].element==c.records[s][a].element)continue;a=u;break}return a},rightVisible=function(a,s){const c=this;let u,d;if(a==0?(u=parseInt(c.selectedCell[0]),d=parseInt(c.selectedCell[1])):(u=parseInt(c.selectedCell[2]),d=parseInt(c.selectedCell[3])),s==0){for(let h=c.headers.length-1;h>u;h--)if(c.records[d][h].element.style.display!="none"){u=h;break}}else u=rightGet.call(c,u,d);a==0?(c.selectedCell[0]=u,c.selectedCell[1]=d):(c.selectedCell[2]=u,c.selectedCell[3]=d)},right=function(a,s){const c=this;a?c.selectedCell[2]<c.headers.length-1&&rightVisible.call(c,1,s?0:1):(c.selectedCell[0]<c.headers.length-1&&rightVisible.call(c,0,s?0:1),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),internal.Rs.call(c,2)},downGet=function(a,s){const c=this;a=parseInt(a);for(let u=(s=parseInt(s))+1;u<c.rows.length;u++)if(c.records[u][a].element.style.display!="none"&&c.rows[u].element.style.display!="none"){if(c.records[u][a].element.getAttribute("data-merged")&&c.records[u][a].element==c.records[s][a].element)continue;s=u;break}return s},downVisible=function(a,s){const c=this;let u,d;if(a==0?(u=parseInt(c.selectedCell[0]),d=parseInt(c.selectedCell[1])):(u=parseInt(c.selectedCell[2]),d=parseInt(c.selectedCell[3])),s==0){for(let h=c.rows.length-1;h>d;h--)if(c.records[h][u].element.style.display!="none"&&c.rows[h].element.style.display!="none"){d=h;break}}else d=downGet.call(c,u,d);a==0?(c.selectedCell[0]=u,c.selectedCell[1]=d):(c.selectedCell[2]=u,c.selectedCell[3]=d)},down=function(a,s){const c=this;if(a?c.selectedCell[3]<c.records.length-1&&downVisible.call(c,1,s?0:1):(c.selectedCell[1]<c.records.length-1&&downVisible.call(c,0,s?0:1),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),c.options.lazyLoading==1)c.selectedCell[1]==c.records.length-1||c.selectedCell[3]==c.records.length-1?(lazyLoading.wu.call(c,-1),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3])):lazyLoading.AG.call(c)?c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]):parseInt(c.tbody.lastChild.getAttribute("data-y"))-c.selectedCell[3]<30&&(lazyLoading.p6.call(c),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]));else if(c.options.pagination>0){const u=c.whichPage(c.selectedCell[3]);u!=c.pageNumber&&c.page(u)}internal.Rs.call(c,3)},leftGet=function(a,s){const c=this;a=parseInt(a),s=parseInt(s);for(let u=a-1;u>=0;u--)if(c.records[s][u].element.style.display!="none"){if(c.records[s][u].element.getAttribute("data-merged")&&c.records[s][u].element==c.records[s][a].element)continue;a=u;break}return a},leftVisible=function(a,s){const c=this;let u,d;if(a==0?(u=parseInt(c.selectedCell[0]),d=parseInt(c.selectedCell[1])):(u=parseInt(c.selectedCell[2]),d=parseInt(c.selectedCell[3])),s==0){for(let h=0;h<u;h++)if(c.records[d][h].element.style.display!="none"){u=h;break}}else u=leftGet.call(c,u,d);a==0?(c.selectedCell[0]=u,c.selectedCell[1]=d):(c.selectedCell[2]=u,c.selectedCell[3]=d)},left=function(a,s){const c=this;a?c.selectedCell[2]>0&&leftVisible.call(c,1,s?0:1):(c.selectedCell[0]>0&&leftVisible.call(c,0,s?0:1),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),internal.Rs.call(c,0)},first=function(a,s){const c=this;if(a?s?c.selectedCell[3]=0:leftVisible.call(c,1,0):(s?c.selectedCell[1]=0:leftVisible.call(c,0,0),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),c.options.lazyLoading!=1||c.selectedCell[1]!=0&&c.selectedCell[3]!=0){if(c.options.pagination>0){const u=c.whichPage(c.selectedCell[3]);u!=c.pageNumber&&c.page(u)}}else lazyLoading.wu.call(c,0);c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),internal.Rs.call(c,1)},last=function(a,s){const c=this;if(a?s?c.selectedCell[3]=c.records.length-1:rightVisible.call(c,1,0):(s?c.selectedCell[1]=c.records.length-1:rightVisible.call(c,0,0),c.selectedCell[2]=c.selectedCell[0],c.selectedCell[3]=c.selectedCell[1]),c.options.lazyLoading!=1||c.selectedCell[1]!=c.records.length-1&&c.selectedCell[3]!=c.records.length-1){if(c.options.pagination>0){const u=c.whichPage(c.selectedCell[3]);u!=c.pageNumber&&c.page(u)}}else lazyLoading.wu.call(c,-1);c.updateSelectionFromCoords(c.selectedCell[0],c.selectedCell[1],c.selectedCell[2],c.selectedCell[3]),internal.Rs.call(c,3)};var merges=__webpack_require__(910),selection=__webpack_require__(657),helpers=__webpack_require__(978),internalHelpers=__webpack_require__(689);const copy=function(a,s,c,u,d,h,f){const g=this;s||(s="	");const m=new RegExp(s,"ig"),p=[];let v=[],w=[];const E=[],C=[],b=g.options.data[0].length,P=g.options.data.length;let R="",T=!1,I="",M="",N=0,H=0,L=0;for(let W=0;W<P;W++)for(let G=0;G<b;G++)a&&!g.records[W][G].element.classList.contains("highlight")||L<=W&&(L=W);if(d&&(g.parent.config.includeHeadersOnDownload==1||u)){if(g.options.nestedHeaders&&g.options.nestedHeaders.length>0){R=g.options.nestedHeaders;for(let W=0;W<R.length;W++){const G=[];for(let oe=0;oe<R[W].length;oe++){const ae=parseInt(R[W][oe].colspan);G.push(R[W][oe].title);for(let X=0;X<ae-1;X++)G.push("")}M+=G.join(s)+`\r
`}}T=!0}g.style=[];for(let W=0;W<P;W++){v=[],w=[];for(let G=0;G<b;G++)if(!a||g.records[W][G].element.classList.contains("highlight")){T==1&&p.push(g.headers[G].textContent);let oe,ae=g.options.data[W][G];ae.match&&(ae.match(m)||ae.match(/,/g)||ae.match(/\n/)||ae.match(/\"/))&&(ae=ae.replace(new RegExp('"',"g"),'""'),ae='"'+ae+'"'),v.push(ae),g.options.columns&&g.options.columns[G]&&(g.options.columns[G].type=="checkbox"||g.options.columns[G].type=="radio")?oe=ae:(oe=g.records[W][G].element.innerHTML,oe.match&&(oe.match(m)||oe.match(/,/g)||oe.match(/\n/)||oe.match(/\"/))&&(oe=oe.replace(new RegExp('"',"g"),'""'),oe='"'+oe+'"')),w.push(oe),R=g.records[W][G].element.getAttribute("style"),R=R.replace("display: none;",""),g.style.push(R||"")}v.length&&(T&&(N=v.length,E.push(p.join(s))),E.push(v.join(s))),w.length&&(H++,T&&(C.push(p.join(s)),T=!1),C.push(w.join(s)))}b==N&&P==H&&(I=M);const A=I+E.join(`\r
`);let k=I+C.join(`\r
`);if(!c){const W=[Math.min(g.selectedCell[0],g.selectedCell[2]),Math.min(g.selectedCell[1],g.selectedCell[3]),Math.max(g.selectedCell[0],g.selectedCell[2]),Math.max(g.selectedCell[1],g.selectedCell[3])],G=dispatch.A.call(g,"oncopy",g,W,k,h);if(G)k=G;else if(G===!1)return!1;g.textarea.value=k,g.textarea.select(),document.execCommand("copy")}if(g.data=f==1?k:A,g.hashString=selection.tW.call(g,g.data),!c&&(selection.kA.call(g),g.highlighted))for(let W=0;W<g.highlighted.length;W++)g.highlighted[W].element.classList.add("copying"),g.highlighted[W].element.classList.contains("highlight-left")&&g.highlighted[W].element.classList.add("copying-left"),g.highlighted[W].element.classList.contains("highlight-right")&&g.highlighted[W].element.classList.add("copying-right"),g.highlighted[W].element.classList.contains("highlight-top")&&g.highlighted[W].element.classList.add("copying-top"),g.highlighted[W].element.classList.contains("highlight-bottom")&&g.highlighted[W].element.classList.add("copying-bottom");return g.data},paste=function(a,s,c){const u=this,d=(0,selection.tW)(c);let h=d==u.hashString?u.style:null;d==u.hashString&&(c=u.data),c=(0,helpers.parseCSV)(c,"	");const f=u.selectedCell[2]-a+1,g=u.selectedCell[3]-s+1,m=c[0].length;if(f>1&Number.isInteger(f/m)){const w=f/m;if(h){const C=[];for(let b=0;b<h.length;b+=m){const P=h.slice(b,b+m);for(let R=0;R<w;R++)C.push(...P)}h=C}c=c.map((function(C,b){return Array.apply(null,{length:w*C.length}).map((function(R,T){return C[T%C.length]}))}))}const p=c.length;if(g>1&Number.isInteger(g/p)){const w=g/p;if(h){const C=[];for(let b=0;b<w;b++)C.push(...h);h=C}c=Array.apply(null,{length:w*p}).map((function(C,b){return c[b%p]}))}const v=dispatch.A.call(u,"onbeforepaste",u,c.map((function(w){return w.map((function(E){return{value:E}}))})),a,s);if(v===!1)return!1;if(v&&(c=v),a!=null&&s!=null&&c){let w=0,E=0;const C=[],b={},P={};let R=0,T=parseInt(a),I=parseInt(s),M=null;const N=u.headers.slice(T).filter((ae=>ae.style.display==="none")).length,H=T+N+c[0].length,L=u.headers.length;H>L&&(u.skipUpdateTableReferences=!0,u.insertColumn(H-L));const A=u.rows.slice(I).filter((ae=>ae.element.style.display==="none")).length,k=I+A+c.length,W=u.rows.length;for(k>W&&(u.skipUpdateTableReferences=!0,u.insertRow(k-W)),u.skipUpdateTableReferences&&(u.skipUpdateTableReferences=!1,internal.o8.call(u));M=c[E];){for(w=0,T=parseInt(a);M[w]!=null;){let ae=M[w];u.options.columns&&u.options.columns[w]&&u.options.columns[w].type=="calendar"&&(ae=jSuites.calendar.extractDateFromString(ae,u.options.columns[w].options&&u.options.columns[w].options.format||"YYYY-MM-DD"));const X=internal.k9.call(u,T,I,ae);if(C.push(X),internal.xF.call(u,T,I,C),h&&h[R]){const le=(0,internalHelpers.t3)([T,I]);b[le]=h[R],P[le]=u.getStyle(le),u.records[I][T].element.setAttribute("style",h[R]),R++}if(w++,M[w]!=null){if(T>=u.headers.length-1){if(u.options.allowInsertColumn==0)break;u.insertColumn()}T=rightGet.call(u,T,I)}}if(E++,c[E]){if(I>=u.rows.length-1){if(u.options.allowInsertRow==0)break;u.insertRow()}I=downGet.call(u,a,I)}}selection.AH.call(u,a,s,T,I),utils_history.Dh.call(u,{action:"setValue",records:C,selection:u.selectedCell,newStyle:b,oldStyle:P}),internal.am.call(u);const G=[];for(let ae=0;ae<c.length;ae++)for(let X=0;X<c[ae].length;X++)G.push({x:X+a,y:ae+s,value:c[ae][X]});dispatch.A.call(u,"onpaste",u,G);const oe=C.map((function(ae){return{x:ae.x,y:ae.y,value:ae.value,oldValue:ae.oldValue}}));dispatch.A.call(u,"onafterchanges",u,oe)}(0,selection.kA)()};var filter=__webpack_require__(829),footer=__webpack_require__(160);const getNumberOfColumns=function(){const a=this;let s=a.options.columns&&a.options.columns.length||0;if(a.options.data&&a.options.data[0]!==void 0){const c=Object.keys(a.options.data[0]);c.length>s&&(s=c.length)}return a.options.minDimensions&&a.options.minDimensions[0]>s&&(s=a.options.minDimensions[0]),s},createCellHeader=function(a){const s=this,c=s.options.columns&&s.options.columns[a]&&s.options.columns[a].width||s.options.defaultColWidth||100,u=s.options.columns&&s.options.columns[a]&&s.options.columns[a].align||s.options.defaultColAlign||"center";s.headers[a]=document.createElement("td"),s.headers[a].textContent=s.options.columns&&s.options.columns[a]&&s.options.columns[a].title||(0,helpers.getColumnName)(a),s.headers[a].setAttribute("data-x",a),s.headers[a].style.textAlign=u,s.options.columns&&s.options.columns[a]&&s.options.columns[a].title&&s.headers[a].setAttribute("title",s.headers[a].innerText),s.options.columns&&s.options.columns[a]&&s.options.columns[a].id&&s.headers[a].setAttribute("id",s.options.columns[a].id);const d=document.createElement("col");d.setAttribute("width",c),s.cols[a]={colElement:d,x:a},s.options.columns&&s.options.columns[a]&&s.options.columns[a].type=="hidden"&&(s.headers[a].style.display="none",d.style.display="none")},insertColumn=function(a,s,c,u){const d=this;if(d.options.allowInsertColumn!=0){let h,f=[];Array.isArray(a)?(h=1,a&&(f=a)):h=typeof a=="number"?a:1,c=!!c;const g=Math.max(d.options.columns.length,...d.options.data.map((function(T){return T.length})))-1;(s==null||s>=parseInt(g)||s<0)&&(s=g),u||(u=[]);for(let T=0;T<h;T++)u[T]||(u[T]={});const m=[];if(Array.isArray(a)){const T=[];for(let M=0;M<d.options.data.length;M++)T.push(M<a.length?a[M]:"");const I={column:s+(c?0:1),options:Object.assign({},u[0]),data:T};m.push(I)}else for(let T=0;T<a;T++){const I={column:s+T+(c?0:1),options:Object.assign({},u[T])};m.push(I)}if(dispatch.A.call(d,"onbeforeinsertcolumn",d,m)===!1)return!1;if(d.options.mergeCells&&Object.keys(d.options.mergeCells).length>0&&merges.Lt.call(d,s,c).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;d.destroyMerge()}const p=c?s:s+1;d.options.columns=(0,internalHelpers.Hh)(d.options.columns,p,u);const v=d.headers.splice(p),w=d.cols.splice(p),E=[],C=[],b=[],P=[],R=[];for(let T=p;T<h+p;T++)createCellHeader.call(d,T),d.headerContainer.insertBefore(d.headers[T],d.headerContainer.children[T+1]),d.colgroupContainer.insertBefore(d.cols[T].colElement,d.colgroupContainer.children[T+1]),E.push(d.headers[T]),C.push(d.cols[T]);if(d.options.footers)for(let T=0;T<d.options.footers.length;T++){R[T]=[];for(let I=0;I<h;I++)R[T].push("");d.options.footers[T].splice(p,0,R[T])}for(let T=0;T<d.options.data.length;T++){const I=d.options.data[T].splice(p),M=d.records[T].splice(p);P[T]=[],b[T]=[];for(let N=p;N<h+p;N++){const H=f[T]?f[T]:"";d.options.data[T][N]=H;const L=internal.P9.call(d,N,T,d.options.data[T][N]);d.records[T][N]={element:L,y:T},d.rows[T]&&d.rows[T].element.insertBefore(L,d.rows[T].element.children[N+1]),d.options.columns&&d.options.columns[N]&&typeof d.options.columns[N].render=="function"&&d.options.columns[N].render(L,H,parseInt(N),parseInt(T),d,d.options.columns[N]),P[T].push(H),b[T].push({element:L,x:N,y:T})}Array.prototype.push.apply(d.options.data[T],I),Array.prototype.push.apply(d.records[T],M)}Array.prototype.push.apply(d.headers,v),Array.prototype.push.apply(d.cols,w);for(let T=p;T<d.cols.length;T++)d.cols[T].x=T;for(let T=0;T<d.records.length;T++)for(let I=0;I<d.records[T].length;I++)d.records[T][I].x=I;if(d.options.nestedHeaders&&d.options.nestedHeaders.length>0&&d.options.nestedHeaders[0]&&d.options.nestedHeaders[0][0])for(let T=0;T<d.options.nestedHeaders.length;T++){const I=parseInt(d.options.nestedHeaders[T][d.options.nestedHeaders[T].length-1].colspan)+h;d.options.nestedHeaders[T][d.options.nestedHeaders[T].length-1].colspan=I,d.thead.children[T].children[d.thead.children[T].children.length-1].setAttribute("colspan",I);let M=d.thead.children[T].children[d.thead.children[T].children.length-1].getAttribute("data-column");M=M.split(",");for(let N=p;N<h+p;N++)M.push(N);d.thead.children[T].children[d.thead.children[T].children.length-1].setAttribute("data-column",M)}utils_history.Dh.call(d,{action:"insertColumn",columnNumber:s,numOfColumns:h,insertBefore:c,columns:u,headers:E,cols:C,records:b,footers:R,data:P}),internal.o8.call(d),dispatch.A.call(d,"oninsertcolumn",d,m)}},moveColumn=function(a,s){const c=this;if(c.options.mergeCells&&Object.keys(c.options.mergeCells).length>0){let h;if(h=a>s?1:0,merges.Lt.call(c,a).length||merges.Lt.call(c,s,h).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;c.destroyMerge()}}if((a=parseInt(a))>(s=parseInt(s))){c.headerContainer.insertBefore(c.headers[a],c.headers[s]),c.colgroupContainer.insertBefore(c.cols[a].colElement,c.cols[s].colElement);for(let h=0;h<c.rows.length;h++)c.rows[h].element.insertBefore(c.records[h][a].element,c.records[h][s].element)}else{c.headerContainer.insertBefore(c.headers[a],c.headers[s].nextSibling),c.colgroupContainer.insertBefore(c.cols[a].colElement,c.cols[s].colElement.nextSibling);for(let h=0;h<c.rows.length;h++)c.rows[h].element.insertBefore(c.records[h][a].element,c.records[h][s].element.nextSibling)}c.options.columns.splice(s,0,c.options.columns.splice(a,1)[0]),c.headers.splice(s,0,c.headers.splice(a,1)[0]),c.cols.splice(s,0,c.cols.splice(a,1)[0]);const u=Math.min(a,s),d=Math.max(a,s);for(let h=0;h<c.rows.length;h++)c.options.data[h].splice(s,0,c.options.data[h].splice(a,1)[0]),c.records[h].splice(s,0,c.records[h].splice(a,1)[0]);for(let h=u;h<=d;h++)c.cols[h].x=h;for(let h=0;h<c.records.length;h++)for(let f=u;f<=d;f++)c.records[h][f].x=f;if(c.options.footers)for(let h=0;h<c.options.footers.length;h++)c.options.footers[h].splice(s,0,c.options.footers[h].splice(a,1)[0]);utils_history.Dh.call(c,{action:"moveColumn",oldValue:a,newValue:s}),internal.o8.call(c),dispatch.A.call(c,"onmovecolumn",c,a,s,1)},deleteColumn=function(a,s){const c=this;if(c.options.allowDeleteColumn!=0)if(c.headers.length>1){if(a==null){const h=c.getSelectedColumns(!0);h.length?(a=parseInt(h[0]),s=parseInt(h.length)):(a=c.headers.length-1,s=1)}const u=c.options.data[0].length-1;(a==null||a>u||a<0)&&(a=u),s||(s=1),s>c.options.data[0].length-a&&(s=c.options.data[0].length-a);const d=[];for(let h=0;h<s;h++)d.push(h+a);if(dispatch.A.call(c,"onbeforedeletecolumn",c,d)===!1)return!1;if(parseInt(a)>-1){let h=!1;if(c.options.mergeCells&&Object.keys(c.options.mergeCells).length>0)for(let E=a;E<a+s;E++)merges.Lt.call(c,E,null).length&&(h=!0);if(h){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;c.destroyMerge()}const f=c.options.columns?c.options.columns.splice(a,s):void 0;for(let E=a;E<a+s;E++)c.cols[E].colElement.className="",c.headers[E].className="",c.cols[E].colElement.parentNode.removeChild(c.cols[E].colElement),c.headers[E].parentNode.removeChild(c.headers[E]);const g=c.headers.splice(a,s),m=c.cols.splice(a,s),p=[],v=[],w=[];for(let E=0;E<c.options.data.length;E++)for(let C=a;C<a+s;C++)c.records[E][C].element.className="",c.records[E][C].element.parentNode.removeChild(c.records[E][C].element);for(let E=0;E<c.options.data.length;E++)v[E]=c.options.data[E].splice(a,s),p[E]=c.records[E].splice(a,s);for(let E=a;E<c.cols.length;E++)c.cols[E].x=E;for(let E=0;E<c.records.length;E++)for(let C=a;C<c.records[E].length;C++)c.records[E][C].x=C;if(c.options.footers)for(let E=0;E<c.options.footers.length;E++)w[E]=c.options.footers[E].splice(a,s);if(selection.at.call(c,0,a,a+s-1),c.options.nestedHeaders&&c.options.nestedHeaders.length>0&&c.options.nestedHeaders[0]&&c.options.nestedHeaders[0][0])for(let E=0;E<c.options.nestedHeaders.length;E++){const C=parseInt(c.options.nestedHeaders[E][c.options.nestedHeaders[E].length-1].colspan)-s;c.options.nestedHeaders[E][c.options.nestedHeaders[E].length-1].colspan=C,c.thead.children[E].children[c.thead.children[E].children.length-1].setAttribute("colspan",C)}utils_history.Dh.call(c,{action:"deleteColumn",columnNumber:a,numOfColumns:s,insertBefore:1,columns:f,headers:g,cols:m,records:p,footers:w,data:v}),internal.o8.call(c),dispatch.A.call(c,"ondeletecolumn",c,d)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},getWidth=function(a){const s=this;let c;if(a===void 0){c=[];for(let u=0;u<s.headers.length;u++)c.push(s.options.columns&&s.options.columns[u]&&s.options.columns[u].width||s.options.defaultColWidth||100)}else c=parseInt(s.cols[a].colElement.getAttribute("width"));return c},setWidth=function(a,s,c){const u=this;if(s){if(Array.isArray(a)){c||(c=[]);for(let d=0;d<a.length;d++){c[d]||(c[d]=parseInt(u.cols[a[d]].colElement.getAttribute("width")));const h=Array.isArray(s)&&s[d]?s[d]:s;u.cols[a[d]].colElement.setAttribute("width",h),u.options.columns||(u.options.columns=[]),u.options.columns[a[d]]||(u.options.columns[a[d]]={}),u.options.columns[a[d]].width=h}}else c||(c=parseInt(u.cols[a].colElement.getAttribute("width"))),u.cols[a].colElement.setAttribute("width",s),u.options.columns||(u.options.columns=[]),u.options.columns[a]||(u.options.columns[a]={}),u.options.columns[a].width=s;utils_history.Dh.call(u,{action:"setWidth",column:a,oldValue:c,newValue:s}),dispatch.A.call(u,"onresizecolumn",u,a,s,c),selection.Aq.call(u)}},showColumn=function(a){const s=this;Array.isArray(a)||(a=[a]);for(let c=0;c<a.length;c++){const u=a[c];s.headers[u].style.display="",s.cols[u].colElement.style.display="",s.filter&&s.filter.children.length>u+1&&(s.filter.children[u+1].style.display="");for(let d=0;d<s.options.data.length;d++)s.records[d][u].element.style.display=""}s.options.footers&&footer.e.call(s),s.resetSelection()},hideColumn=function(a){const s=this;Array.isArray(a)||(a=[a]);for(let c=0;c<a.length;c++){const u=a[c];s.headers[u].style.display="none",s.cols[u].colElement.style.display="none",s.filter&&s.filter.children.length>u+1&&(s.filter.children[u+1].style.display="none");for(let d=0;d<s.options.data.length;d++)s.records[d][u].element.style.display="none"}s.options.footers&&footer.e.call(s),s.resetSelection()},getColumnData=function(a,s){const c=this,u=[];for(let d=0;d<c.options.data.length;d++)s?u.push(c.records[d][a].element.innerHTML):u.push(c.options.data[d][a]);return u},setColumnData=function(a,s,c){const u=this;for(let d=0;d<u.rows.length;d++){const h=(0,internalHelpers.t3)([a,d]);s[d]!=null&&u.setValue(h,s[d],c)}},createRow=function(a,s){const c=this;c.records[a]||(c.records[a]=[]),s||(s=c.options.data[a]);const u={element:document.createElement("tr"),y:a};c.rows[a]=u,u.element.setAttribute("data-y",a);let d=null;c.options.defaultRowHeight&&(u.element.style.height=c.options.defaultRowHeight+"px"),c.options.rows&&c.options.rows[a]&&(c.options.rows[a].height&&(u.element.style.height=c.options.rows[a].height),c.options.rows[a].title&&(d=c.options.rows[a].title)),d||(d=parseInt(a+1));const h=document.createElement("td");h.innerHTML=d,h.setAttribute("data-y",a),h.className="jss_row",u.element.appendChild(h);const f=getNumberOfColumns.call(c);for(let g=0;g<f;g++)c.records[a][g]={element:internal.P9.call(this,g,a,s[g]),x:g,y:a},u.element.appendChild(c.records[a][g].element),c.options.columns&&c.options.columns[g]&&typeof c.options.columns[g].render=="function"&&c.options.columns[g].render(c.records[a][g].element,s[g],parseInt(g),parseInt(a),c,c.options.columns[g]);return u},insertRow=function(a,s,c){const u=this;if(u.options.allowInsertRow!=0){let d,h=[];Array.isArray(a)?(d=1,a&&(h=a)):d=a!==void 0?a:1,c=!!c;const f=u.options.data.length-1;(s==null||s>=parseInt(f)||s<0)&&(s=f);const g=[];for(let P=0;P<d;P++){const R=[];for(let T=0;T<u.options.columns.length;T++)R[T]=h[T]?h[T]:"";g.push({row:P+s+(c?0:1),data:R})}if(dispatch.A.call(u,"onbeforeinsertrow",u,g)===!1)return!1;if(u.options.mergeCells&&Object.keys(u.options.mergeCells).length>0&&merges.D0.call(u,s,c).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;u.destroyMerge()}if(u.options.search==1){if(u.results&&u.results.length!=u.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;u.resetSearch()}u.results=null}const m=c?s:s+1,p=u.records.splice(m),v=u.options.data.splice(m),w=u.rows.splice(m),E=[],C=[],b=[];for(let P=m;P<d+m;P++){u.options.data[P]=[];for(let T=0;T<u.options.columns.length;T++)u.options.data[P][T]=h[T]?h[T]:"";const R=createRow.call(u,P,u.options.data[P]);w[0]?Array.prototype.indexOf.call(u.tbody.children,w[0].element)>=0&&u.tbody.insertBefore(R.element,w[0].element):Array.prototype.indexOf.call(u.tbody.children,u.rows[s].element)>=0&&u.tbody.appendChild(R.element),E.push([...u.records[P]]),C.push([...u.options.data[P]]),b.push(R)}Array.prototype.push.apply(u.records,p),Array.prototype.push.apply(u.options.data,v),Array.prototype.push.apply(u.rows,w);for(let P=m;P<u.rows.length;P++)u.rows[P].y=P;for(let P=m;P<u.records.length;P++)for(let R=0;R<u.records[P].length;R++)u.records[P][R].y=P;u.options.pagination>0&&u.page(u.pageNumber),utils_history.Dh.call(u,{action:"insertRow",rowNumber:s,numOfRows:d,insertBefore:c,rowRecords:E,rowData:C,rowNode:b}),internal.o8.call(u),dispatch.A.call(u,"oninsertrow",u,g)}},moveRow=function(a,s,c){const u=this;if(u.options.mergeCells&&Object.keys(u.options.mergeCells).length>0){let f;if(f=a>s?1:0,merges.D0.call(u,a).length||merges.D0.call(u,s,f).length){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;u.destroyMerge()}}if(u.options.search==1){if(u.results&&u.results.length!=u.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;u.resetSearch()}u.results=null}c||(Array.prototype.indexOf.call(u.tbody.children,u.rows[s].element)>=0?a>s?u.tbody.insertBefore(u.rows[a].element,u.rows[s].element):u.tbody.insertBefore(u.rows[a].element,u.rows[s].element.nextSibling):u.tbody.removeChild(u.rows[a].element)),u.rows.splice(s,0,u.rows.splice(a,1)[0]),u.records.splice(s,0,u.records.splice(a,1)[0]),u.options.data.splice(s,0,u.options.data.splice(a,1)[0]);const d=Math.min(a,s),h=Math.max(a,s);for(let f=d;f<=h;f++)u.rows[f].y=f;for(let f=d;f<=h;f++)for(let g=0;g<u.records[f].length;g++)u.records[f][g].y=f;u.options.pagination>0&&u.tbody.children.length!=u.options.pagination&&u.page(u.pageNumber),utils_history.Dh.call(u,{action:"moveRow",oldValue:a,newValue:s}),internal.o8.call(u),dispatch.A.call(u,"onmoverow",u,parseInt(a),parseInt(s),1)},deleteRow=function(a,s){const c=this;if(c.options.allowDeleteRow!=0)if(c.options.allowDeletingAllRows==1||c.options.data.length>1){if(a==null){const h=selection.R5.call(c);h.length===0?(a=c.options.data.length-1,s=1):(a=h[0],s=h.length)}let u=c.options.data.length-1;(a==null||a>u||a<0)&&(a=u),s||(s=1),a+s>=c.options.data.length&&(s=c.options.data.length-a);const d=[];for(let h=0;h<s;h++)d.push(h+a);if(dispatch.A.call(c,"onbeforedeleterow",c,d)===!1)return!1;if(parseInt(a)>-1){let h=!1;if(c.options.mergeCells&&Object.keys(c.options.mergeCells).length>0)for(let p=a;p<a+s;p++)merges.D0.call(c,p,!1).length&&(h=!0);if(h){if(!confirm(jSuites.translate("This action will destroy any existing merged cells. Are you sure?")))return!1;c.destroyMerge()}if(c.options.search==1){if(c.results&&c.results.length!=c.rows.length){if(!confirm(jSuites.translate("This action will clear your search results. Are you sure?")))return!1;c.resetSearch()}c.results=null}c.options.allowDeletingAllRows!=1&&u+1===s&&(s--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(let p=a;p<a+s;p++)Array.prototype.indexOf.call(c.tbody.children,c.rows[p].element)>=0&&(c.rows[p].element.className="",c.rows[p].element.parentNode.removeChild(c.rows[p].element));const f=c.records.splice(a,s),g=c.options.data.splice(a,s),m=c.rows.splice(a,s);for(let p=a;p<c.rows.length;p++)c.rows[p].y=p;for(let p=a;p<c.records.length;p++)for(let v=0;v<c.records[p].length;v++)c.records[p][v].y=p;c.options.pagination>0&&c.tbody.children.length!=c.options.pagination&&c.page(c.pageNumber),selection.at.call(c,1,a,a+s-1),utils_history.Dh.call(c,{action:"deleteRow",rowNumber:a,numOfRows:s,insertBefore:1,rowRecords:f,rowData:g,rowNode:m}),internal.o8.call(c),dispatch.A.call(c,"ondeleterow",c,d)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},getHeight=function(a){const s=this;let c;if(a===void 0){c=[];for(let u=0;u<s.rows.length;u++){const d=s.rows[u].element.style.height;d&&(c[u]=d)}}else typeof a=="object"&&(a=$(a).getAttribute("data-y")),c=s.rows[a].element.style.height;return c},setHeight=function(a,s,c){const u=this;s>0&&(c||(c=u.rows[a].element.getAttribute("height"))||(c=u.rows[a].element.getBoundingClientRect().height),s=parseInt(s),u.rows[a].element.style.height=s+"px",u.options.rows||(u.options.rows=[]),u.options.rows[a]||(u.options.rows[a]={}),u.options.rows[a].height=s,utils_history.Dh.call(u,{action:"setHeight",row:a,oldValue:c,newValue:s}),dispatch.A.call(u,"onresizerow",u,a,s,c),selection.Aq.call(u))},showRow=function(a){const s=this;Array.isArray(a)||(a=[a]),a.forEach((function(c){s.rows[c].element.style.display=""}))},hideRow=function(a){const s=this;Array.isArray(a)||(a=[a]),a.forEach((function(c){s.rows[c].element.style.display="none"}))},getRowData=function(a,s){return s?this.records[a].map((function(c){return c.element.innerHTML})):this.options.data[a]},setRowData=function(a,s,c){const u=this;for(let d=0;d<u.headers.length;d++){const h=(0,internalHelpers.t3)([d,a]);s[d]!=null&&u.setValue(h,s[d],c)}};var version={version:"5.0.0",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[["Jspreadsheet CE",this.version,this.host,this.license].join(`\r
`)]}};const getElement=function(a){let s=0,c=0;return(function u(d){d.className&&(d.classList.contains("jss_container")&&(c=d),d.classList.contains("jss_spreadsheet")&&(c=d.querySelector(":scope > .jtabs-content > .jtabs-selected"))),d.tagName=="THEAD"?s=1:d.tagName=="TBODY"&&(s=2),d.parentNode&&(c||u(d.parentNode))})(a),[c,s]},mouseUpControls=function(a){if(libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.current.resizing){if(libraryBase.jspreadsheet.current.resizing.column){const s=parseInt(libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.getAttribute("width")),c=libraryBase.jspreadsheet.current.getSelectedColumns();if(c.length>1){const u=[];for(let d=0;d<c.length;d++)u.push(parseInt(libraryBase.jspreadsheet.current.cols[c[d]].colElement.getAttribute("width")));u[c.indexOf(parseInt(libraryBase.jspreadsheet.current.resizing.column))]=libraryBase.jspreadsheet.current.resizing.width,setWidth.call(libraryBase.jspreadsheet.current,c,s,u)}else setWidth.call(libraryBase.jspreadsheet.current,parseInt(libraryBase.jspreadsheet.current.resizing.column),s,libraryBase.jspreadsheet.current.resizing.width);libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.resizing.column].classList.remove("resizing");for(let u=0;u<libraryBase.jspreadsheet.current.records.length;u++)libraryBase.jspreadsheet.current.records[u][libraryBase.jspreadsheet.current.resizing.column]&&libraryBase.jspreadsheet.current.records[u][libraryBase.jspreadsheet.current.resizing.column].element.classList.remove("resizing")}else{libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.children[0].classList.remove("resizing");let s=libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.getAttribute("height");setHeight.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.resizing.row,s,libraryBase.jspreadsheet.current.resizing.height),libraryBase.jspreadsheet.current.resizing.element.classList.remove("resizing")}libraryBase.jspreadsheet.current.resizing=null}else if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging){if(libraryBase.jspreadsheet.current.dragging.column){const s=a.target.getAttribute("data-x");libraryBase.jspreadsheet.current.headers[libraryBase.jspreadsheet.current.dragging.column].classList.remove("dragging");for(let c=0;c<libraryBase.jspreadsheet.current.rows.length;c++)libraryBase.jspreadsheet.current.records[c][libraryBase.jspreadsheet.current.dragging.column]&&libraryBase.jspreadsheet.current.records[c][libraryBase.jspreadsheet.current.dragging.column].element.classList.remove("dragging");for(let c=0;c<libraryBase.jspreadsheet.current.headers.length;c++)libraryBase.jspreadsheet.current.headers[c].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[c].classList.remove("dragging-right");s&&libraryBase.jspreadsheet.current.dragging.column!=libraryBase.jspreadsheet.current.dragging.destination&&libraryBase.jspreadsheet.current.moveColumn(libraryBase.jspreadsheet.current.dragging.column,libraryBase.jspreadsheet.current.dragging.destination)}else{let s;libraryBase.jspreadsheet.current.dragging.element.nextSibling?(s=parseInt(libraryBase.jspreadsheet.current.dragging.element.nextSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row<s&&(s-=1)):s=parseInt(libraryBase.jspreadsheet.current.dragging.element.previousSibling.getAttribute("data-y")),libraryBase.jspreadsheet.current.dragging.row!=libraryBase.jspreadsheet.current.dragging.destination&&moveRow.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.dragging.row,s,!0),libraryBase.jspreadsheet.current.dragging.element.classList.remove("dragging")}libraryBase.jspreadsheet.current.dragging=null}}else libraryBase.jspreadsheet.current.selectedCorner&&(libraryBase.jspreadsheet.current.selectedCorner=!1,libraryBase.jspreadsheet.current.selection.length>0&&(selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selection[0],libraryBase.jspreadsheet.current.selection[libraryBase.jspreadsheet.current.selection.length-1]),selection.gG.call(libraryBase.jspreadsheet.current)));libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null),libraryBase.jspreadsheet.isMouseAction=!1},mouseDownControls=function(a){let s;s=(a=a||window.event).buttons?a.buttons:a.button?a.button:a.which;const c=getElement(a.target);if(c[0]?libraryBase.jspreadsheet.current!=c[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),libraryBase.jspreadsheet.current.resetSelection()),libraryBase.jspreadsheet.current=c[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0),a.target.classList.contains("jss_object")||(selection.gE.call(libraryBase.jspreadsheet.current,!0),libraryBase.jspreadsheet.current=null)),libraryBase.jspreadsheet.current&&s==1){if(a.target.classList.contains("jss_selectall"))libraryBase.jspreadsheet.current&&selection.Ub.call(libraryBase.jspreadsheet.current);else if(a.target.classList.contains("jss_corner"))libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedCorner=!0);else{if(c[1]==1){const u=a.target.getAttribute("data-x");if(u){const d=a.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.columnResize!=0&&d.width-a.offsetX<6){libraryBase.jspreadsheet.current.resizing={mousePosition:a.pageX,column:u,width:d.width},libraryBase.jspreadsheet.current.headers[u].classList.add("resizing");for(let h=0;h<libraryBase.jspreadsheet.current.records.length;h++)libraryBase.jspreadsheet.current.records[h][u]&&libraryBase.jspreadsheet.current.records[h][u].element.classList.add("resizing")}else if(libraryBase.jspreadsheet.current.options.columnDrag!=0&&d.height-a.offsetY<6)if(merges.Lt.call(libraryBase.jspreadsheet.current,u).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:a.target,column:u,destination:u},libraryBase.jspreadsheet.current.headers[u].classList.add("dragging");for(let h=0;h<libraryBase.jspreadsheet.current.records.length;h++)libraryBase.jspreadsheet.current.records[h][u]&&libraryBase.jspreadsheet.current.records[h][u].element.classList.add("dragging")}else{let h,f;libraryBase.jspreadsheet.current.selectedHeader&&(a.shiftKey||a.ctrlKey)?(h=libraryBase.jspreadsheet.current.selectedHeader,f=u):(libraryBase.jspreadsheet.current.selectedHeader==u&&libraryBase.jspreadsheet.current.options.allowRenameColumn!=0&&(libraryBase.jspreadsheet.timeControl=setTimeout((function(){libraryBase.jspreadsheet.current.setHeader(u)}),800)),libraryBase.jspreadsheet.current.selectedHeader=u,h=u,f=u),selection.AH.call(libraryBase.jspreadsheet.current,h,0,f,libraryBase.jspreadsheet.current.options.data.length-1,a)}}else if(a.target.parentNode.classList.contains("jss_nested")){let d,h;if(a.target.getAttribute("data-column")){const f=a.target.getAttribute("data-column").split(",");d=parseInt(f[0]),h=parseInt(f[f.length-1])}else d=0,h=libraryBase.jspreadsheet.current.options.columns.length-1;selection.AH.call(libraryBase.jspreadsheet.current,d,0,h,libraryBase.jspreadsheet.current.options.data.length-1,a)}}else libraryBase.jspreadsheet.current.selectedHeader=!1;if(c[1]==2){const u=parseInt(a.target.getAttribute("data-y"));if(a.target.classList.contains("jss_row")){const d=a.target.getBoundingClientRect();if(libraryBase.jspreadsheet.current.options.rowResize!=0&&d.height-a.offsetY<6)libraryBase.jspreadsheet.current.resizing={element:a.target.parentNode,mousePosition:a.pageY,row:u,height:d.height},a.target.parentNode.classList.add("resizing");else if(libraryBase.jspreadsheet.current.options.rowDrag!=0&&d.width-a.offsetX<6)merges.D0.call(libraryBase.jspreadsheet.current,u).length?console.error("Jspreadsheet: This row is part of a merged cell"):libraryBase.jspreadsheet.current.options.search==1&&libraryBase.jspreadsheet.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current.dragging={element:a.target.parentNode,row:u,destination:u},a.target.parentNode.classList.add("dragging"));else{let h,f;libraryBase.jspreadsheet.current.selectedRow!=null&&(a.shiftKey||a.ctrlKey)?(h=libraryBase.jspreadsheet.current.selectedRow,f=u):(libraryBase.jspreadsheet.current.selectedRow=u,h=u,f=u),selection.AH.call(libraryBase.jspreadsheet.current,null,h,null,f,a)}}else if(a.target.classList.contains("jclose")&&a.target.clientWidth-a.offsetX<50&&a.offsetY<50)closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else{const d=function(f){const g=f.getAttribute("data-x"),m=f.getAttribute("data-y");return g&&m?[g,m]:f.parentNode?d(f.parentNode):void 0},h=d(a.target);if(h){const f=h[0],g=h[1];libraryBase.jspreadsheet.current.edition&&(libraryBase.jspreadsheet.current.edition[2]==f&&libraryBase.jspreadsheet.current.edition[3]==g||closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0)),libraryBase.jspreadsheet.current.edition||(a.shiftKey?selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],f,g,a):selection.AH.call(libraryBase.jspreadsheet.current,f,g,void 0,void 0,a)),libraryBase.jspreadsheet.current.selectedHeader=null,libraryBase.jspreadsheet.current.selectedRow=null}}}else libraryBase.jspreadsheet.current.selectedRow=!1;a.target.classList.contains("jss_page")&&(a.target.textContent=="<"?libraryBase.jspreadsheet.current.page(0):a.target.textContent==">"?libraryBase.jspreadsheet.current.page(a.target.getAttribute("title")-1):libraryBase.jspreadsheet.current.page(a.target.textContent-1))}libraryBase.jspreadsheet.current.edition?libraryBase.jspreadsheet.isMouseAction=!1:libraryBase.jspreadsheet.isMouseAction=!0}else libraryBase.jspreadsheet.isMouseAction=!1},mouseMoveControls=function(a){let s;if(s=(a=a||window.event).buttons?a.buttons:a.button?a.button:a.which,s||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current)if(libraryBase.jspreadsheet.isMouseAction==1){if(libraryBase.jspreadsheet.current.resizing)if(libraryBase.jspreadsheet.current.resizing.column){const c=a.pageX-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.width+c>0){const u=libraryBase.jspreadsheet.current.resizing.width+c;libraryBase.jspreadsheet.current.cols[libraryBase.jspreadsheet.current.resizing.column].colElement.setAttribute("width",u),selection.Aq.call(libraryBase.jspreadsheet.current)}}else{const c=a.pageY-libraryBase.jspreadsheet.current.resizing.mousePosition;if(libraryBase.jspreadsheet.current.resizing.height+c>0){const u=libraryBase.jspreadsheet.current.resizing.height+c;libraryBase.jspreadsheet.current.rows[libraryBase.jspreadsheet.current.resizing.row].element.setAttribute("height",u),selection.Aq.call(libraryBase.jspreadsheet.current)}}else if(libraryBase.jspreadsheet.current.dragging)if(libraryBase.jspreadsheet.current.dragging.column){const c=a.target.getAttribute("data-x");if(c)if(merges.Lt.call(libraryBase.jspreadsheet.current,c).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(let u=0;u<libraryBase.jspreadsheet.current.headers.length;u++)libraryBase.jspreadsheet.current.headers[u].classList.remove("dragging-left"),libraryBase.jspreadsheet.current.headers[u].classList.remove("dragging-right");libraryBase.jspreadsheet.current.dragging.column==c?libraryBase.jspreadsheet.current.dragging.destination=parseInt(c):a.target.clientWidth/2>a.offsetX?(libraryBase.jspreadsheet.current.dragging.column<c?libraryBase.jspreadsheet.current.dragging.destination=parseInt(c)-1:libraryBase.jspreadsheet.current.dragging.destination=parseInt(c),libraryBase.jspreadsheet.current.headers[c].classList.add("dragging-left")):(libraryBase.jspreadsheet.current.dragging.column<c?libraryBase.jspreadsheet.current.dragging.destination=parseInt(c):libraryBase.jspreadsheet.current.dragging.destination=parseInt(c)+1,libraryBase.jspreadsheet.current.headers[c].classList.add("dragging-right"))}}else{const c=a.target.getAttribute("data-y");if(c)if(merges.D0.call(libraryBase.jspreadsheet.current,c).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{const u=a.target.clientHeight/2>a.offsetY?a.target.parentNode.nextSibling:a.target.parentNode;libraryBase.jspreadsheet.current.dragging.element!=u&&(a.target.parentNode.parentNode.insertBefore(libraryBase.jspreadsheet.current.dragging.element,u),libraryBase.jspreadsheet.current.dragging.destination=Array.prototype.indexOf.call(libraryBase.jspreadsheet.current.dragging.element.parentNode.children,libraryBase.jspreadsheet.current.dragging.element))}}}else{const c=a.target.getAttribute("data-x"),u=a.target.getAttribute("data-y"),d=a.target.getBoundingClientRect();libraryBase.jspreadsheet.current.cursor&&(libraryBase.jspreadsheet.current.cursor.style.cursor="",libraryBase.jspreadsheet.current.cursor=null),a.target.parentNode.parentNode&&a.target.parentNode.parentNode.className&&(a.target.parentNode.parentNode.classList.contains("resizable")&&(a.target&&c&&!u&&d.width-(a.clientX-d.left)<6?(libraryBase.jspreadsheet.current.cursor=a.target,libraryBase.jspreadsheet.current.cursor.style.cursor="col-resize"):a.target&&!c&&u&&d.height-(a.clientY-d.top)<6&&(libraryBase.jspreadsheet.current.cursor=a.target,libraryBase.jspreadsheet.current.cursor.style.cursor="row-resize")),a.target.parentNode.parentNode.classList.contains("draggable")&&(a.target&&!c&&u&&d.width-(a.clientX-d.left)<6||a.target&&c&&!u&&d.height-(a.clientY-d.top)<6)&&(libraryBase.jspreadsheet.current.cursor=a.target,libraryBase.jspreadsheet.current.cursor.style.cursor="move"))}},updateCopySelection=function(a,s){const c=this;selection.gG.call(c);const u=c.selectedContainer[0],d=c.selectedContainer[1],h=c.selectedContainer[2],f=c.selectedContainer[3];if(a!=null&&s!=null){let g,m,p,v;a-h>0?(g=parseInt(h)+1,m=parseInt(a)):(g=parseInt(a),m=parseInt(u)-1),s-f>0?(p=parseInt(f)+1,v=parseInt(s)):(p=parseInt(s),v=parseInt(d)-1),m-g<=v-p?(g=parseInt(u),m=parseInt(h)):(p=parseInt(d),v=parseInt(f));for(let w=p;w<=v;w++)for(let E=g;E<=m;E++)c.records[w][E]&&c.rows[w].element.style.display!="none"&&c.records[w][E].element.style.display!="none"&&(c.records[w][E].element.classList.add("selection"),c.records[p][E].element.classList.add("selection-top"),c.records[v][E].element.classList.add("selection-bottom"),c.records[w][g].element.classList.add("selection-left"),c.records[w][m].element.classList.add("selection-right"),c.selection.push(c.records[w][E].element))}},mouseOverControls=function(a){let s;if(s=(a=a||window.event).buttons?a.buttons:a.button?a.button:a.which,s||(libraryBase.jspreadsheet.isMouseAction=!1),libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.isMouseAction==1){const c=getElement(a.target);if(c[0]){if(libraryBase.jspreadsheet.current!=c[0].jssWorksheet&&libraryBase.jspreadsheet.current)return!1;let u=a.target.getAttribute("data-x");const d=a.target.getAttribute("data-y");if(!(libraryBase.jspreadsheet.current.resizing||libraryBase.jspreadsheet.current.dragging)){if(c[1]==1&&libraryBase.jspreadsheet.current.selectedHeader){u=a.target.getAttribute("data-x");const h=libraryBase.jspreadsheet.current.selectedHeader,f=u;selection.AH.call(libraryBase.jspreadsheet.current,h,0,f,libraryBase.jspreadsheet.current.options.data.length-1,a)}if(c[1]==2)if(a.target.classList.contains("jss_row")){if(libraryBase.jspreadsheet.current.selectedRow!=null){const h=libraryBase.jspreadsheet.current.selectedRow,f=d;selection.AH.call(libraryBase.jspreadsheet.current,0,h,libraryBase.jspreadsheet.current.options.data[0].length-1,f,a)}}else libraryBase.jspreadsheet.current.edition||u&&d&&(libraryBase.jspreadsheet.current.selectedCorner?updateCopySelection.call(libraryBase.jspreadsheet.current,u,d):libraryBase.jspreadsheet.current.selectedCell&&selection.AH.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],u,d,a))}}}libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null)},doubleClickControls=function(a){if(libraryBase.jspreadsheet.current)if(a.target.classList.contains("jss_corner")){if(libraryBase.jspreadsheet.current.highlighted.length>0){const s=libraryBase.jspreadsheet.current.highlighted[0].element.getAttribute("data-x"),c=parseInt(libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-y"))+1,u=libraryBase.jspreadsheet.current.highlighted[libraryBase.jspreadsheet.current.highlighted.length-1].element.getAttribute("data-x"),d=libraryBase.jspreadsheet.current.records.length-1;selection.kF.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[c][s].element,libraryBase.jspreadsheet.current.records[d][u].element)}}else if(a.target.classList.contains("jss_column_filter")){const s=a.target.getAttribute("data-x");filter.N$.call(libraryBase.jspreadsheet.current,s)}else{const s=getElement(a.target);if(s[1]==1&&libraryBase.jspreadsheet.current.options.columnSorting!=0){const c=a.target.getAttribute("data-x");c&&libraryBase.jspreadsheet.current.orderBy(parseInt(c))}if(s[1]==2&&libraryBase.jspreadsheet.current.options.editable!=0&&!libraryBase.jspreadsheet.current.edition){const c=function(d){if(d.parentNode){const h=d.getAttribute("data-x"),f=d.getAttribute("data-y");return h&&f?d:c(d.parentNode)}},u=c(a.target);u&&u.classList.contains("highlight")&&openEditor.call(libraryBase.jspreadsheet.current,u,void 0,a)}}},pasteControls=function(a){libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.selectedCell&&(libraryBase.jspreadsheet.current.edition||libraryBase.jspreadsheet.current.options.editable!=0&&(a&&a.clipboardData?(paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],a.clipboardData.getData("text")),a.preventDefault()):window.clipboardData&&paste.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.selectedCell[0],libraryBase.jspreadsheet.current.selectedCell[1],window.clipboardData.getData("text"))))},getRole=function(a){if(a.classList.contains("jss_selectall"))return"select-all";if(a.classList.contains("jss_corner"))return"fill-handle";let s=a;for(;!s.classList.contains("jss_spreadsheet");){if(s.classList.contains("jss_row"))return"row";if(s.classList.contains("jss_nested"))return"nested";if(s.classList.contains("jtabs-headers"))return"tabs";if(s.classList.contains("jtoolbar"))return"toolbar";if(s.classList.contains("jss_pagination"))return"pagination";if(s.tagName==="TBODY")return"cell";if(s.tagName==="TFOOT")return getElementIndex(a)===0?"grid":"footer";if(s.tagName==="THEAD")return"header";s=s.parentElement}return"applications"},defaultContextMenu=function(a,s,c,u){const d=[];if(u==="header"&&(a.options.allowInsertColumn!=0&&d.push({title:jSuites.translate("Insert a new column before"),onclick:function(){a.insertColumn(1,parseInt(s),1)}}),a.options.allowInsertColumn!=0&&d.push({title:jSuites.translate("Insert a new column after"),onclick:function(){a.insertColumn(1,parseInt(s),0)}}),a.options.allowDeleteColumn!=0&&d.push({title:jSuites.translate("Delete selected columns"),onclick:function(){a.deleteColumn(a.getSelectedColumns().length?void 0:parseInt(s))}}),a.options.allowRenameColumn!=0&&d.push({title:jSuites.translate("Rename this column"),onclick:function(){const h=a.getHeader(s),f=prompt(jSuites.translate("Column name"),h);a.setHeader(s,f)}}),a.options.columnSorting!=0&&(d.push({type:"line"}),d.push({title:jSuites.translate("Order ascending"),onclick:function(){a.orderBy(s,0)}}),d.push({title:jSuites.translate("Order descending"),onclick:function(){a.orderBy(s,1)}}))),u!=="row"&&u!=="cell"||(a.options.allowInsertRow!=0&&(d.push({title:jSuites.translate("Insert a new row before"),onclick:function(){a.insertRow(1,parseInt(c),1)}}),d.push({title:jSuites.translate("Insert a new row after"),onclick:function(){a.insertRow(1,parseInt(c))}})),a.options.allowDeleteRow!=0&&d.push({title:jSuites.translate("Delete selected rows"),onclick:function(){a.deleteRow(a.getSelectedRows().length?void 0:parseInt(c))}})),u==="cell"&&a.options.allowComments!=0){d.push({type:"line"});const h=a.records[c][s].element.getAttribute("title")||"";d.push({title:jSuites.translate(h?"Edit comments":"Add comments"),onclick:function(){const f=prompt(jSuites.translate("Comments"),h);f&&a.setComments((0,helpers.getCellNameFromCoords)(s,c),f)}}),h&&d.push({title:jSuites.translate("Clear comments"),onclick:function(){a.setComments((0,helpers.getCellNameFromCoords)(s,c),"")}})}return d.length!==0&&d.push({type:"line"}),u!=="header"&&u!=="row"&&u!=="cell"||(d.push({title:jSuites.translate("Copy")+"...",shortcut:"Ctrl + C",onclick:function(){copy.call(a,!0)}}),navigator&&navigator.clipboard&&d.push({title:jSuites.translate("Paste")+"...",shortcut:"Ctrl + V",onclick:function(){a.selectedCell&&navigator.clipboard.readText().then((function(h){h&&paste.call(a,a.selectedCell[0],a.selectedCell[1],h)}))}})),a.parent.config.allowExport!=0&&d.push({title:jSuites.translate("Save as")+"...",shortcut:"Ctrl + S",onclick:function(){a.download()}}),a.parent.config.about!=0&&d.push({title:jSuites.translate("About"),onclick:function(){a.parent.config.about===void 0||a.parent.config.about===!0?alert(version.print()):alert(a.parent.config.about)}}),d},getElementIndex=function(a){const s=a.parentElement.children;for(let c=0;c<s.length;c++)if(a===s[c])return c;return-1},contextMenuControls=function(a){if("buttons"in(a=a||window.event)?a.buttons:a.which||a.button,libraryBase.jspreadsheet.current){const s=libraryBase.jspreadsheet.current.parent;if(libraryBase.jspreadsheet.current.edition)a.preventDefault();else if(s.contextMenu.contextmenu.close(),libraryBase.jspreadsheet.current){const c=getRole(a.target);let u=null,d=null;if(c==="cell"){let f=a.target;for(;f.tagName!=="TD";)f=f.parentNode;d=f.getAttribute("data-y"),u=f.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||u<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||u>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||d<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||d>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,u,d,u,d,a)}else if(c==="row"||c==="header")c==="row"?d=a.target.getAttribute("data-y"):u=a.target.getAttribute("data-x"),(!libraryBase.jspreadsheet.current.selectedCell||u<parseInt(libraryBase.jspreadsheet.current.selectedCell[0])||u>parseInt(libraryBase.jspreadsheet.current.selectedCell[2])||d<parseInt(libraryBase.jspreadsheet.current.selectedCell[1])||d>parseInt(libraryBase.jspreadsheet.current.selectedCell[3]))&&selection.AH.call(libraryBase.jspreadsheet.current,u,d,u,d,a);else if(c==="nested"){const f=a.target.getAttribute("data-column").split(",");u=getElementIndex(a.target)-1,d=getElementIndex(a.target.parentElement),libraryBase.jspreadsheet.current.selectedCell&&f[0]==parseInt(libraryBase.jspreadsheet.current.selectedCell[0])&&f[f.length-1]==parseInt(libraryBase.jspreadsheet.current.selectedCell[2])&&libraryBase.jspreadsheet.current.selectedCell[1]==null&&libraryBase.jspreadsheet.current.selectedCell[3]==null||selection.AH.call(libraryBase.jspreadsheet.current,f[0],null,f[f.length-1],null,a)}else c==="select-all"?selection.Ub.call(libraryBase.jspreadsheet.current):c==="tabs"?u=getElementIndex(a.target):c==="footer"&&(u=getElementIndex(a.target)-1,d=getElementIndex(a.target.parentElement));let h=defaultContextMenu(libraryBase.jspreadsheet.current,parseInt(u),parseInt(d),c);if(typeof s.config.contextMenu=="function"){const f=s.config.contextMenu(libraryBase.jspreadsheet.current,u,d,a,h,c,u,d);if(f)h=f;else if(f===!1)return}typeof s.plugins=="object"&&Object.entries(s.plugins).forEach((function([,f]){if(typeof f.contextMenu=="function"){const g=f.contextMenu(libraryBase.jspreadsheet.current,u!==null?parseInt(u):null,d!==null?parseInt(d):null,a,h,c,u!==null?parseInt(u):null,d!==null?parseInt(d):null);g&&(h=g)}})),s.contextMenu.contextmenu.open(a,h),a.preventDefault()}}},touchStartControls=function(a){const s=getElement(a.target);if(s[0]?libraryBase.jspreadsheet.current!=s[0].jssWorksheet&&(libraryBase.jspreadsheet.current&&libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=s[0].jssWorksheet):libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.resetSelection(),libraryBase.jspreadsheet.current=null),libraryBase.jspreadsheet.current&&!libraryBase.jspreadsheet.current.edition){const c=a.target.getAttribute("data-x"),u=a.target.getAttribute("data-y");c&&u&&(selection.AH.call(libraryBase.jspreadsheet.current,c,u,void 0,void 0,a),libraryBase.jspreadsheet.timeControl=setTimeout((function(){libraryBase.jspreadsheet.current.options.columns[c].type=="color"?libraryBase.jspreadsheet.tmpElement=null:libraryBase.jspreadsheet.tmpElement=a.target,openEditor.call(libraryBase.jspreadsheet.current,a.target,!1,a)}),500))}},touchEndControls=function(a){libraryBase.jspreadsheet.timeControl&&(clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=null,libraryBase.jspreadsheet.tmpElement&&libraryBase.jspreadsheet.tmpElement.children[0].tagName=="INPUT"&&libraryBase.jspreadsheet.tmpElement.children[0].focus(),libraryBase.jspreadsheet.tmpElement=null)},cutControls=function(a){libraryBase.jspreadsheet.current&&(libraryBase.jspreadsheet.current.edition||(copy.call(libraryBase.jspreadsheet.current,!0,void 0,void 0,void 0,void 0,!0),libraryBase.jspreadsheet.current.options.editable!=0&&libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map((function(s){return s.element})),"")))},copyControls=function(a){libraryBase.jspreadsheet.current&&copyControls.enabled&&(libraryBase.jspreadsheet.current.edition||copy.call(libraryBase.jspreadsheet.current,!0))},isMac=function(){return navigator.platform.toUpperCase().indexOf("MAC")>=0},isCtrl=function(a){return isMac()?a.metaKey:a.ctrlKey},keyDownControls=function(a){if(libraryBase.jspreadsheet.current){if(libraryBase.jspreadsheet.current.edition)if(a.which==27)libraryBase.jspreadsheet.current.edition&&closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!1),a.preventDefault();else if(a.which==13){if(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="calendar")closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0);else if(!(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type=="dropdown"))if((libraryBase.jspreadsheet.current.options.wordWrap==1||libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].wordWrap==1||libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]]&&libraryBase.jspreadsheet.current.options.data[libraryBase.jspreadsheet.current.edition[3]][libraryBase.jspreadsheet.current.edition[2]].length>200)&&a.altKey){const s=libraryBase.jspreadsheet.current.edition[0].children[0];let c=libraryBase.jspreadsheet.current.edition[0].children[0].value;const u=s.selectionStart;c=c.slice(0,u)+`
`+c.slice(u),s.value=c,s.focus(),s.selectionStart=u+1,s.selectionEnd=u+1}else libraryBase.jspreadsheet.current.edition[0].children[0].blur()}else a.which==9&&(libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]]&&["calendar","html"].includes(libraryBase.jspreadsheet.current.options.columns[libraryBase.jspreadsheet.current.edition[2]].type)?closeEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.edition[0],!0):libraryBase.jspreadsheet.current.edition[0].children[0].blur());if(!libraryBase.jspreadsheet.current.edition&&libraryBase.jspreadsheet.current.selectedCell)if(a.which==37)left.call(libraryBase.jspreadsheet.current,a.shiftKey,a.ctrlKey),a.preventDefault();else if(a.which==39)right.call(libraryBase.jspreadsheet.current,a.shiftKey,a.ctrlKey),a.preventDefault();else if(a.which==38)up.call(libraryBase.jspreadsheet.current,a.shiftKey,a.ctrlKey),a.preventDefault();else if(a.which==40)down.call(libraryBase.jspreadsheet.current,a.shiftKey,a.ctrlKey),a.preventDefault();else if(a.which==36)first.call(libraryBase.jspreadsheet.current,a.shiftKey,a.ctrlKey),a.preventDefault();else if(a.which==35)last.call(libraryBase.jspreadsheet.current,a.shiftKey,a.ctrlKey),a.preventDefault();else if(a.which==46||a.which==8)libraryBase.jspreadsheet.current.options.editable!=0&&(libraryBase.jspreadsheet.current.selectedRow!=null?libraryBase.jspreadsheet.current.options.allowDeleteRow!=0&&confirm(jSuites.translate("Are you sure to delete the selected rows?"))&&libraryBase.jspreadsheet.current.deleteRow():libraryBase.jspreadsheet.current.selectedHeader?libraryBase.jspreadsheet.current.options.allowDeleteColumn!=0&&confirm(jSuites.translate("Are you sure to delete the selected columns?"))&&libraryBase.jspreadsheet.current.deleteColumn():libraryBase.jspreadsheet.current.setValue(libraryBase.jspreadsheet.current.highlighted.map((function(s){return s.element})),""));else if(a.which==13)a.shiftKey?up.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertRow!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertRow!=0&&libraryBase.jspreadsheet.current.selectedCell[1]==libraryBase.jspreadsheet.current.options.data.length-1&&libraryBase.jspreadsheet.current.insertRow(),down.call(libraryBase.jspreadsheet.current)),a.preventDefault();else if(a.which==9)a.shiftKey?left.call(libraryBase.jspreadsheet.current):(libraryBase.jspreadsheet.current.options.allowInsertColumn!=0&&libraryBase.jspreadsheet.current.options.allowManualInsertColumn!=0&&libraryBase.jspreadsheet.current.selectedCell[0]==libraryBase.jspreadsheet.current.options.data[0].length-1&&libraryBase.jspreadsheet.current.insertColumn(),right.call(libraryBase.jspreadsheet.current)),a.preventDefault();else if(!a.ctrlKey&&!a.metaKey||a.shiftKey){if(libraryBase.jspreadsheet.current.selectedCell&&libraryBase.jspreadsheet.current.options.editable!=0){const s=libraryBase.jspreadsheet.current.selectedCell[1],c=libraryBase.jspreadsheet.current.selectedCell[0];a.keyCode==32?(a.preventDefault(),libraryBase.jspreadsheet.current.options.columns[c].type=="checkbox"||libraryBase.jspreadsheet.current.options.columns[c].type=="radio"?setCheckRadioValue.call(libraryBase.jspreadsheet.current):openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[s][c].element,!0,a)):a.keyCode==113?openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[s][c].element,!1,a):a.key.length!==1&&a.key!=="Process"||a.altKey||isCtrl(a)||(openEditor.call(libraryBase.jspreadsheet.current,libraryBase.jspreadsheet.current.records[s][c].element,!0,a),libraryBase.jspreadsheet.current.options.columns&&libraryBase.jspreadsheet.current.options.columns[c]&&libraryBase.jspreadsheet.current.options.columns[c].type=="calendar"&&a.preventDefault())}}else a.which==65?(selection.Ub.call(libraryBase.jspreadsheet.current),a.preventDefault()):a.which==83?(libraryBase.jspreadsheet.current.download(),a.preventDefault()):a.which==89?(libraryBase.jspreadsheet.current.redo(),a.preventDefault()):a.which==90?(libraryBase.jspreadsheet.current.undo(),a.preventDefault()):a.which==67?(copy.call(libraryBase.jspreadsheet.current,!0),a.preventDefault()):a.which==88?(libraryBase.jspreadsheet.current.options.editable!=0?cutControls():copyControls(),a.preventDefault()):a.which==86&&pasteControls();else a.target.classList.contains("jss_search")&&(libraryBase.jspreadsheet.timeControl&&clearTimeout(libraryBase.jspreadsheet.timeControl),libraryBase.jspreadsheet.timeControl=setTimeout((function(){libraryBase.jspreadsheet.current.search(a.target.value)}),200))}},wheelControls=function(a){const s=this;s.options.lazyLoading==1&&libraryBase.jspreadsheet.timeControlLoading==null&&(libraryBase.jspreadsheet.timeControlLoading=setTimeout((function(){s.content.scrollTop+s.content.clientHeight>=s.content.scrollHeight-10?lazyLoading.p6.call(s)&&(s.content.scrollTop+s.content.clientHeight>s.content.scrollHeight-10&&(s.content.scrollTop=s.content.scrollTop-s.content.clientHeight),selection.Aq.call(s)):s.content.scrollTop<=s.content.clientHeight&&lazyLoading.G_.call(s)&&(s.content.scrollTop<10&&(s.content.scrollTop=s.content.scrollTop+s.content.clientHeight),selection.Aq.call(s)),libraryBase.jspreadsheet.timeControlLoading=null}),100))};let scrollLeft=0;const updateFreezePosition=function(){const a=this;scrollLeft=a.content.scrollLeft;let s=0;if(scrollLeft>50)for(let c=0;c<a.options.freezeColumns;c++){if(c>0&&(!a.options.columns||!a.options.columns[c-1]||a.options.columns[c-1].type!=="hidden")){let u;u=a.options.columns&&a.options.columns[c-1]&&a.options.columns[c-1].width!==void 0?parseInt(a.options.columns[c-1].width):a.options.defaultColWidth!==void 0?parseInt(a.options.defaultColWidth):100,s+=parseInt(u)}a.headers[c].classList.add("jss_freezed"),a.headers[c].style.left=s+"px";for(let u=0;u<a.rows.length;u++)if(a.rows[u]&&a.records[u][c]){const d=scrollLeft+(c>0?a.records[u][c-1].element.style.width:0)-51+"px";a.records[u][c].element.classList.add("jss_freezed"),a.records[u][c].element.style.left=d}}else for(let c=0;c<a.options.freezeColumns;c++){a.headers[c].classList.remove("jss_freezed"),a.headers[c].style.left="";for(let u=0;u<a.rows.length;u++)a.records[u][c]&&(a.records[u][c].element.classList.remove("jss_freezed"),a.records[u][c].element.style.left="")}selection.Aq.call(a)},scrollControls=function(a){const s=this;wheelControls.call(s),s.options.freezeColumns>0&&s.content.scrollLeft!=scrollLeft&&updateFreezePosition.call(s),s.options.lazyLoading!=1&&s.options.tableOverflow!=1||s.edition&&a.target.className.substr(0,9)!="jdropdown"&&closeEditor.call(s,s.edition[0],!0)},setEvents=function(a){destroyEvents(a),a.addEventListener("mouseup",mouseUpControls),a.addEventListener("mousedown",mouseDownControls),a.addEventListener("mousemove",mouseMoveControls),a.addEventListener("mouseover",mouseOverControls),a.addEventListener("dblclick",doubleClickControls),a.addEventListener("paste",pasteControls),a.addEventListener("contextmenu",contextMenuControls),a.addEventListener("touchstart",touchStartControls),a.addEventListener("touchend",touchEndControls),a.addEventListener("touchcancel",touchEndControls),a.addEventListener("touchmove",touchEndControls),document.addEventListener("keydown",keyDownControls)},destroyEvents=function(a){a.removeEventListener("mouseup",mouseUpControls),a.removeEventListener("mousedown",mouseDownControls),a.removeEventListener("mousemove",mouseMoveControls),a.removeEventListener("mouseover",mouseOverControls),a.removeEventListener("dblclick",doubleClickControls),a.removeEventListener("paste",pasteControls),a.removeEventListener("contextmenu",contextMenuControls),a.removeEventListener("touchstart",touchStartControls),a.removeEventListener("touchend",touchEndControls),a.removeEventListener("touchcancel",touchEndControls),document.removeEventListener("keydown",keyDownControls)};var toolbar=__webpack_require__(392),pagination=__webpack_require__(167);const setData=function(a){const s=this;if(a&&(s.options.data=a),s.options.data||(s.options.data=[]),s.options.data&&s.options.data[0]&&!Array.isArray(s.options.data[0])){a=[];for(let E=0;E<s.options.data.length;E++){const C=[];for(let b=0;b<s.options.columns.length;b++)C[b]=s.options.data[E][s.options.columns[b].name];a.push(C)}s.options.data=a}let c=0,u=0;const d=s.options.columns&&s.options.columns.length||0,h=s.options.data.length,f=s.options.minDimensions[0],g=s.options.minDimensions[1],m=f>d?f:d,p=g>h?g:h;for(c=0;c<p;c++)for(u=0;u<m;u++)s.options.data[c]==null&&(s.options.data[c]=[]),s.options.data[c][u]==null&&(s.options.data[c][u]="");let v,w;for(s.rows=[],s.results=null,s.records=[],s.history=[],s.historyIndex=-1,s.tbody.innerHTML="",s.options.lazyLoading==1?(v=0,w=s.options.data.length<100?s.options.data.length:100,s.options.pagination&&(s.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))):s.options.pagination?(s.pageNumber||(s.pageNumber=0),s.options.pagination,v=s.options.pagination*s.pageNumber,w=s.options.pagination*s.pageNumber+s.options.pagination,s.options.data.length<w&&(w=s.options.data.length)):(v=0,w=s.options.data.length),c=0;c<s.options.data.length;c++){const E=createRow.call(s,c,s.options.data[c]);c>=v&&c<w&&s.tbody.appendChild(E.element)}if(s.options.lazyLoading==1||s.options.pagination&&pagination.IV.call(s),s.options.mergeCells){const E=Object.keys(s.options.mergeCells);for(let C=0;C<E.length;C++){const b=s.options.mergeCells[E[C]];merges.FU.call(s,E[C],b[0],b[1],1)}}internal.am.call(s)},getValue=function(a,s){const c=this;let u,d;if(typeof a!="string")return null;u=(a=(0,internalHelpers.vu)(a,!0))[0],d=a[1];let h=null;return u!=null&&d!=null&&(c.records[d]&&c.records[d][u]&&s?h=c.records[d][u].element.innerHTML:c.options.data[d]&&c.options.data[d][u]!="undefined"&&(h=c.options.data[d][u])),h},getValueFromCoords=function(a,s,c){const u=this;let d=null;return a!=null&&s!=null&&(u.records[s]&&u.records[s][a]&&c?d=u.records[s][a].element.innerHTML:u.options.data[s]&&u.options.data[s][a]!="undefined"&&(d=u.options.data[s][a])),d},setValue=function(a,s,c){const u=this,d=[];if(typeof a=="string"){const f=(0,internalHelpers.vu)(a,!0),g=f[0],m=f[1];d.push(internal.k9.call(u,g,m,s,c)),internal.xF.call(u,g,m,d)}else{let f=null,g=null;if(a&&a.getAttribute&&(f=a.getAttribute("data-x"),g=a.getAttribute("data-y")),f!=null&&g!=null)d.push(internal.k9.call(u,f,g,s,c)),internal.xF.call(u,f,g,d);else{const m=Object.keys(a);if(m.length>0)for(let p=0;p<m.length;p++){let v,w;if(typeof a[p]=="string"){const E=(0,internalHelpers.vu)(a[p],!0);v=E[0],w=E[1]}else a[p].x!=null&&a[p].y!=null?(v=a[p].x,w=a[p].y,a[p].value!=null&&(s=a[p].value)):(v=a[p].getAttribute("data-x"),w=a[p].getAttribute("data-y"));v!=null&&w!=null&&(d.push(internal.k9.call(u,v,w,s,c)),internal.xF.call(u,v,w,d))}}}utils_history.Dh.call(u,{action:"setValue",records:d,selection:u.selectedCell}),internal.am.call(u);const h=d.map((function(f){return{x:f.x,y:f.y,value:f.value,oldValue:f.oldValue}}));dispatch.A.call(u,"onafterchanges",u,h)},setValueFromCoords=function(a,s,c,u){const d=this,h=[];h.push(internal.k9.call(d,a,s,c,u)),internal.xF.call(d,a,s,h),utils_history.Dh.call(d,{action:"setValue",records:h,selection:d.selectedCell}),internal.am.call(d);const f=h.map((function(g){return{x:g.x,y:g.y,value:g.value,oldValue:g.oldValue}}));dispatch.A.call(d,"onafterchanges",d,f)},getData=function(a,s,c,u){const d=this,h=[];let f=0,g=0;const m=Math.max(...d.options.data.map((function(v){return v.length}))),p=d.options.data.length;for(let v=0;v<p;v++){f=0;for(let w=0;w<m;w++)a&&!d.records[v][w].element.classList.contains("highlight")||(h[g]||(h[g]=[]),h[g][f]=s?d.records[v][w].element.innerHTML:d.options.data[v][w],f++);f>0&&g++}return c?h.map((function(v){return v.join(c)})).join(`\r
`)+`\r
`:u?h.map((function(v){const w={};return v.forEach((function(E,C){w[C]=E})),w})):h},getDataFromRange=function(a,s){const c=this,u=(0,helpers.getCoordsFromRange)(a),d=[];for(let h=u[1];h<=u[3];h++){d.push([]);for(let f=u[0];f<=u[2];f++)s?d[d.length-1].push(c.records[h][f].element.innerHTML):d[d.length-1].push(c.options.data[h][f])}return d},search=function(a){const s=this;if(s.options.filters&&filter.dr.call(s),s.resetSelection(),s.pageNumber=0,s.results=[],a){s.searchInput.value!==a&&(s.searchInput.value=a);const c=function(h,f,g){for(let m=0;m<h.length;m++)if((""+h[m]).toLowerCase().search(f)>=0||(""+s.records[g][m].element.innerHTML).toLowerCase().search(f)>=0)return!0;return!1},u=function(h){s.results.indexOf(h)==-1&&s.results.push(h)};let d=a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");d=new RegExp(d,"i"),s.options.data.forEach((function(h,f){if(c(h,d,f)){const g=merges.D0.call(s,f);if(g.length)for(let m=0;m<g.length;m++){const p=(0,internalHelpers.vu)(g[m],!0);for(let v=0;v<s.options.mergeCells[g[m]][1];v++)u(p[1]+v)}else u(f)}}))}else s.results=null;internal.hG.call(s)},resetSearch=function(){const a=this;a.searchInput.value="",a.search(""),a.results=null},getHeader=function(a){return this.headers[a].textContent},getHeaders=function(a){const s=this,c=[];for(let u=0;u<s.headers.length;u++)c.push(s.getHeader(u));return a?c:c.join(s.options.csvDelimiter)},setHeader=function(a,s){const c=this;if(c.headers[a]){const u=c.headers[a].textContent,d=c.options.columns&&c.options.columns[a]&&c.options.columns[a].title||"";s||(s=(0,helpers.getColumnName)(a)),c.headers[a].textContent=s,c.headers[a].setAttribute("title",s),c.options.columns||(c.options.columns=[]),c.options.columns[a]||(c.options.columns[a]={}),c.options.columns[a].title=s,utils_history.Dh.call(c,{action:"setHeader",column:a,oldValue:u,newValue:s}),dispatch.A.call(c,"onchangeheader",c,parseInt(a),s,d)}},getStyle=function(a,s){const c=this;if(a)return a=(0,internalHelpers.vu)(a,!0),s?c.records[a[1]][a[0]].element.style[s]:c.records[a[1]][a[0]].element.getAttribute("style");{const u={},d=c.options.data[0].length,h=c.options.data.length;for(let f=0;f<h;f++)for(let g=0;g<d;g++){const m=s?c.records[f][g].element.style[s]:c.records[f][g].element.getAttribute("style");m&&(u[(0,internalHelpers.t3)([g,f])]=m)}return u}},setStyle=function(a,s,c,u,d){const h=this,f={},g={},m=function(v,w,E){const C=(0,internalHelpers.vu)(v,!0);if(h.records[C[1]]&&h.records[C[1]][C[0]]&&(h.records[C[1]][C[0]].element.classList.contains("readonly")==0||u)){const b=h.records[C[1]][C[0]].element.style[w];b!=E||u?h.records[C[1]][C[0]].element.style[w]=E:(E="",h.records[C[1]][C[0]].element.style[w]=""),g[v]||(g[v]=[]),f[v]||(f[v]=[]),g[v].push([w+":"+b]),f[v].push([w+":"+E])}};if(s&&c)typeof a=="string"&&m(a,s,c);else{const v=Object.keys(a);for(let w=0;w<v.length;w++){let E=a[v[w]];typeof E=="string"&&(E=E.split(";"));for(let C=0;C<E.length;C++)typeof E[C]=="string"&&(E[C]=E[C].split(":")),E[C][0].trim()&&m(v[w],E[C][0].trim(),E[C][1])}}let p=Object.keys(g);for(let v=0;v<p.length;v++)g[p[v]]=g[p[v]].join(";");p=Object.keys(f);for(let v=0;v<p.length;v++)f[p[v]]=f[p[v]].join(";");d||utils_history.Dh.call(h,{action:"setStyle",oldValue:g,newValue:f}),dispatch.A.call(h,"onchangestyle",h,f)},resetStyle=function(a,s){const c=this,u=Object.keys(a);for(let d=0;d<u.length;d++){const h=(0,internalHelpers.vu)(u[d],!0);c.records[h[1]]&&c.records[h[1]][h[0]]&&c.records[h[1]][h[0]].element.setAttribute("style","")}c.setStyle(a,null,null,null,s)},download=function(a,s){const c=this;if(c.parent.config.allowExport==0)console.error("Export not allowed");else{let u="";u+=copy.call(c,!1,c.options.csvDelimiter,!0,a,!0,void 0,s);const d=new Blob(["\uFEFF"+u],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(d,(c.options.csvFileName||c.options.worksheetName)+".csv");else{const h=document.createElement("a");h.setAttribute("target","_top");const f=URL.createObjectURL(d);h.href=f,h.setAttribute("download",(c.options.csvFileName||c.options.worksheetName)+".csv"),document.body.appendChild(h),h.click(),h.parentNode.removeChild(h)}}},getComments=function(a){const s=this;if(a)return typeof a!="string"?getComments.call(s):(a=(0,internalHelpers.vu)(a,!0),s.records[a[1]][a[0]].element.getAttribute("title")||"");{const c={};for(let u=0;u<s.options.data.length;u++)for(let d=0;d<s.options.columns.length;d++){const h=s.records[u][d].element.getAttribute("title");h&&(c[(0,internalHelpers.t3)([d,u])]=h)}return c}},setComments=function(a,s){const c=this;let u;u=typeof a=="string"?{[a]:s}:a;const d={};Object.entries(u).forEach((function([h,f]){const g=(0,helpers.getCoordsFromCellName)(h);d[h]=c.records[g[1]][g[0]].element.getAttribute("title"),c.records[g[1]][g[0]].element.setAttribute("title",f||""),f?(c.records[g[1]][g[0]].element.classList.add("jss_comments"),c.options.comments||(c.options.comments={}),c.options.comments[h]=f):(c.records[g[1]][g[0]].element.classList.remove("jss_comments"),c.options.comments&&c.options.comments[h]&&delete c.options.comments[h])})),utils_history.Dh.call(c,{action:"setComments",newValue:u,oldValue:d}),dispatch.A.call(c,"oncomments",c,u,d)};var orderBy=__webpack_require__(94);const getWorksheetConfig=function(){return this.options},getSpreadsheetConfig=function(){return this.config},setConfig=function(a,s){const c=this,u=Object.keys(a);let d;c.parent?d=c.parent:(s=!0,d=c),u.forEach((function(h){s?(d.config[h]=a[h],h==="toolbar"&&(a[h]===!0?d.showToolbar():a[h]===!1&&d.hideToolbar())):c.options[h]=a[h]}))};var meta=__webpack_require__(654);const setReadOnly=function(a,s){const c=this;let u;if(typeof a=="string"){const d=(0,helpers.getCoordsFromCellName)(a);u=c.records[d[1]][d[0]]}else{const d=parseInt(a.getAttribute("data-x")),h=parseInt(a.getAttribute("data-y"));u=c.records[h][d]}s?u.element.classList.add("readonly"):u.element.classList.remove("readonly")},isReadOnly=function(a,s){return typeof a=="string"&&s===void 0&&([a,s]=(0,helpers.getCoordsFromCellName)(a)),this.records[s][a].element.classList.contains("readonly")},setWorksheetFunctions=function(a){for(let s=0;s<worksheetPublicMethodsLength;s++){const[c,u]=worksheetPublicMethods[s];a[c]=u.bind(a)}},createTable=function(){let a=this;setWorksheetFunctions(a),a.table=document.createElement("table"),a.thead=document.createElement("thead"),a.tbody=document.createElement("tbody"),a.headers=[],a.cols=[],a.content=document.createElement("div"),a.content.classList.add("jss_content"),a.content.onscroll=function(w){scrollControls.call(a,w)},a.content.onwheel=function(w){wheelControls.call(a,w)};const s=document.createElement("div"),c=document.createElement("label");c.innerHTML=jSuites.translate("Search")+": ",s.appendChild(c),a.searchInput=document.createElement("input"),a.searchInput.classList.add("jss_search"),c.appendChild(a.searchInput),a.searchInput.onfocus=function(){a.resetSelection()};const u=document.createElement("div");if(a.options.pagination>0&&a.options.paginationOptions&&a.options.paginationOptions.length>0){a.paginationDropdown=document.createElement("select"),a.paginationDropdown.classList.add("jss_pagination_dropdown"),a.paginationDropdown.onchange=function(){a.options.pagination=parseInt(this.value),a.page(0)};for(let w=0;w<a.options.paginationOptions.length;w++){const E=document.createElement("option");E.value=a.options.paginationOptions[w],E.innerHTML=a.options.paginationOptions[w],a.paginationDropdown.appendChild(E)}a.paginationDropdown.value=a.options.pagination,u.appendChild(document.createTextNode(jSuites.translate("Show "))),u.appendChild(a.paginationDropdown),u.appendChild(document.createTextNode(jSuites.translate("entries")))}const d=document.createElement("div");d.classList.add("jss_filter"),d.appendChild(u),d.appendChild(s),a.colgroupContainer=document.createElement("colgroup");let h=document.createElement("col");if(h.setAttribute("width","50"),a.colgroupContainer.appendChild(h),a.options.nestedHeaders&&a.options.nestedHeaders.length>0&&a.options.nestedHeaders[0]&&a.options.nestedHeaders[0][0])for(let w=0;w<a.options.nestedHeaders.length;w++)a.thead.appendChild(internal.ju.call(a,a.options.nestedHeaders[w]));a.headerContainer=document.createElement("tr"),h=document.createElement("td"),h.classList.add("jss_selectall"),a.headerContainer.appendChild(h);const f=getNumberOfColumns.call(a);for(let w=0;w<f;w++)createCellHeader.call(a,w),a.headerContainer.appendChild(a.headers[w]),a.colgroupContainer.appendChild(a.cols[w].colElement);if(a.thead.appendChild(a.headerContainer),a.options.filters==1){a.filter=document.createElement("tr");const w=document.createElement("td");a.filter.appendChild(w);for(let E=0;E<a.options.columns.length;E++){const C=document.createElement("td");C.innerHTML="&nbsp;",C.setAttribute("data-x",E),C.className="jss_column_filter",a.options.columns[E].type=="hidden"&&(C.style.display="none"),a.filter.appendChild(C)}a.thead.appendChild(a.filter)}a.table=document.createElement("table"),a.table.classList.add("jss_worksheet"),a.table.setAttribute("cellpadding","0"),a.table.setAttribute("cellspacing","0"),a.table.setAttribute("unselectable","yes"),a.table.appendChild(a.colgroupContainer),a.table.appendChild(a.thead),a.table.appendChild(a.tbody),a.options.textOverflow||a.table.classList.add("jss_overflow"),a.corner=document.createElement("div"),a.corner.className="jss_corner",a.corner.setAttribute("unselectable","on"),a.corner.setAttribute("onselectstart","return false"),a.options.selectionCopy==0&&(a.corner.style.display="none"),a.textarea=document.createElement("textarea"),a.textarea.className="jss_textarea",a.textarea.id="jss_textarea",a.textarea.tabIndex="-1",a.textarea.ariaHidden="true";const g=document.createElement("a");g.setAttribute("href","https://bossanova.uk/jspreadsheet/"),a.ads=document.createElement("div"),a.ads.className="jss_about";const m=document.createElement("span");m.innerHTML="Jspreadsheet CE",g.appendChild(m),a.ads.appendChild(g),document.createElement("div").classList.add("jss_table"),a.pagination=document.createElement("div"),a.pagination.classList.add("jss_pagination");const p=document.createElement("div"),v=document.createElement("div");if(a.pagination.appendChild(p),a.pagination.appendChild(v),a.options.pagination||(a.pagination.style.display="none"),a.options.search==1&&a.element.appendChild(d),a.content.appendChild(a.table),a.content.appendChild(a.corner),a.content.appendChild(a.textarea),a.element.appendChild(a.content),a.element.appendChild(a.pagination),a.element.appendChild(a.ads),a.element.classList.add("jss_container"),a.element.jssWorksheet=a,a.element.jspreadsheet=a,a.options.tableOverflow==1&&(a.options.tableHeight&&(a.content.style["overflow-y"]="auto",a.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",a.content.style.maxHeight=typeof a.options.tableHeight=="string"?a.options.tableHeight:a.options.tableHeight+"px"),a.options.tableWidth&&(a.content.style["overflow-x"]="auto",a.content.style.width=typeof a.options.tableWidth=="string"?a.options.tableWidth:a.options.tableWidth+"px")),a.options.tableOverflow!=1&&a.parent.config.toolbar&&a.element.classList.add("with-toolbar"),a.options.columnDrag!=0&&a.thead.classList.add("draggable"),a.options.columnResize!=0&&a.thead.classList.add("resizable"),a.options.rowDrag!=0&&a.tbody.classList.add("draggable"),a.options.rowResize!=0&&a.tbody.classList.add("resizable"),a.setData.call(a),a.options.style&&(a.setStyle(a.options.style,null,null,1,1),delete a.options.style),Object.defineProperty(a.options,"style",{enumerable:!0,configurable:!0,get(){return a.getStyle()}}),a.options.comments&&a.setComments(a.options.comments),a.options.classes){const w=Object.keys(a.options.classes);for(let E=0;E<w.length;E++){const C=(0,internalHelpers.vu)(w[E],!0);a.records[C[1]][C[0]].element.classList.add(a.options.classes[w[E]])}}},prepareTable=function(){const a=this;a.options.lazyLoading==1&&a.options.tableOverflow!=1&&a.parent.config.fullscreen!=1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),a.options.lazyLoading=!1),a.options.columns||(a.options.columns=[]);let s,c=a.options.columns.length;if(a.options.data&&a.options.data[0]!==void 0)if(Array.isArray(a.options.data[0])){const d=a.options.data[0].length;d>c&&(c=d)}else s=Object.keys(a.options.data[0]),s.length>c&&(c=s.length);a.options.minDimensions||(a.options.minDimensions=[0,0]),a.options.minDimensions[0]>c&&(c=a.options.minDimensions[0]);const u=[];for(let d=0;d<c;d++)a.options.columns[d]||(a.options.columns[d]={}),!a.options.columns[d].name&&s&&s[d]&&(a.options.columns[d].name=s[d]),a.options.columns[d].type=="dropdown"&&a.options.columns[d].url&&u.push({url:a.options.columns[d].url,index:d,method:"GET",dataType:"json",success:function(h){a.options.columns[this.index].source||(a.options.columns[this.index].source=[]);for(let f=0;f<h.length;f++)a.options.columns[this.index].source.push(h[f])}});u.length?jSuites.ajax(u,(function(){createTable.call(a)})):createTable.call(a)},getNextDefaultWorksheetName=function(a){const s=/^Sheet(\d+)$/;let c=0;return a.worksheets.forEach((function(u){const d=s.exec(u.options.worksheetName);d&&(c=Math.max(c,parseInt(d[1])))})),"Sheet"+(c+1)},buildWorksheet=async function(){const a=this,s=(a.element,a.parent);typeof s.plugins=="object"&&Object.entries(s.plugins).forEach((function([,u]){typeof u.beforeinit=="function"&&u.beforeinit(a)})),libraryBase.jspreadsheet.current=a;const c=[];if(a.options.csv){const u=new Promise((d=>{jSuites.ajax({url:a.options.csv,method:"GET",dataType:"text",success:function(h){const f=(0,helpers.parseCSV)(h,a.options.csvDelimiter);if(a.options.csvHeaders==1&&f.length>0){const g=f.shift();if(g.length>0){a.options.columns||(a.options.columns=[]);for(let m=0;m<g.length;m++)a.options.columns[m]||(a.options.columns[m]={}),a.options.columns[m].title===void 0&&(a.options.columns[m].title=g[m])}}a.options.data=f,prepareTable.call(a),d()}})}));c.push(u)}else if(a.options.url){const u=new Promise((d=>{jSuites.ajax({url:a.options.url,method:"GET",dataType:"json",success:function(h){a.options.data=h.data?h.data:h,prepareTable.call(a),d()}})}));c.push(u)}else prepareTable.call(a);await Promise.all(c),typeof s.plugins=="object"&&Object.entries(s.plugins).forEach((function([,u]){typeof u.init=="function"&&u.init(a)}))},createWorksheetObj=function(a){const s=this.parent;a.worksheetName||(a.worksheetName=getNextDefaultWorksheetName(this.parent));const c={parent:s,options:a,filters:[],formula:[],history:[],selection:[],historyIndex:-1};return s.config.worksheets.push(c.options),s.worksheets.push(c),c},createWorksheet=function(a){const s=this.parent;s.creationThroughJss=!0,createWorksheetObj.call(this,a),s.element.tabs.create(a.worksheetName)},openWorksheet=function(a){this.parent.element.tabs.open(a)},deleteWorksheet=function(a){const s=this;s.parent.element.tabs.remove(a);const c=s.parent.worksheets.splice(a,1)[0];dispatch.A.call(s.parent,"ondeleteworksheet",c,a)},worksheetPublicMethods=[["selectAll",selection.Ub],["updateSelectionFromCoords",function(a,s,c,u){return selection.AH.call(this,a,s,c,u)}],["resetSelection",function(){return selection.gE.call(this)}],["getSelection",selection.Lo],["getSelected",selection.ef],["getSelectedColumns",selection.Jg],["getSelectedRows",selection.R5],["getData",getData],["setData",setData],["getValue",getValue],["getValueFromCoords",getValueFromCoords],["setValue",setValue],["setValueFromCoords",setValueFromCoords],["getWidth",getWidth],["setWidth",function(a,s){return setWidth.call(this,a,s)}],["insertRow",insertRow],["moveRow",function(a,s){return moveRow.call(this,a,s)}],["deleteRow",deleteRow],["hideRow",hideRow],["showRow",showRow],["getRowData",getRowData],["setRowData",setRowData],["getHeight",getHeight],["setHeight",function(a,s){return setHeight.call(this,a,s)}],["getMerge",merges.fd],["setMerge",function(a,s,c){return merges.FU.call(this,a,s,c)}],["destroyMerge",function(){return merges.VP.call(this)}],["removeMerge",function(a,s){return merges.Zp.call(this,a,s)}],["search",search],["resetSearch",resetSearch],["getHeader",getHeader],["getHeaders",getHeaders],["setHeader",setHeader],["getStyle",getStyle],["setStyle",function(a,s,c,u){return setStyle.call(this,a,s,c,u)}],["resetStyle",resetStyle],["insertColumn",insertColumn],["moveColumn",moveColumn],["deleteColumn",deleteColumn],["getColumnData",getColumnData],["setColumnData",setColumnData],["whichPage",pagination.ho],["page",pagination.MY],["download",download],["getComments",getComments],["setComments",setComments],["orderBy",orderBy.My],["undo",utils_history.tN],["redo",utils_history.ZS],["getCell",internal.tT],["getCellFromCoords",internal.Xr],["getLabel",internal.p9],["getConfig",getWorksheetConfig],["setConfig",setConfig],["getMeta",function(a){return meta.IQ.call(this,a)}],["setMeta",meta.iZ],["showColumn",showColumn],["hideColumn",hideColumn],["showIndex",internal.C6],["hideIndex",internal.TI],["getWorksheetActive",internal.$O],["openEditor",openEditor],["closeEditor",closeEditor],["createWorksheet",createWorksheet],["openWorksheet",openWorksheet],["deleteWorksheet",deleteWorksheet],["copy",function(a){a?cutControls():copy.call(this,!0)}],["paste",paste],["executeFormula",internal.Em],["getDataFromRange",getDataFromRange],["quantiyOfPages",pagination.$f],["getRange",selection.eO],["isSelected",selection.sp],["setReadOnly",setReadOnly],["isReadOnly",isReadOnly],["getHighlighted",selection.kV],["dispatch",dispatch.A],["down",down],["first",first],["last",last],["left",left],["right",right],["up",up],["openFilter",filter.N$],["resetFilters",filter.dr]],worksheetPublicMethodsLength=worksheetPublicMethods.length,factory=function(){},createWorksheets=async function(a,s,c){let u=s.worksheets;if(!u)throw new Error("JSS: worksheets are not defined");{let d={animation:!0,onbeforecreate:function(m,p){return p||getNextDefaultWorksheetName(a)},oncreate:function(m,p){if(a.creationThroughJss)a.creationThroughJss=!1;else{const w=m.tabs.headers.children[m.tabs.headers.children.length-2].innerHTML;createWorksheetObj.call(a.worksheets[0],{minDimensions:[10,15],worksheetName:w})}const v=a.worksheets[a.worksheets.length-1];v.element=p,buildWorksheet.call(v).then((function(){(0,toolbar.nK)(v),dispatch.A.call(v,"oncreateworksheet",v,s,a.worksheets.length-1)}))},onchange:function(m,p,v){a.worksheets.length!=0&&a.worksheets[v]&&(0,toolbar.nK)(a.worksheets[v])}};s.tabs==1?d.allowCreate=!0:d.hideHeaders=!0,d.data=[];let h=1;for(let m=0;m<u.length;m++)u[m].worksheetName||(u[m].worksheetName="Sheet"+h++),d.data.push({title:u[m].worksheetName,content:""});c.classList.add("jss_spreadsheet"),c.tabIndex=0;const f=jSuites.tabs(c,d),g=s.style;delete s.style;for(let m=0;m<u.length;m++)u[m].style&&Object.entries(u[m].style).forEach((function([p,v]){typeof v=="number"&&(u[m].style[p]=g[v])})),a.worksheets.push({parent:a,element:f.content.children[m],options:u[m],filters:[],formula:[],history:[],selection:[],historyIndex:-1}),await buildWorksheet.call(a.worksheets[m])}};factory.spreadsheet=async function(a,s,c){if(a.tagName=="TABLE"){s||(s={}),s.worksheets||(s.worksheets=[]);const d=(0,helpers.createFromTable)(a,s.worksheets[0]);s.worksheets[0]=d;const h=document.createElement("div");a.parentNode.insertBefore(h,a),a.remove(),a=h}let u={worksheets:c,config:s,element:a,el:a};return u.contextMenu=document.createElement("div"),u.contextMenu.className="jss_contextmenu",u.getWorksheetActive=internal.$O.bind(u),u.fullscreen=internal.Y5.bind(u),u.showToolbar=toolbar.ll.bind(u),u.hideToolbar=toolbar.Ar.bind(u),u.getConfig=getSpreadsheetConfig.bind(u),u.setConfig=setConfig.bind(u),u.setPlugins=function(d){u.plugins||(u.plugins={}),typeof d=="object"&&Object.entries(d).forEach((function([h,f]){u.plugins[h]=f.call(libraryBase.jspreadsheet,u,{},u.config)}))},u.setPlugins(s.plugins),await createWorksheets(u,s,a),u.element.appendChild(u.contextMenu),jSuites.contextmenu(u.contextMenu,{onclick:function(){u.contextMenu.contextmenu.close(!1)}}),u.config.fullscreen==1&&u.element.classList.add("fullscreen"),toolbar.ll.call(u),s.root?setEvents(s.root):setEvents(document),a.spreadsheet=u,u},factory.worksheet=function(a,s,c){let u={parent:a,options:{}};return c===void 0?a.worksheets.push(u):a.worksheets.splice(c,0,u),Object.assign(u.options,s),u};var utils_factory=factory;libraryBase.jspreadsheet=function(a,s){try{let c=[];return utils_factory.spreadsheet(a,s,c).then((u=>{libraryBase.jspreadsheet.spreadsheet.push(u),dispatch.A.call(u,"onload",u)})),c}catch(c){console.error(c)}},libraryBase.jspreadsheet.getWorksheetInstanceByName=function(a,s){const c=libraryBase.jspreadsheet.spreadsheet.find((u=>u.config.namespace===s));if(c)return{};if(a==null){const u=c.worksheets.map((d=>[d.options.worksheetName,d]));return Object.fromEntries(u)}return c.worksheets.find((u=>u.options.worksheetName===a))},libraryBase.jspreadsheet.setDictionary=function(a){jSuites.setDictionary(a)},libraryBase.jspreadsheet.destroy=function(a,s){if(a.spreadsheet){const c=libraryBase.jspreadsheet.spreadsheet.indexOf(a.spreadsheet);libraryBase.jspreadsheet.spreadsheet.splice(c,1);const u=a.spreadsheet.config.root||document;a.spreadsheet=null,a.innerHTML="",s&&destroyEvents(u)}},libraryBase.jspreadsheet.destroyAll=function(){for(let a=0;a<libraryBase.jspreadsheet.spreadsheet.length;a++){const s=libraryBase.jspreadsheet.spreadsheet[a];libraryBase.jspreadsheet.destroy(s.element)}},libraryBase.jspreadsheet.current=null,libraryBase.jspreadsheet.spreadsheet=[],libraryBase.jspreadsheet.helpers={},libraryBase.jspreadsheet.version=function(){return version},Object.entries(helpers).forEach((([a,s])=>{libraryBase.jspreadsheet.helpers[a]=s}));var src=libraryBase.jspreadsheet;jspreadsheet=__webpack_exports__.default})(),jspreadsheet}))})(dist$3)),dist$3.exports}var distExports=requireDist();const jspreadsheet=getDefaultExportFromCjs$2(distExports);function HistoryWindow(){const{platform:a}=React.useContext(AppContext),[s,c]=React.useState(!1),[u,d]=React.useState([]),h=React.useRef(null);async function f(){await mc.send("getHistory",a).then(v=>{d(v.map(w=>({...w,imageFormula:`<img src=${w.imageUrl} />`})))}),c(!0)}useEmitter([{name:"openHistoryWindow",callback:f}]);function g(v){h.current=jspreadsheet(v,{worksheets:[{data:u,columns:[{name:"time",type:"text",title:"时间"},{name:"submitter",type:"text",title:"提交人"},{name:"pageTitle",type:"text",title:"页面标题"},{name:"pageUrl",title:"网址",type:"text"},{name:"imageUrl",title:"图片链接",type:"text"},{name:"imageFormula",title:"图片预览",type:"html"},{name:"prompt",title:"提示词",type:"text"}],editable:!1,defaultRowHeight:100,defaultColWidth:200,tableHeight:900,columnResize:!1,allowDeleteRow:!0,allowInsertColumn:!1,allowInsertRow:!1}],contextMenu:()=>!1})}const m=v=>{if(v)return h.current&&jspreadsheet.destroy(v),g(v),()=>{jspreadsheet.destroy(v)}};function p(){const v=h?.current?.[0],w=v?.getSelection();if(!w||!w.length)return null;const E=[];for(let C=w[1];C<=w[3];C++){const b=[];for(let P=w[0];P<=w[2];P++){let R=v?.getCellFromCoords(P,C)?.innerHTML;if(R||(R=""),R.startsWith("<img")){const T=R.match(/src=(".+")/);T&&(R=`=IMAGE(${T[1]})`)}b.push(R)}E.push(b)}return E}return jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx("style",{children:`
          .history-window {
            .jss_worksheet {
              & tbody tr {
                td {
                  white-space: break-spaces;
                  overflow: hidden;
                  text-overflow: ellipsis;
                  width: 200px;
                  height: 100px;

                  & img {
                    max-width: 100%;
                    max-height: 100%;
                    object-fit: contain;
                  }
                }
              }
            }
          }
        `}),jsxRuntime.jsx(antd.Modal,{title:"历史记录",width:1550,style:{minWidth:1550},open:s,onCancel:()=>c(!1),footer:null,className:"history-window",children:jsxRuntime.jsx("div",{ref:m,onCopy:v=>{const w=p();if(!w)return;const E=w.map(C=>C.join("	")).join(`
`);v.preventDefault(),v.clipboardData.setData("text/plain",E)}})})]})}function SettingsWindow(){const{platform:a}=React.useContext(AppContext),[s,c]=React.useState(!1),[u]=useForm();async function d(){const f=(await mc.send("getSettings",a)).submit;u.setFieldsValue(f),c(!0)}async function h(){mc.send("updateSettings",a,{submit:u.getFieldsValue()}),antd.message.success("配置已保存"),c(!1)}return useEmitter([{name:"openSettingsWindow",callback:d}]),jsxRuntime.jsx(antd.Modal,{title:"设置",open:s,onOk:h,onCancel:()=>c(!1),okText:"保存",cancelText:"取消",children:jsxRuntime.jsxs(antd.Form,{form:u,children:[jsxRuntime.jsxs("div",{className:"flex-row",style:{gap:10},children:[jsxRuntime.jsx(antd.Form.Item,{name:"history",label:"历史记录",valuePropName:"checked",children:jsxRuntime.jsx(antd.Checkbox,{})}),jsxRuntime.jsx(antd.Form.Item,{name:"register",label:"登记到表格",valuePropName:"checked",children:jsxRuntime.jsx(antd.Checkbox,{})})]}),jsxRuntime.jsx(antd.Form.Item,{name:"submitter",label:"提交人",children:jsxRuntime.jsx(antd.Input,{})}),jsxRuntime.jsx(antd.Form.Item,{name:"webAppUrl",label:"Web App URL",children:jsxRuntime.jsx(antd.Input,{})}),jsxRuntime.jsx(antd.Form.Item,{name:"sheet",label:"分页名",children:jsxRuntime.jsx(antd.Input,{})})]})})}class o{id;listeners={};slug;isDebugger;constructor(s,c){this.slug=s,this.isDebugger=!!c,this.id=window[s].id,this.bindEvent()}on(s,c){return this.listeners[s]=this.listeners[s]||[],this.listeners[s].push(c),()=>{if(this.listeners[s].includes(c)){const u=this.listeners[s].indexOf(c);this.listeners[s].splice(u,1)}}}send(s,...c){return new Promise(async(u,d)=>{let h={action:s,payload:c};this.isDebugger&&console.log(`[${h.action}] - 发送`,h),chrome.runtime.sendMessage(this.id,h,{},f=>{this.isDebugger&&(f?.status==="success"?console.log(`[${h.action}] - 成功`,f?.result):console.error(`[${h.action}] - 失败`,f?.errorMessage)),f?.status==="success"?u(f?.result):(console.error(f?.errorMessage),d(new Error(f?.errorMessage)))})})}connect(){chrome.runtime.sendMessage(this.id,{action:"__connect"})}disconnect(){chrome.runtime.sendMessage(this.id,{action:"__disconnect"})}bindEvent(){window.addEventListener("message",this._handleReceivingMessage.bind(this))}destroy(){this.disconnect(),this.listeners={},window.removeEventListener("message",this._handleReceivingMessage.bind(this))}async _handleReceivingMessage(s){if(s.data&&s.data.from===this.slug&&s.data.payload){const{action:c,payload:u}=s.data.payload,{callbackId:d}=s.data;if(this.isDebugger&&console.log("收到消息",s.data),this.listeners[c])for(let h of this.listeners[c])try{const f=await h(...u);d&&chrome.runtime.sendMessage(this.id,{action:"__callback",payload:{status:"success",callbackId:d,result:f}})}catch(f){d&&chrome.runtime.sendMessage(this.id,{action:"__callback",payload:{status:"error",callbackId:d,errorMessage:f.toString(),result:void 0}}),console.error(f)}}}}const mc=new o(extId,!0);antd.message.config({prefixCls:"light-message"});function App(){const a=[{key:"settings",label:"设置"},{key:"history",label:"历史记录"}];window.deleteHistory&&a.push({key:"delete",label:"打开删除窗口"});function s(c){switch(c.key){case"settings":emitter.emit("openSettingsWindow");break;case"history":emitter.emit("openHistoryWindow");break;case"delete":emitter.emit("openDeleteWindow");break}}return jsxRuntime.jsxs(jsxRuntime.Fragment,{children:[jsxRuntime.jsx(antd.Dropdown,{menu:{items:a,onClick:s},placement:"topLeft",children:jsxRuntime.jsxs("div",{className:"open-dialog-button",role:"button",onClick:()=>emitter.emit("openGenerateWindow"),children:[jsxRuntime.jsx("img",{src:logo,style:{width:35}}),jsxRuntime.jsx("span",{children:"打开窗口"})]})}),jsxRuntime.jsx(BatchModal,{}),jsxRuntime.jsx(SettingsWindow,{}),!!window.deleteHistory&&jsxRuntime.jsx(DeleteWindow,{}),jsxRuntime.jsx(HistoryWindow,{})]})}function _defineProperty$1f(a,s,c){return(s=_toPropertyKey$1f(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1f(a){var s=_toPrimitive$1f(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1f(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const SHORTCUTS_GROUP$f="handsontableEditor",EDITOR_TYPE$8="handsontable";class HandsontableEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1f(this,"isFlippedVertically",!1),_defineProperty$1f(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return EDITOR_TYPE$8}open(){super.open();const s=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),s.width="",s.height="",s.overflow=""),s.display==="none"&&(s.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(s,c,u,d,h,f){super.prepare(s,c,u,d,h,f);const g=this,m={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(p,v){const w=this.getSourceData(v.row,v.col);w!==void 0&&g.setValue(w),g.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&extend$1(m,f.handsontable),this.htOptions=m}beginEditing(s,c){const u=this.hot.getSettings().onBeginEditing;u&&u()===!1||super.beginEditing(s,c)}createElements(){super.createElements();const s=this.hot.rootDocument.createElement("DIV");s.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(s),this.htContainer=s,this.assignHooks()}finishEditing(s,c,u){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const d=this.htEditor.getValue();d!==void 0&&this.setValue(d)}super.finishEditing(s,c,u)}flipDropdownVerticallyIfNeeded(){const{view:s}=this.hot,c=this.getEditedCellRect();let u=c.top;if(s.isVerticallyScrollableByWindow()){const g=s.getTableOffset().top-this.hot.rootWindow.scrollY;u=Math.max(u+g,0)}const d=this.getDropdownHeight(),h=s.getWorkspaceHeight()-u-c.height,f=d>h&&u>h+c.height;return f?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:f,spaceAbove:u,spaceBelow:h}}flipDropdownVertically(){const s=this.htEditor.rootElement.style;s.position="absolute",s.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const s=this.htEditor.rootElement.style;s.position="absolute",s.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:s}=this.hot,c=this.getEditedCellRect();let u=c.start+c.width;if(s.isHorizontallyScrollableByWindow()){const g=s.getTableOffset().left-this.hot.rootWindow.scrollX;u=Math.max(u+g,0)}const d=this.getDropdownWidth(),h=s.getWorkspaceWidth()-u+c.width,f=d>h&&u>h;return f?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:f,spaceInlineStart:u,spaceInlineEnd:h}}flipDropdownHorizontally(){const s=this.htEditor.rootElement.style,{width:c}=this.getEditedCellRect();s.position="absolute",s[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-c)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const s=this.htEditor.rootElement.style;s.position="absolute",s[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var s;(s=this.htEditor)===null||s===void 0||s.destroy()}),this.hot.addHook("afterSetTheme",(s,c)=>{c||this.close()})}registerShortcuts(){const c=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const u={group:SHORTCUTS_GROUP$f,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"},d=(h,f)=>{const g=this.htEditor;if(h!==void 0&&(h<0||this.isFlippedVertically&&h>g.countRows()-1?g.deselectCell():g.selectCell(h,0),g.getData().length))return f.preventDefault(),stopImmediatePropagation(f),this.hot.listen(),this.TEXTAREA.focus(),!1};c.addShortcuts([{keys:[["ArrowUp"]],callback:h=>{const f=this.htEditor;let g,m;return!f.getSelectedActive()&&this.isFlippedVertically?g=f.countRows()-1:f.getSelectedActive()&&(this.isFlippedVertically?(m=f.getSelectedActive()[0],g=Math.max(0,m-1)):(m=f.getSelectedActive()[0],g=m-1)),d(g,h)},preventDefault:!1},{keys:[["ArrowDown"]],callback:h=>{const f=this.htEditor;let g,m;if(!f.getSelectedActive()&&!this.isFlippedVertically)g=0;else if(f.getSelectedActive()){if(this.isFlippedVertically)g=f.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const p=f.countRows()-1;m=f.getSelectedActive()[0],g=Math.min(p,m+1)}}return d(g,h)},preventDefault:!1}],u)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$f)}}function _classPrivateMethodInitSpec$Q(a,s){_checkPrivateRedeclaration$12(a,s),s.add(a)}function _classPrivateFieldInitSpec$L(a,s,c){_checkPrivateRedeclaration$12(a,s),s.set(a,c)}function _checkPrivateRedeclaration$12(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1e(a,s,c){return(s=_toPropertyKey$1e(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1e(a){var s=_toPrimitive$1e(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1e(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$L(a,s){return a.get(_assertClassBrand$12(a,s))}function _assertClassBrand$12(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$7="autocomplete";var _idPrefix=new WeakMap,_focusDebounced=new WeakMap,_AutocompleteEditor_brand=new WeakSet;class AutocompleteEditor extends HandsontableEditor{constructor(){super(...arguments),_classPrivateMethodInitSpec$Q(this,_AutocompleteEditor_brand),_defineProperty$1e(this,"query",null),_defineProperty$1e(this,"strippedChoices",[]),_defineProperty$1e(this,"rawChoices",[]),_classPrivateFieldInitSpec$L(this,_idPrefix,this.hot.guid.slice(0,9)),_classPrivateFieldInitSpec$L(this,_focusDebounced,debounce(()=>{this.focus()},100))}static get EDITOR_TYPE(){return EDITOR_TYPE$7}getValue(){const s=this.rawChoices.find(c=>{const u=this.stripValueIfNeeded(c);return(_assertClassBrand$12(_AutocompleteEditor_brand,this,_isKeyValueObject).call(this,u)?u.value:u)===this.TEXTAREA.value});return isDefined(s)?s:this.TEXTAREA.value}createElements(){super.createElements(),addClass$1(this.htContainer,"autocompleteEditor"),addClass$1(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_TEXT(),A11Y_COMBOBOX(),A11Y_HASPOPUP("listbox"),A11Y_AUTOCOMPLETE()])}prepare(s,c,u,d,h,f){super.prepare(s,c,u,d,h,f),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false"),A11Y_CONTROLS(`${_classPrivateFieldGet$L(_idPrefix,this)}-listbox-${s}-${c}`)]),this.htOptions={...this.htOptions,valueGetter:g=>_assertClassBrand$12(_AutocompleteEditor_brand,this,_isKeyValueObject).call(this,g)?g.value:g}}open(){super.open();const s=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,c=this.hot.getSettings().ariaTags,u=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,d=u?.length,{row:h,col:f}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",g=>this.onBeforeKeyDown(g)),this.htEditor.addHook("afterScroll",_classPrivateFieldGet$L(_focusDebounced,this)),this.htEditor.updateSettings({colWidths:s?[outerWidth(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(g,m,p,v,w,E,C)=>{textRenderer(g,m,p,v,w,E,C);const{filteringCaseSensitive:b,allowHtml:P,locale:R}=this.cellProperties,T=this.query;let I=stringify$1(E),M,N;I&&!P&&(M=b===!0?I.indexOf(T):I.toLocaleLowerCase(R).indexOf(T.toLocaleLowerCase(R)),M!==-1&&(N=I.substr(M,T.length),I=I.replace(N,`<strong>${N}</strong>`))),c&&setAttribute(m,[A11Y_OPTION(),...u?[A11Y_SETSIZE(d)]:[],...u?[A11Y_POSINSET(u.indexOf(E)+1)]:[],["id",`${this.htEditor.rootElement.id}_${p}-${v}`]]),m.innerHTML=I},afterSelectionEnd:(g,m)=>{if(c){const p=w=>{setAttribute(w,[A11Y_SELECTED()]),setAttribute(this.TEXTAREA,...A11Y_ACTIVEDESCENDANT(w.id))},v=this.htEditor.getCell(g,m,!0);v!==null?p(v):this.htEditor.addHookOnce("afterScrollVertically",()=>{const w=this.htEditor.getCell(g,m,!0);p(w)})}}}),c&&(setAttribute(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...A11Y_PRESENTATION()),setAttribute(this.htEditor.rootElement,[A11Y_LISTBOX(),A11Y_LIVE("polite"),A11Y_RELEVANT("text"),["id",`${_classPrivateFieldGet$L(_idPrefix,this)}-listbox-${h}-${f}`]]),setAttribute(this.TEXTAREA,...A11Y_EXPANDED("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&setAttribute(this.TEXTAREA,[A11Y_EXPANDED("false")])}discardEditor(s){super.discardEditor(s),this.hot.view.render()}finishEditing(s,c,u){if(this.isOpened()){const d=this.hot.getSelectedRangeActive();(isUndefined(d)||isDefined(d)&&!d.includes(this.hot._createCellCoords(this.row,this.col)))&&(s=!0)}super.finishEditing(s,c,u)}queryChoices(s){const c=this.cellProperties.source;this.query=s,typeof c=="function"?c.call(this.cellProperties,s,u=>{this.rawChoices=u,this.updateChoicesList(this.stripValuesIfNeeded(u))}):Array.isArray(c)?(this.rawChoices=c,this.updateChoicesList(this.stripValuesIfNeeded(c))):this.updateChoicesList([])}updateChoicesList(s){const c=getCaretPosition(this.TEXTAREA),u=getSelectionEndPosition(this.TEXTAREA),d=this.cellProperties.sortByRelevance,h=this.cellProperties.filter,f=this.stripValueIfNeeded(this.getValue()),g=_assertClassBrand$12(_AutocompleteEditor_brand,this,_isKeyValueObject).call(this,f)?f.value:f;let m=null,p=s;d||(p=p.toSorted());const v=[],w=this.cellProperties.locale,E=this.cellProperties.filteringCaseSensitive,C=E?g:g.toLocaleLowerCase(w);for(let b=0;b<p.length;b++){const P=_assertClassBrand$12(_AutocompleteEditor_brand,this,_isKeyValueObject).call(this,p[b])?stripTags(stringify$1(p[b].value)):stripTags(stringify$1(p[b]));if((E?P:P.toLocaleLowerCase(w)).indexOf(C)!==-1&&(v.push(b),h===!1))break}h===!1?f.length>0&&(m=v[0]):(p=v.map(b=>p[b]),m=p.indexOf(C)>-1?p.indexOf(C):0),this.strippedChoices=p,p.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(pivot([p])),p.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(m)),this.hot.listen(),setCaretPosition(this.TEXTAREA,c,c===u?void 0:u)}flipDropdownVerticallyIfNeeded(){const s=super.flipDropdownVerticallyIfNeeded(),{isFlipped:c,spaceAbove:u,spaceBelow:d}=s;return this.limitDropdownIfNeeded(c?u:d),s}limitDropdownIfNeeded(s){const c=this.getDropdownHeight();if(c>s){let u=0,d=0,h=null;do d=this.htEditor.stylesHandler.getDefaultRowHeight(),u+=d;while(u<s);h=u-d,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+c-h}px`),this.setDropdownHeight(u-d)}}updateDropdownDimensions(){const s=getFractionalScalingCompensation(),c=this.getTargetEditorWidth()+s,u=this.getTargetEditorHeight()+s;this.htEditor.updateSettings({width:c,height:u}),_assertClassBrand$12(_AutocompleteEditor_brand,this,_fixDropdownWidth).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(s){this.htEditor.updateSettings({height:s}),_assertClassBrand$12(_AutocompleteEditor_brand,this,_fixDropdownWidth).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(s){typeof s=="number"?this.htEditor.selectCell(s,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let s=0;if(!this.hot.getCurrentThemeName()){const d=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));s=parseInt(d.borderTopWidth,10)+parseInt(d.borderBottomWidth,10)}const c=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:c},(d,h)=>h).reduce((d,h)=>{const f=this.hot.stylesHandler.getDefaultRowHeight()+(h===0?1:0);return d+f},0)+s}getTargetEditorWidth(){let s=0;if(!this.hot.getCurrentThemeName()){const c=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));s=parseInt(c.borderInlineStartWidth,10)+parseInt(c.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+s}stripValueIfNeeded(s){return this.stripValuesIfNeeded([s])[0]}stripValuesIfNeeded(s){const{allowHtml:c}=this.cellProperties,u=d=>stringify$1(c?d:stripTags(d));return s.every(d=>_assertClassBrand$12(_AutocompleteEditor_brand,this,_isKeyValueObject).call(this,d))?s.map(d=>({key:u(d.key),value:u(d.value)})):s.map(d=>u(d))}onBeforeKeyDown(s){if(isPrintableChar(s.keyCode)||s.keyCode===KEY_CODES.BACKSPACE||s.keyCode===KEY_CODES.DELETE||s.keyCode===KEY_CODES.INSERT){let c=10;if(s.keyCode===KEY_CODES.C&&(s.ctrlKey||s.metaKey))return;this.isOpened()||(c+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},c)}}}function _fixDropdownWidth(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+getScrollbarWidth(this.hot.rootDocument)})}function _isKeyValueObject(a){return isObject(a)&&isDefined(a.key)&&isDefined(a.value)}const EDITOR_TYPE$6="checkbox";class CheckboxEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$6}beginEditing(s,c){if(c&&c.type==="mouseup"&&c.target.nodeName==="TD"){const u=this.TD.querySelector('input[type="checkbox"]');hasClass$1(u,"htBadValue")||u.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}const getWindow=()=>window,getDocument=()=>window.document,sto=(a,s)=>window.setTimeout(a,s),addEvent$1=function(a,s,c,u){a.addEventListener(s,c,!!u)},removeEvent=function(a,s,c,u){a.removeEventListener(s,c,!!u)},trim=function(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")},hasClass=function(a,s){return(" "+a.className+" ").indexOf(" "+s+" ")!==-1},addClass=function(a,s){hasClass(a,s)||(a.className=a.className===""?s:a.className+" "+s)},removeClass=function(a,s){a.className=trim((" "+a.className+" ").replace(" "+s+" "," "))},isArray=function(a){return/Array/.test(Object.prototype.toString.call(a))},isDate$1=function(a){return/Date/.test(Object.prototype.toString.call(a))&&!isNaN(a.getTime())},isWeekend=function(a){let s=a.getDay();return s===0||s===6},isLeapYear=function(a){return a%4===0&&a%100!==0||a%400===0},getDaysInMonth=function(a,s){return[31,isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][s]},setToStartOfDay=function(a){isDate$1(a)&&a.setHours(0,0,0,0)},compareDates=function(a,s){return a.getTime()===s.getTime()},extend=function(a,s,c){let u,d;for(u in s)d=a[u]!==void 0,d&&typeof s[u]=="object"&&s[u]!==null&&s[u].nodeName===void 0?isDate$1(s[u])?c&&(a[u]=new Date(s[u].getTime())):isArray(s[u])?c&&(a[u]=s[u].slice(0)):a[u]=extend({},s[u],c):(c||!d)&&(a[u]=s[u]);return a},fireEvent=function(a,s,c){let u=getDocument().createEvent("HTMLEvents");u.initEvent(s,!0,!1),u=extend(u,c),a.dispatchEvent(u)},adjustCalendar=function(a){return a.month<0&&(a.year-=Math.ceil(Math.abs(a.month)/12),a.month+=12),a.month>11&&(a.year+=Math.floor(Math.abs(a.month)/12),a.month-=12),a},defaults={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},renderDayName=function(a,s,c){for(s+=a.firstDay;s>=7;)s-=7;return c?a.i18n.weekdaysShort[s]:a.i18n.weekdays[s]},renderDay=function(a){let s=[],c="false";if(a.isEmpty)if(a.showDaysInNextAndPreviousMonths)s.push("is-outside-current-month"),a.enableSelectionDaysInNextAndPreviousMonths||s.push("is-selection-disabled");else return'<td class="is-empty"></td>';return a.isDisabled&&s.push("is-disabled"),a.isToday&&s.push("is-today"),a.isSelected&&(s.push("is-selected"),c="true"),a.hasEvent&&s.push("has-event"),a.isInRange&&s.push("is-inrange"),a.isStartRange&&s.push("is-startrange"),a.isEndRange&&s.push("is-endrange"),'<td data-day="'+a.day+'" class="'+s.join(" ")+'" aria-selected="'+c+'"><button class="pika-button pika-day" type="button" data-pika-year="'+a.year+'" data-pika-month="'+a.month+'" data-pika-day="'+a.day+'">'+a.day+"</button></td>"},isoWeek=function(a,s){a.setHours(0,0,0,0);let c=a.getDate(),u=a.getDay(),d=s,h=d-1,f=7,g=function(E){return(E+f-1)%f};a.setDate(c+h-g(u));let m=new Date(a.getFullYear(),0,d),p=1440*60*1e3,v=(a.getTime()-m.getTime())/p;return 1+Math.round((v-h+g(m.getDay()))/f)},renderWeek=function(a,s,c,u,d){let h=new Date(u,c,s);return'<td class="pika-week">'+(a.hasMoment?a.moment(h).isoWeek():isoWeek(h,d))+"</td>"},renderRow=function(a,s,c,u){return'<tr class="pika-row'+(c?" pick-whole-week":"")+(u?" is-selected":"")+'">'+(s?a.reverse():a).join("")+"</tr>"},renderBody=function(a){return"<tbody>"+a.join("")+"</tbody>"},renderHead=function(a){let s,c=[];for(a.showWeekNumber&&c.push("<th></th>"),s=0;s<7;s++)c.push('<th scope="col"><abbr title="'+renderDayName(a,s)+'">'+renderDayName(a,s,!0)+"</abbr></th>");return"<thead><tr>"+(a.isRTL?c.reverse():c).join("")+"</tr></thead>"},renderTitle=function(a,s,c,u,d,h){let f,g,m,p=a._o,v=c===p.minYear,w=c===p.maxYear,E='<div id="'+h+'" class="pika-title" role="heading" aria-live="polite">',C,b,P=!0,R=!0;for(m=[],f=0;f<12;f++)m.push('<option value="'+(c===d?f-s:12+f-s)+'"'+(f===u?' selected="selected"':"")+(v&&f<p.minMonth||w&&f>p.maxMonth?' disabled="disabled"':"")+">"+p.i18n.months[f]+"</option>");for(C='<div class="pika-label">'+p.i18n.months[u]+'<select class="pika-select pika-select-month" tabindex="-1">'+m.join("")+"</select></div>",isArray(p.yearRange)?(f=p.yearRange[0],g=p.yearRange[1]+1):(f=c-p.yearRange,g=1+c+p.yearRange),m=[];f<g&&f<=p.maxYear;f++)f>=p.minYear&&m.push('<option value="'+f+'"'+(f===c?' selected="selected"':"")+">"+f+"</option>");return b='<div class="pika-label">'+c+p.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+m.join("")+"</select></div>",p.showMonthAfterYear?E+=b+C:E+=C+b,v&&(u===0||p.minMonth>=u)&&(P=!1),w&&(u===11||p.maxMonth<=u)&&(R=!1),s===0&&(E+='<button class="pika-prev'+(P?"":" is-disabled")+'" type="button">'+p.i18n.previousMonth+"</button>"),s===a._o.numberOfMonths-1&&(E+='<button class="pika-next'+(R?"":" is-disabled")+'" type="button">'+p.i18n.nextMonth+"</button>"),E+="</div>"},renderTable=function(a,s,c){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+c+'">'+renderHead(a)+renderBody(s)+"</table>"};function Pikaday(a){let s=this,c=s.config(a);s._onMouseDown=function(d){if(!s._v)return;d=d||getWindow().event;let h=d.target||d.srcElement;if(h)if(hasClass(h,"is-disabled")||(hasClass(h,"pika-button")&&!hasClass(h,"is-empty")&&!hasClass(h.parentNode,"is-disabled")?(s.setDate(new Date(h.getAttribute("data-pika-year"),h.getAttribute("data-pika-month"),h.getAttribute("data-pika-day"))),c.bound&&sto(function(){s.hide(),c.blurFieldOnSelect&&c.field&&c.field.blur()},100)):hasClass(h,"pika-prev")?s.prevMonth():hasClass(h,"pika-next")&&s.nextMonth()),hasClass(h,"pika-select"))s._c=!0;else if(d.preventDefault)d.preventDefault();else return d.returnValue=!1,!1},s._onChange=function(d){d=d||getWindow().event;let h=d.target||d.srcElement;h&&(hasClass(h,"pika-select-month")?s.gotoMonth(h.value):hasClass(h,"pika-select-year")&&s.gotoYear(h.value))},s._onKeyChange=function(d){if(d=d||getWindow().event,s.isVisible())switch(d.keyCode){case 13:case 27:c.field&&c.field.blur();break;case 37:s.adjustDate("subtract",1);break;case 38:s.adjustDate("subtract",7);break;case 39:s.adjustDate("add",1);break;case 40:s.adjustDate("add",7);break;case 8:case 46:s.setDate(null);break}},s._parseFieldValue=function(){if(c.parse)return c.parse(c.field.value,c.format);if(this.hasMoment){let d=this.moment(c.field.value,c.format,c.formatStrict);return d&&d.isValid()?d.toDate():null}else return new Date(Date.parse(c.field.value))},s._onInputChange=function(d){let h;d.firedBy!==s&&(h=s._parseFieldValue(),isDate$1(h)&&s.setDate(h),s._v||s.show())},s._onInputFocus=function(){s.show()},s._onInputClick=function(){s.show()},s._onInputBlur=function(){let d=getDocument().activeElement;do if(hasClass(d,"pika-single"))return;while(d=d.parentNode);s._c||(s._b=sto(function(){s.hide()},50)),s._c=!1},s._onClick=function(d){d=d||getWindow().event;let h=d.target||d.srcElement,f=h;if(h){!hasEventListeners&&hasClass(h,"pika-select")&&(h.onchange||(h.setAttribute("onchange","return;"),addEvent$1(h,"change",s._onChange)));do if(hasClass(f,"pika-single")||f===c.trigger)return;while(f=f.parentNode);s._v&&h!==c.trigger&&f!==c.trigger&&s.hide()}},s.el=getDocument().createElement("div"),s.el.className="pika-single"+(c.isRTL?" is-rtl":"")+(c.theme?" "+c.theme:""),addEvent$1(s.el,"mousedown",s._onMouseDown,!0),addEvent$1(s.el,"touchend",s._onMouseDown,!0),addEvent$1(s.el,"change",s._onChange),c.keyboardInput&&addEvent$1(getDocument(),"keydown",s._onKeyChange),c.field&&(c.container?c.container.appendChild(s.el):c.bound?getDocument().body.appendChild(s.el):c.field.parentNode.insertBefore(s.el,c.field.nextSibling),addEvent$1(c.field,"change",s._onInputChange),c.defaultDate||(c.defaultDate=s._parseFieldValue(),c.setDefaultDate=!0));let u=c.defaultDate;isDate$1(u)?c.setDefaultDate?s.setDate(u,!0):s.gotoDate(u):s.gotoDate(new Date),c.bound?(this.hide(),s.el.className+=" is-bound",addEvent$1(c.trigger,"click",s._onInputClick),addEvent$1(c.trigger,"focus",s._onInputFocus),addEvent$1(c.trigger,"blur",s._onInputBlur)):this.show()}Pikaday.prototype={config:function(a){this._o||(this._o=extend({},defaults,!0));let s=extend(this._o,a,!0);s.isRTL=!!s.isRTL,s.field=s.field&&s.field.nodeName?s.field:null,s.theme=typeof s.theme=="string"&&s.theme?s.theme:null,s.bound=!!(s.bound!==void 0?s.field&&s.bound:s.field),s.trigger=s.trigger&&s.trigger.nodeName?s.trigger:s.field,s.disableWeekends=!!s.disableWeekends,s.disableDayFn=typeof s.disableDayFn=="function"?s.disableDayFn:null;let c=parseInt(s.numberOfMonths,10)||1;if(s.numberOfMonths=c>4?4:c,isDate$1(s.minDate)||(s.minDate=!1),isDate$1(s.maxDate)||(s.maxDate=!1),s.minDate&&s.maxDate&&s.maxDate<s.minDate&&(s.maxDate=s.minDate=!1),s.minDate&&this.setMinDate(s.minDate),s.maxDate&&this.setMaxDate(s.maxDate),isArray(s.yearRange)){let u=new Date().getFullYear()-10;s.yearRange[0]=parseInt(s.yearRange[0],10)||u,s.yearRange[1]=parseInt(s.yearRange[1],10)||u}else s.yearRange=Math.abs(parseInt(s.yearRange,10))||defaults.yearRange,s.yearRange>100&&(s.yearRange=100);return s},toString:function(a){return a=a||this._o.format,isDate$1(this._d)?this._o.toString?this._o.toString(this._d,a):this.hasMoment?this.moment(this._d).format(a):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(a,s){this.hasMoment&&this.moment.isMoment(a)&&this.setDate(a.toDate(),s)},useMoment:function(a){this.hasMoment=!0,this.moment=a},getDate:function(){return isDate$1(this._d)?new Date(this._d.getTime()):null},setDate:function(a,s){if(!a)return this._d=null,this._o.field&&(this._o.field.value="",fireEvent(this._o.field,"change",{firedBy:this})),this.draw();if(typeof a=="string"&&(a=new Date(Date.parse(a))),!isDate$1(a))return;let c=this._o.minDate,u=this._o.maxDate;isDate$1(c)&&a<c?a=c:isDate$1(u)&&a>u&&(a=u),this._d=new Date(a.getTime()),setToStartOfDay(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fireEvent(this._o.field,"change",{firedBy:this})),!s&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(a){let s=!0;if(isDate$1(a)){if(this.calendars){let c=new Date(this.calendars[0].year,this.calendars[0].month,1),u=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),d=a.getTime();u.setMonth(u.getMonth()+1),u.setDate(u.getDate()-1),s=d<c.getTime()||u.getTime()<d}s&&(this.calendars=[{month:a.getMonth(),year:a.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(a,s){let c=this.getDate()||new Date,u=parseInt(s)*24*60*60*1e3,d;a==="add"?d=new Date(c.valueOf()+u):a==="subtract"&&(d=new Date(c.valueOf()-u)),this.setDate(d)},adjustCalendars:function(){this.calendars[0]=adjustCalendar(this.calendars[0]);for(let a=1;a<this._o.numberOfMonths;a++)this.calendars[a]=adjustCalendar({month:this.calendars[0].month+a,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(a){isNaN(a)||(this.calendars[0].month=parseInt(a,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(a){isNaN(a)||(this.calendars[0].year=parseInt(a,10),this.adjustCalendars())},setMinDate:function(a){a instanceof Date?(setToStartOfDay(a),this._o.minDate=a,this._o.minYear=a.getFullYear(),this._o.minMonth=a.getMonth()):(this._o.minDate=defaults.minDate,this._o.minYear=defaults.minYear,this._o.minMonth=defaults.minMonth,this._o.startRange=defaults.startRange),this.draw()},setMaxDate:function(a){a instanceof Date?(setToStartOfDay(a),this._o.maxDate=a,this._o.maxYear=a.getFullYear(),this._o.maxMonth=a.getMonth()):(this._o.maxDate=defaults.maxDate,this._o.maxYear=defaults.maxYear,this._o.maxMonth=defaults.maxMonth,this._o.endRange=defaults.endRange),this.draw()},setStartRange:function(a){this._o.startRange=a},setEndRange:function(a){this._o.endRange=a},draw:function(a){if(!this._v&&!a)return;let s=this._o,c=s.minYear,u=s.maxYear,d=s.minMonth,h=s.maxMonth,f="",g;this._y<=c&&(this._y=c,!isNaN(d)&&this._m<d&&(this._m=d)),this._y>=u&&(this._y=u,!isNaN(h)&&this._m>h&&(this._m=h));for(let m=0;m<s.numberOfMonths;m++)g="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),f+='<div class="pika-lendar">'+renderTitle(this,m,this.calendars[m].year,this.calendars[m].month,this.calendars[0].year,g)+this.render(this.calendars[m].year,this.calendars[m].month,g)+"</div>";this.el.innerHTML=f,s.bound&&s.field.type!=="hidden"&&sto(function(){s.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),s.bound&&s.field.setAttribute("aria-label",s.ariaLabel)},adjustPosition:function(){let a,s,c,u,d,h,f,g,m,p,v;this._o.container||(this.el.style.position="absolute",a=this._o.trigger,s=this.el.offsetWidth,c=this.el.offsetHeight,u=getWindow().innerWidth||getDocument().documentElement.clientWidth,d=getWindow().innerHeight||getDocument().documentElement.clientHeight,h=getDocument().body.scrollTop||getDocument().documentElement.scrollTop,p=!0,v=!0,m=a.getBoundingClientRect(),f=m.left+getWindow().pageXOffset,g=m.bottom+getWindow().pageYOffset,(this._o.reposition&&f+s>u||this._o.position.indexOf("right")>-1&&f-s+a.offsetWidth>0)&&(f=f-s+a.offsetWidth,p=!1),(this._o.reposition&&g+c>d+h||this._o.position.indexOf("top")>-1&&g-c-a.offsetHeight>0)&&(g=g-c-a.offsetHeight,v=!1),f<0&&(f=0),g<0&&(g=0),this.el.style.left=f+"px",this.el.style.top=g+"px",addClass(this.el,p?"left-aligned":"right-aligned"),addClass(this.el,v?"bottom-aligned":"top-aligned"),removeClass(this.el,p?"right-aligned":"left-aligned"),removeClass(this.el,v?"top-aligned":"bottom-aligned"))},render:function(a,s,c){let u=this._o,d=new Date,h=getDaysInMonth(a,s),f=new Date(a,s,1).getDay(),g=[],m=[];setToStartOfDay(d),u.firstDay>0&&(f-=u.firstDay,f<0&&(f+=7));let p=s===0?11:s-1,v=s===11?0:s+1,w=s===0?a-1:a,E=s===11?a+1:a,C=getDaysInMonth(w,p),b=h+f,P=b;for(;P>7;)P-=7;b+=7-P;let R=!1;for(let T=0,I=0;T<b;T++){let M=new Date(a,s,1+(T-f)),N=isDate$1(this._d)?compareDates(M,this._d):!1,H=compareDates(M,d),L=u.events.indexOf(M.toDateString())!==-1,A=T<f||T>=h+f,k=1+(T-f),W=s,G=a,oe=u.startRange&&compareDates(u.startRange,M),ae=u.endRange&&compareDates(u.endRange,M),X=u.startRange&&u.endRange&&u.startRange<M&&M<u.endRange,le=u.minDate&&M<u.minDate||u.maxDate&&M>u.maxDate||u.disableWeekends&&isWeekend(M)||u.disableDayFn&&u.disableDayFn(M);A&&(T<f?(k=C+k,W=p,G=w):(k=k-h,W=v,G=E));let ye={day:k,month:W,year:G,hasEvent:L,isSelected:N,isToday:H,isDisabled:le,isEmpty:A,isStartRange:oe,isEndRange:ae,isInRange:X,showDaysInNextAndPreviousMonths:u.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:u.enableSelectionDaysInNextAndPreviousMonths};u.pickWholeWeek&&N&&(R=!0),m.push(renderDay(ye)),++I===7&&(u.showWeekNumber&&m.unshift(renderWeek(this,T-f,s,a,u.firstWeekOfYearMinDays)),g.push(renderRow(m,u.isRTL,u.pickWholeWeek,R)),m=[],I=0,R=!1)}return renderTable(u,g,c)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),removeClass(this.el,"is-hidden"),this._o.bound&&(addEvent$1(getDocument(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let a=this._v;a!==!1&&(this._o.bound&&removeEvent(getDocument(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),addClass(this.el,"is-hidden"),this._v=!1,a!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let a=this._o;this.hide(),removeEvent(this.el,"mousedown",this._onMouseDown,!0),removeEvent(this.el,"touchend",this._onMouseDown,!0),removeEvent(this.el,"change",this._onChange),a.keyboardInput&&removeEvent(getDocument(),"keydown",this._onKeyChange),a.field&&(removeEvent(a.field,"change",this._onInputChange),a.bound&&(removeEvent(a.trigger,"click",this._onInputClick),removeEvent(a.trigger,"focus",this._onInputFocus),removeEvent(a.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function _classPrivateMethodInitSpec$P(a,s){_checkPrivateRedeclaration$11(a,s),s.add(a)}function _checkPrivateRedeclaration$11(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$1d(a,s,c){return(s=_toPropertyKey$1d(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1d(a){var s=_toPrimitive$1d(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1d(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$11(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const EDITOR_TYPE$5="date",SHORTCUTS_GROUP_EDITOR="dateEditor",DEFAULT_DATE_FORMAT="DD/MM/YYYY";var _DateEditor_brand=new WeakSet;class DateEditor extends TextEditor{constructor(){super(...arguments),_classPrivateMethodInitSpec$P(this,_DateEditor_brand),_defineProperty$1d(this,"parentDestroyed",!1),_defineProperty$1d(this,"$datePicker",null)}static get EDITOR_TYPE(){return EDITOR_TYPE$5}init(){if(typeof hooks!="function")throw new Error("You need to include moment.js to your project.");if(typeof Pikaday!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(s,c)=>{c||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),addClass$1(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",s=>{hasClass$1(s.target,"pika-day")&&this.hideDatepicker(),s.stopPropagation()})}destroyElements(){const s=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),s&&s.removeChild(this.datePicker)}prepare(s,c,u,d,h,f){super.prepare(s,c,u,d,h,f)}open(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const u=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(s),super.open(),u.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:SHORTCUTS_GROUP_EDITOR})}close(){var s;(s=this.$datePicker)!==null&&s!==void 0&&s.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const d=this.hot._getEditorManager();d.closeEditor(),this.hot.view.render(),d.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP_EDITOR),super.close()}finishEditing(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(s,c)}showDatepicker(s){const c=_assertClassBrand$11(_DateEditor_brand,this,_getDateFormat).call(this),u=this.hot.view.isMouseDown(),d=s?isFunctionKey(s.keyCode):!1;let h;this.datePicker.style.display="block",this.$datePicker=new Pikaday(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(hooks),this.$datePicker._onInputFocus=function(){},this.originalValue?(h=this.originalValue,hooks(h,c,!0).isValid()&&this.$datePicker.setMoment(hooks(h,c),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!d&&!u&&this.setValue("")):this.cellProperties.defaultDate?(h=this.cellProperties.defaultDate,hooks(h,c,!0).isValid()&&this.$datePicker.setMoment(hooks(h,c),!0),!d&&!u&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var s;const c=this.TEXTAREA,u={};this.cellProperties&&this.cellProperties.datePickerConfig&&deepExtend(u,this.cellProperties.datePickerConfig);const d=u.onSelect,h=u.onClose;return u.field=c,u.trigger=c,u.container=this.datePicker,u.bound=!1,u.keyboardInput=!1,u.format=(s=u.format)!==null&&s!==void 0?s:_assertClassBrand$11(_DateEditor_brand,this,_getDateFormat).call(this),u.reposition=u.reposition||!1,u.isRTL=!1,u.onSelect=f=>{let g=f;isNaN(g.getTime())||(g=hooks(g).format(_assertClassBrand$11(_DateEditor_brand,this,_getDateFormat).call(this))),this.setValue(g),d&&d(),isMobileBrowser()&&this.hideDatepicker()},u.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),h&&h()},u}refreshDimensions(s){var c;if(super.refreshDimensions(s),this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:u,columnIndexMapper:d}=this.hot,{wtOverlays:h}=this.hot.view._wt,{wtTable:f}=(c=h.getParentOverlay(this.TD))!==null&&c!==void 0?c:this.hot.view._wt,g=u.getVisualFromRenderableIndex(f.getFirstPartiallyVisibleRow()),m=u.getVisualFromRenderableIndex(f.getLastPartiallyVisibleRow()),p=d.getVisualFromRenderableIndex(f.getFirstPartiallyVisibleColumn()),v=d.getVisualFromRenderableIndex(f.getLastPartiallyVisibleColumn());if(this.row>=g&&this.row<=m&&this.col>=p&&this.col<=v){const w=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+w.top+outerHeight(this.TD)}px`;let E=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?E+=w.right-outerWidth(this.datePicker):E+=w.left,this.datePickerStyle.left=`${E}px`}else this.hideDatepicker()}}function _getDateFormat(){var a;return(a=this.cellProperties.dateFormat)!==null&&a!==void 0?a:DEFAULT_DATE_FORMAT}const EDITOR_TYPE$4="dropdown";class DropdownEditor extends AutocompleteEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$4}prepare(s,c,u,d,h,f){f.filter=!1,f.strict=!0,super.prepare(s,c,u,d,h,f)}}const EDITOR_TYPE$3="numeric";class NumericEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$3}}function _defineProperty$1c(a,s,c){return(s=_toPropertyKey$1c(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1c(a){var s=_toPrimitive$1c(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1c(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const EDITOR_TYPE$2="password";class PasswordEditor extends TextEditor{constructor(){super(...arguments),_defineProperty$1c(this,"autoResize",createInputElementResizer(this.hot.rootDocument,{textContent:s=>"•".repeat(s.value.length)}))}static get EDITOR_TYPE(){return EDITOR_TYPE$2}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,empty(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...A11Y_TABINDEX(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const EDITOR_VISIBLE_CLASS_NAME="ht_editor_visible",SHORTCUTS_GROUP$e="selectEditor",EDITOR_TYPE$1="select";class SelectEditor extends BaseEditor{static get EDITOR_TYPE(){return EDITOR_TYPE$1}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const s=this.hot.rootDocument.createElement("DIV"),c=this.hot.getSettings().ariaTags;s.className="htAutocompleteArrow",c&&s.setAttribute(...A11Y_HIDDEN()),s.appendChild(this.hot.rootDocument.createTextNode("▼")),addClass$1(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(s,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(s){this.select.value=s}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",hasClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)&&removeClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(s,c,u,d,h,f){super.prepare(s,c,u,d,h,f);const g=this.cellProperties.selectOptions;let m;typeof g=="function"?m=this.prepareOptions(g(this.row,this.col,this.prop)):m=this.prepareOptions(g),empty(this.select),objectEach(m,(p,v)=>{const w=this.hot.rootDocument.createElement("OPTION");w.value=v,fastInnerHTML(w,p),this.select.appendChild(w)})}prepareOptions(s){let c={};if(Array.isArray(s))for(let u=0,d=s.length;u<d;u++)c[s[u]]=s[u];else typeof s=="object"&&(c=s);return c}refreshValue(){const s=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=s,this.setValue(s),this.refreshDimensions()}refreshDimensions(){if(this.state!==EDITOR_STATE.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:s,start:c,width:u,height:d}=this.getEditedCellRect(),h=this.selectWrapper.style;h.height=`${d}px`,h.width=`${u}px`,h.top=`${s}px`,h[this.hot.isRtl()?"right":"left"]=`${c}px`,h.margin="0px",addClass$1(this.selectWrapper,EDITOR_VISIBLE_CLASS_NAME)}registerShortcuts(){const c=this.hot.getShortcutManager().getContext("editor"),u={group:SHORTCUTS_GROUP$e};this.isInFullEditMode()&&c.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const d=this.select.selectedIndex-1;d>=0&&(this.select[d].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const d=this.select.selectedIndex+1;d<=this.select.length-1&&(this.select[d].selected=!0)}}],u)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(SHORTCUTS_GROUP$e)}}const EDITOR_TYPE="time";class TimeEditor extends TextEditor{static get EDITOR_TYPE(){return EDITOR_TYPE}prepare(s,c,u,d,h,f){super.prepare(s,c,u,d,h,f),this.TEXTAREA.dir="ltr"}}function registerAllEditors(){_register$3(BaseEditor),_register$3(AutocompleteEditor),_register$3(CheckboxEditor),_register$3(DateEditor),_register$3(DropdownEditor),_register$3(HandsontableEditor),_register$3(NumericEditor),_register$3(PasswordEditor),_register$3(SelectEditor),_register$3(TextEditor),_register$3(TimeEditor)}const RENDERER_TYPE$9="html";function htmlRenderer(a,s,c,u,d,h,f){baseRenderer.apply(this,[a,s,c,u,d,h,f]),fastInnerHTML(s,h??"",!1)}htmlRenderer.RENDERER_TYPE=RENDERER_TYPE$9;const RENDERER_TYPE$8="autocomplete";function autocompleteRenderer(a,s,c,u,d,h,f){const{rootDocument:g}=a,m=f.allowHtml?htmlRenderer:textRenderer,p=g.createElement("DIV"),v=a.getSettings().ariaTags;if(p.className="htAutocompleteArrow",v&&p.setAttribute(...A11Y_HIDDEN()),p.appendChild(g.createTextNode("▼")),m.apply(this,[a,s,c,u,d,h,f]),s.firstChild||s.appendChild(g.createTextNode(" ")),s.insertBefore(p,s.firstChild),addClass$1(s,"htAutocomplete"),!a.acArrowListener){const w=new EventManager(a);a.acArrowListener=function(E){hasClass$1(E.target,"htAutocompleteArrow")&&a.view._wt.getSetting("onCellDblClick",null,a._createCellCoords(c,u),s)},w.addEventListener(a.rootElement,"mousedown",a.acArrowListener),a.addHookOnce("afterDestroy",()=>{w.destroy()})}}autocompleteRenderer.RENDERER_TYPE=RENDERER_TYPE$8;const RENDERER_TYPE$7="dropdown";function dropdownRenderer(a,s,c,u,d,h,f){autocompleteRenderer.apply(this,[a,s,c,u,d,h,f])}dropdownRenderer.RENDERER_TYPE=RENDERER_TYPE$7;const isListeningKeyDownEvent=new WeakMap,isCheckboxListenerAdded=new WeakMap,BAD_VALUE_CLASS="htBadValue",ATTR_ROW="data-row",ATTR_COLUMN="data-col",SHORTCUTS_GROUP$d="checkboxRenderer",RENDERER_TYPE$6="checkbox";Hooks.getSingleton().add("modifyAutoColumnSizeSeed",function(a,s,c){const{label:u,type:d,row:h,column:f,prop:g}=s;if(d!==RENDERER_TYPE$6||!u)return;const{value:m,property:p}=u;let v=c;if(m)v=typeof m=="function"?m(h,f,g,c):m;else if(p){const w=this.getDataAtRowProp(h,p);v=w!==null?w:c}return`${stringify$1(v).length}`});function checkboxRenderer(a,s,c,u,d,h,f){const{rootDocument:g}=a,m=a.getSettings().ariaTags;baseRenderer.apply(this,[a,s,c,u,d,h,f]),registerEvents(a);let p=createInput(g);const v=f.label;let w=!1;if(typeof f.checkedTemplate>"u"&&(f.checkedTemplate=!0),typeof f.uncheckedTemplate>"u"&&(f.uncheckedTemplate=!1),empty(s),h===f.checkedTemplate||stringify$1(h).toLocaleLowerCase(f.locale)===stringify$1(f.checkedTemplate).toLocaleLowerCase(f.locale)?p.checked=!0:h===f.uncheckedTemplate||stringify$1(h).toLocaleLowerCase(f.locale)===stringify$1(f.uncheckedTemplate).toLocaleLowerCase(f.locale)?p.checked=!1:isEmpty(h)?addClass$1(p,"noValue"):(p.style.display="none",addClass$1(p,BAD_VALUE_CLASS),w=!0),setAttribute(p,[[ATTR_ROW,c],[ATTR_COLUMN,u]]),m&&setAttribute(p,[A11Y_LABEL(p.checked?a.getTranslatedPhrase(CHECKBOX_CHECKED):a.getTranslatedPhrase(CHECKBOX_UNCHECKED)),A11Y_CHECKED(p.checked),A11Y_CHECKBOX()]),!w&&v){let P="";if(v.value)P=typeof v.value=="function"?v.value.call(this,c,u,d,h):v.value;else if(v.property){const T=a.getDataAtRowProp(c,v.property);P=T!==null?T:""}const R=createLabel(g,P,v.separated!==!0);v.position==="before"?v.separated?(s.appendChild(R),s.appendChild(p)):(R.appendChild(p),p=R):(!v.position||v.position==="after")&&(v.separated?(s.appendChild(p),s.appendChild(R)):(R.insertBefore(p,R.firstChild),p=R))}(!v||v&&!v.separated)&&s.appendChild(p),w&&s.appendChild(g.createTextNode("#bad-value#")),isListeningKeyDownEvent.has(a)||(isListeningKeyDownEvent.set(a,!0),E());function E(){const R=a.getShortcutManager().getContext("grid"),T={group:SHORTCUTS_GROUP$d,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"};R.addShortcuts([{keys:[["space"]],callback:()=>(C(),!b()),runOnlyIf:()=>{var I;return(I=a.getSelectedRangeActive())===null||I===void 0?void 0:I.highlight.isCell()}},{keys:[["enter"]],callback:()=>(C(),!b()),runOnlyIf:()=>{const I=a.getSelectedRangeActive();return a.getSettings().enterBeginsEditing&&I?.highlight.isCell()&&!a.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(C(!0),!b()),runOnlyIf:()=>{var I;return(I=a.getSelectedRangeActive())===null||I===void 0?void 0:I.highlight.isCell()}}],T)}function C(){let P=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const R=a.getSelectedRange(),T=[],I=new Map;let M=[],N=0;if(R){for(let H=0;H<R.length;H++){const{row:L,col:A}=R[H].getTopStartCorner(),{row:k,col:W}=R[H].getBottomEndCorner();for(let G=L;G<=k;G+=1)for(let oe=A;oe<=W;oe+=1){const ae=a.getCellMeta(G,oe);if(ae.hidden)continue;const X={checkedTemplate:ae.checkedTemplate,uncheckedTemplate:ae.uncheckedTemplate};if(ae.type!=="checkbox"){P===!0&&!ae.readOnly&&(I.has(T.length)?I.set(T.length,[...I.get(T.length),[G,oe,null]]):I.set(T.length,[[G,oe,null]]));continue}if(ae.readOnly===!0)continue;typeof ae.checkedTemplate>"u"&&(ae.checkedTemplate=!0),typeof ae.uncheckedTemplate>"u"&&(ae.uncheckedTemplate=!1);const le=a.getDataAtCell(G,oe);P===!1?[ae.checkedTemplate,ae.checkedTemplate.toString()].includes(le)?M.push([G,oe,ae.uncheckedTemplate,X]):[ae.uncheckedTemplate,ae.uncheckedTemplate.toString(),null,void 0].includes(le)&&M.push([G,oe,ae.checkedTemplate,X]):M.push([G,oe,ae.uncheckedTemplate,X]),N+=1}T.push(N),N=0}M.every(H=>{let[,,L]=H;return L===M[0][2]})?M=M.map(H=>{let[L,A,k]=H;return[L,A,k]}):M=M.map(H=>{let[L,A,,k]=H;return[L,A,k.checkedTemplate]}),M.length>0&&T.forEach((H,L)=>{let A=M.splice(0,H);I.size&&I.has(L)&&(A=[...A,...I.get(L)]),a.setDataAtCell(A)})}}function b(){const P=a.getSelectedRange();if(P){for(let R=0;R<P.length;R++){const T=P[R].getTopStartCorner(),I=P[R].getBottomEndCorner();for(let M=T.row;M<=I.row;M++)for(let N=T.col;N<=I.col;N++){if(a.getCellMeta(M,N).readOnly)continue;const L=a.getCell(M,N);if(isHTMLElement(L)&&L.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}checkboxRenderer.RENDERER_TYPE=RENDERER_TYPE$6;function registerEvents(a){let s=isCheckboxListenerAdded.get(a);if(!s){const{rootElement:c}=a;s=new EventManager(a),s.addEventListener(c,"click",u=>onClick(u,a)),s.addEventListener(c,"mouseup",u=>onMouseUp(u,a)),s.addEventListener(c,"change",u=>onChange(u,a)),isCheckboxListenerAdded.set(a,s)}return s}function createInput(a){const s=a.createElement("input");return s.className="htCheckboxRendererInput",s.type="checkbox",s.setAttribute("tabindex","-1"),s.cloneNode(!1)}function createLabel(a,s,c){const u=a.createElement("label");u.className=`htCheckboxRendererLabel ${c?"fullWidth":""}`;const d=a.createTextNode(s);if(c){const h=a.createElement("span");h.appendChild(d),u.appendChild(h)}else u.appendChild(d);return u.cloneNode(!0)}function onMouseUp(a,s){const{target:c}=a;isCheckboxInput(c)&&(!c.hasAttribute(ATTR_ROW)||!c.hasAttribute(ATTR_COLUMN)||setTimeout(s.listen,10))}function onClick(a,s){const{target:c}=a;if(!isCheckboxInput(c)||!c.hasAttribute(ATTR_ROW)||!c.hasAttribute(ATTR_COLUMN))return;const u=parseInt(c.getAttribute(ATTR_ROW),10),d=parseInt(c.getAttribute(ATTR_COLUMN),10);s.getCellMeta(u,d).readOnly&&a.preventDefault()}function onChange(a,s){const{target:c}=a;if(!isCheckboxInput(c)||!c.hasAttribute(ATTR_ROW)||!c.hasAttribute(ATTR_COLUMN))return;const u=parseInt(c.getAttribute(ATTR_ROW),10),d=parseInt(c.getAttribute(ATTR_COLUMN),10),h=s.getCellMeta(u,d);if(!h.readOnly){let f=null;a.target.checked?f=h.uncheckedTemplate===void 0?!0:h.checkedTemplate:f=h.uncheckedTemplate===void 0?!1:h.uncheckedTemplate,s.setDataAtCell(u,d,f)}}function isCheckboxInput(a){return a.tagName==="INPUT"&&a.getAttribute("type")==="checkbox"}const RENDERER_TYPE$5="handsontable";function handsontableRenderer(a,s,c,u,d,h,f){autocompleteRenderer.apply(this,[a,s,c,u,d,h,f])}handsontableRenderer.RENDERER_TYPE=RENDERER_TYPE$5;var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var enUS,hasRequiredEnUS;function requireEnUS(){return hasRequiredEnUS||(hasRequiredEnUS=1,enUS={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(a){let s=a%10;return~~(a%100/10)===1?"th":s===1?"st":s===2?"nd":s===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),enUS}var unformatting,hasRequiredUnformatting;function requireUnformatting(){if(hasRequiredUnformatting)return unformatting;hasRequiredUnformatting=1;const a=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function s(m){return m.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function c(m,p,v,w,E,C,b){if(!isNaN(+m))return+m;let P="",R=m.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(R!==m)return-1*c(R,p,v,w,E,C);for(let L=0;L<a.length;L++){let A=a[L];if(P=m.replace(RegExp(`([0-9 ])(${A.key})$`),"$1"),P!==m)return c(P,p,v,w,E,C)*A.factor}if(P=m.replace("%",""),P!==m)return c(P,p,v,w,E,C)/100;let T=parseFloat(m);if(isNaN(T))return;let I=w(T);if(I&&I!=="."&&(P=m.replace(new RegExp(`${s(I)}$`),""),P!==m))return c(P,p,v,w,E,C);let M={};Object.keys(C).forEach(L=>{M[C[L]]=L});let N=Object.keys(M).sort().reverse(),H=N.length;for(let L=0;L<H;L++){let A=N[L],k=M[A];if(P=m.replace(A,""),P!==m){let W;switch(k){case"thousand":W=Math.pow(10,3);break;case"million":W=Math.pow(10,6);break;case"billion":W=Math.pow(10,9);break;case"trillion":W=Math.pow(10,12);break}return c(P,p,v,w,E,C)*W}}}function u(m,p,v){let w=m.replace(v,"");return w=w.replace(new RegExp(`([0-9])${s(p.thousands)}([0-9])`,"g"),"$1$2"),w=w.replace(p.decimal,"."),w}function d(m,p,v="",w,E,C,b){if(m==="")return;if(m===E)return 0;let P=u(m,p,v);return c(P,p,v,w,E,C)}function h(m,p){if(!(m.indexOf(":")&&p.thousands!==":"))return!1;let w=m.split(":");if(w.length!==3)return!1;let E=+w[0],C=+w[1],b=+w[2];return!isNaN(E)&&!isNaN(C)&&!isNaN(b)}function f(m){let p=m.split(":"),v=+p[0],w=+p[1];return+p[2]+60*w+3600*v}function g(m,p){const v=requireGlobalState();let w=v.currentDelimiters(),E=v.currentCurrency().symbol,C=v.currentOrdinal(),b=v.getZeroFormat(),P=v.currentAbbreviations(),R;if(typeof m=="string")h(m,w)?R=f(m):R=d(m,w,E,C,b,P);else if(typeof m=="number")R=m;else return;if(R!==void 0)return R}return unformatting={unformat:g},unformatting}var validating$1,hasRequiredValidating;function requireValidating(){if(hasRequiredValidating)return validating$1;hasRequiredValidating=1;let a=requireUnformatting();const s=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,c=["currency","percent","byte","time","ordinal","number"],u=["trillion","billion","million","thousand"],d=["prefix","infix","postfix"],h=["sign","parenthesis"],f={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},p={output:{type:"string",validValues:c},base:{type:"string",validValues:["decimal","binary","general"],restriction:(R,T)=>T.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:R=>R.output==="byte"},characteristic:{type:"number",restriction:R=>R>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:u},average:"boolean",lowPrecision:{type:"boolean",restriction:(R,T)=>T.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:d},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:R=>R>=0,message:"value must be positive"},{restriction:(R,T)=>!T.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:R=>R>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:h},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(R,T)=>T.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},v={languageTag:{type:"string",mandatory:!0,restriction:R=>R.match(s),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:f,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function w(R,T){let I=E(R),M=b(T);return I&&M}function E(R){return a.unformat(R)!==void 0}function C(R,T,I,M=!1){let N=Object.keys(R).map(H=>{if(!T[H])return console.error(`${I} Invalid key: ${H}`),!1;let L=R[H],A=T[H];if(typeof A=="string"&&(A={type:A}),A.type==="format"){if(!C(L,p,`[Validate ${H}]`,!0))return!1}else if(typeof L!==A.type)return console.error(`${I} ${H} type mismatched: "${A.type}" expected, "${typeof L}" provided`),!1;if(A.restrictions&&A.restrictions.length){let k=A.restrictions.length;for(let W=0;W<k;W++){let{restriction:G,message:oe}=A.restrictions[W];if(!G(L,R))return console.error(`${I} ${H} invalid value: ${oe}`),!1}}return A.restriction&&!A.restriction(L,R)?(console.error(`${I} ${H} invalid value: ${A.message}`),!1):A.validValues&&A.validValues.indexOf(L)===-1?(console.error(`${I} ${H} invalid value: must be among ${JSON.stringify(A.validValues)}, "${L}" provided`),!1):!(A.children&&!C(L,A.children,`[Validate ${H}]`))});return M||N.push(...Object.keys(T).map(H=>{let L=T[H];if(typeof L=="string"&&(L={type:L}),L.mandatory){let A=L.mandatory;if(typeof A=="function"&&(A=A(R)),A&&R[H]===void 0)return console.error(`${I} Missing mandatory key "${H}"`),!1}return!0})),N.reduce((H,L)=>H&&L,!0)}function b(R){return C(R,p,"[Validate format]")}function P(R){return C(R,v,"[Validate language]")}return validating$1={validate:w,validateFormat:b,validateInput:E,validateLanguage:P},validating$1}function parsePrefix(a,s){let c=a.match(/^{([^}]*)}/);return c?(s.prefix=c[1],a.slice(c[0].length)):a}function parsePostfix(a,s){let c=a.match(/{([^}]*)}$/);return c?(s.postfix=c[1],a.slice(0,-c[0].length)):a}function parseOutput(a,s){if(a.indexOf("$")!==-1){s.output="currency";return}if(a.indexOf("%")!==-1){s.output="percent";return}if(a.indexOf("bd")!==-1){s.output="byte",s.base="general";return}if(a.indexOf("b")!==-1){s.output="byte",s.base="binary";return}if(a.indexOf("d")!==-1){s.output="byte",s.base="decimal";return}if(a.indexOf(":")!==-1){s.output="time";return}a.indexOf("o")!==-1&&(s.output="ordinal")}function parseThousandSeparated(a,s){a.indexOf(",")!==-1&&(s.thousandSeparated=!0)}function parseSpaceSeparated(a,s){a.indexOf(" ")!==-1&&(s.spaceSeparated=!0,s.spaceSeparatedCurrency=!0,(s.average||s.forceAverage)&&(s.spaceSeparatedAbbreviation=!0))}function parseTotalLength(a,s){let c=a.match(/[1-9]+[0-9]*/);c&&(s.totalLength=+c[0])}function parseCharacteristic(a,s){let u=a.split(".")[0].match(/0+/);u&&(s.characteristic=u[0].length)}function parseMantissa(a,s){let c=a.split(".")[1];if(c){let u=c.match(/0+/);u&&(s.mantissa=u[0].length)}}function parseTrimMantissa(a,s){const c=a.split(".")[1];c&&(s.trimMantissa=c.indexOf("[")!==-1)}function parseAverage(a,s){a.indexOf("a")!==-1&&(s.average=!0)}function parseForceAverage(a,s){a.indexOf("K")!==-1?s.forceAverage="thousand":a.indexOf("M")!==-1?s.forceAverage="million":a.indexOf("B")!==-1?s.forceAverage="billion":a.indexOf("T")!==-1&&(s.forceAverage="trillion")}function parseOptionalMantissa(a,s){a.match(/\[\.]/)?s.optionalMantissa=!0:a.match(/\./)&&(s.optionalMantissa=!1)}function parseOptionalCharacteristic(a,s){if(a.indexOf(".")!==-1){let c=a.split(".")[0];s.optionalCharacteristic=c.indexOf("0")===-1}}function parseNegative(a,s){a.match(/^\+?\([^)]*\)$/)&&(s.negative="parenthesis"),a.match(/^\+?-/)&&(s.negative="sign")}function parseForceSign(a,s){a.match(/^\+/)&&(s.forceSign=!0)}function parseFormat(a,s={}){return typeof a!="string"?a:(a=parsePrefix(a,s),a=parsePostfix(a,s),parseOutput(a,s),parseTotalLength(a,s),parseCharacteristic(a,s),parseOptionalCharacteristic(a,s),parseAverage(a,s),parseForceAverage(a,s),parseMantissa(a,s),parseOptionalMantissa(a,s),parseTrimMantissa(a,s),parseThousandSeparated(a,s),parseSpaceSeparated(a,s),parseNegative(a,s),parseForceSign(a,s),s)}var parsing$2={parseFormat};var globalState$2,hasRequiredGlobalState;function requireGlobalState(){if(hasRequiredGlobalState)return globalState$2;hasRequiredGlobalState=1;const a=requireEnUS(),s=requireValidating(),c=parsing$2;let u={},d,h={},f=null,g={};function m(v){d=v}function p(){return h[d]}return u.languages=()=>Object.assign({},h),u.currentLanguage=()=>d,u.currentBytes=()=>p().bytes||{},u.currentCurrency=()=>p().currency,u.currentAbbreviations=()=>p().abbreviations,u.currentDelimiters=()=>p().delimiters,u.currentOrdinal=()=>p().ordinal,u.currentDefaults=()=>Object.assign({},p().defaults,g),u.currentOrdinalDefaultFormat=()=>Object.assign({},u.currentDefaults(),p().ordinalFormat),u.currentByteDefaultFormat=()=>Object.assign({},u.currentDefaults(),p().byteFormat),u.currentPercentageDefaultFormat=()=>Object.assign({},u.currentDefaults(),p().percentageFormat),u.currentCurrencyDefaultFormat=()=>Object.assign({},u.currentDefaults(),p().currencyFormat),u.currentTimeDefaultFormat=()=>Object.assign({},u.currentDefaults(),p().timeFormat),u.setDefaults=v=>{v=c.parseFormat(v),s.validateFormat(v)&&(g=v)},u.getZeroFormat=()=>f,u.setZeroFormat=v=>f=typeof v=="string"?v:null,u.hasZeroFormat=()=>f!==null,u.languageData=v=>{if(v){if(h[v])return h[v];throw new Error(`Unknown tag "${v}"`)}return p()},u.registerLanguage=(v,w=!1)=>{if(!s.validateLanguage(v))throw new Error("Invalid language data");h[v.languageTag]=v,w&&m(v.languageTag)},u.setLanguage=(v,w=a.languageTag)=>{if(!h[v]){let E=v.split("-")[0],C=Object.keys(h).find(b=>b.split("-")[0]===E);if(!h[C]){m(w);return}m(C);return}m(v)},u.registerLanguage(a),d=a.languageTag,globalState$2=u,globalState$2}function commonjsRequire(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}function loadLanguagesInNode(a,s){a.forEach(c=>{let u;try{u=commonjsRequire(`../languages/${c}`)}catch{console.error(`Unable to load "${c}". No matching language file found.`)}u&&s.registerLanguage(u)})}var loading=a=>({loadLanguagesInNode:s=>loadLanguagesInNode(s,a)}),bignumber={exports:{}};(function(a){(function(s){var c,u=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,d=Math.ceil,h=Math.floor,f="[BigNumber Error] ",g=f+"Number primitive has more than 15 significant digits: ",m=1e14,p=14,v=9007199254740991,w=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],E=1e7,C=1e9;function b(L){var A,k,W,G=Pe.prototype={constructor:Pe,toString:null,valueOf:null},oe=new Pe(1),ae=20,X=4,le=-7,ye=21,pe=-1e7,he=1e7,Me=!1,Qe=1,Xe=0,Ke={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},it="0123456789abcdefghijklmnopqrstuvwxyz",te=!0;function Pe(K,ne){var de,Oe,Se,ge,De,$e,Fe,Ve,Be=this;if(!(Be instanceof Pe))return new Pe(K,ne);if(ne==null){if(K&&K._isBigNumber===!0){Be.s=K.s,!K.c||K.e>he?Be.c=Be.e=null:K.e<pe?Be.c=[Be.e=0]:(Be.e=K.e,Be.c=K.c.slice());return}if(($e=typeof K=="number")&&K*0==0){if(Be.s=1/K<0?(K=-K,-1):1,K===~~K){for(ge=0,De=K;De>=10;De/=10,ge++);ge>he?Be.c=Be.e=null:(Be.e=ge,Be.c=[K]);return}Ve=String(K)}else{if(!u.test(Ve=String(K)))return W(Be,Ve,$e);Be.s=Ve.charCodeAt(0)==45?(Ve=Ve.slice(1),-1):1}(ge=Ve.indexOf("."))>-1&&(Ve=Ve.replace(".","")),(De=Ve.search(/e/i))>0?(ge<0&&(ge=De),ge+=+Ve.slice(De+1),Ve=Ve.substring(0,De)):ge<0&&(ge=Ve.length)}else{if(I(ne,2,it.length,"Base"),ne==10&&te)return Be=new Pe(K),ce(Be,ae+Be.e+1,X);if(Ve=String(K),$e=typeof K=="number"){if(K*0!=0)return W(Be,Ve,$e,ne);if(Be.s=1/K<0?(Ve=Ve.slice(1),-1):1,Pe.DEBUG&&Ve.replace(/^0\.0*|\./,"").length>15)throw Error(g+K)}else Be.s=Ve.charCodeAt(0)===45?(Ve=Ve.slice(1),-1):1;for(de=it.slice(0,ne),ge=De=0,Fe=Ve.length;De<Fe;De++)if(de.indexOf(Oe=Ve.charAt(De))<0){if(Oe=="."){if(De>ge){ge=Fe;continue}}else if(!Se&&(Ve==Ve.toUpperCase()&&(Ve=Ve.toLowerCase())||Ve==Ve.toLowerCase()&&(Ve=Ve.toUpperCase()))){Se=!0,De=-1,ge=0;continue}return W(Be,String(K),$e,ne)}$e=!1,Ve=k(Ve,ne,10,Be.s),(ge=Ve.indexOf("."))>-1?Ve=Ve.replace(".",""):ge=Ve.length}for(De=0;Ve.charCodeAt(De)===48;De++);for(Fe=Ve.length;Ve.charCodeAt(--Fe)===48;);if(Ve=Ve.slice(De,++Fe)){if(Fe-=De,$e&&Pe.DEBUG&&Fe>15&&(K>v||K!==h(K)))throw Error(g+Be.s*K);if((ge=ge-De-1)>he)Be.c=Be.e=null;else if(ge<pe)Be.c=[Be.e=0];else{if(Be.e=ge,Be.c=[],De=(ge+1)%p,ge<0&&(De+=p),De<Fe){for(De&&Be.c.push(+Ve.slice(0,De)),Fe-=p;De<Fe;)Be.c.push(+Ve.slice(De,De+=p));De=p-(Ve=Ve.slice(De)).length}else De-=Fe;for(;De--;Ve+="0");Be.c.push(+Ve)}}else Be.c=[Be.e=0]}Pe.clone=b,Pe.ROUND_UP=0,Pe.ROUND_DOWN=1,Pe.ROUND_CEIL=2,Pe.ROUND_FLOOR=3,Pe.ROUND_HALF_UP=4,Pe.ROUND_HALF_DOWN=5,Pe.ROUND_HALF_EVEN=6,Pe.ROUND_HALF_CEIL=7,Pe.ROUND_HALF_FLOOR=8,Pe.EUCLID=9,Pe.config=Pe.set=function(K){var ne,de;if(K!=null)if(typeof K=="object"){if(K.hasOwnProperty(ne="DECIMAL_PLACES")&&(de=K[ne],I(de,0,C,ne),ae=de),K.hasOwnProperty(ne="ROUNDING_MODE")&&(de=K[ne],I(de,0,8,ne),X=de),K.hasOwnProperty(ne="EXPONENTIAL_AT")&&(de=K[ne],de&&de.pop?(I(de[0],-C,0,ne),I(de[1],0,C,ne),le=de[0],ye=de[1]):(I(de,-C,C,ne),le=-(ye=de<0?-de:de))),K.hasOwnProperty(ne="RANGE"))if(de=K[ne],de&&de.pop)I(de[0],-C,-1,ne),I(de[1],1,C,ne),pe=de[0],he=de[1];else if(I(de,-C,C,ne),de)pe=-(he=de<0?-de:de);else throw Error(f+ne+" cannot be zero: "+de);if(K.hasOwnProperty(ne="CRYPTO"))if(de=K[ne],de===!!de)if(de)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Me=de;else throw Me=!de,Error(f+"crypto unavailable");else Me=de;else throw Error(f+ne+" not true or false: "+de);if(K.hasOwnProperty(ne="MODULO_MODE")&&(de=K[ne],I(de,0,9,ne),Qe=de),K.hasOwnProperty(ne="POW_PRECISION")&&(de=K[ne],I(de,0,C,ne),Xe=de),K.hasOwnProperty(ne="FORMAT"))if(de=K[ne],typeof de=="object")Ke=de;else throw Error(f+ne+" not an object: "+de);if(K.hasOwnProperty(ne="ALPHABET"))if(de=K[ne],typeof de=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(de))te=de.slice(0,10)=="0123456789",it=de;else throw Error(f+ne+" invalid: "+de)}else throw Error(f+"Object expected: "+K);return{DECIMAL_PLACES:ae,ROUNDING_MODE:X,EXPONENTIAL_AT:[le,ye],RANGE:[pe,he],CRYPTO:Me,MODULO_MODE:Qe,POW_PRECISION:Xe,FORMAT:Ke,ALPHABET:it}},Pe.isBigNumber=function(K){if(!K||K._isBigNumber!==!0)return!1;if(!Pe.DEBUG)return!0;var ne,de,Oe=K.c,Se=K.e,ge=K.s;e:if({}.toString.call(Oe)=="[object Array]"){if((ge===1||ge===-1)&&Se>=-C&&Se<=C&&Se===h(Se)){if(Oe[0]===0){if(Se===0&&Oe.length===1)return!0;break e}if(ne=(Se+1)%p,ne<1&&(ne+=p),String(Oe[0]).length==ne){for(ne=0;ne<Oe.length;ne++)if(de=Oe[ne],de<0||de>=m||de!==h(de))break e;if(de!==0)return!0}}}else if(Oe===null&&Se===null&&(ge===null||ge===1||ge===-1))return!0;throw Error(f+"Invalid BigNumber: "+K)},Pe.maximum=Pe.max=function(){return Q(arguments,-1)},Pe.minimum=Pe.min=function(){return Q(arguments,1)},Pe.random=(function(){var K=9007199254740992,ne=Math.random()*K&2097151?function(){return h(Math.random()*K)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(de){var Oe,Se,ge,De,$e,Fe=0,Ve=[],Be=new Pe(oe);if(de==null?de=ae:I(de,0,C),De=d(de/p),Me)if(crypto.getRandomValues){for(Oe=crypto.getRandomValues(new Uint32Array(De*=2));Fe<De;)$e=Oe[Fe]*131072+(Oe[Fe+1]>>>11),$e>=9e15?(Se=crypto.getRandomValues(new Uint32Array(2)),Oe[Fe]=Se[0],Oe[Fe+1]=Se[1]):(Ve.push($e%1e14),Fe+=2);Fe=De/2}else if(crypto.randomBytes){for(Oe=crypto.randomBytes(De*=7);Fe<De;)$e=(Oe[Fe]&31)*281474976710656+Oe[Fe+1]*1099511627776+Oe[Fe+2]*4294967296+Oe[Fe+3]*16777216+(Oe[Fe+4]<<16)+(Oe[Fe+5]<<8)+Oe[Fe+6],$e>=9e15?crypto.randomBytes(7).copy(Oe,Fe):(Ve.push($e%1e14),Fe+=7);Fe=De/7}else throw Me=!1,Error(f+"crypto unavailable");if(!Me)for(;Fe<De;)$e=ne(),$e<9e15&&(Ve[Fe++]=$e%1e14);for(De=Ve[--Fe],de%=p,De&&de&&($e=w[p-de],Ve[Fe]=h(De/$e)*$e);Ve[Fe]===0;Ve.pop(),Fe--);if(Fe<0)Ve=[ge=0];else{for(ge=-1;Ve[0]===0;Ve.splice(0,1),ge-=p);for(Fe=1,$e=Ve[0];$e>=10;$e/=10,Fe++);Fe<p&&(ge-=p-Fe)}return Be.e=ge,Be.c=Ve,Be}})(),Pe.sum=function(){for(var K=1,ne=arguments,de=new Pe(ne[0]);K<ne.length;)de=de.plus(ne[K++]);return de},k=(function(){var K="0123456789";function ne(de,Oe,Se,ge){for(var De,$e=[0],Fe,Ve=0,Be=de.length;Ve<Be;){for(Fe=$e.length;Fe--;$e[Fe]*=Oe);for($e[0]+=ge.indexOf(de.charAt(Ve++)),De=0;De<$e.length;De++)$e[De]>Se-1&&($e[De+1]==null&&($e[De+1]=0),$e[De+1]+=$e[De]/Se|0,$e[De]%=Se)}return $e.reverse()}return function(de,Oe,Se,ge,De){var $e,Fe,Ve,Be,Je,lt,ot,ht,Ct=de.indexOf("."),bt=ae,vt=X;for(Ct>=0&&(Be=Xe,Xe=0,de=de.replace(".",""),ht=new Pe(Oe),lt=ht.pow(de.length-Ct),Xe=Be,ht.c=ne(H(R(lt.c),lt.e,"0"),10,Se,K),ht.e=ht.c.length),ot=ne(de,Oe,Se,De?($e=it,K):($e=K,it)),Ve=Be=ot.length;ot[--Be]==0;ot.pop());if(!ot[0])return $e.charAt(0);if(Ct<0?--Ve:(lt.c=ot,lt.e=Ve,lt.s=ge,lt=A(lt,ht,bt,vt,Se),ot=lt.c,Je=lt.r,Ve=lt.e),Fe=Ve+bt+1,Ct=ot[Fe],Be=Se/2,Je=Je||Fe<0||ot[Fe+1]!=null,Je=vt<4?(Ct!=null||Je)&&(vt==0||vt==(lt.s<0?3:2)):Ct>Be||Ct==Be&&(vt==4||Je||vt==6&&ot[Fe-1]&1||vt==(lt.s<0?8:7)),Fe<1||!ot[0])de=Je?H($e.charAt(1),-bt,$e.charAt(0)):$e.charAt(0);else{if(ot.length=Fe,Je)for(--Se;++ot[--Fe]>Se;)ot[Fe]=0,Fe||(++Ve,ot=[1].concat(ot));for(Be=ot.length;!ot[--Be];);for(Ct=0,de="";Ct<=Be;de+=$e.charAt(ot[Ct++]));de=H(de,Ve,$e.charAt(0))}return de}})(),A=(function(){function K(Oe,Se,ge){var De,$e,Fe,Ve,Be=0,Je=Oe.length,lt=Se%E,ot=Se/E|0;for(Oe=Oe.slice();Je--;)Fe=Oe[Je]%E,Ve=Oe[Je]/E|0,De=ot*Fe+Ve*lt,$e=lt*Fe+De%E*E+Be,Be=($e/ge|0)+(De/E|0)+ot*Ve,Oe[Je]=$e%ge;return Be&&(Oe=[Be].concat(Oe)),Oe}function ne(Oe,Se,ge,De){var $e,Fe;if(ge!=De)Fe=ge>De?1:-1;else for($e=Fe=0;$e<ge;$e++)if(Oe[$e]!=Se[$e]){Fe=Oe[$e]>Se[$e]?1:-1;break}return Fe}function de(Oe,Se,ge,De){for(var $e=0;ge--;)Oe[ge]-=$e,$e=Oe[ge]<Se[ge]?1:0,Oe[ge]=$e*De+Oe[ge]-Se[ge];for(;!Oe[0]&&Oe.length>1;Oe.splice(0,1));}return function(Oe,Se,ge,De,$e){var Fe,Ve,Be,Je,lt,ot,ht,Ct,bt,vt,mt,Et,Rt,V,q,D,O,re=Oe.s==Se.s?1:-1,Ee=Oe.c,we=Se.c;if(!Ee||!Ee[0]||!we||!we[0])return new Pe(!Oe.s||!Se.s||(Ee?we&&Ee[0]==we[0]:!we)?NaN:Ee&&Ee[0]==0||!we?re*0:re/0);for(Ct=new Pe(re),bt=Ct.c=[],Ve=Oe.e-Se.e,re=ge+Ve+1,$e||($e=m,Ve=P(Oe.e/p)-P(Se.e/p),re=re/p|0),Be=0;we[Be]==(Ee[Be]||0);Be++);if(we[Be]>(Ee[Be]||0)&&Ve--,re<0)bt.push(1),Je=!0;else{for(V=Ee.length,D=we.length,Be=0,re+=2,lt=h($e/(we[0]+1)),lt>1&&(we=K(we,lt,$e),Ee=K(Ee,lt,$e),D=we.length,V=Ee.length),Rt=D,vt=Ee.slice(0,D),mt=vt.length;mt<D;vt[mt++]=0);O=we.slice(),O=[0].concat(O),q=we[0],we[1]>=$e/2&&q++;do{if(lt=0,Fe=ne(we,vt,D,mt),Fe<0){if(Et=vt[0],D!=mt&&(Et=Et*$e+(vt[1]||0)),lt=h(Et/q),lt>1)for(lt>=$e&&(lt=$e-1),ot=K(we,lt,$e),ht=ot.length,mt=vt.length;ne(ot,vt,ht,mt)==1;)lt--,de(ot,D<ht?O:we,ht,$e),ht=ot.length,Fe=1;else lt==0&&(Fe=lt=1),ot=we.slice(),ht=ot.length;if(ht<mt&&(ot=[0].concat(ot)),de(vt,ot,mt,$e),mt=vt.length,Fe==-1)for(;ne(we,vt,D,mt)<1;)lt++,de(vt,D<mt?O:we,mt,$e),mt=vt.length}else Fe===0&&(lt++,vt=[0]);bt[Be++]=lt,vt[0]?vt[mt++]=Ee[Rt]||0:(vt=[Ee[Rt]],mt=1)}while((Rt++<V||vt[0]!=null)&&re--);Je=vt[0]!=null,bt[0]||bt.splice(0,1)}if($e==m){for(Be=1,re=bt[0];re>=10;re/=10,Be++);ce(Ct,ge+(Ct.e=Be+Ve*p-1)+1,De,Je)}else Ct.e=Ve,Ct.r=+Je;return Ct}})();function U(K,ne,de,Oe){var Se,ge,De,$e,Fe;if(de==null?de=X:I(de,0,8),!K.c)return K.toString();if(Se=K.c[0],De=K.e,ne==null)Fe=R(K.c),Fe=Oe==1||Oe==2&&(De<=le||De>=ye)?N(Fe,De):H(Fe,De,"0");else if(K=ce(new Pe(K),ne,de),ge=K.e,Fe=R(K.c),$e=Fe.length,Oe==1||Oe==2&&(ne<=ge||ge<=le)){for(;$e<ne;Fe+="0",$e++);Fe=N(Fe,ge)}else if(ne-=De,Fe=H(Fe,ge,"0"),ge+1>$e){if(--ne>0)for(Fe+=".";ne--;Fe+="0");}else if(ne+=ge-$e,ne>0)for(ge+1==$e&&(Fe+=".");ne--;Fe+="0");return K.s<0&&Se?"-"+Fe:Fe}function Q(K,ne){for(var de,Oe,Se=1,ge=new Pe(K[0]);Se<K.length;Se++)Oe=new Pe(K[Se]),(!Oe.s||(de=T(ge,Oe))===ne||de===0&&ge.s===ne)&&(ge=Oe);return ge}function ee(K,ne,de){for(var Oe=1,Se=ne.length;!ne[--Se];ne.pop());for(Se=ne[0];Se>=10;Se/=10,Oe++);return(de=Oe+de*p-1)>he?K.c=K.e=null:de<pe?K.c=[K.e=0]:(K.e=de,K.c=ne),K}W=(function(){var K=/^(-?)0([xbo])(?=\w[\w.]*$)/i,ne=/^([^.]+)\.$/,de=/^\.([^.]+)$/,Oe=/^-?(Infinity|NaN)$/,Se=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(ge,De,$e,Fe){var Ve,Be=$e?De:De.replace(Se,"");if(Oe.test(Be))ge.s=isNaN(Be)?null:Be<0?-1:1;else{if(!$e&&(Be=Be.replace(K,function(Je,lt,ot){return Ve=(ot=ot.toLowerCase())=="x"?16:ot=="b"?2:8,!Fe||Fe==Ve?lt:Je}),Fe&&(Ve=Fe,Be=Be.replace(ne,"$1").replace(de,"0.$1")),De!=Be))return new Pe(Be,Ve);if(Pe.DEBUG)throw Error(f+"Not a"+(Fe?" base "+Fe:"")+" number: "+De);ge.s=null}ge.c=ge.e=null}})();function ce(K,ne,de,Oe){var Se,ge,De,$e,Fe,Ve,Be,Je=K.c,lt=w;if(Je){e:{for(Se=1,$e=Je[0];$e>=10;$e/=10,Se++);if(ge=ne-Se,ge<0)ge+=p,De=ne,Fe=Je[Ve=0],Be=h(Fe/lt[Se-De-1]%10);else if(Ve=d((ge+1)/p),Ve>=Je.length)if(Oe){for(;Je.length<=Ve;Je.push(0));Fe=Be=0,Se=1,ge%=p,De=ge-p+1}else break e;else{for(Fe=$e=Je[Ve],Se=1;$e>=10;$e/=10,Se++);ge%=p,De=ge-p+Se,Be=De<0?0:h(Fe/lt[Se-De-1]%10)}if(Oe=Oe||ne<0||Je[Ve+1]!=null||(De<0?Fe:Fe%lt[Se-De-1]),Oe=de<4?(Be||Oe)&&(de==0||de==(K.s<0?3:2)):Be>5||Be==5&&(de==4||Oe||de==6&&(ge>0?De>0?Fe/lt[Se-De]:0:Je[Ve-1])%10&1||de==(K.s<0?8:7)),ne<1||!Je[0])return Je.length=0,Oe?(ne-=K.e+1,Je[0]=lt[(p-ne%p)%p],K.e=-ne||0):Je[0]=K.e=0,K;if(ge==0?(Je.length=Ve,$e=1,Ve--):(Je.length=Ve+1,$e=lt[p-ge],Je[Ve]=De>0?h(Fe/lt[Se-De]%lt[De])*$e:0),Oe)for(;;)if(Ve==0){for(ge=1,De=Je[0];De>=10;De/=10,ge++);for(De=Je[0]+=$e,$e=1;De>=10;De/=10,$e++);ge!=$e&&(K.e++,Je[0]==m&&(Je[0]=1));break}else{if(Je[Ve]+=$e,Je[Ve]!=m)break;Je[Ve--]=0,$e=1}for(ge=Je.length;Je[--ge]===0;Je.pop());}K.e>he?K.c=K.e=null:K.e<pe&&(K.c=[K.e=0])}return K}function ve(K){var ne,de=K.e;return de===null?K.toString():(ne=R(K.c),ne=de<=le||de>=ye?N(ne,de):H(ne,de,"0"),K.s<0?"-"+ne:ne)}return G.absoluteValue=G.abs=function(){var K=new Pe(this);return K.s<0&&(K.s=1),K},G.comparedTo=function(K,ne){return T(this,new Pe(K,ne))},G.decimalPlaces=G.dp=function(K,ne){var de,Oe,Se,ge=this;if(K!=null)return I(K,0,C),ne==null?ne=X:I(ne,0,8),ce(new Pe(ge),K+ge.e+1,ne);if(!(de=ge.c))return null;if(Oe=((Se=de.length-1)-P(this.e/p))*p,Se=de[Se])for(;Se%10==0;Se/=10,Oe--);return Oe<0&&(Oe=0),Oe},G.dividedBy=G.div=function(K,ne){return A(this,new Pe(K,ne),ae,X)},G.dividedToIntegerBy=G.idiv=function(K,ne){return A(this,new Pe(K,ne),0,1)},G.exponentiatedBy=G.pow=function(K,ne){var de,Oe,Se,ge,De,$e,Fe,Ve,Be,Je=this;if(K=new Pe(K),K.c&&!K.isInteger())throw Error(f+"Exponent not an integer: "+ve(K));if(ne!=null&&(ne=new Pe(ne)),$e=K.e>14,!Je.c||!Je.c[0]||Je.c[0]==1&&!Je.e&&Je.c.length==1||!K.c||!K.c[0])return Be=new Pe(Math.pow(+ve(Je),$e?K.s*(2-M(K)):+ve(K))),ne?Be.mod(ne):Be;if(Fe=K.s<0,ne){if(ne.c?!ne.c[0]:!ne.s)return new Pe(NaN);Oe=!Fe&&Je.isInteger()&&ne.isInteger(),Oe&&(Je=Je.mod(ne))}else{if(K.e>9&&(Je.e>0||Je.e<-1||(Je.e==0?Je.c[0]>1||$e&&Je.c[1]>=24e7:Je.c[0]<8e13||$e&&Je.c[0]<=9999975e7)))return ge=Je.s<0&&M(K)?-0:0,Je.e>-1&&(ge=1/ge),new Pe(Fe?1/ge:ge);Xe&&(ge=d(Xe/p+2))}for($e?(de=new Pe(.5),Fe&&(K.s=1),Ve=M(K)):(Se=Math.abs(+ve(K)),Ve=Se%2),Be=new Pe(oe);;){if(Ve){if(Be=Be.times(Je),!Be.c)break;ge?Be.c.length>ge&&(Be.c.length=ge):Oe&&(Be=Be.mod(ne))}if(Se){if(Se=h(Se/2),Se===0)break;Ve=Se%2}else if(K=K.times(de),ce(K,K.e+1,1),K.e>14)Ve=M(K);else{if(Se=+ve(K),Se===0)break;Ve=Se%2}Je=Je.times(Je),ge?Je.c&&Je.c.length>ge&&(Je.c.length=ge):Oe&&(Je=Je.mod(ne))}return Oe?Be:(Fe&&(Be=oe.div(Be)),ne?Be.mod(ne):ge?ce(Be,Xe,X,De):Be)},G.integerValue=function(K){var ne=new Pe(this);return K==null?K=X:I(K,0,8),ce(ne,ne.e+1,K)},G.isEqualTo=G.eq=function(K,ne){return T(this,new Pe(K,ne))===0},G.isFinite=function(){return!!this.c},G.isGreaterThan=G.gt=function(K,ne){return T(this,new Pe(K,ne))>0},G.isGreaterThanOrEqualTo=G.gte=function(K,ne){return(ne=T(this,new Pe(K,ne)))===1||ne===0},G.isInteger=function(){return!!this.c&&P(this.e/p)>this.c.length-2},G.isLessThan=G.lt=function(K,ne){return T(this,new Pe(K,ne))<0},G.isLessThanOrEqualTo=G.lte=function(K,ne){return(ne=T(this,new Pe(K,ne)))===-1||ne===0},G.isNaN=function(){return!this.s},G.isNegative=function(){return this.s<0},G.isPositive=function(){return this.s>0},G.isZero=function(){return!!this.c&&this.c[0]==0},G.minus=function(K,ne){var de,Oe,Se,ge,De=this,$e=De.s;if(K=new Pe(K,ne),ne=K.s,!$e||!ne)return new Pe(NaN);if($e!=ne)return K.s=-ne,De.plus(K);var Fe=De.e/p,Ve=K.e/p,Be=De.c,Je=K.c;if(!Fe||!Ve){if(!Be||!Je)return Be?(K.s=-ne,K):new Pe(Je?De:NaN);if(!Be[0]||!Je[0])return Je[0]?(K.s=-ne,K):new Pe(Be[0]?De:X==3?-0:0)}if(Fe=P(Fe),Ve=P(Ve),Be=Be.slice(),$e=Fe-Ve){for((ge=$e<0)?($e=-$e,Se=Be):(Ve=Fe,Se=Je),Se.reverse(),ne=$e;ne--;Se.push(0));Se.reverse()}else for(Oe=(ge=($e=Be.length)<(ne=Je.length))?$e:ne,$e=ne=0;ne<Oe;ne++)if(Be[ne]!=Je[ne]){ge=Be[ne]<Je[ne];break}if(ge&&(Se=Be,Be=Je,Je=Se,K.s=-K.s),ne=(Oe=Je.length)-(de=Be.length),ne>0)for(;ne--;Be[de++]=0);for(ne=m-1;Oe>$e;){if(Be[--Oe]<Je[Oe]){for(de=Oe;de&&!Be[--de];Be[de]=ne);--Be[de],Be[Oe]+=m}Be[Oe]-=Je[Oe]}for(;Be[0]==0;Be.splice(0,1),--Ve);return Be[0]?ee(K,Be,Ve):(K.s=X==3?-1:1,K.c=[K.e=0],K)},G.modulo=G.mod=function(K,ne){var de,Oe,Se=this;return K=new Pe(K,ne),!Se.c||!K.s||K.c&&!K.c[0]?new Pe(NaN):!K.c||Se.c&&!Se.c[0]?new Pe(Se):(Qe==9?(Oe=K.s,K.s=1,de=A(Se,K,0,3),K.s=Oe,de.s*=Oe):de=A(Se,K,0,Qe),K=Se.minus(de.times(K)),!K.c[0]&&Qe==1&&(K.s=Se.s),K)},G.multipliedBy=G.times=function(K,ne){var de,Oe,Se,ge,De,$e,Fe,Ve,Be,Je,lt,ot,ht,Ct,bt,vt=this,mt=vt.c,Et=(K=new Pe(K,ne)).c;if(!mt||!Et||!mt[0]||!Et[0])return!vt.s||!K.s||mt&&!mt[0]&&!Et||Et&&!Et[0]&&!mt?K.c=K.e=K.s=null:(K.s*=vt.s,!mt||!Et?K.c=K.e=null:(K.c=[0],K.e=0)),K;for(Oe=P(vt.e/p)+P(K.e/p),K.s*=vt.s,Fe=mt.length,Je=Et.length,Fe<Je&&(ht=mt,mt=Et,Et=ht,Se=Fe,Fe=Je,Je=Se),Se=Fe+Je,ht=[];Se--;ht.push(0));for(Ct=m,bt=E,Se=Je;--Se>=0;){for(de=0,lt=Et[Se]%bt,ot=Et[Se]/bt|0,De=Fe,ge=Se+De;ge>Se;)Ve=mt[--De]%bt,Be=mt[De]/bt|0,$e=ot*Ve+Be*lt,Ve=lt*Ve+$e%bt*bt+ht[ge]+de,de=(Ve/Ct|0)+($e/bt|0)+ot*Be,ht[ge--]=Ve%Ct;ht[ge]=de}return de?++Oe:ht.splice(0,1),ee(K,ht,Oe)},G.negated=function(){var K=new Pe(this);return K.s=-K.s||null,K},G.plus=function(K,ne){var de,Oe=this,Se=Oe.s;if(K=new Pe(K,ne),ne=K.s,!Se||!ne)return new Pe(NaN);if(Se!=ne)return K.s=-ne,Oe.minus(K);var ge=Oe.e/p,De=K.e/p,$e=Oe.c,Fe=K.c;if(!ge||!De){if(!$e||!Fe)return new Pe(Se/0);if(!$e[0]||!Fe[0])return Fe[0]?K:new Pe($e[0]?Oe:Se*0)}if(ge=P(ge),De=P(De),$e=$e.slice(),Se=ge-De){for(Se>0?(De=ge,de=Fe):(Se=-Se,de=$e),de.reverse();Se--;de.push(0));de.reverse()}for(Se=$e.length,ne=Fe.length,Se-ne<0&&(de=Fe,Fe=$e,$e=de,ne=Se),Se=0;ne;)Se=($e[--ne]=$e[ne]+Fe[ne]+Se)/m|0,$e[ne]=m===$e[ne]?0:$e[ne]%m;return Se&&($e=[Se].concat($e),++De),ee(K,$e,De)},G.precision=G.sd=function(K,ne){var de,Oe,Se,ge=this;if(K!=null&&K!==!!K)return I(K,1,C),ne==null?ne=X:I(ne,0,8),ce(new Pe(ge),K,ne);if(!(de=ge.c))return null;if(Se=de.length-1,Oe=Se*p+1,Se=de[Se]){for(;Se%10==0;Se/=10,Oe--);for(Se=de[0];Se>=10;Se/=10,Oe++);}return K&&ge.e+1>Oe&&(Oe=ge.e+1),Oe},G.shiftedBy=function(K){return I(K,-v,v),this.times("1e"+K)},G.squareRoot=G.sqrt=function(){var K,ne,de,Oe,Se,ge=this,De=ge.c,$e=ge.s,Fe=ge.e,Ve=ae+4,Be=new Pe("0.5");if($e!==1||!De||!De[0])return new Pe(!$e||$e<0&&(!De||De[0])?NaN:De?ge:1/0);if($e=Math.sqrt(+ve(ge)),$e==0||$e==1/0?(ne=R(De),(ne.length+Fe)%2==0&&(ne+="0"),$e=Math.sqrt(+ne),Fe=P((Fe+1)/2)-(Fe<0||Fe%2),$e==1/0?ne="5e"+Fe:(ne=$e.toExponential(),ne=ne.slice(0,ne.indexOf("e")+1)+Fe),de=new Pe(ne)):de=new Pe($e+""),de.c[0]){for(Fe=de.e,$e=Fe+Ve,$e<3&&($e=0);;)if(Se=de,de=Be.times(Se.plus(A(ge,Se,Ve,1))),R(Se.c).slice(0,$e)===(ne=R(de.c)).slice(0,$e))if(de.e<Fe&&--$e,ne=ne.slice($e-3,$e+1),ne=="9999"||!Oe&&ne=="4999"){if(!Oe&&(ce(Se,Se.e+ae+2,0),Se.times(Se).eq(ge))){de=Se;break}Ve+=4,$e+=4,Oe=1}else{(!+ne||!+ne.slice(1)&&ne.charAt(0)=="5")&&(ce(de,de.e+ae+2,1),K=!de.times(de).eq(ge));break}}return ce(de,de.e+ae+1,X,K)},G.toExponential=function(K,ne){return K!=null&&(I(K,0,C),K++),U(this,K,ne,1)},G.toFixed=function(K,ne){return K!=null&&(I(K,0,C),K=K+this.e+1),U(this,K,ne)},G.toFormat=function(K,ne,de){var Oe,Se=this;if(de==null)K!=null&&ne&&typeof ne=="object"?(de=ne,ne=null):K&&typeof K=="object"?(de=K,K=ne=null):de=Ke;else if(typeof de!="object")throw Error(f+"Argument not an object: "+de);if(Oe=Se.toFixed(K,ne),Se.c){var ge,De=Oe.split("."),$e=+de.groupSize,Fe=+de.secondaryGroupSize,Ve=de.groupSeparator||"",Be=De[0],Je=De[1],lt=Se.s<0,ot=lt?Be.slice(1):Be,ht=ot.length;if(Fe&&(ge=$e,$e=Fe,Fe=ge,ht-=ge),$e>0&&ht>0){for(ge=ht%$e||$e,Be=ot.substr(0,ge);ge<ht;ge+=$e)Be+=Ve+ot.substr(ge,$e);Fe>0&&(Be+=Ve+ot.slice(ge)),lt&&(Be="-"+Be)}Oe=Je?Be+(de.decimalSeparator||"")+((Fe=+de.fractionGroupSize)?Je.replace(new RegExp("\\d{"+Fe+"}\\B","g"),"$&"+(de.fractionGroupSeparator||"")):Je):Be}return(de.prefix||"")+Oe+(de.suffix||"")},G.toFraction=function(K){var ne,de,Oe,Se,ge,De,$e,Fe,Ve,Be,Je,lt,ot=this,ht=ot.c;if(K!=null&&($e=new Pe(K),!$e.isInteger()&&($e.c||$e.s!==1)||$e.lt(oe)))throw Error(f+"Argument "+($e.isInteger()?"out of range: ":"not an integer: ")+ve($e));if(!ht)return new Pe(ot);for(ne=new Pe(oe),Ve=de=new Pe(oe),Oe=Fe=new Pe(oe),lt=R(ht),ge=ne.e=lt.length-ot.e-1,ne.c[0]=w[(De=ge%p)<0?p+De:De],K=!K||$e.comparedTo(ne)>0?ge>0?ne:Ve:$e,De=he,he=1/0,$e=new Pe(lt),Fe.c[0]=0;Be=A($e,ne,0,1),Se=de.plus(Be.times(Oe)),Se.comparedTo(K)!=1;)de=Oe,Oe=Se,Ve=Fe.plus(Be.times(Se=Ve)),Fe=Se,ne=$e.minus(Be.times(Se=ne)),$e=Se;return Se=A(K.minus(de),Oe,0,1),Fe=Fe.plus(Se.times(Ve)),de=de.plus(Se.times(Oe)),Fe.s=Ve.s=ot.s,ge=ge*2,Je=A(Ve,Oe,ge,X).minus(ot).abs().comparedTo(A(Fe,de,ge,X).minus(ot).abs())<1?[Ve,Oe]:[Fe,de],he=De,Je},G.toNumber=function(){return+ve(this)},G.toPrecision=function(K,ne){return K!=null&&I(K,1,C),U(this,K,ne,2)},G.toString=function(K){var ne,de=this,Oe=de.s,Se=de.e;return Se===null?Oe?(ne="Infinity",Oe<0&&(ne="-"+ne)):ne="NaN":(K==null?ne=Se<=le||Se>=ye?N(R(de.c),Se):H(R(de.c),Se,"0"):K===10&&te?(de=ce(new Pe(de),ae+Se+1,X),ne=H(R(de.c),de.e,"0")):(I(K,2,it.length,"Base"),ne=k(H(R(de.c),Se,"0"),10,K,Oe,!0)),Oe<0&&de.c[0]&&(ne="-"+ne)),ne},G.valueOf=G.toJSON=function(){return ve(this)},G._isBigNumber=!0,L!=null&&Pe.set(L),Pe}function P(L){var A=L|0;return L>0||L===A?A:A-1}function R(L){for(var A,k,W=1,G=L.length,oe=L[0]+"";W<G;){for(A=L[W++]+"",k=p-A.length;k--;A="0"+A);oe+=A}for(G=oe.length;oe.charCodeAt(--G)===48;);return oe.slice(0,G+1||1)}function T(L,A){var k,W,G=L.c,oe=A.c,ae=L.s,X=A.s,le=L.e,ye=A.e;if(!ae||!X)return null;if(k=G&&!G[0],W=oe&&!oe[0],k||W)return k?W?0:-X:ae;if(ae!=X)return ae;if(k=ae<0,W=le==ye,!G||!oe)return W?0:!G^k?1:-1;if(!W)return le>ye^k?1:-1;for(X=(le=G.length)<(ye=oe.length)?le:ye,ae=0;ae<X;ae++)if(G[ae]!=oe[ae])return G[ae]>oe[ae]^k?1:-1;return le==ye?0:le>ye^k?1:-1}function I(L,A,k,W){if(L<A||L>k||L!==h(L))throw Error(f+(W||"Argument")+(typeof L=="number"?L<A||L>k?" out of range: ":" not an integer: ":" not a primitive number: ")+String(L))}function M(L){var A=L.c.length-1;return P(L.e/p)==A&&L.c[A]%2!=0}function N(L,A){return(L.length>1?L.charAt(0)+"."+L.slice(1):L)+(A<0?"e":"e+")+A}function H(L,A,k){var W,G;if(A<0){for(G=k+".";++A;G+=k);L=G+L}else if(W=L.length,++A>W){for(G=k,A-=W;--A;G+=k);L+=G}else A<W&&(L=L.slice(0,A)+"."+L.slice(A));return L}c=b(),c.default=c.BigNumber=c,a.exports?a.exports=c:(s||(s=typeof self<"u"&&self?self:window),s.BigNumber=c)})(commonjsGlobal)})(bignumber);var bignumberExports=bignumber.exports;const globalState$1=requireGlobalState(),validating=requireValidating(),parsing$1=parsing$2,BigNumber$1=bignumberExports,powers={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},defaultOptions={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes,decimalSuffixes}=globalState$1.currentBytes(),bytes={general:{scale:1024,suffixes:decimalSuffixes},binary:{scale:1024,suffixes:binarySuffixes},decimal:{scale:1e3,suffixes:decimalSuffixes}};function format(a,s={},c){if(typeof s=="string"&&(s=parsing$1.parseFormat(s)),!validating.validateFormat(s))return"ERROR: invalid format";let d=s.prefix||"",h=s.postfix||"",f=formatNumbro(a,s,c);return f=insertPrefix(f,d),f=insertPostfix(f,h),f}function formatNumbro(a,s,c){switch(s.output){case"currency":return s=formatOrDefault(s,globalState$1.currentCurrencyDefaultFormat()),formatCurrency(a,s,globalState$1);case"percent":return s=formatOrDefault(s,globalState$1.currentPercentageDefaultFormat()),formatPercentage(a,s,globalState$1,c);case"byte":return s=formatOrDefault(s,globalState$1.currentByteDefaultFormat()),formatByte(a,s,globalState$1,c);case"time":return s=formatOrDefault(s,globalState$1.currentTimeDefaultFormat()),formatTime(a);case"ordinal":return s=formatOrDefault(s,globalState$1.currentOrdinalDefaultFormat()),formatOrdinal(a,s,globalState$1);case"number":default:return formatNumber({instance:a,providedFormat:s})}}function getDecimalByteUnit(a){let s=bytes.decimal;return getFormatByteUnits(a._value,s.suffixes,s.scale).suffix}function getBinaryByteUnit(a){let s=bytes.binary;return getFormatByteUnits(a._value,s.suffixes,s.scale).suffix}function getByteUnit(a){let s=bytes.general;return getFormatByteUnits(a._value,s.suffixes,s.scale).suffix}function getFormatByteUnits(a,s,c){let u=s[0],d=Math.abs(a);if(d>=c){for(let h=1;h<s.length;++h){let f=Math.pow(c,h),g=Math.pow(c,h+1);if(d>=f&&d<g){u=s[h],a=a/f;break}}u===s[0]&&(a=a/Math.pow(c,s.length-1),u=s[s.length-1])}return{value:a,suffix:u}}function formatByte(a,s,c,u){let d=s.base||"binary",h=Object.assign({},defaultOptions,s);const{binarySuffixes:f,decimalSuffixes:g}=c.currentBytes();let p={general:{scale:1024,suffixes:g||decimalSuffixes,marker:"bd"},binary:{scale:1024,suffixes:f||binarySuffixes,marker:"b"},decimal:{scale:1e3,suffixes:g||decimalSuffixes,marker:"d"}}[d],{value:v,suffix:w}=getFormatByteUnits(a._value,p.suffixes,p.scale);return`${formatNumber({instance:u(v),providedFormat:s,state:c,defaults:c.currentByteDefaultFormat()})}${h.spaceSeparated?" ":""}${w}`}function formatOrdinal(a,s,c){let u=c.currentOrdinal(),d=Object.assign({},defaultOptions,s),h=formatNumber({instance:a,providedFormat:s,state:c}),f=u(a._value);return`${h}${d.spaceSeparated?" ":""}${f}`}function formatTime(a){let s=Math.floor(a._value/60/60),c=Math.floor((a._value-s*60*60)/60),u=Math.round(a._value-s*60*60-c*60);return`${s}:${c<10?"0":""}${c}:${u<10?"0":""}${u}`}function formatPercentage(a,s,c,u){let d=s.prefixSymbol,h=formatNumber({instance:u(a._value*100),providedFormat:s,state:c}),f=Object.assign({},defaultOptions,s);return d?`%${f.spaceSeparated?" ":""}${h}`:`${h}${f.spaceSeparated?" ":""}%`}function formatCurrency(a,s,c){const u=c.currentCurrency();let d=Object.assign({},s),h=Object.assign({},defaultOptions,d),f,g="",m=!!h.totalLength||!!h.forceAverage||h.average,p=d.currencyPosition||u.position,v=d.currencySymbol||u.symbol;const w=h.spaceSeparatedCurrency!==void 0?h.spaceSeparatedCurrency:h.spaceSeparated;d.lowPrecision===void 0&&(d.lowPrecision=!1),w&&(g=" "),p==="infix"&&(f=g+v+g);let E=formatNumber({instance:a,providedFormat:d,state:c,decimalSeparator:f});return p==="prefix"&&(a._value<0&&h.negative==="sign"?E=`-${g}${v}${E.slice(1)}`:a._value>0&&h.forceSign?E=`+${g}${v}${E.slice(1)}`:E=v+g+E),(!p||p==="postfix")&&(g=!h.spaceSeparatedAbbreviation&&m?"":g,E=E+g+v),E}function computeAverage({value:a,forceAverage:s,lowPrecision:c=!0,abbreviations:u,spaceSeparated:d=!1,totalLength:h=0,roundingFunction:f=Math.round}){let g="",m=Math.abs(a),p=-1;if(s&&u[s]&&powers[s]?(g=u[s],a=a/powers[s]):m>=powers.trillion||c&&f(m/powers.trillion)===1?(g=u.trillion,a=a/powers.trillion):m<powers.trillion&&m>=powers.billion||c&&f(m/powers.billion)===1?(g=u.billion,a=a/powers.billion):m<powers.billion&&m>=powers.million||c&&f(m/powers.million)===1?(g=u.million,a=a/powers.million):(m<powers.million&&m>=powers.thousand||c&&f(m/powers.thousand)===1)&&(g=u.thousand,a=a/powers.thousand),g&&(g=(d?" ":"")+g),h){let w=a<0,E=a.toString().split(".")[0],C=w?E.length-1:E.length;p=Math.max(h-C,0)}return{value:a,abbreviation:g,mantissaPrecision:p}}function computeExponential({value:a,characteristicPrecision:s}){let[c,u]=a.toExponential().split("e"),d=+c;if(!s)return{value:d,abbreviation:`e${u}`};let h=1;return h<s&&(d=d*Math.pow(10,s-h),u=+u-(s-h),u=u>=0?`+${u}`:u),{value:d,abbreviation:`e${u}`}}function zeroes(a){let s="";for(let c=0;c<a;c++)s+="0";return s}function toFixedLarge(a,s){let c=a.toString(),[u,d]=c.split("e"),[h,f=""]=u.split(".");if(+d>0)c=h+f+zeroes(d-f.length);else{let g=".";+h<0?g=`-0${g}`:g=`0${g}`;let m=(zeroes(-d-1)+Math.abs(h)+f).substr(0,s);m.length<s&&(m+=zeroes(s-m.length)),c=g+m}return+d>0&&s>0&&(c+=`.${zeroes(s)}`),c}function toFixed(a,s,c=Math.round){return a.toString().indexOf("e")!==-1?toFixedLarge(a,s):new BigNumber$1(c(+`${a}e+${s}`)/Math.pow(10,s)).toFixed(s)}function setMantissaPrecision(a,s,c,u,d,h){if(u===-1)return a;let f=toFixed(s,u,h),[g,m=""]=f.toString().split(".");if(m.match(/^0+$/)&&(c||d))return g;let p=m.match(/0+$/);return d&&p?`${g}.${m.toString().slice(0,p.index)}`:f.toString()}function setCharacteristicPrecision(a,s,c,u){let d=a,[h,f]=d.toString().split(".");if(h.match(/^-?0$/)&&c)return f?`${h.replace("0","")}.${f}`:h.replace("0","");const g=s<0&&h.indexOf("-")===0;if(g&&(h=h.slice(1),d=d.slice(1)),h.length<u){let m=u-h.length;for(let p=0;p<m;p++)d=`0${d}`}return g&&(d=`-${d}`),d.toString()}function indexesOfGroupSpaces(a,s){let c=[],u=0;for(let d=a;d>0;d--)u===s&&(c.unshift(d),u=0),u++;return c}function replaceDelimiters(a,s,c,u,d){let h=u.currentDelimiters(),f=h.thousands;d=d||h.decimal;let g=h.thousandsSize||3,m=a.toString(),p=m.split(".")[0],v=m.split(".")[1];const w=s<0&&p.indexOf("-")===0;return c&&(w&&(p=p.slice(1)),indexesOfGroupSpaces(p.length,g).forEach((C,b)=>{p=p.slice(0,C+b)+f+p.slice(C+b)}),w&&(p=`-${p}`)),v?m=p+d+v:m=p,m}function insertAbbreviation(a,s){return a+s}function insertSign(a,s,c){return s===0?a:+a==0?a.replace("-",""):s>0?`+${a}`:c==="sign"?a:`(${a.replace("-","")})`}function insertPrefix(a,s){return s+a}function insertPostfix(a,s){return a+s}function formatNumber({instance:a,providedFormat:s,state:c=globalState$1,decimalSeparator:u,defaults:d=c.currentDefaults()}){let h=a._value;if(h===0&&c.hasZeroFormat())return c.getZeroFormat();if(!isFinite(h))return h.toString();let f=Object.assign({},defaultOptions,d,s),g=f.totalLength,m=g?0:f.characteristic,p=f.optionalCharacteristic,v=f.forceAverage,w=f.lowPrecision,E=!!g||!!v||f.average,C=g?-1:E&&s.mantissa===void 0?0:f.mantissa,b=g?!1:s.optionalMantissa===void 0?C===-1:f.optionalMantissa,P=f.trimMantissa,R=f.thousandSeparated,T=f.spaceSeparated,I=f.negative,M=f.forceSign,N=f.exponential,H=f.roundingFunction,L="";if(E){let k=computeAverage({value:h,forceAverage:v,lowPrecision:w,abbreviations:c.currentAbbreviations(),spaceSeparated:T,roundingFunction:H,totalLength:g});h=k.value,L+=k.abbreviation,g&&(C=k.mantissaPrecision)}if(N){let k=computeExponential({value:h,characteristicPrecision:m});h=k.value,L=k.abbreviation+L}let A=setMantissaPrecision(h.toString(),h,b,C,P,H);return A=setCharacteristicPrecision(A,h,p,m),A=replaceDelimiters(A,h,R,c,u),(E||N)&&(A=insertAbbreviation(A,L)),(M||h<0)&&(A=insertSign(A,h,I)),A}function formatOrDefault(a,s){if(!a)return s;let c=Object.keys(a);return c.length===1&&c[0]==="output"?s:a}var formatting=a=>({format:(...s)=>format(...s,a),getByteUnit:(...s)=>getByteUnit(...s,a),getBinaryByteUnit:(...s)=>getBinaryByteUnit(...s,a),getDecimalByteUnit:(...s)=>getDecimalByteUnit(...s,a),formatOrDefault});const BigNumber=bignumberExports;function add(a,s,c){let u=new BigNumber(a._value),d=s;return c.isNumbro(s)&&(d=s._value),d=new BigNumber(d),a._value=u.plus(d).toNumber(),a}function subtract(a,s,c){let u=new BigNumber(a._value),d=s;return c.isNumbro(s)&&(d=s._value),d=new BigNumber(d),a._value=u.minus(d).toNumber(),a}function multiply(a,s,c){let u=new BigNumber(a._value),d=s;return c.isNumbro(s)&&(d=s._value),d=new BigNumber(d),a._value=u.times(d).toNumber(),a}function divide(a,s,c){let u=new BigNumber(a._value),d=s;return c.isNumbro(s)&&(d=s._value),d=new BigNumber(d),a._value=u.dividedBy(d).toNumber(),a}function set(a,s,c){let u=s;return c.isNumbro(s)&&(u=s._value),a._value=u,a}function difference(a,s,c){let u=c(a._value);return subtract(u,s,c),Math.abs(u._value)}var manipulating=a=>({add:(s,c)=>add(s,c,a),subtract:(s,c)=>subtract(s,c,a),multiply:(s,c)=>multiply(s,c,a),divide:(s,c)=>divide(s,c,a),set:(s,c)=>set(s,c,a),difference:(s,c)=>difference(s,c,a),BigNumber});const VERSION="2.5.0",globalState=requireGlobalState(),validator=requireValidating(),loader=loading(numbro),unformatter=requireUnformatting();let formatter=formatting(numbro),manipulate=manipulating(numbro);const parsing=parsing$2;class Numbro{constructor(s){this._value=s}clone(){return numbro(this._value)}format(s={}){return formatter.format(this,s)}formatCurrency(s){return typeof s=="string"&&(s=parsing.parseFormat(s)),s=formatter.formatOrDefault(s,globalState.currentCurrencyDefaultFormat()),s.output="currency",formatter.format(this,s)}formatTime(s={}){return s.output="time",formatter.format(this,s)}binaryByteUnits(){return formatter.getBinaryByteUnit(this)}decimalByteUnits(){return formatter.getDecimalByteUnit(this)}byteUnits(){return formatter.getByteUnit(this)}difference(s){return manipulate.difference(this,s)}add(s){return manipulate.add(this,s)}subtract(s){return manipulate.subtract(this,s)}multiply(s){return manipulate.multiply(this,s)}divide(s){return manipulate.divide(this,s)}set(s){return manipulate.set(this,normalizeInput(s))}value(){return this._value}valueOf(){return this._value}}function normalizeInput(a){let s=a;return numbro.isNumbro(a)?s=a._value:typeof a=="string"?s=numbro.unformat(a):isNaN(a)&&(s=NaN),s}function numbro(a){return new Numbro(normalizeInput(a))}numbro.version=VERSION,numbro.isNumbro=function(a){return a instanceof Numbro},numbro.language=globalState.currentLanguage,numbro.registerLanguage=globalState.registerLanguage,numbro.setLanguage=globalState.setLanguage,numbro.languages=globalState.languages,numbro.languageData=globalState.languageData,numbro.zeroFormat=globalState.setZeroFormat,numbro.defaultFormat=globalState.currentDefaults,numbro.setDefaults=globalState.setDefaults,numbro.defaultCurrencyFormat=globalState.currentCurrencyDefaultFormat,numbro.validate=validator.validate,numbro.loadLanguagesInNode=loader.loadLanguagesInNode,numbro.unformat=unformatter.unformat,numbro.BigNumber=manipulate.BigNumber;var numbro_1=numbro,numbro$1=getDefaultExportFromCjs(numbro_1);const RENDERER_TYPE$4="numeric";function getRenderedValue(a,s){if(isNumeric(a)){const c=s.numericFormat,u=c&&c.culture||"-",d=c&&c.pattern;if(typeof u<"u"&&!numbro$1.languages()[u]){const h=u.replace("-",""),f=numbro$1.allLanguages?numbro$1.allLanguages[u]:numbro$1[h];f&&numbro$1.registerLanguage(f)}numbro$1.setLanguage(u),a=numbro$1(a).format(d||"0")}return a}function numericRenderer(a,s,c,u,d,h,f){let g=h;if(isNumeric(g)){let p=[];if(Array.isArray(f.className))p=f.className;else{var m;const v=(m=f.className)!==null&&m!==void 0?m:"";v.length&&(p=v.split(" "))}g=getRenderedValue(g,f),p.indexOf("htLeft")<0&&p.indexOf("htCenter")<0&&p.indexOf("htRight")<0&&p.indexOf("htJustify")<0&&p.push("htRight"),p.indexOf("htNumeric")<0&&p.push("htNumeric"),f.className=p.join(" "),s.dir="ltr"}textRenderer(a,s,c,u,d,g,f)}numericRenderer.RENDERER_TYPE=RENDERER_TYPE$4;const RENDERER_TYPE$3="password";function passwordRenderer(a,s,c,u,d,h,f){textRenderer.apply(this,[a,s,c,u,d,h,f]);const g=f.hashLength||s.innerHTML.length,m=f.hashSymbol||"*";let p="";rangeEach(g-1,()=>{p+=m}),fastInnerHTML(s,p)}passwordRenderer.RENDERER_TYPE=RENDERER_TYPE$3;const RENDERER_TYPE$2="select";function selectRenderer(a,s,c,u,d,h,f){textRenderer.apply(this,[a,s,c,u,d,h,f])}selectRenderer.RENDERER_TYPE=RENDERER_TYPE$2;const RENDERER_TYPE$1="time";function timeRenderer(a,s,c,u,d,h,f){textRenderer.apply(this,[a,s,c,u,d,h,f]),s.dir="ltr"}timeRenderer.RENDERER_TYPE=RENDERER_TYPE$1;function registerAllRenderers(){_register$2(autocompleteRenderer),_register$2(baseRenderer),_register$2(checkboxRenderer),_register$2(dropdownRenderer),_register$2(handsontableRenderer),_register$2(htmlRenderer),_register$2(numericRenderer),_register$2(passwordRenderer),_register$2(selectRenderer),_register$2(textRenderer),_register$2(timeRenderer)}const VALIDATOR_TYPE$4="autocomplete";function autocompleteValidator(a,s){let c=a;if(c==null&&(c=""),this.allowEmpty&&c===""){s(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(c,process$1(c,s)):process$1(c,s)(this.source):s(!0)}autocompleteValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$4;function process$1(a,s){const c=a;return function(u){let d=!1;for(let h=0,f=u.length;h<f;h++)if(isObjectEqual(c,u[h])){d=!0;break}s(d)}}function getNormalizedDate(a){const s=new Date(a);return isNaN(new Date(`${a}T00:00`).getDate())?s:new Date(s.getTime()+s.getTimezoneOffset()*6e4)}const VALIDATOR_TYPE$3="date";function dateValidator(a,s){const c=_getEditorInstance(EDITOR_TYPE$5,this.instance);let u=a,d=!0;u==null&&(u="");let h=hooks(u,this.dateFormat||c.defaultDateFormat,!0).isValid(),f=hooks(new Date(u)).isValid()||h;if(this.allowEmpty&&u===""&&(f=!0,h=!0),f||(d=!1),!f&&h&&(d=!0),f&&!h)if(this.correctFormat===!0){const g=correctFormat(u,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,g,"dateValidator"),d=!0}else d=!1;s(d)}dateValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$3;function correctFormat(a,s){const c=hooks(getNormalizedDate(a)),u=hooks(a,s),d=a.search(/[A-Za-z]/g)>-1;let h;return c.isValid()&&c.format("x")===u.format("x")||!u.isValid()||d?h=c:h=u,h.format(s)}const VALIDATOR_TYPE$2="dropdown";function dropdownValidator(a,s){autocompleteValidator.apply(this,[a,s])}dropdownValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$2;const VALIDATOR_TYPE$1="numeric";function numericValidator(a,s){let c=a;c==null&&(c=""),this.allowEmpty&&c===""?s(!0):s(c===""?!1:isNumeric(a))}numericValidator.VALIDATOR_TYPE=VALIDATOR_TYPE$1;const STRICT_FORMATS=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],VALIDATOR_TYPE="time";function timeValidator(a,s){const c=this.timeFormat||"h:mm:ss a";let u=!0,d=a;d===null&&(d=""),d=/^\d{3,}$/.test(d)?parseInt(d,10):d;const h=/^\d{1,2}$/.test(d);h&&(d+=":00");const f=hooks(d,STRICT_FORMATS,!0).isValid()?hooks(d):hooks(d,c);let g=f.isValid(),m=hooks(d,c,!0).isValid()&&!h;if(this.allowEmpty&&d===""&&(g=!0,m=!0),g||(u=!1),!g&&m&&(u=!0),g&&!m)if(this.correctFormat===!0){const p=f.format(c);this.instance.setDataAtCell(this.visualRow,this.visualCol,p,"timeValidator"),u=!0}else u=!1;s(u)}timeValidator.VALIDATOR_TYPE=VALIDATOR_TYPE;function registerAllValidators(){_register$1(autocompleteValidator),_register$1(dropdownValidator),_register$1(dateValidator),_register$1(numericValidator),_register$1(timeValidator)}function valueGetter$1(a){return isObject(a)&&a.value!==void 0?a.value:a}function valueSetter$3(a,s,c){const u=this.getSourceDataAtCell(this.toPhysicalRow(s),this.toPhysicalColumn(c)),d=h=>isObject(h)&&isDefined(h.key)&&isDefined(h.value);return d(u)?d(a)?a:{key:a,value:a}:a}const CELL_TYPE$8="autocomplete",AutocompleteCellType={CELL_TYPE:CELL_TYPE$8,editor:AutocompleteEditor,renderer:autocompleteRenderer,validator:autocompleteValidator,valueGetter:valueGetter$1,valueSetter:valueSetter$3};function valueSetter$2(a,s,c){const{checkedTemplate:u,uncheckedTemplate:d}=this.getCellMeta(s,c),h=stringify$1(a),f=h===stringify$1(u),g=h===stringify$1(d);return f||g?f?u:d:a}const CELL_TYPE$7="checkbox",CheckboxCellType={CELL_TYPE:CELL_TYPE$7,editor:CheckboxEditor,renderer:checkboxRenderer,valueSetter:valueSetter$2},RENDERER_TYPE="date";function dateRenderer(a,s,c,u,d,h,f){autocompleteRenderer.apply(this,[a,s,c,u,d,h,f])}dateRenderer.RENDERER_TYPE=RENDERER_TYPE;const CELL_TYPE$6="date",DateCellType={CELL_TYPE:CELL_TYPE$6,editor:DateEditor,renderer:dateRenderer,validator:dateValidator};function valueGetter(a){return valueGetter$1.call(this,a)}function valueSetter$1(a,s,c,u){return valueSetter$3.call(this,a,s,c,u)}const CELL_TYPE$5="dropdown",DropdownCellType={CELL_TYPE:CELL_TYPE$5,editor:DropdownEditor,renderer:dropdownRenderer,validator:dropdownValidator,filter:!1,strict:!0,valueGetter,valueSetter:valueSetter$1},CELL_TYPE$4="handsontable",HandsontableCellType={CELL_TYPE:CELL_TYPE$4,editor:HandsontableEditor,renderer:handsontableRenderer};function valueSetter(a){if(typeof a=="string"&&isNumericLike(a)){const s=getParsedNumber(a);return isNullish(s)?a:s}return a}const CELL_TYPE$3="numeric",NumericCellType={CELL_TYPE:CELL_TYPE$3,editor:NumericEditor,renderer:numericRenderer,validator:numericValidator,dataType:"number",valueSetter},CELL_TYPE$2="password",PasswordCellType={CELL_TYPE:CELL_TYPE$2,editor:PasswordEditor,renderer:passwordRenderer,copyable:!1},CELL_TYPE$1="select",SelectCellType={CELL_TYPE:CELL_TYPE$1,editor:SelectEditor,renderer:selectRenderer},CELL_TYPE="time",TimeCellType={CELL_TYPE,editor:TimeEditor,renderer:timeRenderer,validator:timeValidator};function registerAllCellTypes(){_register(AutocompleteCellType),_register(CheckboxCellType),_register(DateCellType),_register(DropdownCellType),_register(HandsontableCellType),_register(NumericCellType),_register(PasswordCellType),_register(SelectCellType),_register(TextCellType),_register(TimeCellType)}function _classPrivateMethodInitSpec$O(a,s){_checkPrivateRedeclaration$10(a,s),s.add(a)}function _defineProperty$1b(a,s,c){return(s=_toPropertyKey$1b(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1b(a){var s=_toPrimitive$1b(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1b(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldInitSpec$K(a,s,c){_checkPrivateRedeclaration$10(a,s),s.set(a,c)}function _checkPrivateRedeclaration$10(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$J(a,s,c){return a.set(_assertClassBrand$10(a,s),c),c}function _classPrivateFieldGet$K(a,s){return a.get(_assertClassBrand$10(a,s))}function _assertClassBrand$10(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const DEPS_TYPE_CHECKERS=new Map([["plugin",hasPlugin],["cell-type",hasItem],["editor",hasItem$3],["renderer",hasItem$2],["validator",hasItem$1]]),defaultMainSettingSymbol=Symbol("mainSetting"),PLUGIN_KEY$C="base",missingDepsMsgs=[];let initializedPlugins=null;var _pluginSettings=new WeakMap,_hooks=new WeakMap,_BasePlugin_brand=new WeakSet;class BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$C}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(s){_classPrivateMethodInitSpec$O(this,_BasePlugin_brand),_classPrivateFieldInitSpec$K(this,_pluginSettings,null),_defineProperty$1b(this,"eventManager",new EventManager(this)),_defineProperty$1b(this,"pluginName",null),_defineProperty$1b(this,"pluginsInitializedCallbacks",[]),_defineProperty$1b(this,"isPluginsReady",!1),_defineProperty$1b(this,"enabled",!1),_defineProperty$1b(this,"initialized",!1),_classPrivateFieldInitSpec$K(this,_hooks,{}),defineGetter(this,"hot",s,{writable:!1}),initializedPlugins=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",c=>this.onUpdateSettings(c)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const s=this.constructor.PLUGIN_DEPS,c=Array.isArray(s)?s:[];if(c.length>0){const d=[];if(c.forEach(h=>{const[f,g]=h.split(":");if(!DEPS_TYPE_CHECKERS.has(f))throw new Error(`Unknown plugin dependency type "${f}" was found.`);DEPS_TYPE_CHECKERS.get(f)(g)||d.push(` - ${g} (${f})`)}),d.length>0){const h=[`The ${this.pluginName} plugin requires the following modules:
`,`${d.join(`
`)}
`].join("");missingDepsMsgs.push(h)}}if(initializedPlugins||(initializedPlugins=getPluginsNames()),initializedPlugins.indexOf(this.pluginName)>=0&&initializedPlugins.splice(initializedPlugins.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),initializedPlugins.length===0){if(missingDepsMsgs.length>0){const d=[`${missingDepsMsgs.join(`
`)}
`,"You have to import and register them manually."].join("");throw missingDepsMsgs.length=0,new Error(d)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var s;(s=this.eventManager)===null||s===void 0||s.clear(),this.clearHooks(),this.enabled=!1}getSetting(s){var c=this;const u=this.constructor.DEFAULT_SETTINGS,d=this.constructor.SETTINGS_VALIDATORS;if(s===void 0)return isObject(_classPrivateFieldGet$K(_pluginSettings,this))?assignObjectDefaults(_classPrivateFieldGet$K(_pluginSettings,this),u):_classPrivateFieldGet$K(_pluginSettings,this);let h;if((Array.isArray(_classPrivateFieldGet$K(_pluginSettings,this))||isObject(_classPrivateFieldGet$K(_pluginSettings,this)))&&u[defaultMainSettingSymbol]===s)if(Array.isArray(_classPrivateFieldGet$K(_pluginSettings,this)))h=_classPrivateFieldGet$K(_pluginSettings,this);else{var f;h=(f=_classPrivateFieldGet$K(_pluginSettings,this)[s])!==null&&f!==void 0?f:u[s]}else if(s.includes(".")){const g=getProperty(_classPrivateFieldGet$K(_pluginSettings,this),s),m=getProperty(u,s);isObject(g)?h=assignObjectDefaults(g,m):h=g!==void 0?g:m}else isObject(_classPrivateFieldGet$K(_pluginSettings,this))?h=assignObjectDefaults(_classPrivateFieldGet$K(_pluginSettings,this),u)[s]:h=u[s];if(typeof h=="function"&&d&&typeof d=="object"){const g=d[s];if(g&&typeof g=="function")return function(){for(var m=arguments.length,p=new Array(m),v=0;v<m;v++)p[v]=arguments[v];const w=h(...p);if(g(w)===!1){const C=p.map(P=>typeof P=="string"?`"${P}"`:"").join(", "),b=p.length>0?C:"";warn$1(`${c.pluginName} Plugin: "${s}" function (${b}) result                is not valid and will be ignored.`);return}return w}}return h}updatePluginSettings(s){const c=this.constructor.SETTINGS_VALIDATORS;if(c&&typeof c=="function"&&typeof s!="object"){if(c(s)===!1){warn$1(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return _classPrivateFieldSet$J(_pluginSettings,this,s),_classPrivateFieldGet$K(_pluginSettings,this)}return c&&typeof c=="object"&&typeof s=="object"?((_classPrivateFieldGet$K(_pluginSettings,this)===null||typeof _classPrivateFieldGet$K(_pluginSettings,this)!="object")&&_classPrivateFieldSet$J(_pluginSettings,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(c).forEach(u=>{if(!(u in s))return;const d=c[u];if((d?d(s[u]):!0)===!1){warn$1(`${this.pluginName} Plugin: "${u}" option is not valid and it will be ignored.`);return}_classPrivateFieldGet$K(_pluginSettings,this)[u]=s[u]}),_classPrivateFieldGet$K(_pluginSettings,this)):(_classPrivateFieldSet$J(_pluginSettings,this,s),s)}addHook(s,c,u){_classPrivateFieldGet$K(_hooks,this)[s]=_classPrivateFieldGet$K(_hooks,this)[s]||[];const d=_classPrivateFieldGet$K(_hooks,this)[s];this.hot.addHook(s,c,u),d.push(c),_classPrivateFieldGet$K(_hooks,this)[s]=d}removeHooks(s){arrayEach(_classPrivateFieldGet$K(_hooks,this)[s]||[],c=>{this.hot.removeHook(s,c)})}clearHooks(){const s=_classPrivateFieldGet$K(_hooks,this);objectEach(s,(c,u)=>this.removeHooks(u)),s.length=0}callOnPluginsReady(s){this.isPluginsReady?s():this.pluginsInitializedCallbacks.push(s)}onAfterPluginsInitialized(){arrayEach(this.pluginsInitializedCallbacks,s=>s()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(s){const c=_assertClassBrand$10(_BasePlugin_brand,this,_isRelevantToSettings).call(this,s);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&c&&(this.updatePluginSettings(s[this.constructor.PLUGIN_KEY]),this.updatePlugin(s)))}updatePlugin(){}destroy(){var s;_classPrivateFieldSet$J(_pluginSettings,this,null),(s=this.eventManager)===null||s===void 0||s.destroy(),this.clearHooks(),objectEach(this,(c,u)=>{u!=="hot"&&(this[u]=null)}),delete this.t,delete this.hot}}function _isRelevantToSettings(a){if(!a)return!1;const s=this.constructor.SETTING_KEYS;if(typeof s=="boolean")return s;for(let c=0;c<s.length;c++)if(a[s[c]]!==void 0)return!0;return!1}function _defineProperty$1a(a,s,c){return(s=_toPropertyKey$1a(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1a(a){var s=_toPrimitive$1a(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1a(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}let GhostTable$1=class{constructor(s){_defineProperty$1a(this,"hot",null),_defineProperty$1a(this,"container",null),_defineProperty$1a(this,"injected",!1),_defineProperty$1a(this,"rows",[]),_defineProperty$1a(this,"columns",[]),_defineProperty$1a(this,"samples",null),_defineProperty$1a(this,"settings",{useHeaders:!0}),this.hot=s}addRow(s,c){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const u={row:s};this.rows.push(u),this.samples=c,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(s)),this.table.tr.appendChild(this.createRow(s)),this.container.container.appendChild(this.table.fragment),u.table=this.table.table}addColumnHeadersRow(s){const c=this.hot.getColHeader(0);if(c!=null){const u={row:-1};this.rows.push(u),this.container=this.createContainer(this.hot.rootElement.className),this.samples=s,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),u.table=this.table.table}}addColumn(s,c){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const u={col:s};this.columns.push(u),this.samples=c,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(s)!==null&&this.hot.view.appendColHeader(s,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(s)),this.container.container.appendChild(this.table.fragment),u.table=this.table.table}getHeights(s){this.injected||this.injectTable(),arrayEach(this.rows,c=>{const{height:u}=c.table.getBoundingClientRect();s(c.row,Math.ceil(u))})}getWidths(s){this.injected||this.injectTable(),arrayEach(this.columns,c=>{const{width:u}=c.table.getBoundingClientRect();s(c.col,Math.ceil(u))})}setSettings(s){this.settings=s}setSetting(s,c){this.settings||(this.settings={}),this.settings[s]=c}getSettings(){return this.settings}getSetting(s){return this.settings?this.settings[s]:null}createColGroupsCol(s){const c=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&c.appendChild(this.createColElement(-1,-1)),this.samples.forEach(u=>{arrayEach(u.strings,d=>{c.appendChild(this.createColElement(d.col,s))})}),c}createRow(s){const{rootDocument:c}=this.hot,u=c.createDocumentFragment(),d=c.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(s,d),u.appendChild(d)),this.samples.forEach(h=>{arrayEach(h.strings,f=>{const g=f.col,m=this.hot.getCellMeta(s,g),p=this.hot.getCellRenderer(m),v=c.createElement("td");v.setAttribute("ghost-table",1),p(this.hot,v,s,g,this.hot.colToProp(g),f.value,m),u.appendChild(v)})}),u}appendColumnHeadersRow(){const{rootDocument:s}=this.hot,c=s.createDocumentFragment(),u=[];if(this.hot.hasRowHeaders()){const d=s.createElement("th");u.push([-1,d]),c.appendChild(d)}this.samples.forEach(d=>{arrayEach(d.strings,h=>{const f=h.col,g=s.createElement("th");u.push([f,g]),c.appendChild(g)})}),this.table.tHead.appendChild(c),arrayEach(u,d=>{const[h,f]=d;this.hot.view.appendColHeader(h,f)})}createCol(s){const{rootDocument:c}=this.hot,u=c.createDocumentFragment();return this.samples.forEach(d=>{arrayEach(d.strings,h=>{const f=h.row,g=this.hot.getCellMeta(f,s),m=this.hot.getCellRenderer(g),p=c.createElement("td"),v=c.createElement("tr");p.setAttribute("ghost-table",1),m(this.hot,p,f,s,this.hot.colToProp(s),h.value,g),v.appendChild(p),u.appendChild(v)})}),u}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((s||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(s,c){const u=this.hot.rootDocument.createElement("col");let d=0;c>=0&&s>=0&&(d=this.hot.getCellMeta(c,s).colspan);let h=this.hot.getColWidth(s);if(d>1)for(let f=s+1;f<s+d;f++)h+=this.hot.getColWidth(f);return u.style.width=`${h}px`,u}createTable(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:c}=this.hot,u=c.createDocumentFragment(),d=c.createElement("table"),h=c.createElement("thead"),f=c.createElement("tbody"),g=c.createElement("colgroup"),m=c.createElement("tr"),p=c.createElement("th");return this.isVertical()&&d.appendChild(g),this.isHorizontal()&&(m.appendChild(p),h.appendChild(m),d.style.tableLayout="auto",d.style.width="auto"),d.appendChild(h),this.isVertical()&&f.appendChild(m),d.appendChild(f),addClass$1(d,s),u.appendChild(d),{fragment:u,table:d,tHead:h,tBody:f,colGroup:g,tr:m,th:p}}createContainer(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:c}=this.hot,u=c.createDocumentFragment(),d=c.createElement("div"),h=`htGhostTable htAutoSize ${s.trim()}`;return addClass$1(d,h),u.appendChild(d),{fragment:u,container:d}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function _defineProperty$19(a,s,c){return(s=_toPropertyKey$19(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$19(a){var s=_toPrimitive$19(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$19(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class SamplesGenerator{static get SAMPLE_COUNT(){return 3}constructor(s){_defineProperty$19(this,"samples",null),_defineProperty$19(this,"dataFactory",null),_defineProperty$19(this,"customSampleCount",null),_defineProperty$19(this,"allowDuplicates",!1),_defineProperty$19(this,"includeHidden",!1),this.dataFactory=s}getSampleCount(){return this.customSampleCount?this.customSampleCount:SamplesGenerator.SAMPLE_COUNT}setSampleCount(s){this.customSampleCount=s}setAllowDuplicates(s){this.allowDuplicates=s}setIncludeHidden(s){this.includeHidden=s}generateRowSamples(s,c){return this.generateSamples("row",c,s)}generateColumnSamples(s,c){return this.generateSamples("col",c,s)}generateSamples(s,c,u){const d=new Map,{from:h,to:f}=typeof u=="number"?{from:u,to:u}:u;return rangeEach(h,f,g=>{const m=this.generateSample(s,c,g);d.set(g,m)}),d}generateSample(s,c,u){if(s!=="row"&&s!=="col")throw new Error("Unsupported sample type");const d=new Map,h=s==="row"?"col":"row",f=[];return rangeEach(c.from,c.to,g=>{const m=s==="row"?this.dataFactory(u,g,this):this.dataFactory(g,u,this);if(m===!1)return;const{value:p,bundleSeed:v}=m,w=typeof v=="string"&&v.length>0;let E;w?E=v:isObject(p)?E=`${Object.keys(p).length}`:Array.isArray(p)?E=`${p.length}`:E=`${stringify$1(p).length}`,d.has(E)||d.set(E,{needed:this.getSampleCount(),strings:[]});const C=d.get(E);C.needed&&(!(f.indexOf(p)>-1)||this.allowDuplicates||w)&&(C.strings.push({value:p,[h]:g}),f.push(p),C.needed-=1)}),d}}function _classPrivateMethodInitSpec$N(a,s){_checkPrivateRedeclaration$$(a,s),s.add(a)}function _classPrivateFieldInitSpec$J(a,s,c){_checkPrivateRedeclaration$$(a,s),s.set(a,c)}function _checkPrivateRedeclaration$$(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$18(a,s,c){return(s=_toPropertyKey$18(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$18(a){var s=_toPrimitive$18(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$18(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$J(a,s){return a.get(_assertClassBrand$$(a,s))}function _classPrivateFieldSet$I(a,s,c){return a.set(_assertClassBrand$$(a,s),c),c}function _assertClassBrand$$(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutoColumnSizeSeed");const PLUGIN_KEY$B="autoColumnSize",PLUGIN_PRIORITY$B=10,COLUMN_SIZE_MAP_NAME="autoColumnSize";var _isInitialized$1=new WeakMap,_cachedColumnHeaders=new WeakMap,_visualColumnsToRefresh=new WeakMap,_AutoColumnSize_brand=new WeakSet;class AutoColumnSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$B}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$B}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(s){super(s),_classPrivateMethodInitSpec$N(this,_AutoColumnSize_brand),_defineProperty$18(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$18(this,"samplesGenerator",new SamplesGenerator((c,u)=>{const d=this.hot.toPhysicalRow(c),h=this.hot.toPhysicalColumn(u);if(this.hot.rowIndexMapper.isHidden(d)||this.hot.columnIndexMapper.isHidden(h))return!1;const f=this.hot.getCellMeta(c,u);let g="";f.spanned||(g=this.hot.getDataAtCell(c,u));let m="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(m=this.hot.runHooks("modifyAutoColumnSizeSeed",m,f,g)),{value:g,bundleSeed:m}})),_defineProperty$18(this,"inProgress",!1),_defineProperty$18(this,"measuredColumns",0),_defineProperty$18(this,"columnWidthsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$J(this,_isInitialized$1,!1),_classPrivateFieldInitSpec$J(this,_cachedColumnHeaders,[]),_classPrivateFieldInitSpec$J(this,_visualColumnsToRefresh,[]),this.hot.columnIndexMapper.registerMap(COLUMN_SIZE_MAP_NAME,this.columnWidthsMap),this.addHook("beforeColumnResize",(c,u,d)=>_assertClassBrand$$(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,c,u,d))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$B]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var s=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const c=this.getSetting("samplingRatio");c&&!isNaN(c)&&this.samplesGenerator.setSampleCount(parseInt(c,10)),this.addHook("afterLoadData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$$(_AutoColumnSize_brand,s,_onAfterLoadData$8).call(s,...d)}),this.addHook("beforeChangeRender",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$$(_AutoColumnSize_brand,s,_onBeforeChange$1).call(s,...d)}),this.addHook("afterFormulasValuesUpdate",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$$(_AutoColumnSize_brand,s,_onAfterFormulasValuesUpdate$1).call(s,...d)}),this.addHook("beforeRender",()=>_assertClassBrand$$(_AutoColumnSize_brand,this,_onBeforeRender$2).call(this)),this.addHook("modifyColWidth",(u,d)=>this.getColumnWidth(d,u)),this.addHook("init",()=>_assertClassBrand$$(_AutoColumnSize_brand,this,_onInit$4).call(this)),super.enablePlugin()}updatePlugin(){_classPrivateFieldSet$I(_visualColumnsToRefresh,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(s,c,u)=>_assertClassBrand$$(_AutoColumnSize_brand,this,_onBeforeColumnResize$1).call(this,s,c,u))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const s=this.getFirstVisibleColumn(),c=this.getLastVisibleColumn();if(s===-1||c===-1)return;const u=this.hot.forceFullRender;this.calculateColumnsWidth({from:s,to:c},void 0,u)}calculateColumnsWidth(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=typeof s=="number"?{from:s,to:s}:s,h=typeof c=="number"?{from:c,to:c}:c;rangeEach(d.from,d.to,f=>{let g=this.hot.toPhysicalColumn(f);g===null&&(g=f),(u||this.columnWidthsMap.getValueAtIndex(g)===null&&!this.hot._getColWidthFromSettings(g))&&_assertClassBrand$$(_AutoColumnSize_brand,this,_fillGhostTableWithSamples).call(this,f,h)}),this.ghostTable.columns.length&&(_assertClassBrand$$(_AutoColumnSize_brand,this,_updateColumnWidthsMapBasedOnGhostTable).call(this),this.measuredColumns=d.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=0;const d=this.hot.countCols()-1;let h=null;this.inProgress=!0;const f=()=>{if(!this.hot){cancelAnimationFrame(h),this.inProgress=!1;return}this.calculateColumnsWidth({from:u,to:Math.min(u+AutoColumnSize.CALCULATION_STEP,d)},s,c),u=u+AutoColumnSize.CALCULATION_STEP+1,u<d?h=requestAnimationFrame$1(f):(cancelAnimationFrame(h),this.inProgress=!1,this.hot.view.adjustElementsSize())},g=this.getSyncCalculationLimit();g>=0&&(this.calculateColumnsWidth({from:0,to:g},s,c),u=g+1),u<d?f():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const s=this.hot.getSettings()[PLUGIN_KEY$B];let c=AutoColumnSize.SYNC_CALCULATION_LIMIT;const u=this.hot.countCols()-1;return isObject(s)&&(c=s.syncLimit,isPercentValue(c)?c=valueAccordingPercent(u,c):c>>=0),Math.min(c,u)}getColumnWidth(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,d=c;return d===void 0&&(d=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(s)),u&&typeof d=="number"&&(d=Math.max(d,DEFAULT_WIDTH))),d}getFirstVisibleColumn(){var s;return(s=this.hot.getFirstRenderedVisibleColumn())!==null&&s!==void 0?s:-1}getLastVisibleColumn(){var s;return(s=this.hot.getLastRenderedVisibleColumn())!==null&&s!==void 0?s:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((u,d,h)=>{const f=_classPrivateFieldGet$J(_cachedColumnHeaders,this).length;return(f-1<h||_classPrivateFieldGet$J(_cachedColumnHeaders,this)[h]!==d)&&u.push(this.hot.toVisualColumn(h)),f-1<h?_classPrivateFieldGet$J(_cachedColumnHeaders,this).push(d):_classPrivateFieldGet$J(_cachedColumnHeaders,this)[h]=d,u},[])}clearCache(s){Array.isArray(s)?this.hot.batchExecution(()=>{s.forEach(c=>{this.columnWidthsMap.setValueAtIndex(c,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(s=>s===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificColumnsWidth(a){const s={from:0,to:this.hot.countRows()-1};a.forEach(c=>{const u=this.hot.toPhysicalColumn(c);u!==null&&(this.hot._getColWidthFromSettings(u)||_assertClassBrand$$(_AutoColumnSize_brand,this,_fillGhostTableWithSamples).call(this,c,s))}),this.ghostTable.columns.length&&(_assertClassBrand$$(_AutoColumnSize_brand,this,_updateColumnWidthsMapBasedOnGhostTable).call(this),this.ghostTable.clean())}function _fillGhostTableWithSamples(a,s){this.samplesGenerator.generateColumnSamples(a,s).forEach((u,d)=>this.ghostTable.addColumn(d,u))}function _updateColumnWidthsMapBasedOnGhostTable(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((a,s)=>{const c=this.hot.toPhysicalColumn(a);this.columnWidthsMap.setValueAtIndex(c,s)})},!0)}function _onBeforeRender$2(){this.calculateVisibleColumnsWidth(),this.inProgress||(_assertClassBrand$$(_AutoColumnSize_brand,this,_calculateSpecificColumnsWidth).call(this,_classPrivateFieldGet$J(_visualColumnsToRefresh,this)),_classPrivateFieldSet$I(_visualColumnsToRefresh,this,[]))}function _onAfterLoadData$8(a,s){s||this.recalculateAllColumnsWidth()}function _onBeforeChange$1(a){const s=a.reduce((c,u)=>{let[,d]=u;const h=this.hot.propToCol(d);return Number.isInteger(h)&&c.indexOf(h)===-1&&c.push(h),c},[]);_classPrivateFieldGet$J(_visualColumnsToRefresh,this).push(...s)}function _onBeforeColumnResize$1(a,s,c){let u=a;return c&&(this.calculateColumnsWidth(s,void 0,!0),u=this.getColumnWidth(s,void 0,!1)),u}function _onInit$4(){_classPrivateFieldSet$I(_cachedColumnHeaders,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),_classPrivateFieldSet$I(_isInitialized$1,this,!0)}function _onAfterFormulasValuesUpdate$1(a){if(!_classPrivateFieldGet$J(_isInitialized$1,this))return;const s=a.reduce((c,u)=>{var d;const h=(d=u.address)===null||d===void 0?void 0:d.col;if(Number.isInteger(h)){const f=this.hot.toVisualColumn(h);c.indexOf(f)===-1&&c.push(f)}return c},[]);_classPrivateFieldGet$J(_visualColumnsToRefresh,this).push(...s)}const DIRECTIONS={horizontal:"horizontal",vertical:"vertical"};function getDragDirectionAndRange(a,s,c){let u,d,h;return s[0]===a[0]&&s[1]<a[1]?(h="left",u=c(s[0],s[1]),d=c(s[2],a[1]-1)):s[2]===a[2]&&s[0]===a[0]&&s[3]>a[3]?(h="right",u=c(s[0],a[3]+1),d=c(s[2],s[3])):s[0]<a[0]&&s[1]===a[1]?(h="up",u=c(s[0],s[1]),d=c(a[0]-1,s[3])):s[2]>a[2]&&s[1]===a[1]&&(h="down",u=c(a[2]+1,s[1]),d=c(s[2],s[3])),u&&u.normalize(),d&&d.normalize(),{directionOfDrag:h,startOfDragCoords:u,endOfDragCoords:d}}function getMappedFillHandleSetting(a){const s={};return a===!0?(s.directions=Object.keys(DIRECTIONS),s.autoInsertRow=!0):isObject(a)?(isDefined(a.autoInsertRow)?a.direction===DIRECTIONS.horizontal?s.autoInsertRow=!1:s.autoInsertRow=a.autoInsertRow:s.autoInsertRow=!1,isDefined(a.direction)?s.directions=[a.direction]:s.directions=Object.keys(DIRECTIONS)):typeof a=="string"?(s.directions=[a],s.autoInsertRow=!0):(s.directions=[],s.autoInsertRow=!1),s}function _classPrivateMethodInitSpec$M(a,s){_checkPrivateRedeclaration$_(a,s),s.add(a)}function _checkPrivateRedeclaration$_(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$17(a,s,c){return(s=_toPropertyKey$17(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$17(a){var s=_toPrimitive$17(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$17(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$_(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("modifyAutofillRange"),Hooks.getSingleton().register("beforeAutofill"),Hooks.getSingleton().register("afterAutofill");const PLUGIN_KEY$A="autofill",PLUGIN_PRIORITY$A=20,SETTING_KEYS$3=["fillHandle"],INSERT_ROW_ALTER_ACTION_NAME="insert_row_below",INTERVAL_FOR_ADDING_ROW=200;var _Autofill_brand=new WeakSet;class Autofill extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$M(this,_Autofill_brand),_defineProperty$17(this,"addingStarted",!1),_defineProperty$17(this,"mouseDownOnCellCorner",!1),_defineProperty$17(this,"mouseDragOutside",!1),_defineProperty$17(this,"handleDraggedCells",0),_defineProperty$17(this,"directions",[]),_defineProperty$17(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$A}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$A}static get SETTING_KEYS(){return[PLUGIN_KEY$A,...SETTING_KEYS$3]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",s=>_assertClassBrand$_(_Autofill_brand,this,_onAfterCellCornerMouseDown).call(this,s)),this.addHook("afterOnCellCornerDblClick",s=>_assertClassBrand$_(_Autofill_brand,this,_onCellCornerDblClick).call(this,s)),this.addHook("beforeOnCellMouseOver",(s,c)=>_assertClassBrand$_(_Autofill_brand,this,_onBeforeCellMouseOver).call(this,c)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const c=this.hot.getSelectedRangeLast(),{row:u,col:d}=c.getTopStartCorner(),{row:h,col:f}=c.getBottomEndCorner(),g=this.hot.runHooks("modifyCopyableRange",[{startRow:u,startCol:d,endRow:h,endCol:f}]),m=[],p=[],v=[];return arrayEach(g,w=>{for(let E=w.startRow;E<=w.endRow;E+=1)m.indexOf(E)===-1&&m.push(E);for(let E=w.startCol;E<=w.endCol;E+=1)p.indexOf(E)===-1&&p.push(E)}),arrayEach(m,w=>{const E=[];arrayEach(p,C=>{const b=s?this.hot.getSourceDataAtCell(w,C):null;s&&isObject(b)?E.push(this.hot.getCopyableSourceData(w,C)):E.push(this.hot.getCopyableData(w,C))}),v.push(E)}),v}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[s,c,u,d]=this.hot.selection.highlight.getFill().getVisualCorners(),h=this.hot.getSelectedRangeLast(),f=h.getTopStartCorner(),g=h.getBottomEndCorner();this.resetSelectionOfDraggedArea();const m=[f.row,f.col,g.row,g.col],p=this.hot.runHooks("modifyAutofillRange",[Math.min(f.row,s),Math.min(f.col,c),Math.max(g.row,u),Math.max(g.col,d)],m),{directionOfDrag:v,startOfDragCoords:w,endOfDragCoords:E}=getDragDirectionAndRange(m,p,(C,b)=>this.hot._createCellCoords(C,b));if(w&&w.row>-1&&w.col>-1){const C=this.getSelectionData(),b=this.getSelectionData(!0),P=h.clone(),R=this.hot._createCellRange(w,w,E),T=this.hot.runHooks("beforeAutofill",C,P,R,v);if(T===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let I=T;const M=T;if(["up","left"].indexOf(v)>-1&&!(M.length===1&&M[0].length===0))if(I=[],v==="up"){const N=E.row-w.row+1,H=N%M.length;for(let L=0;L<N;L++)I.push(M[(L+(M.length-H))%M.length])}else{const N=E.col-w.col+1,H=N%M[0].length;for(let L=0;L<M.length;L++){I.push([]);for(let A=0;A<N;A++)I[L].push(M[L][(A+(M[L].length-H))%M[L].length])}}if(b.some(N=>N.some(H=>isObject(H)))){const N=_assertClassBrand$_(_Autofill_brand,this,_extendFillDataWithSourceData).call(this,I,b,w,E,v);N.length&&(I=N)}this.hot.populateFromArray(w.row,w.col,I,E.row,E.col,`${this.pluginName}.fill`,null),this.setSelection(p),this.hot.runHooks("afterAutofill",I,P,R,v),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(s){return s.row<0&&(s.row=0),s.col<0&&(s.col=0),s}getCoordsOfDragAndDropBorders(s){const c=this.hot.getSelectedRangeLast(),u=c.getBottomEndCorner();let d=s;if(this.directions.includes(DIRECTIONS.vertical)&&this.directions.includes(DIRECTIONS.horizontal)){const h=c.getTopStartCorner();(u.col<=s.col||h.col>=s.col)&&(d=this.hot._createCellCoords(u.row,s.col)),(u.row<s.row||h.row>s.row)&&(d=this.hot._createCellCoords(s.row,u.col))}else if(this.directions.includes(DIRECTIONS.vertical))d=this.hot._createCellCoords(s.row,u.col);else if(this.directions.includes(DIRECTIONS.horizontal))d=this.hot._createCellCoords(u.row,s.col);else return;return this.reduceSelectionAreaIfNeeded(d)}showBorder(s){const c=this.getCoordsOfDragAndDropBorders(s);c&&this.redrawBorders(c)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(INSERT_ROW_ALTER_ACTION_NAME,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},INTERVAL_FOR_ADDING_ROW)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const s=this.hot.getSelectedLast(),c=this.hot.selection.highlight.getFill().getVisualCorners(),u=this.hot.countRows();s[2]<u-1&&c[2]===u-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(s){const c=this.hot.getData(),u=this.hot.countRows();let d;for(let h=s[2]+1;h<u;h++){for(let m=s[1];m<=s[3];m++){const p=c[h][m];if(!isEmpty(p))return-1}const f=c[h][s[1]-1],g=c[h][s[3]+1];(!isEmpty(f)||!isEmpty(g))&&(d=h)}return d}addSelectionFromStartAreaToSpecificRowIndex(s,c){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(s[0],s[1])).add(this.hot._createCellCoords(c,s[3])).commit()}setSelection(s){this.hot.selectCell(...arrayMap(s,c=>Math.max(c,0)),!1,!1)}selectAdjacent(){const s=this.hot.getSelectedLast(),c=this.getIndexOfLastAdjacentFilledInRow(s);return c===-1||c===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(s,c),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(s){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(s).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(s){const{documentElement:c}=this.hot.rootDocument,u=offset(this.hot.table).top-(this.hot.rootWindow.pageYOffset||c.scrollTop)+outerHeight(this.hot.table),d=offset(this.hot.table).left-(this.hot.rootWindow.pageXOffset||c.scrollLeft)+outerWidth(this.hot.table);return s.clientY>u&&s.clientX<=d}registerEvents(){const{documentElement:s}=this.hot.rootDocument;this.eventManager.addEventListener(s,"mouseup",()=>_assertClassBrand$_(_Autofill_brand,this,_onMouseUp$5).call(this)),this.eventManager.addEventListener(s,"mousemove",c=>_assertClassBrand$_(_Autofill_brand,this,_onMouseMove$4).call(this,c))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const s=getMappedFillHandleSetting(this.hot.getSettings().fillHandle);this.directions=s.directions,this.autoInsertRow=s.autoInsertRow}destroy(){super.destroy()}}function _extendFillDataWithSourceData(a,s,c,u){const d=[];for(let h=Math.min(c.row,u.row);h<=Math.max(c.row,u.row);h+=1){d.push([]);for(let f=Math.min(c.col,u.col);f<=Math.max(c.col,u.col);f+=1){const g=this.hot.getSourceDataAtCell(h,f),m=h-Math.min(c.row,u.row),p=f-Math.min(c.col,u.col),v=m%s.length,w=p%s[0].length;isObject(g)?d[m][p]=s[v][w]:d[m][p]=a[v][w]}}return d}function _onCellCornerDblClick(){this.selectAdjacent()&&this.fillIn()}function _onAfterCellCornerMouseDown(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function _onBeforeCellMouseOver(a){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(a),this.addNewRowIfNeeded())}function _onMouseUp$5(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function _onMouseMove$4(a){const s=this.getIfMouseWasDraggedOutside(a);this.addingStarted===!1&&this.handleDraggedCells>0&&s?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function _classPrivateMethodInitSpec$L(a,s){_checkPrivateRedeclaration$Z(a,s),s.add(a)}function _classPrivateFieldInitSpec$I(a,s,c){_checkPrivateRedeclaration$Z(a,s),s.set(a,c)}function _checkPrivateRedeclaration$Z(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$16(a,s,c){return(s=_toPropertyKey$16(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$16(a){var s=_toPrimitive$16(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$16(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldSet$H(a,s,c){return a.set(_assertClassBrand$Z(a,s),c),c}function _classPrivateFieldGet$I(a,s){return a.get(_assertClassBrand$Z(a,s))}function _assertClassBrand$Z(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$z="autoRowSize",PLUGIN_PRIORITY$z=40,ROW_WIDTHS_MAP_NAME="autoRowSize",FIRST_COLUMN_NOT_RENDERED_CLASS_NAME="htFirstDatasetColumnNotRendered",AUTO_ROW_SIZE_CLASS_NAME="htAutoRowSize";var _visualRowsToRefresh=new WeakMap,_isInitialized=new WeakMap,_AutoRowSize_brand=new WeakSet;class AutoRowSize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$z}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$z}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(s){super(s),_classPrivateMethodInitSpec$L(this,_AutoRowSize_brand),_defineProperty$16(this,"headerHeight",null),_defineProperty$16(this,"ghostTable",new GhostTable$1(this.hot)),_defineProperty$16(this,"samplesGenerator",new SamplesGenerator((c,u)=>{const d=this.hot.toPhysicalColumn(u);if(this.hot.columnIndexMapper.isHidden(d)||c>=0&&u>=0&&this.hot.getCellMeta(c,u).hidden)return!1;let h;return c>=0?h=this.hot.getDataAtCell(c,u):c===-1&&(h=this.hot.getColHeader(u)),{value:h}})),_defineProperty$16(this,"inProgress",!1),_defineProperty$16(this,"measuredRows",0),_defineProperty$16(this,"rowHeightsMap",new PhysicalIndexToValueMap),_classPrivateFieldInitSpec$I(this,_visualRowsToRefresh,[]),_classPrivateFieldInitSpec$I(this,_isInitialized,!1),this.hot.rowIndexMapper.registerMap(ROW_WIDTHS_MAP_NAME,this.rowHeightsMap),this.addHook("beforeRowResize",(c,u,d)=>_assertClassBrand$Z(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,c,u,d))}isEnabled(){const s=this.hot.getSettings()[PLUGIN_KEY$z];return s===!0||isObject(s)}enablePlugin(){var s=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const c=this.getSetting("samplingRatio");c&&!isNaN(c)&&this.samplesGenerator.setSampleCount(parseInt(c,10)),this.addHook("afterLoadData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$Z(_AutoRowSize_brand,s,_onAfterLoadData$7).call(s,...d)}),this.addHook("beforeChangeRender",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$Z(_AutoRowSize_brand,s,_onBeforeChange).call(s,...d)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$Z(_AutoRowSize_brand,s,_onAfterFormulasValuesUpdate).call(s,...d)}),this.addHook("beforeViewRender",()=>_assertClassBrand$Z(_AutoRowSize_brand,this,_onBeforeViewRender$1).call(this)),this.addHook("beforeRender",()=>_assertClassBrand$Z(_AutoRowSize_brand,this,_onBeforeRender$1).call(this)),this.addHook("modifyRowHeight",(u,d)=>this.getRowHeight(d,u)),this.addHook("init",()=>_assertClassBrand$Z(_AutoRowSize_brand,this,_onInit$3).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),addClass$1(this.hot.rootElement,AUTO_ROW_SIZE_CLASS_NAME),super.enablePlugin()}disablePlugin(){this.headerHeight=null,removeClass$1(this.hot.rootElement,AUTO_ROW_SIZE_CLASS_NAME),super.disablePlugin(),_assertClassBrand$Z(_AutoRowSize_brand,this,_toggleFirstDatasetColumnRenderedClassName).call(this,!1),this.addHook("beforeRowResize",(s,c,u)=>_assertClassBrand$Z(_AutoRowSize_brand,this,_onBeforeRowResize).call(this,s,c,u))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const s=this.getFirstVisibleRow(),c=this.getLastVisibleRow();if(s===-1||c===-1)return;const u=this.hot.forceFullRender;this.calculateRowsHeight({from:s,to:c},void 0,u)}calculateRowsHeight(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=typeof s=="number"?{from:s,to:s}:s,h=typeof c=="number"?{from:c,to:c}:c;if(this.hot.getColHeader(0)!==null){const f=this.samplesGenerator.generateRowSamples(-1,h);this.ghostTable.addColumnHeadersRow(f.get(-1))}rangeEach(d.from,d.to,f=>{let g=this.hot.toPhysicalRow(f);g===null&&(g=f),(u||this.rowHeightsMap.getValueAtIndex(g)===null)&&this.samplesGenerator.generateRowSamples(f,h).forEach((p,v)=>this.ghostTable.addRow(v,p))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((f,g)=>{f<0?this.headerHeight=g:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(f),g)})},!0),this.measuredRows=d.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=0;const d=this.hot.countRows()-1;let h=null;this.inProgress=!0;const f=()=>{if(!this.hot){cancelAnimationFrame(h),this.inProgress=!1;return}this.calculateRowsHeight({from:u,to:Math.min(u+AutoRowSize.CALCULATION_STEP,d)},s,c),u=u+AutoRowSize.CALCULATION_STEP+1,u<d?h=requestAnimationFrame$1(f):(cancelAnimationFrame(h),this.inProgress=!1,this.hot.view.adjustElementsSize())},g=this.getSyncCalculationLimit();g>=0&&(this.calculateRowsHeight({from:0,to:g},s,c),u=g+1),u<d?f():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const s=this.hot.getSettings()[PLUGIN_KEY$z];let c=AutoRowSize.SYNC_CALCULATION_LIMIT;const u=this.hot.countRows()-1;return isObject(s)&&(c=s.syncLimit,isPercentValue(c)?c=valueAccordingPercent(u,c):c>>=0),Math.min(c,u)}getRowHeight(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight(s);if(s<0){var u;return(u=this.headerHeight)!==null&&u!==void 0?u:c}const d=this.hot.toPhysicalRow(s);if(this.hot.rowIndexMapper.isHidden(d))return c;const h=this.rowHeightsMap.getValueAtIndex(d);let f=c;return h!==null&&h>c&&(f=h,!this.hot.stylesHandler.isClassicTheme()&&s===this.hot.view.getFirstRenderedVisibleRow()&&(f+=1)),f}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var s;return(s=this.hot.getFirstRenderedVisibleRow())!==null&&s!==void 0?s:-1}getLastVisibleRow(){var s;return(s=this.hot.getLastRenderedVisibleRow())!==null&&s!==void 0?s:-1}clearCache(s){this.headerHeight=null,Array.isArray(s)?this.hot.batchExecution(()=>{s.forEach(c=>{this.rowHeightsMap.setValueAtIndex(c,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(s){const{from:c,to:u}=typeof s=="number"?{from:s,to:s}:s;this.hot.batchExecution(()=>{rangeEach(Math.min(c,u),Math.max(c,u),d=>{this.rowHeightsMap.setValueAtIndex(d,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(s=>s===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function _calculateSpecificRowsHeight(a){const s={from:0,to:this.hot.countCols()-1};a.forEach(c=>{this.samplesGenerator.generateRowSamples(c,s).forEach((d,h)=>this.ghostTable.addRow(h,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((c,u)=>{const d=this.hot.toPhysicalRow(c);this.rowHeightsMap.setValueAtIndex(d,u)})},!0),this.ghostTable.clean())}function _toggleFirstDatasetColumnRenderedClassName(a){const s=this.hot.getFirstRenderedVisibleColumn(),c=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(s);a===!1||c===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?removeClass$1(this.hot.rootElement,FIRST_COLUMN_NOT_RENDERED_CLASS_NAME):addClass$1(this.hot.rootElement,FIRST_COLUMN_NOT_RENDERED_CLASS_NAME)}function _onBeforeViewRender$1(){_assertClassBrand$Z(_AutoRowSize_brand,this,_toggleFirstDatasetColumnRenderedClassName).call(this)}function _onBeforeRender$1(){this.calculateVisibleRowsHeight(),this.inProgress||(_assertClassBrand$Z(_AutoRowSize_brand,this,_calculateSpecificRowsHeight).call(this,_classPrivateFieldGet$I(_visualRowsToRefresh,this)),_classPrivateFieldSet$H(_visualRowsToRefresh,this,[]))}function _onBeforeRowResize(a,s,c){let u=a;return c&&(this.calculateRowsHeight(s,void 0,!0),u=this.getRowHeight(s)),u}function _onAfterLoadData$7(a,s){s||this.recalculateAllRowsHeight()}function _onBeforeChange(a){const s=a.reduce((c,u)=>{let[d]=u;return c.indexOf(d)===-1&&c.push(d),c},[]);_classPrivateFieldGet$I(_visualRowsToRefresh,this).push(...s)}function _onInit$3(){this.recalculateAllRowsHeight(),_classPrivateFieldSet$H(_isInitialized,this,!0)}function _onAfterFormulasValuesUpdate(a){if(!_classPrivateFieldGet$I(_isInitialized,this))return;const s=a.reduce((c,u)=>{var d;const h=(d=u.address)===null||d===void 0?void 0:d.row;if(Number.isInteger(h)){const f=this.hot.toVisualRow(h);c.indexOf(f)===-1&&c.push(f)}return c},[]);_classPrivateFieldGet$I(_visualRowsToRefresh,this).push(...s)}const{getListWithInsertedItems:getListWithInsertedItems$1,getListWithRemovedItems:getListWithRemovedItems$1}=alterUtilsFactory("physicallyIndexed");class LooseBindsMap extends IndexMap{constructor(){super(s=>s)}insert(s,c){const u=getIncreasedIndexes(this.indexedValues,c);this.indexedValues=getListWithInsertedItems$1(u,s,c,this.initValueOrFn),super.insert(s,c)}remove(s){const c=getListWithRemovedItems$1(this.indexedValues,s);this.indexedValues=getDecreasedIndexes(c,s),super.remove(s)}}const{getListWithInsertedItems,getListWithRemovedItems}=alterUtilsFactory("physicallyIndexed");class StrictBindsMap extends IndexMap{constructor(){super(s=>s)}insert(s,c){this.indexedValues=getListWithInsertedItems(this.indexedValues,s,c,(u,d)=>this.getNextValue(d)),super.insert(s,c)}remove(s){this.indexedValues=getListWithRemovedItems(this.indexedValues,s),super.remove(s)}getNextValue(s){return Math.max(...this.getValues())+1+s}}function _classPrivateMethodInitSpec$K(a,s){_checkPrivateRedeclaration$Y(a,s),s.add(a)}function _checkPrivateRedeclaration$Y(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$15(a,s,c){return(s=_toPropertyKey$15(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$15(a){var s=_toPrimitive$15(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$15(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$Y(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$y="bindRowsWithHeaders",PLUGIN_PRIORITY$y=210,DEFAULT_BIND="loose",bindTypeToMapStrategy=new Map([["loose",LooseBindsMap],["strict",StrictBindsMap]]);var _BindRowsWithHeaders_brand=new WeakSet;class BindRowsWithHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$K(this,_BindRowsWithHeaders_brand),_defineProperty$15(this,"headerIndexes",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$y}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$y}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$y]}enablePlugin(){var s;if(this.enabled)return;const c=(s=bindTypeToMapStrategy.get(this.getSetting()))!==null&&s!==void 0?s:bindTypeToMapStrategy.get(DEFAULT_BIND);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new c),this.addHook("modifyRowHeader",u=>_assertClassBrand$Y(_BindRowsWithHeaders_brand,this,_onModifyRowHeader).call(this,u)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function _onModifyRowHeader(a){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(a))}function _classPrivateMethodInitSpec$J(a,s){_checkPrivateRedeclaration$X(a,s),s.add(a)}function _classPrivateFieldInitSpec$H(a,s,c){_checkPrivateRedeclaration$X(a,s),s.set(a,c)}function _checkPrivateRedeclaration$X(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$14(a,s,c){return(s=_toPropertyKey$14(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$14(a){var s=_toPrimitive$14(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$14(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$H(a,s){return a.get(_assertClassBrand$X(a,s))}function _classPrivateFieldSet$G(a,s,c){return a.set(_assertClassBrand$X(a,s),c),c}function _assertClassBrand$X(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$x="collapsibleColumns",PLUGIN_PRIORITY$x=290,SETTING_KEYS$2=["nestedHeaders"],COLLAPSIBLE_ELEMENT_CLASS="collapsibleIndicator",SHORTCUTS_GROUP$c=PLUGIN_KEY$x,actionDictionary=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var _collapsedColumnsMap=new WeakMap,_CollapsibleColumns_brand=new WeakSet;class CollapsibleColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$J(this,_CollapsibleColumns_brand),_defineProperty$14(this,"nestedHeadersPlugin",null),_defineProperty$14(this,"headerStateManager",null),_classPrivateFieldInitSpec$H(this,_collapsedColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$x}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$x}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[PLUGIN_KEY$x,...SETTING_KEYS$2]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$x]}enablePlugin(){var s=this;if(this.enabled)return;const{nestedHeaders:c}=this.hot.getSettings();c||warn$1("You need to configure the Nested Headers plugin in order to use collapsible headers."),_classPrivateFieldSet$G(_collapsedColumnsMap,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>_assertClassBrand$X(_CollapsibleColumns_brand,this,_onInit$2).call(this)),this.addHook("afterLoadData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$X(_CollapsibleColumns_brand,s,_onAfterLoadData$6).call(s,...d)}),this.addHook("afterGetColHeader",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$X(_CollapsibleColumns_brand,s,_onAfterGetColHeader$4).call(s,...d)}),this.addHook("beforeOnCellMouseDown",(u,d,h)=>_assertClassBrand$X(_CollapsibleColumns_brand,this,_onBeforeOnCellMouseDown$6).call(this,u,d,h)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:s}=this.hot.getSettings();typeof s=="boolean"?this.headerStateManager.mapState(c=>({collapsible:c.origColspan>1})):Array.isArray(s)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(s))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),_classPrivateFieldSet$G(_collapsedColumnsMap,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var s;const{row:c,col:u}=this.hot.getSelectedRangeActive().highlight,{collapsible:d,isCollapsed:h,columnIndex:f}=(s=this.headerStateManager.getHeaderTreeNodeData(c,u))!==null&&s!==void 0?s:{};if(d)return h?this.expandSection({row:c,col:f}):this.collapseSection({row:c,col:f}),!1},runOnlyIf:()=>{var s,c;return((s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.isSingle())&&((c=this.hot.getSelectedRangeActive())===null||c===void 0?void 0:c.highlight.isHeader())},group:SHORTCUTS_GROUP$c,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$c)}clearButtons(){if(!this.hot.view)return;const s=this.hot.view._wt.getSetting("columnHeaders").length,c=this.hot.view._wt.wtTable.THEAD,u=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,d=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,h=function(f){f&&f.parentNode.removeChild(f)};rangeEach(0,s-1,f=>{const g=c.childNodes[f],m=u.childNodes[f],p=d?d.childNodes[f]:null;rangeEach(0,g.childNodes.length-1,v=>{let w=g.childNodes[v].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);h(w),m&&m.childNodes[v]&&(w=m.childNodes[v].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),h(w)),d&&p&&p.childNodes[v]&&(w=p.childNodes[v].querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`),h(w))})})}expandSection(s){this.toggleCollapsibleSection([s],"expand")}collapseSection(s){this.toggleCollapsibleSection([s],"collapse")}toggleAllCollapsibleSections(s){const c=this.headerStateManager.mapNodes(u=>{const{collapsible:d,origColspan:h,headerLevel:f,columnIndex:g,isCollapsed:m}=u;if(d===!0&&h>1&&(m&&s==="expand"||!m&&s==="collapse"))return{row:this.headerStateManager.levelToRowCoords(f),col:g}});this.toggleCollapsibleSection(c,s)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(s,c){if(!actionDictionary.has(c))throw new Error(`Unsupported action is passed (${c}).`);if(!Array.isArray(s))return;const u=arrayFilter(s,C=>{let{row:b}=C;return b<0});let d=u.length>0;arrayEach(u,C=>{var b;let{row:P,col:R}=C;const{collapsible:T,isCollapsed:I}=(b=this.headerStateManager.getHeaderSettings(P,R))!==null&&b!==void 0?b:{};if(!T||I&&c==="collapse"||!I&&c==="expand")return d=!1,!1});const h=[],f=[];d&&arrayEach(u,C=>{let{row:b,col:P}=C;const{colspanCompensation:R,affectedColumns:T,rollbackModification:I}=this.headerStateManager.triggerNodeModification(c,b,P);R>0&&(f.push(...T),h.push(I))});const g=this.getCollapsedColumns();let m=[];c==="collapse"?m=arrayUnique([...g,...f]):c==="expand"&&(m=arrayFilter(g,C=>!f.includes(C)));const p=actionDictionary.get(c);if(this.hot.runHooks(p.beforeHook,g,m,d)===!1){arrayEach(h,C=>{C()});return}this.hot.batchExecution(()=>{arrayEach(f,C=>{_classPrivateFieldGet$H(_collapsedColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(C),p.hideColumn)})},!0);const w=this.getCollapsedColumns().length!==g.length,E=this.hot.getSelectedRangeActive();if(c==="collapse"&&w&&E){const{row:C,col:b}=E.highlight;if((this.hot.rowIndexMapper.isHidden(C)||this.hot.columnIndexMapper.isHidden(b))&&f.includes(b)){const R=C>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(C,1,!0):C,T=b>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(b,1,!0):b;R!==null&&T!==null&&this.hot.selectCell(R,T)}}this.hot.runHooks(p.afterHook,g,m,d,w),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return _classPrivateFieldGet$H(_collapsedColumnsMap,this).getHiddenIndexes()}destroy(){_classPrivateFieldSet$G(_collapsedColumnsMap,this,null),super.destroy()}}function _onAfterGetColHeader$4(a,s,c){var u;const{collapsible:d,origColspan:h,isCollapsed:f}=(u=this.headerStateManager.getHeaderSettings(c,a))!==null&&u!==void 0?u:{},g=d&&h>1&&a>=this.hot.getSettings().fixedColumnsStart,m=this.hot.getSettings().ariaTags;let p=s.querySelector(`.${COLLAPSIBLE_ELEMENT_CLASS}`);if(removeAttribute(s,[A11Y_EXPANDED("")[0]]),g)p||(p=this.hot.rootDocument.createElement("div"),addClass$1(p,COLLAPSIBLE_ELEMENT_CLASS),s.querySelector("div:first-child").appendChild(p)),removeClass$1(p,["collapsed","expanded"]),f?(addClass$1(p,"collapsed"),fastInnerText(p,"+"),m&&setAttribute(s,...A11Y_EXPANDED(!1))):(addClass$1(p,"expanded"),fastInnerText(p,"-"),m&&setAttribute(s,...A11Y_EXPANDED(!0))),m&&setAttribute(p,...A11Y_HIDDEN());else{var v;(v=p)===null||v===void 0||v.remove()}}function _onBeforeOnCellMouseDown$6(a,s){hasClass$1(a.target,COLLAPSIBLE_ELEMENT_CLASS)&&(hasClass$1(a.target,"expanded")?(this.eventManager.fireEvent(a.target,"mouseup"),this.toggleCollapsibleSection([s],"collapse")):hasClass$1(a.target,"collapsed")&&(this.eventManager.fireEvent(a.target,"mouseup"),this.toggleCollapsibleSection([s],"expand")),stopImmediatePropagation(a))}function _onInit$2(){this.updatePlugin()}function _onAfterLoadData$6(a,s){s||this.updatePlugin()}function _defineProperty$13(a,s,c){return(s=_toPropertyKey$13(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$13(a){var s=_toPrimitive$13(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$13(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const inheritedColumnProperties=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],SORT_EMPTY_CELLS_DEFAULT=!1,SHOW_SORT_INDICATOR_DEFAULT=!0,HEADER_ACTION_DEFAULT=!0;class ColumnStatesManager{constructor(s,c){_defineProperty$13(this,"hot",void 0),_defineProperty$13(this,"sortingStates",new LinkedPhysicalIndexToValueMap),_defineProperty$13(this,"sortEmptyCells",SORT_EMPTY_CELLS_DEFAULT),_defineProperty$13(this,"indicator",SHOW_SORT_INDICATOR_DEFAULT),_defineProperty$13(this,"headerAction",HEADER_ACTION_DEFAULT),_defineProperty$13(this,"compareFunctionFactory",void 0),_defineProperty$13(this,"mapName",void 0),this.hot=s,this.mapName=c,this.hot.columnIndexMapper.registerMap(c,this.sortingStates)}updateAllColumnsProperties(s){isObject(s)&&objectEach(s,(c,u)=>{inheritedColumnProperties.includes(u)&&(this[u]=c)})}getAllColumnsProperties(){const s={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(s.compareFunctionFactory=this.compareFunctionFactory),s}getSortOrderOfColumn(s){var c;return(c=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(s)))===null||c===void 0?void 0:c.sortOrder}getIndexOfColumnInSortQueue(s){return s=this.hot.toPhysicalColumn(s),this.sortingStates.getEntries().findIndex(c=>{let[u]=c;return u===s})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(s){return isObject(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(s)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(c=>{let[u,d]=c;return{column:this.hot.toVisualColumn(u),...d}})}getColumnSortState(s){const c=this.getSortOrderOfColumn(s);if(isDefined(c))return{column:s,sortOrder:c}}setSortStates(s){this.sortingStates.clear();for(let c=0;c<s.length;c+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(s[c].column),{sortOrder:s[c].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function compareFunctionFactory$4(a,s,c){const u=s.locale;return function(d,h){const{sortEmptyCells:f}=c;return typeof d=="string"&&(d=d.toLocaleLowerCase(u)),typeof h=="string"&&(h=h.toLocaleLowerCase(u)),d===h?DO_NOT_SWAP:isEmpty(d)?isEmpty(h)?DO_NOT_SWAP:f&&a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:isEmpty(h)?f&&a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:isNaN(d)&&!isNaN(h)?a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:!isNaN(d)&&isNaN(h)||(isNaN(d)||isNaN(h)||(d=parseFloat(d),h=parseFloat(h)),d<h)?a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:d>h?a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$4="default";function compareFunctionFactory$3(a,s,c){return function(u,d){const h=parseFloat(u),f=parseFloat(d),{sortEmptyCells:g}=c;if(h===f||isNaN(h)&&isNaN(f))return DO_NOT_SWAP;if(g){if(isEmpty(u))return a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(d))return a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND}return isNaN(h)?FIRST_AFTER_SECOND:isNaN(f)?FIRST_BEFORE_SECOND:h<f?a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:h>f?a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$3="numeric";function compareFunctionFactory$2(a,s,c){const u=s.checkedTemplate,d=s.uncheckedTemplate,{sortEmptyCells:h}=c;return function(f,g){const m=isEmpty(f),p=isEmpty(g),v=m?d:f,w=p?d:g,E=v===d||v===u,C=w===d||w===u;if(h===!1){if(m&&p===!1)return FIRST_AFTER_SECOND;if(m===!1&&p)return FIRST_BEFORE_SECOND}return E===!1&&C?a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:E&&C===!1?a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:E===!1&&C===!1?compareFunctionFactory$4(a,s,c)(f,g):v===d&&w===u?a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:v===u&&w===d?a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP}}const COLUMN_DATA_TYPE$2="checkbox";function compareFunctionFactory$1(a,s,c){return createDateTimeCompareFunction(a,s.dateFormat,c)}const COLUMN_DATA_TYPE$1="date";function compareFunctionFactory(a,s,c){return createDateTimeCompareFunction(a,s.timeFormat,c)}const COLUMN_DATA_TYPE="time",{register:registerCompareFunctionFactory,getItem:getGloballyCompareFunctionFactory,hasItem:hasGloballyCompareFunctionFactory}=staticRegister("sorting.compareFunctionFactory"),{register:registerRootComparator,getItem:getRootComparator}=staticRegister("sorting.mainSortComparator");function getCompareFunctionFactory(a){return hasGloballyCompareFunctionFactory(a)?getGloballyCompareFunctionFactory(a):getGloballyCompareFunctionFactory(COLUMN_DATA_TYPE$4)}registerCompareFunctionFactory(COLUMN_DATA_TYPE$2,compareFunctionFactory$2),registerCompareFunctionFactory(COLUMN_DATA_TYPE$1,compareFunctionFactory$1),registerCompareFunctionFactory(COLUMN_DATA_TYPE$4,compareFunctionFactory$4),registerCompareFunctionFactory(COLUMN_DATA_TYPE$3,compareFunctionFactory$3),registerCompareFunctionFactory(COLUMN_DATA_TYPE,compareFunctionFactory);const DO_NOT_SWAP=0,FIRST_BEFORE_SECOND=-1,FIRST_AFTER_SECOND=1;function sort(a,s){const c=getRootComparator(s);for(var u=arguments.length,d=new Array(u>2?u-2:0),h=2;h<u;h++)d[h-2]=arguments[h];a.sort(c(...d))}const ASC_SORT_STATE="asc",DESC_SORT_STATE="desc",HEADER_SPAN_CLASS="colHeader";function isValidColumnState(a){if(isObject(a)===!1)return!1;const{column:s,sortOrder:c}=a;return Number.isInteger(s)&&[ASC_SORT_STATE,DESC_SORT_STATE].includes(c)}function areValidSortStates(a){if(a.some(c=>isValidColumnState(c)===!1))return!1;const s=a.map(c=>{let{column:u}=c;return u});return new Set(s).size===s.length}function getNextSortOrder(a){if(a!==DESC_SORT_STATE)return a===ASC_SORT_STATE?DESC_SORT_STATE:ASC_SORT_STATE}function getHeaderSpanElement(a){return a.querySelector(`.${HEADER_SPAN_CLASS}`)}function isFirstLevelColumnHeader(a,s){if(a<0||!s.parentNode)return!1;const c=s.parentNode.parentNode.childNodes;return Array.from(c).indexOf(s.parentNode)-c.length===-1}function wasHeaderClickedProperly(a,s,c){return a===-1&&s>=0&&isRightClick(c)===!1}function createDateTimeCompareFunction(a,s,c){return function(u,d){const{sortEmptyCells:h}=c;if(u===d)return DO_NOT_SWAP;if(isEmpty(u))return isEmpty(d)?DO_NOT_SWAP:h&&a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND;if(isEmpty(d))return h&&a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND;const f=hooks(u,s),g=hooks(d,s);return f.isValid()?g.isValid()?g.isAfter(f)?a==="asc"?FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND:g.isBefore(f)?a==="asc"?FIRST_AFTER_SECOND:FIRST_BEFORE_SECOND:DO_NOT_SWAP:FIRST_BEFORE_SECOND:FIRST_AFTER_SECOND}}function warnAboutPluginsConflict(a,s){warn$1(toSingleLine`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${a}\` will work. The \`${s}\` plugin will remain disabled.`)}const HEADER_CLASS_ASC_SORT="ascending",HEADER_CLASS_DESC_SORT="descending",HEADER_CLASS_INDICATOR_DISABLED="indicatorDisabled",HEADER_SORT_CLASS="columnSorting",HEADER_ACTION_CLASS="sortAction",orderToCssClass=new Map([[ASC_SORT_STATE,HEADER_CLASS_ASC_SORT],[DESC_SORT_STATE,HEADER_CLASS_DESC_SORT]]);function getClassesToAdd$1(a,s,c,u){const d=[HEADER_SORT_CLASS];if(u&&d.push(HEADER_ACTION_CLASS),c===!1)return d.push(HEADER_CLASS_INDICATOR_DISABLED),d;const h=a.getSortOrderOfColumn(s);return isDefined(h)&&d.push(orderToCssClass.get(h)),d}function getClassesToRemove$1(){return Array.from(orderToCssClass.values()).concat(HEADER_ACTION_CLASS,HEADER_CLASS_INDICATOR_DISABLED,HEADER_SORT_CLASS)}function rootComparator$1(a,s){return function(c,u){const[,...d]=c,[,...h]=u;return(function(g){const m=a[g],p=s[g],v=d[g],w=h[g],E=p.columnSorting;return(E.compareFunctionFactory?E.compareFunctionFactory:getCompareFunctionFactory(p.type))(m,p,E)(v,w)})(0)}}function _classPrivateMethodInitSpec$I(a,s){_checkPrivateRedeclaration$W(a,s),s.add(a)}function _checkPrivateRedeclaration$W(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$12(a,s,c){return(s=_toPropertyKey$12(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$12(a){var s=_toPrimitive$12(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$12(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$W(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$w="columnSorting",PLUGIN_PRIORITY$w=50,APPEND_COLUMN_CONFIG_STRATEGY="append",REPLACE_COLUMN_CONFIG_STRATEGY="replace",SHORTCUTS_GROUP$b=PLUGIN_KEY$w;registerRootComparator(PLUGIN_KEY$w,rootComparator$1),Hooks.getSingleton().register("beforeColumnSort"),Hooks.getSingleton().register("afterColumnSort");const pluginConflictsState=new WeakMap;var _ColumnSorting_brand=new WeakSet;class ColumnSorting extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$I(this,_ColumnSorting_brand),_defineProperty$12(this,"columnStatesManager",null),_defineProperty$12(this,"columnMetaCache",null),_defineProperty$12(this,"pluginKey",PLUGIN_KEY$w),_defineProperty$12(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$w}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$w}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var s=this;if(pluginConflictsState.has(this.hot)&&pluginConflictsState.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),warnAboutPluginsConflict(pluginConflictsState.get(this.hot),this.pluginKey);return}this.enabled||(pluginConflictsState.set(this.hot,this.pluginKey),this.columnStatesManager=new ColumnStatesManager(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new PhysicalIndexToValueMap(c=>{let u=this.hot.toVisualColumn(c);return u===null&&(u=c),this.getMergedPluginSettings(u)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(c,u)=>_assertClassBrand$W(_ColumnSorting_brand,this,_onAfterGetColHeader$3).call(this,c,u)),this.addHook("beforeOnCellMouseDown",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$W(_ColumnSorting_brand,s,_onBeforeOnCellMouseDown$5).call(s,...u)}),this.addHook("afterOnCellMouseDown",(c,u)=>this.onAfterOnCellMouseDown(c,u)),this.addHook("afterInit",()=>_assertClassBrand$W(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)),this.addHook("afterLoadData",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$W(_ColumnSorting_brand,s,_onAfterLoadData$5).call(s,...u)}),this.hot.view&&_assertClassBrand$W(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const s=(c,u)=>{const d=getHeaderSpanElement(u);isFirstLevelColumnHeader(c,u)===!1||d===null||this.updateHeaderClasses(d)};pluginConflictsState.delete(this.hot),this.hot.addHook("afterGetColHeader",s),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",s)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:s}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(s.col)),!1},runOnlyIf:()=>{var s,c;const u=(s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;return u&&((c=this.hot.getSelectedRangeActive())===null||c===void 0?void 0:c.isSingle())&&this.hot.selection.isCellVisible(u)&&u.row===-1&&u.col>=0},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$b})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$b)}sort(s){const c=this.getSortConfig(),u=this.getNormalizedSortConfigs(s),d=this.areValidSortConfigs(u);this.hot.runHooks("beforeColumnSort",c,u,d)!==!1&&(c.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new IndexesSequence),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),d&&(this.columnStatesManager.setSortStates(u),this.sortByPresetSortStates(u),this.saveAllSortSettings(u)),this.hot.runHooks("afterColumnSort",c,d?u:c,d),d&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(s){return isDefined(s)?this.columnStatesManager.getColumnSortState(s):this.columnStatesManager.getSortStates()}setSortConfig(s){const c=this.getNormalizedSortConfigs(s);this.areValidSortConfigs(c)&&this.columnStatesManager.setSortStates(c)}getNormalizedSortConfigs(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(s)?s.slice(0,1):[s]}areValidSortConfigs(s){const c=this.hot.countCols();return areValidSortStates(s)&&s.every(u=>{let{column:d}=u;return d<=c&&d>=0})}saveAllSortSettings(s){const c=this.columnStatesManager.getAllColumnsProperties(),u=d=>{let{column:h,...f}=d;return{column:this.hot.toPhysicalColumn(h),...f}};c.initialConfig=arrayMap(s,u),this.hot.runHooks("persistentStateSave","columnSorting",c)}getAllSavedSortSettings(){const s={};this.hot.runHooks("persistentStateLoad","columnSorting",s);const c=s.value,u=d=>{let{column:h,...f}=d;return{column:this.hot.toVisualColumn(h),...f}};return isDefined(c)&&Array.isArray(c.initialConfig)&&(c.initialConfig=arrayMap(c.initialConfig,u)),c}getColumnNextConfig(s){const c=this.columnStatesManager.getSortOrderOfColumn(s);if(isDefined(c)){const d=getNextSortOrder(c);return isDefined(d)?{column:s,sortOrder:d}:void 0}const u=this.hot.countCols();if(Number.isInteger(s)&&s>=0&&s<u)return{column:s,sortOrder:getNextSortOrder()}}getNextSortConfig(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:APPEND_COLUMN_CONFIG_STRATEGY;const u=this.columnStatesManager.getIndexOfColumnInSortQueue(s),d=u!==-1,h=this.getSortConfig(),f=this.getColumnNextConfig(s);if(d){if(isUndefined(f))return[...h.slice(0,u),...h.slice(u+1)];if(c===APPEND_COLUMN_CONFIG_STRATEGY)return[...h.slice(0,u),...h.slice(u+1),f];if(c===REPLACE_COLUMN_CONFIG_STRATEGY)return[...h.slice(0,u),f,...h.slice(u+1)]}return isDefined(f)?h.concat(f):h}getPluginColumnConfig(s){if(isObject(s)){const c=s[this.pluginKey];if(isObject(c))return c}return{}}getMergedPluginSettings(s){const c=this.hot.getSettings()[this.pluginKey],u=this.columnStatesManager.getAllColumnsProperties(),d=this.hot.getCellMeta(0,s),h=Object.getPrototypeOf(d);return Array.isArray(h.columns)?Object.assign(u,c,this.getPluginColumnConfig(h.columns[s])):isFunction(h.columns)?Object.assign(u,c,this.getPluginColumnConfig(h.columns(s))):Object.assign(u,c)}getFirstCellSettings(s){const c=this.hot.getCellMeta(0,s),u=Object.create(c);return u[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(s)),u}getNumberOfRowsToSort(s){const c=this.hot.getSettings();return c.maxRows<=s?c.maxRows:s-c.minSpareRows}sortByPresetSortStates(s){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),s.length===0)return;const c=[],u=this.hot.countRows(),d=p=>arrayMap(s,v=>this.hot.getDataAtCell(p,v.column));for(let p=0;p<this.getNumberOfRowsToSort(u);p+=1)c.push([this.hot.toPhysicalRow(p)].concat(d(p)));const h=arrayMap(c,p=>p[0]);sort(c,this.pluginKey,arrayMap(s,p=>p.sortOrder),arrayMap(s,p=>this.getFirstCellSettings(p.column)));for(let p=c.length;p<u;p+=1)c.push([p].concat(d(p)));const f=arrayMap(c,p=>p[0]),g=new Map(arrayMap(h,(p,v)=>[p,f[v]])),m=arrayMap(this.hot.rowIndexMapper.getIndexesSequence(),p=>g.has(p)?g.get(p):p);this.hot.rowIndexMapper.setIndexesSequence(m)}sortBySettings(s){if(isObject(s)){this.columnStatesManager.updateAllColumnsProperties(s);const c=s.initialConfig;(Array.isArray(c)||isObject(c))&&this.sort(c)}else this.hot.render()}updateHeaderClasses(s){if(removeClass$1(s,getClassesToRemove$1()),this.enabled!==!1){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];addClass$1(s,getClassesToAdd$1(...u))}}onUpdateSettings(s){super.onUpdateSettings(s),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),isDefined(s[this.pluginKey])&&this.sortBySettings(s[this.pluginKey])}wasClickableHeaderClicked(s,c){return this.getFirstCellSettings(c)[this.pluginKey].headerAction&&hasClass$1(s.target,HEADER_SPAN_CLASS)}onAfterOnCellMouseDown(s,c){if(wasHeaderClickedProperly(c.row,c.col,s)!==!1&&this.wasClickableHeaderClicked(s,c.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(c.col));const u=this.hot.getActiveEditor(),d=this.getColumnNextConfig(c.col);u!=null&&u.isOpened()&&this.hot.getCellValidator(u.row,u.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(d)}):this.sort(d)}}destroy(){var s;(s=this.columnStatesManager)===null||s===void 0||s.destroy(),super.destroy()}}function _loadOrSortBySettings(){const a=this.getAllSavedSortSettings();if(isObject(a))this.sortBySettings(a);else{const s=this.hot.getSettings()[this.pluginKey];this.sortBySettings(s)}}function _onAfterGetColHeader$3(a,s){const c=getHeaderSpanElement(s);if(isFirstLevelColumnHeader(a,s)===!1||c===null)return;const u=this.getFirstCellSettings(a)[this.pluginKey],d=u.indicator,h=u.headerAction;if(this.updateHeaderClasses(c,this.columnStatesManager,a,d,h),this.hot.getSettings().ariaTags){const f=this.columnStatesManager.getSortOrderOfColumn(a);setAttribute(s,...A11Y_SORT(f?`${f}ending`:"none"))}}function _onAfterLoadData$5(a){a===!0&&this.hot.view&&_assertClassBrand$W(_ColumnSorting_brand,this,_loadOrSortBySettings).call(this)}function _onBeforeOnCellMouseDown$5(a,s,c,u){wasHeaderClickedProperly(s.row,s.col,a)!==!1&&this.wasClickableHeaderClicked(a,s.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(u.column=!0)}function isNullishOrNaN(a){return a==null||isNaN(a)}function roundFloat(a,s){if(typeof a!="number")return a;const c=u=>u.toString();switch(typeof s){case"number":return c(a.toFixed(Math.min(Math.max(0,s),100)));case"boolean":return s?c(Math.round(a)):a;case"string":if(s==="auto"){const u=Math.round(a).toString().length;return c(a.toFixed(8-u))}return a;default:return a}}function _defineProperty$11(a,s,c){return(s=_toPropertyKey$11(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$11(a){var s=_toPrimitive$11(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$11(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Endpoints{constructor(s,c){_defineProperty$11(this,"plugin",void 0),_defineProperty$11(this,"hot",void 0),_defineProperty$11(this,"endpoints",[]),_defineProperty$11(this,"settings",void 0),_defineProperty$11(this,"settingsType","array"),_defineProperty$11(this,"currentEndpoint",null),_defineProperty$11(this,"cellsToSetCache",[]),this.plugin=s,this.hot=this.plugin.hot,this.settings=c}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(s){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[s]:this.endpoints[s]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(s){return this.parseSettings(s.call(this))}parseSettings(s){const c=[];let u=s;if(!u&&typeof this.settings=="function"){this.settingsType="function";return}return u||(u=this.settings),arrayEach(u,d=>{const h={};this.assignSetting(d,h,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(d,h,"reversedRowCoords",!1),this.assignSetting(d,h,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(d,h,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(d,h,"sourceColumn",d.destinationColumn),this.assignSetting(d,h,"type","sum"),this.assignSetting(d,h,"forceNumeric",!1),this.assignSetting(d,h,"suppressDataTypeErrors",!0),this.assignSetting(d,h,"customFunction",null),this.assignSetting(d,h,"readOnly",!0),this.assignSetting(d,h,"roundFloat",!1),c.push(h)}),c}assignSetting(s,c,u,d){if(u==="ranges"&&s[u]===void 0){c[u]=d;return}else if(u==="ranges"&&s[u].length===0)return;if(s[u]===void 0){if(d instanceof Error)throw d;c[u]=d}else u==="destinationRow"&&c.reversedRowCoords?c[u]=this.hot.countRows()-s[u]-1:c[u]=s[u]}resetSetupBeforeStructureAlteration(s,c,u){if(this.settingsType!=="function")return;const d=s.indexOf("row")>-1?"row":"col",h=this.getAllEndpoints();arrayEach(h,f=>{d==="row"&&f.destinationRow>=c&&(s==="insert_row"?f.alterRowOffset=u:s==="remove_row"&&(f.alterRowOffset=-1*u)),d==="col"&&f.destinationColumn>=c&&(s==="insert_col"?f.alterColumnOffset=u:s==="remove_col"&&(f.alterColumnOffset=-1*u))}),this.resetAllEndpoints(h,!1)}resetSetupAfterStructureAlteration(s,c,u,d,h){let f=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(h==="auto")return;if(this.settingsType==="function"){const E=()=>(this.hot.removeHook("beforeViewRender",E),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",E);return}const g=s.indexOf("row")>-1?"row":"col",m=s.indexOf("remove")>-1?-1:1,p=this.getAllEndpoints(),v=s.indexOf("move_row")===0,w=c;arrayEach(p,E=>{g==="row"&&E.destinationRow>=w&&(E.alterRowOffset=m*u),g==="col"&&E.destinationColumn>=w&&(E.alterColumnOffset=m*u)}),this.resetAllEndpoints(p,!v),v?arrayEach(p,E=>{this.extendEndpointRanges(E,w,d[0],d.length),this.recreatePhysicalRanges(E),this.clearOffsetInformation(E)}):arrayEach(p,E=>{this.shiftEndpointCoordinates(E,w)}),f&&this.refreshAllEndpoints()}clearOffsetInformation(s){s.alterRowOffset=void 0,s.alterColumnOffset=void 0}extendEndpointRanges(s,c,u,d){arrayEach(s.ranges,h=>{h[1]&&(c>=h[0]&&c<=h[1]?u>h[1]?h[1]+=d:u<h[0]&&(h[0]-=d):u>=h[0]&&u<=h[1]&&(h[1]-=d,c<=h[0]&&(h[0]+=1,h[1]+=1)))})}recreatePhysicalRanges(s){const c=s.ranges,u=[],d=[];arrayEach(c,h=>{const f=[];if(h[1])for(let g=h[0];g<=h[1];g++)f.push(this.hot.toPhysicalRow(g));else f.push(this.hot.toPhysicalRow(h[0]));d.push(f)}),arrayEach(d,h=>{let f=[];arrayEach(h,(g,m)=>{m===0?f.push(g):h[m]!==h[m-1]+1&&(f.push(h[m-1]),u.push(f),f=[],f.push(g)),m===h.length-1&&(f.push(g),u.push(f))})}),s.ranges=u}shiftEndpointCoordinates(s,c){s.alterRowOffset&&s.alterRowOffset!==0?(s.destinationRow+=s.alterRowOffset||0,arrayEach(s.ranges,u=>{arrayEach(u,(d,h)=>{d>=c&&(u[h]+=s.alterRowOffset||0)})})):s.alterColumnOffset&&s.alterColumnOffset!==0&&(s.destinationColumn+=s.alterColumnOffset||0,s.sourceColumn+=s.alterColumnOffset||0)}resetAllEndpoints(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;s.some(d=>{const h=d.alterRowOffset||0,f=d.alterColumnOffset||0;return d.destinationRow+h>=this.hot.countRows()||d.destinationColumn+f>=this.hot.countCols()})||(this.cellsToSetCache=[],arrayEach(s,d=>{this.resetEndpointValue(d,c)}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],arrayEach(this.getAllEndpoints(),s=>{this.currentEndpoint=s,this.plugin.calculate(s),this.setEndpointValue(s,"init")}),this.currentEndpoint=null,this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(s){const c=[];this.cellsToSetCache=[],arrayEach(s,(u,d,h)=>{`${u[2]||""}`!=`${u[3]}`&&arrayEach(this.getAllEndpoints(),(f,g)=>{this.hot.propToCol(h[d][1])===f.sourceColumn&&c.indexOf(g)===-1&&c.push(g)})}),arrayEach(c,u=>{this.refreshEndpoint(this.getEndpoint(u))}),this.cellsToSetCache.length&&this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(s=>{const c=this.hot.toVisualRow(s.destinationRow);if(c!==null){const u=this.hot.getCellMeta(c,s.destinationColumn);u.readOnly=s.readOnly,u.className="columnSummaryResult"}})}refreshEndpoint(s){this.currentEndpoint=s,this.plugin.calculate(s),this.setEndpointValue(s),this.currentEndpoint=null}resetEndpointValue(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const u=s.alterRowOffset||0,d=s.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(s.destinationRow+(c?u:0)),this.hot.toVisualColumn(s.destinationColumn+(c?d:0)),""])}setEndpointValue(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=this.hot.toVisualRow(s.destinationRow);if(s.destinationRow>=this.hot.countRows()||s.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const h=this.hot.toVisualRow(s.destinationRow);if(h!==null){const f=this.hot.getCellMeta(h,s.destinationColumn);(c==="init"||f.readOnly!==s.readOnly)&&(f.readOnly=s.readOnly,f.className="columnSummaryResult")}s.result=roundFloat(s.result,s.roundFloat),u?this.hot.setDataAtCell(d,s.destinationColumn,s.result,"ColumnSummary.set"):this.cellsToSetCache.push([d,s.destinationColumn,s.result]),s.alterRowOffset=void 0,s.alterColumnOffset=void 0}throwOutOfBoundsWarning(){warn$1("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function _classPrivateMethodInitSpec$H(a,s){_checkPrivateRedeclaration$V(a,s),s.add(a)}function _checkPrivateRedeclaration$V(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$10(a,s,c){return(s=_toPropertyKey$10(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$10(a){var s=_toPrimitive$10(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$10(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$V(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$v="columnSummary",PLUGIN_PRIORITY$v=220;var _ColumnSummary_brand=new WeakSet;class ColumnSummary extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$H(this,_ColumnSummary_brand),_defineProperty$10(this,"endpoints",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$v}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$v}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$v]}enablePlugin(){var s=this;this.enabled||(this.settings=this.hot.getSettings()[PLUGIN_KEY$v],this.endpoints=new Endpoints(this,this.settings),this.addHook("afterInit",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$V(_ColumnSummary_brand,s,_onAfterInit$4).call(s,...u)}),this.addHook("afterChange",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$V(_ColumnSummary_brand,s,_onAfterChange$3).call(s,...u)}),this.addHook("afterUpdateSettings",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$V(_ColumnSummary_brand,s,_onAfterUpdateSettings).call(s,...u)}),this.addHook("afterLoadData",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$V(_ColumnSummary_brand,s,_onAfterLoadData$4).call(s,...u)}),this.addHook("afterUpdateData",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$V(_ColumnSummary_brand,s,_onAfterUpdateData).call(s,...u)}),this.addHook("beforeCreateRow",(c,u,d)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",c,u,null,d)),this.addHook("beforeCreateCol",(c,u,d)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",c,u,null,d)),this.addHook("beforeRemoveRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return s.endpoints.resetSetupBeforeStructureAlteration("remove_row",...u)}),this.addHook("beforeRemoveCol",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return s.endpoints.resetSetupBeforeStructureAlteration("remove_col",...u)}),this.addHook("afterCreateRow",(c,u,d)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",c,u,null,d)),this.addHook("afterCreateCol",(c,u,d)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",c,u,null,d)),this.addHook("afterRemoveRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return s.endpoints.resetSetupAfterStructureAlteration("remove_row",...u)}),this.addHook("afterRemoveCol",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return s.endpoints.resetSetupAfterStructureAlteration("remove_col",...u)}),this.addHook("afterRowMove",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$V(_ColumnSummary_brand,s,_onAfterRowMove).call(s,...u)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(s){switch(s.type.toLowerCase()){case"sum":s.result=this.calculateSum(s);break;case"min":s.result=this.calculateMinMax(s,s.type);break;case"max":s.result=this.calculateMinMax(s,s.type);break;case"count":s.result=this.countEntries(s);break;case"average":s.result=this.calculateAverage(s);break;case"custom":s.result=s.customFunction.call(this,s);break}}calculateSum(s){let c=0;return objectEach(s.ranges,u=>{c+=this.getPartialSum(u,s.sourceColumn)}),c}getPartialSum(s,c){let u=0,d=s[1]||s[0],h=null,f=0;do{if(h=this.getCellValue(d,c),h=isNullishOrNaN(h)?null:h,h!==null){const g=(`${h}`.split(".")[1]||[]).length||1;g>f&&(f=g)}u+=h||0,d-=1}while(d>=s[0]);return Math.round(u*10**f)/10**f}calculateMinMax(s,c){let u=null;return objectEach(s.ranges,d=>{const h=this.getPartialMinMax(d,s.sourceColumn,c);if(u===null&&h!==null&&(u=h),h!==null)switch(c){case"min":u=Math.min(u,h);break;case"max":u=Math.max(u,h);break}}),u===null?"Not enough data":u}getPartialMinMax(s,c,u){let d=null,h=s[1]||s[0],f;do{if(f=this.getCellValue(h,c),f=isNullishOrNaN(f)?null:f,d===null)d=f;else if(f!==null)switch(u){case"min":d=Math.min(d,f);break;case"max":d=Math.max(d,f);break}h-=1}while(h>=s[0]);return d}countEmpty(s,c){let u,d=0,h=s[1]||s[0];do u=this.getCellValue(h,c),u=isNullishOrNaN(u)?null:u,u===null&&(d+=1),h-=1;while(h>=s[0]);return d}countEntries(s){let c=0;const u=s.ranges;return objectEach(u,d=>{const h=d[1]===void 0?1:d[1]-d[0]+1,f=this.countEmpty(d,s.sourceColumn);c+=h,c-=f}),c}calculateAverage(s){const c=this.calculateSum(s),u=this.countEntries(s);return c/u}getCellValue(s,c){const u=this.hot.toVisualRow(s),d=this.hot.toVisualColumn(c);let h=this.hot.getSourceDataAtCell(s,c),f="";if(u!==null&&d!==null&&(f=this.hot.getCellMeta(u,d).className||""),f.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof h=="string"&&(h=h.replace(/,/,".")),h=parseFloat(h)),isNaN(h)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(toSingleLine`ColumnSummary plugin: cell at (${s}, ${c}) is not in a\x20
          numeric format. Cannot do the calculation.`);return h}}function _onAfterInit$4(){this.endpoints.initEndpoints()}function _onAfterUpdateSettings(a){a.columns!==void 0&&this.endpoints.refreshCellMetas()}function _onAfterChange$3(a,s){a&&s!=="ColumnSummary.reset"&&s!=="ColumnSummary.set"&&s!=="loadData"&&this.endpoints.refreshChangedEndpoints(a)}function _onAfterLoadData$4(a,s){s||this.endpoints.refreshAllEndpoints()}function _onAfterUpdateData(a,s){s||this.endpoints.refreshAllEndpoints()}function _onAfterRowMove(a,s){this.endpoints.resetSetupBeforeStructureAlteration("move_row",a[0],a.length,a,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",s,a.length,a,this.pluginName)}function _classPrivateMethodInitSpec$G(a,s){_checkPrivateRedeclaration$U(a,s),s.add(a)}function _classPrivateFieldInitSpec$G(a,s,c){_checkPrivateRedeclaration$U(a,s),s.set(a,c)}function _checkPrivateRedeclaration$U(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$G(a,s){return a.get(_assertClassBrand$U(a,s))}function _classPrivateFieldSet$F(a,s,c){return a.set(_assertClassBrand$U(a,s),c),c}function _assertClassBrand$U(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _ignoreInitialCall=new WeakMap,_observedElement=new WeakMap,_observer$1=new WeakMap,_EditorResizeObserver_brand=new WeakSet;class EditorResizeObserver{constructor(){_classPrivateMethodInitSpec$G(this,_EditorResizeObserver_brand),_classPrivateFieldInitSpec$G(this,_ignoreInitialCall,!0),_classPrivateFieldInitSpec$G(this,_observedElement,null),_classPrivateFieldInitSpec$G(this,_observer$1,new ResizeObserver(s=>_assertClassBrand$U(_EditorResizeObserver_brand,this,_onResize).call(this,s)))}setObservedElement(s){_classPrivateFieldSet$F(_observedElement,this,s)}unobserve(){_classPrivateFieldGet$G(_observer$1,this).unobserve(_classPrivateFieldGet$G(_observedElement,this))}observe(){_classPrivateFieldSet$F(_ignoreInitialCall,this,!0),_classPrivateFieldGet$G(_observer$1,this).observe(_classPrivateFieldGet$G(_observedElement,this))}destroy(){_classPrivateFieldGet$G(_observer$1,this).disconnect()}}function _onResize(a){if(_classPrivateFieldGet$G(_ignoreInitialCall,this)||!Array.isArray(a)||!a.length){_classPrivateFieldSet$F(_ignoreInitialCall,this,!1);return}a.forEach(s=>{let{borderBoxSize:c}=s;const{inlineSize:u,blockSize:d}=c[0];this.runLocalHooks("resize",u,d)})}mixin(EditorResizeObserver,localHooks);function _classPrivateFieldInitSpec$F(a,s,c){_checkPrivateRedeclaration$T(a,s),s.set(a,c)}function _checkPrivateRedeclaration$T(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$F(a,s){return a.get(_assertClassBrand$T(a,s))}function _classPrivateFieldSet$E(a,s,c){return a.set(_assertClassBrand$T(a,s),c),c}function _assertClassBrand$T(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _rootDocument$1=new WeakMap,_rootPortalElement=new WeakMap,_isRtl$2=new WeakMap,_container$1=new WeakMap,_editor$1=new WeakMap,_editorStyle=new WeakMap,_hidden=new WeakMap,_resizeObserver$1=new WeakMap;class CommentEditor{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(s,c,u){var d=this;_classPrivateFieldInitSpec$F(this,_rootDocument$1,void 0),_classPrivateFieldInitSpec$F(this,_rootPortalElement,void 0),_classPrivateFieldInitSpec$F(this,_isRtl$2,!1),_classPrivateFieldInitSpec$F(this,_container$1,null),_classPrivateFieldInitSpec$F(this,_editor$1,void 0),_classPrivateFieldInitSpec$F(this,_editorStyle,void 0),_classPrivateFieldInitSpec$F(this,_hidden,!0),_classPrivateFieldInitSpec$F(this,_resizeObserver$1,new EditorResizeObserver),_classPrivateFieldSet$E(_rootDocument$1,this,s),_classPrivateFieldSet$E(_rootPortalElement,this,u),_classPrivateFieldSet$E(_isRtl$2,this,c),_classPrivateFieldSet$E(_editor$1,this,this.createEditor()),_classPrivateFieldSet$E(_editorStyle,this,_classPrivateFieldGet$F(_editor$1,this).style),_classPrivateFieldGet$F(_resizeObserver$1,this).setObservedElement(this.getInputElement()),_classPrivateFieldGet$F(_resizeObserver$1,this).addLocalHook("resize",function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return d.runLocalHooks("resize",...f)}),this.hide()}setPosition(s,c){_classPrivateFieldGet$F(_editorStyle,this).left=`${s}px`,_classPrivateFieldGet$F(_editorStyle,this).top=`${c}px`}setSize(s,c){if(s&&c){const u=this.getInputElement();u.style.width=`${s}px`,u.style.height=`${c}px`}}getSize(){return{width:outerWidth(this.getInputElement()),height:outerHeight(this.getInputElement())}}observeSize(){_classPrivateFieldGet$F(_resizeObserver$1,this).observe()}resetSize(){const s=this.getInputElement();s.style.width="",s.style.height=""}setReadOnlyState(s){const c=this.getInputElement();c.readOnly=s}show(){_classPrivateFieldGet$F(_editorStyle,this).display="block",_classPrivateFieldSet$E(_hidden,this,!1)}hide(){_classPrivateFieldGet$F(_resizeObserver$1,this).unobserve(),_classPrivateFieldGet$F(_hidden,this)||(_classPrivateFieldGet$F(_editorStyle,this).display="none"),_classPrivateFieldSet$E(_hidden,this,!0)}isVisible(){return _classPrivateFieldGet$F(_editorStyle,this).display==="block"}setValue(){const c=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=c}getValue(){return this.getInputElement().value}isFocused(){return _classPrivateFieldGet$F(_rootDocument$1,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const s=_classPrivateFieldGet$F(_rootDocument$1,this).createElement("div"),c=_classPrivateFieldGet$F(_rootDocument$1,this).createElement("textarea");return s.style.display="none",_classPrivateFieldSet$E(_container$1,this,_classPrivateFieldGet$F(_rootDocument$1,this).createElement("div")),_classPrivateFieldGet$F(_container$1,this).setAttribute("dir",_classPrivateFieldGet$F(_isRtl$2,this)?"rtl":"ltr"),addClass$1(_classPrivateFieldGet$F(_container$1,this),CommentEditor.CLASS_EDITOR_CONTAINER),_classPrivateFieldGet$F(_rootPortalElement,this).appendChild(_classPrivateFieldGet$F(_container$1,this)),addClass$1(s,CommentEditor.CLASS_EDITOR),addClass$1(c,CommentEditor.CLASS_INPUT),c.setAttribute("data-hot-input",!0),s.appendChild(c),_classPrivateFieldGet$F(_container$1,this).appendChild(s),s}getInputElement(){return _classPrivateFieldGet$F(_editor$1,this).querySelector(`.${CommentEditor.CLASS_INPUT}`)}getEditorElement(){return _classPrivateFieldGet$F(_editor$1,this)}destroy(){const s=_classPrivateFieldGet$F(_container$1,this)?_classPrivateFieldGet$F(_container$1,this).parentNode:null;_classPrivateFieldGet$F(_editor$1,this).parentNode.removeChild(_classPrivateFieldGet$F(_editor$1,this)),_classPrivateFieldSet$E(_editor$1,this,null),_classPrivateFieldSet$E(_editorStyle,this,null),_classPrivateFieldGet$F(_resizeObserver$1,this).destroy(),s&&s.removeChild(_classPrivateFieldGet$F(_container$1,this))}}mixin(CommentEditor,localHooks);function _defineProperty$$(a,s,c){return(s=_toPropertyKey$$(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$$(a){var s=_toPrimitive$$(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$$(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const DEFAULT_DISPLAY_DELAY=250,DEFAULT_HIDE_DELAY=250;class DisplaySwitch{constructor(s){_defineProperty$$(this,"wasLastActionShow",!0),_defineProperty$$(this,"showDebounced",null),_defineProperty$$(this,"hidingTimer",null),this.updateDelay(s)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},DEFAULT_HIDE_DELAY)}show(s){this.wasLastActionShow=!0,this.showDebounced(s)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:DEFAULT_DISPLAY_DELAY;this.showDebounced=debounce(c=>{this.wasLastActionShow&&this.runLocalHooks("show",c.from.row,c.from.col)},s)}destroy(){this.clearLocalHooks()}}mixin(DisplaySwitch,localHooks);function prepareVerticalAlignClass(a,s){return a.indexOf(s)!==-1?a:`${a.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${s}`}function prepareHorizontalAlignClass(a,s){return a.indexOf(s)!==-1?a:`${a.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${s}`}function getAlignmentClasses(a,s){const c={};return arrayEach(a,u=>{u.forAll((d,h)=>{d>=0&&h>=0&&(c[d]||(c[d]=[]),c[d][h]=s(d,h))})}),c}function align(a,s,c,u,d){arrayEach(a,h=>{h.forAll((f,g)=>{f>=0&&g>=0&&applyAlignClassName(f,g,s,c,u,d)})})}function applyAlignClassName(a,s,c,u,d,h){const f=d(a,s);let g=u;f.className&&(c==="vertical"?g=prepareVerticalAlignClass(f.className,u):g=prepareHorizontalAlignClass(f.className,u)),h(a,s,"className",g)}function markLabelAsSelected(a){return`<span class="selected">✓</span>${a}`}function checkSelectionConsistency(a,s){let c=!1;return Array.isArray(a)&&arrayEach(a,u=>(u.forAll((d,h)=>{if(d>=0&&h>=0&&s(d,h))return c=!0,!1}),c)),c}function getDocumentOffsetByElement(a,s){const c={top:0,left:0};if(s!==a.ownerDocument){const{frameElement:u}=s.defaultView,{top:d,left:h}=u.getBoundingClientRect();c.top=d,c.left=h}return c}const KEY$c="---------";function separatorItem(){return{name:KEY$c}}const KEY$b="alignment";function alignmentItem(){return{key:KEY$b,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const a=this.getSelectedRangeActive();return!a||a.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${KEY$b}:left`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_LEFT)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="horizontal",u="htLeft";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1},{key:`${KEY$b}:center`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_CENTER)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="horizontal",u="htCenter";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1},{key:`${KEY$b}:right`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="horizontal",u="htRight";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1},{key:`${KEY$b}:justify`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="horizontal",u="htJustify";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1},{name:KEY$c},{key:`${KEY$b}:top`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_TOP)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="vertical",u="htTop";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1},{key:`${KEY$b}:middle`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="vertical",u="htMiddle";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1},{key:`${KEY$b}:bottom`,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM)},callback(){const a=this.getSelectedRange(),s=getAlignmentClasses(a,(d,h)=>this.getCellMeta(d,h).className),c="vertical",u="htBottom";this.runHooks("beforeCellAlignment",s,a,c,u),align(a,c,u,(d,h)=>this.getCellMeta(d,h),(d,h,f,g)=>this.setCellMeta(d,h,f,g)),this.render()},disabled:!1}]}}}const KEY$a="clear_column";function clearColumnItem(){return{key:KEY$a,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CLEAR_COLUMN)},callback(a,s){const c=s[0].start.col,u=s[0].end.col;this.countRows()&&this.populateFromArray(0,c,[[null]],Math.max(s[0].start.row,s[0].end.row),u,"ContextMenu.clearColumn")},disabled(){const a=this.getSelectedRangeActive();if(!a||a.isSingleHeader()&&a.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let s=!1;return a.forAll((c,u)=>{if(c<0||u<0)return!0;const{readOnly:d}=this.getCellMeta(c,u);return d?!0:(s=!0,!1)}),!s}}}const KEY$9="col_left";function columnLeftItem(){return{key:KEY$9,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_LEFT)},callback(){const a=this.getSelectedRangeActive().getTopLeftCorner(),s=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(s,a.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const a=this.getSelectedRangeActive();return!a||this.selection.isSelectedByRowHeader()||a.isSingleHeader()&&a.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$8="col_right";function columnRightItem(){return{key:KEY$8,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_INSERT_RIGHT)},callback(){const a=this.getSelectedRangeActive().getTopRightCorner(),s=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(s,a.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const a=this.getSelectedRangeActive();return!!(!a||this.selection.isSelectedByRowHeader()||a.isSingleHeader()&&a.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const KEY$7="make_read_only";function readOnlyItem(){return{key:KEY$7,checkable:!0,ariaChecked(){return checkSelectionConsistency(this.getSelectedRange(),(s,c)=>this.getCellMeta(s,c).readOnly)},ariaLabel(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY)},name(){let a=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY);return checkSelectionConsistency(this.getSelectedRange(),(c,u)=>this.getCellMeta(c,u).readOnly)&&(a=markLabelAsSelected(a)),a},callback(){const a=this.getSelectedRange(),s=checkSelectionConsistency(a,(c,u)=>this.getCellMeta(c,u).readOnly);arrayEach(a,c=>{c.forAll((u,d)=>{u>=0&&d>=0&&this.setCellMeta(u,d,"readOnly",!s)})}),this.render()},disabled(){const a=this.getSelectedRangeActive();return!!(!a||a.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const KEY$6="redo";function redoItem(){return{key:KEY$6,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REDO)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const a=this.getPlugin("undoRedo");return!a||!a.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const KEY$5="remove_col";function removeColumnItem(){return{key:KEY$5,name(){const a=this.getSelected();let s=0;if(a)if(a.length>1)s=1;else{const[,c,,u]=a[0];c-u!==0&&(s=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COLUMN,s)},callback(){this.alter("remove_col",transformSelectionToColumnDistance(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const a=this.getSelectedRangeActive();if(!a||a.isSingleHeader()&&a.highlight.col<0)return!0;const s=this.countCols();return this.selection.isSelectedByCorner()?s===0:this.selection.isSelectedByRowHeader()||s===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const KEY$4="remove_row";function removeRowItem(){return{key:KEY$4,name(){const a=this.getSelected();let s=0;if(a)if(a.length>1)s=1;else{const[c,,u]=a[0];c-u!==0&&(s=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_ROW,s)},callback(){this.alter("remove_row",transformSelectionToRowDistance(this),1,"ContextMenu.removeRow")},disabled(){const a=this.getSelectedRangeActive();if(!a||a.isSingleHeader()&&a.highlight.row<0)return!0;const s=this.countRows();return this.selection.isSelectedByCorner()?s===0:this.selection.isSelectedByColumnHeader()||s===0},hidden(){return!this.getSettings().allowRemoveRow}}}const KEY$3="row_above";function rowAboveItem(){return{key:KEY$3,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_ABOVE)},callback(){const a=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",a.row,1,"ContextMenu.rowAbove")},disabled(){const a=this.getSelectedRangeActive();return!a||this.selection.isSelectedByColumnHeader()||a.isSingleHeader()&&a.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$2="row_below";function rowBelowItem(){return{key:KEY$2,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ROW_BELOW)},callback(){const a=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",a.row,1,"ContextMenu.rowBelow")},disabled(){const a=this.getSelectedRangeActive();return!!(!a||this.selection.isSelectedByColumnHeader()||a.isSingleHeader()&&a.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const KEY$1="no_items";function noItemsItem(){return{key:KEY$1,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NO_ITEMS)},disabled:!0,isCommand:!1}}const KEY="undo";function undoItem(){return{key:KEY,name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNDO)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const a=this.getPlugin("undoRedo");return!a||!a.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const ITEMS=[KEY$3,KEY$2,KEY$9,KEY$8,KEY$a,KEY$4,KEY$5,KEY,KEY$6,KEY$7,KEY$b,KEY$c,KEY$1],_predefinedItems={[KEY$c]:separatorItem,[KEY$1]:noItemsItem,[KEY$3]:rowAboveItem,[KEY$2]:rowBelowItem,[KEY$9]:columnLeftItem,[KEY$8]:columnRightItem,[KEY$a]:clearColumnItem,[KEY$4]:removeRowItem,[KEY$5]:removeColumnItem,[KEY]:undoItem,[KEY$6]:redoItem,[KEY$7]:readOnlyItem,[KEY$b]:alignmentItem};function predefinedItems(){const a={};return objectEach(_predefinedItems,(s,c)=>{a[c]=s()}),a}function addEditCommentItem(a){return{key:"commentsAddEdit",name(){var s;const c=(s=this.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;return c!=null&&c.isCell()&&a.getCommentAtCell(c.row,c.col)?this.getTranslatedPhrase(CONTEXTMENU_ITEMS_EDIT_COMMENT):this.getTranslatedPhrase(CONTEXTMENU_ITEMS_ADD_COMMENT)},callback(){const s=this.getSelectedRangeActive();a.setRange(s),a.show(),a.focusEditor()},disabled(){const s=this.getSelectedRangeActive();return!!(!s||s.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function removeCommentItem(a){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_COMMENT)},callback(){this.getSelectedRangeActive().forAll((c,u)=>{c>=0&&u>=0&&a.removeCommentAtCell(c,u,!1)}),this.render()},disabled(){const s=this.getSelectedRangeActive();return!!(!s||s.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function readOnlyCommentItem(a){return{key:"commentsReadOnly",name(){const s=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_READ_ONLY_COMMENT);return checkSelectionConsistency(this.getSelectedRange(),(u,d)=>a.getCommentMeta(u,d,META_READONLY))?markLabelAsSelected(s):s},callback(){this.getSelectedRangeActive().forAll((c,u)=>{if(c>=0&&u>=0){const d=!!a.getCommentMeta(c,u,META_READONLY);a.updateCommentMeta(c,u,{[META_READONLY]:!d})}})},disabled(){const s=this.getSelectedRangeActive();return!!(!s||s.highlight.isHeader()||!a.getCommentAtCell(s.highlight.row,s.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function _classPrivateMethodInitSpec$F(a,s){_checkPrivateRedeclaration$S(a,s),s.add(a)}function _classPrivateFieldInitSpec$E(a,s,c){_checkPrivateRedeclaration$S(a,s),s.set(a,c)}function _checkPrivateRedeclaration$S(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$_(a,s,c){return(s=_toPropertyKey$_(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$_(a){var s=_toPrimitive$_(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$_(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldSet$D(a,s,c){return a.set(_assertClassBrand$S(a,s),c),c}function _classPrivateFieldGet$E(a,s){return a.get(_assertClassBrand$S(a,s))}function _assertClassBrand$S(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$u="comments",PLUGIN_PRIORITY$u=60,META_COMMENT="comment",META_COMMENT_VALUE="value",META_STYLE="style",META_READONLY="readOnly",SHORTCUTS_GROUP$a=PLUGIN_KEY$u,SHORTCUTS_CONTEXT_NAME$3=`plugin:${PLUGIN_KEY$u}`;var _editor=new WeakMap,_displaySwitch=new WeakMap,_preventEditorAutoSwitch=new WeakMap,_preventEditorHiding=new WeakMap,_preventEditorSaveOnBlur=new WeakMap,_cellBelowCursor=new WeakMap,_commentValueBeforeSave=new WeakMap,_Comments_brand=new WeakSet;class Comments extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$F(this,_Comments_brand),_defineProperty$_(this,"range",{}),_classPrivateFieldInitSpec$E(this,_editor,null),_classPrivateFieldInitSpec$E(this,_displaySwitch,null),_classPrivateFieldInitSpec$E(this,_preventEditorAutoSwitch,!1),_classPrivateFieldInitSpec$E(this,_preventEditorHiding,!1),_classPrivateFieldInitSpec$E(this,_preventEditorSaveOnBlur,!1),_classPrivateFieldInitSpec$E(this,_cellBelowCursor,null),_classPrivateFieldInitSpec$E(this,_commentValueBeforeSave,"")}static get PLUGIN_KEY(){return PLUGIN_KEY$u}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$u}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$u]}enablePlugin(){var s=this;this.enabled||(_classPrivateFieldGet$E(_editor,this)||(_classPrivateFieldSet$D(_editor,this,new CommentEditor(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),_classPrivateFieldGet$E(_editor,this).addLocalHook("resize",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$S(_Comments_brand,s,_onEditorResize).call(s,...u)}),this.hot.addHook("afterSetTheme",(c,u)=>{u||this.hide()})),_classPrivateFieldGet$E(_displaySwitch,this)||_classPrivateFieldSet$D(_displaySwitch,this,new DisplaySwitch(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",c=>this.addToContextMenu(c)),this.addHook("afterRenderer",(c,u,d,h,f,g)=>_assertClassBrand$S(_Comments_brand,this,_onAfterRenderer).call(this,c,g)),this.addHook("afterScroll",()=>_assertClassBrand$S(_Comments_brand,this,_onAfterScroll).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",c=>_assertClassBrand$S(_Comments_brand,this,_onAfterDocumentKeyDown).call(this,c)),this.addHook("beforeCompositionStart",c=>_assertClassBrand$S(_Comments_brand,this,_onAfterDocumentKeyDown).call(this,c)),_classPrivateFieldGet$E(_displaySwitch,this).addLocalHook("hide",()=>this.hide()),_classPrivateFieldGet$E(_displaySwitch,this).addLocalHook("show",(c,u)=>this.showAtCell(c,u)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$E(_displaySwitch,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const s=this.hot.getShortcutManager(),c=s.getContext("grid"),u=s.addContext(SHORTCUTS_CONTEXT_NAME$3);c.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const d=this.hot.getSelectedRangeActive();_classPrivateFieldSet$D(_preventEditorHiding,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(d),this.show(),this.focusEditor(),s.setActiveContextName(SHORTCUTS_CONTEXT_NAME$3),this.hot._registerTimeout(()=>{_classPrivateFieldSet$D(_preventEditorHiding,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var d;return(d=this.hot.getSelectedRangeActive())===null||d===void 0?void 0:d.highlight.isCell()},group:SHORTCUTS_GROUP$a}),u.addShortcut({keys:[["Escape"]],callback:()=>{_classPrivateFieldGet$E(_editor,this).setValue(_classPrivateFieldGet$E(_commentValueBeforeSave,this)),this.hide(),s.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$E(_editor,this).isVisible()&&_classPrivateFieldGet$E(_editor,this).isFocused(),group:SHORTCUTS_GROUP$a}),u.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),s.setActiveContextName("grid")},runOnlyIf:()=>_classPrivateFieldGet$E(_editor,this).isVisible()&&_classPrivateFieldGet$E(_editor,this).isFocused(),group:SHORTCUTS_GROUP$a}),u.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:s.getContext("grid"),callback:()=>{_classPrivateFieldSet$D(_preventEditorSaveOnBlur,this,!0),_classPrivateFieldGet$E(_editor,this).setValue(_classPrivateFieldGet$E(_editor,this).getValue()),this.setComment(),this.hide(),s.setActiveContextName("grid")},group:SHORTCUTS_GROUP$a})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$a)}registerListeners(){const{rootDocument:s}=this.hot,c=this.getEditorInputElement();this.eventManager.addEventListener(s,"mouseover",u=>_assertClassBrand$S(_Comments_brand,this,_onMouseOver$2).call(this,u)),this.eventManager.addEventListener(s,"mousedown",u=>_assertClassBrand$S(_Comments_brand,this,_onMouseDown$2).call(this,u)),this.eventManager.addEventListener(s,"mouseup",()=>_assertClassBrand$S(_Comments_brand,this,_onMouseUp$4).call(this)),this.eventManager.addEventListener(c,"focus",()=>_assertClassBrand$S(_Comments_brand,this,_onEditorFocus).call(this)),this.eventManager.addEventListener(c,"blur",()=>_assertClassBrand$S(_Comments_brand,this,_onEditorBlur).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",u=>_assertClassBrand$S(_Comments_brand,this,_onInputElementMouseDown).call(this,u))}setRange(s){this.range=s}clearRange(){this.range={}}targetIsCellWithComment(s){const c=closest(s.target,"TD","TBODY");return!!(c&&hasClass$1(c,"htCommentCell")&&closest(c,[this.hot.rootElement]))}targetIsCommentTextArea(s){return this.getEditorInputElement()===s.target}setComment(s){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const c=_classPrivateFieldGet$E(_editor,this).getValue();let u="";s!=null?u=s:c!=null&&(u=c);const{row:d,col:h}=_assertClassBrand$S(_Comments_brand,this,_getRangeCoords).call(this);this.updateCommentMeta(d,h,{[META_COMMENT_VALUE]:u}),this.hot.render()}setCommentAtCell(s,c,u){this.setRange({from:this.hot._createCellCoords(s,c)}),this.setComment(u)}removeComment(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:c,col:u}=_assertClassBrand$S(_Comments_brand,this,_getRangeCoords).call(this);this.hot.setCellMeta(c,u,META_COMMENT),s&&this.hot.render(),this.hide()}removeCommentAtCell(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(s,c)}),this.removeComment(u)}getComment(){const{row:s,col:c}=_assertClassBrand$S(_Comments_brand,this,_getRangeCoords).call(this);return this.getCommentMeta(s,c,META_COMMENT_VALUE)}getCommentAtCell(s,c){return this.getCommentMeta(s,c,META_COMMENT_VALUE)}show(){var s;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:c,col:u}=_assertClassBrand$S(_Comments_brand,this,_getRangeCoords).call(this);if(c<0||c>this.hot.countSourceRows()-1||u<0||u>this.hot.countSourceCols()-1)return!1;const d=this.hot.getCellMeta(c,u);return _classPrivateFieldGet$E(_displaySwitch,this).cancelHiding(),_classPrivateFieldGet$E(_editor,this).setValue((s=d[META_COMMENT]?d[META_COMMENT][META_COMMENT_VALUE]:null)!==null&&s!==void 0?s:""),_classPrivateFieldGet$E(_editor,this).show(),this.refreshEditor(!0),!0}showAtCell(s,c){return this.setRange({from:this.hot._createCellCoords(s,c)}),this.show()}hide(){_classPrivateFieldGet$E(_editor,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!_classPrivateFieldGet$E(_editor,this).isVisible()))return;const{rowIndexMapper:c,columnIndexMapper:u}=this.hot,{row:d,col:h}=_assertClassBrand$S(_Comments_brand,this,_getRangeCoords).call(this);let f=c.getRenderableFromVisualIndex(d),g=u.getRenderableFromVisualIndex(h);const m=f===null;_classPrivateFieldGet$E(_editor,this).setPosition(0,0),f===null&&(f=c.getRenderableFromVisualIndex(c.getNearestNotHiddenIndex(d,-1))),g===null&&(g=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(h,-1)));const p=f===null,v=g===null;f=f??0,g=g??0;const{rootWindow:w,view:{_wt:E}}=this.hot,{wtTable:C}=E,b=E.getCell({row:f,col:g},!0),P=this.getCommentMeta(d,h,META_STYLE);P?_classPrivateFieldGet$E(_editor,this).setSize(P.width,P.height):_classPrivateFieldGet$E(_editor,this).resetSize();const R=v?0:C.getColumnWidth(g),T=m&&!p?outerHeight(b):0,{left:I,top:M,width:N,height:H}=b.getBoundingClientRect(),{width:L,height:A}=_classPrivateFieldGet$E(_editor,this).getSize(),{innerWidth:k,innerHeight:W}=this.hot.rootWindow,G=this.hot.rootDocument.documentElement,oe=getScrollbarWidth(this.hot.rootDocument),ae=hasVerticalScrollbar(this.hot.rootWindow)?oe:0,X=hasHorizontalScrollbar(this.hot.rootWindow)?oe:0;let le=I+w.scrollX+R,ye=M+w.scrollY+T;this.hot.isRtl()&&(le-=L+R),this.hot.isLtr()&&I+N+L>k-ae?le=I+w.scrollX-L-1:this.hot.isRtl()&&le<-(G.scrollWidth-G.clientWidth)&&(le=I+w.scrollX+R+1),M+A>W-X&&(ye-=A-H+1),_classPrivateFieldGet$E(_editor,this).setPosition(le,ye),_classPrivateFieldGet$E(_editor,this).setReadOnlyState(this.getCommentMeta(d,h,META_READONLY)),_classPrivateFieldGet$E(_editor,this).observeSize()}focusEditor(){_classPrivateFieldGet$E(_editor,this).focus()}updateCommentMeta(s,c,u){const d=this.hot.getCellMeta(s,c)[META_COMMENT];let h;d?(h=deepClone(d),deepExtend(h,u)):h=u,this.hot.setCellMeta(s,c,META_COMMENT,h)}getCommentMeta(s,c,u){const d=this.hot.getCellMeta(s,c);if(d[META_COMMENT])return d[META_COMMENT][u]}addToContextMenu(s){s.items.push({name:KEY$c},addEditCommentItem(this),removeCommentItem(this),readOnlyCommentItem(this))}getEditorInputElement(){return _classPrivateFieldGet$E(_editor,this).getInputElement()}destroy(){var s,c;(s=_classPrivateFieldGet$E(_editor,this))===null||s===void 0||s.destroy(),(c=_classPrivateFieldGet$E(_displaySwitch,this))===null||c===void 0||c.destroy(),super.destroy()}}function _onMouseDown$2(a){if(!(!this.hot.view||!this.hot.view._wt)&&!_classPrivateFieldGet$E(_preventEditorAutoSwitch,this)&&!this.targetIsCommentTextArea(a)){const s=closest(a.target,"TD","TBODY");let c=null;s&&(c=this.hot.getCoords(s)),(!s||this.range.from&&c&&(this.range.from.row!==c.row||this.range.from.col!==c.col))&&this.hide()}}function _onInputElementMouseDown(a){a.stopPropagation()}function _onMouseOver$2(a){const{rootDocument:s}=this.hot;if(!(_classPrivateFieldGet$E(_preventEditorAutoSwitch,this)||_classPrivateFieldGet$E(_editor,this).isFocused()||hasClass$1(a.target,"wtBorder")||_classPrivateFieldGet$E(_cellBelowCursor,this)===a.target||!_classPrivateFieldGet$E(_editor,this)))if(_classPrivateFieldSet$D(_cellBelowCursor,this,s.elementFromPoint(a.clientX,a.clientY)),this.targetIsCellWithComment(a)){const c=this.hot._createCellRange(this.hot.getCoords(a.target));_classPrivateFieldGet$E(_displaySwitch,this).show(c)}else isChildOf(a.target,s)&&!this.targetIsCommentTextArea(a)&&_classPrivateFieldGet$E(_displaySwitch,this).hide()}function _onMouseUp$4(){_classPrivateFieldSet$D(_preventEditorAutoSwitch,this,!1)}function _onAfterRenderer(a,s){s[META_COMMENT]&&s[META_COMMENT][META_COMMENT_VALUE]&&addClass$1(a,s.commentedCellClassName)}function _onEditorBlur(){if(_classPrivateFieldGet$E(_preventEditorSaveOnBlur,this)){_classPrivateFieldSet$D(_preventEditorSaveOnBlur,this,!1);return}_classPrivateFieldSet$D(_commentValueBeforeSave,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function _onEditorFocus(){_classPrivateFieldSet$D(_commentValueBeforeSave,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(SHORTCUTS_CONTEXT_NAME$3)}function _onEditorResize(a,s){const{row:c,col:u}=_assertClassBrand$S(_Comments_brand,this,_getRangeCoords).call(this);this.updateCommentMeta(c,u,{[META_STYLE]:{width:a,height:s}})}function _onAfterDocumentKeyDown(a){_classPrivateFieldGet$E(_editor,this).isFocused()&&stopImmediatePropagation(a)}function _onAfterScroll(){_classPrivateFieldGet$E(_preventEditorHiding,this)||this.hide()}function _getRangeCoords(){return this.range instanceof CellRange?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function _defineProperty$Z(a,s,c){return(s=_toPropertyKey$Z(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$Z(a){var s=_toPrimitive$Z(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$Z(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CommandExecutor{constructor(s){_defineProperty$Z(this,"hot",void 0),_defineProperty$Z(this,"commands",{}),_defineProperty$Z(this,"commonCallback",null),this.hot=s}registerCommand(s,c){this.commands[s]=c}setCommonCallback(s){this.commonCallback=s}execute(s){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];const h=s.split(":"),f=h[0],g=h.length===2?h[1]:null;let m=this.commands[f];if(!m)throw new Error(`Menu command '${f}' not exists.`);if(g&&m.submenu&&(m=findSubCommand(g,m.submenu.items)),m.disabled===!0||typeof m.disabled=="function"&&m.disabled.call(this.hot)===!0||hasOwnProperty(m,"submenu"))return;const p=[];typeof m.callback=="function"&&p.push(m.callback),typeof this.commonCallback=="function"&&p.push(this.commonCallback),u.unshift(h.join(":")),arrayEach(p,v=>v.apply(this.hot,u))}}function findSubCommand(a,s){let c;return arrayEach(s,u=>{const d=u.key?u.key.split(":"):null;if(Array.isArray(d)&&d[1]===a)return c=u,!1}),c}function _defineProperty$Y(a,s,c){return(s=_toPropertyKey$Y(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$Y(a){var s=_toPrimitive$Y(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$Y(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ItemsFactory{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;_defineProperty$Y(this,"hot",void 0),_defineProperty$Y(this,"predefinedItems",predefinedItems()),_defineProperty$Y(this,"defaultOrderPattern",void 0),this.hot=s,this.defaultOrderPattern=c}setPredefinedItems(s){const c={};this.defaultOrderPattern.length=0,objectEach(s,(u,d)=>{let h="";u.name===KEY$c?(c[KEY$c]=u,h=KEY$c):isNaN(parseInt(d,10))?(u.key=u.key===void 0?d:u.key,c[d]=u,h=u.key):(c[u.key]=u,h=u.key),this.defaultOrderPattern.push(h)}),this.predefinedItems=c}getItems(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return getItems(s,this.defaultOrderPattern,this.predefinedItems)}}function getItems(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const u=[];let d=a;return d&&d.items?d=d.items:Array.isArray(d)||(d=s),isObject(d)?objectEach(d,(h,f)=>{let g=c[typeof h=="string"?h:f];g||(g=h),isObject(h)?extend$1(g,h):typeof g=="string"&&(g={name:g}),g.key===void 0&&(g.key=f),u.push(g)}):arrayEach(d,(h,f)=>{let g=c[h];!g&&ITEMS.indexOf(h)>=0||(g||(g={name:h,key:`${f}`}),isObject(h)&&extend$1(g,h),g.key===void 0&&(g.key=f),u.push(g))}),u}function _defineProperty$X(a,s,c){return(s=_toPropertyKey$X(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$X(a){var s=_toPrimitive$X(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$X(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Cursor{constructor(s,c){_defineProperty$X(this,"top",void 0),_defineProperty$X(this,"topRelative",void 0),_defineProperty$X(this,"left",void 0),_defineProperty$X(this,"leftRelative",void 0),_defineProperty$X(this,"scrollTop",void 0),_defineProperty$X(this,"scrollLeft",void 0),_defineProperty$X(this,"cellHeight",void 0),_defineProperty$X(this,"cellWidth",void 0);const u=c.scrollY,d=c.scrollX;let h,f,g,m,p,v;this.rootWindow=c,this.type=this.getSourceType(s),this.type==="literal"?(h=parseInt(s.top,10),g=parseInt(s.left,10),p=s.height||0,v=s.width||0,f=h,m=g,h+=u,g+=d):this.type==="event"&&(h=parseInt(s.pageY,10),g=parseInt(s.pageX,10),p=s.target.clientHeight,v=s.target.clientWidth,f=h-u,m=g-d),this.top=h,this.topRelative=f,this.left=g,this.leftRelative=m,this.scrollTop=u,this.scrollLeft=d,this.cellHeight=p,this.cellWidth=v}getSourceType(s){let c="literal";return s instanceof Event&&(c="event"),c}fitsAbove(s){return this.topRelative>=s.offsetHeight}fitsBelow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+s.offsetHeight<=c}fitsOnRight(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+s.offsetWidth<=c}fitsOnLeft(s){return this.leftRelative>=s.offsetWidth}}function _classPrivateFieldInitSpec$D(a,s,c){_checkPrivateRedeclaration$R(a,s),s.set(a,c)}function _checkPrivateRedeclaration$R(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$D(a,s){return a.get(_assertClassBrand$R(a,s))}function _classPrivateFieldSet$C(a,s,c){return a.set(_assertClassBrand$R(a,s),c),c}function _assertClassBrand$R(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _container=new WeakMap,_parentContainer=new WeakMap,_cursor=new WeakMap,_keepInViewport=new WeakMap,_offset=new WeakMap;class Positioner{constructor(s){_classPrivateFieldInitSpec$D(this,_container,void 0),_classPrivateFieldInitSpec$D(this,_parentContainer,void 0),_classPrivateFieldInitSpec$D(this,_cursor,void 0),_classPrivateFieldInitSpec$D(this,_keepInViewport,!1),_classPrivateFieldInitSpec$D(this,_offset,{above:0,below:0,left:0,right:0}),_classPrivateFieldSet$C(_keepInViewport,this,s)}setOffset(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return _classPrivateFieldGet$D(_offset,this)[s]=c,this}setElement(s){return _classPrivateFieldSet$C(_container,this,s),this}setParentElement(s){return _classPrivateFieldSet$C(_parentContainer,this,s),this}updatePosition(s){_classPrivateFieldSet$C(_cursor,this,new Cursor(s,_classPrivateFieldGet$D(_container,this).ownerDocument.defaultView)),_classPrivateFieldGet$D(_keepInViewport,this)?(_classPrivateFieldGet$D(_cursor,this).fitsBelow(_classPrivateFieldGet$D(_container,this))?this.setPositionBelowCursor():_classPrivateFieldGet$D(_cursor,this).fitsAbove(_classPrivateFieldGet$D(_container,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){_classPrivateFieldGet$D(_container,this).dir==="rtl"?_classPrivateFieldGet$D(_cursor,this).fitsOnLeft(_classPrivateFieldGet$D(_container,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():_classPrivateFieldGet$D(_cursor,this).fitsOnRight(_classPrivateFieldGet$D(_container,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let s=_classPrivateFieldGet$D(_offset,this).above+_classPrivateFieldGet$D(_cursor,this).top-_classPrivateFieldGet$D(_container,this).offsetHeight;if(_classPrivateFieldGet$D(_parentContainer,this)){const u=_classPrivateFieldGet$D(_parentContainer,this).ownerDocument.defaultView.getComputedStyle(_classPrivateFieldGet$D(_parentContainer,this).querySelector(".ht_master")),d=Number.parseInt(u.paddingTop,10),h=Number.parseInt(u.borderTop,10);s=_classPrivateFieldGet$D(_cursor,this).top+_classPrivateFieldGet$D(_cursor,this).cellHeight-_classPrivateFieldGet$D(_container,this).scrollHeight+d+h}_classPrivateFieldGet$D(_container,this).style.top=`${s}px`}setPositionBelowCursor(){let s=_classPrivateFieldGet$D(_offset,this).below+_classPrivateFieldGet$D(_cursor,this).top+1;if(_classPrivateFieldGet$D(_parentContainer,this)){const u=_classPrivateFieldGet$D(_parentContainer,this).ownerDocument.defaultView.getComputedStyle(_classPrivateFieldGet$D(_parentContainer,this).querySelector(".ht_master")),d=Number.parseInt(u.paddingTop,10),h=Number.parseInt(u.borderTop,10);s=_classPrivateFieldGet$D(_cursor,this).top-d-h}_classPrivateFieldGet$D(_container,this).style.top=`${s}px`}setPositionOnRightOfCursor(){let s=_classPrivateFieldGet$D(_cursor,this).left;if(_classPrivateFieldGet$D(_parentContainer,this)){const c=_classPrivateFieldGet$D(_parentContainer,this).ownerDocument.defaultView,u=Number.parseInt(c.getComputedStyle(_classPrivateFieldGet$D(_parentContainer,this).querySelector(".htCore")).borderRightWidth,10);s+=_classPrivateFieldGet$D(_cursor,this).cellWidth+u}else s+=_classPrivateFieldGet$D(_offset,this).right;_classPrivateFieldGet$D(_container,this).style.left=`${s}px`}setPositionOnLeftOfCursor(){let s=_classPrivateFieldGet$D(_offset,this).left+_classPrivateFieldGet$D(_cursor,this).left-_classPrivateFieldGet$D(_container,this).offsetWidth;if(_classPrivateFieldGet$D(_parentContainer,this)){const c=_classPrivateFieldGet$D(_parentContainer,this).ownerDocument.defaultView,u=Number.parseInt(c.getComputedStyle(_classPrivateFieldGet$D(_parentContainer,this).querySelector(".htCore")).borderLeftWidth,10);s-=u}_classPrivateFieldGet$D(_container,this).style.left=`${s}px`}}function createPaginator(a){let{initialPage:s=-1,size:c=()=>0,onItemSelect:u=()=>{},onClear:d=()=>{}}=a;const h=new Set;let f=clamp(s,-1,P()-1);function g(T,I){const M=P()-1;return T<0&&(T=M),T>M&&(T=0),h.has(T)?-1:(h.add(T),u(T,!1)===!1&&(T=g(I===1?++T:--T,I)),T)}function m(T){T>-1&&T<P()&&u(T,!0)!==!1&&(f=T)}function p(T){T>-1&&T<P()&&(f=T)}function v(){return f}function w(){P()>0&&(h.clear(),f=g(0,1))}function E(){P()>0&&(h.clear(),f=g(P()-1,-1))}function C(){P()>0&&(h.clear(),f=g(++f,1))}function b(){P()>0&&(h.clear(),f=g(--f,-1))}function P(){return Math.max(c(),0)}function R(){h.clear(),f=s,d()}return{setCurrentPage:m,setPageCursorAt:p,getCurrentPage:v,toFirstItem:w,toLastItem:E,toNextItem:C,toPreviousItem:b,getSize:P,clear:R}}function normalizeSelection(a){return arrayMap(a,s=>({start:s.getTopStartCorner(),end:s.getBottomEndCorner()}))}function isItemSubMenu(a){return hasOwnProperty(a,"submenu")}function isItemSeparator(a){return new RegExp(KEY$c,"i").test(a.name)}function isItemDisabled(a,s){return a.disabled===!0||typeof a.disabled=="function"&&a.disabled.call(s)===!0}function isItemSelectionDisabled(a){return hasOwnProperty(a,"disableSelection")}function isSeparator(a){return hasClass$1(a,"htSeparator")}function hasSubMenu(a){return hasClass$1(a,"htSubmenu")}function isDisabled(a){return hasClass$1(a,"htDisabled")}function isSelectionDisabled(a){return hasClass$1(a,"htSelectionDisabled")}function isItemHidden(a,s){return!a.hidden||!(typeof a.hidden=="function"&&a.hidden.call(s))}function shiftSeparators(a,s){const c=a.slice(0);for(let u=0;u<c.length&&c[u].name===s;)c.shift();return c}function popSeparators(a,s){let c=a.slice(0);return c.reverse(),c=shiftSeparators(c,s),c.reverse(),c}function removeDuplicatedSeparators(a){const s=[];return arrayEach(a,(c,u)=>{u>0?s[s.length-1].name!==c.name&&s.push(c):s.push(c)}),s}function filterSeparators(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:KEY$c,c=a.slice(0);return c=shiftSeparators(c,s),c=popSeparators(c,s),c=removeDuplicatedSeparators(c),c}function isItemCheckable(a){return a.checkable===!0}function createMenuNavigator(a){return createPaginator({size:()=>a.countRows(),onItemSelect(s,c){const u=a.getCell(s,0);if(!u||isSeparator(u)||isDisabled(u)||isSelectionDisabled(u))return!1;a.selectCell(s,0,...c?[s,0,!1,!1]:[])},onClear(){a.deselectCell()}})}function createDefaultShortcutsList(a){const{hot:s,hotMenu:c}=a;return[{keys:[["Control/Meta","A"]],forwardToContext:s.getShortcutManager().getContext("grid"),callback:()=>a.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(u,d)=>{const h=s.getSettings(),f=typeof h.tabMoves=="function"?h.tabMoves(u):h.tabMoves;d.includes("shift")?s.selection.transformStart(-f.row,-f.col):s.selection.transformStart(f.row,f.col),a.close(!0)}},{keys:[["Escape"]],callback:()=>a.close()},{keys:[["ArrowDown"]],callback:()=>a.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>a.getNavigator().toPreviousItem()},{keys:[[s.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const u=c.getSelectedActive();if(u){const d=a.openSubMenu(u[0]);d&&d.getNavigator().toFirstItem()}}},{keys:[[s.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{c.getSelectedActive()&&a.isSubMenu()&&(a.close(),a.isSubMenu()&&a.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>a.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>a.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:u=>{const d=c.getSelectedActive();d&&(c.getSourceDataAtRow(d[0]).submenu?a.openSubMenu(d[0]).getNavigator().toFirstItem():(a.executeCommand(u),a.close(!0)))}},{keys:[["PageUp"]],callback:()=>{c.getSelectedActive()?c.selection.transformStart(-c.countVisibleRows(),0):a.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{c.getSelectedActive()?c.selection.transformStart(c.countVisibleRows(),0):a.getNavigator().toLastItem()}}]}const SHORTCUTS_CONTEXT="menu",SHORTCUTS_GROUP$9=SHORTCUTS_CONTEXT;function createKeyboardShortcutsCtrl(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const c=[];u(createDefaultShortcutsList(a)),s.forEach(p=>{let{shortcuts:v,contextName:w}=p;d(v,w)});function u(p,v){g(v).addShortcuts(p,{group:SHORTCUTS_CONTEXT})}function d(p,v){const w=g(v);p.forEach(E=>{let{keys:C}=E;C.forEach(b=>w.removeShortcutsByKeys(b))}),c.push({shortcuts:p,contextName:v}),u(p,v)}function h(){return[...c]}function f(p){return p?`${SHORTCUTS_GROUP$9}:${p}`:SHORTCUTS_GROUP$9}function g(p){var v;const w=a.hotMenu.getShortcutManager(),E=f(p);return(v=w.getContext(E))!==null&&v!==void 0?v:w.addContext(E)}function m(p){a.hotMenu.getShortcutManager().setActiveContextName(f(p))}return{addCustomShortcuts:d,getCustomShortcuts:h,getContext:g,listen:m}}function createMenuItemRenderer(a){return(s,c,u,d,h,f)=>{const g=s.getSourceDataAtRow(u),m=a.rootDocument.createElement("div"),p=typeof f=="function"?f.call(a):f,v=typeof g.ariaLabel=="function"?g.ariaLabel.call(a):g.ariaLabel,w=typeof g.ariaChecked=="function"?g.ariaChecked.call(a):g.ariaChecked;if(empty(c),addClass$1(m,"htItemWrapper"),a.getSettings().ariaTags){const E=!isItemDisabled(g,a)&&!isItemSelectionDisabled(g)&&!isItemSeparator(g);setAttribute(c,[...isItemCheckable(g)?[A11Y_MENU_ITEM_CHECKBOX(),A11Y_LABEL(v),A11Y_CHECKED(w)]:[A11Y_MENU_ITEM(),A11Y_LABEL(p)],...E?[A11Y_TABINDEX(-1)]:[],...isItemDisabled(g,a)?[A11Y_DISABLED()]:[],...isItemSubMenu(g)?[A11Y_EXPANDED(!1)]:[]])}c.className="",c.appendChild(m),isItemSeparator(g)?addClass$1(c,"htSeparator"):typeof g.renderer=="function"?(addClass$1(c,"htCustomMenuRenderer"),c.appendChild(g.renderer(s,m,u,d,h,p))):fastInnerHTML(m,p),isItemDisabled(g,a)?addClass$1(c,"htDisabled"):isItemSelectionDisabled(g)?addClass$1(c,"htSelectionDisabled"):isItemSubMenu(g)&&addClass$1(c,"htSubmenu")}}function _classPrivateFieldInitSpec$C(a,s,c){_checkPrivateRedeclaration$Q(a,s),s.set(a,c)}function _checkPrivateRedeclaration$Q(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$W(a,s,c){return(s=_toPropertyKey$W(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$W(a){var s=_toPrimitive$W(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$W(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldSet$B(a,s,c){return a.set(_assertClassBrand$Q(a,s),c),c}function _classPrivateFieldGet$C(a,s){return a.get(_assertClassBrand$Q(a,s))}function _assertClassBrand$Q(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const MIN_WIDTH=215;var _navigator=new WeakMap,_shortcutsCtrl=new WeakMap,_tableBorderWidth=new WeakMap;class Menu{get tableBorderWidth(){return _classPrivateFieldGet$C(_tableBorderWidth,this)===void 0&&this.hotMenu&&_classPrivateFieldSet$B(_tableBorderWidth,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),_classPrivateFieldGet$C(_tableBorderWidth,this)}constructor(s,c){var u=this;_defineProperty$W(this,"hot",void 0),_defineProperty$W(this,"options",void 0),_defineProperty$W(this,"eventManager",new EventManager(this)),_defineProperty$W(this,"container",void 0),_defineProperty$W(this,"positioner",void 0),_defineProperty$W(this,"hotMenu",null),_defineProperty$W(this,"hotSubMenus",{}),_defineProperty$W(this,"parentMenu",void 0),_defineProperty$W(this,"menuItems",null),_defineProperty$W(this,"origOutsideClickDeselects",null),_classPrivateFieldInitSpec$C(this,_navigator,void 0),_classPrivateFieldInitSpec$C(this,_shortcutsCtrl,void 0),_classPrivateFieldInitSpec$C(this,_tableBorderWidth,void 0),this.hot=s,this.options=c||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:MIN_WIDTH,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new Positioner(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return u.parentMenu.runLocalHooks("afterSelectionChange",...h)}),this.hot.addHook("afterSetTheme",(d,h)=>{this.options.container!==this.hot.rootPortalElement&&(removeClass$1(this.options.container,/ht-theme-.*/g),addClass$1(this.options.container,d)),h||this.close()})}registerEvents(){let s=this.hot.rootWindow;for(;s;)this.eventManager.addEventListener(s.document,"mousedown",c=>this.onDocumentMouseDown(c)),this.eventManager.addEventListener(s.document,"touchstart",c=>this.onDocumentMouseDown(c)),this.eventManager.addEventListener(s.document,"contextmenu",c=>this.onDocumentContextMenu(c)),s=getParentWindow(s)}setMenuItems(s){this.menuItems=s}getNavigator(){return _classPrivateFieldGet$C(_navigator,this)}getKeyboardShortcutsCtrl(){return _classPrivateFieldGet$C(_shortcutsCtrl,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const s=debounce(g=>this.openSubMenu(g),300),c=this.options.minWidth||MIN_WIDTH;let u=!1,d=arrayFilter(this.menuItems,g=>(g.key===KEY$1&&(u=!0),isItemHidden(g,this.hot)));if(d.length<1&&!u)d.push(predefinedItems()[KEY$1]);else if(d.length===0)return;d=filterSeparators(d,KEY$c);let h=!1;const f={data:d,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(g){return isDefined(g)&&g<c?c:g},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:createMenuItemRenderer(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(g,m)=>{this.hotMenu.stylesHandler.isClassicTheme()?_classPrivateFieldGet$C(_navigator,this).setCurrentPage(m.row):_classPrivateFieldGet$C(_navigator,this).setPageCursorAt(m.row)},afterOnCellMouseOver:(g,m)=>{this.isAllSubMenusClosed()?s(m.row):this.openSubMenu(m.row)},afterOnCellContextMenu:g=>{g.preventDefault(),isWindowsOS()&&h&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(g,m,p,v,w)=>{this.hotMenu.view.isMouseDown()&&(w.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:g=>{this.hasSelectedItem()&&(h=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(g))},afterOnCellMouseUp:g=>{(!isWindowsOS()||!isRightClick(g))&&h&&this.hasSelectedItem()&&(isMobileBrowser()||isIpadOS()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,f),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),_classPrivateFieldSet$B(_navigator,this,createMenuNavigator(this.hotMenu)),_classPrivateFieldSet$B(_shortcutsCtrl,this,createKeyboardShortcutsCtrl(this)),_classPrivateFieldGet$C(_shortcutsCtrl,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(s&&this.isSubMenu())this.parentMenu.close();else if(_classPrivateFieldGet$C(_navigator,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const c=this.parentMenu.hotMenu.getSelectedActive();if(c){const u=this.parentMenu.hotMenu.getCell(c[0],0);setAttribute(u,[A11Y_EXPANDED(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(s){if(!this.hotMenu)return!1;const c=this.hotMenu.getCell(s,0);if(this.closeAllSubMenus(),!c||!hasSubMenu(c))return!1;const u=this.hotMenu.getSourceDataAtRow(s),d=new Menu(this.hot,{parent:this,name:u.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return d.setMenuItems(u.submenu.items),d.open(),d.setPosition(c.getBoundingClientRect()),this.hotSubMenus[u.key]=d,this.hot.getSettings().ariaTags&&setAttribute(c,[A11Y_EXPANDED(!0)]),d}closeSubMenu(s){const c=this.hotMenu.getSourceDataAtRow(s),u=this.hotSubMenus[c.key];if(u){u.destroy(),delete this.hotSubMenus[c.key];const d=this.hotMenu.getCell(s,0);this.hot.getSettings().ariaTags&&setAttribute(d,[A11Y_EXPANDED(!1)])}}closeAllSubMenus(){arrayEach(this.hotMenu.getData(),(s,c)=>this.closeSubMenu(c))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const s=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),s&&s.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(s){if(!this.isOpened()||!this.hasSelectedItem())return;const c=this.getSelectedItem();if(this.runLocalHooks("select",c,s),this.isCommandPassive(c))return;const u=this.hot.getSelectedRange(),d=u?normalizeSelection(u):[];this.runLocalHooks("executeCommand",c.key,d,s),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",c.key,d,s)}isCommandPassive(s){return s.isCommand===!1||isItemSeparator(s)||isItemDisabled(s,this.hot)||isItemSubMenu(s)}setOffset(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(s,c)}setPosition(s){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(s)}updateMenuDimensions(){const{wtTable:s}=this.hotMenu.view._wt,c=this.hotMenu.getSettings().data,u=s.hider.style,d=s.holder.style,h=parseInt(u.width,10),f=arrayReduce(c,(g,m,p)=>{const w=this.hotMenu.getCell(p,0)?outerHeight(this.hotMenu.getCell(p,0)):0;return g+(m.name===KEY$c?1:w)},0);this.hotMenu.stylesHandler.isClassicTheme()?(d.width=`${h+3}px`,d.height=`${f+3}px`):(d.width=`${h}px`,d.height=`${f}px`),u.height=d.height}createContainer(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const c=this.options.container.ownerDocument;let u=s,d;return u&&(isFunction(u)&&(u=u.call(this.hot),u===null||isUndefined(u)?u="":u=u.toString()),u=u.replace(/[^A-Za-z0-9]/g,"_"),u=`${this.options.className}Sub_${u}`,d=c.querySelector(`.${this.options.className}.${u}`)),d||(d=c.createElement("div"),addClass$1(d,`htMenu handsontable ${this.options.className}`),u&&addClass$1(d,u),this.options.container.appendChild(d)),d}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&setAttribute(this.hotMenu.rootElement,[A11Y_MENU(),A11Y_TABINDEX(-1)])}onDocumentMouseDown(s){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!isChildOf(s.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!isChildOf(s.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(s){this.isOpened()&&hasClass$1(s.target,"htCore")&&isChildOf(s.target,this.hotMenu.rootElement)&&s.preventDefault()}}mixin(Menu,localHooks);function _classPrivateMethodInitSpec$E(a,s){_checkPrivateRedeclaration$P(a,s),s.add(a)}function _checkPrivateRedeclaration$P(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$V(a,s,c){return(s=_toPropertyKey$V(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$V(a){var s=_toPrimitive$V(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$V(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$P(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$t="contextMenu",PLUGIN_PRIORITY$t=70,SHORTCUTS_GROUP$8=PLUGIN_KEY$t;Hooks.getSingleton().register("afterContextMenuDefaultOptions"),Hooks.getSingleton().register("beforeContextMenuShow"),Hooks.getSingleton().register("afterContextMenuShow"),Hooks.getSingleton().register("afterContextMenuHide"),Hooks.getSingleton().register("afterContextMenuExecute");var _ContextMenu_brand=new WeakSet;class ContextMenu extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$E(this,_ContextMenu_brand),_defineProperty$V(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$V(this,"itemsFactory",null),_defineProperty$V(this,"menu",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$t}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$t}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$3,KEY$2,KEY$c,KEY$9,KEY$8,KEY$c,KEY$4,KEY$5,KEY$c,KEY,KEY$6,KEY$c,KEY$7,KEY$c,KEY$b]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$t]}enablePlugin(){var s=this;if(this.enabled)return;const c=this.hot.getSettings()[PLUGIN_KEY$t];typeof c.callback=="function"&&this.commandExecutor.setCommonCallback(c.callback),this.menu=new Menu(this.hot,{className:"htContextMenu",keepInViewport:!0,container:c.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$P(_ContextMenu_brand,this,_onMenuBeforeOpen$1).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$P(_ContextMenu_brand,this,_onMenuAfterOpen$1).call(this)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$P(_ContextMenu_brand,this,_onMenuAfterClose$1).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return s.executeCommand.call(s,...d)}),this.addHook("afterOnCellContextMenu",u=>_assertClassBrand$P(_ContextMenu_brand,this,_onAfterOnCellContextMenu).call(this,u)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:s}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const c=this.hot.getCell(s.row,s.col,!0).getBoundingClientRect(),u=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({left:c.left+u.left,top:c.top+u.top-1+c.height},{left:c.width,above:-c.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var s;const c=(s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;return c&&this.hot.selection.isCellVisible(c)&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$8})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$8)}open(s){var c;let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(c=this.menu)!==null&&c!==void 0&&c.isOpened()||(this.prepareMenuItems(),this.menu.open(),objectEach(u,(d,h)=>{this.menu.setOffset(h,d)}),this.menu.setPosition(s))}close(){var s;(s=this.menu)===null||s===void 0||s.close(),this.itemsFactory=null}executeCommand(s){this.itemsFactory===null&&this.prepareMenuItems();for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];this.commandExecutor.execute(s,...u)}prepareMenuItems(){this.itemsFactory=new ItemsFactory(this.hot,ContextMenu.DEFAULT_ITEMS);const s=this.hot.getSettings()[PLUGIN_KEY$t],c={items:this.itemsFactory.getItems(s)};this.hot.runHooks("afterContextMenuDefaultOptions",c),this.itemsFactory.setPredefinedItems(c.items);const u=this.itemsFactory.getItems(s);this.hot.runHooks("beforeContextMenuSetItems",u),this.menu.setMenuItems(u),arrayEach(u,d=>this.commandExecutor.registerCommand(d.key,d))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _onAfterOnCellContextMenu(a){const s=this.hot.getSettings(),c=s.rowHeaders,u=s.colHeaders;function d(g){return g.nodeName==="TD"||g.parentNode.nodeName==="TD"}const h=a.target;if(this.close(),hasClass$1(h,"handsontableInput")||(a.preventDefault(),a.stopPropagation(),!(c||u)&&!d(h)&&!(hasClass$1(h,"current")&&hasClass$1(h,"wtBorder"))))return;const f=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument);this.open({top:a.clientY+f.top,left:a.clientX+f.left})}function _onMenuBeforeOpen$1(){this.hot.runHooks("beforeContextMenuShow",this)}function _onMenuAfterOpen$1(){this.hot.runHooks("afterContextMenuShow",this)}function _onMenuAfterClose$1(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}ContextMenu.SEPARATOR={name:KEY$c};function copyItem(a){return{key:"copy",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY)},callback(){a.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const s=this.getSelectedRangeActive();if(!s||s.isSingleHeader())return!0;const c=this.getSelected();return!c||c.length>1},hidden:!1}}function copyColumnHeadersOnlyItem(a){return{key:"copy_column_headers_only",name(){const s=this.getSelectedRangeActive(),c=s?clamp(s.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY,c)},callback(){a.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const s=this.getSelectedRangeActive();if(!s||s.isSingleHeader())return!0;const c=this.getSelected();return!c||c.length>1},hidden:!1}}function copyWithColumnGroupHeadersItem(a){return{key:"copy_with_column_group_headers",name(){const s=this.getSelectedRangeActive(),c=s?clamp(s.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS,c)},callback(){a.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const s=this.getSelectedRangeActive();if(!s||s.isSingleHeader())return!0;const c=this.getSelected();return!c||c.length>1},hidden:!1}}function copyWithColumnHeadersItem(a){return{key:"copy_with_column_headers",name(){const s=this.getSelectedRangeActive(),c=s?clamp(s.getWidth()-1,0,1):0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS,c)},callback(){a.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const s=this.getSelectedRangeActive();if(!s||s.isSingleHeader())return!0;const c=this.getSelected();return!c||c.length>1},hidden:!1}}function cutItem(a){return{key:"cut",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_CUT)},callback(){a.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const s=this.getSelectedRangeActive();if(!s||s.isSingleHeader())return!0;const c=this.getSelected();return!c||c.length>1},hidden:!1}}class ClipboardData{constructor(){this.data={}}setData(s,c){this.data[s]=c}getData(s){return this.data[s]||void 0}}class PasteEvent{constructor(){this.clipboardData=new ClipboardData}preventDefault(){}composedPath(){return[]}}function _classPrivateMethodInitSpec$D(a,s){_checkPrivateRedeclaration$O(a,s),s.add(a)}function _classPrivateFieldInitSpec$B(a,s,c){_checkPrivateRedeclaration$O(a,s),s.set(a,c)}function _checkPrivateRedeclaration$O(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$B(a,s){return a.get(_assertClassBrand$O(a,s))}function _classPrivateFieldSet$A(a,s,c){return a.set(_assertClassBrand$O(a,s),c),c}function _assertClassBrand$O(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _selectedRange=new WeakMap,_countRows=new WeakMap,_countColumns=new WeakMap,_rowsLimit=new WeakMap,_columnsLimit$1=new WeakMap,_countColumnHeaders=new WeakMap,_CopyableRangesFactory_brand=new WeakSet;class CopyableRangesFactory{constructor(s){let{countRows:c,countColumns:u,rowsLimit:d,columnsLimit:h,countColumnHeaders:f}=s;_classPrivateMethodInitSpec$D(this,_CopyableRangesFactory_brand),_classPrivateFieldInitSpec$B(this,_selectedRange,void 0),_classPrivateFieldInitSpec$B(this,_countRows,void 0),_classPrivateFieldInitSpec$B(this,_countColumns,void 0),_classPrivateFieldInitSpec$B(this,_rowsLimit,void 0),_classPrivateFieldInitSpec$B(this,_columnsLimit$1,void 0),_classPrivateFieldInitSpec$B(this,_countColumnHeaders,void 0),_classPrivateFieldSet$A(_countRows,this,c),_classPrivateFieldSet$A(_countColumns,this,u),_classPrivateFieldSet$A(_rowsLimit,this,d),_classPrivateFieldSet$A(_columnsLimit$1,this,h),_classPrivateFieldSet$A(_countColumnHeaders,this,f)}setSelectedRange(s){_classPrivateFieldSet$A(_selectedRange,this,s)}getCellsRange(){if(_classPrivateFieldGet$B(_countRows,this).call(this)===0||_classPrivateFieldGet$B(_countColumns,this).call(this)===0)return null;const{row:s,col:c}=_classPrivateFieldGet$B(_selectedRange,this).getTopStartCorner(),{row:u,col:d}=_classPrivateFieldGet$B(_selectedRange,this).getBottomEndCorner(),h=_assertClassBrand$O(_CopyableRangesFactory_brand,this,_trimRowsRange).call(this,s,u),f=_assertClassBrand$O(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,c,d);return{isRangeTrimmed:u!==h||d!==f,startRow:s,startCol:c,endRow:h,endCol:f}}getMostBottomColumnHeadersRange(){if(_classPrivateFieldGet$B(_countColumns,this).call(this)===0||_classPrivateFieldGet$B(_countColumnHeaders,this).call(this)===0)return null;const{col:s}=_classPrivateFieldGet$B(_selectedRange,this).getTopStartCorner(),{col:c}=_classPrivateFieldGet$B(_selectedRange,this).getBottomEndCorner(),u=_assertClassBrand$O(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,s,c);return{isRangeTrimmed:c!==u,startRow:-1,startCol:s,endRow:-1,endCol:u}}getAllColumnHeadersRange(){if(_classPrivateFieldGet$B(_countColumns,this).call(this)===0||_classPrivateFieldGet$B(_countColumnHeaders,this).call(this)===0)return null;const{col:s}=_classPrivateFieldGet$B(_selectedRange,this).getTopStartCorner(),{col:c}=_classPrivateFieldGet$B(_selectedRange,this).getBottomEndCorner(),u=_assertClassBrand$O(_CopyableRangesFactory_brand,this,_trimColumnsRange).call(this,s,c);return{isRangeTrimmed:c!==u,startRow:-_classPrivateFieldGet$B(_countColumnHeaders,this).call(this),startCol:s,endRow:-1,endCol:u}}}function _trimColumnsRange(a,s){return Math.min(s,Math.max(a+_classPrivateFieldGet$B(_columnsLimit$1,this).call(this)-1,a))}function _trimRowsRange(a,s){return Math.min(s,Math.max(a+_classPrivateFieldGet$B(_rowsLimit,this).call(this)-1,a))}function normalizeRanges(a){const s=[],c=[];return arrayEach(a,u=>{const d=Math.min(u.startRow,u.endRow),h=Math.max(u.startRow,u.endRow);rangeEach(d,h,m=>{s.indexOf(m)===-1&&s.push(m)});const f=Math.min(u.startCol,u.endCol),g=Math.max(u.startCol,u.endCol);rangeEach(f,g,m=>{c.indexOf(m)===-1&&c.push(m)})}),{rows:s,columns:c}}function _classPrivateMethodInitSpec$C(a,s){_checkPrivateRedeclaration$N(a,s),s.add(a)}function _classPrivateFieldInitSpec$A(a,s,c){_checkPrivateRedeclaration$N(a,s),s.set(a,c)}function _checkPrivateRedeclaration$N(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$U(a,s,c){return(s=_toPropertyKey$U(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$U(a){var s=_toPrimitive$U(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$U(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$A(a,s){return a.get(_assertClassBrand$N(a,s))}function _classPrivateFieldSet$z(a,s,c){return a.set(_assertClassBrand$N(a,s),c),c}function _assertClassBrand$N(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterCopyLimit"),Hooks.getSingleton().register("modifyCopyableRange"),Hooks.getSingleton().register("beforeCut"),Hooks.getSingleton().register("afterCut"),Hooks.getSingleton().register("beforePaste"),Hooks.getSingleton().register("afterPaste"),Hooks.getSingleton().register("beforeCopy"),Hooks.getSingleton().register("afterCopy");const PLUGIN_KEY$s="copyPaste",PLUGIN_PRIORITY$s=80,SETTING_KEYS$1=["fragmentSelection"],SOURCE_DATA_HTML_MIME_TYPE="application/ht-source-data-json-html",META_HEAD=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var _enableCopyColumnHeaders=new WeakMap,_enableCopyColumnGroupHeaders=new WeakMap,_enableCopyColumnHeadersOnly=new WeakMap,_copyMode=new WeakMap,_isTriggeredByCopy=new WeakMap,_isTriggeredByCut=new WeakMap,_copyableRangesFactory=new WeakMap,_preventViewportScrollOnPaste=new WeakMap,_CopyPaste_brand=new WeakSet;class CopyPaste extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$C(this,_CopyPaste_brand),_defineProperty$U(this,"columnsLimit",1/0),_defineProperty$U(this,"rowsLimit",1/0),_defineProperty$U(this,"pasteMode","overwrite"),_defineProperty$U(this,"uiContainer",this.hot.rootDocument.body),_classPrivateFieldInitSpec$A(this,_enableCopyColumnHeaders,!1),_classPrivateFieldInitSpec$A(this,_enableCopyColumnGroupHeaders,!1),_classPrivateFieldInitSpec$A(this,_enableCopyColumnHeadersOnly,!1),_classPrivateFieldInitSpec$A(this,_copyMode,"cells-only"),_classPrivateFieldInitSpec$A(this,_isTriggeredByCopy,!1),_classPrivateFieldInitSpec$A(this,_isTriggeredByCut,!1),_classPrivateFieldInitSpec$A(this,_copyableRangesFactory,new CopyableRangesFactory({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),_classPrivateFieldInitSpec$A(this,_preventViewportScrollOnPaste,!1),_defineProperty$U(this,"copyableRanges",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$s}static get SETTING_KEYS(){return[PLUGIN_KEY$s,...SETTING_KEYS$1]}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$s}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$s]}enablePlugin(){var s,c,u=this;this.enabled||(this.pasteMode=(s=this.getSetting("pasteMode"))!==null&&s!==void 0?s:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),_classPrivateFieldSet$z(_enableCopyColumnHeaders,this,this.getSetting("copyColumnHeaders")),_classPrivateFieldSet$z(_enableCopyColumnGroupHeaders,this,this.getSetting("copyColumnGroupHeaders")),_classPrivateFieldSet$z(_enableCopyColumnHeadersOnly,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(c=this.getSetting("uiContainer"))!==null&&c!==void 0?c:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",d=>_assertClassBrand$N(_CopyPaste_brand,this,_onAfterContextMenuDefaultOptions$4).call(this,d)),this.addHook("afterSelection",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$N(_CopyPaste_brand,u,_onAfterSelection).call(u,...h)}),this.addHook("afterSelectionEnd",()=>_assertClassBrand$N(_CopyPaste_brand,this,_onAfterSelectionEnd$1).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return u.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return u.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return u.onPaste(...arguments)}),isSafari()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$N(_CopyPaste_brand,u,_onSafariMouseEnter).call(u,...h)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$N(_CopyPaste_brand,u,_onSafariMouseLeave).call(u,...h)}),this.addHook("afterSelection",()=>_assertClassBrand$N(_CopyPaste_brand,this,_onSafariAfterSelection).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";_classPrivateFieldSet$z(_copyMode,this,s),_classPrivateFieldSet$z(_isTriggeredByCopy,this,!0),_assertClassBrand$N(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){_classPrivateFieldSet$z(_isTriggeredByCut,this,!0),_assertClassBrand$N(_CopyPaste_brand,this,_ensureClipboardEventsGetTriggered).call(this,"cut")}getRangedCopyableData(s){return stringify(this.getRangedData(s))}getRangedData(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const u=[],{rows:d,columns:h}=normalizeRanges(s);return arrayEach(d,f=>{const g=[];arrayEach(h,m=>{if(f<0)g.push(this.hot.getColHeader(m,f));else{let p=c?this.hot.getCopyableSourceData(f,m):this.hot.getCopyableData(f,m);c&&isObject(p)&&(p=JSON.stringify(p)),g.push(p)}}),u.push(g)}),u}paste(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s;if(!s&&!c)return;const u=new PasteEvent;s&&u.clipboardData.setData("text/plain",s),c&&u.clipboardData.setData("text/html",c),this.onPaste(u)}setCopyableText(){const s=this.hot.getSelectedRangeActive();if(!s)return;if(s.isSingleHeader()){this.copyableRanges=[];return}_classPrivateFieldGet$A(_copyableRangesFactory,this).setSelectedRange(s);const c=new Map([["headers",null],["cells",null]]);_classPrivateFieldGet$A(_copyMode,this)==="column-headers-only"?c.set("headers",_classPrivateFieldGet$A(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):(_classPrivateFieldGet$A(_copyMode,this)==="with-column-headers"?c.set("headers",_classPrivateFieldGet$A(_copyableRangesFactory,this).getMostBottomColumnHeadersRange()):_classPrivateFieldGet$A(_copyMode,this)==="with-column-group-headers"&&c.set("headers",_classPrivateFieldGet$A(_copyableRangesFactory,this).getAllColumnHeadersRange()),c.set("cells",_classPrivateFieldGet$A(_copyableRangesFactory,this).getCellsRange())),this.copyableRanges=Array.from(c.values()).filter(d=>d!==null).map(d=>{let{startRow:h,startCol:f,endRow:g,endCol:m}=d;return{startRow:h,startCol:f,endRow:g,endCol:m}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const u=c.get("cells");if(u!==null&&u.isRangeTrimmed){const{startRow:d,startCol:h,endRow:f,endCol:g}=u;this.hot.runHooks("afterCopyLimit",f-d+1,g-h+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var s;return(s=this.hot.getActiveEditor())===null||s===void 0?void 0:s.isOpened()}populateValues(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!s.length)return[null,null,null,null];const d=s.length,h=s[0].length,f=[],{row:g,col:m}=u.getTopStartCorner(),{row:p,col:v}=u.getBottomEndCorner();let w=g,E=m,C=g,b=m;for(;f.length<d||w<=p;){const{skipRowOnPaste:R,visualRow:T}=this.hot.getCellMeta(w,m);if(w=T+1,R===!0)continue;C=T,E=m;const I=[],M=f.length%d;for(;I.length<h||E<=v;){var P;const{skipColumnOnPaste:N,visualCol:H}=this.hot.getCellMeta(T,E),L=this.hot.getSourceDataAtCell(T,E),A=I.length%h;if(E=H+1,N===!0)continue;b=H;const k=c==null||(P=c[M])===null||P===void 0?void 0:P[A];let W=s[M][A];if(c&&isJSON(k)){const G=JSON.parse(k);(isObject(L)||L===null)&&(W=G)}I.push(W)}f.push(I)}return _classPrivateFieldSet$z(_preventViewportScrollOnPaste,this,!0),this.hot.populateFromArray(g,m,f,void 0,void 0,"CopyPaste.paste",this.pasteMode),[g,m,C,b]}onCopy(s){const c=s.composedPath()[0],u=this.hot.getFocusManager().getRefocusElement(),d=c?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$A(_isTriggeredByCopy,this)||this.isEditorOpened()||isHTMLElement(c)&&(d&&c!==u||!d&&c!==this.hot.rootDocument.body&&!isInternalElement(c,this.hot.rootElement)))return;s.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$z(_isTriggeredByCopy,this,!1);const h=this.getRangedData(this.copyableRanges),f=this.getRangedData(this.copyableRanges,!0),g=_assertClassBrand$N(_CopyPaste_brand,this,_countCopiedHeaders).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",h,this.copyableRanges,g)&&(_assertClassBrand$N(_CopyPaste_brand,this,_setClipboardData).call(this,s,h,f),this.hot.runHooks("afterCopy",h,this.copyableRanges,g)),_classPrivateFieldSet$z(_copyMode,this,"cells-only")}onCut(s){const c=s.composedPath()[0],u=this.hot.getFocusManager().getRefocusElement(),d=c?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!_classPrivateFieldGet$A(_isTriggeredByCut,this)||this.isEditorOpened()||isHTMLElement(c)&&(d&&c!==u||!d&&c!==this.hot.rootDocument.body&&!isInternalElement(c,this.hot.rootElement)))return;s.preventDefault(),this.setCopyableText(),_classPrivateFieldSet$z(_isTriggeredByCut,this,!1);const h=this.getRangedData(this.copyableRanges),f=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",h,this.copyableRanges)&&(_assertClassBrand$N(_CopyPaste_brand,this,_setClipboardData).call(this,s,h,f),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",h,this.copyableRanges))}onPaste(s){const c=s.composedPath()[0],u=this.hot.getFocusManager().getRefocusElement(),d=c?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||isHTMLElement(c)&&(d&&c!==u||!d&&c!==this.hot.rootDocument.body&&!isInternalElement(c,this.hot.rootElement)))return;s.preventDefault();let h,f;if(s&&typeof s.clipboardData<"u"){const w=s.clipboardData.getData(SOURCE_DATA_HTML_MIME_TYPE);w&&(f=htmlToGridSettings(w,this.hot.rootDocument).data);const E=sanitize(s.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});E&&/(<table)|(<TABLE)/g.test(E)?h=htmlToGridSettings(E,this.hot.rootDocument).data:h=s.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(h=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof h=="string"&&(h=parse(h)),h===void 0||h&&h.length===0||this.hot.runHooks("beforePaste",h,this.copyableRanges)===!1)return;const[g,m,p,v]=this.populateValues(h,f);g!==null&&m!==null&&this.hot.selectCell(g,m,Math.min(this.hot.countRows()-1,p),Math.min(this.hot.countCols()-1,v)),this.hot.runHooks("afterPaste",h,this.copyableRanges)}destroy(){super.destroy()}}function _ensureClipboardEventsGetTriggered(a){if(isSafari()){const s=this.hot.getSelectedRangeActive();if(s){const{row:c,col:u}=s.highlight,d=this.hot.getCell(c,u,!0);d&&runWithSelectedContendEditableElement(d,()=>{this.hot.rootDocument.execCommand(a)})}}else this.hot.rootDocument.execCommand(a)}function _countCopiedHeaders(a){const{rows:s}=normalizeRanges(a);let c=0;for(let u=0;u<s.length&&!(s[u]>=0);u++)c+=1;return{columnHeadersCount:c}}function _addContentEditableToHighlightedCell(){if(this.hot.isListening()){const a=this.hot.getSelectedRangeActive();if(a){const{row:s,col:c}=a.highlight,u=this.hot.getCell(s,c,!0);u&&makeElementContentEditableAndSelectItsContent(u)}}}function _removeContentEditableFromHighlightedCell(){if(this.hot.isListening()){const a=this.hot.getSelectedRangeActive();if(a){const{row:s,col:c}=a.highlight,u=this.hot.getCell(s,c,!0);u!=null&&u.hasAttribute("contenteditable")&&removeContentEditableFromElementAndDeselect(u)}}}function _setClipboardData(a,s,c){const u=stringify(s);if(a&&a.clipboardData){const d=_dataToHTML(s),h=_dataToHTML(c);a.clipboardData.setData("text/plain",u),a.clipboardData.setData("text/html",[META_HEAD,d].join("")),a.clipboardData.setData(SOURCE_DATA_HTML_MIME_TYPE,[META_HEAD,h].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",u)}function _onAfterContextMenuDefaultOptions$4(a){a.items.push({name:"---------"},copyItem(this)),_classPrivateFieldGet$A(_enableCopyColumnHeaders,this)&&a.items.push(copyWithColumnHeadersItem(this)),_classPrivateFieldGet$A(_enableCopyColumnGroupHeaders,this)&&a.items.push(copyWithColumnGroupHeadersItem(this)),_classPrivateFieldGet$A(_enableCopyColumnHeadersOnly,this)&&a.items.push(copyColumnHeadersOnlyItem(this)),a.items.push(cutItem(this))}function _onAfterSelection(a,s,c,u,d){_classPrivateFieldGet$A(_preventViewportScrollOnPaste,this)&&(d.value=!0),_classPrivateFieldSet$z(_preventViewportScrollOnPaste,this,!1)}function _onAfterSelectionEnd$1(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function _onSafariMouseEnter(){_assertClassBrand$N(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function _onSafariMouseLeave(){_assertClassBrand$N(_CopyPaste_brand,this,_addContentEditableToHighlightedCell).call(this)}function _onSafariAfterSelection(){_assertClassBrand$N(_CopyPaste_brand,this,_removeContentEditableFromHighlightedCell).call(this)}function createId(a,s){return`border_row${a}col${s}`}function createDefaultCustomBorder(){return{width:1,color:"#000"}}function createSingleEmptyBorder(){return{hide:!0}}function createDefaultHtBorder(){return{width:1,color:"#000",cornerVisible:!1}}function normalizeBorder(a){if(isDefined(a.start)||isDefined(a.left)){var s;a.start=(s=a.start)!==null&&s!==void 0?s:a.left}if(isDefined(a.end)||isDefined(a.right)){var c;a.end=(c=a.end)!==null&&c!==void 0?c:a.right}return delete a.left,delete a.right,a}function denormalizeBorder(a){return isDefined(a.start)&&(a.left=a.start),isDefined(a.end)&&(a.right=a.end),a}function createEmptyBorders(a,s){return{id:createId(a,s),border:createDefaultHtBorder(),row:a,col:s,top:createSingleEmptyBorder(),bottom:createSingleEmptyBorder(),start:createSingleEmptyBorder(),end:createSingleEmptyBorder()}}function extendDefaultBorder(a,s){return hasOwnProperty(s,"border")&&s.border&&(a.border=s.border),hasOwnProperty(s,"top")&&isDefined(s.top)&&(s.top?(isObject(s.top)||(s.top=createDefaultCustomBorder()),a.top=s.top):(s.top=createSingleEmptyBorder(),a.top=s.top)),hasOwnProperty(s,"bottom")&&isDefined(s.bottom)&&(s.bottom?(isObject(s.bottom)||(s.bottom=createDefaultCustomBorder()),a.bottom=s.bottom):(s.bottom=createSingleEmptyBorder(),a.bottom=s.bottom)),hasOwnProperty(s,"start")&&isDefined(s.start)&&(s.start?(isObject(s.start)||(s.start=createDefaultCustomBorder()),a.start=s.start):(s.start=createSingleEmptyBorder(),a.start=s.start)),hasOwnProperty(s,"end")&&isDefined(s.end)&&(s.end?(isObject(s.end)||(s.end=createDefaultCustomBorder()),a.end=s.end):(s.end=createSingleEmptyBorder(),a.end=s.end)),a}function checkSelectionBorders(a,s){let c=!1;return arrayEach(a.getSelectedRange(),u=>{u.forAll((d,h)=>{if(d<0||h<0)return;const f=a.getCellMeta(d,h).borders;if(f)if(s){if(!hasOwnProperty(f[s],"hide")||f[s].hide===!1)return c=!0,!1}else return c=!0,!1})}),c}function markSelected(a){return`<span class="selected">✓</span>${a}`}function hasLeftRightTypeOptions(a){return a.some(s=>isDefined(s.left)||isDefined(s.right))}function hasStartEndTypeOptions(a){return a.some(s=>isDefined(s.start)||isDefined(s.end))}const physicalToInlinePropNames=new Map([["left","start"],["right","end"]]);function toInlinePropName(a){var s;return(s=physicalToInlinePropNames.get(a))!==null&&s!==void 0?s:a}function bottom(a){return{key:"borders:bottom",name(){let s=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_BOTTOM);return checkSelectionBorders(this,"bottom")&&(s=markSelected(s)),s},callback(s,c){const u=checkSelectionBorders(this,"bottom");a.prepareBorder(c,"bottom",u)}}}function left(a){const s=a.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let c=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_LEFT);return checkSelectionBorders(this,s)&&(c=markSelected(c)),c},callback(c,u){const d=checkSelectionBorders(this,s);a.prepareBorder(u,s,d)}}}function noBorders(a){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_REMOVE_BORDERS)},callback(s,c){a.prepareBorder(c,"noBorders")},disabled(){return!checkSelectionBorders(this)}}}function right(a){const s=a.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let c=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_RIGHT);return checkSelectionBorders(this,s)&&(c=markSelected(c)),c},callback(c,u){const d=checkSelectionBorders(this,s);a.prepareBorder(u,s,d)}}}function top$1(a){return{key:"borders:top",name(){let s=this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS_TOP);return checkSelectionBorders(this,"top")&&(s=markSelected(s)),s},callback(s,c){const u=checkSelectionBorders(this,"top");a.prepareBorder(c,"top",u)}}}function _classPrivateMethodInitSpec$B(a,s){_checkPrivateRedeclaration$M(a,s),s.add(a)}function _checkPrivateRedeclaration$M(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$T(a,s,c){return(s=_toPropertyKey$T(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$T(a){var s=_toPrimitive$T(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$T(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$M(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$r="customBorders",PLUGIN_PRIORITY$r=90,SUPPORTED_STYLES=["dashed","dotted","solid"];var _CustomBorders_brand=new WeakSet;class CustomBorders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$B(this,_CustomBorders_brand),_defineProperty$T(this,"savedBorders",[])}static get PLUGIN_KEY(){return PLUGIN_KEY$r}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$r}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$r]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",s=>_assertClassBrand$M(_CustomBorders_brand,this,_onAfterContextMenuDefaultOptions$3).call(this,s)),this.addHook("init",()=>_assertClassBrand$M(_CustomBorders_brand,this,_onAfterInit$3).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(s,c){let u=["top","bottom","start","end"],d=null;c&&(this.checkSettingsCohesion([c]),u=Object.keys(c),d=normalizeBorder(c));const h=detectSelectionType(s),f=normalizeSelectionFactory(h,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});arrayEach(s,g=>{f(g).forAll((m,p)=>{arrayEach(u,v=>{this.prepareBorderFromCustomAdded(m,p,d,toInlinePropName(v))})})}),this.hot.view.render()}getBorders(s){if(!Array.isArray(s))return this.savedBorders;const c=detectSelectionType(s),u=normalizeSelectionFactory(c,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),d=[];return arrayEach(s,h=>{u(h).forAll((f,g)=>{arrayEach(this.savedBorders,m=>{m.row===f&&m.col===g&&d.push(denormalizeBorder(m))})})}),d}clearBorders(s){s?this.setBorders(s):(arrayEach(this.savedBorders,c=>{this.clearBordersFromSelectionSettings(c.id),this.clearNullCellRange(),this.hot.removeCellMeta(c.row,c.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(s,c){this.checkSavedBorders(s)||this.savedBorders.push(s);const d=this.hot._createCellRange(this.hot._createCellCoords(s.row,s.col));this.checkCustomSelections(s,d,c)||this.hot.selection.highlight.addCustomSelection({border:s,visualCellRange:d})}prepareBorderFromCustomAdded(s,c,u,d){const h=this.hot.countRows(),f=this.hot.countCols();if(s>=h||c>=f)return;let g=createEmptyBorders(s,c);u&&(g=extendDefaultBorder(g,u),arrayEach(this.hot.selection.highlight.customSelections,m=>{if(g.id===m.settings.id)return Object.assign(m.settings,u),g.id=m.settings.id,g.top=m.settings.top,g.bottom=m.settings.bottom,g.start=m.settings.start,g.end=m.settings.end,!1})),this.hot.setCellMeta(s,c,"borders",denormalizeBorder(g)),this.insertBorderIntoSettings(g,d)}prepareBorderFromCustomAddedRange(s,c){const u=Math.min(s.to.row,this.hot.countRows()-1),d=Math.min(s.to.col,this.hot.countCols()-1);rangeEach(s.from.row,u,h=>{rangeEach(s.from.col,d,f=>{const g=createEmptyBorders(h,f);let m=0;h===s.from.row&&hasOwnProperty(c,"top")&&(m+=1,g.top=c.top),h===s.to.row&&hasOwnProperty(c,"bottom")&&(m+=1,g.bottom=c.bottom),f===s.from.col&&hasOwnProperty(c,"start")&&(m+=1,g.start=c.start),f===s.to.col&&hasOwnProperty(c,"end")&&(m+=1,g.end=c.end),m>0&&(this.hot.setCellMeta(h,f,"borders",denormalizeBorder(g)),this.insertBorderIntoSettings(g))})})}removeAllBorders(s,c){const u=createId(s,c);this.spliceBorder(u),this.clearBordersFromSelectionSettings(u),this.clearNullCellRange(),this.hot.removeCellMeta(s,c,"borders")}setBorder(s,c,u,d){let h=this.hot.getCellMeta(s,c).borders;!h||h.border===void 0?h=createEmptyBorders(s,c):h=normalizeBorder(h),d?(h[u]=createSingleEmptyBorder(),this.countHide(h)===4?this.removeAllBorders(s,c):(this.checkCustomSelectionsFromContextMenu(h,u,d)||this.insertBorderIntoSettings(h),this.hot.setCellMeta(s,c,"borders",denormalizeBorder(h)))):(h[u]=createDefaultCustomBorder(),this.checkCustomSelectionsFromContextMenu(h,u,d)||this.insertBorderIntoSettings(h),this.hot.setCellMeta(s,c,"borders",denormalizeBorder(h)))}prepareBorder(s,c,u){arrayEach(s,d=>{let{start:h,end:f}=d;if(h.row===f.row&&h.col===f.col)c==="noBorders"?this.removeAllBorders(h.row,h.col):this.setBorder(h.row,h.col,c,u);else switch(c){case"noBorders":rangeEach(h.col,f.col,g=>{rangeEach(h.row,f.row,m=>{this.removeAllBorders(m,g)})});break;case"top":rangeEach(h.col,f.col,g=>{this.setBorder(h.row,g,c,u)});break;case"bottom":rangeEach(h.col,f.col,g=>{this.setBorder(f.row,g,c,u)});break;case"start":rangeEach(h.row,f.row,g=>{this.setBorder(g,h.col,c,u)});break;case"end":rangeEach(h.row,f.row,g=>{this.setBorder(g,f.col,c,u)});break}})}createCustomBorders(s){arrayEach(s,c=>{const u=normalizeBorder(c);c.range?this.prepareBorderFromCustomAddedRange(c.range,u):this.prepareBorderFromCustomAdded(c.row,c.col,u)})}countHide(s){const{top:c,bottom:u,start:d,end:h}=s;return arrayReduce([c,u,d,h],(g,m)=>{let p=g;return m&&m.hide&&(p+=1),p},0)}clearBordersFromSelectionSettings(s){const c=arrayMap(this.hot.selection.highlight.customSelections,u=>u.settings.id).indexOf(s);c>-1&&this.hot.selection.highlight.customSelections[c].clear()}clearNullCellRange(){arrayEach(this.hot.selection.highlight.customSelections,(s,c)=>{if(s.cellRange===null)return this.hot.selection.highlight.customSelections[c].destroy(),this.hot.selection.highlight.customSelections.splice(c,1),!1})}hideBorders(){arrayEach(this.savedBorders,s=>{this.clearBordersFromSelectionSettings(s.id),this.clearNullCellRange()})}spliceBorder(s){const c=arrayMap(this.savedBorders,u=>u.id).indexOf(s);c>-1&&this.savedBorders.splice(c,1)}checkSavedBorders(s){let c=!1;return this.countHide(s)===4?(this.spliceBorder(s.id),c=!0):arrayEach(this.savedBorders,(d,h)=>{if(s.id===d.id)return this.savedBorders[h]=s,c=!0,!1}),c}checkCustomSelectionsFromContextMenu(s,c,u){let d=!1;return arrayEach(this.hot.selection.highlight.customSelections,h=>{if(s.id===h.settings.id){const f=this.hot.view._wt.selectionManager.getBorderInstances(h);return arrayEach(f,g=>{g.toggleHiddenClass(c,u)}),d=!0,!1}}),d}checkCustomSelections(s,c,u){const d=this.countHide(s);let h=!1;return d===4?(this.removeAllBorders(s.row,s.col),h=!0):arrayEach(this.hot.selection.highlight.customSelections,f=>{if(s.id===f.settings.id){if(f.visualCellRange=c,f.commit(),u){const g=this.hot.view._wt.selectionManager.getBorderInstances(f);arrayEach(g,m=>{m.changeBorderStyle(u,s)})}return h=!0,!1}}),h}changeBorderSettings(){const s=this.hot.getSettings()[PLUGIN_KEY$r];if(Array.isArray(s)){const c=deepClone(s);this.checkSettingsCohesion(c),c.length||(this.savedBorders=c),this.createCustomBorders(c)}else s!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(s){const c=hasLeftRightTypeOptions(s),u=hasStartEndTypeOptions(s);if(c&&u)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&c)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".');_assertClassBrand$M(_CustomBorders_brand,this,_validateStyleSettings).call(this,s)}destroy(){super.destroy()}}function _validateStyleSettings(a){a.forEach(s=>{Object.keys(s).forEach(c=>{const u=s[c].style;isDefined(u)&&!SUPPORTED_STYLES.includes(u)?(warn$1(`The "${u}" border style is not supported. Please use one of the following styles: ${SUPPORTED_STYLES.join(", ")}.
The border style will be ignored.`),delete s[c].style):isDefined(u)&&u==="solid"&&delete s[c].style})})}function _onAfterContextMenuDefaultOptions$3(a){this.hot.getSettings()[PLUGIN_KEY$r]&&a.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_BORDERS)},disabled(){const s=this.getSelectedRangeActive();return!s||s.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[top$1(this),right(this),bottom(this),left(this),noBorders(this)]}})}function _onAfterInit$3(){this.changeBorderSettings()}function _classPrivateMethodInitSpec$A(a,s){_checkPrivateRedeclaration$L(a,s),s.add(a)}function _checkPrivateRedeclaration$L(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$S(a,s,c){return(s=_toPropertyKey$S(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$S(a){var s=_toPrimitive$S(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$S(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$L(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$q="dragToScroll",PLUGIN_PRIORITY$q=100;var _DragToScroll_brand=new WeakSet;class DragToScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$A(this,_DragToScroll_brand),_defineProperty$S(this,"boundaries",null),_defineProperty$S(this,"callback",null),_defineProperty$S(this,"listening",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$q}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$q}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$q]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",s=>_assertClassBrand$L(_DragToScroll_brand,this,_setupListening).call(this,s)),this.addHook("afterOnCellCornerMouseDown",s=>_assertClassBrand$L(_DragToScroll_brand,this,_setupListening).call(this,s)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=s}setCallback(s){this.callback=s}check(s,c){let u=0,d=0;c<this.boundaries.top?d=c-this.boundaries.top:c>this.boundaries.bottom&&(d=c-this.boundaries.bottom),s<this.boundaries.left?u=s-this.boundaries.left:s>this.boundaries.right&&(u=s-this.boundaries.right),this.callback(u,d)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:s}=this.hot;let c=s;for(;c;)this.eventManager.addEventListener(c.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(c.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(c.document,"mousemove",u=>this.onMouseMove(u)),c=getParentWindow(c)}unregisterEvents(){this.eventManager.clear()}onMouseMove(s){this.isListening()&&this.check(s.clientX,s.clientY)}destroy(){super.destroy()}}function _setupListening(a){if(isRightClick(a))return;const s=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(s!==this.hot.rootWindow?s.getBoundingClientRect():void 0),this.setCallback((c,u)=>{var d,h;const f=(d=s.scrollLeft)!==null&&d!==void 0?d:s.scrollX,g=(h=s.scrollTop)!==null&&h!==void 0?h:s.scrollY;s.scroll(f+Math.sign(c)*50,g+Math.sign(u)*20)}),this.listen()}function _classPrivateMethodInitSpec$z(a,s){_checkPrivateRedeclaration$K(a,s),s.add(a)}function _classPrivateFieldInitSpec$z(a,s,c){_checkPrivateRedeclaration$K(a,s),s.set(a,c)}function _checkPrivateRedeclaration$K(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$R(a,s,c){return(s=_toPropertyKey$R(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$R(a){var s=_toPrimitive$R(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$R(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$z(a,s){return a.get(_assertClassBrand$K(a,s))}function _classPrivateFieldSet$y(a,s,c){return a.set(_assertClassBrand$K(a,s),c),c}function _assertClassBrand$K(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("afterDropdownMenuDefaultOptions"),Hooks.getSingleton().register("beforeDropdownMenuShow"),Hooks.getSingleton().register("afterDropdownMenuShow"),Hooks.getSingleton().register("afterDropdownMenuHide"),Hooks.getSingleton().register("afterDropdownMenuExecute");const PLUGIN_KEY$p="dropdownMenu",PLUGIN_PRIORITY$p=230,BUTTON_CLASS_NAME="changeType",SHORTCUTS_GROUP$7=PLUGIN_KEY$p;var _isButtonClicked=new WeakMap,_DropdownMenu_brand=new WeakSet;class DropdownMenu extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$p}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$p}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[KEY$9,KEY$8,KEY$c,KEY$5,KEY$c,KEY$a,KEY$c,KEY$7,KEY$c,KEY$b]}constructor(s){super(s),_classPrivateMethodInitSpec$z(this,_DropdownMenu_brand),_defineProperty$R(this,"commandExecutor",new CommandExecutor(this.hot)),_defineProperty$R(this,"itemsFactory",null),_defineProperty$R(this,"menu",null),_classPrivateFieldInitSpec$z(this,_isButtonClicked,!1),this.hot.addHook("afterGetColHeader",(c,u)=>_assertClassBrand$K(_DropdownMenu_brand,this,_onAfterGetColHeader$2).call(this,c,u))}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$p]}enablePlugin(){var s=this;if(this.enabled)return;this.itemsFactory=new ItemsFactory(this.hot,DropdownMenu.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$K(_DropdownMenu_brand,s,_onBeforeOnCellMouseDown$4).call(s,...h)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$K(_DropdownMenu_brand,s,_onBeforeViewportScrollHorizontally$1).call(s,...h)}),this.addHook("beforeDialogShow",()=>this.close());const c=this.hot.getSettings()[PLUGIN_KEY$p],u={items:this.itemsFactory.getItems(c)};this.registerEvents(),typeof c.callback=="function"&&this.commandExecutor.setCommonCallback(c.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",u),this.itemsFactory.setPredefinedItems(u.items);const d=this.itemsFactory.getItems(c);this.menu&&this.menu.destroy(),this.menu=new Menu(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:c.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",d),this.menu.setMenuItems(d),this.menu.addLocalHook("beforeOpen",()=>_assertClassBrand$K(_DropdownMenu_brand,this,_onMenuBeforeOpen).call(this)),this.menu.addLocalHook("afterOpen",()=>_assertClassBrand$K(_DropdownMenu_brand,this,_onMenuAfterOpen).call(this)),this.menu.addLocalHook("afterSubmenuOpen",h=>_assertClassBrand$K(_DropdownMenu_brand,this,_onSubMenuAfterOpen).call(this,h)),this.menu.addLocalHook("afterClose",()=>_assertClassBrand$K(_DropdownMenu_brand,this,_onMenuAfterClose).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return s.executeCommand.call(s,...f)}),arrayEach(d,h=>this.commandExecutor.registerCommand(h.key,h))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const s=this.hot.getShortcutManager().getContext("grid"),c=()=>{const{highlight:u}=this.hot.getSelectedRangeActive();if((u.isHeader()&&u.row===-1||u.isCell())&&u.col>=0){this.hot.selectColumns(u.col,u.col,-1);const{from:d}=this.hot.getSelectedRangeActive(),h=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),f=this.hot.getCell(-1,d.col,!0).querySelector(`.${BUTTON_CLASS_NAME}`),g=f.getBoundingClientRect();this.open({left:g.left+h.left,top:g.top+f.offsetHeight+h.top},{left:g.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};s.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:c,runOnlyIf:()=>{var u;const d=(u=this.hot.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight;return d&&this.hot.selection.isCellVisible(d)&&d.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:SHORTCUTS_GROUP$7},{keys:[["Shift","Alt","ArrowDown"]],callback:c,runOnlyIf:()=>{var u;const d=(u=this.hot.getSelectedRangeActive())===null||u===void 0?void 0:u.highlight;return d&&this.hot.selection.isCellVisible(d)&&d.isCell()&&!this.menu.isOpened()},group:SHORTCUTS_GROUP$7}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$7)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",s=>_assertClassBrand$K(_DropdownMenu_brand,this,_onTableClick).call(this,s))}open(s){var c;let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(c=this.menu)!==null&&c!==void 0&&c.isOpened()||(this.menu.open(),objectEach(u,(d,h)=>{this.menu.setOffset(h,d)}),this.menu.setPosition(s))}close(){var s;(s=this.menu)===null||s===void 0||s.close()}executeCommand(s){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];this.commandExecutor.execute(s,...u)}setListening(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(s?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function _addCustomShortcuts(a){a.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function _onTableClick(a){if(hasClass$1(a.target,BUTTON_CLASS_NAME)){const s=getDocumentOffsetByElement(this.menu.container,this.hot.rootDocument),c=a.target.getBoundingClientRect();a.stopPropagation(),_classPrivateFieldSet$y(_isButtonClicked,this,!1),this.open({left:c.left+s.left,top:c.top+a.target.offsetHeight+s.top},{left:c.width,right:0,above:0,below:3})}}function _onAfterGetColHeader$2(a,s){const c=s.parentNode;if(!c)return;const u=c.parentNode.childNodes,d=Array.prototype.indexOf.call(u,c);if(a<0||d!==u.length-1)return;const h=s.querySelector(`.${BUTTON_CLASS_NAME}`);if(this.enabled&&h)return;if(!this.enabled){h&&h.parentNode.removeChild(h);return}const f=this.hot.rootDocument.createElement("button");f.className=BUTTON_CLASS_NAME,f.type="button",f.tabIndex=-1,this.hot.getSettings().ariaTags&&(setAttribute(f,[A11Y_HIDDEN(),A11Y_LABEL(" ")]),setAttribute(s,[A11Y_HASPOPUP("menu")])),f.onclick=function(){return!1},s.firstChild.insertBefore(f,s.firstChild.firstChild)}function _onMenuBeforeOpen(){this.hot.runHooks("beforeDropdownMenuShow",this)}function _onMenuAfterOpen(){this.hot.runHooks("afterDropdownMenuShow",this),_assertClassBrand$K(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,this.menu)}function _onSubMenuAfterOpen(a){_assertClassBrand$K(_DropdownMenu_brand,this,_addCustomShortcuts).call(this,a)}function _onMenuAfterClose(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function _onBeforeViewportScrollHorizontally$1(a){return _classPrivateFieldGet$z(_isButtonClicked,this)?null:a}function _onBeforeOnCellMouseDown$4(a){hasClass$1(a.target,BUTTON_CLASS_NAME)&&_classPrivateFieldSet$y(_isButtonClicked,this,!0)}DropdownMenu.SEPARATOR={name:KEY$c};function _defineProperty$Q(a,s,c){return(s=_toPropertyKey$Q(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$Q(a){var s=_toPrimitive$Q(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$Q(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DataProvider{constructor(s){_defineProperty$Q(this,"hot",void 0),_defineProperty$Q(this,"options",{}),this.hot=s}setOptions(s){this.options=s}getData(){const{startRow:s,startCol:c,endRow:u,endCol:d}=this._getDataRange(),h=this.options,f=[];return rangeEach(s,u,g=>{const m=[];!h.exportHiddenRows&&this._isHiddenRow(g)||(rangeEach(c,d,p=>{!h.exportHiddenColumns&&this._isHiddenColumn(p)||m.push(this.hot.getDataAtCell(g,p))}),f.push(m))}),f}getRowHeaders(){const s=[];if(this.options.rowHeaders){const{startRow:c,endRow:u}=this._getDataRange(),d=this.hot.getRowHeader();rangeEach(c,u,h=>{!this.options.exportHiddenRows&&this._isHiddenRow(h)||s.push(d[h])})}return s}getColumnHeaders(){const s=[];if(this.options.columnHeaders){const{startCol:c,endCol:u}=this._getDataRange(),d=this.hot.getColHeader();rangeEach(c,u,h=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(h)||s.push(d[h])})}return s}_getDataRange(){const s=this.hot.countCols()-1,c=this.hot.countRows()-1;let[u=0,d=0,h=c,f=s]=this.options.range;return u=Math.max(u,0),d=Math.max(d,0),h=Math.min(h,c),f=Math.min(f,s),{startRow:u,startCol:d,endRow:h,endCol:f}}_isHiddenRow(s){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(s))}_isHiddenColumn(s){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(s))}}function _defineProperty$P(a,s,c){return(s=_toPropertyKey$P(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$P(a){var s=_toPrimitive$P(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$P(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class BaseType{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(s,c){_defineProperty$P(this,"dataProvider",void 0),_defineProperty$P(this,"options",void 0),this.dataProvider=s,this.options=this._mergeOptions(c),this.dataProvider.setOptions(this.options)}_mergeOptions(s){let c=clone(this.constructor.DEFAULT_OPTIONS);const u=new Date;return c=extend$1(clone(BaseType.DEFAULT_OPTIONS),c),c=extend$1(c,s),c.filename=substitute(c.filename,{YYYY:u.getFullYear(),MM:`${u.getMonth()+1}`.padStart(2,"0"),DD:`${u.getDate()}`.padStart(2,"0")}),c}}function _classPrivateMethodInitSpec$y(a,s){_checkPrivateRedeclaration$J(a,s),s.add(a)}function _checkPrivateRedeclaration$J(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _assertClassBrand$J(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const CHAR_CARRIAGE_RETURN="\r",CHAR_DOUBLE_QUOTES='"',CHAR_LINE_FEED=`
`,CHAR_EQUAL="=",CHAR_PLUS="+",CHAR_MINUS="-",CHAR_AT="@",CHAR_TAB="	";var _Csv_brand=new WeakSet;class Csv extends BaseType{constructor(){super(...arguments),_classPrivateMethodInitSpec$y(this,_Csv_brand)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const s=this.options,c=this.dataProvider.getData();let u=this.dataProvider.getColumnHeaders();const d=u.length>0,h=this.dataProvider.getRowHeaders(),f=h.length>0;let g=s.bom?"\uFEFF":"";return d&&(u=arrayMap(u,m=>this._escapeCell(m,{force:!0,sanitizeValue:s.sanitizeValues})),f&&(g+=s.columnDelimiter),g+=u.join(s.columnDelimiter),g+=s.rowDelimiter),arrayEach(c,(m,p)=>{p>0&&(g+=s.rowDelimiter),f&&(g+=this._escapeCell(h[p],{sanitizeValue:s.sanitizeValues}),g+=s.columnDelimiter);const v=m.map(w=>this._escapeCell(w,{sanitizeValue:s.sanitizeValues})).join(s.columnDelimiter);g+=v}),g}_escapeCell(s){let{force:c=!1,sanitizeValue:u=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},d=stringify$1(s);return d===""||(u&&(c=!0),u instanceof RegExp?d=_assertClassBrand$J(_Csv_brand,this,_sanitizeValueWithRegExp).call(this,d,u):typeof u=="function"?d=u(d):u&&(d=_assertClassBrand$J(_Csv_brand,this,_sanitizeValueWithOWASP).call(this,d)),(c||d.indexOf(CHAR_CARRIAGE_RETURN)>=0||d.indexOf(CHAR_DOUBLE_QUOTES)>=0||d.indexOf(CHAR_LINE_FEED)>=0||d.indexOf(this.options.columnDelimiter)>=0)&&(d=d.replace(new RegExp('"',"g"),'""'),d=`"${d}"`)),d}}function _sanitizeValueWithOWASP(a){return a.startsWith(CHAR_EQUAL)||a.startsWith(CHAR_PLUS)||a.startsWith(CHAR_MINUS)||a.startsWith(CHAR_AT)||a.startsWith(CHAR_TAB)||a.startsWith(CHAR_CARRIAGE_RETURN)?`'${a}`:a}function _sanitizeValueWithRegExp(a,s){return s.test(a)?`'${a}`:a}const TYPE_CSV="csv",EXPORT_TYPES={[TYPE_CSV]:Csv};function typeFactory(a,s,c){return typeof EXPORT_TYPES[a]=="function"?new EXPORT_TYPES[a](s,c):null}const PLUGIN_KEY$o="exportFile",PLUGIN_PRIORITY$o=240;class ExportFile extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$o}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$o}isEnabled(){return!0}exportAsString(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(s,c).export()}exportAsBlob(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(s,c))}downloadFile(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:u,rootWindow:d}=this.hot,h=this._createTypeFormatter(s,c),f=this._createBlob(h),g=d.URL||d.webkitURL,m=u.createElement("a"),p=`${h.options.filename}.${h.options.fileExtension}`;if(m.download!==void 0){const v=g.createObjectURL(f);m.style.display="none",m.setAttribute("href",v),m.setAttribute("download",p),u.body.appendChild(m),m.dispatchEvent(new MouseEvent("click")),u.body.removeChild(m),setTimeout(()=>{g.revokeObjectURL(v)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(f,p)}_createTypeFormatter(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!EXPORT_TYPES[s])throw new Error(`Export format type "${s}" is not supported.`);return typeFactory(s,new DataProvider(this.hot),c)}_createBlob(s){let c=null;return typeof Blob<"u"&&(c=new Blob([s.export()],{type:`${s.options.mimeType};charset=${s.options.encoding}`})),c}}function _defineProperty$O(a,s,c){return(s=_toPropertyKey$O(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$O(a){var s=_toPrimitive$O(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$O(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class BaseComponent{constructor(s,c){let{id:u,stateless:d=!0}=c;_defineProperty$O(this,"hot",void 0),_defineProperty$O(this,"id",void 0),_defineProperty$O(this,"elements",[]),_defineProperty$O(this,"hidden",!1),_defineProperty$O(this,"stateId",""),_defineProperty$O(this,"state",void 0),this.hot=s,this.id=u,this.stateId=`Filters.component.${this.id}`,this.state=d?null:this.hot.columnIndexMapper.registerMap(this.stateId,new LinkedPhysicalIndexToValueMap)}getElements(){return this.elements}reset(){arrayEach(this.elements,s=>s.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(s){this.state&&this.setState(this.state.getValueAtIndex(s))}setState(){throw new Error("The state setting logic is not implemented")}saveState(s){this.state&&this.state.setValueAtIndex(s,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),arrayEach(this.elements,s=>s.destroy()),this.state=null,this.elements=null,this.hot=null}}mixin(BaseComponent,localHooks);const conditions={};function getCondition(a,s){if(!conditions[a])throw Error(`Filter condition "${a}" does not exist.`);const{condition:c,descriptor:u}=conditions[a];let d=s;return u.inputValuesDecorator&&(d=u.inputValuesDecorator(d)),function(h){return c.apply(h.meta.instance,[].concat([h],[d]))}}function getConditionDescriptor(a){if(!conditions[a])throw Error(`Filter condition "${a}" does not exist.`);return conditions[a].descriptor}function registerCondition(a,s,c){c.key=a,conditions[a]={condition:s,descriptor:c}}const CONDITION_NAME$k="none";function condition$k(){return!0}registerCondition(CONDITION_NAME$k,condition$k,{name:FILTERS_CONDITIONS_NONE,inputsCount:0,showOperators:!1});const CONDITION_NAME$j="empty";function condition$j(a){return isEmpty(a.value)}registerCondition(CONDITION_NAME$j,condition$j,{name:FILTERS_CONDITIONS_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$i="not_empty";function condition$i(a,s){return!getCondition(CONDITION_NAME$j,s)(a)}registerCondition(CONDITION_NAME$i,condition$i,{name:FILTERS_CONDITIONS_NOT_EMPTY,inputsCount:0,showOperators:!0});const CONDITION_NAME$h="eq";function condition$h(a,s){let[c]=s;return stringify$1(a.value).toLocaleLowerCase(a.meta.locale)===stringify$1(c)}registerCondition(CONDITION_NAME$h,condition$h,{name:FILTERS_CONDITIONS_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$g="neq";function condition$g(a,s){return!getCondition(CONDITION_NAME$h,s)(a)}registerCondition(CONDITION_NAME$g,condition$g,{name:FILTERS_CONDITIONS_NOT_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$f="gt";function condition$f(a,s){let[c]=s,u=c;return a.meta.type==="numeric"&&(u=parseFloat(u,10)),a.value>u}registerCondition(CONDITION_NAME$f,condition$f,{name:FILTERS_CONDITIONS_GREATER_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$e="gte";function condition$e(a,s){let[c]=s,u=c;return a.meta.type==="numeric"&&(u=parseFloat(u,10)),a.value>=u}registerCondition(CONDITION_NAME$e,condition$e,{name:FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$d="lt";function condition$d(a,s){let[c]=s,u=c;return a.meta.type==="numeric"&&(u=parseFloat(u,10)),a.value<u}registerCondition(CONDITION_NAME$d,condition$d,{name:FILTERS_CONDITIONS_LESS_THAN,inputsCount:1,showOperators:!0});const CONDITION_NAME$c="lte";function condition$c(a,s){let[c]=s,u=c;return a.meta.type==="numeric"&&(u=parseFloat(u,10)),a.value<=u}registerCondition(CONDITION_NAME$c,condition$c,{name:FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL,inputsCount:1,showOperators:!0});const CONDITION_NAME$b="date_after";function condition$b(a,s){let[c]=s;const u=hooks(a.value,a.meta.dateFormat),d=hooks(c,a.meta.dateFormat);return!u.isValid()||!d.isValid()?!1:u.diff(d)>=0}registerCondition(CONDITION_NAME$b,condition$b,{name:FILTERS_CONDITIONS_AFTER,inputsCount:1,showOperators:!0});const CONDITION_NAME$a="date_before";function condition$a(a,s){let[c]=s;const u=hooks(a.value,a.meta.dateFormat),d=hooks(c,a.meta.dateFormat);return!u.isValid()||!d.isValid()?!1:u.diff(d)<=0}registerCondition(CONDITION_NAME$a,condition$a,{name:FILTERS_CONDITIONS_BEFORE,inputsCount:1,showOperators:!0});const CONDITION_NAME$9="between";function condition$9(a,s){let[c,u]=s,d=c,h=u;if(a.meta.type==="numeric"){const f=parseFloat(d,10),g=parseFloat(h,10);d=Math.min(f,g),h=Math.max(f,g)}else if(a.meta.type==="date"){const f=getCondition(CONDITION_NAME$a,[h]),g=getCondition(CONDITION_NAME$b,[d]);return f(a)&&g(a)}return a.value>=d&&a.value<=h}registerCondition(CONDITION_NAME$9,condition$9,{name:FILTERS_CONDITIONS_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$8="not_between";function condition$8(a,s){return!getCondition(CONDITION_NAME$9,s)(a)}registerCondition(CONDITION_NAME$8,condition$8,{name:FILTERS_CONDITIONS_NOT_BETWEEN,inputsCount:2,showOperators:!0});const CONDITION_NAME$7="begins_with";function condition$7(a,s){let[c]=s;return stringify$1(a.value).toLocaleLowerCase(a.meta.locale).startsWith(stringify$1(c))}registerCondition(CONDITION_NAME$7,condition$7,{name:FILTERS_CONDITIONS_BEGINS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$6="ends_with";function condition$6(a,s){let[c]=s;return stringify$1(a.value).toLocaleLowerCase(a.meta.locale).endsWith(stringify$1(c))}registerCondition(CONDITION_NAME$6,condition$6,{name:FILTERS_CONDITIONS_ENDS_WITH,inputsCount:1,showOperators:!0});const CONDITION_NAME$5="contains";function condition$5(a,s){let[c]=s;return stringify$1(a.value).toLocaleLowerCase(a.meta.locale).indexOf(stringify$1(c))>=0}registerCondition(CONDITION_NAME$5,condition$5,{name:FILTERS_CONDITIONS_CONTAINS,inputsCount:1,showOperators:!0});const CONDITION_NAME$4="not_contains";function condition$4(a,s){return!getCondition(CONDITION_NAME$5,s)(a)}registerCondition(CONDITION_NAME$4,condition$4,{name:FILTERS_CONDITIONS_NOT_CONTAIN,inputsCount:1,showOperators:!0});const CONDITION_NAME$3="date_tomorrow";function condition$3(a){const s=hooks(a.value,a.meta.dateFormat);return s.isValid()?s.isSame(hooks().subtract(-1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$3,condition$3,{name:FILTERS_CONDITIONS_TOMORROW,inputsCount:0});const CONDITION_NAME$2="date_today";function condition$2(a){const s=hooks(a.value,a.meta.dateFormat);return s.isValid()?s.isSame(hooks().startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$2,condition$2,{name:FILTERS_CONDITIONS_TODAY,inputsCount:0});const CONDITION_NAME$1="date_yesterday";function condition$1(a){const s=hooks(a.value,a.meta.dateFormat);return s.isValid()?s.isSame(hooks().subtract(1,"days").startOf("day"),"d"):!1}registerCondition(CONDITION_NAME$1,condition$1,{name:FILTERS_CONDITIONS_YESTERDAY,inputsCount:0}),getComparisonFunction();function toVisualValue(a,s){let c=a;return c===""&&(c=`(${s})`),c}function createArrayAssertion(a){const s=new Set(a);return function(c){return s.has(c)}}function toEmptyString(a){return a??""}function unifyColumnValues(a){return Array.from(new Set(a)).map(s=>toEmptyString(s)).sort((s,c)=>typeof s=="number"&&typeof c=="number"?s-c:s===c?0:s>c?1:-1)}function intersectValues(a,s,c,u){const d=[],h=a===s;let f;return h||(f=createArrayAssertion(s)),a.forEach(g=>{let m=!1;(h||f(g))&&(m=!0);const p={checked:m,value:g,visualValue:toVisualValue(g,c)};u&&u(p),d.push(p)}),d}const CONDITION_NAME="by_value";function condition(a,s){let[c]=s;return c(a.value)}registerCondition(CONDITION_NAME,condition,{name:"By value",inputsCount:0,inputValuesDecorator(a){let[s]=a;return[createArrayAssertion(s)]},showOperators:!1});const operations={};function getOperationFunc(a){if(!operations[a])throw Error(`Operation with id "${a}" does not exist.`);const s=operations[a].func;return function(c,u){return s(c,u)}}function getOperationName(a){return operations[a].name}function registerOperation(a,s,c){operations[a]={name:s,func:c}}const OPERATION_ID$2="conjunction",SHORT_NAME_FOR_COMPONENT$2=FILTERS_LABELS_CONJUNCTION;function operationResult$2(a,s){return a.every(c=>c.func(s))}registerOperation(OPERATION_ID$2,SHORT_NAME_FOR_COMPONENT$2,operationResult$2);const OPERATION_ID$1="disjunction",SHORT_NAME_FOR_COMPONENT$1=FILTERS_LABELS_DISJUNCTION;function operationResult$1(a,s){return a.some(c=>c.func(s))}registerOperation(OPERATION_ID$1,SHORT_NAME_FOR_COMPONENT$1,operationResult$1);const OPERATION_ID="disjunctionWithExtraCondition",SHORT_NAME_FOR_COMPONENT=FILTERS_LABELS_DISJUNCTION;function operationResult(a,s){if(a.length<3)throw Error("Operation doesn't work on less then three conditions.");return a.slice(0,a.length-1).some(c=>c.func(s))&&a[a.length-1].func(s)}registerOperation(OPERATION_ID,SHORT_NAME_FOR_COMPONENT,operationResult);const TYPE_NUMERIC="numeric",TYPE_TEXT="text",TYPE_DATE="date",TYPES={[TYPE_NUMERIC]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$f,CONDITION_NAME$e,CONDITION_NAME$d,CONDITION_NAME$c,CONDITION_NAME$9,CONDITION_NAME$8],[TYPE_TEXT]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$7,CONDITION_NAME$6,KEY$c,CONDITION_NAME$5,CONDITION_NAME$4],[TYPE_DATE]:[CONDITION_NAME$k,KEY$c,CONDITION_NAME$j,CONDITION_NAME$i,KEY$c,CONDITION_NAME$h,CONDITION_NAME$g,KEY$c,CONDITION_NAME$a,CONDITION_NAME$b,CONDITION_NAME$9,KEY$c,CONDITION_NAME$3,CONDITION_NAME$2,CONDITION_NAME$1]};function getOptionsList(a){const s=[];let c=a;return TYPES[c]||(c=TYPE_TEXT),arrayEach(TYPES[c],u=>{let d;u===KEY$c?d={name:KEY$c}:d=clone(getConditionDescriptor(u)),s.push(d)}),s}function _defineProperty$N(a,s,c){return(s=_toPropertyKey$N(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$N(a){var s=_toPrimitive$N(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$N(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const STATE_BUILT$2="built",STATE_BUILDING="building",EVENTS_TO_REGISTER=["click","input","keydown","keypress","keyup","focus","blur","change"];let BaseUI$3=class wr{static get DEFAULTS(){return clone({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(s,c){_defineProperty$N(this,"hot",void 0),_defineProperty$N(this,"eventManager",new EventManager(this)),_defineProperty$N(this,"options",void 0),_defineProperty$N(this,"_element",void 0),_defineProperty$N(this,"buildState",void 0),this.hot=s,this.options=extend$1(wr.DEFAULTS,c),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(s){this.options.value=s,this.update()}getValue(){return this.options.value}get element(){return this.buildState===STATE_BUILDING?this._element:this.buildState===STATE_BUILT$2?(this.update(),this._element):(this.buildState=STATE_BUILDING,this.build(),this.buildState=STATE_BUILT$2,this._element)}isBuilt(){return this.buildState===STATE_BUILT$2}translateIfPossible(s){return typeof s=="string"&&s.startsWith(FILTERS_NAMESPACE)?this.hot.getTranslatedPhrase(s):s}build(){const s=(c,u)=>{this.eventManager.addEventListener(c,u,d=>this.runLocalHooks(u,d,this))};if(this.buildState||(this.buildState=STATE_BUILDING),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&addClass$1(this._element,this.options.className),this.options.children.length)arrayEach(this.options.children,c=>this._element.appendChild(c.element));else if(this.options.wrapIt){const c=this.hot.rootDocument.createElement(this.options.tagName);c.setAttribute("data-hot-input",!0),objectEach(this.options,(u,d)=>{c[d]!==void 0&&d!=="className"&&d!=="tagName"&&d!=="children"&&(c[d]=this.translateIfPossible(u))}),this._element.appendChild(c),arrayEach(EVENTS_TO_REGISTER,u=>s(c,u))}else arrayEach(EVENTS_TO_REGISTER,c=>s(this._element,c))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};mixin(BaseUI$3,localHooks);function _classPrivateMethodInitSpec$x(a,s){_checkPrivateRedeclaration$I(a,s),s.add(a)}function _classPrivateFieldInitSpec$y(a,s,c){_checkPrivateRedeclaration$I(a,s),s.set(a,c)}function _checkPrivateRedeclaration$I(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$y(a,s){return a.get(_assertClassBrand$I(a,s))}function _classPrivateFieldSet$x(a,s,c){return a.set(_assertClassBrand$I(a,s),c),c}function _assertClassBrand$I(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _input$1=new WeakMap,_InputUI_brand=new WeakSet;class InputUI extends BaseUI$3{static get DEFAULTS(){return clone({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(s,c){super(s,extend$1(InputUI.DEFAULTS,c)),_classPrivateMethodInitSpec$x(this,_InputUI_brand),_classPrivateFieldInitSpec$y(this,_input$1,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",s=>_assertClassBrand$I(_InputUI_brand,this,_onKeyup).call(this,s))}build(){super.build();const s=this.hot.rootDocument.createElement("div");_classPrivateFieldSet$x(_input$1,this,this._element.firstChild),addClass$1(this._element,"htUIInput"),addClass$1(s,"htUIInputIcon"),this._element.appendChild(s),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$y(_input$1,this).type=this.options.type,_classPrivateFieldGet$y(_input$1,this).placeholder=this.translateIfPossible(this.options.placeholder),_classPrivateFieldGet$y(_input$1,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&_classPrivateFieldGet$y(_input$1,this).focus()}}function _onKeyup(a){this.options.value=a.target.value}function _classPrivateMethodInitSpec$w(a,s){_checkPrivateRedeclaration$H(a,s),s.add(a)}function _classPrivateFieldInitSpec$x(a,s,c){_checkPrivateRedeclaration$H(a,s),s.set(a,c)}function _checkPrivateRedeclaration$H(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$w(a,s,c){return a.set(_assertClassBrand$H(a,s),c),c}function _classPrivateFieldGet$x(a,s){return a.get(_assertClassBrand$H(a,s))}function _assertClassBrand$H(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _menu=new WeakMap,_items$1=new WeakMap,_caption=new WeakMap,_captionElement=new WeakMap,_dropdown=new WeakMap,_SelectUI_brand=new WeakSet;class SelectUI extends BaseUI$3{static get DEFAULTS(){return clone({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(s,c){super(s,extend$1(SelectUI.DEFAULTS,c)),_classPrivateMethodInitSpec$w(this,_SelectUI_brand),_classPrivateFieldInitSpec$x(this,_menu,null),_classPrivateFieldInitSpec$x(this,_items$1,[]),_classPrivateFieldInitSpec$x(this,_caption,void 0),_classPrivateFieldInitSpec$x(this,_captionElement,void 0),_classPrivateFieldInitSpec$x(this,_dropdown,void 0),this.registerHooks()}getMenu(){return _classPrivateFieldGet$x(_menu,this)}registerHooks(){this.addLocalHook("click",()=>_assertClassBrand$H(_SelectUI_brand,this,_onClick).call(this))}setItems(s){_classPrivateFieldSet$w(_items$1,this,this.translateNames(s)),_classPrivateFieldGet$x(_menu,this)&&_classPrivateFieldGet$x(_menu,this).setMenuItems(_classPrivateFieldGet$x(_items$1,this))}translateNames(s){return arrayEach(s,c=>{c.name=this.translateIfPossible(c.name)}),s}build(){super.build(),_classPrivateFieldSet$w(_menu,this,new Menu(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),_classPrivateFieldGet$x(_menu,this).setMenuItems(_classPrivateFieldGet$x(_items$1,this));const s=new BaseUI$3(this.hot,{className:"htUISelectCaption"}),c=new BaseUI$3(this.hot,{className:"htUISelectDropdown"});_classPrivateFieldSet$w(_caption,this,s),_classPrivateFieldSet$w(_captionElement,this,s.element),_classPrivateFieldSet$w(_dropdown,this,c),this.hot.getSettings().ariaTags&&(setAttribute(c.element,[A11Y_HIDDEN()]),setAttribute(this._element,[A11Y_LISTBOX()])),arrayEach([s,c],u=>this._element.appendChild(u.element)),_classPrivateFieldGet$x(_menu,this).addLocalHook("select",u=>_assertClassBrand$H(_SelectUI_brand,this,_onMenuSelect).call(this,u)),_classPrivateFieldGet$x(_menu,this).addLocalHook("afterClose",()=>_assertClassBrand$H(_SelectUI_brand,this,_onMenuClosed).call(this)),this.update()}update(){if(!this.isBuilt())return;let s;this.options.value?s=this.options.value.name:s=_classPrivateFieldGet$x(_menu,this).hot.getTranslatedPhrase(FILTERS_CONDITIONS_NONE),_classPrivateFieldGet$x(_captionElement,this).textContent=s,super.update()}openOptions(){const s=this.element.getBoundingClientRect();_classPrivateFieldGet$x(_menu,this)&&(_classPrivateFieldGet$x(_menu,this).open(),_classPrivateFieldGet$x(_menu,this).setPosition({left:this.hot.isLtr()?s.left-5:s.left-31,top:s.top-1,width:s.width,height:s.height}),_classPrivateFieldGet$x(_menu,this).getNavigator().toFirstItem(),_classPrivateFieldGet$x(_menu,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:c=>{this.closeOptions(),this.runLocalHooks("tabKeydown",c)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){_classPrivateFieldGet$x(_menu,this)&&_classPrivateFieldGet$x(_menu,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){_classPrivateFieldGet$x(_menu,this)&&(_classPrivateFieldGet$x(_menu,this).destroy(),_classPrivateFieldSet$w(_menu,this,null)),_classPrivateFieldGet$x(_caption,this)&&_classPrivateFieldGet$x(_caption,this).destroy(),_classPrivateFieldGet$x(_dropdown,this)&&_classPrivateFieldGet$x(_dropdown,this).destroy(),super.destroy()}}function _onMenuSelect(a){a.name!==KEY$c&&(this.options.value=a,this.update(),this.runLocalHooks("select",this.options.value))}function _onMenuClosed(){this.runLocalHooks("afterClose")}function _onClick(){this.openOptions()}function _classPrivateMethodInitSpec$v(a,s){_checkPrivateRedeclaration$G(a,s),s.add(a)}function _checkPrivateRedeclaration$G(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$M(a,s,c){return(s=_toPropertyKey$M(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$M(a){var s=_toPrimitive$M(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$M(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$G(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _ConditionComponent_brand=new WeakSet;class ConditionComponent extends BaseComponent{constructor(s,c){super(s,{id:c.id,stateless:!1}),_classPrivateMethodInitSpec$v(this,_ConditionComponent_brand),_defineProperty$M(this,"name",""),_defineProperty$M(this,"addSeparator",!1),this.name=c.name,this.addSeparator=c.addSeparator,this.elements.push(new SelectUI(this.hot,{menuContainer:c.menuContainer})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_VALUE})),this.elements.push(new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",s=>_assertClassBrand$G(_ConditionComponent_brand,this,_onConditionSelect).call(this,s)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",s=>this.runLocalHooks("selectTabKeydown",s)),arrayEach(this.getInputElements(),s=>{s.addLocalHook("keydown",c=>_assertClassBrand$G(_ConditionComponent_brand,this,_onInputKeyDown$2).call(this,c))})}setState(s){if(this.reset(),!s)return;const c=clone(s.command);c.name.startsWith(FILTERS_CONDITIONS_NAMESPACE)&&(c.name=this.hot.getTranslatedPhrase(c.name)),this.getSelectElement().setValue(c),arrayEach(s.args,(u,d)=>{if(d>c.inputsCount-1)return!1;const h=this.getInputElement(d);h.setValue(u),h[c.inputsCount>d?"show":"hide"](),d||this.hot._registerTimeout(()=>h.focus(),10)})}getState(){const s=this.getSelectElement().getValue()||getConditionDescriptor(CONDITION_NAME$k),c=[];return arrayEach(this.getInputElements(),(u,d)=>{s.inputsCount>d&&c.push(u.getValue())}),{command:s,args:c}}updateState(s,c){const u=getConditionDescriptor(s?s.name:CONDITION_NAME$k);this.state.setValueAtIndex(c,{command:u,args:s?s.args:[]}),s||arrayEach(this.getInputElements(),d=>d.setValue(null))}getSelectElement(){return this.elements.filter(s=>s instanceof SelectUI)[0]}getInputElement(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[s]}getInputElements(){return this.elements.filter(s=>s instanceof InputUI)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(s,c,u,d,h,f)=>{addClass$1(c.parentNode,"htFiltersMenuCondition"),this.addSeparator&&addClass$1(c.parentNode,"border");const g=this.hot.rootDocument.createElement("div");return addClass$1(g,"htFiltersMenuLabel"),g.textContent=f,c.appendChild(g),c.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,m=>c.appendChild(m.element)),c}}}reset(){const s=this.hot.getPlugin("filters").getSelectedColumn();let c=[getConditionDescriptor(CONDITION_NAME$k)];if(s!==null){const{visualIndex:u}=s;c=getOptionsList(this.hot.getDataType(0,u,this.hot.countRows(),u))}arrayEach(this.getInputElements(),u=>u.hide()),this.getSelectElement().setItems(c),super.reset(),this.getSelectElement().setValue(c[0])}}function _onConditionSelect(a){arrayEach(this.getInputElements(),(s,c)=>{s[a.inputsCount>c?"show":"hide"](),c===0&&this.hot._registerTimeout(()=>s.focus(),10)}),this.runLocalHooks("change",a)}function _onInputKeyDown$2(a){isKey(a.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(a))}function _classPrivateFieldInitSpec$w(a,s,c){_checkPrivateRedeclaration$F(a,s),s.set(a,c)}function _checkPrivateRedeclaration$F(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$w(a,s){return a.get(_assertClassBrand$F(a,s))}function _classPrivateFieldSet$v(a,s,c){return a.set(_assertClassBrand$F(a,s),c),c}function _assertClassBrand$F(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _input=new WeakMap,_label=new WeakMap;class RadioInputUI extends BaseUI$3{static get DEFAULTS(){return clone({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(s,c){super(s,extend$1(RadioInputUI.DEFAULTS,c)),_classPrivateFieldInitSpec$w(this,_input,void 0),_classPrivateFieldInitSpec$w(this,_label,void 0)}build(){super.build();const s=this.hot.rootDocument.createElement("label");s.textContent=this.translateIfPossible(this.options.label.textContent),s.htmlFor=this.translateIfPossible(this.options.label.htmlFor),_classPrivateFieldSet$v(_label,this,s),_classPrivateFieldSet$v(_input,this,this._element.firstChild),_classPrivateFieldGet$w(_input,this).checked=this.options.checked,this._element.appendChild(s),this.update()}update(){this.isBuilt()&&(_classPrivateFieldGet$w(_label,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?_classPrivateFieldGet$w(_input,this).checked:!1}setChecked(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(_classPrivateFieldGet$w(_input,this).checked=s)}focus(){this.isBuilt()&&_classPrivateFieldGet$w(_input,this).focus()}}function _classPrivateMethodInitSpec$u(a,s){_checkPrivateRedeclaration$E(a,s),s.add(a)}function _checkPrivateRedeclaration$E(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$L(a,s,c){return(s=_toPropertyKey$L(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$L(a){var s=_toPrimitive$L(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$L(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$E(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const SELECTED_AT_START_ELEMENT_INDEX=0;var _OperatorsComponent_brand=new WeakSet;class OperatorsComponent extends BaseComponent{constructor(s,c){super(s,{id:c.id,stateless:!1}),_classPrivateMethodInitSpec$u(this,_OperatorsComponent_brand),_defineProperty$L(this,"name",""),this.name=c.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(s,c)=>(addClass$1(c.parentNode,"htFiltersMenuOperators"),arrayEach(this.elements,u=>c.appendChild(u.element)),c)}}buildOperatorsElement(){const s=[OPERATION_ID$2,OPERATION_ID$1];arrayEach(s,c=>{const u=new RadioInputUI(this.hot,{name:"operator",label:{htmlFor:c,textContent:getOperationName(c)},value:c,checked:c===s[SELECTED_AT_START_ELEMENT_INDEX],id:c});u.addLocalHook("change",d=>_assertClassBrand$E(_OperatorsComponent_brand,this,_onRadioInputChange).call(this,d)),this.elements.push(u)})}setChecked(s){if(this.elements.length<s)throw Error(toSingleLine`Radio button with index ${s} doesn't exist.`);arrayEach(this.elements,(c,u)=>{c.setChecked(u===s)})}getActiveOperationId(){const s=this.elements.find(c=>c instanceof RadioInputUI&&c.isChecked());return s?s.getValue():OPERATION_ID$2}getState(){return this.getActiveOperationId()}setState(s){this.reset(),s&&this.getActiveOperationId()!==s&&arrayEach(this.elements,c=>{c.setChecked(c.getValue()===s)})}updateState(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:OPERATION_ID$2,c=arguments.length>1?arguments[1]:void 0,u=s;u===OPERATION_ID&&(u=OPERATION_ID$1),this.state.setValueAtIndex(c,u)}reset(){this.setChecked(SELECTED_AT_START_ELEMENT_INDEX)}}function _onRadioInputChange(a){this.setState(a.target.value)}function _classPrivateFieldInitSpec$v(a,s,c){_checkPrivateRedeclaration$D(a,s),s.set(a,c)}function _checkPrivateRedeclaration$D(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$v(a,s){return a.get(_assertClassBrand$D(a,s))}function _classPrivateFieldSet$u(a,s,c){return a.set(_assertClassBrand$D(a,s),c),c}function _assertClassBrand$D(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _link=new WeakMap;class LinkUI extends BaseUI$3{static get DEFAULTS(){return clone({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(s,c){super(s,extend$1(LinkUI.DEFAULTS,c)),_classPrivateFieldInitSpec$v(this,_link,void 0)}build(){super.build(),_classPrivateFieldSet$u(_link,this,this._element.firstChild)}update(){this.isBuilt()&&(_classPrivateFieldGet$v(_link,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&_classPrivateFieldGet$v(_link,this).focus()}activate(){_classPrivateFieldGet$v(_link,this).click()}}function _classPrivateMethodInitSpec$t(a,s){_checkPrivateRedeclaration$C(a,s),s.add(a)}function _classPrivateFieldInitSpec$u(a,s,c){_checkPrivateRedeclaration$C(a,s),s.set(a,c)}function _checkPrivateRedeclaration$C(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$u(a,s){return a.get(_assertClassBrand$C(a,s))}function _classPrivateFieldSet$t(a,s,c){return a.set(_assertClassBrand$C(a,s),c),c}function _assertClassBrand$C(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP$6="multipleSelect.itemBox";var _items=new WeakMap,_itemsBox=new WeakMap,_locale=new WeakMap,_searchInput=new WeakMap,_selectAllUI=new WeakMap,_clearAllUI=new WeakMap,_MultipleSelectUI_brand=new WeakSet;class MultipleSelectUI extends BaseUI$3{static get DEFAULTS(){return clone({className:"htUIMultipleSelect",value:[]})}constructor(s,c){super(s,extend$1(MultipleSelectUI.DEFAULTS,c)),_classPrivateMethodInitSpec$t(this,_MultipleSelectUI_brand),_classPrivateFieldInitSpec$u(this,_items,[]),_classPrivateFieldInitSpec$u(this,_itemsBox,void 0),_classPrivateFieldInitSpec$u(this,_locale,void 0),_classPrivateFieldInitSpec$u(this,_searchInput,void 0),_classPrivateFieldInitSpec$u(this,_selectAllUI,void 0),_classPrivateFieldInitSpec$u(this,_clearAllUI,void 0),_classPrivateFieldSet$t(_searchInput,this,new InputUI(this.hot,{placeholder:FILTERS_BUTTONS_PLACEHOLDER_SEARCH,className:"htUIMultipleSelectSearch"})),_classPrivateFieldSet$t(_selectAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_SELECT_ALL,className:"htUISelectAll"})),_classPrivateFieldSet$t(_clearAllUI,this,new LinkUI(this.hot,{textContent:FILTERS_BUTTONS_CLEAR,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return _classPrivateFieldGet$u(_itemsBox,this)}registerHooks(){_classPrivateFieldGet$u(_searchInput,this).addLocalHook("keydown",s=>_assertClassBrand$C(_MultipleSelectUI_brand,this,_onInputKeyDown$1).call(this,s)),_classPrivateFieldGet$u(_searchInput,this).addLocalHook("input",s=>_assertClassBrand$C(_MultipleSelectUI_brand,this,_onInput).call(this,s)),_classPrivateFieldGet$u(_selectAllUI,this).addLocalHook("click",s=>_assertClassBrand$C(_MultipleSelectUI_brand,this,_onSelectAllClick).call(this,s)),_classPrivateFieldGet$u(_clearAllUI,this).addLocalHook("click",s=>_assertClassBrand$C(_MultipleSelectUI_brand,this,_onClearAllClick).call(this,s))}setItems(s){var c;_classPrivateFieldSet$t(_items,this,s),(c=_classPrivateFieldGet$u(_itemsBox,this))===null||c===void 0||c.loadData(_classPrivateFieldGet$u(_items,this))}setLocale(s){_classPrivateFieldSet$t(_locale,this,s)}getLocale(){return _classPrivateFieldGet$u(_locale,this)}getItems(){return[..._classPrivateFieldGet$u(_items,this)]}getValue(){return itemsToValue(_classPrivateFieldGet$u(_items,this))}getSearchInputElement(){return _classPrivateFieldGet$u(_searchInput,this)}getSelectAllElement(){return _classPrivateFieldGet$u(_selectAllUI,this)}getClearAllElement(){return _classPrivateFieldGet$u(_clearAllUI,this)}isSelectedAllValues(){return _classPrivateFieldGet$u(_items,this).length===this.getValue().length}build(){var s;super.build();const{rootDocument:c}=this.hot,u=c.createElement("div"),d=new BaseUI$3(this.hot,{className:"htUISelectionControls",children:[_classPrivateFieldGet$u(_selectAllUI,this),_classPrivateFieldGet$u(_clearAllUI,this)]});this._element.appendChild(_classPrivateFieldGet$u(_searchInput,this).element),this._element.appendChild(d.element),this._element.appendChild(u),(s=_classPrivateFieldGet$u(_itemsBox,this))===null||s===void 0||s.destroy(),addClass$1(u,"htUIMultipleSelectHot"),_classPrivateFieldSet$t(_itemsBox,this,new this.hot.constructor(u,{data:[[]],columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(g,m,p,v,w,E)=>{g.title=E.instance.getDataAtRowProp(m,E.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{_classPrivateFieldGet$u(_itemsBox,this).listen()},modifyColWidth:g=>{const m=_classPrivateFieldGet$u(_itemsBox,this).container.scrollWidth-getScrollbarWidth(c);return g!==void 0&&g<m?m:g},autoColumnSize:!0,autoRowSize:!1,hiddenRows:!0,maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),_classPrivateFieldGet$u(_itemsBox,this).init();const f=_classPrivateFieldGet$u(_itemsBox,this).getShortcutManager().getContext("grid");f.removeShortcutsByKeys(["Tab"]),f.removeShortcutsByKeys(["Shift","Tab"]),f.addShortcut({keys:[["Escape"]],callback:g=>{this.runLocalHooks("keydown",g,this)},group:SHORTCUTS_GROUP$6}),f.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:g=>{_classPrivateFieldGet$u(_itemsBox,this).deselectCell(),this.runLocalHooks("keydown",g,this),this.runLocalHooks("listTabKeydown",g,this)},group:SHORTCUTS_GROUP$6})}focus(){this.isBuilt()&&_classPrivateFieldGet$u(_itemsBox,this).listen()}reset(){_classPrivateFieldGet$u(_searchInput,this).reset(),_classPrivateFieldGet$u(_selectAllUI,this).reset(),_classPrivateFieldGet$u(_clearAllUI,this).reset()}update(){!this.isBuilt()||_classPrivateFieldGet$u(_itemsBox,this).rootElement.offsetHeight===0||(_classPrivateFieldGet$u(_itemsBox,this).updateSettings({data:valueToItems(_classPrivateFieldGet$u(_items,this),this.options.value)}),super.update())}destroy(){var s;(s=_classPrivateFieldGet$u(_itemsBox,this))===null||s===void 0||s.destroy(),_classPrivateFieldGet$u(_searchInput,this).destroy(),_classPrivateFieldGet$u(_clearAllUI,this).destroy(),_classPrivateFieldGet$u(_selectAllUI,this).destroy(),_classPrivateFieldSet$t(_searchInput,this,null),_classPrivateFieldSet$t(_clearAllUI,this,null),_classPrivateFieldSet$t(_selectAllUI,this,null),_classPrivateFieldSet$t(_itemsBox,this,null),_classPrivateFieldSet$t(_items,this,null),super.destroy()}}function _onInput(a){const s=a.target.value.toLocaleLowerCase(this.getLocale());if(this.options.searchMode==="apply"){const c=_classPrivateFieldGet$u(_itemsBox,this).getPlugin("hiddenRows");c.showRows(c.getHiddenRows()),_classPrivateFieldGet$u(_items,this).forEach((u,d)=>{u.checked=`${u.value}`.toLocaleLowerCase(this.getLocale()).indexOf(s)>=0,u.checked||c.hideRow(d)}),_classPrivateFieldGet$u(_itemsBox,this).view.adjustElementsSize(),_classPrivateFieldGet$u(_itemsBox,this).render()}else{let c;s===""?c=[..._classPrivateFieldGet$u(_items,this)]:c=_classPrivateFieldGet$u(_items,this).filter(u=>`${u.value}`.toLocaleLowerCase(this.getLocale()).indexOf(s)>=0),_classPrivateFieldGet$u(_itemsBox,this).loadData(c)}}function _onInputKeyDown$1(a){this.runLocalHooks("keydown",a,this),partial(isKey,a.keyCode)("ARROW_DOWN")&&(a.preventDefault(),stopImmediatePropagation(a),_classPrivateFieldGet$u(_itemsBox,this).listen(),_classPrivateFieldGet$u(_itemsBox,this).selectCell(0,0))}function _onSelectAllClick(a){const s=[];a.preventDefault(),_classPrivateFieldGet$u(_itemsBox,this).getSourceData().forEach((c,u)=>{c.checked=!0,s.push(dataRowToChangesArray(c,u)[0])}),_classPrivateFieldGet$u(_itemsBox,this).setSourceDataAtCell(s)}function _onClearAllClick(a){const s=[];a.preventDefault(),_classPrivateFieldGet$u(_itemsBox,this).getSourceData().forEach((c,u)=>{c.checked=!1,s.push(dataRowToChangesArray(c,u)[0])}),_classPrivateFieldGet$u(_itemsBox,this).setSourceDataAtCell(s)}function valueToItems(a,s){const c=createArrayAssertion(s);return a.map(u=>(u.checked=c(u.value),u))}function itemsToValue(a){const s=[];return a.forEach(c=>{c.checked&&s.push(c.value)}),s}function _classPrivateMethodInitSpec$s(a,s){_checkPrivateRedeclaration$B(a,s),s.add(a)}function _checkPrivateRedeclaration$B(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$K(a,s,c){return(s=_toPropertyKey$K(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$K(a){var s=_toPrimitive$K(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$K(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$B(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _ValueComponent_brand=new WeakSet;class ValueComponent extends BaseComponent{constructor(s,c){super(s,{id:c.id,stateless:!1}),_classPrivateMethodInitSpec$s(this,_ValueComponent_brand),_defineProperty$K(this,"name",""),_defineProperty$K(this,"searchMode",void 0),this.name=c.name,this.searchMode=c.searchMode,this.elements.push(new MultipleSelectUI(this.hot,{searchMode:this.searchMode})),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",s=>_assertClassBrand$B(_ValueComponent_brand,this,_onInputKeyDown).call(this,s)).addLocalHook("listTabKeydown",s=>this.runLocalHooks("listTabKeydown",s)),this.hot.addHook("modifyFiltersMultiSelectValue",(s,c)=>_assertClassBrand$B(_ValueComponent_brand,this,_onModifyDisplayedValue).call(this,s,c))}getElements(){const s=this.getMultipleSelectElement();return[s.getSearchInputElement(),s.getSelectAllElement(),s.getClearAllElement(),this.getMultipleSelectElement()]}setState(s){if(this.reset(),s&&s.command.key===CONDITION_NAME){const c=this.getMultipleSelectElement();c.setItems(s.itemsSnapshot),c.setValue(s.args[0]),c.setLocale(s.locale)}}getState(){const s=this.getMultipleSelectElement(),c=s.getItems();return{command:{key:s.isSelectedAllValues()||!c.length?CONDITION_NAME$k:CONDITION_NAME},args:[s.getValue()],itemsSnapshot:c}}updateState(s){const c=(u,d,h,f,g)=>{const[m]=arrayFilter(d,w=>w.name===CONDITION_NAME),p={},v=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS);if(m){const w=f(u,g),E=arrayMap(w,I=>I.value),C=new Map(w.map(I=>[I.value,this.hot.getCellMeta(I.meta.visualRow,I.meta.visualCol)])),b=unifyColumnValues(E);h&&(m.args[0]=h);const P=[],R=intersectValues(b,m.args[0],v,I=>{I.checked&&P.push(I.value),_assertClassBrand$B(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,I,C)}),T=s.editedConditionStack.column;p.locale=this.hot.getCellMeta(0,T).locale,p.args=[P],p.command=getConditionDescriptor(CONDITION_NAME),p.itemsSnapshot=R}else p.args=[],p.command=getConditionDescriptor(CONDITION_NAME$k);this.state.setValueAtIndex(u,p)};c(s.editedConditionStack.column,s.editedConditionStack.conditions,s.conditionArgsChange,s.filteredRowsFactory),s.dependentConditionStacks.length&&c(s.dependentConditionStacks[0].column,s.dependentConditionStacks[0].conditions,s.conditionArgsChange,s.filteredRowsFactory,s.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(s=>s instanceof MultipleSelectUI)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(s,c,u,d,h,f)=>{addClass$1(c.parentNode,"htFiltersMenuValue");const g=this.hot.rootDocument.createElement("div");return addClass$1(g,"htFiltersMenuLabel"),g.textContent=f,c.appendChild(g),c.parentElement.hasAttribute("ghost-table")||arrayEach(this.elements,m=>c.appendChild(m.element)),c}}}reset(){const s=this.hot.getTranslatedPhrase(FILTERS_VALUES_BLANK_CELLS),c=this._getColumnVisibleValues(),u=c.map(m=>m.value),d=new Map(c.map(m=>[m.value,m.meta])),h=unifyColumnValues(u),f=intersectValues(h,h,s,m=>{_assertClassBrand$B(_ValueComponent_brand,this,_triggerModifyMultipleSelectionValueHook).call(this,m,d)});this.getMultipleSelectElement().setItems(f),super.reset(),this.getMultipleSelectElement().setValue(h);const g=this.hot.getPlugin("filters").getSelectedColumn();g!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,g.visualIndex).locale)}_getColumnVisibleValues(){const s=this.hot.getPlugin("filters").getSelectedColumn();return s===null?[]:arrayMap(this.hot.getDataAtCol(s.visualIndex),(c,u)=>({value:toEmptyString(c),meta:this.hot.getCellMeta(u,s.visualIndex)}))}}function _onInputKeyDown(a){isKey(a.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),stopImmediatePropagation(a)),isKey(a.keyCode,"ENTER")&&(this.searchMode==="apply"&&this.runLocalHooks("accept"),stopImmediatePropagation(a))}function _triggerModifyMultipleSelectionValueHook(a,s){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(a.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",a.visualValue,s.get(a.value)))}function _onModifyDisplayedValue(a,s){switch(s.type){case"numeric":return getRenderedValue(a,s);default:return a}}var _ActionBarComponent;function _classPrivateMethodInitSpec$r(a,s){_checkPrivateRedeclaration$A(a,s),s.add(a)}function _checkPrivateRedeclaration$A(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$J(a,s,c){return(s=_toPropertyKey$J(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$J(a){var s=_toPrimitive$J(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$J(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$A(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _ActionBarComponent_brand=new WeakSet;class ActionBarComponent extends BaseComponent{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(s,c){super(s,{id:c.id,stateless:!0}),_classPrivateMethodInitSpec$r(this,_ActionBarComponent_brand),_defineProperty$J(this,"name",""),this.name=c.name,this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_OK,className:"htUIButton htUIButtonOK",identifier:ActionBarComponent.BUTTON_OK})),this.elements.push(new InputUI(this.hot,{type:"button",value:FILTERS_BUTTONS_CANCEL,className:"htUIButton htUIButtonCancel",identifier:ActionBarComponent.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){arrayEach(this.elements,s=>{s.addLocalHook("click",(c,u)=>_assertClassBrand$A(_ActionBarComponent_brand,this,_onButtonClick).call(this,c,u))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(s,c)=>(addClass$1(c.parentNode,"htFiltersMenuActionBar"),arrayEach(this.elements,u=>c.appendChild(u.element)),c)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}_ActionBarComponent=ActionBarComponent;function _onButtonClick(a,s){s.options.identifier===_ActionBarComponent.BUTTON_OK?this.accept():this.cancel()}function _defineProperty$I(a,s,c){return(s=_toPropertyKey$I(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$I(a){var s=_toPrimitive$I(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$I(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const MAP_NAME="ConditionCollection.filteringStates";class ConditionCollection{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;_defineProperty$I(this,"hot",void 0),_defineProperty$I(this,"isMapRegistrable",void 0),_defineProperty$I(this,"filteringStates",new LinkedPhysicalIndexToValueMap),this.hot=s,this.isMapRegistrable=c,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(MAP_NAME,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(s,c){var u;const d=this.filteringStates.getValueAtIndex(c),h=(u=d?.conditions)!==null&&u!==void 0?u:[],f=d?.operation;return this.isMatchInConditions(h,s,f)}isMatchInConditions(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2;return s.length?getOperationFunc(u)(s,c):!0}addCondition(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:OPERATION_ID$2,d=arguments.length>3?arguments[3]:void 0;const h=this.hot.getCellMeta(0,s).locale,f=c.args.map(v=>typeof v=="string"?v.toLocaleLowerCase(h):v),g=c.name||c.command.key;this.runLocalHooks("beforeAdd",s);const m=this.getOperation(s);if(m){if(m!==u)throw Error(toSingleLine`The column of index ${s} has been already applied with a \`${m}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if(isUndefined(operations[u]))throw new Error(toSingleLine`Unexpected operation named \`${u}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const p=this.getConditions(s);p.length===0?this.filteringStates.setValueAtIndex(s,{operation:u,conditions:[{name:g,args:f,func:getCondition(g,f)}]},d):p.push({name:g,args:f,func:getCondition(g,f)}),this.runLocalHooks("afterAdd",s)}getConditions(s){var c,u;return(c=(u=this.filteringStates.getValueAtIndex(s))===null||u===void 0?void 0:u.conditions)!==null&&c!==void 0?c:[]}getOperation(s){var c;return(c=this.filteringStates.getValueAtIndex(s))===null||c===void 0?void 0:c.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(s=>{let[c]=s;return c})}getColumnStackPosition(s){return this.getFilteredColumns().indexOf(s)}exportAllConditions(){return this.filteringStates.getEntries().reduce((s,c)=>{let[u,{operation:d,conditions:h}]=c;return s.push({column:u,operation:d,conditions:h.map(f=>{let{name:g,args:m}=f;return{name:g,args:[...m]}})}),s},[])}importAllConditions(s){this.clean(),s.forEach(c=>{c.conditions.forEach(u=>this.addCondition(c.column,u))})}removeConditions(s){this.runLocalHooks("beforeRemove",s),this.filteringStates.clearValue(s),this.runLocalHooks("afterRemove",s)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(s,c){const u=this.getConditions(s);return c?u.some(d=>d.name===c):u.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(MAP_NAME),this.filteringStates=null,this.clearLocalHooks()}}mixin(ConditionCollection,localHooks);function _defineProperty$H(a,s,c){return(s=_toPropertyKey$H(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$H(a){var s=_toPrimitive$H(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$H(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DataFilter{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];_defineProperty$H(this,"conditionCollection",void 0),_defineProperty$H(this,"columnDataFactory",void 0),this.conditionCollection=s,this.columnDataFactory=c}filter(){let s=[];return arrayEach(this.conditionCollection.getFilteredColumns(),(c,u)=>{let d=this.columnDataFactory(c);u&&(d=this._getIntersectData(d,s)),s=this.filterByColumn(c,d)}),s}filterByColumn(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const u=[];return arrayEach(c,d=>{d!==void 0&&this.conditionCollection.isMatch(d,s)&&u.push(d)}),u}_getIntersectData(s,c){const u=[];return arrayEach(c,d=>{const h=d.meta.visualRow;s[h]!==void 0&&(u[h]=s[h])}),u}}function _classPrivateMethodInitSpec$q(a,s){_checkPrivateRedeclaration$z(a,s),s.add(a)}function _checkPrivateRedeclaration$z(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$G(a,s,c){return(s=_toPropertyKey$G(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$G(a){var s=_toPrimitive$G(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$G(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$z(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _ConditionUpdateObserver_brand=new WeakSet;class ConditionUpdateObserver{constructor(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];_classPrivateMethodInitSpec$q(this,_ConditionUpdateObserver_brand),_defineProperty$G(this,"hot",void 0),_defineProperty$G(this,"conditionCollection",void 0),_defineProperty$G(this,"columnDataFactory",void 0),_defineProperty$G(this,"changes",[]),_defineProperty$G(this,"grouping",!1),_defineProperty$G(this,"latestEditedColumnPosition",-1),_defineProperty$G(this,"latestOrderStack",[]),this.hot=s,this.conditionCollection=c,this.columnDataFactory=u,this.conditionCollection.addLocalHook("beforeRemove",d=>_assertClassBrand$z(_ConditionUpdateObserver_brand,this,_onConditionBeforeModify).call(this,d)),this.conditionCollection.addLocalHook("afterRemove",d=>this.updateStatesAtColumn(d)),this.conditionCollection.addLocalHook("afterAdd",d=>this.updateStatesAtColumn(d)),this.conditionCollection.addLocalHook("beforeClean",()=>_assertClassBrand$z(_ConditionUpdateObserver_brand,this,_onConditionBeforeClean).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>_assertClassBrand$z(_ConditionUpdateObserver_brand,this,_onConditionAfterClean).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,arrayEach(this.changes,s=>{this.updateStatesAtColumn(s)}),this.changes.length=0}updateStatesAtColumn(s,c){var u=this;if(this.grouping){this.changes.indexOf(s)===-1&&this.changes.push(s);return}const d=this.conditionCollection.exportAllConditions();let h=this.conditionCollection.getColumnStackPosition(s);h===-1&&(h=this.latestEditedColumnPosition);const f=d.slice(0,h),g=d.slice(h);g.length&&g[0].column===s&&g.shift();const m=curry(function(v,w){let E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const C=new ConditionCollection(u.hot,!1),b=[].concat(v,E);C.importAllConditions(b);const P=u.columnDataFactory(w);let R;C.isEmpty()?R=P:R=new DataFilter(C,I=>u.columnDataFactory(I)).filter(),R=arrayMap(R,I=>I.meta.visualRow);const T=createArrayAssertion(R);return C.destroy(),arrayFilter(P,I=>T(I.meta.visualRow))})(f),p=[].concat(this.conditionCollection.getConditions(s));this.runLocalHooks("update",{editedConditionStack:{column:s,conditions:p},dependentConditionStacks:g,filteredRowsFactory:m,conditionArgsChange:c})}destroy(){this.clearLocalHooks(),objectEach(this,(s,c)=>{this[c]=null})}}function _onConditionBeforeModify(a){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(a)}function _onConditionBeforeClean(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function _onConditionAfterClean(){arrayEach(this.latestOrderStack,a=>{this.updateStatesAtColumn(a)})}mixin(ConditionUpdateObserver,localHooks);function createFocusNavigator(a){return createPaginator({initialPage:0,size:()=>a.length,onItemSelect:(c,u)=>{const d=a[c];if(d instanceof MultipleSelectUI)return u;if(d.element&&!isVisible(d.element))return!1;d.focus()}})}const SHORTCUTS_MENU_CONTEXT="filters";function createMenuFocusController(a,s){let c=-1,u;const d=createFocusNavigator(s),h=w=>()=>{u.isOpened()&&u.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT),d.setCurrentPage(s.indexOf(w))};s.forEach(w=>{w instanceof BaseUI$3&&(w.addLocalHook("click",h(w)),w.addLocalHook("focus",h(w)),w.addLocalHook("afterClose",h(w)))}),m(a);function f(w){const E=u.getKeyboardShortcutsCtrl(),C=w.getKeyboardShortcutsCtrl();d.clear(),C.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:E.getContext(SHORTCUTS_MENU_CONTEXT),callback:()=>{w.isSubMenu()&&w.close(),E.listen(SHORTCUTS_MENU_CONTEXT)}}]),!w.isSubMenu()&&E.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:b=>{const P=u.getNavigator();P.getCurrentPage()>-1&&(c=P.getCurrentPage()),P.clear(),b.shiftKey?d.toPreviousItem():d.toNextItem()}},{keys:[["Escape"]],callback:()=>{u.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:b=>{const P=s[d.getCurrentPage()];P instanceof SelectUI&&(P.openOptions(),b.preventDefault()),P instanceof LinkUI&&(P.activate(),b.preventDefault()),P instanceof BaseUI$3||b.preventDefault()}}],SHORTCUTS_MENU_CONTEXT)}function g(){u.focus(),u.getKeyboardShortcutsCtrl().listen(SHORTCUTS_MENU_CONTEXT)}function m(w){w.addLocalHook("afterSelectionChange",E=>{E.key.startsWith("filter_")||d.clear()}),w.addLocalHook("afterSubmenuOpen",f),w.addLocalHook("afterOpen",f),u=w}function p(){return u}function v(){return c}return{...d,listen:g,setMenu:m,getMenu:p,getLastMenuPage:v}}function _classPrivateMethodInitSpec$p(a,s){_checkPrivateRedeclaration$y(a,s),s.add(a)}function _classPrivateFieldInitSpec$t(a,s,c){_checkPrivateRedeclaration$y(a,s),s.set(a,c)}function _checkPrivateRedeclaration$y(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$F(a,s,c){return(s=_toPropertyKey$F(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$F(a){var s=_toPrimitive$F(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$F(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldSet$s(a,s,c){return a.set(_assertClassBrand$y(a,s),c),c}function _classPrivateFieldGet$t(a,s){return a.get(_assertClassBrand$y(a,s))}function _assertClassBrand$y(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$n="filters",PLUGIN_PRIORITY$n=250,SHORTCUTS_GROUP$5=PLUGIN_KEY$n;var _menuFocusNavigator=new WeakMap,_dropdownMenuTraces=new WeakMap,_previousConditionStack=new WeakMap,_Filters_brand=new WeakSet;class Filters extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$n}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$n}static get DEFAULT_SETTINGS(){return{searchMode:"show"}}static get SETTINGS_VALIDATORS(){return{searchMode:s=>typeof s=="string"&&["show","apply"].includes(s)}}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(s){var c;super(s),c=this,_classPrivateMethodInitSpec$p(this,_Filters_brand),_defineProperty$F(this,"dropdownMenuPlugin",null),_defineProperty$F(this,"conditionCollection",null),_defineProperty$F(this,"conditionUpdateObserver",null),_defineProperty$F(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),_defineProperty$F(this,"filtersRowsMap",null),_classPrivateFieldInitSpec$t(this,_menuFocusNavigator,void 0),_classPrivateFieldInitSpec$t(this,_dropdownMenuTraces,new WeakSet),_classPrivateFieldInitSpec$t(this,_previousConditionStack,[]),this.hot.addHook("afterGetColHeader",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$y(_Filters_brand,c,_onAfterGetColHeader$1).call(c,...d)})}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$n]}enablePlugin(){var s=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new TrimmingMap),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const c=this.hot.getSettings().dropdownMenu,u=c&&c.uiContainer||this.hot.rootPortalElement,d=g=>(g.addLocalHook("accept",()=>_assertClassBrand$y(_Filters_brand,this,_onActionBarSubmit).call(this,"accept")),g.addLocalHook("cancel",()=>_assertClassBrand$y(_Filters_brand,this,_onActionBarSubmit).call(this,"cancel")),g.addLocalHook("change",m=>_assertClassBrand$y(_Filters_brand,this,_onComponentChange).call(this,g,m)),g),h=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_CONDITION)}:`,f=()=>`${this.hot.getTranslatedPhrase(FILTERS_DIVS_FILTER_BY_VALUE)}:`;if(!this.components.get("filter_by_condition")){const g=new ConditionComponent(this.hot,{id:"filter_by_condition",name:h,addSeparator:!1,menuContainer:u});g.addLocalHook("afterClose",()=>_assertClassBrand$y(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition",d(g))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new OperatorsComponent(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const g=new ConditionComponent(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:u});g.addLocalHook("afterClose",()=>_assertClassBrand$y(_Filters_brand,this,_onSelectUIClosed).call(this)),this.components.set("filter_by_condition2",d(g))}if(!this.components.get("filter_by_value")){const g=this.getSetting("searchMode");this.components.set("filter_by_value",d(new ValueComponent(this.hot,{id:"filter_by_value",name:f,searchMode:g})))}if(this.components.get("filter_action_bar")||this.components.set("filter_action_bar",d(new ActionBarComponent(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new ConditionCollection(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new ConditionUpdateObserver(this.hot,this.conditionCollection,g=>this.getDataMapAtColumn(g)),this.conditionUpdateObserver.addLocalHook("update",g=>_assertClassBrand$y(_Filters_brand,this,_updateComponents).call(this,g))),this.components.forEach(g=>g.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var g=arguments.length,m=new Array(g),p=0;p<g;p++)m[p]=arguments[p];return _assertClassBrand$y(_Filters_brand,s,_onAfterDropdownMenuDefaultOptions).call(s,...m)}),this.addHook("beforeDropdownMenuShow",()=>_assertClassBrand$y(_Filters_brand,this,_onBeforeDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuShow",()=>_assertClassBrand$y(_Filters_brand,this,_onAfterDropdownMenuShow).call(this)),this.addHook("afterDropdownMenuHide",()=>_assertClassBrand$y(_Filters_brand,this,_onAfterDropdownMenuHide).call(this)),this.addHook("afterChange",g=>_assertClassBrand$y(_Filters_brand,this,_onAfterChange$2).call(this,g)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!_classPrivateFieldGet$t(_menuFocusNavigator,this)&&this.dropdownMenuPlugin.enabled){const g=[{focus:()=>{const p=_classPrivateFieldGet$t(_menuFocusNavigator,this).getMenu(),v=p.getNavigator(),w=_classPrivateFieldGet$t(_menuFocusNavigator,this).getLastMenuPage();p.focus(),w>0?v.setCurrentPage(w):v.toFirstItem()}},...Array.from(this.components).map(p=>{let[,v]=p;return v.getElements()}).flat()];_classPrivateFieldSet$s(_menuFocusNavigator,this,createMenuFocusController(this.dropdownMenuPlugin.menu,g));const m=p=>{_classPrivateFieldGet$t(_menuFocusNavigator,this).listen(),p.preventDefault(),isKey(p.keyCode,"TAB")&&(p.shiftKey?_classPrivateFieldGet$t(_menuFocusNavigator,this).toPreviousItem():_classPrivateFieldGet$t(_menuFocusNavigator,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",m),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",m)}this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){if(this.enabled){var s;(s=this.dropdownMenuPlugin)!==null&&s!==void 0&&s.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((c,u)=>{c.destroy(),this.components.set(u,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const s=this.hot.getSelected();this.clearConditions(),this.filter(),s&&this.hot.selectCells(s)},group:SHORTCUTS_GROUP$5})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$5)}addCondition(s,c,u){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:OPERATION_ID$2;const h=this.hot.toPhysicalColumn(s);this.conditionCollection.addCondition(h,{command:{key:c},args:u},d)}removeConditions(s){const c=this.hot.toPhysicalColumn(s);this.conditionCollection.removeConditions(c)}clearConditions(s){if(s===void 0)this.conditionCollection.clean();else{const c=this.hot.toPhysicalColumn(s);this.conditionCollection.removeConditions(c)}}importConditions(s){this.conditionCollection.importAllConditions(s)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:s}=this.hot.getSettings(),c=this._createDataFilter(),u=!this.conditionCollection.isEmpty();let d=[];const h=this.exportConditions(),f=this.hot.runHooks("beforeFilter",h,_classPrivateFieldGet$t(_previousConditionStack,this));if(f!==!1&&u){const g=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),d=arrayMap(c.filter(),p=>p.meta.visualRow);const m=createArrayAssertion(d);rangeEach(this.hot.countSourceRows()-1,p=>{m(p)||g.push(p)}),arrayEach(g,p=>{this.filtersRowsMap.setValueAtIndex(p,!0)})},!0),!s&&!d.length&&this.hot.deselectCell(),_classPrivateFieldSet$s(_previousConditionStack,this,this.exportConditions())}else f!==!1&&!u?(_classPrivateFieldSet$s(_previousConditionStack,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(_classPrivateFieldGet$t(_previousConditionStack,this));this.hot.selection.isSelected()&&this.hot.selectCell(s?-1:0,this.hot.getSelectedRangeActive().highlight.col),f!==!1&&(this.hot.runHooks("afterFilter",h),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var s;const c=(s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;return c?{visualIndex:c.col,physicalIndex:this.hot.toPhysicalColumn(c.col)}:null}getDataMapAtColumn(s){const c=this.hot.toVisualColumn(s),u=[];return arrayEach(this.hot.getSourceDataAtCol(c),(d,h)=>{var f;const{row:g,col:m,visualCol:p,visualRow:v,type:w,instance:E,dateFormat:C,locale:b}=this.hot.getCellMeta(h,c),P=(f=this.hot.getDataAtCell(this.hot.toVisualRow(h),c))!==null&&f!==void 0?f:d;u.push({meta:{row:g,col:m,visualCol:p,visualRow:v,type:w,instance:E,dateFormat:C,locale:b},value:toEmptyString(P)})}),u}updateValueComponentCondition(s){const c=this.hot.getDataAtCol(s),u=unifyColumnValues(c);this.conditionUpdateObserver.updateStatesAtColumn(s,u)}restoreComponents(s){var c;const u=(c=this.getSelectedColumn())===null||c===void 0?void 0:c.physicalIndex;s.forEach(d=>{d.isHidden()||d.restoreState(u)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(s,c,u,d){let h=s;return h===OPERATION_ID$1&&c.command.key!==CONDITION_NAME$k&&u.command.key!==CONDITION_NAME$k&&d.command.key!==CONDITION_NAME$k?h=OPERATION_ID:d.command.key!==CONDITION_NAME$k&&(c.command.key===CONDITION_NAME$k||u.command.key===CONDITION_NAME$k)&&(h=OPERATION_ID$2),h}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const s=this.components.get("filter_by_condition"),{command:c}=s.getState(),u=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];c.showOperators?this.showComponents(...u):this.hideComponents(...u)}_createDataFilter(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new DataFilter(s,c=>this.getDataMapAtColumn(c))}getIndexesOfComponents(){const s=[];if(!this.dropdownMenuPlugin)return s;const c=this.dropdownMenuPlugin.menu;for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return arrayEach(d,f=>{arrayEach(c.menuItems,(g,m)=>{g.key===f.getMenuItemDescriptor().key&&s.push(m)})}),s}changeComponentsVisibility(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const u=this.dropdownMenuPlugin.menu.hotMenu,d=u.getPlugin("hiddenRows");for(var h=arguments.length,f=new Array(h>1?h-1:0),g=1;g<h;g++)f[g-1]=arguments[g];const m=this.getIndexesOfComponents(...f);s?d.showRows(m):d.hideRows(m),u.render()}hideComponents(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.changeComponentsVisibility(!1,...c)}showComponents(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.changeComponentsVisibility(!0,...c)}destroy(){this.enabled&&(this.components.forEach((s,c)=>{s!==null&&(s.destroy(),this.components.set(c,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function _onAfterChange$2(a){a&&arrayEach(a,s=>{const[,c]=s,u=this.hot.propToCol(c);this.conditionCollection.hasConditions(u)&&this.updateValueComponentCondition(u)})}function _onAfterDropdownMenuShow(){const a=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),a.updateMenuDimensions()}function _onAfterDropdownMenuHide(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function _onBeforeDropdownMenuShow(){const a=this.dropdownMenuPlugin.menu;_classPrivateFieldGet$t(_dropdownMenuTraces,this).has(a)||_classPrivateFieldGet$t(_menuFocusNavigator,this).setMenu(a),_classPrivateFieldGet$t(_dropdownMenuTraces,this).add(a)}function _onAfterDropdownMenuDefaultOptions(a){a.items.push({name:KEY$c}),this.components.forEach(s=>{a.items.push(s.getMenuItemDescriptor())})}function _onActionBarSubmit(a){var s;if(a==="accept"){const u=this.getSelectedColumn();if(u===null){var c;(c=this.dropdownMenuPlugin)===null||c===void 0||c.close();return}const{physicalIndex:d}=u,h=this.components.get("filter_by_condition").getState(),f=this.components.get("filter_by_condition2").getState(),g=this.components.get("filter_by_value").getState(),m=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),h,f,g);this.conditionUpdateObserver.groupChanges();let p=this.conditionCollection.getColumnStackPosition(d);p===-1&&(p=void 0),this.conditionCollection.removeConditions(d),h.command.key!==CONDITION_NAME$k&&(this.conditionCollection.addCondition(d,h,m,p),f.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(d,f,m,p)),g.command.key!==CONDITION_NAME$k&&this.conditionCollection.addCondition(d,g,m,p),this.conditionUpdateObserver.flush(),this.components.forEach(v=>v.saveState(d)),this.filter()}(s=this.dropdownMenuPlugin)===null||s===void 0||s.close()}function _onComponentChange(a,s){const c=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),a.constructor===ConditionComponent&&!s.inputsCount&&this.setListeningDropdownMenu(),c.updateMenuDimensions()}function _onSelectUIClosed(){this.setListeningDropdownMenu()}function _onAfterGetColHeader$1(a,s,c){const u=this.hot.toPhysicalColumn(a);this.enabled&&this.conditionCollection.hasConditions(u)&&c===this.hot.view.getColumnHeadersCount()-1?addClass$1(s,"htFiltersActive"):removeClass$1(s,"htFiltersActive")}function _updateComponents(a){var s;if(!((s=this.dropdownMenuPlugin)!==null&&s!==void 0&&s.enabled))return;const{editedConditionStack:{conditions:c,column:u},conditionArgsChange:d}=a;Array.isArray(d)&&_classPrivateFieldSet$s(_previousConditionStack,this,_classPrivateFieldGet$t(_previousConditionStack,this).map(g=>(g.column===u&&c.length>0&&g.conditions.forEach(m=>{m.name==="by_value"&&(m.args=[[...d]])}),g)));const h=c.filter(g=>g.name===CONDITION_NAME),f=c.filter(g=>g.name!==CONDITION_NAME);if(h.length>=2||f.length>=3)warn$1(toSingleLine`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const g=this.conditionCollection.getOperation(u);this.components.get("filter_by_condition").updateState(f[0],u),this.components.get("filter_by_condition2").updateState(f[1],u),this.components.get("filter_operators").updateState(g,u),this.components.get("filter_by_value").updateState(a)}}const DEFAULT_LICENSE_KEY="internal-use-in-handsontable",DEFAULT_SETTINGS={licenseKey:DEFAULT_LICENSE_KEY,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function getEngineSettingsOverrides(a){var s;return{maxColumns:a.maxColumns,maxRows:a.maxRows,language:(s=a[PLUGIN_KEY$m])===null||s===void 0||(s=s.language)===null||s===void 0?void 0:s.langCode}}function cleanEngineSettings(a){return Object.keys(a).reduce((s,c)=>(c!=="hyperformula"&&(s[c]=a[c]),s),{})}function getEngineSettingsWithDefaultsAndOverrides(a){var s;const c=a[PLUGIN_KEY$m],u=cleanEngineSettings(c!=null&&(s=c.engine)!==null&&s!==void 0&&s.hyperformula?c.engine:{}),d=getEngineSettingsOverrides(a);return{...DEFAULT_SETTINGS,...u,...d}}function getEngineSettingsWithOverrides(a){var s;const c=a[PLUGIN_KEY$m],u=cleanEngineSettings(c!=null&&(s=c.engine)!==null&&s!==void 0&&s.hyperformula?c.engine:{}),d=getEngineSettingsOverrides(a);return{...u,...d}}function haveEngineSettingsChanged(a,s){return Object.keys(s).some(c=>s[c]!==void 0&&s[c]!==a[c])}function getEngineRelationshipRegistry(){const a="engine_relationship",s=staticRegister(PLUGIN_KEY$m);return s.hasItem(a)||s.register(a,new Map),s.getItem(a)}function getSharedEngineUsageRegistry(){const a="shared_engine_usage",s=staticRegister(PLUGIN_KEY$m);return s.hasItem(a)||s.register(a,new Map),s.getItem(a)}function setupEngine(a){const s=a.getSettings(),c=s[PLUGIN_KEY$m],u=c?.engine;if(c===!0||isUndefined(u))return null;if(typeof u.hyperformula=="function"||typeof u=="function"){var d;return registerEngine((d=u.hyperformula)!==null&&d!==void 0?d:u,s,a)}else if(typeof u=="object"&&isUndefined(u.hyperformula)){const h=getEngineRelationshipRegistry(),f=getSharedEngineUsageRegistry().get(u);return h.has(u)||h.set(u,[]),h.get(u).push(a),f&&f.push(a.guid),u.getConfig().licenseKey||u.updateConfig({licenseKey:DEFAULT_LICENSE_KEY}),(u.getConfig().leapYear1900!==DEFAULT_SETTINGS.leapYear1900||isObjectEqual(u.getConfig().nullDate,DEFAULT_SETTINGS.nullDate)===!1)&&warn$1(toSingleLine`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),u}return null}function registerEngine(a,s,c){const u=s[PLUGIN_KEY$m],d=getEngineSettingsWithDefaultsAndOverrides(s),h=getEngineRelationshipRegistry(),f=getSharedEngineUsageRegistry();registerCustomFunctions(a,u.functions),registerLanguage(a,u.language);const g=a.buildEmpty(d);return h.set(g,[c]),f.set(g,[c.guid]),registerNamedExpressions(g,u.namedExpressions),g.on("sheetAdded",()=>{g.rebuildAndRecalculate()}),g.on("sheetRemoved",()=>{g.rebuildAndRecalculate()}),g}function getRegisteredHotInstances(a){var s;const c=getEngineRelationshipRegistry(),u=c.size===0?[]:Array.from((s=c.get(a))!==null&&s!==void 0?s:[]);return new Map(u.map(d=>[d.getPlugin("formulas").sheetId,d]))}function unregisterEngine(a,s){if(a){const c=getEngineRelationshipRegistry(),u=c.get(a),d=getSharedEngineUsageRegistry(),h=d.get(a);u&&u.includes(s)&&(u.splice(u.indexOf(s),1),u.length===0&&c.delete(a)),h&&h.includes(s.guid)&&(h.splice(h.indexOf(s.guid),1),h.length===0&&(d.delete(a),a.destroy()))}}function registerCustomFunctions(a,s){s&&s.forEach(c=>{const{name:u,plugin:d,translations:h}=c;try{a.registerFunction(u,d,h)}catch(f){warn$1(f.message)}})}function registerLanguage(a,s){if(s){const{langCode:c}=s;try{a.registerLanguage(c,s)}catch(u){warn$1(u.message)}}}function registerNamedExpressions(a,s){s&&(a.suspendEvaluation(),s.forEach(c=>{const{name:u,expression:d,scope:h,options:f}=c;try{a.addNamedExpression(u,d,h,f)}catch(g){warn$1(g.message)}}),a.resumeEvaluation())}function setupSheet(a,s){return(isUndefined(s)||!a.doesSheetExist(s))&&(s=a.addSheet(s)),s}const DEFAULT_DATE_FORMAT_HYPERFORMULA="DD/MM/YYYY";function isEscapedFormulaExpression(a){return typeof a=="string"&&a.charAt(0)==="'"&&a.charAt(1)==="="}function unescapeFormulaExpression(a){return isEscapedFormulaExpression(a)?a.substr(1):a}function isFormula(a){return typeof a=="string"&&a.startsWith("=")}function isDate(a,s){return typeof a=="string"&&s==="date"}function isDateValid(a,s){return hooks(a,s,!0).isValid()}function getDateInHfFormat(a,s){return hooks(a,s,!0).format(DEFAULT_DATE_FORMAT_HYPERFORMULA)}function getDateInHotFormat(a,s){return hooks(a,DEFAULT_DATE_FORMAT_HYPERFORMULA,!0).format(s)}function getDateFromExcelDate(a,s){const u=new Date(Date.UTC(0,0,a+-1));return hooks(u).format(s)}function getMoveLine(a,s,c){const u=Array.from(Array(c).keys()).filter(h=>a.includes(h)===!1);if(s===0){var d;return(d=u[s])!==null&&d!==void 0?d:0}return u[s-1]+1}function getInitiallyCalculatedMoves(a,s){const c=[];return a.forEach(u=>{const d={from:u,to:s};c.forEach(h=>{const f=h.from>h.to,g=h.to<=d.from;h.from>d.from&&g&&f&&(d.from+=1)}),d.from>=s&&(s+=1),c.push(d)}),c}function adjustedCalculatedMoves(a){return a.forEach((s,c)=>{a.slice(c+1).forEach(d=>{const h=d.from<d.to;d.from>s.from&&h&&(d.from-=1)})}),a}function getMoves(a,s,c){const u=getInitiallyCalculatedMoves(a,getMoveLine(a,s,c));return adjustedCalculatedMoves(u)}function _classPrivateFieldInitSpec$s(a,s,c){_checkPrivateRedeclaration$x(a,s),s.set(a,c)}function _checkPrivateRedeclaration$x(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$s(a,s){return a.get(_assertClassBrand$x(a,s))}function _classPrivateFieldSet$r(a,s,c){return a.set(_assertClassBrand$x(a,s),c),c}function _assertClassBrand$x(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _axis=new WeakMap,_indexMapper=new WeakMap,_indexSyncer=new WeakMap,_indexesSequence=new WeakMap,_movedIndexes=new WeakMap,_finalIndex=new WeakMap,_removedIndexes=new WeakMap;class AxisSyncer{constructor(s,c,u){_classPrivateFieldInitSpec$s(this,_axis,void 0),_classPrivateFieldInitSpec$s(this,_indexMapper,void 0),_classPrivateFieldInitSpec$s(this,_indexSyncer,void 0),_classPrivateFieldInitSpec$s(this,_indexesSequence,[]),_classPrivateFieldInitSpec$s(this,_movedIndexes,[]),_classPrivateFieldInitSpec$s(this,_finalIndex,void 0),_classPrivateFieldInitSpec$s(this,_removedIndexes,[]),_classPrivateFieldSet$r(_axis,this,s),_classPrivateFieldSet$r(_indexMapper,this,c),_classPrivateFieldSet$r(_indexSyncer,this,u)}setRemovedHfIndexes(s){return _classPrivateFieldSet$r(_removedIndexes,this,s.map(c=>{const u=_classPrivateFieldGet$s(_indexMapper,this).getVisualFromPhysicalIndex(c);return this.getHfIndexFromVisualIndex(u)})),_classPrivateFieldGet$s(_removedIndexes,this)}getRemovedHfIndexes(){return _classPrivateFieldGet$s(_removedIndexes,this)}getHfIndexFromVisualIndex(s){const c=_classPrivateFieldGet$s(_indexMapper,this).getIndexesSequence(),u=_classPrivateFieldGet$s(_indexMapper,this).getNotTrimmedIndexes();return c.indexOf(u[s],s)}syncMoves(s){const u=`move${toUpperCaseFirst(_classPrivateFieldGet$s(_axis,this))}s`;_classPrivateFieldGet$s(_indexSyncer,this).getEngine().batch(()=>{s.forEach(d=>{const h=d.from!==d.to,f=d.from+1!==d.to;h&&f&&_classPrivateFieldGet$s(_indexSyncer,this).getEngine()[u](_classPrivateFieldGet$s(_indexSyncer,this).getSheetId(),d.from,1,d.to)})})}storeMovesInformation(s,c,u){u!==!1&&(_classPrivateFieldSet$r(_movedIndexes,this,s.map(d=>this.getHfIndexFromVisualIndex(d))),_classPrivateFieldSet$r(_finalIndex,this,this.getHfIndexFromVisualIndex(c)))}calculateAndSyncMoves(s,c){if(_classPrivateFieldGet$s(_indexSyncer,this).isPerformingUndoRedo()||s===!1||c===!1)return;const u=getMoves(_classPrivateFieldGet$s(_movedIndexes,this),_classPrivateFieldGet$s(_finalIndex,this),_classPrivateFieldGet$s(_indexMapper,this).getNumberOfIndexes());_classPrivateFieldGet$s(_indexSyncer,this).getSheetId()===null?_classPrivateFieldGet$s(_indexSyncer,this).getPostponeAction(()=>this.syncMoves(u)):this.syncMoves(u)}getIndexesChangeSyncMethod(){const s=`set${toUpperCaseFirst(_classPrivateFieldGet$s(_axis,this))}Order`;return c=>{if(_classPrivateFieldGet$s(_indexSyncer,this).isPerformingUndoRedo())return;const u=_classPrivateFieldGet$s(_indexMapper,this).getIndexesSequence();if(c==="update"&&u.length>0){const d=_classPrivateFieldGet$s(_indexesSequence,this).map(m=>u.indexOf(m)),h=_classPrivateFieldGet$s(_indexSyncer,this).getEngine().getSheetDimensions(_classPrivateFieldGet$s(_indexSyncer,this).getSheetId());let f;_classPrivateFieldGet$s(_axis,this)==="row"?f=h.height:f=h.width;const g=d.length;for(let m=g;m<f;m+=1)d.push(m);_classPrivateFieldGet$s(_indexSyncer,this).getEngine()[s](_classPrivateFieldGet$s(_indexSyncer,this).getSheetId(),d)}_classPrivateFieldSet$r(_indexesSequence,this,u)}}init(){_classPrivateFieldSet$r(_indexesSequence,this,_classPrivateFieldGet$s(_indexMapper,this).getIndexesSequence())}}function _classPrivateFieldInitSpec$r(a,s,c){_checkPrivateRedeclaration$w(a,s),s.set(a,c)}function _checkPrivateRedeclaration$w(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$r(a,s){return a.get(_assertClassBrand$w(a,s))}function _classPrivateFieldSet$q(a,s,c){return a.set(_assertClassBrand$w(a,s),c),c}function _assertClassBrand$w(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _rowIndexSyncer=new WeakMap,_columnIndexSyncer=new WeakMap,_postponeAction=new WeakMap,_isPerformingUndo=new WeakMap,_isPerformingRedo=new WeakMap,_engine=new WeakMap,_sheetId=new WeakMap;class IndexSyncer{constructor(s,c,u){_classPrivateFieldInitSpec$r(this,_rowIndexSyncer,void 0),_classPrivateFieldInitSpec$r(this,_columnIndexSyncer,void 0),_classPrivateFieldInitSpec$r(this,_postponeAction,void 0),_classPrivateFieldInitSpec$r(this,_isPerformingUndo,!1),_classPrivateFieldInitSpec$r(this,_isPerformingRedo,!1),_classPrivateFieldInitSpec$r(this,_engine,null),_classPrivateFieldInitSpec$r(this,_sheetId,null),_classPrivateFieldSet$q(_rowIndexSyncer,this,new AxisSyncer("row",s,this)),_classPrivateFieldSet$q(_columnIndexSyncer,this,new AxisSyncer("column",c,this)),_classPrivateFieldSet$q(_postponeAction,this,u)}getForAxis(s){return s==="row"?_classPrivateFieldGet$r(_rowIndexSyncer,this):_classPrivateFieldGet$r(_columnIndexSyncer,this)}setPerformUndo(s){_classPrivateFieldSet$q(_isPerformingUndo,this,s)}setPerformRedo(s){_classPrivateFieldSet$q(_isPerformingRedo,this,s)}isPerformingUndoRedo(){return _classPrivateFieldGet$r(_isPerformingUndo,this)||_classPrivateFieldGet$r(_isPerformingRedo,this)}getSheetId(){return _classPrivateFieldGet$r(_sheetId,this)}getEngine(){return _classPrivateFieldGet$r(_engine,this)}getPostponeAction(){return _classPrivateFieldGet$r(_postponeAction,this)}setupSyncEndpoint(s,c){_classPrivateFieldSet$q(_engine,this,s),_classPrivateFieldSet$q(_sheetId,this,c),_classPrivateFieldGet$r(_rowIndexSyncer,this).init(),_classPrivateFieldGet$r(_columnIndexSyncer,this).init()}}function _classPrivateMethodInitSpec$o(a,s){_checkPrivateRedeclaration$v(a,s),s.add(a)}function _defineProperty$E(a,s,c){return(s=_toPropertyKey$E(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$E(a){var s=_toPrimitive$E(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$E(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldInitSpec$q(a,s,c){_checkPrivateRedeclaration$v(a,s),s.set(a,c)}function _checkPrivateRedeclaration$v(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$p(a,s,c){return a.set(_assertClassBrand$v(a,s),c),c}function _classPrivateFieldGet$q(a,s){return a.get(_assertClassBrand$v(a,s))}function _assertClassBrand$v(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$m="formulas",SETTING_KEYS=["maxRows","maxColumns","language"],PLUGIN_PRIORITY$m=260;Hooks.getSingleton().register("afterNamedExpressionAdded"),Hooks.getSingleton().register("afterNamedExpressionRemoved"),Hooks.getSingleton().register("afterSheetAdded"),Hooks.getSingleton().register("afterSheetRemoved"),Hooks.getSingleton().register("afterSheetRenamed"),Hooks.getSingleton().register("afterFormulasValuesUpdate");const isBlockedSource=a=>a==="UndoRedo.undo"||a==="UndoRedo.redo"||a==="auto";var _internalOperationPending=new WeakMap,_hotWasInitializedWithEmptyData=new WeakMap,_engineListeners=new WeakMap,_Formulas_brand=new WeakSet;class Formulas extends BasePlugin{constructor(){var s;super(...arguments),s=this,_classPrivateMethodInitSpec$o(this,_Formulas_brand),_classPrivateFieldInitSpec$q(this,_internalOperationPending,!1),_classPrivateFieldInitSpec$q(this,_hotWasInitializedWithEmptyData,!1),_classPrivateFieldInitSpec$q(this,_engineListeners,[["valuesUpdated",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$v(_Formulas_brand,s,_onEngineValuesUpdated).call(s,...u)}],["namedExpressionAdded",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$v(_Formulas_brand,s,_onEngineNamedExpressionsAdded).call(s,...u)}],["namedExpressionRemoved",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$v(_Formulas_brand,s,_onEngineNamedExpressionsRemoved).call(s,...u)}],["sheetAdded",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$v(_Formulas_brand,s,_onEngineSheetAdded).call(s,...u)}],["sheetRenamed",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$v(_Formulas_brand,s,_onEngineSheetRenamed).call(s,...u)}],["sheetRemoved",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$v(_Formulas_brand,s,_onEngineSheetRemoved).call(s,...u)}]]),_defineProperty$E(this,"staticRegister",staticRegister("formulas")),_defineProperty$E(this,"engine",null),_defineProperty$E(this,"sheetId",null),_defineProperty$E(this,"sheetName",null),_defineProperty$E(this,"indexSyncer",null),_defineProperty$E(this,"rowAxisSyncer",null),_defineProperty$E(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$m}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$m}static get SETTING_KEYS(){return[PLUGIN_KEY$m,...SETTING_KEYS]}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$m]}enablePlugin(){var s,c=this;if(!this.enabled){if(this.engine=(s=setupEngine(this.hot))!==null&&s!==void 0?s:this.engine,!this.engine){warn$1("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const u=this.addSheet(this.sheetName,_assertClassBrand$v(_Formulas_brand,this,_getProcessedSourceDataArray).call(this));u!==!1&&_assertClassBrand$v(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,u)}this.addHook("beforeLoadData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeLoadData$1).call(c,...d)}),this.addHook("afterLoadData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterLoadData$3).call(c,...d)}),this.addHook("beforeUpdateData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeLoadData$1).call(c,...d)}),this.addHook("afterUpdateData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterLoadData$3).call(c,...d)}),this.addHook("modifyData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onModifyData).call(c,...d)}),this.addHook("modifySourceData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onModifySourceData).call(c,...d)}),this.addHook("beforeValidate",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeValidate).call(c,...d)}),this.addHook("afterSetSourceDataAtCell",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterSetSourceDataAtCell).call(c,...d)}),this.addHook("afterSetDataAtCell",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterSetDataAtCell).call(c,...d)}),this.addHook("afterSetDataAtRowProp",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterSetDataAtCell).call(c,...d)}),this.addHook("beforeCreateRow",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeCreateRow).call(c,...d)}),this.addHook("beforeCreateCol",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeCreateCol).call(c,...d)}),this.addHook("afterCreateRow",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterCreateRow$2).call(c,...d)}),this.addHook("afterCreateCol",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterCreateCol$1).call(c,...d)}),this.addHook("beforeRemoveRow",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeRemoveRow$1).call(c,...d)}),this.addHook("beforeRemoveCol",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeRemoveCol).call(c,...d)}),this.addHook("afterRemoveRow",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterRemoveRow$2).call(c,...d)}),this.addHook("afterRemoveCol",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterRemoveCol$1).call(c,...d)}),this.indexSyncer=new IndexSyncer(this.hot.rowIndexMapper,this.hot.columnIndexMapper,u=>{this.hot.addHookOnce("init",()=>{u()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(u,d,h,f)=>{this.rowAxisSyncer.storeMovesInformation(u,d,f)}),this.hot.addHook("beforeColumnMove",(u,d,h,f)=>{this.columnAxisSyncer.storeMovesInformation(u,d,f)}),this.hot.addHook("afterRowMove",(u,d,h,f,g)=>{this.rowAxisSyncer.calculateAndSyncMoves(f,g)}),this.hot.addHook("afterColumnMove",(u,d,h,f,g)=>{this.columnAxisSyncer.calculateAndSyncMoves(f,g)}),this.hot.addHook("beforeColumnFreeze",(u,d)=>{this.columnAxisSyncer.storeMovesInformation([u],this.hot.getSettings().fixedColumnsStart,d)}),this.hot.addHook("afterColumnFreeze",(u,d)=>{this.columnAxisSyncer.calculateAndSyncMoves(d,d)}),this.hot.addHook("beforeColumnUnfreeze",(u,d)=>{this.columnAxisSyncer.storeMovesInformation([u],this.hot.getSettings().fixedColumnsStart-1,d)}),this.hot.addHook("afterColumnUnfreeze",(u,d)=>{this.columnAxisSyncer.calculateAndSyncMoves(d,d)}),this.addHook("afterCellMetaReset",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterCellMetaReset).call(c,...d)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onAfterDetachChild$1).call(c,...d)}),this.addHook("beforeAutofill",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$v(_Formulas_brand,c,_onBeforeAutofill).call(c,...d)}),_classPrivateFieldGet$q(_engineListeners,this).forEach(u=>{let[d,h]=u;return this.engine.on(d,h)}),super.enablePlugin()}}disablePlugin(){_classPrivateFieldGet$q(_engineListeners,this).forEach(s=>{let[c,u]=s;return this.engine.off(c,u)}),unregisterEngine(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(s){const c=getEngineSettingsWithOverrides(this.hot.getSettings());haveEngineSettingsChanged(this.engine.getConfig(),c)&&this.engine.updateConfig(c);const u=this.hot.getSettings()[PLUGIN_KEY$m];if(isDefined(u)&&isDefined(u.sheetName)&&u.sheetName!==this.sheetName&&this.switchSheet(u.sheetName),!s.data&&this.sheetName===null){const d=this.hot.getSettings()[PLUGIN_KEY$m].sheetName;if(d&&this.engine.doesSheetExist(d))this.switchSheet(this.sheetName);else{const h=this.addSheet(d??void 0,_assertClassBrand$v(_Formulas_brand,this,_getProcessedSourceDataArray).call(this));_assertClassBrand$v(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,h)}}super.updatePlugin(s)}destroy(){_classPrivateFieldGet$q(_engineListeners,this).forEach(s=>{var c;let[u,d]=s;return(c=this.engine)===null||c===void 0?void 0:c.off(u,d)}),_classPrivateFieldSet$p(_engineListeners,this,null),unregisterEngine(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(s,c){if(isDefined(c)&&!isArrayOfArrays(c))return warn$1("The provided data should be an array of arrays."),!1;if(s!=null&&this.engine.doesSheetExist(s))return warn$1("Sheet with the provided name already exists."),!1;try{const u=this.engine.addSheet(s??void 0);return c&&this.engine.setSheetContent(this.engine.getSheetId(u),c),u}catch(u){return warn$1(u.message),!1}}switchSheet(s){if(!this.engine.doesSheetExist(s)){error(`The sheet named \`${s}\` does not exist, switch aborted.`);return}_assertClassBrand$v(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,s);const c=this.engine.getSheetSerialized(this.sheetId);c.length>0&&this.hot.loadData(c,`${toUpperCaseFirst(PLUGIN_KEY$m)}.switchSheet`)}getCellType(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const d=this.hot.toPhysicalRow(s),h=this.hot.toPhysicalColumn(c);return d!==null&&h!==null?this.engine.getCellType({sheet:u,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c)}):"EMPTY"}isFormulaCellType(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:u,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c)})}renderDependentSheets(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const u=new Set;s.forEach(d=>{var h;const f=d==null||(h=d.address)===null||h===void 0?void 0:h.sheet;f!==void 0&&(u.has(f)||u.add(f))}),getRegisteredHotInstances(this.engine).forEach((d,h)=>{if((c||h!==this.sheetId)&&u.has(h)){var f;d.render(),(f=d.view)===null||f===void 0||f.adjustElementsSize()}})}validateDependentCells(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const u=h=>{var f;const{row:g,col:m,sheet:p}=(f=h?.address)!==null&&f!==void 0?f:{};return isDefined(p)?`${p}:${g}x${m}`:""},d=new Set(c.map(h=>u(h)));s.forEach(h=>{var f,g;const{row:m,col:p}=(f=h.address)!==null&&f!==void 0?f:{};if(isDefined(m)===!1||isDefined(p)===!1||m>=this.hot.countRows()||p>=this.hot.countCols())return;const v=h==null||(g=h.address)===null||g===void 0?void 0:g.sheet,w=u(h);if(v!==void 0&&!d.has(w)){const E=getRegisteredHotInstances(this.engine).get(v);if(!E)return;E.validateCell(E.getDataAtCell(m,p),E.getCellMeta(m,p),()=>{})}})}syncChangeWithEngine(s,c,u){const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(c),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){warn$1(`Not possible to set cell data at ${JSON.stringify(d)}`);return}const h=this.hot.getCellMeta(s,c);return isDate(u,h.type)&&(isDateValid(u,h.dateFormat)?u=getDateInHfFormat(u,h.dateFormat):isFormula(u)===!1&&(u=`'${u}`)),this.engine.setCellContents(d,u)}}function _updateSheetNameAndSheetId(a){this.sheetName=a,this.sheetId=this.engine.getSheetId(this.sheetName)}function _getValueGetterValue(a,s,c){if(isObject(c)&&c!==null){const u=this.hot.toVisualRow(a),d=this.hot.toVisualColumn(s),h=this.hot.getCellMeta(u,d).valueGetter;return h?h.call(this.hot,c):c.toString()}return c}function _getProcessedSourceDataArray(a,s,c,u){return this.hot.getSourceDataArray(a,s,c,u).map((d,h)=>d.map((f,g)=>_assertClassBrand$v(_Formulas_brand,this,_getValueGetterValue).call(this,h,g,f)))}function _onBeforeValidate(a,s,c){const u=this.hot.propToCol(c);if(this.isFormulaCellType(s,u)){const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(s),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(u),sheet:this.sheetId},h=this.hot.getCellMeta(s,u);let f=this.engine.getCellValue(d);return h.type==="date"&&isNumeric(f)&&(f=getDateFromExcelDate(f,h.dateFormat)),typeof f=="object"&&f!==null?f.value:f}return a}function _onBeforeAutofill(a,s,c){const{row:u,col:d}=s.getTopStartCorner(),{row:h,col:f}=s.getBottomEndCorner(),{row:g,col:m}=c.getTopStartCorner(),{row:p,col:v}=c.getBottomEndCorner(),w={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(f),sheet:this.sheetId}},E={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(g),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(m),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(p),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(v),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(E)===!1)return!1;const C=this.engine.getFillRangeData(w,E),{row:b,col:P}=w.start,{row:R,col:T}=w.end,I=R-b+1,M=T-P+1;for(let N=0;N<C.length;N+=1)for(let H=0;H<C[N].length;H+=1){const L=C[N][H],A=b+N%I,k=P+H%M,W=this.hot.getCellMeta(A,k);isDate(L,W.type)&&(L.startsWith("'")?C[N][H]=L.slice(1):this.isFormulaCellType(A,k,this.sheetId)===!1&&(C[N][H]=getDateInHotFormat(L,W.dateFormat)))}return C}function _onBeforeLoadData$1(a,s){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(toUpperCaseFirst(PLUGIN_KEY$m))||_classPrivateFieldSet$p(_hotWasInitializedWithEmptyData,this,isUndefined(this.hot.getSettings().data))}function _onAfterCellMetaReset(){if(_classPrivateFieldGet$q(_hotWasInitializedWithEmptyData,this)){this.switchSheet(this.sheetName);return}const a=_assertClassBrand$v(_Formulas_brand,this,_getProcessedSourceDataArray).call(this);a.forEach((c,u)=>{c.forEach((d,h)=>{const f=this.hot.getCellMeta(u,h,{skipMetaExtension:!0}),g=f.dateFormat;isDate(d,f.type)&&(isDateValid(d,g)?a[u][h]=getDateInHfFormat(d,g):d.startsWith("=")||(a[u][h]=`'${d}`))})}),_classPrivateFieldSet$p(_internalOperationPending,this,!0);const s=this.engine.setSheetContent(this.sheetId,a);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(s),_classPrivateFieldSet$p(_internalOperationPending,this,!1)}function _onAfterLoadData$3(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(c.includes(toUpperCaseFirst(PLUGIN_KEY$m)))return;const u=setupSheet(this.engine,this.hot.getSettings()[PLUGIN_KEY$m].sheetName);if(_assertClassBrand$v(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,u),c!=="updateSettings")if(_classPrivateFieldGet$q(_hotWasInitializedWithEmptyData,this))this.switchSheet(this.sheetName);else{const d=_assertClassBrand$v(_Formulas_brand,this,_getProcessedSourceDataArray).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,d)){_classPrivateFieldSet$p(_internalOperationPending,this,!0);const h=this.engine.setSheetContent(this.sheetId,d);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(h),_classPrivateFieldSet$p(_internalOperationPending,this,!1)}}}function _onModifyData(a,s,c,u){if(u!=="get"||_classPrivateFieldGet$q(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||a===null||s===null)return;const d=this.getCellType(a,s);if(d==="VALUE"||d==="EMPTY"){c.value=unescapeFormulaExpression(c.value);return}const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(s),sheet:this.sheetId};let f=this.engine.getCellValue(h);const g=this.hot.getCellMeta(a,s,{skipMetaExtension:!0});g.type==="date"&&isNumeric(f)&&(f=getDateFromExcelDate(f,g.dateFormat)),c.value=typeof f=="object"&&f!==null?f.value:f}function _onModifySourceData(a,s,c,u){if(u!=="get"||_classPrivateFieldGet$q(_internalOperationPending,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const d=this.hot.toVisualRow(a),h=this.hot.propToCol(s);if(d===null||h===null)return;const f=this.getCellType(d,h);if(f==="VALUE"||f==="EMPTY")return;const g=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(g.width===0&&g.height===0)return;const m={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};c.value=this.engine.getCellSerialized(m)}function _onAfterSetDataAtCell(a,s){if(isBlockedSource(s))return;const c=[],u=[],d=this.engine.batch(()=>{a.forEach(h=>{let[f,g,,m]=h;const p=this.hot.propToCol(g),v=this.hot.toPhysicalRow(f),w=this.hot.toPhysicalColumn(p),E={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(f),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(p),sheet:this.sheetId};m=_assertClassBrand$v(_Formulas_brand,this,_getValueGetterValue).call(this,v,w,m),v!==null&&w!==null?this.syncChangeWithEngine(f,p,m):c.push([f,p,m]),u.push({address:E})})});c.length&&this.hot.addHookOnce("afterChange",()=>{const h=this.engine.batch(()=>{c.forEach(f=>{let[g,m,p]=f;this.syncChangeWithEngine(g,m,p)})});this.renderDependentSheets(h,!0)}),this.renderDependentSheets(d),this.validateDependentCells(d,u)}function _onAfterSetSourceDataAtCell(a,s){if(isBlockedSource(s))return;const c=[],u=[];a.forEach(d=>{let[h,f,,g]=d;const m=this.hot.propToCol(f);if(!isNumeric(m))return;const p={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(h),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(m),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(p)){warn$1(`Not possible to set source cell data at ${JSON.stringify(p)}`);return}u.push({address:p}),c.push(...this.engine.setCellContents(p,g))}),this.renderDependentSheets(c),this.validateDependentCells(c,u)}function _onBeforeCreateRow(a,s){let c=this.rowAxisSyncer.getHfIndexFromVisualIndex(a);if(a>=this.hot.countRows()&&(c=a),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[c,s]))return!1}function _onBeforeCreateCol(a,s){let c=this.columnAxisSyncer.getHfIndexFromVisualIndex(a);if(a>=this.hot.countCols()&&(c=a),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[c,s]))return!1}function _onBeforeRemoveRow$1(a,s,c){return this.rowAxisSyncer.setRemovedHfIndexes(c).every(h=>this.engine.isItPossibleToRemoveRows(this.sheetId,[h,1]))===!1?!1:void 0}function _onBeforeRemoveCol(a,s,c){return this.columnAxisSyncer.setRemovedHfIndexes(c).every(h=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[h,1]))===!1?!1:void 0}function _onAfterCreateRow$2(a,s,c){if(isBlockedSource(c))return;const u=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(a),s]);this.renderDependentSheets(u)}function _onAfterCreateCol$1(a,s,c){if(isBlockedSource(c))return;const u=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(a),s]);this.renderDependentSheets(u)}function _onAfterRemoveRow$2(a,s,c,u){if(isBlockedSource(u))return;const d=this.rowAxisSyncer.getRemovedHfIndexes().sort((f,g)=>g-f),h=this.engine.batch(()=>{d.forEach(f=>{this.engine.removeRows(this.sheetId,[f,1])})});this.renderDependentSheets(h)}function _onAfterRemoveCol$1(a,s,c,u){if(isBlockedSource(u))return;const d=this.columnAxisSyncer.getRemovedHfIndexes().sort((f,g)=>g-f),h=this.engine.batch(()=>{d.forEach(f=>{this.engine.removeColumns(this.sheetId,[f,1])})});this.renderDependentSheets(h)}function _onAfterDetachChild$1(a,s,c){var u;_classPrivateFieldSet$p(_internalOperationPending,this,!0);const d=_assertClassBrand$v(_Formulas_brand,this,_getProcessedSourceDataArray).call(this,c,0,c+(((u=s.__children)===null||u===void 0?void 0:u.length)||0),this.hot.countSourceCols());_classPrivateFieldSet$p(_internalOperationPending,this,!1),d.forEach((h,f)=>{h.forEach((g,m)=>{this.engine.setCellContents({col:m,row:c+f,sheet:this.sheetId},[[g]])})})}function _onEngineValuesUpdated(a){this.hot.runHooks("afterFormulasValuesUpdate",a)}function _onEngineNamedExpressionsAdded(a,s){this.hot.runHooks("afterNamedExpressionAdded",a,s)}function _onEngineNamedExpressionsRemoved(a,s){this.hot.runHooks("afterNamedExpressionRemoved",a,s)}function _onEngineSheetAdded(a){this.hot.runHooks("afterSheetAdded",a)}function _onEngineSheetRenamed(a,s){_assertClassBrand$v(_Formulas_brand,this,_updateSheetNameAndSheetId).call(this,s),this.hot.runHooks("afterSheetRenamed",a,s)}function _onEngineSheetRemoved(a,s){this.hot.runHooks("afterSheetRemoved",a,s)}function hideColumnItem(a){return{key:"hidden_columns_hide",name(){const s=this.getSelectedActive();let c=0;if(Array.isArray(s)){const[,u,,d]=s;u-d!==0&&(c=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_COLUMN,c)},callback(){const{from:s,to:c}=this.getSelectedRangeActive(),u=Math.max(Math.min(s.col,c.col),0),d=Math.max(s.col,c.col),h=[];for(let m=u;m<=d;m+=1)h.push(m);a.hideColumns(h);const f=h[h.length-1],g=this.columnIndexMapper.getNearestNotHiddenIndex(f,1,!0);Number.isInteger(g)&&g>=0?this.selectColumns(g):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function showColumnItem(a){const s=[];return{key:"hidden_columns_show",name(){const c=s.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_COLUMN,c)},callback(){var c,u;if(s.length===0)return;let d=s[0],h=s[s.length-1];d=(c=this.columnIndexMapper.getNearestNotHiddenIndex(d-1,-1))!==null&&c!==void 0?c:0,h=(u=this.columnIndexMapper.getNearestNotHiddenIndex(h+1,1))!==null&&u!==void 0?u:this.countCols()-1,a.showColumns(s),this.view.adjustElementsSize(),this.render(),h-d+1===this.countCols()||this.selectColumns(d,h)},disabled:!1,hidden(){const c=arrayMap(a.getHiddenColumns(),w=>this.toPhysicalColumn(w));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||c.length<1)return!0;s.length=0;const u=this.getSelectedRangeActive(),d=u.getTopStartCorner().col,h=u.getBottomEndCorner().col,f=this.columnIndexMapper,g=f.getRenderableFromVisualIndex(d),m=f.getRenderableFromVisualIndex(h),p=f.getNotTrimmedIndexes(),v=[];if(d!==h){const w=h-d+1,E=m-g+1;if(w>E){const C=p.slice(d,h+1);v.push(...C.filter(b=>c.includes(b)))}}else if(g===0&&g<d)v.push(...p.slice(0,d));else if(g===null)v.push(...p.slice(0,this.countCols()));else{const w=this.countCols()-1,E=f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,-1));m===E&&w>h&&v.push(...p.slice(h+1))}return arrayEach(v,w=>{s.push(this.toVisualColumn(w))}),s.length===0}}}function _classPrivateMethodInitSpec$n(a,s){_checkPrivateRedeclaration$u(a,s),s.add(a)}function _classPrivateFieldInitSpec$p(a,s,c){_checkPrivateRedeclaration$u(a,s),s.set(a,c)}function _checkPrivateRedeclaration$u(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$p(a,s){return a.get(_assertClassBrand$u(a,s))}function _classPrivateFieldSet$o(a,s,c){return a.set(_assertClassBrand$u(a,s),c),c}function _assertClassBrand$u(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideColumns"),Hooks.getSingleton().register("afterHideColumns"),Hooks.getSingleton().register("beforeUnhideColumns"),Hooks.getSingleton().register("afterUnhideColumns");const PLUGIN_KEY$l="hiddenColumns",PLUGIN_PRIORITY$l=310;var _hiddenColumnsMap=new WeakMap,_HiddenColumns_brand=new WeakSet;class HiddenColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$n(this,_HiddenColumns_brand),_classPrivateFieldInitSpec$p(this,_hiddenColumnsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$l}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$l}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$l]}enablePlugin(){var s=this;this.enabled||(_classPrivateFieldSet$o(_hiddenColumnsMap,this,new HidingMap),_classPrivateFieldGet$p(_hiddenColumnsMap,this).addLocalHook("init",()=>_assertClassBrand$u(_HiddenColumns_brand,this,_onMapInit$4).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$p(_hiddenColumnsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$u(_HiddenColumns_brand,s,_onAfterContextMenuDefaultOptions$2).call(s,...u)}),this.addHook("afterGetCellMeta",(c,u,d)=>_assertClassBrand$u(_HiddenColumns_brand,this,_onAfterGetCellMeta$2).call(this,c,u,d)),this.addHook("modifyColWidth",(c,u)=>_assertClassBrand$u(_HiddenColumns_brand,this,_onModifyColWidth$3).call(this,c,u),2),this.addHook("afterGetColHeader",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$u(_HiddenColumns_brand,s,_onAfterGetColHeader).call(s,...u)}),this.addHook("modifyCopyableRange",c=>_assertClassBrand$u(_HiddenColumns_brand,this,_onModifyCopyableRange$1).call(this,c)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(s){const c=this.getHiddenColumns(),u=this.isValidConfig(s);let d=c;const h=_classPrivateFieldGet$p(_hiddenColumnsMap,this).getValues().slice(),f=s.length>0;if(u&&f){const m=s.map(p=>this.hot.toPhysicalColumn(p));arrayEach(m,p=>{h[p]=!1}),d=arrayReduce(h,(p,v,w)=>(v&&p.push(this.hot.toVisualColumn(w)),p),[])}this.hot.runHooks("beforeUnhideColumns",c,d,u&&f)!==!1&&(u&&f&&_classPrivateFieldGet$p(_hiddenColumnsMap,this).setValues(h),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",c,d,u&&f,u&&d.length<c.length))}showColumn(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.showColumns(c)}hideColumns(s){const c=this.getHiddenColumns(),u=this.isValidConfig(s);let d=c;u&&(d=Array.from(new Set(c.concat(s)))),this.hot.runHooks("beforeHideColumns",c,d,u)!==!1&&(u&&this.hot.batchExecution(()=>{arrayEach(s,f=>{_classPrivateFieldGet$p(_hiddenColumnsMap,this).setValueAtIndex(this.hot.toPhysicalColumn(f),!0)})},!0),this.hot.runHooks("afterHideColumns",c,d,u,u&&d.length>c.length))}hideColumn(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.hideColumns(c)}getHiddenColumns(){return arrayMap(_classPrivateFieldGet$p(_hiddenColumnsMap,this).getHiddenIndexes(),s=>this.hot.toVisualColumn(s))}isHidden(s){return _classPrivateFieldGet$p(_hiddenColumnsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(s))||!1}isValidConfig(s){const c=this.hot.countCols();return Array.isArray(s)&&s.length>0?s.every(u=>Number.isInteger(u)&&u>=0&&u<c):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),s=>{s.skipColumnOnPaste=!1})}destroy(){_classPrivateFieldSet$o(_hiddenColumnsMap,this,null),super.destroy()}}function _onModifyColWidth$3(a,s){if(this.isHidden(s))return 0;if(this.getSetting("indicators")&&(this.isHidden(s+1)||this.isHidden(s-1))&&typeof a=="number"&&this.hot.hasColHeaders())return a+15}function _onAfterGetCellMeta$2(a,s,c){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(s)&&(c.skipColumnOnPaste=!0),this.isHidden(s-1))c.className=c.className||"",c.className.indexOf("afterHiddenColumn")===-1&&(c.className+=" afterHiddenColumn");else if(c.className){const u=c.className.split(" ");if(u.length>0){const d=u.indexOf("afterHiddenColumn");d>-1&&u.splice(d,1),c.className=u.join(" ")}}}function _onModifyCopyableRange$1(a){if(this.getSetting("copyPasteEnabled"))return a;const s=[],c=(u,d,h,f)=>{s.push({startRow:u,endRow:d,startCol:h,endCol:f})};return arrayEach(a,u=>{let d=!0,h=0;rangeEach(u.startCol,u.endCol,f=>{this.isHidden(f)?(d||c(u.startRow,u.endRow,h,f-1),d=!0):(d&&(h=f),f===u.endCol&&c(u.startRow,u.endRow,h,f),d=!1)})}),s}function _onAfterGetColHeader(a,s){if(!this.getSetting("indicators")||a<0)return;const c=[];a>=1&&this.isHidden(a-1)&&c.push("afterHiddenColumn"),a<this.hot.countCols()-1&&this.isHidden(a+1)&&c.push("beforeHiddenColumn"),addClass$1(s,c)}function _onAfterContextMenuDefaultOptions$2(a){a.items.push({name:KEY$c},hideColumnItem(this),showColumnItem(this))}function _onMapInit$4(){const a=this.getSetting("columns");Array.isArray(a)&&this.hideColumns(a)}function hideRowItem(a){return{key:"hidden_rows_hide",name(){const s=this.getSelectedActive();let c=0;if(Array.isArray(s)){const[u,,d]=s;u-d!==0&&(c=1)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_HIDE_ROW,c)},callback(){const{from:s,to:c}=this.getSelectedRangeActive(),u=Math.max(Math.min(s.row,c.row),0),d=Math.max(s.row,c.row),h=[];for(let m=u;m<=d;m+=1)h.push(m);a.hideRows(h);const f=h[h.length-1],g=this.rowIndexMapper.getNearestNotHiddenIndex(f,1,!0);Number.isInteger(g)&&g>=0?this.selectRows(g):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function showRowItem(a){const s=[];return{key:"hidden_rows_show",name(){const c=s.length>1?1:0;return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_SHOW_ROW,c)},callback(){var c,u;if(s.length===0)return;let d=s[0],h=s[s.length-1];d=(c=this.rowIndexMapper.getNearestNotHiddenIndex(d-1,-1))!==null&&c!==void 0?c:0,h=(u=this.rowIndexMapper.getNearestNotHiddenIndex(h+1,1))!==null&&u!==void 0?u:this.countRows()-1,a.showRows(s),this.view.adjustElementsSize(),this.render(),h-d+1===this.countRows()||this.selectRows(d,h)},disabled:!1,hidden(){const c=arrayMap(a.getHiddenRows(),w=>this.toPhysicalRow(w));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||c.length<1)return!0;s.length=0;const u=this.getSelectedRangeActive(),d=u.getTopStartCorner().row,h=u.getBottomEndCorner().row,f=this.rowIndexMapper,g=f.getRenderableFromVisualIndex(d),m=f.getRenderableFromVisualIndex(h),p=f.getNotTrimmedIndexes(),v=[];if(d!==h){const w=h-d+1,E=m-g+1;if(w>E){const C=p.slice(d,h+1);v.push(...C.filter(b=>c.includes(b)))}}else if(g===0&&g<d)v.push(...p.slice(0,d));else if(g===null)v.push(...p.slice(0,this.countRows()));else{const w=this.countRows()-1,E=f.getRenderableFromVisualIndex(f.getNearestNotHiddenIndex(w,-1));m===E&&w>h&&v.push(...p.slice(h+1))}return arrayEach(v,w=>{s.push(this.toVisualRow(w))}),s.length===0}}}function _classPrivateMethodInitSpec$m(a,s){_checkPrivateRedeclaration$t(a,s),s.add(a)}function _classPrivateFieldInitSpec$o(a,s,c){_checkPrivateRedeclaration$t(a,s),s.set(a,c)}function _checkPrivateRedeclaration$t(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$o(a,s){return a.get(_assertClassBrand$t(a,s))}function _classPrivateFieldSet$n(a,s,c){return a.set(_assertClassBrand$t(a,s),c),c}function _assertClassBrand$t(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeHideRows"),Hooks.getSingleton().register("afterHideRows"),Hooks.getSingleton().register("beforeUnhideRows"),Hooks.getSingleton().register("afterUnhideRows");const PLUGIN_KEY$k="hiddenRows",PLUGIN_PRIORITY$k=320;var _hiddenRowsMap=new WeakMap,_HiddenRows_brand=new WeakSet;class HiddenRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$m(this,_HiddenRows_brand),_classPrivateFieldInitSpec$o(this,_hiddenRowsMap,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$k}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$k}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$k]}enablePlugin(){var s=this;this.enabled||(_classPrivateFieldSet$n(_hiddenRowsMap,this,new HidingMap),_classPrivateFieldGet$o(_hiddenRowsMap,this).addLocalHook("init",()=>_assertClassBrand$t(_HiddenRows_brand,this,_onMapInit$3).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$o(_hiddenRowsMap,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$t(_HiddenRows_brand,s,_onAfterContextMenuDefaultOptions$1).call(s,...u)}),this.addHook("afterGetCellMeta",(c,u,d)=>_assertClassBrand$t(_HiddenRows_brand,this,_onAfterGetCellMeta$1).call(this,c,u,d)),this.addHook("modifyRowHeight",(c,u)=>_assertClassBrand$t(_HiddenRows_brand,this,_onModifyRowHeight$1).call(this,c,u)),this.addHook("afterGetRowHeader",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$t(_HiddenRows_brand,s,_onAfterGetRowHeader$1).call(s,...u)}),this.addHook("modifyCopyableRange",c=>_assertClassBrand$t(_HiddenRows_brand,this,_onModifyCopyableRange).call(this,c)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(s){const c=this.getHiddenRows(),u=this.isValidConfig(s);let d=c;const h=_classPrivateFieldGet$o(_hiddenRowsMap,this).getValues().slice(),f=s.length>0;if(u&&f){const m=s.map(p=>this.hot.toPhysicalRow(p));arrayEach(m,p=>{h[p]=!1}),d=arrayReduce(h,(p,v,w)=>(v&&p.push(this.hot.toVisualRow(w)),p),[])}this.hot.runHooks("beforeUnhideRows",c,d,u&&f)!==!1&&(u&&f&&_classPrivateFieldGet$o(_hiddenRowsMap,this).setValues(h),this.hot.runHooks("afterUnhideRows",c,d,u&&f,u&&d.length<c.length))}showRow(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.showRows(c)}hideRows(s){const c=this.getHiddenRows(),u=this.isValidConfig(s);let d=c;u&&(d=Array.from(new Set(c.concat(s)))),this.hot.runHooks("beforeHideRows",c,d,u)!==!1&&(u&&this.hot.batchExecution(()=>{arrayEach(s,f=>{_classPrivateFieldGet$o(_hiddenRowsMap,this).setValueAtIndex(this.hot.toPhysicalRow(f),!0)})},!0),this.hot.runHooks("afterHideRows",c,d,u,u&&d.length>c.length))}hideRow(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.hideRows(c)}getHiddenRows(){return arrayMap(_classPrivateFieldGet$o(_hiddenRowsMap,this).getHiddenIndexes(),s=>this.hot.toVisualRow(s))}isHidden(s){return _classPrivateFieldGet$o(_hiddenRowsMap,this).getValueAtIndex(this.hot.toPhysicalRow(s))||!1}isValidConfig(s){const c=this.hot.countRows();return Array.isArray(s)&&s.length>0?s.every(u=>Number.isInteger(u)&&u>=0&&u<c):!1}resetCellsMeta(){arrayEach(this.hot.getCellsMeta(),s=>{s.skipRowOnPaste=!1})}destroy(){_classPrivateFieldSet$n(_hiddenRowsMap,this,null),super.destroy()}}function _onModifyRowHeight$1(a,s){return this.isHidden(s)?0:a}function _onAfterGetCellMeta$1(a,s,c){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(a)&&(c.skipRowOnPaste=!0),this.isHidden(a-1))c.className=c.className||"",c.className.indexOf("afterHiddenRow")===-1&&(c.className+=" afterHiddenRow");else if(c.className){const u=c.className.split(" ");if(u.length>0){const d=u.indexOf("afterHiddenRow");d>-1&&u.splice(d,1),c.className=u.join(" ")}}}function _onModifyCopyableRange(a){if(this.getSetting("copyPasteEnabled"))return a;const s=[],c=(u,d,h,f)=>{s.push({startRow:u,endRow:d,startCol:h,endCol:f})};return arrayEach(a,u=>{let d=!0,h=0;rangeEach(u.startRow,u.endRow,f=>{this.isHidden(f)?(d||c(h,f-1,u.startCol,u.endCol),d=!0):(d&&(h=f),f===u.endRow&&c(h,f,u.startCol,u.endCol),d=!1)})}),s}function _onAfterGetRowHeader$1(a,s){if(!this.getSetting("indicators")||a<0)return;const c=[];a>=1&&this.isHidden(a-1)&&c.push("afterHiddenRow"),a<this.hot.countRows()-1&&this.isHidden(a+1)&&c.push("beforeHiddenRow"),addClass$1(s,c)}function _onAfterContextMenuDefaultOptions$1(a){a.items.push({name:KEY$c},hideRowItem(this),showRowItem(this))}function _onMapInit$3(){const a=this.getSetting("rows");Array.isArray(a)&&this.hideRows(a)}function freezeColumnItem(a){return{key:"freeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_FREEZE_COLUMN)},callback(s,c){const[{start:{col:u}}]=c;a.freezeColumn(u),this.view.adjustElementsSize(),this.render()},hidden(){const s=this.getSelectedRange();let c=!1;return(s===void 0||s.length>1||s[0].from.col!==s[0].to.col||s[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(c=!0),c}}}function unfreezeColumnItem(a){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNFREEZE_COLUMN)},callback(s,c){const[{start:{col:u}}]=c;a.unfreezeColumn(u),this.view.adjustElementsSize(),this.render()},hidden(){const s=this.getSelectedRange();let c=!1;return(s===void 0||s.length>1||s[0].from.col!==s[0].to.col||s[0].from.col>=this.getSettings().fixedColumnsStart)&&(c=!0),c}}}function _classPrivateMethodInitSpec$l(a,s){_checkPrivateRedeclaration$s(a,s),s.add(a)}function _classPrivateFieldInitSpec$n(a,s,c){_checkPrivateRedeclaration$s(a,s),s.set(a,c)}function _checkPrivateRedeclaration$s(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$n(a,s){return a.get(_assertClassBrand$s(a,s))}function _classPrivateFieldSet$m(a,s,c){return a.set(_assertClassBrand$s(a,s),c),c}function _assertClassBrand$s(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnFreeze"),Hooks.getSingleton().register("afterColumnFreeze"),Hooks.getSingleton().register("beforeColumnUnfreeze"),Hooks.getSingleton().register("afterColumnUnfreeze");const PLUGIN_KEY$j="manualColumnFreeze",PLUGIN_PRIORITY$j=110;var _afterFirstUse=new WeakMap,_ManualColumnFreeze_brand=new WeakSet;class ManualColumnFreeze extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$l(this,_ManualColumnFreeze_brand),_classPrivateFieldInitSpec$n(this,_afterFirstUse,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$j}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$j}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$j]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",s=>_assertClassBrand$s(_ManualColumnFreeze_brand,this,_addContextMenuEntry).call(this,s)),this.addHook("beforeColumnMove",(s,c)=>_assertClassBrand$s(_ManualColumnFreeze_brand,this,_onBeforeColumnMove).call(this,s,c)),super.enablePlugin())}disablePlugin(){_classPrivateFieldSet$m(_afterFirstUse,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(s){const c=this.hot.getSettings(),u=c.fixedColumnsStart<this.hot.countCols()&&s>c.fixedColumnsStart-1;_classPrivateFieldGet$n(_afterFirstUse,this)||_classPrivateFieldSet$m(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnFreeze",s,u)!==!1&&(u&&(this.hot.columnIndexMapper.moveIndexes(s,c.fixedColumnsStart),c._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",s,u))}unfreezeColumn(s){const c=this.hot.getSettings(),u=c.fixedColumnsStart>0&&s<=c.fixedColumnsStart-1;_classPrivateFieldGet$n(_afterFirstUse,this)||_classPrivateFieldSet$m(_afterFirstUse,this,!0),this.hot.runHooks("beforeColumnUnfreeze",s,u)!==!1&&(u&&(c._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(s,c.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",s,u))}}function _addContextMenuEntry(a){a.items.push({name:"---------"},freezeColumnItem(this),unfreezeColumnItem(this))}function _onBeforeColumnMove(a,s){if(_classPrivateFieldGet$n(_afterFirstUse,this)){const c=this.hot.getSettings().fixedColumnsStart;if(s<c||a.some(u=>u<c))return!1}}function _defineProperty$D(a,s,c){return(s=_toPropertyKey$D(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$D(a){var s=_toPrimitive$D(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$D(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const STATE_INITIALIZED$1=0,STATE_BUILT$1=1,STATE_APPENDED$1=2,UNIT$1="px";let BaseUI$2=class{constructor(s){_defineProperty$D(this,"hot",void 0),_defineProperty$D(this,"_element",null),_defineProperty$D(this,"state",STATE_INITIALIZED$1),_defineProperty$D(this,"inlineProperty",void 0),this.hot=s,this.inlineProperty=s.isRtl()?"right":"left"}appendTo(s){s.appendChild(this._element),this.state=STATE_APPENDED$1}build(){this.state===STATE_INITIALIZED$1&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT$1)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED$1}isAppended(){return this.state===STATE_APPENDED$1}isBuilt(){return this.state>=STATE_BUILT$1}setPosition(s,c){isNumeric(s)&&(this._element.style.top=s+UNIT$1),isNumeric(c)&&(this._element.style[this.inlineProperty]=c+UNIT$1)}getPosition(){const s=this._element.style;return{top:s.top?parseInt(s.top,10):0,start:s[this.inlineProperty]?parseInt(s[this.inlineProperty],10):0}}setSize(s,c){isNumeric(s)&&(this._element.style.width=s+UNIT$1),isNumeric(c)&&(this._element.style.height=c+UNIT$1)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(s,c){isNumeric(s)&&(this._element.style.marginTop=s+UNIT$1),isNumeric(c)&&(this._element.style[`margin${toUpperCaseFirst(this.inlineProperty)}`]=c+UNIT$1)}getOffset(){const s=this._element.style,c=`margin${toUpperCaseFirst(this.inlineProperty)}`;return{top:s.marginTop?parseInt(s.marginTop,10):0,start:s[c]?parseInt(s[c],10):0}}};const CSS_CLASSNAME$3="ht__manualColumnMove--backlight";let BacklightUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$3)}};const CSS_CLASSNAME$2="ht__manualColumnMove--guideline";let GuidelineUI$1=class extends BaseUI$2{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$2)}};function _classPrivateMethodInitSpec$k(a,s){_checkPrivateRedeclaration$r(a,s),s.add(a)}function _classPrivateFieldInitSpec$m(a,s,c){_checkPrivateRedeclaration$r(a,s),s.set(a,c)}function _checkPrivateRedeclaration$r(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$l(a,s,c){return a.set(_assertClassBrand$r(a,s),c),c}function _classPrivateFieldGet$m(a,s){return a.get(_assertClassBrand$r(a,s))}function _assertClassBrand$r(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeColumnMove"),Hooks.getSingleton().register("afterColumnMove");const PLUGIN_KEY$i="manualColumnMove",PLUGIN_PRIORITY$i=120,CSS_PLUGIN$1="ht__manualColumnMove",CSS_SHOW_UI$1="show-ui",CSS_ON_MOVING$1="on-moving--columns",CSS_AFTER_SELECTION$1="after-selection--columns";var _backlight$1=new WeakMap,_guideline$1=new WeakMap,_columnsToMove=new WeakMap,_countCols=new WeakMap,_pressed$3=new WeakMap,_target$1=new WeakMap,_cachedDropIndex$1=new WeakMap,_hoveredColumn=new WeakMap,_rootElementOffset=new WeakMap,_hasRowHeaders=new WeakMap,_fixedColumnsStart=new WeakMap,_ManualColumnMove_brand=new WeakSet;class ManualColumnMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$k(this,_ManualColumnMove_brand),_classPrivateFieldInitSpec$m(this,_backlight$1,new BacklightUI$1(this.hot)),_classPrivateFieldInitSpec$m(this,_guideline$1,new GuidelineUI$1(this.hot)),_classPrivateFieldInitSpec$m(this,_columnsToMove,[]),_classPrivateFieldInitSpec$m(this,_countCols,0),_classPrivateFieldInitSpec$m(this,_pressed$3,!1),_classPrivateFieldInitSpec$m(this,_target$1,{}),_classPrivateFieldInitSpec$m(this,_cachedDropIndex$1,void 0),_classPrivateFieldInitSpec$m(this,_hoveredColumn,void 0),_classPrivateFieldInitSpec$m(this,_rootElementOffset,void 0),_classPrivateFieldInitSpec$m(this,_hasRowHeaders,void 0),_classPrivateFieldInitSpec$m(this,_fixedColumnsStart,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$i}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$i}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$i]}enablePlugin(){var s=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$r(_ManualColumnMove_brand,s,_onBeforeOnCellMouseDown$3).call(s,...u)}),this.addHook("beforeOnCellMouseOver",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$r(_ManualColumnMove_brand,s,_onBeforeOnCellMouseOver$2).call(s,...u)}),this.addHook("afterScrollVertically",()=>_assertClassBrand$r(_ManualColumnMove_brand,this,_onAfterScrollVertically$1).call(this)),this.addHook("afterLoadData",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$r(_ManualColumnMove_brand,s,_onAfterLoadData$2).call(s,...u)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN$1),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN$1),this.unregisterEvents(),_classPrivateFieldGet$m(_backlight$1,this).destroy(),_classPrivateFieldGet$m(_guideline$1,this).destroy(),super.disablePlugin()}moveColumn(s,c){return this.moveColumns([s],c)}moveColumns(s,c){const u=_classPrivateFieldGet$m(_cachedDropIndex$1,this),d=this.isMovePossible(s,c),h=this.hot.runHooks("beforeColumnMove",s,c,u,d);if(_classPrivateFieldSet$l(_cachedDropIndex$1,this,void 0),h===!1)return;d&&this.hot.columnIndexMapper.moveIndexes(s,c);const f=d&&this.isColumnOrderChanged(s,c);return this.hot.runHooks("afterColumnMove",s,c,u,d,f),f}dragColumn(s,c){return this.dragColumns([s],c)}dragColumns(s,c){const u=this.countFinalIndex(s,c);return _classPrivateFieldSet$l(_cachedDropIndex$1,this,c),this.moveColumns(s,u)}isMovePossible(s,c){const u=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),d=s.length+c>u,h=c<0,f=s.some(m=>m<0),g=s.some(m=>m>=u);return!(d||h||f||g)}isColumnOrderChanged(s,c){return s.some((u,d)=>u-d!==c)}countFinalIndex(s,c){const u=arrayReduce(s,(d,h)=>(h<c&&(d+=1),d),0);return c-u}getColumnsWidth(s,c){const u=this.hot.columnIndexMapper;let d=0;for(let h=s;h<=c;h+=1){const f=u.getRenderableFromVisualIndex(h);h<0?d+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:f!==null&&(d+=this.hot.view._wt.wtTable.getColumnWidth(f)||0)}return d}moveBySettingsOrLoad(){const s=this.hot.getSettings()[PLUGIN_KEY$i];if(Array.isArray(s))this.moveColumns(s,0);else if(s!==void 0){const c=this.persistentStateLoad();c.length&&this.moveColumns(c,0)}}isFixedColumnsStart(s){return s<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const s={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",s),s.value?s.value:[]}prepareColumnsToMoving(s,c){const u=[];return rangeEach(s,c,d=>{u.push(d)}),u}refreshPositions(){const s=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(_classPrivateFieldGet$m(_hoveredColumn,this))&&s>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(s-1,-1)});const c=this.hot.view._wt.wtTable,u=this.hot.view._wt.wtOverlays.scrollableElement,d=typeof u.scrollX=="number"?u.scrollX:u.scrollLeft;let h=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,_classPrivateFieldGet$m(_hoveredColumn,this)-1);const f=c.hider.offsetWidth,g=c.TBODY.offsetLeft,m=_classPrivateFieldGet$m(_backlight$1,this).getOffset().start,p=_classPrivateFieldGet$m(_backlight$1,this).getSize().width;let v=0,w=0;if(this.hot.isRtl()){const b=this.hot.rootWindow,P=outerWidth(this.hot.rootElement),R=b.innerWidth-_classPrivateFieldGet$m(_rootElementOffset,this)-P;w=b.innerWidth-_classPrivateFieldGet$m(_target$1,this).eventPageX-R-(u.scrollX===void 0?d:0)}else w=_classPrivateFieldGet$m(_target$1,this).eventPageX-(_classPrivateFieldGet$m(_rootElementOffset,this)-(u.scrollX===void 0?d:0));if(_classPrivateFieldGet$m(_hasRowHeaders,this)&&(v=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(_classPrivateFieldGet$m(_hoveredColumn,this))&&(h+=d),h+=v,_classPrivateFieldGet$m(_hoveredColumn,this)<0)_classPrivateFieldGet$m(_fixedColumnsStart,this)>0?_classPrivateFieldGet$m(_target$1,this).col=0:_classPrivateFieldGet$m(_target$1,this).col=s>0?s-1:s;else if(_classPrivateFieldGet$m(_target$1,this).TD.offsetWidth/2+h<=w){const b=_classPrivateFieldGet$m(_hoveredColumn,this)>=_classPrivateFieldGet$m(_countCols,this)?_classPrivateFieldGet$m(_countCols,this)-1:_classPrivateFieldGet$m(_hoveredColumn,this);_classPrivateFieldGet$m(_target$1,this).col=b+1,h+=_classPrivateFieldGet$m(_target$1,this).TD.offsetWidth}else _classPrivateFieldGet$m(_target$1,this).col=_classPrivateFieldGet$m(_hoveredColumn,this);let E=w,C=h;w+p+m>=f?E=f-p-m:w+m<g+v&&(E=g+v+Math.abs(m)),h>=f-1?C=f-1:C===0?C=1:u.scrollX!==void 0&&_classPrivateFieldGet$m(_hoveredColumn,this)<_classPrivateFieldGet$m(_fixedColumnsStart,this)&&(C-=_classPrivateFieldGet$m(_rootElementOffset,this)<=u.scrollX?_classPrivateFieldGet$m(_rootElementOffset,this):0),_classPrivateFieldGet$m(_backlight$1,this).setPosition(null,E),_classPrivateFieldGet$m(_guideline$1,this).setPosition(null,C)}registerEvents(){const{documentElement:s}=this.hot.rootDocument;this.eventManager.addEventListener(s,"mousemove",c=>_assertClassBrand$r(_ManualColumnMove_brand,this,_onMouseMove$3).call(this,c)),this.eventManager.addEventListener(s,"mouseup",()=>_assertClassBrand$r(_ManualColumnMove_brand,this,_onMouseUp$3).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$m(_backlight$1,this).build(),_classPrivateFieldGet$m(_guideline$1,this).build()}destroy(){_classPrivateFieldGet$m(_backlight$1,this).destroy(),_classPrivateFieldGet$m(_guideline$1,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$3(a,s,c,u){const d=this.hot.view._wt.wtTable,h=this.hot.selection.isSelectedByColumnHeader(),f=this.hot.getSelectedRangeActive(),g=hasClass$1(a.target,"sortAction");if(!f||!h||_classPrivateFieldGet$m(_pressed$3,this)||a.button!==0||g){_classPrivateFieldSet$l(_pressed$3,this,!1),_classPrivateFieldGet$m(_columnsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1]);return}const m=_classPrivateFieldGet$m(_guideline$1,this).isBuilt()&&!_classPrivateFieldGet$m(_guideline$1,this).isAppended(),p=_classPrivateFieldGet$m(_backlight$1,this).isBuilt()&&!_classPrivateFieldGet$m(_backlight$1,this).isAppended();m&&p&&(_classPrivateFieldGet$m(_guideline$1,this).appendTo(d.hider),_classPrivateFieldGet$m(_backlight$1,this).appendTo(d.hider));const{from:v,to:w}=f,E=Math.min(v.col,w.col),C=Math.max(v.col,w.col);if(s.row<0&&s.col>=E&&s.col<=C){u.column=!0,_classPrivateFieldSet$l(_pressed$3,this,!0);const b=c.firstChild?offsetRelativeTo(a,c.firstChild).x:a.offsetX;_classPrivateFieldGet$m(_target$1,this).eventPageX=a.pageX,_classPrivateFieldSet$l(_hoveredColumn,this,s.col),_classPrivateFieldGet$m(_target$1,this).TD=c,_classPrivateFieldGet$m(_target$1,this).col=s.col,_classPrivateFieldSet$l(_columnsToMove,this,this.prepareColumnsToMoving(E,C)),_classPrivateFieldSet$l(_hasRowHeaders,this,!!this.hot.getSettings().rowHeaders),_classPrivateFieldSet$l(_countCols,this,this.hot.countCols()),_classPrivateFieldSet$l(_fixedColumnsStart,this,this.hot.getSettings().fixedColumnsStart),_classPrivateFieldSet$l(_rootElementOffset,this,offset(this.hot.rootElement).left);const P=_classPrivateFieldGet$m(_hasRowHeaders,this)?-1:0,R=d.holder.scrollTop+d.getColumnHeaderHeight(0)+1,T=s.col<_classPrivateFieldGet$m(_fixedColumnsStart,this),I=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),M=Math.abs(b-(this.hot.isRtl()?c.offsetWidth:0)),N=this.getColumnsWidth(E,s.col-1)+M,H=this.getColumnsWidth(P,E-1)+(T?I:0)+N;_classPrivateFieldGet$m(_backlight$1,this).setPosition(R,H),_classPrivateFieldGet$m(_backlight$1,this).setSize(this.getColumnsWidth(E,C),d.hider.offsetHeight-R),_classPrivateFieldGet$m(_backlight$1,this).setOffset(null,-N),addClass$1(this.hot.rootElement,CSS_ON_MOVING$1)}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),_classPrivateFieldSet$l(_pressed$3,this,!1),_classPrivateFieldGet$m(_columnsToMove,this).length=0}function _onMouseMove$3(a){_classPrivateFieldGet$m(_pressed$3,this)&&(_classPrivateFieldGet$m(_target$1,this).eventPageX=a.pageX,this.refreshPositions())}function _onBeforeOnCellMouseOver$2(a,s,c,u){!this.hot.getSelectedRangeActive()||!_classPrivateFieldGet$m(_pressed$3,this)||(_classPrivateFieldGet$m(_columnsToMove,this).indexOf(s.col)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI$1):addClass$1(this.hot.rootElement,CSS_SHOW_UI$1),u.row=!0,u.column=!0,u.cell=!0,_classPrivateFieldSet$l(_hoveredColumn,this,s.col),_classPrivateFieldGet$m(_target$1,this).TD=c)}function _onMouseUp$3(){const a=_classPrivateFieldGet$m(_target$1,this).col,s=_classPrivateFieldGet$m(_columnsToMove,this).length;if(_classPrivateFieldSet$l(_hoveredColumn,this,void 0),_classPrivateFieldSet$l(_pressed$3,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING$1,CSS_SHOW_UI$1,CSS_AFTER_SELECTION$1]),this.hot.selection.isSelectedByColumnHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION$1),s<1||a===void 0)return;const c=_classPrivateFieldGet$m(_columnsToMove,this)[0],u=this.hot.toPhysicalColumn(c),d=this.dragColumns(_classPrivateFieldGet$m(_columnsToMove,this),a);if(_classPrivateFieldGet$m(_columnsToMove,this).length=0,d===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const h=this.hot.toVisualColumn(u),f=h+s-1;this.hot.selectColumns(h,f)}}function _onAfterScrollVertically$1(){const a=this.hot.view._wt.wtTable,s=a.getColumnHeaderHeight(0)+1,c=a.holder.scrollTop,u=s+c;_classPrivateFieldGet$m(_backlight$1,this).setPosition(u),_classPrivateFieldGet$m(_backlight$1,this).setSize(null,a.hider.offsetHeight-u)}function _onAfterLoadData$2(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$j(a,s){_checkPrivateRedeclaration$q(a,s),s.add(a)}function _classPrivateFieldInitSpec$l(a,s,c){_checkPrivateRedeclaration$q(a,s),s.set(a,c)}function _checkPrivateRedeclaration$q(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$k(a,s,c){return a.set(_assertClassBrand$q(a,s),c),c}function _classPrivateFieldGet$l(a,s){return a.get(_assertClassBrand$q(a,s))}function _assertClassBrand$q(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$h="manualColumnResize",PLUGIN_PRIORITY$h=130,PERSISTENT_STATE_KEY$1="manualColumnWidths";var _currentTH$1=new WeakMap,_currentCol=new WeakMap,_selectedCols=new WeakMap,_currentWidth=new WeakMap,_newSize$1=new WeakMap,_startY$1=new WeakMap,_startWidth=new WeakMap,_startOffset$1=new WeakMap,_handle$1=new WeakMap,_guide$1=new WeakMap,_pressed$2=new WeakMap,_isTriggeredByRMB$1=new WeakMap,_dblclick$1=new WeakMap,_autoresizeTimeout$1=new WeakMap,_columnWidthsMap=new WeakMap,_config$1=new WeakMap,_ManualColumnResize_brand=new WeakSet;class ManualColumnResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$h}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$h}constructor(s){super(s),_classPrivateMethodInitSpec$j(this,_ManualColumnResize_brand),_classPrivateFieldInitSpec$l(this,_currentTH$1,null),_classPrivateFieldInitSpec$l(this,_currentCol,null),_classPrivateFieldInitSpec$l(this,_selectedCols,[]),_classPrivateFieldInitSpec$l(this,_currentWidth,null),_classPrivateFieldInitSpec$l(this,_newSize$1,null),_classPrivateFieldInitSpec$l(this,_startY$1,null),_classPrivateFieldInitSpec$l(this,_startWidth,null),_classPrivateFieldInitSpec$l(this,_startOffset$1,null),_classPrivateFieldInitSpec$l(this,_handle$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$l(this,_guide$1,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$l(this,_pressed$2,null),_classPrivateFieldInitSpec$l(this,_isTriggeredByRMB$1,!1),_classPrivateFieldInitSpec$l(this,_dblclick$1,0),_classPrivateFieldInitSpec$l(this,_autoresizeTimeout$1,null),_classPrivateFieldInitSpec$l(this,_columnWidthsMap,void 0),_classPrivateFieldInitSpec$l(this,_config$1,void 0),addClass$1(_classPrivateFieldGet$l(_handle$1,this),"manualColumnResizer"),addClass$1(_classPrivateFieldGet$l(_guide$1,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$h]}enablePlugin(){var s=this;this.enabled||(_classPrivateFieldSet$k(_columnWidthsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$l(_columnWidthsMap,this).addLocalHook("init",()=>_assertClassBrand$q(_ManualColumnResize_brand,this,_onMapInit$2).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$l(_columnWidthsMap,this)),this.addHook("modifyColWidth",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$q(_ManualColumnResize_brand,s,_onModifyColWidth$2).call(s,...u)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$q(_ManualColumnResize_brand,s,_onBeforeStretchingColumnWidth).call(s,...u)},1),this.addHook("beforeColumnResize",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$q(_ManualColumnResize_brand,s,_onBeforeColumnResize).call(s,...u)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$k(_config$1,this,_classPrivateFieldGet$l(_columnWidthsMap,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY$1,_classPrivateFieldGet$l(_columnWidthsMap,this).getValues())}loadManualColumnWidths(){const s={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY$1,s),s.value}setManualSize(s,c){const u=Math.max(c,20),d=this.hot.toPhysicalColumn(s);return _classPrivateFieldGet$l(_columnWidthsMap,this).setValueAtIndex(d,u),u}clearManualSize(s){const c=this.hot.toPhysicalColumn(s);_classPrivateFieldGet$l(_columnWidthsMap,this).setValueAtIndex(c,null)}setupHandlePosition(s){if(!s.parentNode||_classPrivateFieldGet$l(_dblclick$1,this)>1)return;_classPrivateFieldSet$k(_currentTH$1,this,s);const{_wt:c}=this.hot.view,u=c.wtTable.getCoords(_classPrivateFieldGet$l(_currentTH$1,this)),d=u.col;if(d<0)return;const h=outerHeight(_classPrivateFieldGet$l(_currentTH$1,this)),f=_classPrivateFieldGet$l(_currentTH$1,this).getBoundingClientRect(),g=d<c.getSetting("fixedColumnsStart");let m;g&&(m=c.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$l(_currentTH$1,this),u.row,u.col)),m||(m=c.wtOverlays.topOverlay.getRelativeCellPosition(_classPrivateFieldGet$l(_currentTH$1,this),u.row,u.col)),_classPrivateFieldSet$k(_currentCol,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(d)),_classPrivateFieldSet$k(_selectedCols,this,[]);const p=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&p){const v=this.hot.getSelectedRange();arrayEach(v,w=>{const E=w.getTopStartCorner().col,C=w.getBottomEndCorner().col;rangeEach(E,C,b=>{_classPrivateFieldGet$l(_selectedCols,this).includes(b)||_classPrivateFieldGet$l(_selectedCols,this).push(b)})})}_classPrivateFieldGet$l(_selectedCols,this).includes(_classPrivateFieldGet$l(_currentCol,this))||_classPrivateFieldSet$k(_selectedCols,this,[_classPrivateFieldGet$l(_currentCol,this)]),_classPrivateFieldSet$k(_startOffset$1,this,m.start-6),_classPrivateFieldSet$k(_startWidth,this,parseInt(f.width,10)),_classPrivateFieldGet$l(_handle$1,this).style.top=`${m.top}px`,_classPrivateFieldGet$l(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$l(_startOffset$1,this)+_classPrivateFieldGet$l(_startWidth,this)}px`,_classPrivateFieldGet$l(_handle$1,this).style.height=`${h}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$l(_handle$1,this))}refreshHandlePosition(){_classPrivateFieldGet$l(_handle$1,this).style[this.inlineDir]=`${_classPrivateFieldGet$l(_startOffset$1,this)+_classPrivateFieldGet$l(_currentWidth,this)}px`}setupGuidePosition(){const s=parseInt(outerHeight(_classPrivateFieldGet$l(_handle$1,this)),10),c=parseInt(_classPrivateFieldGet$l(_handle$1,this).style.top,10)+s,u=this.hot.view.getTableHeight();addClass$1(_classPrivateFieldGet$l(_handle$1,this),"active"),addClass$1(_classPrivateFieldGet$l(_guide$1,this),"active"),_classPrivateFieldGet$l(_guide$1,this).style.top=`${c}px`,this.refreshGuidePosition(),_classPrivateFieldGet$l(_guide$1,this).style.height=`${u-s}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$l(_guide$1,this))}refreshGuidePosition(){_classPrivateFieldGet$l(_guide$1,this).style[this.inlineDir]=_classPrivateFieldGet$l(_handle$1,this).style[this.inlineDir]}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$l(_handle$1,this),"active"),removeClass$1(_classPrivateFieldGet$l(_guide$1,this),"active")}checkIfColumnHeader(s){const c=closest(s,["THEAD"],this.hot.rootElement),{topOverlay:u,topInlineStartCornerOverlay:d}=this.hot.view._wt.wtOverlays;return[u.clone.wtTable.THEAD,d.clone.wtTable.THEAD].includes(c)}getClosestTHParent(s){return s.tagName!=="TABLE"?s.tagName==="TH"?s:this.getClosestTHParent(s.parentNode):null}afterMouseDownTimeout(){const s=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},c=(u,d)=>{const h=this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$l(_newSize$1,this),u,!0);h!==void 0&&_classPrivateFieldSet$k(_newSize$1,this,h),this.setManualSize(u,_classPrivateFieldGet$l(_newSize$1,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$l(_newSize$1,this),u,!0),d&&s()};_classPrivateFieldGet$l(_dblclick$1,this)>=2&&(_classPrivateFieldGet$l(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$l(_selectedCols,this),d=>{c(d)}),s()):arrayEach(_classPrivateFieldGet$l(_selectedCols,this),d=>{c(d,!0)})),_classPrivateFieldSet$k(_dblclick$1,this,0),_classPrivateFieldSet$k(_autoresizeTimeout$1,this,null)}bindEvents(){const{rootWindow:s,rootElement:c}=this.hot;this.eventManager.addEventListener(c,"mouseover",u=>_assertClassBrand$q(_ManualColumnResize_brand,this,_onMouseOver$1).call(this,u)),this.eventManager.addEventListener(c,"mousedown",u=>_assertClassBrand$q(_ManualColumnResize_brand,this,_onMouseDown$1).call(this,u)),this.eventManager.addEventListener(s,"mousemove",u=>_assertClassBrand$q(_ManualColumnResize_brand,this,_onMouseMove$2).call(this,u)),this.eventManager.addEventListener(s,"mouseup",()=>_assertClassBrand$q(_ManualColumnResize_brand,this,_onMouseUp$2).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$l(_handle$1,this),"contextmenu",()=>_assertClassBrand$q(_ManualColumnResize_brand,this,_onContextMenu$1).call(this))}destroy(){super.destroy()}}function _onMapInit$2(){const a=this.hot.getSettings()[PLUGIN_KEY$h],s=this.loadManualColumnWidths();typeof s<"u"?this.hot.batchExecution(()=>{s.forEach((c,u)=>{_classPrivateFieldGet$l(_columnWidthsMap,this).setValueAtIndex(u,c)})},!0):Array.isArray(a)?(this.hot.batchExecution(()=>{a.forEach((c,u)=>{_classPrivateFieldGet$l(_columnWidthsMap,this).setValueAtIndex(u,c)})},!0),_classPrivateFieldSet$k(_config$1,this,a)):a===!0&&Array.isArray(_classPrivateFieldGet$l(_config$1,this))&&this.hot.batchExecution(()=>{_classPrivateFieldGet$l(_config$1,this).forEach((c,u)=>{_classPrivateFieldGet$l(_columnWidthsMap,this).setValueAtIndex(u,c)})},!0)}function _onMouseOver$1(a){if(!isDetached(a.target)&&_classPrivateFieldGet$l(_isTriggeredByRMB$1,this)!==!0&&this.checkIfColumnHeader(a.target)){const s=this.getClosestTHParent(a.target);if(!s)return;const c=s.getAttribute("colspan");s&&(c===null||c==="1")&&(_classPrivateFieldGet$l(_pressed$2,this)||this.setupHandlePosition(s))}}function _onMouseDown$1(a){a.target.parentNode===this.hot.rootElement&&hasClass$1(a.target,"manualColumnResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$l(_currentTH$1,this)),this.setupGuidePosition(),_classPrivateFieldSet$k(_pressed$2,this,!0),_classPrivateFieldGet$l(_autoresizeTimeout$1,this)===null&&(_classPrivateFieldSet$k(_autoresizeTimeout$1,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$l(_autoresizeTimeout$1,this))),_classPrivateFieldSet$k(_dblclick$1,this,_classPrivateFieldGet$l(_dblclick$1,this)+1),this.startX=a.pageX,_classPrivateFieldSet$k(_newSize$1,this,_classPrivateFieldGet$l(_startWidth,this)))}function _onMouseMove$2(a){if(_classPrivateFieldGet$l(_pressed$2,this)){const s=(a.pageX-this.startX)*this.hot.getDirectionFactor();_classPrivateFieldSet$k(_currentWidth,this,_classPrivateFieldGet$l(_startWidth,this)+s),arrayEach(_classPrivateFieldGet$l(_selectedCols,this),c=>{_classPrivateFieldSet$k(_newSize$1,this,this.setManualSize(c,_classPrivateFieldGet$l(_currentWidth,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function _onMouseUp$2(){const a=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},s=(c,u)=>{this.hot.runHooks("beforeColumnResize",_classPrivateFieldGet$l(_newSize$1,this),c,!1),u&&a(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",_classPrivateFieldGet$l(_newSize$1,this),c,!1)};_classPrivateFieldGet$l(_pressed$2,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$k(_pressed$2,this,!1),_classPrivateFieldGet$l(_newSize$1,this)!==_classPrivateFieldGet$l(_startWidth,this)&&(_classPrivateFieldGet$l(_selectedCols,this).length>1?(arrayEach(_classPrivateFieldGet$l(_selectedCols,this),u=>{s(u)}),a()):arrayEach(_classPrivateFieldGet$l(_selectedCols,this),u=>{s(u,!0)})),this.setupHandlePosition(_classPrivateFieldGet$l(_currentTH$1,this)))}function _onContextMenu$1(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$l(_handle$1,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$l(_guide$1,this)),_classPrivateFieldSet$k(_pressed$2,this,!1),_classPrivateFieldSet$k(_isTriggeredByRMB$1,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$k(_isTriggeredByRMB$1,this,!1)})}function _onModifyColWidth$2(a,s){let c=a;if(this.enabled){const u=this.hot.toPhysicalColumn(s),d=_classPrivateFieldGet$l(_columnWidthsMap,this).getValueAtIndex(u);this.hot.getSettings()[PLUGIN_KEY$h]&&d&&(c=d)}return c}function _onBeforeStretchingColumnWidth(a,s){const c=_classPrivateFieldGet$l(_columnWidthsMap,this).getValueAtIndex(this.hot.toPhysicalColumn(s));return typeof c=="number"?c:a}function _onBeforeColumnResize(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function _defineProperty$C(a,s,c){return(s=_toPropertyKey$C(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$C(a){var s=_toPrimitive$C(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$C(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const STATE_INITIALIZED=0,STATE_BUILT=1,STATE_APPENDED=2,UNIT="px";let BaseUI$1=class{constructor(s){_defineProperty$C(this,"hot",void 0),_defineProperty$C(this,"_element",null),_defineProperty$C(this,"state",STATE_INITIALIZED),this.hot=s}appendTo(s){s.appendChild(this._element),this.state=STATE_APPENDED}build(){this.state===STATE_INITIALIZED&&(this._element=this.hot.rootDocument.createElement("div"),this.state=STATE_BUILT)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=STATE_INITIALIZED}isAppended(){return this.state===STATE_APPENDED}isBuilt(){return this.state>=STATE_BUILT}setPosition(s,c){s!==void 0&&(this._element.style.top=s+UNIT),c!==void 0&&(this._element.style.left=c+UNIT)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(s,c){s&&(this._element.style.width=s+UNIT),c&&(this._element.style.height=c+UNIT)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(s,c){s&&(this._element.style.marginTop=s+UNIT),c&&(this._element.style.marginLeft=c+UNIT)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const CSS_CLASSNAME$1="ht__manualRowMove--backlight";class BacklightUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME$1)}}const CSS_CLASSNAME="ht__manualRowMove--guideline";class GuidelineUI extends BaseUI$1{build(){super.build(),addClass$1(this._element,CSS_CLASSNAME)}}function _classPrivateMethodInitSpec$i(a,s){_checkPrivateRedeclaration$p(a,s),s.add(a)}function _classPrivateFieldInitSpec$k(a,s,c){_checkPrivateRedeclaration$p(a,s),s.set(a,c)}function _checkPrivateRedeclaration$p(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$j(a,s,c){return a.set(_assertClassBrand$p(a,s),c),c}function _classPrivateFieldGet$k(a,s){return a.get(_assertClassBrand$p(a,s))}function _assertClassBrand$p(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeRowMove"),Hooks.getSingleton().register("afterRowMove");const PLUGIN_KEY$g="manualRowMove",PLUGIN_PRIORITY$g=140,CSS_PLUGIN="ht__manualRowMove",CSS_SHOW_UI="show-ui",CSS_ON_MOVING="on-moving--rows",CSS_AFTER_SELECTION="after-selection--rows";var _backlight=new WeakMap,_guideline=new WeakMap,_rowsToMove=new WeakMap,_pressed$1=new WeakMap,_target=new WeakMap,_cachedDropIndex=new WeakMap,_ManualRowMove_brand=new WeakSet;class ManualRowMove extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$i(this,_ManualRowMove_brand),_classPrivateFieldInitSpec$k(this,_backlight,new BacklightUI(this.hot)),_classPrivateFieldInitSpec$k(this,_guideline,new GuidelineUI(this.hot)),_classPrivateFieldInitSpec$k(this,_rowsToMove,[]),_classPrivateFieldInitSpec$k(this,_pressed$1,void 0),_classPrivateFieldInitSpec$k(this,_target,{}),_classPrivateFieldInitSpec$k(this,_cachedDropIndex,void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$g}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$g}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$g]}enablePlugin(){var s=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$p(_ManualRowMove_brand,s,_onBeforeOnCellMouseDown$2).call(s,...u)}),this.addHook("beforeOnCellMouseOver",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$p(_ManualRowMove_brand,s,_onBeforeOnCellMouseOver$1).call(s,...u)}),this.addHook("afterScrollHorizontally",()=>_assertClassBrand$p(_ManualRowMove_brand,this,_onAfterScrollHorizontally).call(this)),this.addHook("afterLoadData",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$p(_ManualRowMove_brand,s,_onAfterLoadData$1).call(s,...u)}),this.buildPluginUI(),this.registerEvents(),addClass$1(this.hot.rootElement,CSS_PLUGIN),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){removeClass$1(this.hot.rootElement,CSS_PLUGIN),this.unregisterEvents(),_classPrivateFieldGet$k(_backlight,this).destroy(),_classPrivateFieldGet$k(_guideline,this).destroy(),super.disablePlugin()}moveRow(s,c){return this.moveRows([s],c)}moveRows(s,c){const u=_classPrivateFieldGet$k(_cachedDropIndex,this),d=this.isMovePossible(s,c),h=this.hot.runHooks("beforeRowMove",s,c,u,d);if(_classPrivateFieldSet$j(_cachedDropIndex,this,void 0),h===!1)return;d&&this.hot.rowIndexMapper.moveIndexes(s,c);const f=d&&this.isRowOrderChanged(s,c);return this.hot.runHooks("afterRowMove",s,c,u,d,f),f}dragRow(s,c){return this.dragRows([s],c)}dragRows(s,c){const u=this.countFinalIndex(s,c);return _classPrivateFieldSet$j(_cachedDropIndex,this,c),this.moveRows(s,u)}isMovePossible(s,c){const u=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),d=s.length+c>u,h=c<0,f=s.some(m=>m<0),g=s.some(m=>m>=u);return!(d||h||f||g)}isRowOrderChanged(s,c){return s.some((u,d)=>u-d!==c)}countFinalIndex(s,c){const u=arrayReduce(s,(d,h)=>(h<c&&(d+=1),d),0);return c-u}getRowsHeight(s,c){const u=this.hot.rowIndexMapper;let d=0;for(let h=s;h<=c;h++){const f=u.getRenderableFromVisualIndex(h);f!==null&&(d+=this.hot.view._wt.wtTable.getRowHeight(f)||this.hot.stylesHandler.getDefaultRowHeight())}return d}moveBySettingsOrLoad(){const s=this.hot.getSettings()[PLUGIN_KEY$g];if(Array.isArray(s))this.moveRows(s,0);else if(s!==void 0){const c=this.persistentStateLoad();c.length&&this.moveRows(c,0)}}isFixedRowTop(s){return s<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(s){return s>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const s={};return this.hot.runHooks("persistentStateLoad","manualRowMove",s),s.value?s.value:[]}prepareRowsToMoving(){const s=this.hot.getSelectedRangeActive(),c=[];if(!s)return c;const{from:u,to:d}=s,h=Math.min(u.row,d.row),f=Math.max(u.row,d.row);return rangeEach(h,f,g=>{c.push(g)}),c}refreshPositions(){const s=_classPrivateFieldGet$k(_target,this).coords,c=this.hot.getFirstFullyVisibleRow(),u=this.hot.getLastFullyVisibleRow(),d=this.hot.countRows();this.isFixedRowTop(s.row)&&c>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(c-1,-1)),this.isFixedRowBottom(s.row)&&u<d&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(u+1,1),void 0,!0);const h=this.hot.view._wt.wtTable,f=_classPrivateFieldGet$k(_target,this).TD,g=this.hot.rootElement,m=offset(g),p=getTrimmingContainer(g),v=h.holder.scrollTop,w=this.hot.rootWindow!==p?p.scrollTop:0,E=m.top-w,C=_classPrivateFieldGet$k(_target,this).eventPageY-E+v,b=h.hider.offsetHeight,P=h.TBODY.offsetTop,R=_classPrivateFieldGet$k(_backlight,this).getOffset().top,T=_classPrivateFieldGet$k(_backlight,this).getSize().height,I=f.offsetHeight/2,M=f.offsetHeight;let N=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,s.row-1);const H=C>=N+I;this.isFixedRowTop(s.row)&&(N+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),s.row<0?_classPrivateFieldGet$k(_target,this).row=c>0?c-1:c:H?(_classPrivateFieldGet$k(_target,this).row=s.row+1,N+=s.row===0?M-1:M):_classPrivateFieldGet$k(_target,this).row=s.row;let L=C,A=N;C+T+R>=b?L=b-T-R:C+R<P&&(L=P+Math.abs(R)),N>=b-1&&(A=b-1),_classPrivateFieldGet$k(_backlight,this).setPosition(L),_classPrivateFieldGet$k(_guideline,this).setPosition(A)}registerEvents(){const{documentElement:s}=this.hot.rootDocument;this.eventManager.addEventListener(s,"mousemove",c=>_assertClassBrand$p(_ManualRowMove_brand,this,_onMouseMove$1).call(this,c)),this.eventManager.addEventListener(s,"mouseup",()=>_assertClassBrand$p(_ManualRowMove_brand,this,_onMouseUp$1).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){_classPrivateFieldGet$k(_backlight,this).build(),_classPrivateFieldGet$k(_guideline,this).build()}destroy(){_classPrivateFieldGet$k(_backlight,this).destroy(),_classPrivateFieldGet$k(_guideline,this).destroy(),super.destroy()}}function _onBeforeOnCellMouseDown$2(a,s,c,u){const{wtTable:d,wtViewport:h}=this.hot.view._wt,f=this.hot.selection.isSelectedByRowHeader(),g=this.hot.getSelectedRangeActive();if(!g||!f||_classPrivateFieldGet$k(_pressed$1,this)||a.button!==0){_classPrivateFieldSet$j(_pressed$1,this,!1),_classPrivateFieldGet$k(_rowsToMove,this).length=0,removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI]);return}const m=_classPrivateFieldGet$k(_guideline,this).isBuilt()&&!_classPrivateFieldGet$k(_guideline,this).isAppended(),p=_classPrivateFieldGet$k(_backlight,this).isBuilt()&&!_classPrivateFieldGet$k(_backlight,this).isAppended();m&&p&&(_classPrivateFieldGet$k(_guideline,this).appendTo(d.hider),_classPrivateFieldGet$k(_backlight,this).appendTo(d.hider));const{from:v,to:w}=g,E=Math.min(v.row,w.row),C=Math.max(v.row,w.row);if(s.col<0&&s.row>=E&&s.row<=C){u.row=!0,_classPrivateFieldSet$j(_pressed$1,this,!0),_classPrivateFieldGet$k(_target,this).eventPageY=a.pageY,_classPrivateFieldGet$k(_target,this).coords=s,_classPrivateFieldGet$k(_target,this).TD=c,_classPrivateFieldSet$j(_rowsToMove,this,this.prepareRowsToMoving());const b=d.holder.scrollLeft+h.getRowHeaderWidth(),P=this.getRowsHeight(E,s.row-1)+(a.clientY-c.getBoundingClientRect().top);_classPrivateFieldGet$k(_backlight,this).setPosition(null,b),_classPrivateFieldGet$k(_backlight,this).setSize(d.hider.offsetWidth-b,this.getRowsHeight(E,C)),_classPrivateFieldGet$k(_backlight,this).setOffset(-P,null),addClass$1(this.hot.rootElement,CSS_ON_MOVING),this.refreshPositions()}else removeClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),_classPrivateFieldSet$j(_pressed$1,this,!1),_classPrivateFieldGet$k(_rowsToMove,this).length=0}function _onMouseMove$1(a){_classPrivateFieldGet$k(_pressed$1,this)&&(_classPrivateFieldGet$k(_target,this).eventPageY=a.pageY,this.refreshPositions())}function _onBeforeOnCellMouseOver$1(a,s,c,u){!this.hot.getSelectedRangeActive()||!_classPrivateFieldGet$k(_pressed$1,this)||(_classPrivateFieldGet$k(_rowsToMove,this).indexOf(s.row)>-1?removeClass$1(this.hot.rootElement,CSS_SHOW_UI):addClass$1(this.hot.rootElement,CSS_SHOW_UI),u.row=!0,u.column=!0,u.cell=!0,_classPrivateFieldGet$k(_target,this).coords=s,_classPrivateFieldGet$k(_target,this).TD=c)}function _onMouseUp$1(){const a=_classPrivateFieldGet$k(_target,this).row,s=_classPrivateFieldGet$k(_rowsToMove,this).length;if(_classPrivateFieldSet$j(_pressed$1,this,!1),removeClass$1(this.hot.rootElement,[CSS_ON_MOVING,CSS_SHOW_UI,CSS_AFTER_SELECTION]),this.hot.selection.isSelectedByRowHeader()&&addClass$1(this.hot.rootElement,CSS_AFTER_SELECTION),s<1||a===void 0)return;const c=_classPrivateFieldGet$k(_rowsToMove,this)[0],u=this.hot.toPhysicalRow(c),d=this.dragRows(_classPrivateFieldGet$k(_rowsToMove,this),a);if(_classPrivateFieldGet$k(_rowsToMove,this).length=0,d===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const h=this.hot.toVisualRow(u),f=h+s-1;this.hot.selectRows(h,f)}}function _onAfterScrollHorizontally(){const a=this.hot.view._wt.wtTable,s=this.hot.view._wt.wtViewport.getRowHeaderWidth(),c=a.holder.scrollLeft,u=s+c;_classPrivateFieldGet$k(_backlight,this).setPosition(null,u),_classPrivateFieldGet$k(_backlight,this).setSize(a.hider.offsetWidth-u)}function _onAfterLoadData$1(){this.moveBySettingsOrLoad()}function _classPrivateMethodInitSpec$h(a,s){_checkPrivateRedeclaration$o(a,s),s.add(a)}function _classPrivateFieldInitSpec$j(a,s,c){_checkPrivateRedeclaration$o(a,s),s.set(a,c)}function _checkPrivateRedeclaration$o(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$i(a,s,c){return a.set(_assertClassBrand$o(a,s),c),c}function _classPrivateFieldGet$j(a,s){return a.get(_assertClassBrand$o(a,s))}function _assertClassBrand$o(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$f="manualRowResize",PLUGIN_PRIORITY$f=30,PERSISTENT_STATE_KEY="manualRowHeights";var _currentTH=new WeakMap,_currentRow=new WeakMap,_selectedRows=new WeakMap,_currentHeight=new WeakMap,_newSize=new WeakMap,_startY=new WeakMap,_startHeight=new WeakMap,_startOffset=new WeakMap,_handle=new WeakMap,_guide=new WeakMap,_pressed=new WeakMap,_isTriggeredByRMB=new WeakMap,_dblclick=new WeakMap,_autoresizeTimeout=new WeakMap,_rowHeightsMap=new WeakMap,_config=new WeakMap,_ManualRowResize_brand=new WeakSet;class ManualRowResize extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$f}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$f}constructor(s){super(s),_classPrivateMethodInitSpec$h(this,_ManualRowResize_brand),_classPrivateFieldInitSpec$j(this,_currentTH,null),_classPrivateFieldInitSpec$j(this,_currentRow,null),_classPrivateFieldInitSpec$j(this,_selectedRows,[]),_classPrivateFieldInitSpec$j(this,_currentHeight,null),_classPrivateFieldInitSpec$j(this,_newSize,null),_classPrivateFieldInitSpec$j(this,_startY,null),_classPrivateFieldInitSpec$j(this,_startHeight,null),_classPrivateFieldInitSpec$j(this,_startOffset,null),_classPrivateFieldInitSpec$j(this,_handle,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$j(this,_guide,this.hot.rootDocument.createElement("DIV")),_classPrivateFieldInitSpec$j(this,_pressed,!1),_classPrivateFieldInitSpec$j(this,_isTriggeredByRMB,!1),_classPrivateFieldInitSpec$j(this,_dblclick,0),_classPrivateFieldInitSpec$j(this,_autoresizeTimeout,null),_classPrivateFieldInitSpec$j(this,_rowHeightsMap,void 0),_classPrivateFieldInitSpec$j(this,_config,void 0),addClass$1(_classPrivateFieldGet$j(_handle,this),"manualRowResizer"),addClass$1(_classPrivateFieldGet$j(_guide,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$f]}enablePlugin(){this.enabled||(_classPrivateFieldSet$i(_rowHeightsMap,this,new PhysicalIndexToValueMap),_classPrivateFieldGet$j(_rowHeightsMap,this).addLocalHook("init",()=>_assertClassBrand$o(_ManualRowResize_brand,this,_onMapInit$1).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,_classPrivateFieldGet$j(_rowHeightsMap,this)),this.addHook("modifyRowHeight",(s,c)=>_assertClassBrand$o(_ManualRowResize_brand,this,_onModifyRowHeight).call(this,s,c)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){_classPrivateFieldSet$i(_config,this,_classPrivateFieldGet$j(_rowHeightsMap,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",PERSISTENT_STATE_KEY,_classPrivateFieldGet$j(_rowHeightsMap,this).getValues())}loadManualRowHeights(){const s={};return this.hot.runHooks("persistentStateLoad",PERSISTENT_STATE_KEY,s),s.value}setManualSize(s,c){const u=this.hot.toPhysicalRow(s),d=Math.max(c,this.hot.stylesHandler.getDefaultRowHeight());return _classPrivateFieldGet$j(_rowHeightsMap,this).setValueAtIndex(u,d),d}getLastDesiredRowHeight(){return _classPrivateFieldGet$j(_currentHeight,this)}setupHandlePosition(s){if(_classPrivateFieldGet$j(_dblclick,this)>1)return;_classPrivateFieldSet$i(_currentTH,this,s);const{view:c}=this.hot,{_wt:u}=c,d=u.wtTable.getCoords(_classPrivateFieldGet$j(_currentTH,this)),h=d.row;if(h<0)return;const f=outerWidth(_classPrivateFieldGet$j(_currentTH,this)),g=_classPrivateFieldGet$j(_currentTH,this).getBoundingClientRect(),m=h<u.getSetting("fixedRowsTop"),p=h>=c.countNotHiddenRowIndexes(0,1)-u.getSetting("fixedRowsBottom");let v;m?v=u.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$j(_currentTH,this),d.row,d.col):p&&(v=u.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(_classPrivateFieldGet$j(_currentTH,this),d.row,d.col)),v||(v=u.wtOverlays.inlineStartOverlay.getRelativeCellPosition(_classPrivateFieldGet$j(_currentTH,this),d.row,d.col)),_classPrivateFieldSet$i(_currentRow,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(h)),_classPrivateFieldSet$i(_selectedRows,this,[]);const w=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&w){const E=this.hot.getSelectedRange();arrayEach(E,C=>{const b=C.getTopStartCorner().row,P=C.getBottomStartCorner().row;rangeEach(b,P,R=>{_classPrivateFieldGet$j(_selectedRows,this).includes(R)||_classPrivateFieldGet$j(_selectedRows,this).push(R)})})}_classPrivateFieldGet$j(_selectedRows,this).includes(_classPrivateFieldGet$j(_currentRow,this))||_classPrivateFieldSet$i(_selectedRows,this,[_classPrivateFieldGet$j(_currentRow,this)]),_classPrivateFieldSet$i(_startOffset,this,v.top-6),_classPrivateFieldSet$i(_startHeight,this,parseInt(g.height,10)),_classPrivateFieldGet$j(_handle,this).style.top=`${_classPrivateFieldGet$j(_startOffset,this)+_classPrivateFieldGet$j(_startHeight,this)}px`,_classPrivateFieldGet$j(_handle,this).style[this.inlineDir]=`${v.start}px`,_classPrivateFieldGet$j(_handle,this).style.width=`${f}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$j(_handle,this))}refreshHandlePosition(){_classPrivateFieldGet$j(_handle,this).style.top=`${_classPrivateFieldGet$j(_startOffset,this)+_classPrivateFieldGet$j(_currentHeight,this)}px`}setupGuidePosition(){const s=parseInt(outerWidth(_classPrivateFieldGet$j(_handle,this)),10),c=parseInt(_classPrivateFieldGet$j(_handle,this).style[this.inlineDir],10)+s,u=this.hot.view.getTableWidth();addClass$1(_classPrivateFieldGet$j(_handle,this),"active"),addClass$1(_classPrivateFieldGet$j(_guide,this),"active"),_classPrivateFieldGet$j(_guide,this).style.top=_classPrivateFieldGet$j(_handle,this).style.top,_classPrivateFieldGet$j(_guide,this).style[this.inlineDir]=`${c}px`,_classPrivateFieldGet$j(_guide,this).style.width=`${u-s}px`,this.hot.rootElement.appendChild(_classPrivateFieldGet$j(_guide,this))}refreshGuidePosition(){_classPrivateFieldGet$j(_guide,this).style.top=_classPrivateFieldGet$j(_handle,this).style.top}hideHandleAndGuide(){removeClass$1(_classPrivateFieldGet$j(_handle,this),"active"),removeClass$1(_classPrivateFieldGet$j(_guide,this),"active")}checkIfRowHeader(s){const c=closest(s,["TBODY"],this.hot.rootElement),{inlineStartOverlay:u,topInlineStartCornerOverlay:d,bottomInlineStartCornerOverlay:h}=this.hot.view._wt.wtOverlays;return[u.clone.wtTable.TBODY,d.clone.wtTable.TBODY,h.clone.wtTable.TBODY].includes(c)}getClosestTHParent(s){return s.tagName!=="TABLE"?s.tagName==="TH"?s:this.getClosestTHParent(s.parentNode):null}getActualRowHeight(s){const c=this.hot.view._wt.wtTable.getRowHeight(s);return c!==void 0&&_classPrivateFieldGet$j(_newSize,this)<c?c:_classPrivateFieldGet$j(_newSize,this)}afterMouseDownTimeout(){const s=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},c=(u,d)=>{const h=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(u),u,!0);h!==void 0&&_classPrivateFieldSet$i(_newSize,this,h),this.setManualSize(u,_classPrivateFieldGet$j(_newSize,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(u),u,!0),d&&s()};_classPrivateFieldGet$j(_dblclick,this)>=2&&(_classPrivateFieldGet$j(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$j(_selectedRows,this),d=>{c(d)}),s()):arrayEach(_classPrivateFieldGet$j(_selectedRows,this),d=>{c(d,!0)})),_classPrivateFieldSet$i(_dblclick,this,0),_classPrivateFieldSet$i(_autoresizeTimeout,this,null)}bindEvents(){const{rootElement:s,rootWindow:c}=this.hot;this.eventManager.addEventListener(s,"mouseover",u=>_assertClassBrand$o(_ManualRowResize_brand,this,_onMouseOver).call(this,u)),this.eventManager.addEventListener(s,"mousedown",u=>_assertClassBrand$o(_ManualRowResize_brand,this,_onMouseDown).call(this,u)),this.eventManager.addEventListener(c,"mousemove",u=>_assertClassBrand$o(_ManualRowResize_brand,this,_onMouseMove).call(this,u)),this.eventManager.addEventListener(c,"mouseup",()=>_assertClassBrand$o(_ManualRowResize_brand,this,_onMouseUp).call(this)),this.eventManager.addEventListener(_classPrivateFieldGet$j(_handle,this),"contextmenu",()=>_assertClassBrand$o(_ManualRowResize_brand,this,_onContextMenu).call(this))}destroy(){super.destroy()}}function _onMouseOver(a){if(!isDetached(a.target)&&_classPrivateFieldGet$j(_isTriggeredByRMB,this)!==!0&&this.checkIfRowHeader(a.target)){const s=this.getClosestTHParent(a.target);s&&(_classPrivateFieldGet$j(_pressed,this)||this.setupHandlePosition(s))}}function _onMouseDown(a){hasClass$1(a.target,"manualRowResizer")&&(this.setupHandlePosition(_classPrivateFieldGet$j(_currentTH,this)),this.setupGuidePosition(),_classPrivateFieldSet$i(_pressed,this,!0),_classPrivateFieldGet$j(_autoresizeTimeout,this)===null&&(_classPrivateFieldSet$i(_autoresizeTimeout,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(_classPrivateFieldGet$j(_autoresizeTimeout,this))),_classPrivateFieldSet$i(_dblclick,this,_classPrivateFieldGet$j(_dblclick,this)+1),_classPrivateFieldSet$i(_startY,this,a.pageY),_classPrivateFieldSet$i(_newSize,this,_classPrivateFieldGet$j(_startHeight,this)))}function _onMouseMove(a){_classPrivateFieldGet$j(_pressed,this)&&(_classPrivateFieldSet$i(_currentHeight,this,_classPrivateFieldGet$j(_startHeight,this)+(a.pageY-_classPrivateFieldGet$j(_startY,this))),arrayEach(_classPrivateFieldGet$j(_selectedRows,this),s=>{_classPrivateFieldSet$i(_newSize,this,this.setManualSize(s,_classPrivateFieldGet$j(_currentHeight,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function _onMouseUp(){const a=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},s=(c,u)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(c),c,!1),u&&a(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(c),c,!1)};_classPrivateFieldGet$j(_pressed,this)&&(this.hideHandleAndGuide(),_classPrivateFieldSet$i(_pressed,this,!1),_classPrivateFieldGet$j(_newSize,this)!==_classPrivateFieldGet$j(_startHeight,this)&&(_classPrivateFieldGet$j(_selectedRows,this).length>1?(arrayEach(_classPrivateFieldGet$j(_selectedRows,this),u=>{s(u)}),a()):arrayEach(_classPrivateFieldGet$j(_selectedRows,this),u=>{s(u,!0)})),this.setupHandlePosition(_classPrivateFieldGet$j(_currentTH,this)))}function _onContextMenu(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(_classPrivateFieldGet$j(_handle,this)),this.hot.rootElement.removeChild(_classPrivateFieldGet$j(_guide,this)),_classPrivateFieldSet$i(_pressed,this,!1),_classPrivateFieldSet$i(_isTriggeredByRMB,this,!0),this.hot._registerImmediate(()=>{_classPrivateFieldSet$i(_isTriggeredByRMB,this,!1)})}function _onModifyRowHeight(a,s){let c=a;if(this.enabled){const d=this.hot.toPhysicalRow(s),h=_classPrivateFieldGet$j(_rowHeightsMap,this).getValueAtIndex(d);if(this.hot.getSettings()[PLUGIN_KEY$f]&&h){var u;(u=this.hot.getPlugin("autoRowSize"))!==null&&u!==void 0&&u.isEnabled()?c=Math.max(h,c??0):c=h}}return c}function _onMapInit$1(){const a=this.hot.getSettings()[PLUGIN_KEY$f],s=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof s<"u"?s.forEach((c,u)=>{_classPrivateFieldGet$j(_rowHeightsMap,this).setValueAtIndex(u,c)}):Array.isArray(a)?(a.forEach((c,u)=>{_classPrivateFieldGet$j(_rowHeightsMap,this).setValueAtIndex(u,c)}),_classPrivateFieldSet$i(_config,this,a)):a===!0&&Array.isArray(_classPrivateFieldGet$j(_config,this))&&_classPrivateFieldGet$j(_config,this).forEach((c,u)=>{_classPrivateFieldGet$j(_rowHeightsMap,this).setValueAtIndex(u,c)})},!0)}var es_array_unscopables_flatMap={},hasRequiredEs_array_unscopables_flatMap;function requireEs_array_unscopables_flatMap(){if(hasRequiredEs_array_unscopables_flatMap)return es_array_unscopables_flatMap;hasRequiredEs_array_unscopables_flatMap=1;var a=requireAddToUnscopables();return a("flatMap"),es_array_unscopables_flatMap}requireEs_array_unscopables_flatMap();var esnext_iterator_flatMap={},es_iterator_flatMap={},getIteratorFlattenable,hasRequiredGetIteratorFlattenable;function requireGetIteratorFlattenable(){if(hasRequiredGetIteratorFlattenable)return getIteratorFlattenable;hasRequiredGetIteratorFlattenable=1;var a=requireFunctionCall(),s=requireAnObject(),c=requireGetIteratorDirect(),u=requireGetIteratorMethod();return getIteratorFlattenable=function(d,h){(!h||typeof d!="string")&&s(d);var f=u(d);return c(s(f!==void 0?a(f,d):d))},getIteratorFlattenable}var hasRequiredEs_iterator_flatMap;function requireEs_iterator_flatMap(){if(hasRequiredEs_iterator_flatMap)return es_iterator_flatMap;hasRequiredEs_iterator_flatMap=1;var a=require_export(),s=requireFunctionCall(),c=requireACallable(),u=requireAnObject(),d=requireGetIteratorDirect(),h=requireGetIteratorFlattenable(),f=requireIteratorCreateProxy(),g=requireIteratorClose(),m=requireIsPure(),p=requireIteratorHelperThrowsOnInvalidIterator(),v=requireIteratorHelperWithoutClosingOnEarlyError(),w=!m&&!p("flatMap",function(){}),E=!m&&!w&&v("flatMap",TypeError),C=m||w||E,b=f(function(){for(var P=this.iterator,R=this.mapper,T,I;;){if(I=this.inner)try{if(T=u(s(I.next,I.iterator)),!T.done)return T.value;this.inner=null}catch(M){g(P,"throw",M)}if(T=u(s(this.next,P)),this.done=!!T.done)return;try{this.inner=h(R(T.value,this.counter++),!1)}catch(M){g(P,"throw",M)}}});return a({target:"Iterator",proto:!0,real:!0,forced:C},{flatMap:function(R){u(this);try{c(R)}catch(T){g(this,"throw",T)}return E?s(E,this,R):new b(d(this),{mapper:R,inner:null})}}),es_iterator_flatMap}var hasRequiredEsnext_iterator_flatMap;function requireEsnext_iterator_flatMap(){return hasRequiredEsnext_iterator_flatMap||(hasRequiredEsnext_iterator_flatMap=1,requireEs_iterator_flatMap()),esnext_iterator_flatMap}requireEsnext_iterator_flatMap();function _classPrivateFieldInitSpec$i(a,s,c){_checkPrivateRedeclaration$n(a,s),s.set(a,c)}function _checkPrivateRedeclaration$n(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$B(a,s,c){return(s=_toPropertyKey$B(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$B(a){var s=_toPrimitive$B(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$B(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$i(a,s){return a.get(_assertClassBrand$n(a,s))}function _classPrivateFieldSet$h(a,s,c){return a.set(_assertClassBrand$n(a,s),c),c}function _assertClassBrand$n(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _cellRange=new WeakMap;class MergedCellCoords{constructor(s,c,u,d,h,f){_defineProperty$B(this,"row",void 0),_defineProperty$B(this,"col",void 0),_defineProperty$B(this,"rowspan",void 0),_defineProperty$B(this,"colspan",void 0),_defineProperty$B(this,"removed",!1),_defineProperty$B(this,"cellCoordsFactory",void 0),_defineProperty$B(this,"cellRangeFactory",void 0),_classPrivateFieldInitSpec$i(this,_cellRange,null),this.row=s,this.col=c,this.rowspan=u,this.colspan=d,this.cellCoordsFactory=h,this.cellRangeFactory=f}static NEGATIVE_VALUES_WARNING(s){let{row:c,col:u,rowspan:d,colspan:h}=s;return toSingleLine`The merged cell declared with {row: ${c}, col: ${u},\x20
      rowspan: ${d}, colspan: ${h}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(s){let{row:c,col:u}=s;return toSingleLine`The merged cell declared at [${c}, ${u}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(s){let{row:c,col:u}=s;return toSingleLine`The merged cell declared at [${c}, ${u}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(s){let{row:c,col:u}=s;return toSingleLine`The merged cell declared at [${c}, ${u}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(s){let{row:c,col:u,rowspan:d,colspan:h}=s;return c<0||u<0||d<0||h<0}static isSingleCell(s){let{rowspan:c,colspan:u}=s;return u===1&&c===1}static containsZeroSpan(s){let{rowspan:c,colspan:u}=s;return u===0||c===0}static isOutOfBounds(s,c,u){return s.row<0||s.col<0||s.row>=c||s.row+s.rowspan-1>=c||s.col>=u||s.col+s.colspan-1>=u}normalize(s){const c=s.countRows(),u=s.countCols();this.row<0?this.row=0:this.row>c-1&&(this.row=c-1),this.col<0?this.col=0:this.col>u-1&&(this.col=u-1),this.row+this.rowspan>c-1&&(this.rowspan=c-this.row),this.col+this.colspan>u-1&&(this.colspan=u-this.col),_classPrivateFieldSet$h(_cellRange,this,null)}includes(s,c){return this.row<=s&&this.col<=c&&this.row+this.rowspan-1>=s&&this.col+this.colspan-1>=c}includesHorizontally(s){return this.col<=s&&this.col+this.colspan-1>=s}includesVertically(s){return this.row<=s&&this.row+this.rowspan-1>=s}shift(s,c){const u=s[0]||s[1],d=c+Math.abs(s[0]||s[1])-1,h=s[0]?"colspan":"rowspan",f=s[0]?"col":"row",g=Math.min(c,d),m=Math.max(c,d),p=this[f],v=this[f]+this[h]-1;if(p>=c&&(this[f]+=u),u>0)c<=v&&c>p&&(this[h]+=u);else if(u<0){if(g<=p&&m>=v)return this.removed=!0,_classPrivateFieldSet$h(_cellRange,this,null),!1;if(p>=g&&p<=m){const w=m-p+1,E=Math.abs(u)-w;this[f]-=E+u,this[h]-=w}else if(p<=g&&v>=m)this[h]+=u;else if(p<=g&&v>=g&&v<m){const w=v-g+1;this[h]-=w}}return _classPrivateFieldSet$h(_cellRange,this,null),!0}isFarther(s,c){return s?c==="down"?s.row+s.rowspan-1<this.row+this.rowspan-1:c==="up"?s.row>this.row:c==="right"?s.col+s.colspan-1<this.col+this.colspan-1:c==="left"?s.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return _classPrivateFieldGet$i(_cellRange,this)||_classPrivateFieldSet$h(_cellRange,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),_classPrivateFieldGet$i(_cellRange,this)}}function _classPrivateMethodInitSpec$g(a,s){_checkPrivateRedeclaration$m(a,s),s.add(a)}function _checkPrivateRedeclaration$m(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$A(a,s,c){return(s=_toPropertyKey$A(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$A(a){var s=_toPrimitive$A(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$A(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$m(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _MergedCellsCollection_brand=new WeakSet;class MergedCellsCollection{constructor(s){_classPrivateMethodInitSpec$g(this,_MergedCellsCollection_brand),_defineProperty$A(this,"plugin",void 0),_defineProperty$A(this,"mergedCells",[]),_defineProperty$A(this,"mergedCellsMatrix",new Map),_defineProperty$A(this,"hot",void 0),this.plugin=s,this.hot=s.hot}static IS_OVERLAPPING_WARNING(s){let{row:c,col:u}=s;return toSingleLine`The merged cell declared at [${c}, ${u}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(s,c){var u;return this.mergedCellsMatrix.has(s)&&(u=this.mergedCellsMatrix.get(s).get(c))!==null&&u!==void 0?u:!1}getByRange(s){const{row:c,col:u}=s.getTopStartCorner(),{row:d,col:h}=s.getBottomEndCorner(),f=this.mergedCells.length;let g=!1;for(let m=0;m<f;m++){const p=this.mergedCells[m],{row:v,col:w,rowspan:E,colspan:C}=p;if(v>=c&&v+E-1<=d&&w>=u&&w+C-1<=h){g=p;break}}return g}filterOverlappingMergeCells(s){const c=new Set;return this.mergedCells.forEach(d=>{const{row:h,col:f,colspan:g,rowspan:m}=d;for(let p=h;p<h+m;p++)for(let v=f;v<f+g;v++)c.add(`r${p},c${v}`)}),s.filter(d=>{const{row:h,col:f,colspan:g,rowspan:m}=d,p=new Set;let v=!1;for(let w=h;w<h+m;w++){for(let E=f;E<f+g;E++){const C=`r${w},c${E}`;if(c.has(C)){warn$1(MergedCellsCollection.IS_OVERLAPPING_WARNING(d)),v=!0;break}p.add(C)}if(v)break}return v||c.add(...p),!v})}getWithinRange(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:u,col:d}=s.getTopStartCorner(),{row:h,col:f}=s.getBottomEndCorner(),g=[];for(let m=u;m<=h;m++)for(let p=d;p<=f;p++){const v=this.get(m,p);v&&(c||!c&&v.row===m&&v.col===p)&&g.push(v)}return g}add(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const u=s.row,d=s.col,h=s.rowspan,f=s.colspan,g=new MergedCellCoords(u,d,h,f,this.hot._createCellCoords,this.hot._createCellRange),m=this.get(u,d),p=c?!1:this.isOverlapping(g);return!m&&!p?(this.hot&&g.normalize(this.hot),this.mergedCells.push(g),_assertClassBrand$m(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,g),g):(p&&warn$1(MergedCellsCollection.IS_OVERLAPPING_WARNING(g)),!1)}remove(s,c){const u=this.get(s,c),d=u?this.mergedCells.indexOf(u):-1;return u&&d!==-1?(this.mergedCells.splice(d,1),_assertClassBrand$m(_MergedCellsCollection_brand,this,_removeMergedCellFromMatrix).call(this,u),u):!1}clear(){arrayEach(this.mergedCells,s=>{let{row:c,col:u,rowspan:d,colspan:h}=s;rangeEach(c,c+d,f=>{rangeEach(u,u+h,g=>{const m=this.hot.getCell(f,g);m&&(m.removeAttribute("rowspan"),m.removeAttribute("colspan"),m.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(s){const c=s.getRange();for(let u=0;u<this.mergedCells.length;u++)if(this.mergedCells[u].getRange().overlaps(c))return!0;return!1}isFirstRenderableMergedCell(s,c){const u=this.get(s,c);if(!u)return!1;const{row:d,col:h,rowspan:f,colspan:g}=u,m=this.hot.view.getActiveOverlayName(),p=["top","top_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleRow(),v=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(m)?0:this.hot.getFirstRenderedVisibleColumn(),w=clamp(p,d,d+f-1),E=clamp(v,h,h+g-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(w,1)===s&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(E,1)===c}getFirstRenderableCoords(s,c){const u=this.get(s,c);if(!u||this.isFirstRenderableMergedCell(s,c))return this.hot._createCellCoords(s,c);const d=this.hot.rowIndexMapper.getNearestNotHiddenIndex(u.row,1),h=this.hot.columnIndexMapper.getNearestNotHiddenIndex(u.col,1);return this.hot._createCellCoords(d,h)}getStartMostColumnIndex(s,c){const u=_assertClassBrand$m(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,s,"col",-1);let d=c;for(let h=0;h<u.length;h++)if(u[h]<=c){d=u[h];break}return d}getEndMostColumnIndex(s,c){const u=_assertClassBrand$m(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,s,"col",1);let d=c;for(let h=0;h<u.length;h++)if(u[h]>=c){d=u[h];break}return d}getTopMostRowIndex(s,c){const u=_assertClassBrand$m(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,s,"row",-1);let d=c;for(let h=0;h<u.length;h++)if(u[h]<=c){d=u[h];break}return d}getBottomMostRowIndex(s,c){const u=_assertClassBrand$m(_MergedCellsCollection_brand,this,_getNonIntersectingIndexes).call(this,s,"row",1);let d=c;for(let h=0;h<u.length;h++)if(u[h]>=c){d=u[h];break}return d}shiftCollections(s,c,u){const d=[0,0];switch(s){case"right":d[0]+=u;break;case"left":d[0]-=u;break;case"down":d[1]+=u;break;case"up":d[1]-=u;break}const h=[];this.mergedCells.forEach(f=>{f.shift(d,c),f.removed&&h.push(f)}),h.forEach(f=>{this.mergedCells.splice(this.mergedCells.indexOf(f),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(f=>{_assertClassBrand$m(_MergedCellsCollection_brand,this,_addMergedCellToMatrix).call(this,f)})}}function _getNonIntersectingIndexes(a,s){let c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const u=new Map,d=c===1?a.getTopStartCorner():a.getBottomEndCorner(),h=c===1?a.getBottomEndCorner():a.getTopStartCorner();for(let f=d.row;c===1?f<=h.row:f>=h.row;f+=c)for(let g=d.col;c===1?g<=h.col:g>=h.col;g+=c){const m=s==="row"?f:g,p=this.get(f,g);let v=m;p&&(v=c===1?p[s]+p[`${s}span`]-1:p[s]),u.has(m)||u.set(m,new Set),u.get(m).add(v)}return Array.from(new Set(Array.from(u.entries()).filter(f=>{let[,g]=f;return g.size===1}).flatMap(f=>{let[,g]=f;return Array.from(g)})))}function _addMergedCellToMatrix(a){for(let s=a.row;s<a.row+a.rowspan;s++)for(let c=a.col;c<a.col+a.colspan;c++)this.mergedCellsMatrix.has(s)||this.mergedCellsMatrix.set(s,new Map),this.mergedCellsMatrix.get(s).set(c,a)}function _removeMergedCellFromMatrix(a){for(let s=a.row;s<a.row+a.rowspan;s++)for(let c=a.col;c<a.col+a.colspan;c++)this.mergedCellsMatrix.get(s).delete(c)}function _defineProperty$z(a,s,c){return(s=_toPropertyKey$z(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$z(a){var s=_toPrimitive$z(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$z(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class AutofillCalculations{constructor(s){_defineProperty$z(this,"plugin",void 0),_defineProperty$z(this,"mergedCellsCollection",void 0),_defineProperty$z(this,"currentFillData",null),this.plugin=s,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(s,c){let u=null;return c[0]===s[0]&&c[1]===s[1]&&c[3]===s[3]?u="down":c[2]===s[2]&&c[1]===s[1]&&c[3]===s[3]?u="up":c[1]===s[1]&&c[2]===s[2]?u="right":u="left",u}snapDragArea(s,c,u,d){const h=c.slice(0),f=this.getAutofillSize(s,c,u),[g,m,p,v]=s,E=["up","down"].indexOf(u)>-1?p-g+1:v-m+1,C=Math.floor(f/E)*E,b=f-C,P=this.getFarthestCollection(s,c,u,d);if(P){if(u==="down"){const R=P.row+P.rowspan-g-b;h[2]+R>=this.plugin.hot.countRows()?h[2]-=b:h[2]+=b?R:0}else if(u==="right"){const R=P.col+P.colspan-m-b;h[3]+R>=this.plugin.hot.countCols()?h[3]-=b:h[3]+=b?R:0}else if(u==="up"){const R=p-b-P.row+1;h[0]+R<0?h[0]+=b:h[0]-=b?R:0}else if(u==="left"){const R=v-b-P.col+1;h[1]+R<0?h[1]+=b:h[1]-=b?R:0}}return this.updateCurrentFillCache({baseArea:s,dragDirection:u,foundMergedCells:d,fillSize:f,dragArea:h,cycleLength:E}),h}updateCurrentFillCache(s){this.currentFillData||(this.currentFillData={}),extend$1(this.currentFillData,s)}getAutofillSize(s,c,u){const[d,h,f,g]=s,[m,p,v,w]=c;switch(u){case"up":return d-m;case"down":return v-f;case"left":return h-p;case"right":return w-g;default:return null}}getDragArea(s,c,u){const[d,h,f,g]=s,[m,p,v,w]=c;switch(u){case"up":return[m,p,d-1,g];case"down":{const E=this.mergedCellsCollection.get(v,g),C=E?E.rowspan-1:0;return[f+1,h,v+C,g]}case"left":return[m,p,f,h-1];case"right":{const E=this.mergedCellsCollection.get(v,g),C=E?E.colspan-1:0;return[d,g+C,v,w]}default:return null}}getFarthestCollection(s,c,u,d){const[h,f,g,m]=s,p=["up","down"].indexOf(u)>-1,v=p?g:m,w=p?h:f,E=this.getAutofillSize(s,c,u),C=p?g-h+1:m-f+1,b=Math.floor(E/C)*C,P=E-b;let R=null,T=null,I=null;switch(u){case"up":R="includesVertically",I=v-P+1;break;case"left":R="includesHorizontally",I=v-P+1;break;case"down":R="includesVertically",I=w+P-1;break;case"right":R="includesHorizontally",I=w+P-1;break}return arrayEach(d,M=>{M[R](I)&&M.isFarther(T,u)&&(T=M)}),T}recreateAfterDataPopulation(s){if(!this.currentFillData)return;const c=this.getRangeFromChanges(s),u=this.currentFillData.foundMergedCells,d=this.currentFillData.dragDirection,h=(p,v)=>{switch(d){case"up":return p.row-v>=c.from.row;case"down":return p.row+p.rowspan-1+v<=c.to.row;case"left":return p.col-v>=c.from.column;case"right":return p.col+p.colspan-1+v<=c.to.column;default:return null}};let f=0,g=null,m=1;do for(let p=0;p<u.length;p+=1){if(g=u[p],f=m*this.currentFillData.cycleLength,h(g,f))switch(d){case"up":this.plugin.mergedCellsCollection.add({row:g.row-f,rowspan:g.rowspan,col:g.col,colspan:g.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:g.row+f,rowspan:g.rowspan,col:g.col,colspan:g.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:g.row,rowspan:g.rowspan,col:g.col-f,colspan:g.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:g.row,rowspan:g.rowspan,col:g.col+f,colspan:g.colspan},!0);break}p===u.length-1&&(m+=1)}while(h(g,f));this.currentFillData=null,this.plugin.hot.render(),u.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(s){const c={min:null,max:null},u={min:null,max:null};return arrayEach(s,d=>{const h=d[0],f=this.plugin.hot.propToCol(d[1]);(c.min===null||h<c.min)&&(c.min=h),(c.max===null||h>c.max)&&(c.max=h),(u.min===null||f<u.min)&&(u.min=f),(u.max===null||f>u.max)&&(u.max=f)}),{from:{row:c.min,column:u.min},to:{row:c.max,column:u.max}}}dragAreaOverlapsCollections(s,c,u){const d=this.getDragArea(s,c,u),[h,f,g,m]=d,p=this.plugin.hot._createCellCoords(h,f),v=this.plugin.hot._createCellCoords(g,m),w=this.plugin.hot._createCellRange(p,p,v);if(this.mergedCellsCollection.getWithinRange(w,!0).length===0)return!1;const C=this.mergedCellsCollection.getWithinRange(w,!1);return C.length===0?!0:u==="up"||u==="down"?!C.every(b=>{let{colspan:P}=b;return P===w.getWidth()}):!C.every(b=>{let{rowspan:P}=b;return P===w.getHeight()})}}function _defineProperty$y(a,s,c){return(s=_toPropertyKey$y(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$y(a){var s=_toPrimitive$y(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$y(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class SelectionCalculations{constructor(s){_defineProperty$y(this,"plugin",void 0),_defineProperty$y(this,"hot",void 0),_defineProperty$y(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=s,this.hot=s.hot}getSelectedMergedCellClassName(s,c,u,d){const h=Math.min(u[0],u[2]),f=Math.min(u[1],u[3]),g=Math.max(u[0],u[2]),m=Math.max(u[1],u[3]);if(d===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(s,c))return;const v=this.plugin.mergedCellsCollection.get(s,c);if(!v)return;const w=v.getLastRow(),E=v.getLastColumn();if(h<=v.row&&f<=v.col&&g>=w&&m>=E)return`${this.fullySelectedMergedCellClassName}-${d}`;if(this.isMergeCellFullySelected(v,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(s,c){const u=[];if(!c||!s)return!1;for(let d=0;d<s.rowspan;d+=1)for(let h=0;h<s.colspan;h+=1)u.push(this.hot._createCellCoords(s.row+d,s.col+h));for(let d=0;d<u.length;d+=1){const h=[];for(let f=0;f<c.length;f+=1)h[f]=c[f].includes(u[d]);if(!h.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const s=[];for(let c=0;c<=7;c+=1)s.push(`${this.fullySelectedMergedCellClassName}-${c}`);return s.push(`${this.fullySelectedMergedCellClassName}-multiple`),s}}function toggleMergeItem(a){return{key:"mergeCells",name(){const s=this.getSelectedActive();if(s){const c=a.mergedCellsCollection.get(s[0],s[1]);if(c.row===s[0]&&c.col===s[1]&&c.row+c.rowspan-1===s[2]&&c.col+c.colspan-1===s[3])return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_UNMERGE_CELLS)}return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_MERGE_CELLS)},callback(){const s=this.getSelectedRangeActive();if(!s)return;s.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:c,to:u}=s;a.toggleMerge(s),this.selectCell(c.row,c.col,u.row,u.col,!1)},disabled(){const s=this.getSelectedActive();return s?MergedCellCoords.isSingleCell({row:s[0],col:s[1],rowspan:s[2]-s[0]+1,colspan:s[3]-s[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function _defineProperty$x(a,s,c){return(s=_toPropertyKey$x(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$x(a){var s=_toPrimitive$x(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$x(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class NodeStructure{constructor(s){_defineProperty$x(this,"data",void 0),_defineProperty$x(this,"next",null),_defineProperty$x(this,"prev",null),this.data=s}}class LinkedList{constructor(){_defineProperty$x(this,"first",null),_defineProperty$x(this,"last",null)}push(s){const c=new NodeStructure(s);if(this.first===null)this.first=c,this.last=c;else{const u=this.last;this.last=c,c.prev=u,u.next=c}return c}unshift(s){const c=new NodeStructure(s);if(this.first===null)this.first=c,this.last=c;else{const u=this.first;this.first=c,c.next=u,u.prev=c}}inorder(s){let c=this.first;for(;c;){const u=s(c);if(c===this.last||u===!0)break;c=c.next}}remove(s){if(this.first===null)return!1;let c=this.first,u,d;for(;c;){if(c.data===s)return u=c.next,d=c.prev,u&&(u.prev=d),d&&(d.next=u),c===this.first&&(this.first=u),c===this.last&&(this.last=d),!0;c=c.next}return!1}hasCycle(){let s=this.first,c=this.first;for(;;){if(s===null||(s=s.next,s===null))return!1;if(s=s.next,c=c.next,s===c)return!0}}pop(){if(this.last===null)return null;const s=this.last;return this.last=this.last.prev,s}shift(){if(this.first===null)return null;const s=this.first;return this.first=this.first.next,s}recursiveReverse(){function s(u,d){d&&(s(d,d.next),d.next=u)}if(!this.first)return;s(this.first,this.first.next),this.first.next=null;const c=this.first;this.first=this.last,this.last=c}reverse(){if(!this.first||!this.first.next)return;let s=this.first.next,c=this.first,u;for(;s;)u=s.next,s.next=c,c.prev=s,c=s,s=u;this.first.next=null,this.last.prev=null,u=this.first,this.first=c,this.last=u}}function _classPrivateMethodInitSpec$f(a,s){_checkPrivateRedeclaration$l(a,s),s.add(a)}function _classPrivateFieldInitSpec$h(a,s,c){_checkPrivateRedeclaration$l(a,s),s.set(a,c)}function _checkPrivateRedeclaration$l(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$h(a,s){return a.get(_assertClassBrand$l(a,s))}function _classPrivateFieldSet$g(a,s,c){return a.set(_assertClassBrand$l(a,s),c),c}function _assertClassBrand$l(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _cellsHorizontalOrder=new WeakMap,_cellsVerticalOrder=new WeakMap,_currentHorizontalLinkedNode=new WeakMap,_currentVerticalLinkedNode=new WeakMap,_mergedCellsGetter=new WeakMap,_rowIndexMapper=new WeakMap,_columnIndexMapper=new WeakMap,_FocusOrder_brand=new WeakSet;class FocusOrder{constructor(s){let{mergedCellsGetter:c,rowIndexMapper:u,columnIndexMapper:d}=s;_classPrivateMethodInitSpec$f(this,_FocusOrder_brand),_classPrivateFieldInitSpec$h(this,_cellsHorizontalOrder,new LinkedList),_classPrivateFieldInitSpec$h(this,_cellsVerticalOrder,new LinkedList),_classPrivateFieldInitSpec$h(this,_currentHorizontalLinkedNode,null),_classPrivateFieldInitSpec$h(this,_currentVerticalLinkedNode,null),_classPrivateFieldInitSpec$h(this,_mergedCellsGetter,null),_classPrivateFieldInitSpec$h(this,_rowIndexMapper,null),_classPrivateFieldInitSpec$h(this,_columnIndexMapper,null),_classPrivateFieldSet$g(_mergedCellsGetter,this,c),_classPrivateFieldSet$g(_rowIndexMapper,this,u),_classPrivateFieldSet$g(_columnIndexMapper,this,d)}getCurrentVerticalNode(){return _classPrivateFieldGet$h(_currentVerticalLinkedNode,this).data}getFirstVerticalNode(){return _classPrivateFieldGet$h(_cellsVerticalOrder,this).first.data}getNextVerticalNode(){return _classPrivateFieldGet$h(_currentVerticalLinkedNode,this).next.data}getPrevVerticalNode(){return _classPrivateFieldGet$h(_currentVerticalLinkedNode,this).prev.data}getCurrentHorizontalNode(){return _classPrivateFieldGet$h(_currentHorizontalLinkedNode,this).data}getFirstHorizontalNode(){return _classPrivateFieldGet$h(_cellsHorizontalOrder,this).first.data}getNextHorizontalNode(){return _classPrivateFieldGet$h(_currentHorizontalLinkedNode,this).next.data}getPrevHorizontalNode(){return _classPrivateFieldGet$h(_currentHorizontalLinkedNode,this).prev.data}setPrevNodeAsActive(){_classPrivateFieldSet$g(_currentVerticalLinkedNode,this,_classPrivateFieldGet$h(_currentVerticalLinkedNode,this).prev),_classPrivateFieldSet$g(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$h(_currentHorizontalLinkedNode,this).prev)}setNextNodeAsActive(){_classPrivateFieldSet$g(_currentVerticalLinkedNode,this,_classPrivateFieldGet$h(_currentVerticalLinkedNode,this).next),_classPrivateFieldSet$g(_currentHorizontalLinkedNode,this,_classPrivateFieldGet$h(_currentHorizontalLinkedNode,this).next)}buildFocusOrder(s){_classPrivateFieldSet$g(_cellsHorizontalOrder,this,new LinkedList),s.forEach((c,u)=>{const d=new WeakSet,h=c.getTopStartCorner(),f=c.getBottomEndCorner();for(let g=h.row;g<=f.row;g++)if(!_classPrivateFieldGet$h(_rowIndexMapper,this).isHidden(g))for(let m=h.col;m<=f.col;m++){if(_classPrivateFieldGet$h(_columnIndexMapper,this).isHidden(m))continue;const p=_assertClassBrand$l(_FocusOrder_brand,this,_pushOrderNode).call(this,{selectedRange:c,selectionLayer:u,listOrder:_classPrivateFieldGet$h(_cellsHorizontalOrder,this),mergeCellsVisitor:d,row:g,column:m});p&&_classPrivateFieldSet$g(_currentHorizontalLinkedNode,this,p)}}),_classPrivateFieldGet$h(_cellsHorizontalOrder,this).first&&(_classPrivateFieldGet$h(_cellsHorizontalOrder,this).first.prev=_classPrivateFieldGet$h(_cellsHorizontalOrder,this).last,_classPrivateFieldGet$h(_cellsHorizontalOrder,this).last.next=_classPrivateFieldGet$h(_cellsHorizontalOrder,this).first),_classPrivateFieldSet$g(_cellsVerticalOrder,this,new LinkedList),s.forEach((c,u)=>{const d=new WeakSet,h=c.getTopStartCorner(),f=c.getBottomEndCorner();for(let g=h.col;g<=f.col;g++)if(!_classPrivateFieldGet$h(_columnIndexMapper,this).isHidden(g))for(let m=h.row;m<=f.row;m++){if(_classPrivateFieldGet$h(_rowIndexMapper,this).isHidden(m))continue;const p=_assertClassBrand$l(_FocusOrder_brand,this,_pushOrderNode).call(this,{selectedRange:c,selectionLayer:u,listOrder:_classPrivateFieldGet$h(_cellsVerticalOrder,this),mergeCellsVisitor:d,row:m,column:g});p&&_classPrivateFieldSet$g(_currentVerticalLinkedNode,this,p)}}),_classPrivateFieldGet$h(_cellsVerticalOrder,this).first&&(_classPrivateFieldGet$h(_cellsVerticalOrder,this).first.prev=_classPrivateFieldGet$h(_cellsVerticalOrder,this).last,_classPrivateFieldGet$h(_cellsVerticalOrder,this).last.next=_classPrivateFieldGet$h(_cellsVerticalOrder,this).first)}setActiveNode(s,c,u){return _classPrivateFieldGet$h(_cellsHorizontalOrder,this).inorder(d=>{const{selectionLayer:h,rowStart:f,rowEnd:g,colStart:m,colEnd:p}=d.data;if(h===u&&s>=f&&s<=g&&c>=m&&c<=p)return _classPrivateFieldSet$g(_currentHorizontalLinkedNode,this,d),!0}),_classPrivateFieldGet$h(_cellsVerticalOrder,this).inorder(d=>{const{selectionLayer:h,rowStart:f,rowEnd:g,colStart:m,colEnd:p}=d.data;if(h===u&&s>=f&&s<=g&&c>=m&&c<=p)return _classPrivateFieldSet$g(_currentVerticalLinkedNode,this,d),!0}),this}}function _pushOrderNode(a){let{selectedRange:s,selectionLayer:c,listOrder:u,mergeCellsVisitor:d,row:h,column:f}=a;const g=s.getTopStartCorner(),m=s.getBottomEndCorner(),p=s.highlight.clone().normalize(),v=_classPrivateFieldGet$h(_mergedCellsGetter,this).call(this,h,f);if(v&&d.has(v))return null;const w={selectionLayer:c,colStart:f,colEnd:f,rowStart:h,rowEnd:h};if(v){if(d.add(v),v.row<g.row||v.row+v.rowspan-1>m.row||v.col<g.col||v.col+v.colspan-1>m.col)return null;w.colStart=v.col,w.colEnd=v.col+v.colspan-1,w.rowStart=v.row,w.rowEnd=v.row+v.rowspan-1}const E=u.push(w);return h===p.row&&f===p.col||v&&p.row>=v.row&&p.row<=v.row+v.rowspan-1&&p.col>=v.col&&p.col<=v.col+v.colspan-1?E:null}function sumCellsHeights(a,s,c){const{rowIndexMapper:u,stylesHandler:d}=a;let h=0;for(let g=s;g<s+c;g++)if(!u.isHidden(g)){var f;h+=(f=a.getRowHeight(g))!==null&&f!==void 0?f:d.getDefaultRowHeight(g)}return h}function createMergeCellRenderer(a){const{hot:s}=a,{rowIndexMapper:c,columnIndexMapper:u}=s,d=new Map;function h(){}function f(g,m,p){const v=a.mergedCellsCollection.get(m,p);if(!isObject(v)){g.removeAttribute("rowspan"),g.removeAttribute("colspan"),d.has(m)&&!s.getSettings().rowHeaders&&(g.style.height=`${d.get(m)}px`,d.delete(m)),g.style.display="";return}const{row:w,col:E,colspan:C,rowspan:b}=v,[P,R]=a.translateMergedCellToRenderable(w,b,E,C),T=a.getSetting("virtualized");if(E===0&&!s.getSettings().rowHeaders){const G=s._getRowHeightFromSettings(m);if(G!==void 0){const ae=s.stylesHandler.areCellsBorderBox()?0:1;d.set(m,G-ae)}else if(isSafari()){const oe=sumCellsHeights(s,w,b);d.set(m,oe/b)}}const I=c.getRenderableFromVisualIndex(m),M=u.getRenderableFromVisualIndex(p),N=P-I+1,H=R-M+1;let L=c.getNearestNotHiddenIndex(w,1),A=u.getNearestNotHiddenIndex(E,1);if(T){const G=s.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(G)||(L=Math.max(L,s.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(G)||(A=Math.max(A,s.getFirstRenderedVisibleColumn()))}const k=Math.min(b,N),W=Math.min(C,H);L===m&&A===p?(g.setAttribute("rowspan",k),g.setAttribute("colspan",W)):(g.removeAttribute("rowspan"),g.removeAttribute("colspan"),g.style.display="none")}return{before:h,after:f}}function _classPrivateMethodInitSpec$e(a,s){_checkPrivateRedeclaration$k(a,s),s.add(a)}function _classPrivateFieldInitSpec$g(a,s,c){_checkPrivateRedeclaration$k(a,s),s.set(a,c)}function _checkPrivateRedeclaration$k(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$w(a,s,c){return(s=_toPropertyKey$w(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$w(a){var s=_toPrimitive$w(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$w(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldSet$f(a,s,c){return a.set(_assertClassBrand$k(a,s),c),c}function _classPrivateFieldGet$g(a,s){return a.get(_assertClassBrand$k(a,s))}function _assertClassBrand$k(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}Hooks.getSingleton().register("beforeMergeCells"),Hooks.getSingleton().register("afterMergeCells"),Hooks.getSingleton().register("beforeUnmergeCells"),Hooks.getSingleton().register("afterUnmergeCells");const PLUGIN_KEY$e="mergeCells",PLUGIN_PRIORITY$e=150,SHORTCUTS_GROUP$4=PLUGIN_KEY$e;var _lastSelectedFocus=new WeakMap,_lastFocusDelta=new WeakMap,_focusOrder=new WeakMap,_cellRenderer=new WeakMap,_MergeCells_brand=new WeakSet;class MergeCells extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$e(this,_MergeCells_brand),_defineProperty$w(this,"mergedCellsCollection",null),_defineProperty$w(this,"autofillCalculations",null),_defineProperty$w(this,"selectionCalculations",null),_classPrivateFieldInitSpec$g(this,_lastSelectedFocus,null),_classPrivateFieldInitSpec$g(this,_lastFocusDelta,{row:0,col:0}),_classPrivateFieldInitSpec$g(this,_focusOrder,new FocusOrder({mergedCellsGetter:(s,c)=>this.mergedCellsCollection.get(s,c),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),_classPrivateFieldInitSpec$g(this,_cellRenderer,createMergeCellRenderer(this))}static get PLUGIN_KEY(){return PLUGIN_KEY$e}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$e}static get DEFAULT_SETTINGS(){return{[defaultMainSettingSymbol]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$e]}enablePlugin(){var s=this;this.enabled||(this.mergedCellsCollection=new MergedCellsCollection(this),this.autofillCalculations=new AutofillCalculations(this),this.selectionCalculations=new SelectionCalculations(this),this.addHook("afterInit",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterInit$2).call(s,...u)}),this.addHook("modifyTransformFocus",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyTransformFocus).call(s,...u)}),this.addHook("modifyTransformStart",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyTransformStart$1).call(s,...u)}),this.addHook("modifyTransformEnd",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyTransformEnd).call(s,...u)}),this.addHook("beforeSelectionHighlightSet",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeSelectionHighlightSet$2).call(s,...u)}),this.addHook("beforeSetRangeStart",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeSetRangeStart).call(s,...u)}),this.addHook("beforeSetRangeStartOnly",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeSetRangeStart).call(s,...u)}),this.addHook("beforeSelectionFocusSet",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeSelectionFocusSet).call(s,...u)}),this.addHook("afterSelectionFocusSet",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterSelectionFocusSet).call(s,...u)}),this.addHook("afterSelectionEnd",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterSelectionEnd).call(s,...u)}),this.addHook("modifyGetCellCoords",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyGetCellCoords).call(s,...u)}),this.addHook("modifyGetCoordsElement",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyGetCellCoords).call(s,...u)}),this.addHook("afterIsMultipleSelection",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterIsMultipleSelection).call(s,...u)}),this.addHook("afterRenderer",function(){return _classPrivateFieldGet$g(_cellRenderer,s).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_addMergeActionsToContextMenu).call(s,...u)}),this.addHook("afterGetCellMeta",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterGetCellMeta).call(s,...u)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterViewportRowCalculatorOverride).call(s,...u)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterViewportColumnCalculatorOverride$1).call(s,...u)}),this.addHook("modifyAutofillRange",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyAutofillRange).call(s,...u)}),this.addHook("afterCreateCol",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterCreateCol).call(s,...u)}),this.addHook("afterRemoveCol",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterRemoveCol).call(s,...u)}),this.addHook("afterCreateRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterCreateRow$1).call(s,...u)}),this.addHook("afterRemoveRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterRemoveRow$1).call(s,...u)}),this.addHook("afterChange",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterChange$1).call(s,...u)}),this.addHook("beforeDrawBorders",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeDrawAreaBorders).call(s,...u)}),this.addHook("afterDrawSelection",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onAfterDrawSelection).call(s,...u)}),this.addHook("beforeRemoveCellClassNames",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeRemoveCellClassNames).call(s,...u)}),this.addHook("beforeBeginEditing",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onBeforeBeginEditing).call(s,...u)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$k(_MergeCells_brand,s,_onModifyRowHeightByOverlayName).call(s,...u)}),this.addHook("beforeUndoStackChange",(c,u)=>{if(u==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!isChrome())return;const s=[];let c=[];this.mergedCellsCollection.mergedCells.forEach(u=>{const{row:d,rowspan:h}=u;for(let f=d+1;f<d+h;f++)c.push(f)}),c=[...new Set(c)],c.forEach(u=>{const d=this.hot.rowIndexMapper.getRenderableFromVisualIndex(u);this.hot.view._wt.wtOverlays.getOverlays(!0).map(h=>h?.name==="master"?h:h.clone.wtTable).forEach(h=>{const f=h.getRow(d);f&&(f.style.background=getStyle(f,"backgroundColor").replace(")",", 0.99)"),s.push(f))})}),this.hot._registerTimeout(()=>{s.forEach(u=>{var d;u.style.background=(d=getStyle(u,"backgroundColor"))===null||d===void 0?void 0:d.replace(", 0.99)",")")})},1)}validateSetting(s){return s?MergedCellCoords.containsNegativeValues(s)?(warn$1(MergedCellCoords.NEGATIVE_VALUES_WARNING(s)),!1):MergedCellCoords.isOutOfBounds(s,this.hot.countRows(),this.hot.countCols())?(warn$1(MergedCellCoords.IS_OUT_OF_BOUNDS_WARNING(s)),!1):MergedCellCoords.isSingleCell(s)?(warn$1(MergedCellCoords.IS_SINGLE_CELL(s)),!1):MergedCellCoords.containsZeroSpan(s)?(warn$1(MergedCellCoords.ZERO_SPAN_WARNING(s)),!1):!0:!1}generateFromSettings(){const s=this.getSetting("cells").filter(d=>this.validateSetting(d)),c=this.mergedCellsCollection.filterOverlappingMergeCells(s),u=[];c.forEach(d=>{const{row:h,col:f,rowspan:g,colspan:m}=d,p=this.hot._createCellCoords(h,f),v=this.hot._createCellCoords(h+g-1,f+m-1),w=this.hot._createCellRange(p,p,v);this.mergeRange(w,!0,!0);for(let E=h;E<h+g;E++)for(let C=f;C<f+m;C++)(E!==h||C!==f)&&u.push([E,C,null])}),u.length!==0&&this.hot.setDataAtCell(u,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(s){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(s)}mergeSelection(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!s)return;s.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:c,to:u}=s;this.unmergeRange(s,!0),this.mergeRange(s),this.hot.selectCell(c.row,c.col,u.row,u.col,!1)}unmergeSelection(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!s)return;const{from:c,to:u}=s;this.unmergeRange(s,!0),this.hot.selectCell(c.row,c.col,u.row,u.col,!1)}mergeRange(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=s.getTopStartCorner(),h=s.getBottomEndCorner(),f={row:d.row,col:d.col,rowspan:h.row-d.row+1,colspan:h.col-d.col+1},g=[];let m=null;return this.canMergeRange(f,c)?(this.hot.runHooks("beforeMergeCells",s,c),rangeEach(0,f.rowspan-1,v=>{rangeEach(0,f.colspan-1,w=>{let E=null;g[v]||(g[v]=[]),v===0&&w===0?E=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(f.row),this.hot.toPhysicalColumn(f.col)):this.hot.setCellMeta(f.row+v,f.col+w,"hidden",!0),g[v][w]=E})}),this.hot.setCellMeta(f.row,f.col,"spanned",!0),this.mergedCellsCollection.add(f,c)?(u?m=[f.row,f.col,g]:this.hot.populateFromArray(f.row,f.col,g,void 0,void 0,this.pluginName),c||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",s,f,c),m):!0):!1}unmergeRange(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const u=this.mergedCellsCollection.getWithinRange(s);u.length!==0&&(this.hot.runHooks("beforeUnmergeCells",s,c),arrayEach(u,d=>{this.mergedCellsCollection.remove(d.row,d.col),rangeEach(0,d.rowspan-1,h=>{rangeEach(0,d.colspan-1,f=>{this.hot.removeCellMeta(d.row+h,d.col+f,"hidden"),this.hot.removeCellMeta(d.row+h,d.col+f,"copyable")})}),this.hot.removeCellMeta(d.row,d.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",s,c),this.hot.render())}toggleMerge(s){const{from:c,to:u}=s.clone().normalize(),d=this.mergedCellsCollection.get(c.row,c.col);d.row===c.row&&d.col===c.col&&d.row+d.rowspan-1===u.row&&d.col+d.colspan-1===u.col?this.unmergeRange(s):this.mergeSelection(s)}merge(s,c,u,d){const h=this.hot._createCellCoords(s,c),f=this.hot._createCellCoords(u,d);this.mergeRange(this.hot._createCellRange(h,h,f))}unmerge(s,c,u,d){const h=this.hot._createCellCoords(s,c),f=this.hot._createCellCoords(u,d);this.unmergeRange(this.hot._createCellRange(h,h,f))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const u=this.hot.getSelectedRangeActive();u&&!u.isSingleHeader()&&(this.toggleMerge(u),this.hot.render())},runOnlyIf:u=>!u.altKey,group:SHORTCUTS_GROUP$4})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$4)}modifyViewportRowStart(s,c){const u=this.hot.rowIndexMapper,d=u.getVisualFromRenderableIndex(s.startRow);for(let h=0;h<c;h+=1){const f=this.mergedCellsCollection.get(d,h);if(isObject(f)){const g=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f.row,1));if(g<s.startRow){s.startRow=g,this.modifyViewportRowStart(s,c);return}}}}modifyViewportRowEnd(s,c){const u=this.hot.rowIndexMapper,d=u.getVisualFromRenderableIndex(s.endRow);for(let h=0;h<c;h+=1){const f=this.mergedCellsCollection.get(d,h);if(isObject(f)){const g=f.row+f.rowspan-1,m=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,-1));if(m>s.endRow){s.endRow=m,this.modifyViewportRowEnd(s,c);return}}}}modifyViewportColumnStart(s,c){const u=this.hot.columnIndexMapper,d=u.getVisualFromRenderableIndex(s.startColumn);for(let h=0;h<c;h+=1){const f=this.mergedCellsCollection.get(h,d);if(isObject(f)){const g=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(f.col,1));if(g<s.startColumn){s.startColumn=g,this.modifyViewportColumnStart(s,c);return}}}}modifyViewportColumnEnd(s,c){const u=this.hot.columnIndexMapper,d=u.getVisualFromRenderableIndex(s.endColumn);for(let h=0;h<c;h+=1){const f=this.mergedCellsCollection.get(h,d);if(isObject(f)){const g=f.col+f.colspan-1,m=u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(g,-1));if(m>s.endColumn){s.endColumn=m,this.modifyViewportColumnEnd(s,c);return}}}}translateMergedCellToRenderable(s,c,u,d){const{rowIndexMapper:h,columnIndexMapper:f}=this.hot;let g,m;c===0?g=h.getNearestNotHiddenIndex(s,1):g=h.getNearestNotHiddenIndex(s+c-1,-1),d===0?m=f.getNearestNotHiddenIndex(u,1):m=f.getNearestNotHiddenIndex(u+d-1,-1);const p=s>=0?h.getRenderableFromVisualIndex(g):s,v=u>=0?f.getRenderableFromVisualIndex(m):u;return[p,v]}}function _onAfterInit$2(){this.generateFromSettings(),this.hot.render()}function _onAfterIsMultipleSelection(a){if(a){const s=this.mergedCellsCollection.mergedCells,c=this.hot.getSelectedRangeActive(),u=c.getTopStartCorner(),d=c.getBottomEndCorner();for(let h=0;h<s.length;h+=1)if(u.row===s[h].row&&u.col===s[h].col&&d.row===s[h].row+s[h].rowspan-1&&d.col===s[h].col+s[h].colspan-1)return!1}return a}function _onModifyTransformFocus(a){_classPrivateFieldGet$g(_lastFocusDelta,this).row=a.row,_classPrivateFieldGet$g(_lastFocusDelta,this).col=a.col}function _onModifyTransformStart$1(a){const s=this.hot.getSelectedRangeActive(),{highlight:c}=s,{columnIndexMapper:u,rowIndexMapper:d}=this.hot;_classPrivateFieldGet$g(_lastSelectedFocus,this)&&(d.getRenderableFromVisualIndex(_classPrivateFieldGet$g(_lastSelectedFocus,this).row)!==null&&(c.row=_classPrivateFieldGet$g(_lastSelectedFocus,this).row),u.getRenderableFromVisualIndex(_classPrivateFieldGet$g(_lastSelectedFocus,this).col)!==null&&(c.col=_classPrivateFieldGet$g(_lastSelectedFocus,this).col),_classPrivateFieldSet$f(_lastSelectedFocus,this,null));const h=this.mergedCellsCollection.get(c.row,c.col);if(!h)return;const f=h.col,g=h.col+h.colspan-1;if(a.col<0){const v=c.col>=f&&c.col<=g?f-1:g,w=u.getNearestNotHiddenIndex(v,-1);w===null?a.col=-this.hot.view.countRenderableColumnsInRange(0,c.col):a.col=-Math.max(this.hot.view.countRenderableColumnsInRange(w,c.col)-1,1)}else if(a.col>0){const v=c.col>=f&&c.col<=g?g+1:f,w=u.getNearestNotHiddenIndex(v,1);w===null?a.col=this.hot.view.countRenderableColumnsInRange(c.col,this.hot.countCols()):a.col=Math.max(this.hot.view.countRenderableColumnsInRange(c.col,w)-1,1)}const m=h.row,p=h.row+h.rowspan-1;if(a.row<0){const v=c.row>=m&&c.row<=p?m-1:p,w=d.getNearestNotHiddenIndex(v,-1);w===null?a.row=-this.hot.view.countRenderableRowsInRange(0,c.row):a.row=-Math.max(this.hot.view.countRenderableRowsInRange(w,c.row)-1,1)}else if(a.row>0){const v=c.row>=m&&c.row<=p?p+1:m,w=d.getNearestNotHiddenIndex(v,1);w===null?a.row=this.hot.view.countRenderableRowsInRange(c.row,this.hot.countRows()):a.row=Math.max(this.hot.view.countRenderableRowsInRange(c.row,w)-1,1)}}function _onModifyTransformEnd(a){const s=this.hot.getSelectedRangeActive(),c=s.clone(),{to:u}=s,{columnIndexMapper:d,rowIndexMapper:h}=this.hot,f=(g,m)=>{c.expand(this.hot._createCellCoords(g,m));for(let p=0;p<this.mergedCellsCollection.mergedCells.length;p+=1)c.expandByRange(this.mergedCellsCollection.mergedCells[p].getRange())};if(a.col<0){let g=this.mergedCellsCollection.getStartMostColumnIndex(s,u.col)+a.col;f(u.row,g),s.getHorizontalDirection()==="E-W"&&c.getHorizontalDirection()==="E-W"&&(g=c.getTopStartCorner().col);const m=d.getNearestNotHiddenIndex(g,1);m!==null&&(a.col=-Math.max(this.hot.view.countRenderableColumnsInRange(m,u.col)-1,1))}else if(a.col>0){let g=this.mergedCellsCollection.getEndMostColumnIndex(s,u.col)+a.col;f(u.row,g),s.getHorizontalDirection()==="W-E"&&c.getHorizontalDirection()==="W-E"&&(g=c.getBottomEndCorner().col);const m=d.getNearestNotHiddenIndex(g,-1);m!==null&&(a.col=Math.max(this.hot.view.countRenderableColumnsInRange(u.col,m)-1,1))}if(a.row<0){let g=this.mergedCellsCollection.getTopMostRowIndex(s,u.row)+a.row;f(g,u.col),s.getVerticalDirection()==="S-N"&&c.getVerticalDirection()==="S-N"&&(g=c.getTopStartCorner().row);const m=h.getNearestNotHiddenIndex(g,1);m!==null&&(a.row=-Math.max(this.hot.view.countRenderableRowsInRange(m,u.row)-1,1))}else if(a.row>0){let g=this.mergedCellsCollection.getBottomMostRowIndex(s,u.row)+a.row;f(g,u.col),s.getVerticalDirection()==="N-S"&&c.getVerticalDirection()==="N-S"&&(g=c.getBottomStartCorner().row);const m=h.getNearestNotHiddenIndex(g,-1);m!==null&&(a.row=Math.max(this.hot.view.countRenderableRowsInRange(u.row,m)-1,1))}}function _onBeforeSelectionHighlightSet$2(){const a=this.hot.getSelectedRangeLast(),{highlight:s}=a;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){_classPrivateFieldSet$f(_lastSelectedFocus,this,s.clone());return}for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)a.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange(),!1);for(let u=0;u<this.mergedCellsCollection.mergedCells.length;u+=1)a.expandByRange(this.mergedCellsCollection.mergedCells[u].getRange(),!1);const c=this.mergedCellsCollection.get(s.row,s.col);_classPrivateFieldSet$f(_lastSelectedFocus,this,s.clone()),c&&s.assign(c)}function _onModifyGetCellCoords(a,s,c,u){if(a<0||s<0)return;const d=this.mergedCellsCollection.get(a,s);if(!d)return;const{row:h,col:f,colspan:g,rowspan:m}=d,p=h,v=f,w=h+m-1,E=f+g-1;if(u==="render"&&this.getSetting("virtualized")){const C=this.hot.view.getActiveOverlayName(),b=["top","top_inline_start_corner"].includes(C)?0:this.hot.getFirstRenderedVisibleRow(),P=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(C)?0:this.hot.getFirstRenderedVisibleColumn();return[clamp(b,p,w),clamp(P,v,E),clamp(this.hot.getLastRenderedVisibleRow(),p,w),clamp(this.hot.getLastRenderedVisibleColumn(),v,E)]}return[p,v,w,E]}function _addMergeActionsToContextMenu(a){a.items.push({name:"---------"},toggleMergeItem(this))}function _onBeforeSetRangeStart(){_classPrivateFieldSet$f(_lastSelectedFocus,this,null)}function _onBeforeSelectionFocusSet(){if(_classPrivateFieldGet$g(_lastSelectedFocus,this).isCell())return;const a=this.hot.getSelectedRangeActive(),s=a.getVerticalDirection(),c=a.getHorizontalDirection(),u=_classPrivateFieldGet$g(_lastSelectedFocus,this).clone().normalize();_classPrivateFieldGet$g(_focusOrder,this).setActiveNode(u.row,u.col),_classPrivateFieldGet$g(_lastFocusDelta,this).row>0||_classPrivateFieldGet$g(_lastFocusDelta,this).col>0?_classPrivateFieldGet$g(_focusOrder,this).setPrevNodeAsActive():(c==="E-W"&&_classPrivateFieldGet$g(_lastFocusDelta,this).col<0||s==="S-N"&&_classPrivateFieldGet$g(_lastFocusDelta,this).row<0)&&_classPrivateFieldGet$g(_focusOrder,this).setNextNodeAsActive()}function _onAfterSelectionFocusSet(a,s){const{columnIndexMapper:c,rowIndexMapper:u}=this.hot;let d=this.hot.getActiveSelectionLayerIndex(),h=null,f=null;if(_classPrivateFieldGet$g(_lastFocusDelta,this).col<0){const{rowEnd:g,colEnd:m,selectionLayer:p}=_classPrivateFieldGet$g(_focusOrder,this).getPrevHorizontalNode();f=c.getNearestNotHiddenIndex(m,-1),h=u.getNearestNotHiddenIndex(g,-1),d=p}else if(_classPrivateFieldGet$g(_lastFocusDelta,this).col>0){const{rowStart:g,colStart:m,selectionLayer:p}=_classPrivateFieldGet$g(_focusOrder,this).getNextHorizontalNode();f=c.getNearestNotHiddenIndex(m,1),h=u.getNearestNotHiddenIndex(g,1),d=p}else if(_classPrivateFieldGet$g(_lastFocusDelta,this).row<0){const{rowEnd:g,colEnd:m,selectionLayer:p}=_classPrivateFieldGet$g(_focusOrder,this).getPrevVerticalNode();f=c.getNearestNotHiddenIndex(m,-1),h=u.getNearestNotHiddenIndex(g,-1),d=p}else if(_classPrivateFieldGet$g(_lastFocusDelta,this).row>0){const{rowStart:g,colStart:m,selectionLayer:p}=_classPrivateFieldGet$g(_focusOrder,this).getNextVerticalNode();f=c.getNearestNotHiddenIndex(m,1),h=u.getNearestNotHiddenIndex(g,1),d=p}if(h!==null||f!==null){this.hot.selection.setActiveSelectionLayerIndex(d);const g=this.hot.getSelectedRangeActive(),m=this.hot._createCellCoords(h,f),p=this.mergedCellsCollection.get(m.row,m.col),v=this.hot.selection.highlight.getFocus();a=m.row,s=m.col,p?g.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(p.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(p.col,1)}):g.highlight.assign(m),v.clear(),v.add(m).commit()}_classPrivateFieldGet$g(_focusOrder,this).setActiveNode(a,s,d),_classPrivateFieldSet$f(_lastFocusDelta,this,{row:0,col:0})}function _onAfterSelectionEnd(){_classPrivateFieldGet$g(_focusOrder,this).buildFocusOrder(this.hot.getSelectedRange())}function _onAfterGetCellMeta(a,s,c){const u=this.mergedCellsCollection.get(a,s);u&&(u.row!==a||u.col!==s?c.copyable=!1:(c.rowspan=u.rowspan,c.colspan=u.colspan))}function _onAfterViewportRowCalculatorOverride(a){if(this.getSetting("virtualized"))return;const s=this.hot.countCols();this.modifyViewportRowStart(a,s),this.modifyViewportRowEnd(a,s)}function _onAfterViewportColumnCalculatorOverride$1(a){if(this.getSetting("virtualized"))return;const s=this.hot.countRows();this.modifyViewportColumnStart(a,s),this.modifyViewportColumnEnd(a,s)}function _onModifyAutofillRange(a,s){const c=this.autofillCalculations.getDirection(s,a);if(this.autofillCalculations.dragAreaOverlapsCollections(s,a,c))return s;const u=this.hot._createCellCoords(s[0],s[1]),d=this.hot._createCellCoords(s[2],s[3]),h=this.hot._createCellRange(u,u,d),f=this.mergedCellsCollection.getWithinRange(h);return f.length===0?a:this.autofillCalculations.snapDragArea(s,a,c,f)}function _onAfterCreateCol(a,s){this.mergedCellsCollection.shiftCollections("right",a,s)}function _onAfterRemoveCol(a,s){this.mergedCellsCollection.shiftCollections("left",a,s)}function _onAfterCreateRow$1(a,s,c){c!=="auto"&&this.mergedCellsCollection.shiftCollections("down",a,s)}function _onAfterRemoveRow$1(a,s){this.mergedCellsCollection.shiftCollections("up",a,s)}function _onAfterChange$1(a,s){s==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(a)}function _onBeforeDrawAreaBorders(a,s){if(s&&s==="area"){const c=this.hot.getSelectedRangeActive(),u=this.mergedCellsCollection.getWithinRange(c);arrayEach(u,d=>{c.getBottomEndCorner().row===d.getLastRow()&&c.getBottomEndCorner().col===d.getLastColumn()&&(a[2]=d.row,a[3]=d.col)})}}function _onAfterDrawSelection(a,s,c,u){if(c)return this.selectionCalculations.getSelectedMergedCellClassName(a,s,c,u)}function _onBeforeRemoveCellClassNames(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function _onBeforeBeginEditing(a,s,c,u){if(!(u instanceof MouseEvent))return;const d=this.hot.getSelectedRangeActive(),h=this.mergedCellsCollection.getByRange(d);if(!h)return;const f=this.hot._createCellCoords(h.row,h.col),g=this.hot._createCellCoords(h.row+h.rowspan-1,h.col+h.colspan-1);return this.hot.selection.getLayerLevel()===0&&d.isEqual(this.hot._createCellRange(f,f,g))}function _onModifyRowHeightByOverlayName(a,s,c){if(this.hot.getSettings().rowHeaders||c==="bottom"||c==="bottom_inline_start_corner")return a;let u,d;if(c==="master")u=this.hot.getFirstRenderedVisibleColumn(),d=this.hot.getLastRenderedVisibleColumn();else{const E=this.hot.view.getOverlayByName(c);u=this.hot.columnIndexMapper.getVisualFromRenderableIndex(E.clone.wtTable.getFirstRenderedColumn()),d=this.hot.columnIndexMapper.getVisualFromRenderableIndex(E.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(s,u))return a;const f=this.hot._createCellCoords(s,u),g=this.hot._createCellCoords(s,d),m=this.hot._createCellRange(f,f,g),p=this.mergedCellsCollection.getWithinRange(m,!0),v=p.reduce((E,C)=>{let{rowspan:b}=C;return Math.max(E,b)},1);let w=0;return p.length>1&&p[0].rowspan<v&&(w=v-p[0].rowspan),p.forEach(E=>{let{rowspan:C}=E,b=0;c==="top"||c==="top_inline_start_corner"?b=Math.min(v,this.hot.view.countNotHiddenFixedRowsTop()-s):b=C-w,a=Math.max(a??0,sumCellsHeights(this.hot,s,b))}),a}function rootComparator(a,s){return function(c,u){const[,...d]=c,[,...h]=u;return(function f(g){const m=a[g],p=s[g],v=d[g],w=h[g],E=p.multiColumnSorting,b=(E.compareFunctionFactory?E.compareFunctionFactory:getCompareFunctionFactory(p.type))(m,p,E)(v,w);if(b===DO_NOT_SWAP){const P=g+1;if(typeof s[P]<"u")return f(P)}return b})(0)}}const COLUMN_ORDER_PREFIX="sort";function getClassesToAdd(a,s,c){const u=[];return c===!1||a.isColumnSorted(s)&&a.getNumberOfSortedColumns()>1&&u.push(`${COLUMN_ORDER_PREFIX}-${a.getIndexOfColumnInSortQueue(s)+1}`),u}function getClassesToRemove(a){const s=a.className.split(" "),c=new RegExp(`^${COLUMN_ORDER_PREFIX}-[0-9]{1,2}$`);return s.filter(u=>c.test(u))}function _defineProperty$v(a,s,c){return(s=_toPropertyKey$v(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$v(a){var s=_toPrimitive$v(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$v(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const PLUGIN_KEY$d="multiColumnSorting",PLUGIN_PRIORITY$d=170,SHORTCUTS_GROUP$3=PLUGIN_KEY$d;registerRootComparator(PLUGIN_KEY$d,rootComparator);class MultiColumnSorting extends ColumnSorting{constructor(){super(...arguments),_defineProperty$v(this,"pluginKey",PLUGIN_KEY$d)}static get PLUGIN_KEY(){return PLUGIN_KEY$d}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$d}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:s}=this.hot.getSelectedRangeActive();return s.row===-1&&s.col>=0&&this.sort(this.getNextSortConfig(s.col,APPEND_COLUMN_CONFIG_STRATEGY)),!1},runOnlyIf:()=>{var s,c;const u=(s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;return u&&((c=this.hot.getSelectedRangeActive())===null||c===void 0?void 0:c.isSingle())&&this.hot.selection.isCellVisible(u)&&u.isHeader()},relativeToGroup:EDITOR_EDIT_GROUP,position:"before",group:SHORTCUTS_GROUP$3})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$3)}sort(s){super.sort(s)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(s){return super.getSortConfig(s)}setSortConfig(s){super.setSortConfig(s)}getNormalizedSortConfigs(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(s)?s:[s]}updateHeaderClasses(s){for(var c=arguments.length,u=new Array(c>1?c-1:0),d=1;d<c;d++)u[d-1]=arguments[d];super.updateHeaderClasses(s,...u),removeClass$1(s,getClassesToRemove(s)),this.enabled!==!1&&addClass$1(s,getClassesToAdd(...u))}onAfterOnCellMouseDown(s,c){wasHeaderClickedProperly(c.row,c.col,s)!==!1&&this.wasClickableHeaderClicked(s,c.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(c.col),this.sort(this.getNextSortConfig(c.col,APPEND_COLUMN_CONFIG_STRATEGY))):this.sort(this.getColumnNextConfig(c.col)))}}function _defineProperty$u(a,s,c){return(s=_toPropertyKey$u(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$u(a){var s=_toPrimitive$u(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$u(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const PLUGIN_KEY$c="multipleSelectionHandles",PLUGIN_PRIORITY$c=160;class MultipleSelectionHandles extends BasePlugin{constructor(){super(...arguments),_defineProperty$u(this,"dragged",[]),_defineProperty$u(this,"lastSetCell",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$c}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$c}isEnabled(){return isMobileBrowser()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const s=this,{rootElement:c}=this.hot;function u(d){if(s.dragged.length===1)return s.dragged.splice(0,s.dragged.length),!0;const h=s.dragged.indexOf(d);if(h===-1)return!1;h===0?s.dragged=s.dragged.slice(0,1):h===1&&(s.dragged=s.dragged.slice(-1))}this.eventManager.addEventListener(c,"touchstart",d=>{let h;if(hasClass$1(d.target,"topSelectionHandle-HitArea"))return h=s.hot.getSelectedRangeActive(),s.dragged.push("top"),s.touchStartRange={width:h.getWidth(),height:h.getHeight(),direction:h.getDirection()},d.preventDefault(),!1;if(hasClass$1(d.target,"bottomSelectionHandle-HitArea"))return h=s.hot.getSelectedRangeActive(),s.dragged.push("bottom"),s.touchStartRange={width:h.getWidth(),height:h.getHeight(),direction:h.getDirection()},d.preventDefault(),!1}),this.eventManager.addEventListener(c,"touchend",d=>{if(hasClass$1(d.target,"topSelectionHandle-HitArea"))return u.call(s,"top"),s.touchStartRange=void 0,d.preventDefault(),!1;if(hasClass$1(d.target,"bottomSelectionHandle-HitArea"))return u.call(s,"bottom"),s.touchStartRange=void 0,d.preventDefault(),!1}),this.eventManager.addEventListener(c,"touchmove",d=>{const{rootDocument:h}=this.hot;let f,g,m,p,v,w;if(s.dragged.length===0)return;const E=h.elementFromPoint(d.touches[0].clientX,d.touches[0].clientY);!E||E===s.lastSetCell||((E.nodeName==="TD"||E.nodeName==="TH")&&(f=s.hot.getCoords(E),f.col===-1&&(f.col=0),g=s.hot.getSelectedRangeActive(),m=g.getWidth(),p=g.getHeight(),v=g.getDirection(),m===1&&p===1&&s.hot.selection.setRangeEnd(f),w=s.getCurrentRangeCoords(g,f,s.touchStartRange.direction,v,s.dragged[0]),w.start!==null&&s.hot.selection.setRangeStart(w.start),s.hot.selection.setRangeEnd(w.end),s.lastSetCell=E),d.preventDefault())})}getCurrentRangeCoords(s,c,u,d,h){const f=s.getTopStartCorner(),g=s.getBottomEndCorner(),m=s.getBottomStartCorner(),p=s.getTopEndCorner();let v={start:null,end:null};switch(u){case"NE-SW":switch(d){case"NE-SW":case"NW-SE":h==="top"?v={start:this.hot._createCellCoords(c.row,s.highlight.col),end:this.hot._createCellCoords(m.row,c.col)}:v={start:this.hot._createCellCoords(s.highlight.row,c.col),end:this.hot._createCellCoords(c.row,f.col)};break;case"SE-NW":h==="bottom"&&(v={start:this.hot._createCellCoords(g.row,c.col),end:this.hot._createCellCoords(c.row,f.col)});break}break;case"NW-SE":switch(d){case"NE-SW":h==="top"?v={start:c,end:m}:v.end=c;break;case"NW-SE":h==="top"?v={start:c,end:g}:v.end=c;break;case"SE-NW":h==="top"?v={start:c,end:f}:v.end=c;break;case"SW-NE":h==="top"?v={start:c,end:p}:v.end=c;break}break;case"SW-NE":switch(d){case"NW-SE":h==="bottom"?v={start:this.hot._createCellCoords(c.row,f.col),end:this.hot._createCellCoords(m.row,c.col)}:v={start:this.hot._createCellCoords(f.row,c.col),end:this.hot._createCellCoords(c.row,g.col)};break;case"SW-NE":h==="top"?v={start:this.hot._createCellCoords(s.highlight.row,c.col),end:this.hot._createCellCoords(c.row,g.col)}:v={start:this.hot._createCellCoords(c.row,f.col),end:this.hot._createCellCoords(f.row,c.col)};break;case"SE-NW":h==="bottom"?v={start:this.hot._createCellCoords(c.row,p.col),end:this.hot._createCellCoords(f.row,c.col)}:h==="top"&&(v={start:m,end:c});break}break;case"SE-NW":switch(d){case"NW-SE":case"NE-SW":case"SW-NE":h==="top"&&(v.end=c);break;case"SE-NW":h==="top"?v.end=c:v={start:c,end:f};break}break}return v}isDragged(){return this.dragged.length>0}}function createDefaultHeaderSettings(){let{label:a="",colspan:s=1,origColspan:c=1,collapsible:u=!1,crossHiddenColumns:d=[],isCollapsed:h=!1,isHidden:f=!1,isRoot:g=!1,isPlaceholder:m=!1,headerClassNames:p=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:a,colspan:s,origColspan:c,collapsible:u,isCollapsed:h,crossHiddenColumns:d,isHidden:f,isRoot:g,isPlaceholder:m,headerClassNames:p}}function createPlaceholderHeaderSettings(){return{label:"",isPlaceholder:!0}}function normalizeSettings(a){let s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const c=[];if(s===0)return c;arrayEach(a,d=>{const h=[];let f=0;c.push(h),arrayEach(d,g=>{const m=createDefaultHeaderSettings();if(isObject(g)){const{label:v,colspan:w,headerClassName:E}=g;m.label=stringify$1(v),typeof w=="number"&&w>1&&(m.colspan=w,m.origColspan=w),typeof E=="string"&&(m.headerClassNames=[...E.split(" ")])}else m.label=stringify$1(g);f+=m.origColspan;let p=!1;if(f>=s&&(m.colspan=m.origColspan-(f-s),m.origColspan=m.colspan,p=!0),h.push(m),m.colspan>1)for(let v=0;v<m.colspan-1;v++)h.push(createPlaceholderHeaderSettings());return!p})});const u=Math.max(...arrayMap(c,d=>d.length));return arrayEach(c,d=>{if(d.length<u){const h=arrayMap(new Array(u-d.length),()=>createDefaultHeaderSettings());d.splice(d.length,0,...h)}}),c}function _classPrivateFieldInitSpec$f(a,s,c){_checkPrivateRedeclaration$j(a,s),s.set(a,c)}function _checkPrivateRedeclaration$j(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$f(a,s){return a.get(_assertClassBrand$j(a,s))}function _classPrivateFieldSet$e(a,s,c){return a.set(_assertClassBrand$j(a,s),c),c}function _assertClassBrand$j(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const HEADER_CONFIGURABLE_PROPS=["label","collapsible"];var _data=new WeakMap,_dataLength=new WeakMap,_columnsLimit=new WeakMap;class SourceSettings{constructor(){_classPrivateFieldInitSpec$f(this,_data,[]),_classPrivateFieldInitSpec$f(this,_dataLength,0),_classPrivateFieldInitSpec$f(this,_columnsLimit,1/0)}setColumnsLimit(s){_classPrivateFieldSet$e(_columnsLimit,this,s)}setData(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];_classPrivateFieldSet$e(_data,this,normalizeSettings(s,_classPrivateFieldGet$f(_columnsLimit,this))),_classPrivateFieldSet$e(_dataLength,this,_classPrivateFieldGet$f(_data,this).length)}getData(){return _classPrivateFieldGet$f(_data,this)}mergeWith(s){arrayEach(s,c=>{let{row:u,col:d,...h}=c;const f=this.getHeaderSettings(u,d);f!==null&&extend$1(f,h,HEADER_CONFIGURABLE_PROPS)})}map(s){arrayEach(_classPrivateFieldGet$f(_data,this),c=>{arrayEach(c,u=>{const d=s({...u});isObject(d)&&extend$1(u,d,HEADER_CONFIGURABLE_PROPS)})})}getHeaderSettings(s,c){var u;if(s>=_classPrivateFieldGet$f(_dataLength,this)||s<0)return null;const d=_classPrivateFieldGet$f(_data,this)[s];return Array.isArray(d)===!1||c>=d.length?null:(u=d[c])!==null&&u!==void 0?u:null}getHeadersSettings(s,c){let u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const d=[];if(s>=_classPrivateFieldGet$f(_dataLength,this)||s<0)return d;const h=_classPrivateFieldGet$f(_data,this)[s];let f=0;for(let g=c;g<h.length;g++){const m=h[g];if(m.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(f+=m.colspan,d.push(m),m.colspan>1&&(g+=m.colspan-1),f===u)break;if(f>u)throw new Error("The last column settings cannot overlap the other header layers")}return d}getLayersCount(){return _classPrivateFieldGet$f(_dataLength,this)}getColumnsCount(){return _classPrivateFieldGet$f(_dataLength,this)>0?_classPrivateFieldGet$f(_data,this)[0].length:0}clear(){_classPrivateFieldSet$e(_data,this,[]),_classPrivateFieldSet$e(_dataLength,this,0)}}function _defineProperty$t(a,s,c){return(s=_toPropertyKey$t(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$t(a){var s=_toPrimitive$t(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$t(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}const TRAVERSAL_DF_PRE="DF-pre-order";function depthFirstPreOrder(a,s){let c=a.call(s,this);for(let u=0;u<this.childs.length;u++){if(c===!1)return!1;c=depthFirstPreOrder.call(this.childs[u],a,s)}return c}const TRAVERSAL_DF_POST="DF-post-order";function depthFirstPostOrder(a,s){for(let c=0;c<this.childs.length;c++)if(depthFirstPostOrder.call(this.childs[c],a,s)===!1)return!1;return a.call(s,this)}const TRAVERSAL_BF="BF";function breadthFirst(a,s){const c=[this];function u(){if(c.length===0)return;const d=c.shift();c.push(...d.childs),a.call(s,d)!==!1&&u()}u()}const DEFAULT_TRAVERSAL_STRATEGY=TRAVERSAL_BF,TRAVERSAL_STRATEGIES=new Map([[TRAVERSAL_DF_PRE,depthFirstPreOrder],[TRAVERSAL_DF_POST,depthFirstPostOrder],[TRAVERSAL_BF,breadthFirst]]);class TreeNode{constructor(s){_defineProperty$t(this,"data",{}),_defineProperty$t(this,"parent",null),_defineProperty$t(this,"childs",[]),this.data=s}addChild(s){s.parent=this,this.childs.push(s)}cloneTree(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const c=new TreeNode({...s.data});for(let u=0;u<s.childs.length;u++)c.addChild(this.cloneTree(s.childs[u]));return c}replaceTreeWith(s){this.data={...s.data},this.childs=[];for(let c=0;c<s.childs.length;c++)this.addChild(s.childs[c])}walkDown(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:DEFAULT_TRAVERSAL_STRATEGY;if(!TRAVERSAL_STRATEGIES.has(c))throw new Error(`Traversal strategy "${c}" does not exist`);TRAVERSAL_STRATEGIES.get(c).call(this,s,this)}walkUp(s){const c=this,u=d=>{s.call(c,d)!==!1&&d.parent!==null&&u(d.parent)};u(this)}}function _classPrivateFieldInitSpec$e(a,s,c){_checkPrivateRedeclaration$i(a,s),s.set(a,c)}function _checkPrivateRedeclaration$i(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$e(a,s){return a.get(_assertClassBrand$i(a,s))}function _classPrivateFieldSet$d(a,s,c){return a.set(_assertClassBrand$i(a,s),c),c}function _assertClassBrand$i(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _rootNodes=new WeakMap,_rootsIndex=new WeakMap,_sourceSettings$1=new WeakMap;class HeadersTree{constructor(s){_classPrivateFieldInitSpec$e(this,_rootNodes,new Map),_classPrivateFieldInitSpec$e(this,_rootsIndex,new Map),_classPrivateFieldInitSpec$e(this,_sourceSettings$1,null),_classPrivateFieldSet$d(_sourceSettings$1,this,s)}getRoots(){return Array.from(_classPrivateFieldGet$e(_rootNodes,this).values())}getRootByColumn(s){let c;return _classPrivateFieldGet$e(_rootsIndex,this).has(s)&&(c=_classPrivateFieldGet$e(_rootNodes,this).get(_classPrivateFieldGet$e(_rootsIndex,this).get(s))),c}getNode(s,c){const u=this.getRootByColumn(c);if(!u)return;const d=c-_classPrivateFieldGet$e(_rootsIndex,this).get(c);let h=0,f;return u.walkDown(g=>{const{data:{origColspan:m,headerLevel:p}}=g;if(s===p){if(d>=h&&d<=h+m-1)return f=g,f.data.isRoot=c===f.data.columnIndex,!1;h+=m}}),f}rebuildTreeIndex(){let s=0;_classPrivateFieldGet$e(_rootsIndex,this).clear(),arrayEach(_classPrivateFieldGet$e(_rootNodes,this),c=>{let[,{data:{colspan:u}}]=c;for(let d=s;d<s+u;d++)_classPrivateFieldGet$e(_rootsIndex,this).set(d,s);s+=u})}buildTree(){this.clear();const s=_classPrivateFieldGet$e(_sourceSettings$1,this).getColumnsCount();let c=0;for(;c<s;){const u=_classPrivateFieldGet$e(_sourceSettings$1,this).getHeaderSettings(0,c),d=new TreeNode;_classPrivateFieldGet$e(_rootNodes,this).set(c,d),this.buildLeaves(d,c,0,u.origColspan),c+=u.origColspan}this.rebuildTreeIndex()}buildLeaves(s,c,u){let d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const h=_classPrivateFieldGet$e(_sourceSettings$1,this).getHeadersSettings(u,c,d);u+=1,arrayEach(h,f=>{const g={...f,headerLevel:u-1,columnIndex:c};let m;u===1?(s.data=g,m=s):(m=new TreeNode(g),s.addChild(m)),u<_classPrivateFieldGet$e(_sourceSettings$1,this).getLayersCount()&&this.buildLeaves(m,c,u,f.origColspan),c+=f.origColspan})}clear(){_classPrivateFieldGet$e(_rootNodes,this).clear(),_classPrivateFieldGet$e(_rootsIndex,this).clear()}}function traverseHiddenNodeColumnIndexes(a,s){a.walkDown(c=>{let{data:u,childs:d}=c;if(!u.isHidden&&(s(u.columnIndex),d.length===0))for(let h=1;h<u.colspan;h++)s(u.columnIndex+h)})}function getFirstChildProperty(a,s){let{childs:c}=a;if(c.length!==0)return c[0].data[s]}function isNodeReflectsFirstChildColspan(a){return getFirstChildProperty(a,"origColspan")===a.data.origColspan}function expandNode(a){const{data:s,childs:c}=a;if(!s.isCollapsed||s.isHidden||s.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(a))return expandNode(c[0]);s.isCollapsed=!1;const d=c.slice(1),h=new Set;let f=0;if(d.length>0)arrayEach(d,g=>{g.replaceTreeWith(g.data.clonedTree),g.data.clonedTree=null;const m=g.data;f+=m.colspan,traverseHiddenNodeColumnIndexes(g,p=>{h.add(p)})});else{const{colspan:g,origColspan:m,columnIndex:p}=s;f=m-g;for(let v=1;v<m;v++)h.add(p+v)}return a.walkUp(g=>{const{data:m}=g;m.colspan+=f,m.colspan>=m.origColspan?(m.colspan=m.origColspan,m.isCollapsed=!1):isNodeReflectsFirstChildColspan(g)&&(m.isCollapsed=getFirstChildProperty(g,"isCollapsed"))}),{rollbackModification:()=>collapseNode(a),affectedColumns:Array.from(h),colspanCompensation:f}}function collapseNode(a){var s;const{data:c,childs:u}=a;if(c.isCollapsed||c.isHidden||c.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if(isNodeReflectsFirstChildColspan(a))return collapseNode(u[0]);c.isCollapsed=!0;const h=u.slice(1),f=new Set;if(h.length>0)arrayEach(h,m=>{traverseHiddenNodeColumnIndexes(m,p=>{f.add(p)}),m.data.clonedTree=m.cloneTree(),m.walkDown(p=>{let{data:v}=p;v.isHidden=!0})});else{const{origColspan:m,columnIndex:p}=c;for(let v=1;v<m;v++){const w=p+v;f.add(w)}}const g=c.colspan-((s=getFirstChildProperty(a,"colspan"))!==null&&s!==void 0?s:1);return a.walkUp(m=>{const{data:p}=m;p.colspan-=g,p.colspan<=1?(p.colspan=1,p.isCollapsed=!0):isNodeReflectsFirstChildColspan(m)&&(p.isCollapsed=getFirstChildProperty(m,"isCollapsed"))}),{rollbackModification:()=>expandNode(a),affectedColumns:Array.from(f),colspanCompensation:g}}function hideColumn(a,s){if(!Number.isInteger(s))throw new Error("The passed gridColumnIndex argument has invalid type.");if(a.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:c}=a.data;if(c.includes(s))return;let u=!1;a.walkUp(d=>{const{data:{collapsible:h}}=d;if(h)return u=!0,!1}),!u&&a.walkUp(d=>{const{data:h}=d;h.crossHiddenColumns.push(s),h.colspan>1?h.colspan-=1:h.isHidden=!0})}function showColumn(a,s){if(!Number.isInteger(s))throw new Error("The passed gridColumnIndex argument has invalid type.");if(a.childs.length>0)throw new Error(toSingleLine`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:c}=a.data;if(!c.includes(s))return;let u=!1;a.walkUp(d=>{const{data:{collapsible:h}}=d;if(h)return u=!0,!1}),!u&&a.walkUp(d=>{const{data:h}=d;h.crossHiddenColumns.splice(h.crossHiddenColumns.indexOf(s),1),!h.isHidden&&h.colspan<h.origColspan&&(h.colspan+=1),h.isHidden=!1})}const availableModifiers=new Map([["collapse",collapseNode],["expand",expandNode],["hide-column",hideColumn],["show-column",showColumn]]);function triggerNodeModification(a,s,c){if(!availableModifiers.has(a))throw new Error(`The node modifier action ("${a}") does not exist.`);return availableModifiers.get(a)(s,c)}function generateMatrix(a){const s=[];return arrayEach(a,c=>{c.walkDown(u=>{const d=u.data,{origColspan:h,columnIndex:f,headerLevel:g,crossHiddenColumns:m}=d,p=createNestedArrayIfNecessary(s,g);let v=!1;for(let w=f;w<f+h;w++)if(m.includes(w)||v)p.push(createPlaceholderHeaderSettings());else{const C=createHeaderSettings(d);C.isRoot=!0,p.push(C),v=!0}})}),s}function createHeaderSettings(a){const{crossHiddenColumns:s,...c}=createDefaultHeaderSettings(a);return c}function createNestedArrayIfNecessary(a,s){let c;return Array.isArray(a[s])?c=a[s]:(c=[],a[s]=c),c}function _classPrivateFieldInitSpec$d(a,s,c){_checkPrivateRedeclaration$h(a,s),s.set(a,c)}function _checkPrivateRedeclaration$h(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$c(a,s,c){return a.set(_assertClassBrand$h(a,s),c),c}function _classPrivateFieldGet$d(a,s){return a.get(_assertClassBrand$h(a,s))}function _assertClassBrand$h(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _sourceSettings=new WeakMap,_headersTree=new WeakMap,_stateMatrix=new WeakMap;class StateManager{constructor(){_classPrivateFieldInitSpec$d(this,_sourceSettings,new SourceSettings),_classPrivateFieldInitSpec$d(this,_headersTree,new HeadersTree(_classPrivateFieldGet$d(_sourceSettings,this))),_classPrivateFieldInitSpec$d(this,_stateMatrix,[[]])}setState(s){_classPrivateFieldGet$d(_sourceSettings,this).setData(s);let c=!1;try{_classPrivateFieldGet$d(_headersTree,this).buildTree()}catch{_classPrivateFieldGet$d(_headersTree,this).clear(),_classPrivateFieldGet$d(_sourceSettings,this).clear(),c=!0}return _classPrivateFieldSet$c(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$d(_headersTree,this).getRoots())),c}setColumnsLimit(s){_classPrivateFieldGet$d(_sourceSettings,this).setColumnsLimit(s)}mergeStateWith(s){const c=arrayMap(s,u=>{let{row:d,...h}=u;return{row:d<0?this.rowCoordsToLevel(d):d,...h}});_classPrivateFieldGet$d(_sourceSettings,this).mergeWith(c),_classPrivateFieldGet$d(_headersTree,this).buildTree(),_classPrivateFieldSet$c(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$d(_headersTree,this).getRoots()))}mapState(s){_classPrivateFieldGet$d(_sourceSettings,this).map(s),_classPrivateFieldGet$d(_headersTree,this).buildTree(),_classPrivateFieldSet$c(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$d(_headersTree,this).getRoots()))}mapNodes(s){return arrayReduce(_classPrivateFieldGet$d(_headersTree,this).getRoots(),(c,u)=>(u.walkDown(d=>{const h=s(d.data);h!==void 0&&c.push(h)}),c),[])}triggerNodeModification(s,c,u){c<0&&(c=this.rowCoordsToLevel(c));const d=_classPrivateFieldGet$d(_headersTree,this).getNode(c,u);let h;return d&&(h=triggerNodeModification(s,d,u),_classPrivateFieldSet$c(_stateMatrix,this,generateMatrix(_classPrivateFieldGet$d(_headersTree,this).getRoots()))),h}triggerColumnModification(s,c){return this.triggerNodeModification(s,-1,c)}rowCoordsToLevel(s){if(s>=0)return null;const c=s+Math.max(this.getLayersCount(),1);return c<0?null:c}levelToRowCoords(s){if(s<0)return null;const c=s-Math.max(this.getLayersCount(),1);return c>=0?null:c}getHeaderSettings(s,c){var u,d;return s<0&&(s=this.rowCoordsToLevel(s)),s===null||s>=this.getLayersCount()?null:(u=(d=_classPrivateFieldGet$d(_stateMatrix,this)[s])===null||d===void 0?void 0:d[c])!==null&&u!==void 0?u:null}getHeaderTreeNodeData(s,c){const u=this.getHeaderTreeNode(s,c);return u?{...u.data}:null}getHeaderTreeNode(s,c){if(s<0&&(s=this.rowCoordsToLevel(s)),s===null||s>=this.getLayersCount())return null;const u=_classPrivateFieldGet$d(_headersTree,this).getNode(s,c);return u||null}findTopMostEntireHeaderLevel(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s;const u=c-s+1;let d=!1,h=null;for(let f=s;f<=c;f++){const g=_classPrivateFieldGet$d(_headersTree,this).getRootByColumn(f);if(!g)break;d=!0,g.walkDown(m=>{const{columnIndex:p,headerLevel:v,origColspan:w,isHidden:E}=m.data;E||w<=u&&p>=s&&p+w-1<=c&&(h===null||v<h)&&(h=v)},TRAVERSAL_DF_PRE)}return d&&h===null?-1:this.levelToRowCoords(h??0)}findLeftMostColumnIndex(s,c){var u;const{isRoot:d}=(u=this.getHeaderSettings(s,c))!==null&&u!==void 0?u:{isRoot:!0};if(d)return c;let h=c-1;for(;h>=0;){var f;const{isRoot:g}=(f=this.getHeaderSettings(s,h))!==null&&f!==void 0?f:{isRoot:!0};if(g)break;h-=1}return h}findRightMostColumnIndex(s,c){var u;const{isRoot:d,origColspan:h}=(u=this.getHeaderSettings(s,c))!==null&&u!==void 0?u:{isRoot:!0,origColspan:1};if(d)return c+h-1;let f=c+1;for(;f<this.getColumnsCount();){var g;const{isRoot:m}=(g=this.getHeaderSettings(s,f))!==null&&g!==void 0?g:{isRoot:!0};if(m)break;f+=1}return f-1}getLayersCount(){return _classPrivateFieldGet$d(_sourceSettings,this).getLayersCount()}getColumnsCount(){return _classPrivateFieldGet$d(_sourceSettings,this).getColumnsCount()}clear(){_classPrivateFieldSet$c(_stateMatrix,this,[]),_classPrivateFieldGet$d(_sourceSettings,this).clear(),_classPrivateFieldGet$d(_headersTree,this).clear()}}function _defineProperty$s(a,s,c){return(s=_toPropertyKey$s(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$s(a){var s=_toPrimitive$s(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$s(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class GhostTable{constructor(s,c){_defineProperty$s(this,"hot",void 0),_defineProperty$s(this,"nestedHeaderSettingsGetter",void 0),_defineProperty$s(this,"layersCount",0),_defineProperty$s(this,"container",void 0),_defineProperty$s(this,"widthsMap",void 0),this.hot=s,this.nestedHeaderSettingsGetter=c,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(s){return this.layersCount=s,this}getWidth(s){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(s))}buildWidthsMap(){const s=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),s&&this.container.classList.add(s),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const c=this.container.querySelectorAll("tr:last-of-type th"),u=c.length;this.widthsMap.clear();for(let d=0;d<u;d++){const h=this.hot.columnIndexMapper.getVisualFromRenderableIndex(d),f=this.hot.toPhysicalColumn(h);this.widthsMap.setValueAtIndex(f,c[d].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(s){const{rootDocument:c,columnIndexMapper:u}=this.hot,d=c.createDocumentFragment(),h=c.createElement("table"),f=!!this.hot.getSettings().dropdownMenu,g=u.getRenderableIndexesLength();for(let m=0;m<this.layersCount;m++){const p=c.createElement("tr");for(let v=0;v<g;v++){let w=u.getVisualFromRenderableIndex(v);w===null&&(w=v);const E=c.createElement("th"),C=this.nestedHeaderSettingsGetter(m,w);if(C&&(!C.isPlaceholder||C.isHidden)){let b=C.label;f&&(b+='<button class="changeType"></button>'),fastInnerHTML(E,b),E.colSpan=C.colspan,p.appendChild(E)}}h.appendChild(p)}d.appendChild(h),s.appendChild(d)}clear(){this.widthsMap.clear(),this.container=null}}function _classPrivateMethodInitSpec$d(a,s){_checkPrivateRedeclaration$g(a,s),s.add(a)}function _defineProperty$r(a,s,c){return(s=_toPropertyKey$r(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$r(a){var s=_toPrimitive$r(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$r(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldInitSpec$c(a,s,c){_checkPrivateRedeclaration$g(a,s),s.set(a,c)}function _checkPrivateRedeclaration$g(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$b(a,s,c){return a.set(_assertClassBrand$g(a,s),c),c}function _classPrivateFieldGet$c(a,s){return a.get(_assertClassBrand$g(a,s))}function _assertClassBrand$g(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$b="nestedHeaders",PLUGIN_PRIORITY$b=280;var _stateManager=new WeakMap,_hidingIndexMapObserver=new WeakMap,_focusInitialCoords=new WeakMap,_isColumnsSelectionInProgress=new WeakMap,_recentlyHighlightCoords=new WeakMap,_updateFocusHighlightPosition=new WeakMap,_NestedHeaders_brand=new WeakSet;class NestedHeaders extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$d(this,_NestedHeaders_brand),_classPrivateFieldInitSpec$c(this,_stateManager,new StateManager),_classPrivateFieldInitSpec$c(this,_hidingIndexMapObserver,null),_classPrivateFieldInitSpec$c(this,_focusInitialCoords,null),_classPrivateFieldInitSpec$c(this,_isColumnsSelectionInProgress,!1),_classPrivateFieldInitSpec$c(this,_recentlyHighlightCoords,null),_defineProperty$r(this,"ghostTable",new GhostTable(this.hot,(s,c)=>this.getHeaderSettings(s,c))),_defineProperty$r(this,"detectedOverlappedHeaders",!1),_classPrivateFieldInitSpec$c(this,_updateFocusHighlightPosition,()=>{var s;const c=(s=this.hot)===null||s===void 0?void 0:s.getSelectedRangeActive();if(!c)return;const{highlight:u}=c;if(u.isHeader()&&u.col>=0){const h=_classPrivateFieldGet$c(_stateManager,this).findLeftMostColumnIndex(u.row,u.col),f=this.hot.selection.highlight.getFocus();f.visualCellRange.highlight.col=h,f.visualCellRange.from.col=h,f.visualCellRange.to.col=h,f.commit()}})}static get PLUGIN_KEY(){return PLUGIN_KEY$b}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$b}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$b]}enablePlugin(){var s=this;if(this.enabled)return;const{nestedHeaders:c}=this.hot.getSettings();(!Array.isArray(c)||!Array.isArray(c[0]))&&warn$1(toSingleLine`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>_assertClassBrand$g(_NestedHeaders_brand,this,_onInit$1).call(this)),this.addHook("afterLoadData",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onAfterLoadData).call(s,...d)}),this.addHook("beforeOnCellMouseDown",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeOnCellMouseDown$1).call(s,...d)}),this.addHook("afterOnCellMouseDown",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onAfterOnCellMouseDown).call(s,...d)}),this.addHook("beforeOnCellMouseOver",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeOnCellMouseOver).call(s,...d)}),this.addHook("beforeOnCellMouseUp",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeOnCellMouseUp).call(s,...d)}),this.addHook("beforeSelectionHighlightSet",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeSelectionHighlightSet$1).call(s,...d)}),this.addHook("modifyTransformStart",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onModifyTransformStart).call(s,...d)}),this.addHook("afterSelection",()=>_classPrivateFieldGet$c(_updateFocusHighlightPosition,this).call(this)),this.addHook("afterSelectionFocusSet",()=>_classPrivateFieldGet$c(_updateFocusHighlightPosition,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeViewportScrollHorizontally).call(s,...d)}),this.addHook("afterGetColumnHeaderRenderers",u=>_assertClassBrand$g(_NestedHeaders_brand,this,_onAfterGetColumnHeaderRenderers).call(this,u)),this.addHook("modifyColWidth",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onModifyColWidth$1).call(s,...d)}),this.addHook("modifyColumnHeaderValue",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onModifyColumnHeaderValue).call(s,...d)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeHighlightingColumnHeader).call(s,...d)}),this.addHook("beforeCopy",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeCopy).call(s,...d)}),this.addHook("beforeSelectColumns",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onBeforeSelectColumns).call(s,...d)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onAfterViewportColumnCalculatorOverride).call(s,...d)}),this.addHook("modifyFocusedElement",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$g(_NestedHeaders_brand,s,_onModifyFocusedElement).call(s,...d)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",_classPrivateFieldGet$c(_updateFocusHighlightPosition,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",_classPrivateFieldGet$c(_updateFocusHighlightPosition,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:s}=this.hot.getSettings();_classPrivateFieldGet$c(_stateManager,this).setColumnsLimit(this.hot.countCols()),Array.isArray(s)&&(this.detectedOverlappedHeaders=_classPrivateFieldGet$c(_stateManager,this).setState(s)),this.detectedOverlappedHeaders&&warn$1(toSingleLine`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((c,u)=>{const d=c===!0?"hide-column":"show-column";_classPrivateFieldGet$c(_stateManager,this).triggerColumnModification(d,u)}),!_classPrivateFieldGet$c(_hidingIndexMapObserver,this)&&this.enabled&&_classPrivateFieldSet$b(_hidingIndexMapObserver,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(c=>{c.forEach(u=>{let{op:d,index:h,newValue:f}=u;if(d==="replace"){const g=f===!0?"hide-column":"show-column";_classPrivateFieldGet$c(_stateManager,this).triggerColumnModification(g,h)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",_classPrivateFieldGet$c(_updateFocusHighlightPosition,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",_classPrivateFieldGet$c(_updateFocusHighlightPosition,this)),this.clearColspans(),_classPrivateFieldGet$c(_stateManager,this).clear(),_classPrivateFieldGet$c(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$b(_hidingIndexMapObserver,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return _classPrivateFieldGet$c(_stateManager,this)}getLayersCount(){return _classPrivateFieldGet$c(_stateManager,this).getLayersCount()}getHeaderSettings(s,c){return _classPrivateFieldGet$c(_stateManager,this).getHeaderSettings(s,c)}clearColspans(){if(!this.hot.view)return;const{_wt:s}=this.hot.view,c=s.getSetting("columnHeaders").length,u=s.wtTable.THEAD,d=s.wtOverlays.topOverlay.clone.wtTable.THEAD,h=s.wtOverlays.topInlineStartCornerOverlay?s.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let f=0;f<c;f++){const g=u.childNodes[f];if(!g)break;const m=d.childNodes[f],p=h?h.childNodes[f]:null;for(let v=0,w=g.childNodes.length;v<w;v++)g.childNodes[v].removeAttribute("colspan"),removeClass$1(g.childNodes[v],"hiddenHeader"),m&&m.childNodes[v]&&(m.childNodes[v].removeAttribute("colspan"),removeClass$1(m.childNodes[v],"hiddenHeader")),h&&p&&p.childNodes[v]&&(p.childNodes[v].removeAttribute("colspan"),removeClass$1(p.childNodes[v],"hiddenHeader"))}}headerRendererFactory(s){var c=this;const u=this.hot.view._wt.getSetting("fixedColumnsStart");return(d,h)=>{var f;const{columnIndexMapper:g,view:m}=this.hot;let p=g.getVisualFromRenderableIndex(d);p===null&&(p=d),h.removeAttribute("colspan"),removeClass$1(h,"hiddenHeader"),removeClass$1(h,"hiddenHeaderText");const{colspan:v,isHidden:w,isPlaceholder:E,headerClassNames:C}=(f=_classPrivateFieldGet$c(_stateManager,this).getHeaderSettings(s,p))!==null&&f!==void 0?f:{};if(E||w)addClass$1(h,"hiddenHeader");else if(v>1){var b,P,R;const{wtOverlays:T}=m._wt,I=(b=T.topInlineStartCornerOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(h),M=(P=T.inlineStartOverlay)===null||P===void 0?void 0:P.clone.wtTable.THEAD.contains(h);((R=T.topOverlay)===null||R===void 0?void 0:R.clone.wtTable.THEAD.contains(h))&&p<u&&addClass$1(h,"hiddenHeaderText");const H=I||M?Math.min(v,u-d):v;H>1&&h.setAttribute("colspan",H)}if(this.hot.view.appendColHeader(p,h,function(){return c.getColumnHeaderValue(...arguments)},s),!E&&!w){const T=h.querySelector("div.relative");T&&C&&C.length>0&&(removeClass$1(T,this.hot.getColumnMeta(p).headerClassName),addClass$1(T,C))}}}getColumnHeaderValue(s,c){var u;const{isHidden:d,isPlaceholder:h}=(u=_classPrivateFieldGet$c(_stateManager,this).getHeaderSettings(c,s))!==null&&u!==void 0?u:{};return h||d?"":this.hot.getColHeader(s,c)}destroy(){_classPrivateFieldSet$b(_stateManager,this,null),_classPrivateFieldGet$c(_hidingIndexMapObserver,this)!==null&&(_classPrivateFieldGet$c(_hidingIndexMapObserver,this).unsubscribe(),_classPrivateFieldSet$b(_hidingIndexMapObserver,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(s){if(!(s.row>=0||s.col<0))return _classPrivateFieldGet$c(_stateManager,this).getHeaderTreeNodeData(s.row,s.col)}}function _onBeforeViewportScrollHorizontally(a,s){var c;const u=this.hot.getSelectedRangeActive();if(!u)return a;const{highlight:d}=u,{navigableHeaders:h}=this.hot.getSettings(),f=this.hot.selection.isSelectedByColumnHeader(),g=h?d.row:(c=_classPrivateFieldGet$c(_recentlyHighlightCoords,this))===null||c===void 0?void 0:c.row,m=f?a:d.col,p=g<0&&m>=0;if(_classPrivateFieldSet$b(_recentlyHighlightCoords,this,null),!p)return a;const v=this.hot.getFirstFullyVisibleColumn(),w=this.hot.getLastFullyVisibleColumn(),E=w-v+1,C=_classPrivateFieldGet$c(_stateManager,this).findLeftMostColumnIndex(g,m),b=_classPrivateFieldGet$c(_stateManager,this).findRightMostColumnIndex(g,m),P=b-C+1;if(C<v&&b>w)return C;if(f){let R=null;return C>=v&&b>w?P>E?(s.value="start",R=C):(s.value="end",R=b):C<v&&b<=w&&(P>E?(s.value="end",R=b):(s.value="start",R=C)),R}return C<=v?C:b}function _onBeforeHighlightingColumnHeader(a,s,c){const u=_classPrivateFieldGet$c(_stateManager,this).getHeaderTreeNodeData(s,a);if(!u)return a;const{columnCursor:d,selectionType:h,selectionWidth:f}=c,{isRoot:g,colspan:m}=_classPrivateFieldGet$c(_stateManager,this).getHeaderSettings(s,a);if(h===HEADER_TYPE){if(!g)return u.columnIndex}else if(h===ACTIVE_HEADER_TYPE&&(m>f-d||!g))return null;return a}function _onBeforeCopy(a,s,c){let{columnHeadersCount:u}=c;if(u!==0)for(let h=0;h<s.length;h++){const{startRow:f,startCol:g,endRow:m,endCol:p}=s[h],v=m-f+1,w=g-p+1;if(f>=0||w===1)break;for(let E=g;E<=p;E++)for(let C=f;C<=m;C++){var d;const b=v+C,P=E-g;if(P===0)continue;((d=_classPrivateFieldGet$c(_stateManager,this).getHeaderTreeNodeData(C,E))===null||d===void 0?void 0:d.isRoot)===!1&&(a[b][P]="")}}}function _onBeforeOnCellMouseDown$1(a,s,c,u){this._getHeaderTreeNodeDataByCoords(s)&&(u.column=!0)}function _onAfterOnCellMouseDown(a,s){const c=this._getHeaderTreeNodeDataByCoords(s);if(!c)return;_classPrivateFieldSet$b(_focusInitialCoords,this,s.clone()),_classPrivateFieldSet$b(_isColumnsSelectionInProgress,this,!0);const{selection:u}=this.hot,d=u.isSelected()?u.getSelectedRange().current():null,h=[],{columnIndex:f,origColspan:g}=c,m=!u.inInSelection(s);a.shiftKey&&d?s.col<d.from.col?h.push(d.getTopEndCorner().col,f,s.row):s.col>d.from.col?h.push(d.getTopStartCorner().col,f+g-1,s.row):h.push(f,f+g-1,s.row):(isLeftClick(a)||isRightClick(a)&&m||isTouchEvent(a))&&h.push(f,f+g-1,s.row),u.selectColumns(...h)}function _onBeforeOnCellMouseOver(a,s,c,u){if(!this.hot.view.isMouseDown()||u.column)return;const d=this._getHeaderTreeNodeDataByCoords(s);if(!d)return;const{columnIndex:h,origColspan:f}=d,g=this.hot.getSelectedRangeActive(),m=g.getTopStartCorner(),p=g.getBottomEndCorner(),{from:v}=g;u.column=!0,u.cell=!0;const w=[],E=clamp(s.row,-1/0,-1);s.col<v.col?w.push(p.col,h,E):s.col>v.col?w.push(m.col,h+f-1,E):w.push(h,h+f-1,E),this.hot.selection.selectColumns(...w)}function _onBeforeOnCellMouseUp(){_classPrivateFieldSet$b(_isColumnsSelectionInProgress,this,!1)}function _onBeforeSelectionHighlightSet$1(){const{navigableHeaders:a}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!_classPrivateFieldGet$c(_isColumnsSelectionInProgress,this)||!a)return;const s=this.hot.getSelectedRangeLast(),c=s.getTopStartCorner().col,u=s.getBottomEndCorner().col,{columnIndex:d,origColspan:h}=_classPrivateFieldGet$c(_stateManager,this).getHeaderTreeNodeData(_classPrivateFieldGet$c(_focusInitialCoords,this).row,_classPrivateFieldGet$c(_focusInitialCoords,this).col);if(s.setHighlight(_classPrivateFieldGet$c(_focusInitialCoords,this)),h>s.getWidth()||d<c||d+h-1>u){const f=_classPrivateFieldGet$c(_stateManager,this).findTopMostEntireHeaderLevel(clamp(c,d,d+h-1),clamp(u,d,d+h-1));s.highlight.row=f,s.highlight.col=s.from.col}}function _onModifyTransformStart(a){const{highlight:s}=this.hot.getSelectedRangeActive(),c=this.hot._createCellCoords(s.row+a.row,s.col+a.col);if(!(c.isHeader()&&c.col>=0))return;const d=_classPrivateFieldGet$c(_stateManager,this).findLeftMostColumnIndex(c.row,c.col),h=_classPrivateFieldGet$c(_stateManager,this).findRightMostColumnIndex(c.row,c.col);if(a.col<0){const f=s.col>=d&&s.col<=h?d-1:h,g=this.hot.columnIndexMapper.getNearestNotHiddenIndex(f,-1);g===null?a.col=-this.hot.view.countRenderableColumnsInRange(0,s.col):a.col=-Math.max(this.hot.view.countRenderableColumnsInRange(g,s.col)-1,1)}else if(a.col>0){const f=s.col>=d&&s.col<=h?h+1:d,g=this.hot.columnIndexMapper.getNearestNotHiddenIndex(f,1);g===null?a.col=this.hot.view.countRenderableColumnsInRange(s.col,this.hot.countCols()):a.col=Math.max(this.hot.view.countRenderableColumnsInRange(s.col,g)-1,1)}}function _onBeforeSelectColumns(a,s,c){const u=a.row,d=this._getHeaderTreeNodeDataByCoords({row:u,col:a.col}),h=this._getHeaderTreeNodeDataByCoords({row:u,col:s.col});_classPrivateFieldSet$b(_recentlyHighlightCoords,this,c.clone()),s.col<a.col?(d&&(a.col=d.columnIndex+d.origColspan-1),h&&(s.col=h.columnIndex)):s.col>=a.col&&(d&&(a.col=d.columnIndex),h&&(s.col=h.columnIndex+h.origColspan-1))}function _onAfterGetColumnHeaderRenderers(a){if(_classPrivateFieldGet$c(_stateManager,this).getLayersCount()>0){a.length=0;for(let s=0;s<_classPrivateFieldGet$c(_stateManager,this).getLayersCount();s++)a.push(this.headerRendererFactory(s))}}function _onAfterViewportColumnCalculatorOverride(a){const s=_classPrivateFieldGet$c(_stateManager,this).getLayersCount();let c=a.startColumn,u=!!s;for(let d=0;d<s;d++){const h=_classPrivateFieldGet$c(_stateManager,this).findLeftMostColumnIndex(d,a.startColumn),f=this.hot.columnIndexMapper.getRenderableFromVisualIndex(h);if(h>=0&&(u=!1),isNumeric(f)&&f<a.startColumn){c=f;break}}a.startColumn=u?_classPrivateFieldGet$c(_stateManager,this).getHeaderTreeNodeData(0,c).columnIndex:c}function _onModifyColWidth$1(a,s){const c=this.ghostTable.getWidth(s);return a>c?a:c}function _onModifyColumnHeaderValue(a,s,c){var u;const{label:d}=(u=_classPrivateFieldGet$c(_stateManager,this).getHeaderTreeNodeData(c,s))!==null&&u!==void 0?u:{label:""};return d}function _onModifyFocusedElement(a,s){if(a<0)return this.hot.getCell(a,_classPrivateFieldGet$c(_stateManager,this).findLeftMostColumnIndex(a,s),!0)}function _onInit$1(){this.updatePlugin()}function _onAfterLoadData(a,s){s||this.updatePlugin()}function _defineProperty$q(a,s,c){return(s=_toPropertyKey$q(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$q(a){var s=_toPrimitive$q(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$q(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DataManager{constructor(s,c){_defineProperty$q(this,"hot",void 0),_defineProperty$q(this,"data",null),_defineProperty$q(this,"plugin",void 0),_defineProperty$q(this,"parentReference",new WeakMap),_defineProperty$q(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=c,this.plugin=s}setData(s){this.data=s}getData(){return this.data}getRawSourceData(){let s=null;return this.plugin.disableCoreAPIModifiers(),s=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),s}updateWithData(s){this.setData(s),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},rangeEach(0,this.data.length-1,s=>{this.cacheNode(this.data[s],0,null)})}cacheNode(s,c,u){this.cache.levels[c]||(this.cache.levels[c]=[],this.cache.levelCount+=1),this.cache.levels[c].push(s),this.cache.rows.push(s),this.cache.nodeInfo.set(s,{parent:u,row:this.cache.rows.length-1,level:c}),this.hasChildren(s)&&arrayEach(s.__children,d=>{this.cacheNode(d,c+1,s)})}getDataObject(s){return s==null?null:this.cache.rows[s]}readTreeNodes(s,c,u,d){let h=!1,f=c;if(isNaN(f)&&f.end)return f;let g=s;return g||(g={__children:this.data},h=!0,f-=1),u!=null&&f===u?{result:g,end:!0}:d!=null&&g===d?{result:f,end:!0}:(f+=1,g.__children&&arrayEach(g.__children,m=>{if(this.parentReference.set(m,h?null:g),f=this.readTreeNodes(m,f,u,d),isNaN(f)&&f.end)return!1}),f)}mockParent(){const s=this.mockNode();return s.__children=this.data,s}mockNode(){const s={};return objectEach(this.data[0],(c,u)=>{s[u]=null}),s}getRowIndex(s){return s==null?null:this.cache.nodeInfo.get(s).row}getRowIndexWithinParent(s){let c=null;isNaN(s)?c=s:c=this.getDataObject(s);const u=this.getRowParent(s);return u==null?this.data.indexOf(c):u.__children.indexOf(c)}countAllRows(){const s={__children:this.data};return this.countChildren(s)}countChildren(s){let c=0,u=s;return isNaN(u)||(u=this.getDataObject(u)),!u||!u.__children?0:(arrayEach(u.__children,d=>{c+=1,d.__children&&(c+=this.countChildren(d))}),c)}getRowParent(s){let c;return isNaN(s)?c=s:c=this.getDataObject(s),this.getRowObjectParent(c)}getRowObjectParent(s){return!s||typeof s!="object"?null:this.cache.nodeInfo.get(s).parent}getRowLevel(s){let c=null;return isNaN(s)?c=s:c=this.getDataObject(s),c?this.getRowObjectLevel(c):null}getRowObjectLevel(s){return s==null?null:this.cache.nodeInfo.get(s).level}hasChildren(s){let c=s;return isNaN(c)||(c=this.getDataObject(c)),!!(c.__children&&c.__children.length)}isChild(s){return this.getRowParent(s)!==null}getChild(s,c){var u;return((u=s.__children)===null||u===void 0?void 0:u[c])||null}isRowHighestLevel(s){return!this.isChild(s)}isParent(s){var c;let u=s;return isNaN(u)||(u=this.getDataObject(u)),u&&!!u.__children&&((c=u.__children)===null||c===void 0?void 0:c.length)!==0}addChild(s,c){let u=c;this.hot.runHooks("beforeAddChild",s,u);let d=null;s&&(d=this.getRowIndex(s)),this.hot.runHooks("beforeCreateRow",d+this.countChildren(s)+1,1);let h=s;s||(h=this.mockParent()),h.__children||(h.__children=[]),u||(u=this.mockNode()),h.__children.push(u),this.rewriteCache();const f=this.getRowIndex(u);this.hot.rowIndexMapper.insertIndexes(f,1),this.hot.runHooks("afterCreateRow",f,1),this.hot.runHooks("afterAddChild",s,u)}addChildAtIndex(s,c,u){let d=u,h;if(d||(d=this.mockNode()),this.hot.runHooks("beforeAddChild",s,d,c),s){const g=this.getRowIndex(s)+c+1;this.hot.runHooks("beforeCreateRow",g,1),s.__children.splice(c,null,d),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(s),"__children",s.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(g,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",g,1),h=g}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",c,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),h=this.getRowIndex(this.data[c]);d=this.getDataObject(h),this.hot.runHooks("afterAddChild",s,d,c)}addSibling(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const u=this.translateTrimmedRow(s),d=this.getRowParent(u),h=this.getRowIndexWithinParent(u);switch(c){case"below":this.addChildAtIndex(d,h+1,null);break;case"above":this.addChildAtIndex(d,h,null);break}}detachFromParent(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=null;const d=[];Array.isArray(s)?(rangeEach(s[0],s[2],E=>{const C=this.translateTrimmedRow(E);d.push(this.getDataObject(C))}),rangeEach(0,d.length-2,E=>{this.detachFromParent(d[E],!1)}),u=d[d.length-1]):u=s;const h=this.getRowIndex(u),f=this.countChildren(u),g=this.getRowIndexWithinParent(u),m=this.getRowParent(u),p=this.getRowParent(m),v=this.getRowIndex(p);let w=null;if(this.hot.runHooks("beforeDetachChild",m,u),g!=null){const E=Array.from(new Array(h+f+1).keys()).splice(-1*(f+1));if(this.hot.runHooks("beforeRemoveRow",h,f+1,E,this.plugin.pluginName),m.__children.splice(g,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",h,f+1,E,this.plugin.pluginName),p){w=v+this.countChildren(p);const C=this.getChild(p,this.countChildren(p)-1),b=this.getRowIndex(C);this.hot.runHooks("beforeCreateRow",b+1,f+1,this.plugin.pluginName),p.__children.push(u)}else w=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",w-2,f+1,this.plugin.pluginName),this.data.push(u)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",w-2,f+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",m,u,this.getRowIndex(u)),c&&this.hot.render()}filterData(s,c,u){const d=[];arrayEach(u,h=>{d.push(this.getDataObject(h))}),arrayEach(d,h=>{const f=this.getRowIndexWithinParent(h),g=this.getRowParent(h);g===null?this.data.splice(f,1):g.__children.splice(f,1)}),this.rewriteCache()}spliceData(s,c,u){const d=this.getDataObject(s-1);let h=null,f=s;d&&d.__children&&d.__children.length===0?(h=d,f=0):s<this.countAllRows()&&(h=this.getRowParent(s),f=this.getRowIndexWithinParent(s)),h?u?h.__children.splice(f,c,...u):h.__children.splice(f,c):u?this.data.splice(f,c,...u):this.data.splice(f,c),this.rewriteCache()}syncRowWithRawSource(s){let c=s,u=c;do u=this.getRowParent(u),u!==null&&(c=u);while(u!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(c),"__children",c.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(s,c,u,d){const h=c===this.hot.countRows(),f=this.getRowParent(s),g=this.getRowIndexWithinParent(s),m=f.__children.slice(g,g+1),p=s>c;let v=h?this.getRowParent(c-1):this.getRowParent(c);v==null&&(v=this.getRowParent(c-1)),v==null&&(v=this.getDataObject(c-1)),v?v.__children||(v.__children=[]):(v=this.getDataObject(c),v.__children=[]);const w=h||u||d?v.__children.length:this.getRowIndexWithinParent(c),E=f===v;v.__children.splice(w,0,m[0]),f.__children.splice(g+(p&&E?1:0),1),this.syncRowWithRawSource(f),E||this.syncRowWithRawSource(v)}translateTrimmedRow(s){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(s):s}untranslateTrimmedRow(s){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(s):s}}function _defineProperty$p(a,s,c){return(s=_toPropertyKey$p(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$p(a){var s=_toPrimitive$p(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$p(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class BaseUI{constructor(s,c){_defineProperty$p(this,"hot",void 0),_defineProperty$p(this,"plugin",void 0),this.hot=c,this.plugin=s}}class HeadersUI extends BaseUI{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(s,c){super(s,c),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(s,c){const u=this.hot.toPhysicalRow(s),d=this.dataManager.getDataObject(u);if(!d)return;const h=this.dataManager.getRowLevel(u),f=c.getElementsByTagName("DIV")[0],g=f.querySelector("span.rowHeader"),m=f.querySelectorAll('[class^="ht_nesting"]'),p=this.hot.getSettings().ariaTags;if(arrayEach(m,v=>{v&&f.removeChild(v)}),addClass$1(c,HeadersUI.CSS_CLASSES.indicatorContainer),h){const{rootDocument:v}=this.hot,w=g.cloneNode(!0);f.innerHTML="",rangeEach(0,h-1,()=>{const E=v.createElement("SPAN");addClass$1(E,HeadersUI.CSS_CLASSES.emptyIndicator),f.appendChild(E)}),f.appendChild(w)}if(this.dataManager.hasChildren(d)){const v=this.hot.rootDocument.createElement("DIV");p&&setAttribute(v,[A11Y_HIDDEN()]),addClass$1(c,HeadersUI.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(u)?(addClass$1(v,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.expandButton}`),p&&setAttribute(c,[A11Y_EXPANDED(!1)])):(addClass$1(v,`${HeadersUI.CSS_CLASSES.button} ${HeadersUI.CSS_CLASSES.collapseButton}`),p&&setAttribute(c,[A11Y_EXPANDED(!0)])),f.appendChild(v)}}updateRowHeaderWidth(s){let c=s;c||(c=this.dataManager.cache.levelCount);let u=11;this.hot.stylesHandler.isClassicTheme()||(u=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,u+10*c+25),this.hot.render()}}class CollapsingUI extends BaseUI{constructor(s,c){var u;super(s,c),u=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;u.lastCollapsedRows=u.collapsedRows.slice(0),u.expandMultipleChildren(u.lastCollapsedRows,d)},shiftStash:function(d,h){let f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;h==null&&(h=1/0),arrayEach(u.lastCollapsedRows,(g,m)=>{g>=d&&g<h&&(u.lastCollapsedRows[m]=g+f)})},applyStash:function(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;u.collapseMultipleChildren(u.lastCollapsedRows,d),u.lastCollapsedRows=void 0},trimStash:(d,h)=>{rangeEach(d,d+h-1,f=>{const g=this.lastCollapsedRows.indexOf(f);g>-1&&this.lastCollapsedRows.splice(g,1)})}}}collapseChildren(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const d=[];let h=null,f=null,g=null;return isNaN(s)?(h=s,f=this.dataManager.getRowIndex(h)):(h=this.dataManager.getDataObject(s),f=s),this.dataManager.hasChildren(h)&&arrayEach(h.__children,m=>{d.push(this.dataManager.getRowIndex(m))}),g=this.collapseRows(d,!0,!1),u&&this.trimRows(g),c&&this.renderAndAdjust(),this.collapsedRows.indexOf(f)===-1&&this.collapsedRows.push(f),g}collapseMultipleChildren(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const d=[];arrayEach(s,h=>{d.push(...this.collapseChildren(h,!1,!1))}),u&&this.trimRows(d),c&&this.renderAndAdjust()}collapseRow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([s],c)}collapseRows(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=[];return arrayEach(s,h=>{d.push(h),c&&this.collapseChildRows(h,d)}),u&&this.trimRows(d),d}collapseChildRows(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(s)){const d=this.dataManager.getDataObject(s);arrayEach(d.__children,h=>{const f=this.dataManager.getRowIndex(h);c.push(f),this.collapseChildRows(f,c)})}u&&this.trimRows(c)}expandRow(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([s],c)}expandRows(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const d=[];return arrayEach(s,h=>{d.push(h),c&&this.expandChildRows(h,d)}),u&&this.untrimRows(d),d}expandChildRows(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(s)){const d=this.dataManager.getDataObject(s);arrayEach(d.__children,h=>{if(!this.isAnyParentCollapsed(h)){const f=this.dataManager.getRowIndex(h);c.push(f),this.expandChildRows(f,c)}})}u&&this.untrimRows(c)}expandChildren(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const d=[];let h=null,f=null,g=null;return isNaN(s)?(h=s,f=this.dataManager.getRowIndex(s)):(h=this.dataManager.getDataObject(s),f=s),this.collapsedRows.splice(this.collapsedRows.indexOf(f),1),this.dataManager.hasChildren(h)&&arrayEach(h.__children,m=>{const p=this.dataManager.getRowIndex(m);d.push(p)}),g=this.expandRows(d,!0,!1),u&&this.untrimRows(g),c&&this.renderAndAdjust(),g}expandMultipleChildren(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const d=[];arrayEach(s,h=>{d.push(...this.expandChildren(h,!1,!1))}),u&&this.untrimRows(d),c&&this.renderAndAdjust()}collapseAll(){const s=this.dataManager.getData(),c=[];arrayEach(s,u=>{this.dataManager.hasChildren(u)&&c.push(u)}),this.collapseMultipleChildren(c),this.renderAndAdjust()}expandAll(){const s=this.dataManager.getData(),c=[];arrayEach(s,u=>{this.dataManager.hasChildren(u)&&c.push(u)}),this.expandMultipleChildren(c),this.renderAndAdjust()}trimRows(s){this.hot.batchExecution(()=>{arrayEach(s,c=>{this.plugin.collapsedRowsMap.setValueAtIndex(c,!0)})},!0)}untrimRows(s){this.hot.batchExecution(()=>{arrayEach(s,c=>{this.plugin.collapsedRowsMap.setValueAtIndex(c,!1)})},!0)}areChildrenCollapsed(s){let c=isNaN(s)?s:this.dataManager.getDataObject(s),u=!0;return c===null&&(c={__children:this.dataManager.data}),this.dataManager.hasChildren(c)&&arrayEach(c.__children,d=>{const h=this.dataManager.getRowIndex(d);if(!this.plugin.collapsedRowsMap.getValueAtIndex(h))return u=!1,!1}),u}isAnyParentCollapsed(s){let c=s;for(;c!==null;){c=this.dataManager.getRowParent(c);const u=this.dataManager.getRowIndex(c);if(this.collapsedRows.indexOf(u)>-1)return!0}return!1}toggleState(s,c){if(c.col>=0)return;const u=this.translateTrimmedRow(c.row);hasClass$1(s.target,HeadersUI.CSS_CLASSES.button)&&(this.areChildrenCollapsed(u)?this.expandChildren(u):this.collapseChildren(u),stopImmediatePropagation(s))}translateTrimmedRow(s){return this.hot.toPhysicalRow(s)}untranslateTrimmedRow(s){return this.hot.toVisualRow(s)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function _classPrivateFieldInitSpec$b(a,s,c){_checkPrivateRedeclaration$f(a,s),s.set(a,c)}function _checkPrivateRedeclaration$f(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$o(a,s,c){return(s=_toPropertyKey$o(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$o(a){var s=_toPrimitive$o(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$o(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$b(a,s){return a.get(_assertClassBrand$f(a,s))}function _assertClassBrand$f(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _menuEntries=new WeakMap;class ContextMenuUI extends BaseUI{constructor(){super(...arguments),_defineProperty$o(this,"dataManager",this.plugin.dataManager),_classPrivateFieldInitSpec$b(this,_menuEntries,{row_above:(s,c)=>{const u=c[c.length-1];this.dataManager.addSibling(u.start.row,"above")},row_below:(s,c)=>{const u=c[c.length-1];this.dataManager.addSibling(u.start.row,"below")}})}appendOptions(s){const c=[{key:"add_child",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD)},callback:()=>{const u=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),d=this.dataManager.getDataObject(u);this.dataManager.addChild(d)},disabled:()=>{const u=this.hot.getSelectedActive();return!u||u[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const u=this.hot.getSelectedActive(),d=this.dataManager.translateTrimmedRow(u[0]);return!this.dataManager.getRowParent(d)||!u||u[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return rangeEach(0,s.items.length-1,u=>{if(u===0)return arrayEach(c,(d,h)=>{s.items.splice(u+h,0,d)}),!1}),this.modifyRowInsertingOptions(s)}modifyRowInsertingOptions(s){return rangeEach(0,s.items.length-1,c=>{const u=_classPrivateFieldGet$b(_menuEntries,this)[s.items[c].key];u!=null&&(s.items[c].callback=u)}),s}}function _defineProperty$n(a,s,c){return(s=_toPropertyKey$n(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$n(a){var s=_toPrimitive$n(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$n(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RowMoveController{constructor(s){_defineProperty$n(this,"plugin",void 0),_defineProperty$n(this,"hot",void 0),_defineProperty$n(this,"dataManager",void 0),_defineProperty$n(this,"collapsingUI",void 0),this.plugin=s,this.hot=s.hot,this.dataManager=s.dataManager,this.collapsingUI=s.collapsingUI}onBeforeRowMove(s,c,u,d){if(this.displayAPICompatibilityWarning({rows:s,finalIndex:c,dropIndex:u,movePossible:d}))return!1;this.movedToCollapsed=!1;const f=u===this.hot.countRows(),g=f?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(u);let m=!0;const p=s.map(b=>{if(!m)return!1;const P=this.dataManager.translateTrimmedRow(b);return m=this.shouldAllowMoving(P,g),P}),v=p.indexOf(g)===-1;if(!m||!v)return!1;const w=this.getBaseParent(p),E=this.getTargetParent(f,g),C=w===E;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(E),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(p,g,C),this.moveRows(p,g,E),this.dataManager.rewriteCache(),this.moveCellsMeta(p,g),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",s,c,u,d,d&&this.isRowOrderChanged(s,c)),this.hot.render(),this.selectCells(s,u),!1}displayAPICompatibilityWarning(s){const{rows:c,finalIndex:u,dropIndex:d,movePossible:h}=s;let f=!1;return isUndefined(d)&&(warn$1(toSingleLine`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",c,u,d,h,!1),f=!0),f}shouldAllowMoving(s,c){return!(this.dataManager.isParent(s)||this.dataManager.isRowHighestLevel(s)||s===c||c===0)}getBaseParent(s){return this.dataManager.getRowParent(s[0])}getTargetParent(s,c){let u=this.dataManager.getRowParent(s?c-1:c);return u==null&&(u=this.dataManager.getRowParent(c-1)),u}shiftCollapsibleParentsLocations(s,c,u){u||(Math.max(...s)<=c?this.collapsingUI.collapsedRowsStash.shiftStash(s[0],c,-1*s.length):this.collapsingUI.collapsedRowsStash.shiftStash(c,s[0],s.length))}moveRows(s,c,u){const d=c===this.dataManager.getRowIndex(u)+this.dataManager.countChildren(u)+1;this.hot.batchRender(()=>{s.forEach(h=>{this.dataManager.moveRow(h,c,this.movedToCollapsed,d)})})}moveCellsMeta(s,c){const u=[],d=Math.max(...s)<c;s.forEach(h=>{u.push(this.hot.getCellMetaAtRow(h))}),this.hot.spliceCellsMeta(s[0],s.length),this.hot.spliceCellsMeta(c-(d?u.length:0),0,...u)}selectCells(s,c){const u=s.length;let d=0,h=0;if(this.movedToCollapsed){let f=null;s[u-1]<c?f=this.dataManager.translateTrimmedRow(c-u):f=this.dataManager.translateTrimmedRow(c);const g=this.dataManager.getRowParent(f===null?this.hot.countSourceRows()-1:f-1),m=this.dataManager.getRowIndex(g);d=this.dataManager.untranslateTrimmedRow(m),h=d}else s[u-1]<c?(h=c-1,d=h-u+1):(d=c,h=d+u-1);this.hot.selectCells([[d,0,h,this.hot.countCols()-1]],!1)}isRowOrderChanged(s,c){return s.some((u,d)=>u-d!==c)}}function _classPrivateMethodInitSpec$c(a,s){_checkPrivateRedeclaration$e(a,s),s.add(a)}function _classPrivateFieldInitSpec$a(a,s,c){_checkPrivateRedeclaration$e(a,s),s.set(a,c)}function _checkPrivateRedeclaration$e(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$m(a,s,c){return(s=_toPropertyKey$m(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$m(a){var s=_toPrimitive$m(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$m(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _classPrivateFieldGet$a(a,s){return a.get(_assertClassBrand$e(a,s))}function _classPrivateFieldSet$a(a,s,c){return a.set(_assertClassBrand$e(a,s),c),c}function _assertClassBrand$e(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$a="nestedRows",PLUGIN_PRIORITY$a=300,SHORTCUTS_GROUP$2=PLUGIN_KEY$a,WRONG_DATA_TYPE_ERROR="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var _skipRender=new WeakMap,_skipCoreAPIModifiers=new WeakMap,_NestedRows_brand=new WeakSet;class NestedRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$c(this,_NestedRows_brand),_defineProperty$m(this,"dataManager",null),_defineProperty$m(this,"headersUI",null),_defineProperty$m(this,"collapsedRowsMap",null),_classPrivateFieldInitSpec$a(this,_skipRender,!1),_classPrivateFieldInitSpec$a(this,_skipCoreAPIModifiers,!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$a}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$a}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$a]}enablePlugin(){var s=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new TrimmingMap),this.dataManager=new DataManager(this,this.hot),this.collapsingUI=new CollapsingUI(this,this.hot),this.headersUI=new HeadersUI(this,this.hot),this.contextMenuUI=new ContextMenuUI(this,this.hot),this.rowMoveController=new RowMoveController(this),this.addHook("afterInit",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterInit$1).call(s,...u)}),this.addHook("beforeViewRender",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onBeforeViewRender).call(s,...u)}),this.addHook("modifyRowData",function(){return s.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return s.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return s.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onFilterData).call(s,...u)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterContextMenuDefaultOptions).call(s,...u)}),this.addHook("afterGetRowHeader",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterGetRowHeader).call(s,...u)}),this.addHook("beforeOnCellMouseDown",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onBeforeOnCellMouseDown).call(s,...u)}),this.addHook("beforeRemoveRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onBeforeRemoveRow).call(s,...u)}),this.addHook("afterRemoveRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterRemoveRow).call(s,...u)}),this.addHook("beforeAddChild",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onBeforeAddChild).call(s,...u)}),this.addHook("afterAddChild",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterAddChild).call(s,...u)}),this.addHook("beforeDetachChild",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onBeforeDetachChild).call(s,...u)}),this.addHook("afterDetachChild",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterDetachChild).call(s,...u)}),this.addHook("modifyRowHeaderWidth",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onModifyRowHeaderWidth).call(s,...u)}),this.addHook("afterCreateRow",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onAfterCreateRow).call(s,...u)}),this.addHook("beforeRowMove",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$e(_NestedRows_brand,s,_onBeforeRowMove).call(s,...u)}),this.addHook("beforeLoadData",c=>_assertClassBrand$e(_NestedRows_brand,this,_onBeforeLoadData).call(this,c)),this.addHook("beforeUpdateData",c=>_assertClassBrand$e(_NestedRows_brand,this,_onBeforeLoadData).call(this,c)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const s=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(s),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:s}=this.hot.getSelectedRangeActive(),c=this.collapsingUI.translateTrimmedRow(s.row);return this.collapsingUI.areChildrenCollapsed(c)?this.collapsingUI.expandChildren(c):this.collapsingUI.collapseChildren(c),!1},runOnlyIf:()=>{var s,c;const u=(s=this.hot.getSelectedRangeActive())===null||s===void 0?void 0:s.highlight;return u&&((c=this.hot.getSelectedRangeActive())===null||c===void 0?void 0:c.isSingle())&&this.hot.selection.isCellVisible(u)&&u.col===-1&&u.row>=0},group:SHORTCUTS_GROUP$2,relativeToGroup:EDITOR_EDIT_GROUP,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$2)}disableCoreAPIModifiers(){_classPrivateFieldSet$a(_skipCoreAPIModifiers,this,!0)}enableCoreAPIModifiers(){_classPrivateFieldSet$a(_skipCoreAPIModifiers,this,!1)}onModifyRowData(s){if(!_classPrivateFieldGet$a(_skipCoreAPIModifiers,this))return this.dataManager.getDataObject(s)}onModifySourceLength(){if(!_classPrivateFieldGet$a(_skipCoreAPIModifiers,this))return this.dataManager.countAllRows()}onBeforeDataSplice(s,c,u){return _classPrivateFieldGet$a(_skipCoreAPIModifiers,this)||this.dataManager.isRowHighestLevel(s)?!0:(this.dataManager.spliceData(s,c,u),!1)}destroy(){super.destroy()}}function _onBeforeRowMove(a,s,c,u){return this.rowMoveController.onBeforeRowMove(a,s,c,u)}function _onBeforeOnCellMouseDown(a,s,c){this.collapsingUI.toggleState(a,s,c)}function _onFilterData(a,s,c){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(c[0],s),this.collapsingUI.collapsedRowsStash.shiftStash(c[0],null,-1*s),this.dataManager.filterData(a,s,c),_classPrivateFieldSet$a(_skipRender,this,!0),this.dataManager.getData().slice()}function _onAfterContextMenuDefaultOptions(a){return this.contextMenuUI.appendOptions(a)}function _onAfterGetRowHeader(a,s){this.headersUI.appendLevelIndicators(a,s)}function _onModifyRowHeaderWidth(a){return Math.max(this.headersUI.rowHeaderWidthCache,a)}function _onAfterRemoveRow(a,s,c,u){u!==this.pluginName&&this.hot._registerTimeout(()=>{_classPrivateFieldSet$a(_skipRender,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function _onBeforeRemoveRow(a,s,c){const u=Array.from(c.reduce((d,h)=>{if(this.dataManager.isParent(h)){const f=this.dataManager.getDataObject(h).__children;return d.add(h),Array.isArray(f)&&f.forEach(g=>d.add(this.dataManager.getRowIndex(g))),d}return d.add(h)},new Set));c.length=0,c.push(...u)}function _onBeforeAddChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterAddChild(a,s){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(s)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onBeforeDetachChild(){this.collapsingUI.collapsedRowsStash.stash()}function _onAfterDetachChild(a,s,c){this.collapsingUI.collapsedRowsStash.shiftStash(c,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function _onAfterCreateRow(){this.dataManager.rewriteCache()}function _onAfterInit$1(){this.headersUI.updateRowHeaderWidth()}function _onBeforeViewRender(a,s){_classPrivateFieldGet$a(_skipRender,this)&&(s.skipRender=!0)}function _onBeforeLoadData(a){if(!isArrayOfObjects(a)){error(WRONG_DATA_TYPE_ERROR),this.hot.getSettings()[PLUGIN_KEY$a]=!1,this.disablePlugin();return}this.dataManager.setData(a),this.dataManager.rewriteCache()}function _classPrivateMethodInitSpec$b(a,s){_checkPrivateRedeclaration$d(a,s),s.add(a)}function _classPrivateFieldInitSpec$9(a,s,c){_checkPrivateRedeclaration$d(a,s),s.set(a,c)}function _checkPrivateRedeclaration$d(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$9(a,s){return a.get(_assertClassBrand$d(a,s))}function _classPrivateFieldSet$9(a,s,c){return a.set(_assertClassBrand$d(a,s),c),c}function _assertClassBrand$d(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const TEMPLATE$1=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var _rootElement$2=new WeakMap,_uiContainer=new WeakMap,_isRtl$1=new WeakMap,_refs$2=new WeakMap,_themeName=new WeakMap,_phraseTranslator=new WeakMap,_shouldHaveBorder=new WeakMap,_a11yAnnouncer=new WeakMap,_PaginationUI_brand=new WeakSet;class PaginationUI{constructor(s){let{rootElement:c,uiContainer:u,isRtl:d,themeName:h,phraseTranslator:f,shouldHaveBorder:g,a11yAnnouncer:m}=s;_classPrivateMethodInitSpec$b(this,_PaginationUI_brand),_classPrivateFieldInitSpec$9(this,_rootElement$2,void 0),_classPrivateFieldInitSpec$9(this,_uiContainer,void 0),_classPrivateFieldInitSpec$9(this,_isRtl$1,!1),_classPrivateFieldInitSpec$9(this,_refs$2,void 0),_classPrivateFieldInitSpec$9(this,_themeName,void 0),_classPrivateFieldInitSpec$9(this,_phraseTranslator,void 0),_classPrivateFieldInitSpec$9(this,_shouldHaveBorder,void 0),_classPrivateFieldInitSpec$9(this,_a11yAnnouncer,void 0),_classPrivateFieldSet$9(_rootElement$2,this,c),_classPrivateFieldSet$9(_uiContainer,this,u),_classPrivateFieldSet$9(_isRtl$1,this,d),_classPrivateFieldSet$9(_themeName,this,h),_classPrivateFieldSet$9(_phraseTranslator,this,f),_classPrivateFieldSet$9(_shouldHaveBorder,this,g),_classPrivateFieldSet$9(_a11yAnnouncer,this,m),this.install()}install(){var s;if((s=_classPrivateFieldGet$9(_refs$2,this))!==null&&s!==void 0&&s.container)return;const c=html`${TEMPLATE$1}`,{container:u,first:d,prev:h,next:f,last:g,pageSizeSelect:m}=c.refs;_classPrivateFieldSet$9(_refs$2,this,c.refs),u.setAttribute("dir",_classPrivateFieldGet$9(_isRtl$1,this)?"rtl":"ltr"),u.tabIndex=-1;const p=w=>w.currentTarget.disabled,v=(w,E,C)=>{E.addEventListener(w,b=>{p(b)||C()})};v("click",d,()=>this.runLocalHooks("firstPageClick")),v("click",h,()=>this.runLocalHooks("prevPageClick")),v("click",f,()=>this.runLocalHooks("nextPageClick")),v("click",g,()=>this.runLocalHooks("lastPageClick")),m.addEventListener("change",()=>{const w=m.value==="auto"?"auto":Number.parseInt(m.value,10);this.runLocalHooks("pageSizeChange",w)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),_classPrivateFieldGet$9(_uiContainer,this)?(_classPrivateFieldGet$9(_uiContainer,this).appendChild(c.fragment),addClass$1(u,[_classPrivateFieldGet$9(_themeName,this),"handsontable"])):_classPrivateFieldGet$9(_rootElement$2,this).after(c.fragment)}getContainer(){return _classPrivateFieldGet$9(_refs$2,this).container}getFocusableElements(){const{first:s,prev:c,next:u,last:d,pageSizeSelect:h}=_classPrivateFieldGet$9(_refs$2,this);return[h,s,c,u,d].filter(f=>!f.disabled)}updateWidth(s){return _classPrivateFieldGet$9(_refs$2,this).container.style.width=`${s}px`,this}updateTheme(s){if(_classPrivateFieldSet$9(_themeName,this,s),_classPrivateFieldGet$9(_uiContainer,this)){const{container:c}=_classPrivateFieldGet$9(_refs$2,this);removeClass$1(c,/ht-theme-.*/g),_classPrivateFieldGet$9(_themeName,this)&&addClass$1(c,_classPrivateFieldGet$9(_themeName,this))}return this}getHeight(){return _classPrivateFieldGet$9(_refs$2,this).container.offsetHeight}refreshBorderState(){const{container:s}=_classPrivateFieldGet$9(_refs$2,this);return _classPrivateFieldGet$9(_uiContainer,this)||_classPrivateFieldGet$9(_shouldHaveBorder,this).call(this)?addClass$1(s,"ht-pagination--bordered"):removeClass$1(s,"ht-pagination--bordered"),this}updateState(s){let{currentPage:c,totalPages:u,firstVisibleRowIndex:d,lastVisibleRowIndex:h,totalRenderedRows:f,pageSizeList:g,pageSize:m,autoPageSize:p}=s;const{first:v,prev:w,next:E,last:C,pageCounterSection:b,pageNavSection:P,pageNavLabel:R,pageSizeSelect:T,pageSizeLabel:I}=_classPrivateFieldGet$9(_refs$2,this),M=_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_COUNTER_SECTION,{start:d+1,end:h+1,total:f}),N=_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_NAV_SECTION,{currentPage:c,totalPages:u}),H=_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_PAGE_SIZE_SECTION);b.textContent=M,R.textContent=N,T.textContent="",I.textContent=`${H}:`,setAttribute(P,[A11Y_LABEL(_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_SECTION))]),setAttribute(T,[A11Y_LABEL(_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_PAGE_SIZE_SECTION))]),_classPrivateFieldGet$9(_a11yAnnouncer,this).call(this,N),this.refreshBorderState(),g.forEach(k=>{const W=k==="auto"?_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_PAGE_SIZE_AUTO):k,G=new Option(W,k);(p&&k==="auto"||!p&&k===m)&&(G.selected=!0),T.add(G)});const L=c===1,A=c===u;if(P.style.display!=="none"){const k=_classPrivateFieldGet$9(_rootElement$2,this).ownerDocument.activeElement;L?(addClass$1(v,"ht-page-navigation-section__button--disabled"),addClass$1(w,"ht-page-navigation-section__button--disabled"),v.disabled=!0,w.disabled=!0):(removeClass$1(v,"ht-page-navigation-section__button--disabled"),removeClass$1(w,"ht-page-navigation-section__button--disabled"),v.disabled=!1,w.disabled=!1),A?(addClass$1(E,"ht-page-navigation-section__button--disabled"),addClass$1(C,"ht-page-navigation-section__button--disabled"),E.disabled=!0,C.disabled=!0):(removeClass$1(E,"ht-page-navigation-section__button--disabled"),removeClass$1(C,"ht-page-navigation-section__button--disabled"),E.disabled=!1,C.disabled=!1),[v,w,E,C].includes(k)&&(w.disabled?E.focus():E.disabled&&w.focus())}return setAttribute(v,[A11Y_LABEL(_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_FIRST_PAGE)),A11Y_DISABLED(L)]),setAttribute(w,[A11Y_LABEL(_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_PREV_PAGE)),A11Y_DISABLED(L)]),setAttribute(E,[A11Y_LABEL(_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_NEXT_PAGE)),A11Y_DISABLED(A)]),setAttribute(C,[A11Y_LABEL(_classPrivateFieldGet$9(_phraseTranslator,this).call(this,PAGINATION_LAST_PAGE)),A11Y_DISABLED(A)]),this}setPageSizeSectionVisibility(s){const{pageSizeSection:c,pageSizeSelect:u}=_classPrivateFieldGet$9(_refs$2,this);return c.style.display=s?"":"none",u.disabled=!s,_assertClassBrand$d(_PaginationUI_brand,this,_updateContainerVisibility).call(this),this}setCounterSectionVisibility(s){return _classPrivateFieldGet$9(_refs$2,this).pageCounterSection.style.display=s?"":"none",_assertClassBrand$d(_PaginationUI_brand,this,_updateContainerVisibility).call(this),this}setNavigationSectionVisibility(s){const{pageNavSection:c,first:u,prev:d,next:h,last:f}=_classPrivateFieldGet$9(_refs$2,this);return c.style.display=s?"":"none",u.disabled=!s,d.disabled=!s,h.disabled=!s,f.disabled=!s,_assertClassBrand$d(_PaginationUI_brand,this,_updateContainerVisibility).call(this),this}destroy(){var s;(s=_classPrivateFieldGet$9(_refs$2,this))===null||s===void 0||s.container.remove(),_classPrivateFieldSet$9(_refs$2,this,null)}}function _updateContainerVisibility(){const{container:a,pageSizeSection:s,pageCounterSection:c,pageNavSection:u}=_classPrivateFieldGet$9(_refs$2,this),d=s.style.display!=="none"||c.style.display!=="none"||u.style.display!=="none";_classPrivateFieldGet$9(_uiContainer,this)||(d?addClass$1(_classPrivateFieldGet$9(_rootElement$2,this).querySelector(".ht-wrapper"),"htPagination"):removeClass$1(_classPrivateFieldGet$9(_rootElement$2,this).querySelector(".ht-wrapper"),"htPagination")),a.style.display=d?"":"none"}mixin(PaginationUI,localHooks);const CONFLICTING_OPTIONS=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function checkPluginSettingsConflict(a){return CONFLICTING_OPTIONS.some(s=>{const c=!!a[s];return c&&warn$1(toSingleLine`The \`pagination\` plugin cannot be used with the \`${s}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),c})}function _defineProperty$l(a,s,c){return(s=_toPropertyKey$l(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$l(a){var s=_toPrimitive$l(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$l(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class FixedPageSizeStrategy{constructor(){_defineProperty$l(this,"pageSize",1),_defineProperty$l(this,"totalItems",0),_defineProperty$l(this,"totalPages",0)}calculate(s){let{pageSize:c,totalItems:u}=s;this.pageSize=Math.max(c,1),this.totalItems=u,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(s){if(s-=1,s<0||s>=this.getTotalPages())return;const c=s*this.pageSize,u=Math.max(0,Math.min(c+this.pageSize-1,this.totalItems-1));return{startIndex:c,endIndex:u,pageSize:this.pageSize}}}function _defineProperty$k(a,s,c){return(s=_toPropertyKey$k(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$k(a){var s=_toPrimitive$k(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$k(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class AutoPageSizeStrategy{constructor(){_defineProperty$k(this,"pages",[])}calculate(s){let{itemsSizeProvider:c,viewportSizeProvider:u}=s;const d=c(),h=u(),f=[];let g=0,m=0,p=0;for(let v=0;v<d.length;v++){const w=d[v];p>0&&m+w>=h&&(f.push({startIndex:g,endIndex:v-1,pageSize:p}),g=v,m=0,p=0),m+=w,p+=1}f.push({startIndex:g,endIndex:Math.max(0,d.length-1),pageSize:p}),this.pages=f}getTotalPages(){return this.pages.length}getState(s){if(s-=1,!(s<0||s>=this.getTotalPages()))return this.pages[s]}}const strategies=new Map([["fixed",FixedPageSizeStrategy],["auto",AutoPageSizeStrategy]]);function createPaginatorStrategy(a){if(!strategies.has(a))throw new Error(`Unknown pagination strategy type: ${a}`);const s=strategies.get(a);return new s}function _classPrivateMethodInitSpec$a(a,s){_checkPrivateRedeclaration$c(a,s),s.add(a)}function _classPrivateFieldInitSpec$8(a,s,c){_checkPrivateRedeclaration$c(a,s),s.set(a,c)}function _checkPrivateRedeclaration$c(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$8(a,s){return a.get(_assertClassBrand$c(a,s))}function _classPrivateFieldSet$8(a,s,c){return a.set(_assertClassBrand$c(a,s),c),c}function _assertClassBrand$c(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$9="pagination",PLUGIN_PRIORITY$9=900,SHORTCUTS_CONTEXT_NAME$2=`plugin:${PLUGIN_KEY$9}`,AUTO_PAGE_SIZE_WARNING=toSingleLine`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var _pagedRowsMap=new WeakMap,_currentPage=new WeakMap,_pageSize=new WeakMap,_ui$2=new WeakMap,_calcStrategy=new WeakMap,_internalExecutionCall=new WeakMap,_internalRenderCall=new WeakMap,_Pagination_brand=new WeakSet,_onIndexCacheUpdate=new WeakMap;class Pagination extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$a(this,_Pagination_brand),_classPrivateFieldInitSpec$8(this,_pagedRowsMap,null),_classPrivateFieldInitSpec$8(this,_currentPage,1),_classPrivateFieldInitSpec$8(this,_pageSize,10),_classPrivateFieldInitSpec$8(this,_ui$2,null),_classPrivateFieldInitSpec$8(this,_calcStrategy,null),_classPrivateFieldInitSpec$8(this,_internalExecutionCall,!1),_classPrivateFieldInitSpec$8(this,_internalRenderCall,!1),_classPrivateFieldInitSpec$8(this,_onIndexCacheUpdate,()=>{var s;!_classPrivateFieldGet$8(_internalExecutionCall,this)&&(s=this.hot)!==null&&s!==void 0&&s.view&&_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this)})}static get PLUGIN_KEY(){return PLUGIN_KEY$9}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$9}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$9]}enablePlugin(){var s,c=this;if(checkPluginSettingsConflict(this.hot.getSettings())){this.hot.getSettings()[PLUGIN_KEY$9]=!1;return}if(this.enabled)return;const u=this.hot.getSettings()[PLUGIN_KEY$9];u?.initialPage!==void 0&&_classPrivateFieldSet$8(_currentPage,this,this.getSetting("initialPage")),u?.pageSize!==void 0&&_classPrivateFieldSet$8(_pageSize,this,this.getSetting("pageSize")),_classPrivateFieldSet$8(_pagedRowsMap,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),_classPrivateFieldGet$8(_pageSize,this)==="auto"&&!((s=this.hot.getPlugin("autoRowSize"))!==null&&s!==void 0&&s.enabled)&&warn$1(AUTO_PAGE_SIZE_WARNING),_classPrivateFieldSet$8(_calcStrategy,this,createPaginatorStrategy(_classPrivateFieldGet$8(_pageSize,this)==="auto"?"auto":"fixed")),_classPrivateFieldGet$8(_ui$2,this)||(_classPrivateFieldSet$8(_ui$2,this,new PaginationUI({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return c.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>_assertClassBrand$c(_Pagination_brand,this,_computeNeedsBorder).call(this),a11yAnnouncer:d=>announce(d)})),_assertClassBrand$c(_Pagination_brand,this,_updateSectionsVisibilityState).call(this),_classPrivateFieldGet$8(_ui$2,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",d=>this.setPageSize(d))),this.addHook("init",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onInit).call(c,...h)},-1),this.addHook("beforeSelectAll",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onBeforeSelectAllRows).call(c,...h)}),this.addHook("beforeSelectColumns",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onBeforeSelectAllRows).call(c,...h)}),this.addHook("beforeSetRangeEnd",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onBeforeSetRangeEnd).call(c,...h)}),this.addHook("beforeSelectionHighlightSet",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onBeforeSelectionHighlightSet).call(c,...h)}),this.addHook("beforePaste",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onBeforePaste).call(c,...h)}),this.addHook("afterViewRender",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onAfterViewRender$2).call(c,...h)}),this.addHook("afterRender",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onAfterRender$1).call(c,...h)}),this.addHook("afterScrollVertically",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onAfterScrollVertically).call(c,...h)}),this.addHook("afterLanguageChange",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onAfterLanguageChange).call(c,...h)}),this.addHook("beforeHeightChange",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onBeforeHeightChange).call(c,...h)}),this.addHook("afterSetTheme",function(){for(var d=arguments.length,h=new Array(d),f=0;f<d;f++)h[f]=arguments[f];return _assertClassBrand$c(_Pagination_brand,c,_onAfterSetTheme).call(c,...h)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",_classPrivateFieldGet$8(_onIndexCacheUpdate,this)),_assertClassBrand$c(_Pagination_brand,this,_registerFocusScope$2).call(this),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",_classPrivateFieldGet$8(_onIndexCacheUpdate,this)).unregisterMap(this.pluginName),_assertClassBrand$c(_Pagination_brand,this,_unregisterFocusScope$2).call(this),_classPrivateFieldGet$8(_ui$2,this).destroy(),_classPrivateFieldSet$8(_ui$2,this,null),super.disablePlugin()}getPaginationData(){const s=_classPrivateFieldGet$8(_calcStrategy,this).getTotalPages();let c=-1,u=-1;const{pageSize:d,startIndex:h}=_classPrivateFieldGet$8(_calcStrategy,this).getState(_classPrivateFieldGet$8(_currentPage,this)),f=this.hot.countRows();let g=0;for(let m=h;g<d&&!(m>=f);m++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(m))||(c===-1&&(c=m),u=m,g+=1);return{currentPage:_classPrivateFieldGet$8(_currentPage,this),totalPages:s,pageSize:d,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:_classPrivateFieldGet$8(_pageSize,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:c,lastVisibleRowIndex:u}}setPage(s){const c=_classPrivateFieldGet$8(_currentPage,this);this.hot.runHooks("beforePageChange",c,s)!==!1&&(_classPrivateFieldSet$8(_currentPage,this,s),_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",c,_classPrivateFieldGet$8(_currentPage,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(s){var c;const u=_classPrivateFieldGet$8(_pageSize,this);this.hot.runHooks("beforePageSizeChange",u,s)!==!1&&(s==="auto"&&!((c=this.hot.getPlugin("autoRowSize"))!==null&&c!==void 0&&c.enabled)&&warn$1(AUTO_PAGE_SIZE_WARNING),_classPrivateFieldSet$8(_calcStrategy,this,createPaginatorStrategy(s==="auto"?"auto":"fixed")),_classPrivateFieldSet$8(_pageSize,this,s),_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this),this.hot.runHooks("afterPageSizeChange",u,_classPrivateFieldGet$8(_pageSize,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),_assertClassBrand$c(_Pagination_brand,this,_updateSectionsVisibilityState).call(this)}nextPage(){this.setPage(_classPrivateFieldGet$8(_currentPage,this)+1)}prevPage(){this.setPage(_classPrivateFieldGet$8(_currentPage,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(_classPrivateFieldGet$8(_calcStrategy,this).getTotalPages())}hasPreviousPage(){return _classPrivateFieldGet$8(_currentPage,this)>1}hasNextPage(){return _classPrivateFieldGet$8(_currentPage,this)<_classPrivateFieldGet$8(_calcStrategy,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:s,lastVisibleRowIndex:c}=this.getPaginationData();return s===-1||c===-1?[]:this.hot.getData(s,0,c,this.hot.countCols()-1)}showPageSizeSection(){_classPrivateFieldGet$8(_ui$2,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){_classPrivateFieldGet$8(_ui$2,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){_classPrivateFieldGet$8(_ui$2,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){_classPrivateFieldGet$8(_ui$2,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){_classPrivateFieldGet$8(_ui$2,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){_classPrivateFieldGet$8(_ui$2,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var s;_classPrivateFieldSet$8(_pagedRowsMap,this,null),_classPrivateFieldSet$8(_calcStrategy,this,null),(s=_classPrivateFieldGet$8(_ui$2,this))===null||s===void 0||s.destroy(),_classPrivateFieldSet$8(_ui$2,this,null),super.destroy()}}function _updateSectionsVisibilityState(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function _computeAndApplyState(){_classPrivateFieldSet$8(_internalExecutionCall,this,!0),_classPrivateFieldGet$8(_pagedRowsMap,this).clear();const a=this.hot.rowIndexMapper.getRenderableIndexes(),s=a.length,{stylesHandler:c}=this.hot;_classPrivateFieldGet$8(_calcStrategy,this).calculate({pageSize:_classPrivateFieldGet$8(_pageSize,this),totalItems:s,viewportSizeProvider:()=>{const{view:h}=this.hot;if(h.isVerticallyScrollableByWindow()){const g=getComputedStyle(this.hot.rootDocument.body),m=Number.parseInt(g.marginTop,10)+Number.parseInt(g.marginBottom,10),p=this.hot.hasColHeaders()?h._wt.wtTable.getColumnHeaderHeight():0,v=_classPrivateFieldGet$8(_ui$2,this).getHeight();return h.getWorkspaceHeight()-v-p-m}const f=h.hasHorizontalScroll()?getScrollbarWidth():0;return h.getViewportHeight()-f},itemsSizeProvider:()=>this.hot.rowIndexMapper.getRenderableIndexes().map(f=>{var g;const m=this.hot.toVisualRow(f);return(g=this.hot.getRowHeight(m))!==null&&g!==void 0?g:c.getDefaultRowHeight(m)})});const u=_classPrivateFieldGet$8(_calcStrategy,this).getTotalPages();if(_classPrivateFieldSet$8(_currentPage,this,clamp(_classPrivateFieldGet$8(_currentPage,this),1,u)),a.length>0){const{startIndex:h,pageSize:f}=_classPrivateFieldGet$8(_calcStrategy,this).getState(_classPrivateFieldGet$8(_currentPage,this));a.splice(h,f)}a.length>0?this.hot.batchExecution(()=>{a.forEach(h=>_classPrivateFieldGet$8(_pagedRowsMap,this).setValueAtIndex(h,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),_classPrivateFieldSet$8(_internalExecutionCall,this,!1);const d=this.getPaginationData();_classPrivateFieldGet$8(_ui$2,this).updateState({...d,totalRenderedRows:s})}function _computeNeedsBorder(){if(!this.hot.view)return!0;const{view:a}=this.hot;if(a.isVerticallyScrollableByWindow())return!1;if(a.hasHorizontalScroll()||a.getTableHeight()<a.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:s}=this.getPaginationData();return a.getLastFullyVisibleRow()!==s}function _registerFocusScope$2(){this.hot.getFocusScopeManager().registerScope(PLUGIN_KEY$9,_classPrivateFieldGet$8(_ui$2,this).getContainer(),{shortcutsContextName:SHORTCUTS_CONTEXT_NAME$2,runOnlyIf:()=>this.getSetting("showPageSize")||this.getSetting("showNavigation"),onActivate:a=>{const s=_classPrivateFieldGet$8(_ui$2,this).getFocusableElements();s.length>0&&(a==="tab_from_above"?s.at(0).focus():a==="tab_from_below"&&s.at(-1).focus())}})}function _unregisterFocusScope$2(){this.hot.getFocusScopeManager().unregisterScope(PLUGIN_KEY$9)}function _onBeforeSelectAllRows(a,s){const{firstVisibleRowIndex:c,lastVisibleRowIndex:u}=this.getPaginationData();(_classPrivateFieldGet$8(_currentPage,this)>1||a.row>=0)&&(a.row=c),s.row=u}function _onBeforeSetRangeEnd(a){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:s}=this.getPaginationData();a.row=s}}function _onBeforeSelectionHighlightSet(){if(!this.hot.getSettings().navigableHeaders)return;const a=this.hot.getSelectedRangeLast();if(!a.isSingle()){const{highlight:s}=a;s.row=clamp(s.row,a.getTopStartCorner().row,a.getBottomEndCorner().row)}}function _onBeforePaste(a,s){const{firstVisibleRowIndex:c,lastVisibleRowIndex:u}=this.getPaginationData();if(c===-1||u===-1)return!1;s.forEach(d=>{let{startRow:h}=d;if(a.length===0)return;const f=Math.min(a.length-(u-h+1),a.length);a.splice(0,f)})}function _onAfterViewRender$2(){if(_classPrivateFieldGet$8(_pageSize,this)!=="auto"||_classPrivateFieldGet$8(_internalRenderCall,this)){_classPrivateFieldSet$8(_internalRenderCall,this,!1);return}_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this),_classPrivateFieldSet$8(_internalRenderCall,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function _onAfterRender$1(){const{view:a}=this.hot,s=a.isHorizontallyScrollableByWindow()?a.getTotalTableWidth():a.getWorkspaceWidth();_classPrivateFieldGet$8(_ui$2,this).updateWidth(s).refreshBorderState()}function _onBeforeHeightChange(a){return this.getSetting("uiContainer")||!(typeof a=="number"||typeof a=="string"&&/^\d+$/.test(a)||typeof a=="string"&&a.endsWith("px"))?a:`calc(${typeof a=="string"&&a.endsWith("px")?a:`${a}px`} - ${_classPrivateFieldGet$8(_ui$2,this).getHeight()}px)`}function _onInit(){_classPrivateFieldGet$8(_pageSize,this)!=="auto"&&_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this)}function _onAfterScrollVertically(){_classPrivateFieldGet$8(_ui$2,this).refreshBorderState()}function _onAfterLanguageChange(){_assertClassBrand$c(_Pagination_brand,this,_computeAndApplyState).call(this)}function _onAfterSetTheme(a){_classPrivateFieldGet$8(_ui$2,this).updateTheme(a)}function _defineProperty$j(a,s,c){return(s=_toPropertyKey$j(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$j(a){var s=_toPrimitive$j(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$j(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class Storage{constructor(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;_defineProperty$j(this,"rootWindow",void 0),_defineProperty$j(this,"prefix",void 0),_defineProperty$j(this,"savedKeys",[]),this.rootWindow=c,this.prefix=s,this.loadSavedKeys()}saveValue(s,c){this.rootWindow.localStorage.setItem(`${this.prefix}_${s}`,JSON.stringify(c)),this.savedKeys.indexOf(s)===-1&&(this.savedKeys.push(s),this.saveSavedKeys())}loadValue(s,c){const u=typeof s>"u"?c:s,d=this.rootWindow.localStorage.getItem(`${this.prefix}_${u}`);return d===null?void 0:JSON.parse(d)}reset(s){this.rootWindow.localStorage.removeItem(`${this.prefix}_${s}`)}resetAll(){arrayEach(this.savedKeys,(s,c)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[c]}`)}),this.clearSavedKeys()}loadSavedKeys(){const s=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),c=typeof s=="string"?JSON.parse(s):void 0;this.savedKeys=c||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function _defineProperty$i(a,s,c){return(s=_toPropertyKey$i(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$i(a){var s=_toPrimitive$i(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$i(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}Hooks.getSingleton().register("persistentStateSave"),Hooks.getSingleton().register("persistentStateLoad"),Hooks.getSingleton().register("persistentStateReset");const PLUGIN_KEY$8="persistentState",PLUGIN_PRIORITY$8=0,deprecationWarningInstances=new WeakSet;class PersistentState extends BasePlugin{constructor(){super(...arguments),_defineProperty$i(this,"storage",void 0)}static get PLUGIN_KEY(){return PLUGIN_KEY$8}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$8}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$8]}enablePlugin(){this.enabled||(deprecationWarningInstances.has(this.hot)||(deprecationWarningInstances.add(this.hot),deprecatedWarn("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new Storage(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(s,c)=>this.saveValue(s,c)),this.addHook("persistentStateLoad",(s,c)=>this.loadValue(s,c)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(s,c){c.value=this.storage.loadValue(s)}saveValue(s,c){this.storage.saveValue(s,c)}resetValue(s){typeof s>"u"?this.storage.resetAll():this.storage.reset(s)}destroy(){super.destroy()}}function _classPrivateMethodInitSpec$9(a,s){_checkPrivateRedeclaration$b(a,s),s.add(a)}function _checkPrivateRedeclaration$b(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$h(a,s,c){return(s=_toPropertyKey$h(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$h(a){var s=_toPrimitive$h(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$h(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$b(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$7="search",PLUGIN_PRIORITY$7=190,DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",DEFAULT_CALLBACK=function(a,s,c,u,d){a.getCellMeta(s,c).isSearchResult=d},DEFAULT_QUERY_METHOD=function(a,s,c){return isUndefined(a)||a===null||!a.toLocaleLowerCase||a.length===0||isUndefined(s)||s===null?!1:s.toString().toLocaleLowerCase(c.locale).indexOf(a.toLocaleLowerCase(c.locale))!==-1};var _Search_brand=new WeakSet;class Search extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$9(this,_Search_brand),_defineProperty$h(this,"callback",DEFAULT_CALLBACK),_defineProperty$h(this,"queryMethod",DEFAULT_QUERY_METHOD),_defineProperty$h(this,"searchResultClass",DEFAULT_SEARCH_RESULT_CLASS)}static get PLUGIN_KEY(){return PLUGIN_KEY$7}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$7}isEnabled(){return this.hot.getSettings()[PLUGIN_KEY$7]}enablePlugin(){var s=this;if(this.enabled)return;const c=this.hot.getSettings()[PLUGIN_KEY$7];this.updatePluginSettings(c),this.addHook("beforeRenderer",function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$b(_Search_brand,s,_onBeforeRenderer).call(s,...d)}),super.enablePlugin()}disablePlugin(){var s=this;const c=function(){for(var u=arguments.length,d=new Array(u),h=0;h<u;h++)d[h]=arguments[h];return _assertClassBrand$b(_Search_brand,s,_onBeforeRenderer).call(s,...d)};this.hot.addHook("beforeRenderer",c),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",c)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(s){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const d=this.hot.countRows(),h=this.hot.countCols(),f=[],g=this.hot;return rangeEach(0,d-1,m=>{rangeEach(0,h-1,p=>{const v=this.hot.getDataAtCell(m,p),w=this.hot.getCellMeta(m,p),E=w.search.callback||c,b=(w.search.queryMethod||u)(s,v,w);if(b){const P={row:m,col:p,data:v};f.push(P)}E&&E(g,m,p,v,b)})}),f}getCallback(){return this.callback}setCallback(s){this.callback=s}getQueryMethod(){return this.queryMethod}setQueryMethod(s){this.queryMethod=s}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(s){this.searchResultClass=s}updatePluginSettings(s){isObject(s)&&(s.searchResultClass&&this.setSearchResultClass(s.searchResultClass),s.queryMethod&&this.setQueryMethod(s.queryMethod),s.callback&&this.setCallback(s.callback))}destroy(){super.destroy()}}function _onBeforeRenderer(a,s,c,u,d,h){const f=h.className||[];let g=[];typeof f=="string"?g=f.split(" "):g.push(...f),this.isEnabled()&&h.isSearchResult?g.includes(this.searchResultClass)||g.push(`${this.searchResultClass}`):g.includes(this.searchResultClass)&&g.splice(g.indexOf(this.searchResultClass),1),h.className=g.join(" ")}function _defineProperty$g(a,s,c){return(s=_toPropertyKey$g(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$g(a){var s=_toPrimitive$g(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$g(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class StretchStrategy{constructor(s){_defineProperty$g(this,"viewportWidth",void 0),_defineProperty$g(this,"overwriteColumnWidthFn",void 0),_defineProperty$g(this,"baseWidths",new Map),_defineProperty$g(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=s}prepare(s){let{viewportWidth:c}=s;this.viewportWidth=c,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(s,c){this.baseWidths.set(s,c)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class StretchAllStrategy extends StretchStrategy{calculate(){const s=Array.from(this.baseWidths).reduce((w,E)=>{let[,C]=E;return w+C},0);if(this.viewportWidth-s<0){this.stretchedWidths.clear();return}const u=this.viewportWidth/s,d=[],h=[];let f=this.viewportWidth,g=0;if(this.baseWidths.forEach((w,E)=>{const C=Math.round(w*u),b=this.overwriteColumnWidthFn(C,E);C===b&&C>=DEFAULT_WIDTH?(d.push([E,b]),g+=b):C!==b&&(d.push([E,b]),h.push(E),f-=b)}),f<=DEFAULT_WIDTH){this.stretchedWidths.clear();return}const m=f/g;let p=-1,v=0;d.forEach((w,E)=>{let[C,b]=w,P=b;h.includes(C)||(P=Math.round(b*m)),this.stretchedWidths.set(C,P),p=C,E<d.length-1&&(v+=P)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(p,Math.round(this.viewportWidth-v))}}function _classPrivateFieldInitSpec$7(a,s,c){_checkPrivateRedeclaration$a(a,s),s.set(a,c)}function _checkPrivateRedeclaration$a(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$7(a,s){return a.get(_assertClassBrand$a(a,s))}function _classPrivateFieldSet$7(a,s,c){return a.set(_assertClassBrand$a(a,s),c),c}function _assertClassBrand$a(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}var _lastColumnWidth=new WeakMap,_lastColumnIndex=new WeakMap;class StretchLastStrategy extends StretchStrategy{constructor(){super(...arguments),_classPrivateFieldInitSpec$7(this,_lastColumnWidth,0),_classPrivateFieldInitSpec$7(this,_lastColumnIndex,-1)}prepare(s){super.prepare(s),_classPrivateFieldSet$7(_lastColumnWidth,this,0),_classPrivateFieldSet$7(_lastColumnIndex,this,-1)}setColumnBaseWidth(s,c){super.setColumnBaseWidth(s,c),_classPrivateFieldSet$7(_lastColumnIndex,this,s),_classPrivateFieldSet$7(_lastColumnWidth,this,c)}calculate(){if(_classPrivateFieldGet$7(_lastColumnIndex,this)===-1)return;const s=Array.from(this.baseWidths).reduce((u,d)=>{let[,h]=d;return u+h},0),c=Math.max(this.viewportWidth-s+_classPrivateFieldGet$7(_lastColumnWidth,this),0);this.stretchedWidths.set(_classPrivateFieldGet$7(_lastColumnIndex,this),c)}}function _classPrivateMethodInitSpec$8(a,s){_checkPrivateRedeclaration$9(a,s),s.add(a)}function _classPrivateFieldInitSpec$6(a,s,c){_checkPrivateRedeclaration$9(a,s),s.set(a,c)}function _checkPrivateRedeclaration$9(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$6(a,s){return a.get(_assertClassBrand$9(a,s))}function _classPrivateFieldSet$6(a,s,c){return a.set(_assertClassBrand$9(a,s),c),c}function _assertClassBrand$9(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const STRETCH_WIDTH_MAP_NAME="stretchColumns";var _hot=new WeakMap,_widthsMap=new WeakMap,_stretchStrategies=new WeakMap,_activeStrategy=new WeakMap,_StretchCalculator_brand=new WeakSet;class StretchCalculator{constructor(s){_classPrivateMethodInitSpec$8(this,_StretchCalculator_brand),_classPrivateFieldInitSpec$6(this,_hot,void 0),_classPrivateFieldInitSpec$6(this,_widthsMap,void 0),_classPrivateFieldInitSpec$6(this,_stretchStrategies,new Map([["all",new StretchAllStrategy(_assertClassBrand$9(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))],["last",new StretchLastStrategy(_assertClassBrand$9(_StretchCalculator_brand,this,_overwriteColumnWidthFn).bind(this))]])),_classPrivateFieldInitSpec$6(this,_activeStrategy,"none"),_classPrivateFieldSet$6(_hot,this,s),_classPrivateFieldSet$6(_widthsMap,this,_classPrivateFieldGet$6(_hot,this).columnIndexMapper.createAndRegisterIndexMap(STRETCH_WIDTH_MAP_NAME,"physicalIndexToValue"))}useStrategy(s){_classPrivateFieldSet$6(_activeStrategy,this,_classPrivateFieldGet$6(_stretchStrategies,this).has(s)?s:"none")}refreshStretching(){if(_classPrivateFieldGet$6(_activeStrategy,this)==="none"){_classPrivateFieldGet$6(_widthsMap,this).clear();return}_classPrivateFieldGet$6(_hot,this).batchExecution(()=>{_classPrivateFieldGet$6(_widthsMap,this).clear();const s=_classPrivateFieldGet$6(_stretchStrategies,this).get(_classPrivateFieldGet$6(_activeStrategy,this));let u=_classPrivateFieldGet$6(_hot,this).view.getViewportWidth();_assertClassBrand$9(_StretchCalculator_brand,this,_willVerticalScrollAppear).call(this)&&(u-=getScrollbarWidth(_classPrivateFieldGet$6(_hot,this).rootDocument)),s.prepare({viewportWidth:u});for(let d=0;d<_classPrivateFieldGet$6(_hot,this).countCols();d++)_classPrivateFieldGet$6(_hot,this).columnIndexMapper.isHidden(_classPrivateFieldGet$6(_hot,this).toPhysicalColumn(d))||s.setColumnBaseWidth(d,_assertClassBrand$9(_StretchCalculator_brand,this,_getWidthWithoutStretching).call(this,d));s.calculate(),s.getWidths().forEach(d=>{let[h,f]=d;_classPrivateFieldGet$6(_widthsMap,this).setValueAtIndex(_classPrivateFieldGet$6(_hot,this).toPhysicalColumn(h),f)})},!0)}getStretchedWidth(s){return _classPrivateFieldGet$6(_widthsMap,this).getValueAtIndex(_classPrivateFieldGet$6(_hot,this).toPhysicalColumn(s))}}function _willVerticalScrollAppear(){const{view:a,stylesHandler:s}=_classPrivateFieldGet$6(_hot,this);if(a.isVerticallyScrollableByWindow())return!1;const c=a.getViewportHeight(),u=_classPrivateFieldGet$6(_hot,this).countRows(),d=s.getDefaultRowHeight(),h=s.isClassicTheme(),f=v=>h&&v===0?1:0;let g=0,m=!1;for(let v=0;v<u;v++){var p;if(!_classPrivateFieldGet$6(_hot,this).rowIndexMapper.isHidden(_classPrivateFieldGet$6(_hot,this).toPhysicalRow(v))&&(g+=((p=_classPrivateFieldGet$6(_hot,this).getRowHeight(v))!==null&&p!==void 0?p:d)+f(v),g>c)){m=!0;break}}return m}function _getWidthWithoutStretching(a){var s;return(s=_classPrivateFieldGet$6(_hot,this).getColWidth(a,"StretchColumns"))!==null&&s!==void 0?s:DEFAULT_WIDTH}function _overwriteColumnWidthFn(a,s){return _classPrivateFieldGet$6(_hot,this).runHooks("beforeStretchingColumnWidth",a,s)}function _classPrivateMethodInitSpec$7(a,s){_checkPrivateRedeclaration$8(a,s),s.add(a)}function _classPrivateFieldInitSpec$5(a,s,c){_checkPrivateRedeclaration$8(a,s),s.set(a,c)}function _checkPrivateRedeclaration$8(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$5(a,s,c){return a.set(_assertClassBrand$8(a,s),c),c}function _classPrivateFieldGet$5(a,s){return a.get(_assertClassBrand$8(a,s))}function _assertClassBrand$8(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$6="stretchColumns",PLUGIN_PRIORITY$6=155;var _stretchCalculator=new WeakMap,_previousTableWidth=new WeakMap,_resizeObserver=new WeakMap,_StretchColumns_brand=new WeakSet;class StretchColumns extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$7(this,_StretchColumns_brand),_classPrivateFieldInitSpec$5(this,_stretchCalculator,new StretchCalculator(this.hot)),_classPrivateFieldInitSpec$5(this,_previousTableWidth,null),_classPrivateFieldInitSpec$5(this,_resizeObserver,new ResizeObserver(s=>{requestAnimationFrame(()=>{var c;(c=this.hot)!==null&&c!==void 0&&c.view.isHorizontallyScrollableByWindow()&&s.forEach(u=>{let{contentRect:d}=u;_classPrivateFieldGet$5(_previousTableWidth,this)!==null&&_classPrivateFieldGet$5(_previousTableWidth,this)!==d.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),_classPrivateFieldSet$5(_previousTableWidth,this,d.width)})})}))}static get PLUGIN_KEY(){return PLUGIN_KEY$6}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$6}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var s=this;this.enabled||(_classPrivateFieldGet$5(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),_classPrivateFieldGet$5(_resizeObserver,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$8(_StretchColumns_brand,s,_onBeforeRender).call(s,...u)}),this.addHook("modifyColWidth",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$8(_StretchColumns_brand,s,_onModifyColWidth).call(s,...u)},10),super.enablePlugin())}updatePlugin(){_classPrivateFieldGet$5(_stretchCalculator,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),_classPrivateFieldGet$5(_resizeObserver,this).unobserve(this.hot.rootElement)}getColumnWidth(s){return _classPrivateFieldGet$5(_stretchCalculator,this).getStretchedWidth(s)}destroy(){_classPrivateFieldGet$5(_resizeObserver,this).disconnect(),_classPrivateFieldSet$5(_resizeObserver,this,null),_classPrivateFieldSet$5(_stretchCalculator,this,null),super.destroy()}}function _onModifyColWidth(a,s,c){if(c===this.pluginName)return;const u=this.getColumnWidth(s);return typeof u=="number"?u:a}function _onBeforeRender(a){a&&_classPrivateFieldGet$5(_stretchCalculator,this).refreshStretching()}function _classPrivateMethodInitSpec$6(a,s){_checkPrivateRedeclaration$7(a,s),s.add(a)}function _checkPrivateRedeclaration$7(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$f(a,s,c){return(s=_toPropertyKey$f(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$f(a){var s=_toPrimitive$f(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$f(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$7(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$5="touchScroll",PLUGIN_PRIORITY$5=200;var _TouchScroll_brand=new WeakSet;class TouchScroll extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$6(this,_TouchScroll_brand),_defineProperty$f(this,"scrollbars",[]),_defineProperty$f(this,"clones",[]),_defineProperty$f(this,"lockedCollection",!1),_defineProperty$f(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return PLUGIN_KEY$5}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$5}static get SETTING_KEYS(){return!0}isEnabled(){return isTouchSupported()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>_assertClassBrand$7(_TouchScroll_brand,this,_onAfterViewRender$1).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>_assertClassBrand$7(_TouchScroll_brand,this,_onBeforeTouchScroll).call(this)),this.addHook("afterMomentumScroll",()=>_assertClassBrand$7(_TouchScroll_brand,this,_onAfterMomentumScroll).call(this))}}function _onAfterViewRender$1(){if(this.lockedCollection)return;const{topOverlay:a,bottomOverlay:s,inlineStartOverlay:c,topInlineStartCornerOverlay:u,bottomInlineStartCornerOverlay:d}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(a),s.clone&&this.scrollbars.push(s),this.scrollbars.push(c),u&&this.scrollbars.push(u),d&&d.clone&&this.scrollbars.push(d),this.clones=[],a.needFullRender&&this.clones.push(a.clone.wtTable.holder.parentNode),s.needFullRender&&this.clones.push(s.clone.wtTable.holder.parentNode),c.needFullRender&&this.clones.push(c.clone.wtTable.holder.parentNode),u&&this.clones.push(u.clone.wtTable.holder.parentNode),d&&d.clone&&this.clones.push(d.clone.wtTable.holder.parentNode)}function _onBeforeTouchScroll(){this.freezeOverlays=!0,arrayEach(this.clones,a=>{addClass$1(a,"hide-tween")})}function _onAfterMomentumScroll(){this.freezeOverlays=!1,arrayEach(this.clones,a=>{removeClass$1(a,"hide-tween"),addClass$1(a,"show-tween")}),this.hot._registerTimeout(()=>{arrayEach(this.clones,a=>{removeClass$1(a,"show-tween")})},400),arrayEach(this.scrollbars,a=>{a.refresh(),a.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function _classPrivateMethodInitSpec$5(a,s){_checkPrivateRedeclaration$6(a,s),s.add(a)}function _checkPrivateRedeclaration$6(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty$e(a,s,c){return(s=_toPropertyKey$e(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$e(a){var s=_toPrimitive$e(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$e(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$6(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$4="trimRows",PLUGIN_PRIORITY$4=330;var _TrimRows_brand=new WeakSet;class TrimRows extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$5(this,_TrimRows_brand),_defineProperty$e(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return PLUGIN_KEY$4}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$4}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$4]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new TrimmingMap),this.trimmedRowsMap.addLocalHook("init",()=>_assertClassBrand$6(_TrimRows_brand,this,_onMapInit).call(this)),super.enablePlugin())}updatePlugin(){const s=this.hot.getSettings()[PLUGIN_KEY$4];Array.isArray(s)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),arrayEach(s,c=>{this.trimmedRowsMap.setValueAtIndex(c,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(s){const c=this.getTrimmedRows(),u=this.isValidConfig(s);let d=c;u&&(d=Array.from(new Set(c.concat(s)))),this.hot.runHooks("beforeTrimRow",c,d,u)!==!1&&(u&&this.hot.batchExecution(()=>{arrayEach(s,f=>{this.trimmedRowsMap.setValueAtIndex(f,!0)})},!0),this.hot.runHooks("afterTrimRow",c,d,u,u&&d.length>c.length))}trimRow(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.trimRows(c)}untrimRows(s){const c=this.getTrimmedRows(),u=this.isValidConfig(s);let d=c;const h=this.trimmedRowsMap.getValues().slice(),f=s.length>0;u&&f&&(arrayEach(s,m=>{h[m]=!1}),d=arrayReduce(h,(m,p,v)=>(p&&m.push(v),m),[])),this.hot.runHooks("beforeUntrimRow",c,d,u&&f)!==!1&&(u&&f&&this.trimmedRowsMap.setValues(h),this.hot.runHooks("afterUntrimRow",c,d,u&&f,u&&d.length<c.length))}untrimRow(){for(var s=arguments.length,c=new Array(s),u=0;u<s;u++)c[u]=arguments[u];this.untrimRows(c)}isTrimmed(s){return this.trimmedRowsMap.getValueAtIndex(s)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(s){const c=this.hot.countSourceRows();return s.every(u=>Number.isInteger(u)&&u>=0&&u<c)}destroy(){super.destroy()}}function _onMapInit(){const a=this.hot.getSettings()[PLUGIN_KEY$4];Array.isArray(a)&&this.hot.batchExecution(()=>{arrayEach(a,s=>{this.trimmedRowsMap.setValueAtIndex(s,!0)})},!0)}function _defineProperty$d(a,s,c){return(s=_toPropertyKey$d(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$d(a){var s=_toPrimitive$d(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$d(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class BaseAction{constructor(s){_defineProperty$d(this,"actionType",""),this.actionType=s}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function _defineProperty$c(a,s,c){return(s=_toPropertyKey$c(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$c(a){var s=_toPrimitive$c(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$c(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CellAlignmentAction extends BaseAction{constructor(s){let{stateBefore:c,range:u,type:d,alignment:h}=s;super("cell_alignment"),_defineProperty$c(this,"stateBefore",void 0),_defineProperty$c(this,"range",void 0),_defineProperty$c(this,"type",void 0),_defineProperty$c(this,"alignment",void 0),this.stateBefore=c,this.range=u,this.type=d,this.alignment=h}static startRegisteringEvents(s,c){s.addHook("beforeCellAlignment",(u,d,h,f)=>{c.done(()=>new CellAlignmentAction({stateBefore:u,range:d,type:h,alignment:f}))})}undo(s,c){arrayEach(this.range,u=>{u.forAll((d,h)=>{d>=0&&h>=0&&s.setCellMeta(d,h,"className",this.stateBefore[d][h]||" htLeft")})}),s.addHookOnce("afterViewRender",c),s.render()}redo(s,c){align(this.range,this.type,this.alignment,(u,d)=>s.getCellMeta(u,d),(u,d,h,f)=>s.setCellMeta(u,d,h,f)),s.addHookOnce("afterViewRender",c),s.render()}}function _defineProperty$b(a,s,c){return(s=_toPropertyKey$b(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$b(a){var s=_toPrimitive$b(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$b(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ColumnMoveAction extends BaseAction{constructor(s){let{columns:c,finalIndex:u}=s;super("col_move"),_defineProperty$b(this,"columns",void 0),_defineProperty$b(this,"finalColumnIndex",void 0),this.columns=c.slice(),this.finalColumnIndex=u}static startRegisteringEvents(s,c){s.addHook("beforeColumnMove",(u,d)=>{u!==!1&&c.done(()=>new ColumnMoveAction({columns:u,finalIndex:d}))})}undo(s,c){const u=s.getPlugin("manualColumnMove");s.addHookOnce("afterViewRender",c),getMoves(this.columns,this.finalColumnIndex,s.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(h=>{let{from:f,to:g}=h;f<g&&(g-=1),u.moveColumn(g,f)}),s.render(),s.deselectCell(),s.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(s,c){const u=s.getPlugin("manualColumnMove");s.addHookOnce("afterViewRender",c),u.moveColumns(this.columns.slice(),this.finalColumnIndex),s.render(),s.deselectCell(),s.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function _defineProperty$a(a,s,c){return(s=_toPropertyKey$a(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$a(a){var s=_toPrimitive$a(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$a(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class ColumnSortAction extends BaseAction{constructor(s){let{currentSortState:c,newSortState:u}=s;super("col_sort"),_defineProperty$a(this,"previousSortState",void 0),_defineProperty$a(this,"nextSortState",void 0),this.previousSortState=c,this.nextSortState=u}static startRegisteringEvents(s,c){s.addHook("beforeColumnSort",(u,d,h)=>{h&&c.done(()=>new ColumnSortAction({currentSortState:u,newSortState:d}))})}undo(s,c){const u=s.getPlugin("columnSorting"),d=s.getPlugin("multiColumnSorting"),h=d.isEnabled()?d:u;this.previousSortState.length?h.sort(this.previousSortState):h.clearSort(),c()}redo(s,c){const u=s.getPlugin("columnSorting"),d=s.getPlugin("multiColumnSorting");(d.isEnabled()?d:u).sort(this.nextSortState),c()}}function _defineProperty$9(a,s,c){return(s=_toPropertyKey$9(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$9(a){var s=_toPrimitive$9(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$9(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CreateColumnAction extends BaseAction{constructor(s){let{index:c,amount:u}=s;super("insert_col"),_defineProperty$9(this,"index",void 0),_defineProperty$9(this,"amount",void 0),this.index=c,this.amount=u}static startRegisteringEvents(s,c){s.addHook("afterCreateCol",(u,d,h)=>{c.done(()=>new CreateColumnAction({index:u,amount:d}),h)})}undo(s,c){s.addHookOnce("afterRemoveCol",c),s.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(s,c){s.addHookOnce("afterCreateCol",c),s.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function _defineProperty$8(a,s,c){return(s=_toPropertyKey$8(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$8(a){var s=_toPrimitive$8(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$8(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class CreateRowAction extends BaseAction{constructor(s){let{index:c,amount:u}=s;super("insert_row"),_defineProperty$8(this,"index",void 0),_defineProperty$8(this,"amount",void 0),this.index=c,this.amount=u}static startRegisteringEvents(s,c){s.addHook("afterCreateRow",(u,d,h)=>{c.done(()=>new CreateRowAction({index:u,amount:d}),h)})}undo(s,c){const u=s.countRows(),d=s.getSettings().minSpareRows;this.index>=u&&this.index-d<u&&(this.index-=d),s.addHookOnce("afterRemoveRow",c),s.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(s,c){s.addHookOnce("afterCreateRow",c),s.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function _defineProperty$7(a,s,c){return(s=_toPropertyKey$7(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$7(a){var s=_toPrimitive$7(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$7(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class DataChangeAction extends BaseAction{constructor(s){let{changes:c,selected:u,countCols:d,countRows:h}=s;super("change"),_defineProperty$7(this,"changes",void 0),_defineProperty$7(this,"selected",void 0),_defineProperty$7(this,"countCols",void 0),_defineProperty$7(this,"countRows",void 0),this.changes=c,this.selected=u,this.countCols=d,this.countRows=h}static startRegisteringEvents(s,c){s.addHook("beforeChange",function(u,d){const h=u&&u.length;if(!h||!u.find(m=>{const[,,p,v]=m;return p!==v}))return;const g=()=>{const m=u.reduce((v,w)=>(v.push([...w]),v),[]);m.forEach(v=>{v[1]=s.propToCol(v[1])});const p=h>1?this.getSelected():[[m[0][0],m[0][1]]];return new DataChangeAction({changes:m,selected:p,countCols:s.countCols(),countRows:s.countRows()})};c.done(g,d)})}undo(s,c){const u=deepClone(this.changes);for(let d=0,h=u.length;d<h;d++)u[d].splice(3,1);s.addHookOnce("afterChange",()=>{const d=s.countRows()-this.countRows;d>0&&s.alter("remove_row",null,d,"UndoRedo.undo");const h=s.countCols()-this.countCols;h>0&&s.isColumnModificationAllowed()&&s.alter("remove_col",null,h,"UndoRedo.undo"),s.scrollToFocusedCell(),s.selectCells(this.selected,!1,!1),c()}),s.setDataAtCell(u,null,null,"UndoRedo.undo")}redo(s,c){const u=deepClone(this.changes);for(let d=0,h=u.length;d<h;d++)u[d].splice(2,1);s.addHookOnce("afterChange",()=>{s.selectCells(this.selected,!1,!1),c()}),s.setDataAtCell(u,null,null,"UndoRedo.redo")}}function _defineProperty$6(a,s,c){return(s=_toPropertyKey$6(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$6(a){var s=_toPrimitive$6(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$6(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class FiltersAction extends BaseAction{constructor(s){let{conditionsStack:c,previousConditionsStack:u}=s;super("filter"),_defineProperty$6(this,"conditionsStack",void 0),_defineProperty$6(this,"previousConditionsStack",void 0),this.conditionsStack=c,this.previousConditionsStack=u}static startRegisteringEvents(s,c){s.addHook("beforeFilter",(u,d)=>{c.done(()=>new FiltersAction({conditionsStack:u,previousConditionsStack:d}))})}undo(s,c){const u=s.getPlugin("filters");s.addHookOnce("afterViewRender",c),u.importConditions(this.previousConditionsStack),u.filter()}redo(s,c){const u=s.getPlugin("filters");s.addHookOnce("afterViewRender",c),u.importConditions(this.conditionsStack),u.filter()}}function _defineProperty$5(a,s,c){return(s=_toPropertyKey$5(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$5(a){var s=_toPrimitive$5(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$5(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class MergeCellsAction extends BaseAction{constructor(s){let{data:c,cellRange:u}=s;super("merge_cells"),_defineProperty$5(this,"cellRange",void 0),this.cellRange=u,this.data=c}static startRegisteringEvents(s,c){s.addHook("beforeMergeCells",(u,d)=>{if(d)return;const h=u.getTopStartCorner(),f=u.getBottomEndCorner(),g=s.getData(h.row,h.col,f.row,f.col);c.done(()=>new MergeCellsAction({data:g,cellRange:u}))})}undo(s,c){const u=s.getPlugin("mergeCells");s.addHookOnce("afterViewRender",c),u.unmergeRange(this.cellRange,!0);const d=this.cellRange.getTopStartCorner();s.populateFromArray(d.row,d.col,this.data,void 0,void 0,"MergeCells")}redo(s,c){const u=s.getPlugin("mergeCells");s.addHookOnce("afterViewRender",c),u.mergeRange(this.cellRange)}}function getCellMetas(a,s,c,u,d){const h=["visualRow","visualCol","row","col","prop"],f=h.length,g=[];return rangeEach(u,d,m=>{rangeEach(s,c,p=>{const v=a.getCellMeta(p,m);if(Object.keys(v).length!==f){const w=Object.fromEntries(Object.entries(v).filter(E=>{let[C]=E;return h.includes(C)===!1}));g.push([v.visualRow,v.visualCol,w])}})}),g}function _defineProperty$4(a,s,c){return(s=_toPropertyKey$4(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$4(a){var s=_toPrimitive$4(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$4(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RemoveColumnAction extends BaseAction{constructor(s){let{index:c,indexes:u,data:d,amount:h,headers:f,columnPositions:g,rowPositions:m,fixedColumnsStart:p,removedCellMetas:v}=s;super("remove_col"),_defineProperty$4(this,"index",void 0),_defineProperty$4(this,"indexes",void 0),_defineProperty$4(this,"data",void 0),_defineProperty$4(this,"amount",void 0),_defineProperty$4(this,"headers",void 0),_defineProperty$4(this,"columnPositions",void 0),_defineProperty$4(this,"rowPositions",void 0),_defineProperty$4(this,"fixedColumnsStart",void 0),_defineProperty$4(this,"removedCellMetas",void 0),this.index=c,this.indexes=u,this.data=d,this.amount=h,this.headers=f,this.columnPositions=g.slice(0),this.rowPositions=m.slice(0),this.fixedColumnsStart=p,this.removedCellMetas=v}static startRegisteringEvents(s,c){s.addHook("beforeRemoveCol",(u,d,h,f)=>{const g=()=>{const m=s.getSourceDataArray(),p=(s.countCols()+u)%s.countCols(),v=p+d-1,w=[],E=[],C=[];return rangeEach(m.length-1,b=>{const P=[],R=m[b];rangeEach(p,v,T=>{P.push(R[s.toPhysicalColumn(T)])}),w.push(P)}),rangeEach(d-1,b=>{C.push(s.toPhysicalColumn(p+b))}),Array.isArray(s.getSettings().colHeaders)&&rangeEach(d-1,b=>{E.push(s.getSettings().colHeaders[s.toPhysicalColumn(p+b)]||null)}),new RemoveColumnAction({index:p,indexes:C,data:w,amount:d,headers:E,columnPositions:s.columnIndexMapper.getIndexesSequence(),rowPositions:s.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:s.getSettings().fixedColumnsStart,removedCellMetas:getCellMetas(s,0,s.countRows(),p,v)})};c.done(g,f)})}undo(s,c){const u=s.getSettings();u.fixedColumnsStart=this.fixedColumnsStart;const d=this.indexes.slice(0).sort(),h=(v,w,E)=>E[this.indexes.indexOf(d[w])],f=this.data.length,g=[];for(let v=0;v<f;v++)g.push(arrayMap(this.data[v],h));const m=arrayMap(this.headers,h),p=[];s.columnIndexMapper.setIndexesSequence(this.columnPositions),s.alter("insert_col_start",s.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),s.batchExecution(()=>{s.rowIndexMapper.setIndexesSequence(this.rowPositions),s.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),arrayEach(s.getSourceDataArray(),(v,w)=>{arrayEach(d,(E,C)=>{v[E]=g[w][C],p.push([w,E,v[E]])})}),typeof this.headers<"u"&&arrayEach(m,(v,w)=>{s.getSettings().colHeaders[d[w]]=v}),this.removedCellMetas.forEach(v=>{let[w,E,C]=v;s.setCellMetaObject(w,E,C)}),s.addHookOnce("afterViewRender",c),s.setSourceDataAtCell(p,null,null,"UndoRedo.undo")}redo(s,c){s.addHookOnce("afterRemoveCol",c),s.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function _defineProperty$3(a,s,c){return(s=_toPropertyKey$3(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$3(a){var s=_toPrimitive$3(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$3(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RemoveRowAction extends BaseAction{constructor(s){let{index:c,data:u,fixedRowsBottom:d,fixedRowsTop:h,rowIndexesSequence:f,removedCellMetas:g}=s;super("remove_row"),_defineProperty$3(this,"index",void 0),_defineProperty$3(this,"data",void 0),_defineProperty$3(this,"fixedRowsBottom",void 0),_defineProperty$3(this,"fixedRowsTop",void 0),_defineProperty$3(this,"rowIndexesSequence",void 0),_defineProperty$3(this,"removedCellMetas",void 0),this.index=c,this.data=u,this.fixedRowsBottom=d,this.fixedRowsTop=h,this.rowIndexesSequence=f,this.removedCellMetas=g}static startRegisteringEvents(s,c){s.addHook("beforeRemoveRow",(u,d,h,f)=>{const g=()=>{const m=s.toPhysicalRow(u),p=m+d-1,v=deepClone(s.getSourceData(m,0,m+d-1,s.countSourceCols()-1));return new RemoveRowAction({index:m,data:v,fixedRowsBottom:s.getSettings().fixedRowsBottom,fixedRowsTop:s.getSettings().fixedRowsTop,rowIndexesSequence:s.rowIndexMapper.getIndexesSequence(),removedCellMetas:getCellMetas(s,m,p,0,s.countCols()-1)})};c.done(g,f)})}undo(s,c){const u=s.getSettings(),d=[];u.fixedRowsBottom=this.fixedRowsBottom,u.fixedRowsTop=this.fixedRowsTop,this.data.forEach((h,f)=>{Object.keys(h).forEach(g=>{const m=parseInt(g,10);d.push([this.index+f,isNaN(m)?g:m,h[g]])})}),s.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),s.alter("insert_row_above",s.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),s.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(h=>{let[f,g,m]=h;s.setCellMetaObject(f,g,m)}),s.addHookOnce("afterViewRender",c),s.setSourceDataAtCell(d,null,null,"UndoRedo.undo")}redo(s,c){s.addHookOnce("afterRemoveRow",c),s.alter("remove_row",s.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function _defineProperty$2(a,s,c){return(s=_toPropertyKey$2(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$2(a){var s=_toPrimitive$2(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$2(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class RowMoveAction extends BaseAction{constructor(s){let{rows:c,finalIndex:u}=s;super("row_move"),_defineProperty$2(this,"rows",void 0),_defineProperty$2(this,"finalRowIndex",void 0),this.rows=c.slice(),this.finalRowIndex=u}static startRegisteringEvents(s,c){s.addHook("beforeRowMove",(u,d)=>{u!==!1&&c.done(()=>new RowMoveAction({rows:u,finalIndex:d}))})}undo(s,c){const u=s.getPlugin("manualRowMove");s.addHookOnce("afterViewRender",c),getMoves(this.rows,this.finalRowIndex,s.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(h=>{let{from:f,to:g}=h;f<g&&(g-=1),u.moveRow(g,f)}),s.render(),s.deselectCell(),s.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(s,c){const u=s.getPlugin("manualRowMove");s.addHookOnce("afterViewRender",c),u.moveRows(this.rows.slice(),this.finalRowIndex),s.render(),s.deselectCell(),s.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function _defineProperty$1(a,s,c){return(s=_toPropertyKey$1(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey$1(a){var s=_toPrimitive$1(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive$1(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}class UnmergeCellsAction extends BaseAction{constructor(s){let{cellRange:c}=s;super("unmerge_cells"),_defineProperty$1(this,"cellRange",void 0),this.cellRange=c}static startRegisteringEvents(s,c){s.addHook("afterUnmergeCells",(u,d)=>{d||c.done(()=>new UnmergeCellsAction({cellRange:u}))})}undo(s,c){const u=s.getPlugin("mergeCells");s.addHookOnce("afterViewRender",c),u.mergeRange(this.cellRange,!0)}redo(s,c){const u=s.getPlugin("mergeCells");s.addHookOnce("afterViewRender",c),u.unmergeRange(this.cellRange,!0),s.render()}}function registerActions(a,s){[CellAlignmentAction,ColumnMoveAction,ColumnSortAction,CreateColumnAction,CreateRowAction,DataChangeAction,FiltersAction,MergeCellsAction,RemoveColumnAction,RemoveRowAction,RowMoveAction,UnmergeCellsAction].forEach(c=>c.startRegisteringEvents(a,s))}function _classPrivateMethodInitSpec$4(a,s){_checkPrivateRedeclaration$5(a,s),s.add(a)}function _checkPrivateRedeclaration$5(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _defineProperty(a,s,c){return(s=_toPropertyKey(s))in a?Object.defineProperty(a,s,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[s]=c,a}function _toPropertyKey(a){var s=_toPrimitive(a,"string");return typeof s=="symbol"?s:s+""}function _toPrimitive(a,s){if(typeof a!="object"||!a)return a;var c=a[Symbol.toPrimitive];if(c!==void 0){var u=c.call(a,s);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(a)}function _assertClassBrand$5(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const SHORTCUTS_GROUP$1="undoRedo",PLUGIN_KEY$3="undoRedo",PLUGIN_PRIORITY$3=1e3;Hooks.getSingleton().register("beforeUndo"),Hooks.getSingleton().register("afterUndo"),Hooks.getSingleton().register("beforeRedo"),Hooks.getSingleton().register("afterRedo");const deprecationWarns=new Set;var _UndoRedo_brand=new WeakSet;class UndoRedo extends BasePlugin{static get PLUGIN_KEY(){return PLUGIN_KEY$3}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$3}static get SETTING_KEYS(){return!0}constructor(s){super(s),_classPrivateMethodInitSpec$4(this,_UndoRedo_brand),_defineProperty(this,"doneActions",[]),_defineProperty(this,"undoneActions",[]),_defineProperty(this,"ignoreNewActions",!1),registerActions(s,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var s=this;this.enabled||(this.addHook("afterChange",function(){for(var c=arguments.length,u=new Array(c),d=0;d<c;d++)u[d]=arguments[d];return _assertClassBrand$5(_UndoRedo_brand,s,_onAfterChange).call(s,...u)}),this.registerShortcuts(),_assertClassBrand$5(_UndoRedo_brand,this,_exposeAPIToCore).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),_assertClassBrand$5(_UndoRedo_brand,this,_removeAPIFromCore).call(this)}registerShortcuts(){const c=this.hot.getShortcutManager().getContext("grid"),d={runOnlyIf:h=>!h.altKey,group:SHORTCUTS_GROUP$1};c.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],d)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(SHORTCUTS_GROUP$1)}done(s,c){if(this.ignoreNewActions||c==="UndoRedo.undo"||c==="UndoRedo.redo"||c==="auto")return;const d=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",d,c)===!1)return;const f=s(),g=this.undoneActions.slice();this.doneActions.push(f),this.hot.runHooks("afterUndoStackChange",d,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",g),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",g,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const s=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",s);const c=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",s,this.doneActions.slice());const u=deepClone(c);if(this.hot.runHooks("beforeUndo",u)===!1)return;this.ignoreNewActions=!0;const h=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",h),c.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(c)}),this.hot.runHooks("afterRedoStackChange",h,this.undoneActions.slice()),this.hot.runHooks("afterUndo",u)}redo(){if(!this.isRedoAvailable())return;const s=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",s);const c=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",s,this.undoneActions.slice());const u=deepClone(c);if(this.hot.runHooks("beforeRedo",u)===!1)return;this.ignoreNewActions=!0;const h=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",h),c.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(c)}),this.hot.runHooks("afterUndoStackChange",h,this.doneActions.slice()),this.hot.runHooks("afterRedo",u)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function _onAfterChange(a,s){s==="loadData"&&this.clear()}function _exposeAPIToCore(){const a=s=>{deprecationWarns.has(s)||(warn$1(toSingleLine`The "${s}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${s}()\`).`),deprecationWarns.add(s))};this.hot.undo=()=>{a("undo"),this.undo()},this.hot.redo=()=>{a("redo"),this.redo()},this.hot.isUndoAvailable=()=>(a("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(a("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{a("clear"),this.clear()},this.hot.undoRedo=this}function _removeAPIFromCore(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}const DIALOG_CLASS_NAME="ht-dialog";function baseTemplate(){function a(){return`
      <div data-ref="contentElement" class="${DIALOG_CLASS_NAME}__content"></div>
    `}let s=null;const c={};function u(){const h=html`${a()}`;return Object.assign(c,h.refs),s=h.fragment,h}function d(){if(s===null)throw new Error("Compile the template first.");return[]}return{TEMPLATE_NAME:"base",dialogA11YOptions(){return{role:"dialog"}},compile:u,focusableElements:d}}function confirmTemplate(a){let{id:s="",title:c="",description:u="",buttons:d=[]}=a;function h(){return`
      <div tabindex="-1" data-ref="contentElement" class="${DIALOG_CLASS_NAME}__content-wrapper-inner">
        <div class="${DIALOG_CLASS_NAME}__content">
          <h2
            id="${s}-dialog-confirm-title"
            class="${DIALOG_CLASS_NAME}__title">${stripTags(c)}</h2>
          <p
            id="${s}-dialog-confirm-description"
            class="${DIALOG_CLASS_NAME}__description">${stripTags(u)}</p>
        </div>
        ${d.length>0?`
          <div data-ref="buttonsContainer" class="${DIALOG_CLASS_NAME}__buttons">
            ${d.map(v=>`
              <button class="ht-button ht-button--${v.type}">${stripTags(v.text)}</button>
            `).join("")}
          </div>
        `:""}
      </div>
    `}let f=null;const g={};function m(){const v=html`${h()}`;return Object.assign(g,v.refs),f=v.fragment,v}function p(){if(f===null)throw new Error("Compile the template first.");const{contentElement:v,buttonsContainer:w}=g,E=[];return w?E.push(...Array.from(w.children)):E.push(v),E}return{TEMPLATE_NAME:"confirm",dialogA11YOptions(){return{role:"alertdialog",ariaLabelledby:`${s}-dialog-confirm-title`,ariaDescribedby:u?`${s}-dialog-confirm-description`:void 0}},compile:m,focusableElements:p}}const TEMPLATES=new Map([["base",baseTemplate],["confirm",confirmTemplate]]);function _classPrivateMethodInitSpec$3(a,s){_checkPrivateRedeclaration$4(a,s),s.add(a)}function _classPrivateFieldInitSpec$4(a,s,c){_checkPrivateRedeclaration$4(a,s),s.set(a,c)}function _checkPrivateRedeclaration$4(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$4(a,s){return a.get(_assertClassBrand$4(a,s))}function _classPrivateFieldSet$4(a,s,c){return a.set(_assertClassBrand$4(a,s),c),c}function _assertClassBrand$4(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const CONTAINER_TEMPLATE=`
<div data-ref="dialogElement" class="${DIALOG_CLASS_NAME}">
  <div data-ref="dialogWrapperElement" class="${DIALOG_CLASS_NAME}__content-wrapper">
</div>
`;var _rootElement$1=new WeakMap,_refs$1=new WeakMap,_isRtl=new WeakMap,_animationStarted=new WeakMap,_template=new WeakMap,_templateButtonCallbacks=new WeakMap,_DialogUI_brand=new WeakSet;class DialogUI{constructor(s){let{rootElement:c,isRtl:u}=s;_classPrivateMethodInitSpec$3(this,_DialogUI_brand),_classPrivateFieldInitSpec$4(this,_rootElement$1,void 0),_classPrivateFieldInitSpec$4(this,_refs$1,void 0),_classPrivateFieldInitSpec$4(this,_isRtl,!1),_classPrivateFieldInitSpec$4(this,_animationStarted,!1),_classPrivateFieldInitSpec$4(this,_template,TEMPLATES.get("base")),_classPrivateFieldInitSpec$4(this,_templateButtonCallbacks,[]),_classPrivateFieldSet$4(_rootElement$1,this,c),_classPrivateFieldSet$4(_isRtl,this,u),this.install()}useTemplate(s){var c;let u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!TEMPLATES.has(s)||s==="base"){const d=Array.from(TEMPLATES.keys()).filter(h=>h!=="base").join(", ");throw new Error(toSingleLine`Invalid template: ${s}.\x20
        Valid templates are: ${d}.`)}_classPrivateFieldSet$4(_template,this,TEMPLATES.get(s)(u)),_classPrivateFieldSet$4(_templateButtonCallbacks,this,((c=u.buttons)!==null&&c!==void 0?c:[]).map(d=>d.callback))}useDefaultTemplate(){_classPrivateFieldSet$4(_template,this,TEMPLATES.get("base")()),_classPrivateFieldSet$4(_templateButtonCallbacks,this,[])}install(){var s;if((s=_classPrivateFieldGet$4(_refs$1,this))!==null&&s!==void 0&&s.dialogElement)return;const c=html`${CONTAINER_TEMPLATE}`;_classPrivateFieldSet$4(_refs$1,this,c.refs);const{dialogElement:u}=_classPrivateFieldGet$4(_refs$1,this);setAttribute(u,[A11Y_MODAL(),["dir",_classPrivateFieldGet$4(_isRtl,this)?"rtl":"ltr"]]),u.addEventListener("transitionstart",()=>_assertClassBrand$4(_DialogUI_brand,this,_onTransitionStart).call(this)),u.addEventListener("transitionend",()=>_assertClassBrand$4(_DialogUI_brand,this,_onTransitionEnd).call(this)),_classPrivateFieldGet$4(_rootElement$1,this).after(c.fragment)}getContainer(){return _classPrivateFieldGet$4(_refs$1,this).dialogElement}getFocusableElements(){return _classPrivateFieldGet$4(_template,this).focusableElements()}updateDialog(s){let{isVisible:c,content:u,customClassName:d,background:h,contentBackground:f,animation:g,a11y:m}=s;const p=_classPrivateFieldGet$4(_template,this).compile(),{dialogElement:v,dialogWrapperElement:w}=_classPrivateFieldGet$4(_refs$1,this);w.innerHTML="",w.appendChild(p.fragment),Object.assign(_classPrivateFieldGet$4(_refs$1,this),p.refs);const{contentElement:E,buttonsContainer:C}=_classPrivateFieldGet$4(_refs$1,this);_classPrivateFieldGet$4(_template,this).TEMPLATE_NAME!=="base"&&Object.assign(m,_classPrivateFieldGet$4(_template,this).dialogA11YOptions());const b=d?` ${d}`:"",P=h?` ${DIALOG_CLASS_NAME}--background-${h}`:"",R=g?` ${DIALOG_CLASS_NAME}--animation`:"",T=c?` ${DIALOG_CLASS_NAME}--show`:"";v.className=[DIALOG_CLASS_NAME,`${DIALOG_CLASS_NAME}--${_classPrivateFieldGet$4(_template,this).TEMPLATE_NAME}`,"handsontable",b,P,R,T].join(" "),setAttribute(v,[_classPrivateFieldGet$4(_template,this).TEMPLATE_NAME==="base"?A11Y_TABINDEX(-1):void 0]),setAttribute(v,[m.role==="alertdialog"?A11Y_ALERTDIALOG():A11Y_DIALOG()]),m.ariaLabel&&!m.ariaLabelledby?setAttribute(v,[m.ariaLabel?A11Y_LABEL(m.ariaLabel):void 0]):removeAttribute(v,"aria-label"),m.ariaLabelledby?setAttribute(v,[A11Y_LABELED_BY(m.ariaLabelledby)]):removeAttribute(v,"aria-labelledby"),m.ariaDescribedby?setAttribute(v,[A11Y_DESCRIBED_BY(m.ariaDescribedby)]):removeAttribute(v,"aria-describedby");const I=f?` ${DIALOG_CLASS_NAME}__content--background`:"";return addClass$1(E,`${DIALOG_CLASS_NAME}__content${I}`),_classPrivateFieldGet$4(_template,this).TEMPLATE_NAME==="base"?(E.innerHTML="",typeof u=="string"?fastInnerHTML(E,u):(u instanceof HTMLElement||u instanceof DocumentFragment)&&E.appendChild(u)):C&&Array.from(C.children).forEach((M,N)=>{const H=_classPrivateFieldGet$4(_templateButtonCallbacks,this)[N];H&&M.addEventListener("click",H)}),this}showDialog(s){const{dialogElement:c}=_classPrivateFieldGet$4(_refs$1,this);return c.style.display="block",s&&c.offsetHeight,addClass$1(c,`${DIALOG_CLASS_NAME}--show`),_classPrivateFieldSet$4(_animationStarted,this,!1),this}hideDialog(s){const{dialogElement:c}=_classPrivateFieldGet$4(_refs$1,this);return removeClass$1(c,`${DIALOG_CLASS_NAME}--show`),(s&&!_classPrivateFieldGet$4(_animationStarted,this)||!s)&&(c.style.display="none"),_classPrivateFieldSet$4(_animationStarted,this,!1),this}focusDialog(){_classPrivateFieldGet$4(_refs$1,this).dialogElement.focus()}updateWidth(s){return _classPrivateFieldGet$4(_refs$1,this).dialogElement.style.width=`${s}px`,this}updateHeight(s){return _classPrivateFieldGet$4(_refs$1,this).dialogElement.style.height=`calc(100% - ${s}px)`,this}destroyDialog(){var s;(s=_classPrivateFieldGet$4(_refs$1,this))===null||s===void 0||s.dialogElement.remove(),_classPrivateFieldSet$4(_refs$1,this,null)}}function _onTransitionEnd(){const{dialogElement:a}=_classPrivateFieldGet$4(_refs$1,this);hasClass$1(a,`${DIALOG_CLASS_NAME}--show`)||(a.style.display="none")}function _onTransitionStart(){_classPrivateFieldSet$4(_animationStarted,this,!0)}mixin(DialogUI,localHooks);function _classPrivateMethodInitSpec$2(a,s){_checkPrivateRedeclaration$3(a,s),s.add(a)}function _classPrivateFieldInitSpec$3(a,s,c){_checkPrivateRedeclaration$3(a,s),s.set(a,c)}function _checkPrivateRedeclaration$3(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$3(a,s,c){return a.set(_assertClassBrand$3(a,s),c),c}function _classPrivateFieldGet$3(a,s){return a.get(_assertClassBrand$3(a,s))}function _assertClassBrand$3(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$2="dialog",PLUGIN_PRIORITY$2=360,SHORTCUTS_GROUP=PLUGIN_KEY$2,SHORTCUTS_CONTEXT_NAME$1=`plugin:${PLUGIN_KEY$2}`;var _ui$1=new WeakMap,_isVisible$1=new WeakMap,_selectionState$1=new WeakMap,_Dialog_brand=new WeakSet;class Dialog extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$2(this,_Dialog_brand),_classPrivateFieldInitSpec$3(this,_ui$1,null),_classPrivateFieldInitSpec$3(this,_isVisible$1,!1),_classPrivateFieldInitSpec$3(this,_selectionState$1,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$2}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$2}static get DEFAULT_SETTINGS(){return{template:null,content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{template:s=>isObject(s)&&typeof["alert","confirm"].includes(s.type)&&typeof s.title=="string"&&(typeof s?.description>"u"||typeof s?.description=="string")&&(typeof s?.buttons>"u"||Array.isArray(s?.buttons)&&s.buttons.every(c=>typeof c=="object"&&typeof c.text=="string"&&["primary","secondary"].includes(c.type)&&(typeof c.callback>"u"||typeof c.callback=="function"))),content:s=>typeof s=="string"||typeof HTMLElement<"u"&&s instanceof HTMLElement||typeof DocumentFragment<"u"&&s instanceof DocumentFragment,customClassName:s=>typeof s=="string",background:s=>["solid","semi-transparent"].includes(s),contentBackground:s=>typeof s=="boolean",animation:s=>typeof s=="boolean",closable:s=>typeof s=="boolean",a11y:s=>isObject(s)&&(typeof s?.role>"u"||["dialog","alertdialog"].includes(s?.role))&&(typeof s?.ariaLabel>"u"||typeof s?.ariaLabel=="string")&&(typeof s?.ariaLabelledby>"u"||typeof s?.ariaLabelledby=="string")&&(typeof s?.ariaDescribedby>"u"||typeof s?.ariaDescribedby=="string")}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$2]}enablePlugin(){this.enabled||(_classPrivateFieldGet$3(_ui$1,this)||_classPrivateFieldSet$3(_ui$1,this,new DialogUI({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),_assertClassBrand$3(_Dialog_brand,this,_registerShortcuts).call(this),_assertClassBrand$3(_Dialog_brand,this,_registerFocusScope$1).call(this),this.addHook("afterViewRender",()=>_assertClassBrand$3(_Dialog_brand,this,_onAfterViewRender).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),_assertClassBrand$3(_Dialog_brand,this,_unregisterShortcuts).call(this),_assertClassBrand$3(_Dialog_brand,this,_unregisterFocusScope$1).call(this),super.disablePlugin()}isVisible(){return _classPrivateFieldGet$3(_isVisible$1,this)}show(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this.enabled){if(this.isVisible()){this.update(s);return}this.hot.runHooks("beforeDialogShow"),this.update(s),_classPrivateFieldGet$3(_ui$1,this).showDialog(this.getSetting("animation")),_classPrivateFieldSet$3(_isVisible$1,this,!0),this.hot.getFocusScopeManager().activateScope(PLUGIN_KEY$2),_classPrivateFieldSet$3(_selectionState$1,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow")}}hide(){var s;this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),_classPrivateFieldGet$3(_ui$1,this).hideDialog(this.getSetting("animation")),_classPrivateFieldSet$3(_isVisible$1,this,!1),this.hot.getFocusScopeManager().deactivateScope(PLUGIN_KEY$2),((s=_classPrivateFieldGet$3(_selectionState$1,this))===null||s===void 0?void 0:s.ranges.length)>0?(this.hot.selection.importSelection(_classPrivateFieldGet$3(_selectionState$1,this)),this.hot.view.render(),_classPrivateFieldSet$3(_selectionState$1,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(s){if(!this.enabled)return;this.updatePluginSettings(s);const c=this.getSetting("template");if(c!==Dialog.DEFAULT_SETTINGS.template&&this.getSetting("content")!==Dialog.DEFAULT_SETTINGS.content)throw new Error("The `template` option cannot be used together with the `content` option.");c?_classPrivateFieldGet$3(_ui$1,this).useTemplate(c.type,{id:this.hot.guid,...c}):_classPrivateFieldGet$3(_ui$1,this).useDefaultTemplate(),_classPrivateFieldGet$3(_ui$1,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")})}showAlert(s,c){const{title:u="Alert",description:d}=isObject(s)?s:{title:s};this.show({template:{type:"confirm",title:u,description:d,buttons:[{text:this.hot.getTranslatedPhrase(OK),type:"primary",callback:function(){for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];return c?.(...f)}}]},contentBackground:!1,background:"solid",animation:!0,closable:!1})}showConfirm(s,c,u){const{title:d="Confirm",description:h}=isObject(s)?s:{title:s};this.show({template:{type:"confirm",title:d,description:h,buttons:[{text:this.hot.getTranslatedPhrase(CANCEL),type:"secondary",callback:function(){for(var f=arguments.length,g=new Array(f),m=0;m<f;m++)g[m]=arguments[m];return u?.(...g)}},{text:this.hot.getTranslatedPhrase(OK),type:"primary",callback:function(){for(var f=arguments.length,g=new Array(f),m=0;m<f;m++)g[m]=arguments[m];return c?.(...g)}}]},contentBackground:!0,background:"semi-transparent",animation:!0,closable:!1})}focus(){_classPrivateFieldGet$3(_ui$1,this).focusDialog()}destroy(){var s;(s=_classPrivateFieldGet$3(_ui$1,this))===null||s===void 0||s.destroyDialog(),_classPrivateFieldSet$3(_ui$1,this,null),_classPrivateFieldSet$3(_isVisible$1,this,!1),_classPrivateFieldSet$3(_selectionState$1,this,null),super.destroy()}}function _registerShortcuts(){var a;const s=this.hot.getShortcutManager(),c=(a=s.getContext(SHORTCUTS_CONTEXT_NAME$1))!==null&&a!==void 0?a:s.addContext(SHORTCUTS_CONTEXT_NAME$1);c.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>_classPrivateFieldGet$3(_isVisible$1,this)&&this.getSetting("closable"),group:SHORTCUTS_GROUP}),c.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:u=>{this.hot._registerTimeout(()=>{u.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")})},group:SHORTCUTS_GROUP})}function _unregisterShortcuts(){this.hot.getShortcutManager().getContext(SHORTCUTS_CONTEXT_NAME$1).removeShortcutsByGroup(SHORTCUTS_GROUP)}function _registerFocusScope$1(){this.hot.getFocusScopeManager().registerScope(PLUGIN_KEY$2,_classPrivateFieldGet$3(_ui$1,this).getContainer(),{shortcutsContextName:SHORTCUTS_CONTEXT_NAME$1,type:"modal",runOnlyIf:()=>this.isVisible(),onActivate:a=>{const s=this.hot.isListening(),c=_classPrivateFieldGet$3(_ui$1,this).getFocusableElements();c.length>0?a==="tab_from_above"?c.at(0).focus():a==="tab_from_below"&&c.at(-1).focus():a!=="tab_from_above"&&a!=="tab_from_below"&&s&&!_classPrivateFieldGet$3(_ui$1,this).getContainer().contains(this.hot.rootDocument.activeElement)&&_classPrivateFieldGet$3(_ui$1,this).getContainer().focus(),s&&this.hot.runHooks("afterDialogFocus",a==="unknown"?"show":a)}})}function _unregisterFocusScope$1(){this.hot.getFocusScopeManager().unregisterScope(PLUGIN_KEY$2)}function _onAfterViewRender(){const{view:a,rootWrapperElement:s,rootWindow:c}=this.hot,u=a.isHorizontallyScrollableByWindow()?a.getTotalTableWidth():a.getWorkspaceWidth();_classPrivateFieldGet$3(_ui$1,this).updateWidth(u);const d=s.querySelector(".hot-display-license-info");if(d){const h=d.offsetHeight,f=Number.parseFloat(c.getComputedStyle(d).marginTop);_classPrivateFieldGet$3(_ui$1,this).updateHeight(h+f)}}function loadingContent(a){let{id:s,icon:c,title:u,description:d}=a;return`
    <div class="${LOADING_CLASS_NAME}__content">
      <i class="${LOADING_CLASS_NAME}__icon">${c}</i>
      <div class="${LOADING_CLASS_NAME}__text">
        <h2 id="${s}-${PLUGIN_KEY$1}-title" class="${LOADING_CLASS_NAME}__title">${u}</h2>
        ${d?`<p id="${s}-${PLUGIN_KEY$1}-description" class="${LOADING_CLASS_NAME}__description">${d}</p>`:""}
      </div>
    </div>
  `}function _classPrivateMethodInitSpec$1(a,s){_checkPrivateRedeclaration$2(a,s),s.add(a)}function _classPrivateFieldInitSpec$2(a,s,c){_checkPrivateRedeclaration$2(a,s),s.set(a,c)}function _checkPrivateRedeclaration$2(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet$2(a,s,c){return a.set(_assertClassBrand$2(a,s),c),c}function _classPrivateFieldGet$2(a,s){return a.get(_assertClassBrand$2(a,s))}function _assertClassBrand$2(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY$1="loading",PLUGIN_PRIORITY$1=350,LOADING_CLASS_NAME=`ht-${PLUGIN_KEY$1}`;var _dialogPlugin=new WeakMap,_Loading_brand=new WeakSet;class Loading extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec$1(this,_Loading_brand),_classPrivateFieldInitSpec$2(this,_dialogPlugin,null)}static get PLUGIN_KEY(){return PLUGIN_KEY$1}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY$1}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${LOADING_CLASS_NAME}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:s=>typeof s=="string",title:s=>typeof s=="string",description:s=>typeof s=="string"}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY$1]}enablePlugin(){if(!this.enabled){if(_classPrivateFieldGet$2(_dialogPlugin,this)===null){var s;_classPrivateFieldSet$2(_dialogPlugin,this,this.hot.getPlugin("dialog")),(s=_classPrivateFieldGet$2(_dialogPlugin,this))!==null&&s!==void 0&&s.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>_assertClassBrand$2(_Loading_brand,this,_onAfterDialogFocus).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var s,c;return(s=(c=_classPrivateFieldGet$2(_dialogPlugin,this))===null||c===void 0?void 0:c.isVisible())!==null&&s!==void 0?s:!1}show(){var s;let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!_classPrivateFieldGet$2(_dialogPlugin,this)||!((s=_classPrivateFieldGet$2(_dialogPlugin,this))!==null&&s!==void 0&&s.isEnabled()))return;if(this.isVisible()){this.update(c);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(c),_classPrivateFieldGet$2(_dialogPlugin,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var s;!_classPrivateFieldGet$2(_dialogPlugin,this)||!((s=_classPrivateFieldGet$2(_dialogPlugin,this))!==null&&s!==void 0&&s.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(_classPrivateFieldGet$2(_dialogPlugin,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(s){var c,u;if(!this.isEnabled()||!_classPrivateFieldGet$2(_dialogPlugin,this)||!((c=_classPrivateFieldGet$2(_dialogPlugin,this))!==null&&c!==void 0&&c.isEnabled()))return;this.updatePluginSettings(s);const d=this.hot.guid,h=this.getSetting("icon"),f=(u=this.getSetting("title"))!==null&&u!==void 0?u:this.hot.getTranslatedPhrase(LOADING_TITLE),g=this.getSetting("description"),m=loadingContent({id:d,icon:h,title:f,description:g});_classPrivateFieldGet$2(_dialogPlugin,this).update({content:m,customClassName:LOADING_CLASS_NAME,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${d}-${PLUGIN_KEY$1}-title`,ariaDescribedby:g?`${d}-${PLUGIN_KEY$1}-description`:void 0}})}destroy(){_classPrivateFieldSet$2(_dialogPlugin,this,null),super.destroy()}}function _onAfterDialogFocus(){_classPrivateFieldGet$2(_dialogPlugin,this).focus()}function _classPrivateFieldInitSpec$1(a,s,c){_checkPrivateRedeclaration$1(a,s),s.set(a,c)}function _checkPrivateRedeclaration$1(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet$1(a,s){return a.get(_assertClassBrand$1(a,s))}function _classPrivateFieldSet$1(a,s,c){return a.set(_assertClassBrand$1(a,s),c),c}function _assertClassBrand$1(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const EMPTY_DATA_STATE_CLASS_NAME="ht-empty-data-state",MIN_HEIGHT=150,TEMPLATE=`<div data-ref="emptyDataStateElement" class="${EMPTY_DATA_STATE_CLASS_NAME} handsontable">
  <div class="${EMPTY_DATA_STATE_CLASS_NAME}__content-wrapper">
    <div data-ref="emptyDataStateInner" class="${EMPTY_DATA_STATE_CLASS_NAME}__content-wrapper-inner"></div>
  </div>
</div>`,templateContent=a=>{let{title:s,description:c,buttons:u}=a;return`
  <div class="${EMPTY_DATA_STATE_CLASS_NAME}__content">
    ${s?`<h2 class="${EMPTY_DATA_STATE_CLASS_NAME}__title">${stripTags(s)}</h2>`:""}
    ${c?`<p class="${EMPTY_DATA_STATE_CLASS_NAME}__description">${stripTags(c)}</p>`:""}
  </div>
  <div
    data-ref="emptyDataStateButtons"
    class="${EMPTY_DATA_STATE_CLASS_NAME}__buttons${u?.length>0?` ${EMPTY_DATA_STATE_CLASS_NAME}__buttons--has-buttons`:""}"
  >${u?.length>0?u.map(d=>`<button class="ht-button ht-button--${d.type}">${stripTags(d.text)}</button>`).join(""):""}</div>`};var _rootElement=new WeakMap,_rootDocument=new WeakMap,_refs=new WeakMap,_placeholderElement=new WeakMap;class EmptyDataStateUI{constructor(s){let{rootElement:c,rootDocument:u}=s;_classPrivateFieldInitSpec$1(this,_rootElement,void 0),_classPrivateFieldInitSpec$1(this,_rootDocument,void 0),_classPrivateFieldInitSpec$1(this,_refs,void 0),_classPrivateFieldInitSpec$1(this,_placeholderElement,void 0),_classPrivateFieldSet$1(_rootElement,this,c),_classPrivateFieldSet$1(_rootDocument,this,u),this.install()}install(){var s;if((s=_classPrivateFieldGet$1(_refs,this))!==null&&s!==void 0&&s.emptyDataStateElement)return;const c=html`${TEMPLATE}`;_classPrivateFieldSet$1(_refs,this,c.refs);const{emptyDataStateInner:u,emptyDataStateElement:d}=_classPrivateFieldGet$1(_refs,this);setAttribute(u,[A11Y_TABINDEX(-1)]),setAttribute(d,[A11Y_TABINDEX(-1)]),_classPrivateFieldGet$1(_rootElement,this).after(c.fragment)}getElement(){var s;return(s=_classPrivateFieldGet$1(_refs,this))===null||s===void 0?void 0:s.emptyDataStateElement}getFocusableElements(){const{emptyDataStateButtons:s,emptyDataStateInner:c}=_classPrivateFieldGet$1(_refs,this),u=Array.from(s?.children);return u.length===0?[c]:u}show(){var s;(s=_classPrivateFieldGet$1(_refs,this))!==null&&s!==void 0&&s.emptyDataStateElement&&(_classPrivateFieldGet$1(_refs,this).emptyDataStateElement.style.display="block")}hide(){var s,c;(s=_classPrivateFieldGet$1(_refs,this))!==null&&s!==void 0&&s.emptyDataStateElement&&((c=_classPrivateFieldGet$1(_placeholderElement,this))===null||c===void 0||c.remove(),_classPrivateFieldSet$1(_placeholderElement,this,null),_classPrivateFieldGet$1(_refs,this).emptyDataStateElement.style.display="none")}updateContent(s){var c;const{emptyDataStateInner:u}=_classPrivateFieldGet$1(_refs,this);let d="";typeof s=="string"?d={title:s}:d={title:s?.title,description:s?.description,buttons:s?.buttons};const h=html`${templateContent(d)}`;_classPrivateFieldSet$1(_refs,this,{..._classPrivateFieldGet$1(_refs,this),...h.refs}),u.innerHTML="",u.appendChild(h.fragment),((c=d.buttons)===null||c===void 0?void 0:c.length)>0&&Array.from(_classPrivateFieldGet$1(_refs,this).emptyDataStateButtons.children).forEach((f,g)=>{f.addEventListener("click",d.buttons[g].callback)})}updateClassNames(s){const{emptyDataStateElement:c}=_classPrivateFieldGet$1(_refs,this);s.countRenderableColumns()>0&&s.getColumnHeadersCount()>0?addClass$1(c,`${EMPTY_DATA_STATE_CLASS_NAME}--disable-top-border`):removeClass$1(c,`${EMPTY_DATA_STATE_CLASS_NAME}--disable-top-border`),s.countRenderableRows()>0&&s.getRowHeadersCount()>0?addClass$1(c,`${EMPTY_DATA_STATE_CLASS_NAME}--disable-inline-border`):removeClass$1(c,`${EMPTY_DATA_STATE_CLASS_NAME}--disable-inline-border`),s.hasHorizontalScroll()&&!s.isHorizontallyScrollableByWindow()?addClass$1(c,`${EMPTY_DATA_STATE_CLASS_NAME}--disable-bottom-border`):removeClass$1(c,`${EMPTY_DATA_STATE_CLASS_NAME}--disable-bottom-border`)}updateSize(s){const{emptyDataStateElement:c}=_classPrivateFieldGet$1(_refs,this),u=s.hasHorizontalScroll()?getScrollbarWidth(s.hot.rootDocument):0,d=s.countRenderableRows(),h=s.countRenderableColumns(),f=s.getColumnHeadersCount();if(c.style.top=h>0?`${s.getColumnHeaderHeight()}px`:"0px",c.style.insetInlineStart=d>0?`${s.getRowHeaderWidth()}px`:"0px",d===0)_classPrivateFieldGet$1(_placeholderElement,this)||(_classPrivateFieldSet$1(_placeholderElement,this,_classPrivateFieldGet$1(_rootDocument,this).createElement("div")),_classPrivateFieldGet$1(_placeholderElement,this).classList.add(`${EMPTY_DATA_STATE_CLASS_NAME}-placeholder`),s._wt.wtTable.holder.appendChild(_classPrivateFieldGet$1(_placeholderElement,this))),_classPrivateFieldGet$1(_placeholderElement,this).style.width="100%",_classPrivateFieldGet$1(_placeholderElement,this).style.height=`${MIN_HEIGHT}px`;else{var g;(g=_classPrivateFieldGet$1(_placeholderElement,this))===null||g===void 0||g.remove(),_classPrivateFieldSet$1(_placeholderElement,this,null)}let m=s.getWorkspaceWidth(),p=s.getTableHeight();s.isHorizontallyScrollableByWindow()?h>0?m=s.getTotalTableWidth():d>0&&(m=s.getViewportWidth()):d>0?m=s.getViewportWidth():s.getTableWidth()-s.getRowHeaderWidth()<s.getViewportWidth()&&h>0&&(m=s.getTableWidth()),s.isVerticallyScrollableByWindow()||s.hasVerticalScroll()?h>0?p=s.hot.getTableHeight()-s.getColumnHeaderHeight():p=s.hot.getTableHeight():f>0&&h>0?p=s.getViewportHeight()-u:f>0&&h===0&&(p=s.getWorkspaceHeight()-u),c.style.width=`${m}px`,c.style.height=`${p}px`}destroy(){var s,c;(s=_classPrivateFieldGet$1(_refs,this))===null||s===void 0||(s=s.emptyDataStateElement)===null||s===void 0||s.remove(),(c=_classPrivateFieldGet$1(_placeholderElement,this))===null||c===void 0||c.remove(),_classPrivateFieldSet$1(_placeholderElement,this,null),_classPrivateFieldSet$1(_refs,this,null)}}function _classPrivateMethodInitSpec(a,s){_checkPrivateRedeclaration(a,s),s.add(a)}function _classPrivateFieldInitSpec(a,s,c){_checkPrivateRedeclaration(a,s),s.set(a,c)}function _checkPrivateRedeclaration(a,s){if(s.has(a))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(a,s,c){return a.set(_assertClassBrand(a,s),c),c}function _classPrivateFieldGet(a,s){return a.get(_assertClassBrand(a,s))}function _assertClassBrand(a,s,c){if(typeof a=="function"?a===s:a.has(s))return arguments.length<3?s:c;throw new TypeError("Private element is not present on this object")}const PLUGIN_KEY="emptyDataState",PLUGIN_PRIORITY=370,SOURCE=Object.freeze({UNKNOWN:"unknown",FILTERS:"filters"}),SHORTCUTS_CONTEXT_NAME=`plugin:${PLUGIN_KEY}`;var _isVisible=new WeakMap,_ui=new WeakMap,_observer=new WeakMap,_hasFilterConditions=new WeakMap,_selectionState=new WeakMap,_EmptyDataState_brand=new WeakSet;class EmptyDataState extends BasePlugin{constructor(){super(...arguments),_classPrivateMethodInitSpec(this,_EmptyDataState_brand),_classPrivateFieldInitSpec(this,_isVisible,!1),_classPrivateFieldInitSpec(this,_ui,null),_classPrivateFieldInitSpec(this,_observer,null),_classPrivateFieldInitSpec(this,_hasFilterConditions,!1),_classPrivateFieldInitSpec(this,_selectionState,null)}static get PLUGIN_KEY(){return PLUGIN_KEY}static get PLUGIN_PRIORITY(){return PLUGIN_PRIORITY}static get DEFAULT_SETTINGS(){return{message:void 0}}static get SETTINGS_VALIDATORS(){return{message:s=>typeof s=="string"||typeof s=="function"||isObject(s)&&(typeof s?.title>"u"||typeof s?.title=="string")&&(typeof s?.description>"u"||typeof s?.description=="string")&&(typeof s?.buttons>"u"||Array.isArray(s?.buttons)&&s?.buttons.every(c=>typeof c=="object"&&typeof c.text=="string"&&typeof c.type=="string"&&["primary","secondary"].includes(c.type)&&typeof c.callback=="function"))||s===void 0}}isEnabled(){return!!this.hot.getSettings()[PLUGIN_KEY]}enablePlugin(){this.enabled||(_classPrivateFieldGet(_ui,this)||(_classPrivateFieldSet(_ui,this,new EmptyDataStateUI({rootElement:this.hot.rootGridElement,rootDocument:this.hot.rootDocument})),_assertClassBrand(_EmptyDataState_brand,this,_registerFocusScope).call(this),_assertClassBrand(_EmptyDataState_brand,this,_registerEvents).call(this),_assertClassBrand(_EmptyDataState_brand,this,_registerObservers).call(this)),this.addHook("afterInit",()=>_assertClassBrand(_EmptyDataState_brand,this,_onAfterInit).call(this)),this.addHook("afterRender",()=>_assertClassBrand(_EmptyDataState_brand,this,_onAfterRender).call(this)),this.addHook("afterRowSequenceCacheUpdate",()=>_assertClassBrand(_EmptyDataState_brand,this,_toggleEmptyDataState).call(this)),this.addHook("afterColumnSequenceCacheUpdate",()=>_assertClassBrand(_EmptyDataState_brand,this,_toggleEmptyDataState).call(this)),this.addHook("beforeFilter",s=>_assertClassBrand(_EmptyDataState_brand,this,_onBeforeFilter).call(this,s)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),_assertClassBrand(_EmptyDataState_brand,this,_update).call(this),this.isVisible()&&_classPrivateFieldGet(_ui,this).show(),super.updatePlugin()}disablePlugin(){_assertClassBrand(_EmptyDataState_brand,this,_unregisterFocusScope).call(this),_assertClassBrand(_EmptyDataState_brand,this,_disconnectObservers).call(this),_classPrivateFieldGet(_ui,this).destroy(),_classPrivateFieldSet(_ui,this,null),super.disablePlugin()}isVisible(){return _classPrivateFieldGet(_isVisible,this)}destroy(){var s;_classPrivateFieldSet(_isVisible,this,!1),(s=_classPrivateFieldGet(_ui,this))===null||s===void 0||s.destroy(),_classPrivateFieldSet(_ui,this,null),_classPrivateFieldSet(_observer,this,null),_classPrivateFieldSet(_hasFilterConditions,this,!1),_classPrivateFieldSet(_selectionState,this,null),super.destroy()}}function _registerEvents(){this.eventManager.addEventListener(_classPrivateFieldGet(_ui,this).getElement(),"wheel",a=>_assertClassBrand(_EmptyDataState_brand,this,_onMouseWheel).call(this,a))}function _registerObservers(){_classPrivateFieldSet(_observer,this,new MutationObserver(()=>{if(!this.hot)return;const a=_classPrivateFieldGet(_ui,this).getElement();this.hot.rootGridElement.nextElementSibling!==a&&this.hot.rootGridElement.after(a)})),_classPrivateFieldGet(_observer,this).observe(this.hot.rootWrapperElement,{childList:!0})}function _disconnectObservers(){_classPrivateFieldGet(_observer,this).disconnect(),_classPrivateFieldSet(_observer,this,null)}function _registerFocusScope(){this.hot.getFocusScopeManager().registerScope(PLUGIN_KEY,_classPrivateFieldGet(_ui,this).getElement(),{shortcutsContextName:SHORTCUTS_CONTEXT_NAME,runOnlyIf:()=>this.isVisible(),onActivate:a=>{var s;const c=(s=_classPrivateFieldGet(_ui,this))===null||s===void 0?void 0:s.getFocusableElements();c.length>0&&(a==="tab_from_above"?c.at(0).focus():a==="tab_from_below"&&c.at(-1).focus())}})}function _unregisterFocusScope(){this.hot.getFocusScopeManager().unregisterScope(PLUGIN_KEY)}function _getMessage(a){var s,c,u;let d;return typeof this.getSetting("message")=="function"?d=this.getSetting("message")(a):d=this.getSetting("message"),typeof d=="string"&&(d={title:d}),!((s=d)!==null&&s!==void 0&&s.title)&&!((c=d)!==null&&c!==void 0&&c.description)&&!((u=d)!==null&&u!==void 0&&u.buttons)&&(d={},a===SOURCE.FILTERS?(d.title=this.hot.getTranslatedPhrase(EMPTY_DATA_STATE_TITLE_FILTERS),d.description=this.hot.getTranslatedPhrase(EMPTY_DATA_STATE_DESCRIPTION_FILTERS),d.buttons=[{text:this.hot.getTranslatedPhrase(EMPTY_DATA_STATE_BUTTONS_FILTERS_RESET),type:"secondary",callback:()=>{const h=this.hot.getPlugin("filters");h&&(h.clearConditions(),h.filter())}}]):(d.title=this.hot.getTranslatedPhrase(EMPTY_DATA_STATE_TITLE),d.description=this.hot.getTranslatedPhrase(EMPTY_DATA_STATE_DESCRIPTION))),d}function _toggleEmptyDataState(){this.hot.view&&(this.hot.view.countRenderableColumns()===0||this.hot.view.countRenderableRows()===0?_assertClassBrand(_EmptyDataState_brand,this,_show).call(this):_assertClassBrand(_EmptyDataState_brand,this,_hide).call(this))}function _show(){_classPrivateFieldGet(_isVisible,this)||(this.hot.runHooks("beforeEmptyDataStateShow"),_assertClassBrand(_EmptyDataState_brand,this,_update).call(this),_classPrivateFieldGet(_ui,this).show(),_classPrivateFieldSet(_isVisible,this,!0),_classPrivateFieldSet(_selectionState,this,this.hot.selection.exportSelection()),this.hot.getFocusScopeManager().activateScope(PLUGIN_KEY),this.hot.runHooks("afterEmptyDataStateShow"))}function _update(){_classPrivateFieldGet(_hasFilterConditions,this)?_classPrivateFieldGet(_ui,this).updateContent(_assertClassBrand(_EmptyDataState_brand,this,_getMessage).call(this,SOURCE.FILTERS)):_classPrivateFieldGet(_ui,this).updateContent(_assertClassBrand(_EmptyDataState_brand,this,_getMessage).call(this,SOURCE.UNKNOWN))}function _hide(){var a;_classPrivateFieldGet(_isVisible,this)&&(this.hot.runHooks("beforeEmptyDataStateHide"),_classPrivateFieldGet(_ui,this).hide(),_classPrivateFieldSet(_isVisible,this,!1),this.hot.getFocusScopeManager().deactivateScope(PLUGIN_KEY),((a=_classPrivateFieldGet(_selectionState,this))===null||a===void 0?void 0:a.ranges.length)>0?(this.hot.selection.importSelection(_classPrivateFieldGet(_selectionState,this)),this.hot.view.render(),_classPrivateFieldSet(_selectionState,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterEmptyDataStateHide"))}function _onMouseWheel(a){const s=Number.isNaN(a.deltaX)?-1*a.wheelDeltaX:a.deltaX;s!==0&&this.hot.view.hasHorizontalScroll()&&!this.hot.view.isHorizontallyScrollableByWindow()&&(this.hot.view.setTableScrollPosition({left:this.hot.view.getTableScrollPosition().left+s}),a.preventDefault())}function _onAfterInit(){_assertClassBrand(_EmptyDataState_brand,this,_toggleEmptyDataState).call(this),this.hot.render()}function _onAfterRender(){var a;(a=_classPrivateFieldGet(_ui,this))!==null&&a!==void 0&&a.getElement()&&this.isVisible()&&(_classPrivateFieldGet(_ui,this).updateSize(this.hot.view),_classPrivateFieldGet(_ui,this).updateClassNames(this.hot.view))}function _onBeforeFilter(a){_classPrivateFieldSet(_hasFilterConditions,this,a?.length>0),this.isVisible()&&_assertClassBrand(_EmptyDataState_brand,this,_update).call(this)}function registerAllPlugins(){registerPlugin(AutoColumnSize),registerPlugin(Autofill),registerPlugin(AutoRowSize),registerPlugin(BindRowsWithHeaders),registerPlugin(CollapsibleColumns),registerPlugin(ColumnSorting),registerPlugin(ColumnSummary),registerPlugin(Comments),registerPlugin(ContextMenu),registerPlugin(CopyPaste),registerPlugin(CustomBorders),registerPlugin(DragToScroll),registerPlugin(DropdownMenu),registerPlugin(ExportFile),registerPlugin(Filters),registerPlugin(Formulas),registerPlugin(HiddenColumns),registerPlugin(HiddenRows),registerPlugin(ManualColumnFreeze),registerPlugin(ManualColumnMove),registerPlugin(ManualColumnResize),registerPlugin(ManualRowMove),registerPlugin(ManualRowResize),registerPlugin(MergeCells),registerPlugin(MultiColumnSorting),registerPlugin(MultipleSelectionHandles),registerPlugin(NestedHeaders),registerPlugin(NestedRows),registerPlugin(Pagination),registerPlugin(PersistentState),registerPlugin(Search),registerPlugin(StretchColumns),registerPlugin(TouchScroll),registerPlugin(TrimRows),registerPlugin(UndoRedo),registerPlugin(Dialog),registerPlugin(Loading),registerPlugin(EmptyDataState)}function registerAllModules(){registerAllEditors(),registerAllRenderers(),registerAllValidators(),registerAllCellTypes(),registerAllPlugins()}registerAllModules();const AppContext=React.createContext({platform:Platform.WHISK,limit:0,count:1});function addButton(a){function s(){if(!document.querySelector("#downloader")){const u=pathForDisplay[a.platform],d=document.createElement("div");d.id="downloader",document.body.append(d),new RegExp(u).test(location.href)||(d.style.display="none"),client.createRoot(d).render(jsxRuntime.jsx(AppContext.Provider,{value:a,children:jsxRuntime.jsx(App,{})}))}}return location.href.includes("https://grok.com")?setTimeout(()=>{s()},2e3):s(),new MutationObserver(()=>{s()}).observe(document.body,{childList:!0}),()=>{const u=pathForDisplay[a.platform],d=new RegExp(u).test(location.href),h=document.querySelector("#downloader");h&&(d?h.style.display="block":h.style.display="none")}}function addEvent(a){const s=history.pushState;history.pushState=function(...u){const d=s.apply(this,u);return window.dispatchEvent(new Event("locationchange")),d};const c=history.replaceState;history.replaceState=function(...u){const d=c.apply(this,u);return window.dispatchEvent(new Event("locationchange")),d},window.addEventListener("popstate",()=>{window.dispatchEvent(new Event("locationchange"))}),window.addEventListener("load",a),window.addEventListener("locationchange",a)}function getElementFromShadowRoot(a,s=document){let c=s;for(const u of a)if(c=(c.shadowRoot||c)?.querySelector?.(u),!c)break;return c}function getAppBasic(){const a=document.querySelector("iframe")?.contentDocument||document;return getElementFromShadowRoot(["bb-main","#content>bb-app-controller","app-basic"],a)}function getRunBtn(a){return a.shadowRoot?.querySelector("#run")}function getReplayBtn(a){return getElementFromShadowRoot(["bb-app-header","#replay"],a)}function getHint(a){return getElementFromShadowRoot(["bb-a2ui-client-view","a2ui-surface","a2ui-text"],a)?.text?.literalString}function checkProgress(a){return a.shadowRoot?.querySelector?.("#progress")?.className?.includes("active")}const TEXT="文字",IMAGE="图片";async function opalOperation(a,s,c,u,d,h){const{prompt:f,folder:g,images:m,index:p}=s,v=getAppBasic();if(!v||v instanceof Document)return;let w=0;function E(C){if(w++,antd.message.error(C),w>3)throw new Error("连续出错3次，最后一次错误为："+C)}for(let C=0;C<u.times;C++){if(!h.current)return;for(;checkProgress(v);)await sleep(5);p&&await sleep(u.interval),window.currentProcess={row:p,prompt:f,folder:g,filename:m?.[0]?.filename||""};const b=getRunBtn(v);if(b)b.click();else{const P=getReplayBtn(v);if(P){P.click(),await sleep(2);const R=getRunBtn(v);if(R)R.click();else throw new Error("找不到开始按钮")}else throw new Error("找不到开始按钮与重启按钮")}for(await sleep(2);;){const P=getHint(v);if(!P){E("找不到提示");break}const R=getElementFromShadowRoot(["bb-floating-input"],v);if(!R){E("找不到输入框");break}if(P.includes(TEXT)&&f&&(R.textInput&&"value"in R.textInput?(R.textInput.value=f,await sleep(2)):E("找不到文本输入框")),P.includes(IMAGE)&&m?.[0]?.base64){const I=m.map(M=>{const N=M?.base64?.match(/.+?:(.+)?;.+,(.+)/);if(N)return{inlineData:{data:N[2],mimeType:N[1]}};antd.message.error(`第${p}行的图片存在错误`)}).filter(Boolean);if(I.length){const M=getElementFromShadowRoot(["bb-asset-shelf"],R);if(M&&"addAsset"in M&&typeof M.addAsset=="function"){const N={role:"user",parts:I};M.addAsset(N),await sleep(2)}else{E("找不到上传图片的地方");break}}}const T=R.shadowRoot?.querySelector?.("#continue");if(T)T.click();else{E("找不到继续按钮");break}if(await sleep(2),checkProgress(v))break}p===c[c.length-1].index&&C===u.times-1?await sleep(10):await sleep(u.interval)}}window.setPrompt=()=>{},window.generate=()=>{},window.uploadImage=async a=>"";class Api{static async getAuthorization(){if(!window.authorization)try{const s=await fetch("/api/auth/session"),c=await parseResponse(s);c.accessToken&&(window.authorization="Bearer ".concat(c.accessToken))}catch{}return window.authorization}static getOaiDid(){const s=document.cookie.match(/oai-did=(.+?);/);return s?s[1]:""}static async delete(s){try{const c=Api.getOaiDid();if(!c)throw new Error("无法获取认证信息");const u=await Api.getAuthorization();if(!u)throw new Error("无法获取认证信息");const d=await fetch("/backend/project_y/profile/drafts/delete",{headers:{Authorization:u,"Content-Type":"application/json","OAI-Device-Id":c},referrer:"https://sora.chatgpt.com/drafts",body:JSON.stringify({ids:s}),method:"POST",mode:"cors",credentials:"include"});let h="";d.status!==200&&(h+=`请求失败：${d.status} ${d.statusText}`);const f=await parseResponse(d);if(f.error?.message)throw h+=`${f.error.message}`,new Error(h);return{ids:f.deleted_ids||[]}}catch(c){return console.error(c),{error:c.message}}}static async getData(){const s=Api.getOaiDid();if(!s)return console.error("无法获取认证信息");const c=await Api.getAuthorization();if(!c)return console.error("无法获取认证信息");fetch("/backend/project_y/profile/drafts?limit=15",{headers:{Authorization:c,"Content-Type":"application/json","OAI-Device-Id":s},referrer:"https://sora.chatgpt.com/drafts",method:"GET",mode:"cors",credentials:"include"})}}function enableDeleteHistory(){window.deleteHistory=Api.delete}const href=location.href,configs={whisk:{limit:6,count:2},"meta-ai":{limit:0,count:1,config:{supportImage:!0}},sora:{limit:2,count:1},hailuo:{limit:0,count:1,config:{supportImage:!0,multiImagesForImage:!0,hint:"先切换要用的模型，再刷新界面才能正常加载功能"}},grok:{limit:0,count:18},dreamina:{limit:0,count:1,config:{uploadOnce:!0,supportImage:!0,multiImagesForImage:!0,uploadAllImagesOnce:!0}},gemini:{limit:0,count:1,config:{initialize:async()=>{LitHelper.startNewChat(),await sleep(3)},supportImage:!0,downloader:download,multiImagesForImage:!0,multiImagesForVideo:!0}},flow:{limit:0,count:1,config:{supportImage:!0,multiImagesForImage:!0,multiImagesForVideo:!0,hint:"使用前切换到“制作图片”模式，先点击输入框确认显示生成图片再使用"}},playground:{limit:0,count:1,config:{uploadAllImagesOnce:!0,multiImagesForImage:!0,supportImage:!0,uploadOnce:!0}},lmarena:{limit:0,count:1,config:{uploadAllImagesOnce:!0,multiImagesForImage:!0,supportImage:!0}},hedra:{limit:0,count:1,config:{supportImage:!0,multiImagesForImage:!0,uploadOnce:!0}},opal:{limit:1,count:1,config:{supportImage:!0,multiImagesForImage:!0,uploadAllImagesOnce:!0,allowNoImagePrompt:!0,operation:opalOperation,keepProcess:!0}}};for(const a of Object.keys(configs))if(new RegExp(pathForLoad[a]).test(href)){a===Platform.SORA&&enableDeleteHistory(),addEvent(addButton({platform:a,...configs[a]}));break}exports.configs=configs,Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"})})(this.yDTnEEXZEVmVSaIhzpES=this.yDTnEEXZEVmVSaIhzpES||{},window.imagine_externals.react,window.imagine_externals["react-dom/client"],window.imagine_externals.antd,window.imagine_externals["react-dom"],window.imagine_externals["react/jsx-runtime"]);

  });
})();
