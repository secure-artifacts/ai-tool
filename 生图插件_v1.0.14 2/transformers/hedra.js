(function(){"use strict";const m="react";y.id=m;function y(n,a){for(let o=0;o<n.length;o++){const s=n[o];if(typeof s=="function"&&originalToString.call(s).includes(".createElement=")){console.log("找到------------------",m),window.replaceIds=window.replaceIds.filter(l=>l!==m),n[o]=function(l,d,w){window.modulefactory=l,s.apply(this,arguments),a[m]=w};return}}}const h="jsx";v.id=h;function v(n,a){for(let o=0;o<n.length;o++){const s=n[o];if(typeof s=="function"&&originalToString.call(s).includes(".jsx=")){console.log("找到------------------",h),window.replaceIds=window.replaceIds.filter(l=>l!==h),n[o]=function(l,d,w){s.apply(this,arguments),a[h]=w;const e=w.jsx;w.jsx=function(r,t){if(t?.editor&&t.onSubmit){const{editor:i}=t;window.generate=t.onSubmit,window.setPrompt=function(c){i.commands.setContent(`<p>${c}</p>`)}}else if(r?.displayName==="PromptTextArea"&&t?.onChange)window.setPrompt=i=>{t.onChange({target:{value:i}})};else if(!(t?.id==="video-prompt-text-box"&&t.onSubmit)){if(t?.onUpdateImages&&t.onUpload&&t.referenceImages)window.uploadImage=async i=>(t.onUpload(i[0]),""),window.clearUploadedImages=async()=>{t.onUpdateImages([])};else if(!(t?.handleImageUploadAndSelect&&t.frameType==="start_frame")){if(!(t?.handleImageUploadAndSelect&&t.frameType==="end_frame")){if(t&&["deletingItemId","flowMode","innerClassName","items","loadMoreRef","parentScrollRef"].every(i=>i in t)&&Array.isArray(t.items)){const i={};for(const c of t.items)if(c.id&&c.previewUrl&&(i[c.id]=[{url:c.previewUrl,thumbnail:c.previewUrl}]),Object.keys(i).length>=5)break;Object.keys(i).length&&window.emitter.emit("onReceiveData",i)}}}}return e.apply(this,arguments)}};return}}}function R(n){return typeof n=="string"?n:n instanceof URL?n.href:n instanceof Request?n.url:String(n??"")}async function S(n){let a;const o=n.headers.get("Content-Type")||"";try{if(o.includes("application/json"))a=await n.json();else if(o.includes("text/")){let s=await n.text();s=s.replace(/^for\s*\(\s*;;\s*\);/,"").trim();try{a=JSON.parse(s)}catch{a=s}}else if(o.includes("application/octet-stream")||o.includes("blob"))a=await n.blob();else if(o.includes("form-data"))a=await n.formData();else{let s=await n.text();try{a=JSON.parse(s)}catch{a=s}}}catch{}return a}window.currentProcess={row:null,prompt:"",folder:""};function L(){const n=window.fetch;window.fetch=async(a,o)=>{const s=R(a),l={...window.currentProcess},d=s.includes("web-app/generations?limit")&&s.includes("type=image"),w=!d&&s.includes("web-app/generations")&&l.row!=null,e=d||w,r=await n(a,o);if(e)try{const t=r.clone(),i=await S(t);if(w&&i.id)window.emitter.emit("onSubmitSuccess",{id:i.id,...l});else if(d&&Array.isArray(i.data)){const c={};for(const f of i.data)if(f.id&&f.status?.toLowerCase()==="complete"){const p=f.asset?.asset?.url;if(!p)continue;const u=c[f.id]||[],g=f.asset?.thumbnail_url||"";f.type==="image"?u.push({url:p,thumbnail:p}):u.push({url:p,thumbnail:g}),c[f.id]=u}Object.keys(c).length&&window.emitter.emit("onReceiveData",c)}}catch{}return r}}if(window.TURBOPACK)console.log("已经存在 TURBOPACK");else{let n=function(e){replaceIds.length&&replaceIds.forEach(r=>{l[r]?l[r](e,fbmodules):window.replaceIds=window.replaceIds.filter(t=>t!==r)})},a=function(e){const r=e.id;l[r]=e,replaceIds.push(r)};console.log("不存在 TURBOPACK");const o=Function.prototype.toString;window.originalToString=o,window.TURBOPACK=[];let s=window.TURBOPACK.push;window.eventListeners||(window.eventListeners={box:{},waitMount:{},componentStates:{},add:(e,r)=>{if(eventListeners.box[e]||(eventListeners.box[e]=[]),eventListeners.box[e].push(r),eventListeners.waitMount[e]!==void 0){let t=eventListeners.waitMount[e];delete eventListeners.waitMount[e],setTimeout(()=>{eventListeners.fire(e,t)},0)}return()=>{eventListeners.box[e]=eventListeners.box[e].filter(t=>t!==r)}},fire:(e,r)=>{eventListeners.box[e]?eventListeners.box[e].length>0?eventListeners.box[e].forEach(t=>{t(r)}):eventListeners.componentStates[e]=!!r:eventListeners.waitMount[e]=r}}),window.heroReplace||(window.heroReplace={node_replace:function(e,r,t,i){return i.createElement(function(){const f=!!eventListeners.componentStates[e];var[p,u]=i.useState(heroReplace[e+"_proxy"]?f:!1);return i.useEffect(()=>eventListeners.add(e,g=>{eventListeners.componentStates[e]=!!g,u(!!g)}),[u,e]),p&&heroReplace[e+"_proxy"]?i.createElement(heroReplace[e+"_proxy"],{sourceNode:r,mode:t,moduleId:e}):r},{})},memo_replace:function(e,r){var t=window.require("react");return t?.memo?t.memo(function(i,c,f,p){console.log(2,arguments);let u=Object.assign({},i,c,f,p);const g=!!eventListeners.componentStates[e];var[T,b]=t.useState(heroReplace[e+"_proxy"]?g:!1);return t.useEffect(()=>eventListeners.add(e,x=>{eventListeners.componentStates[e]=!!x,b(!!x)}),[b,e]),T&&heroReplace[e+"_proxy"]?t.createElement(heroReplace[e+"_proxy"],{sourcefunc:r,props:u,moduleId:e}):t.createElement(r,u)}):(console.log("替换失败",e),r)},module_replace:function(e,r){var t=window.require("react");return!t||!t.createElement?(console.log("没有，react"),r):function(c){const f=!!eventListeners.componentStates[e];var[p,u]=t.useState(heroReplace[e+"_proxy"]?f:!1);return t.useEffect(()=>eventListeners.add(e,g=>{eventListeners.componentStates[e]=!!g,u(!!g)}),[u,e]),p&&heroReplace[e+"_proxy"]?t.createElement(heroReplace[e+"_proxy"],{props:c,sourcefunc:r,mouldeId:e}):t.createElement(r,c)}}}),window.fbmodules={};let l={};window.replaceIds=[],window.require=function(e){if(!fbmodules[e]){if(!window.moduleManager)return{};let r=window.moduleManager.findModule(U[e]);if(!r?.[0])return{};fbmodules[e]=r?.[0]}return fbmodules[e]};let d=0;const w={0:s};Object.defineProperty(TURBOPACK,"push",{get:()=>{if(d>=0){const e=d;return function(){n(arguments[0]),w[e].apply(TURBOPACK,arguments)}}return s},set:e=>{d++,w[d]=e}}),a(y),a(v)}L();const U={react:n=>n&&n.createElement,"react-dom":n=>n&&n.hydrateRoot&&n.render,jsx:n=>n.jsx}})();
